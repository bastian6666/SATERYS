const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Controls-BeLp0NWk.js","assets/Icon-DvvlgQ-E.js","assets/DrawerController-CUoswhtj.js","assets/DrawerController-ZXfKNTdC.css"])))=>i.map(i=>d[i]);
var gc=Object.defineProperty;var vc=(i,e,o)=>e in i?gc(i,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):i[e]=o;var En=(i,e,o)=>vc(i,typeof e!="symbol"?e+"":e,o);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function o(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(n){if(n.ep)return;n.ep=!0;const a=o(n);fetch(n.href,a)}})();const el=[];function yc(i){el.push(i)}function bc(){return el.slice().sort((i,e)=>(i.order??0)-(e.order??0))}let il;function wc(i){il=i}function nl(){return il}const Vs="starter";yc({id:`${Vs}.hello`,group:"analysis",label:"Hello Plugin",order:100,async run(){const i=nl();i.toast.info("Plugin button clicked!"),await i.jobs.run("Echo Test",async e=>{e(10);try{const o=await i.api.fetch(`/plugins/${Vs}/echo`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({msg:"Hello from UI plugin!"})});if(e(50),!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);const r=await o.json();e(100),r.ok?i.toast.success(`Echo OK: ${r.echo}`):i.toast.error("Echo failed")}catch(o){throw i.toast.error(`Error: ${(o==null?void 0:o.message)||o}`),o}})}});console.log("âœ“ Starter UI plugin loaded");function Ft(){}function cs(i,e){for(const o in e)i[o]=e[o];return i}function ol(i){return i()}function Ys(){return Object.create(null)}function si(i){i.forEach(ol)}function lo(i){return typeof i=="function"}function ui(i,e){return i!=i?e==e:i!==e||i&&typeof i=="object"||typeof i=="function"}function Lc(i){return Object.keys(i).length===0}function mi(i,...e){if(i==null){for(const r of e)r(void 0);return Ft}const o=i.subscribe(...e);return o.unsubscribe?()=>o.unsubscribe():o}function Lt(i){let e;return mi(i,o=>e=o)(),e}function yt(i,e,o){i.$$.on_destroy.push(mi(e,o))}function Ee(i,e,o,r){if(i){const n=sl(i,e,o,r);return i[0](n)}}function sl(i,e,o,r){return i[1]&&r?cs(o.ctx.slice(),i[1](r(e))):o.ctx}function Ce(i,e,o,r){if(i[2]&&r){const n=i[2](r(o));if(e.dirty===void 0)return n;if(typeof n=="object"){const a=[],l=Math.max(e.dirty.length,n.length);for(let h=0;h<l;h+=1)a[h]=e.dirty[h]|n[h];return a}return e.dirty|n}return e.dirty}function Te(i,e,o,r,n,a){if(n){const l=sl(e,o,r,a);i.p(l,n)}}function Se(i){if(i.ctx.length>32){const e=[],o=i.ctx.length/32;for(let r=0;r<o;r++)e[r]=-1;return e}return-1}function hs(i){const e={};for(const o in i)e[o]=!0;return e}function Xs(i){return i??""}function At(i,e,o){return i.set(o),e}function Tn(i){return i&&lo(i.destroy)?i.destroy:Ft}const kc=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function w(i,e){i.appendChild(e)}function J(i,e,o){i.insertBefore(e,o||null)}function Y(i){i.parentNode&&i.parentNode.removeChild(i)}function Sn(i,e){for(let o=0;o<i.length;o+=1)i[o]&&i[o].d(e)}function T(i){return document.createElement(i)}function Jt(i){return document.createElementNS("http://www.w3.org/2000/svg",i)}function Re(i){return document.createTextNode(i)}function V(){return Re(" ")}function De(){return Re("")}function ft(i,e,o,r){return i.addEventListener(e,o,r),()=>i.removeEventListener(e,o,r)}function Xi(i){return function(e){return e.preventDefault(),i.call(this,e)}}function nn(i){return function(e){return e.stopPropagation(),i.call(this,e)}}function no(i){return function(e){e.target===this&&i.call(this,e)}}function p(i,e,o){o==null?i.removeAttribute(e):i.getAttribute(e)!==o&&i.setAttribute(e,o)}function Cn(i){return i===""?null:+i}function Mc(i){return Array.from(i.childNodes)}function pi(i,e){e=""+e,i.data!==e&&(i.data=e)}function Ge(i,e){i.value=e??""}function lt(i,e,o,r){o==null?i.style.removeProperty(e):i.style.setProperty(e,o,"")}function Vn(i,e,o){for(let r=0;r<i.options.length;r+=1){const n=i.options[r];if(n.__value===e){n.selected=!0;return}}(!o||e!==void 0)&&(i.selectedIndex=-1)}function Vo(i){const e=i.querySelector(":checked");return e&&e.__value}let Mo;function Pc(){if(Mo===void 0){Mo=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{Mo=!0}}return Mo}function Ec(i,e){getComputedStyle(i).position==="static"&&(i.style.position="relative");const r=T("iframe");r.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),r.setAttribute("aria-hidden","true"),r.tabIndex=-1;const n=Pc();let a;return n?(r.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",a=ft(window,"message",l=>{l.source===r.contentWindow&&e()})):(r.src="about:blank",r.onload=()=>{a=ft(r.contentWindow,"resize",e),e()}),w(i,r),()=>{(n||a&&r.contentWindow)&&a(),Y(r)}}function jt(i,e,o){i.classList.toggle(e,!!o)}function Cc(i,e,{bubbles:o=!1,cancelable:r=!1}={}){return new CustomEvent(i,{detail:e,bubbles:o,cancelable:r})}class Tc{constructor(e=!1){En(this,"is_svg",!1);En(this,"e");En(this,"n");En(this,"t");En(this,"a");this.is_svg=e,this.e=this.n=null}c(e){this.h(e)}m(e,o,r=null){this.e||(this.is_svg?this.e=Jt(o.nodeName):this.e=T(o.nodeType===11?"TEMPLATE":o.nodeName),this.t=o.tagName!=="TEMPLATE"?o:o.content,this.c(e)),this.i(r)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.nodeName==="TEMPLATE"?this.e.content.childNodes:this.e.childNodes)}i(e){for(let o=0;o<this.n.length;o+=1)J(this.t,this.n[o],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(Y)}}function pn(i,e){return new i(e)}let ro;function oo(i){ro=i}function An(){if(!ro)throw new Error("Function called outside component initialization");return ro}function Sc(i){An().$$.before_update.push(i)}function Ki(i){An().$$.on_mount.push(i)}function rl(i){An().$$.after_update.push(i)}function co(i){An().$$.on_destroy.push(i)}function Yn(){const i=An();return(e,o,{cancelable:r=!1}={})=>{const n=i.$$.callbacks[e];if(n){const a=Cc(e,o,{cancelable:r});return n.slice().forEach(l=>{l.call(i,a)}),!a.defaultPrevented}return!0}}function xe(i,e){return An().$$.context.set(i,e),e}function _e(i){return An().$$.context.get(i)}function ei(i,e){const o=i.$$.callbacks[e.type];o&&o.slice().forEach(r=>r.call(this,e))}const Wn=[],on=[];let jn=[];const ns=[],al=Promise.resolve();let os=!1;function ll(){os||(os=!0,al.then(hl))}function cl(){return ll(),al}function On(i){jn.push(i)}function Dc(i){ns.push(i)}const Yo=new Set;let qn=0;function hl(){if(qn!==0)return;const i=ro;do{try{for(;qn<Wn.length;){const e=Wn[qn];qn++,oo(e),xc(e.$$)}}catch(e){throw Wn.length=0,qn=0,e}for(oo(null),Wn.length=0,qn=0;on.length;)on.pop()();for(let e=0;e<jn.length;e+=1){const o=jn[e];Yo.has(o)||(Yo.add(o),o())}jn.length=0}while(Wn.length);for(;ns.length;)ns.pop()();os=!1,Yo.clear(),oo(i)}function xc(i){if(i.fragment!==null){i.update(),si(i.before_update);const e=i.dirty;i.dirty=[-1],i.fragment&&i.fragment.p(i.ctx,e),i.after_update.forEach(On)}}function zc(i){const e=[],o=[];jn.forEach(r=>i.indexOf(r)===-1?e.push(r):o.push(r)),o.forEach(r=>r()),jn=e}const To=new Set;let zn;function we(){zn={r:0,c:[],p:zn}}function Le(){zn.r||si(zn.c),zn=zn.p}function B(i,e){i&&i.i&&(To.delete(i),i.i(e))}function U(i,e,o,r){if(i&&i.o){if(To.has(i))return;To.add(i),zn.c.push(()=>{To.delete(i),r&&(o&&i.d(1),r())}),i.o(e)}else r&&r()}function ke(i){return(i==null?void 0:i.length)!==void 0?i:Array.from(i)}function zo(i,e){i.d(1),e.delete(i.key)}function ao(i,e){U(i,1,1,()=>{e.delete(i.key)})}function wn(i,e,o,r,n,a,l,h,u,f,_,g){let y=i.length,k=a.length,P=y;const C={};for(;P--;)C[i[P].key]=P;const S=[],x=new Map,z=new Map,O=[];for(P=k;P--;){const rt=g(n,a,P),ot=o(rt);let tt=l.get(ot);tt?O.push(()=>tt.p(rt,e)):(tt=f(ot,rt),tt.c()),x.set(ot,S[P]=tt),ot in C&&z.set(ot,Math.abs(P-C[ot]))}const W=new Set,$=new Set;function Q(rt){B(rt,1),rt.m(h,_),l.set(rt.key,rt),_=rt.first,k--}for(;y&&k;){const rt=S[k-1],ot=i[y-1],tt=rt.key,at=ot.key;rt===ot?(_=rt.first,y--,k--):x.has(at)?!l.has(tt)||W.has(tt)?Q(rt):$.has(at)?y--:z.get(tt)>z.get(at)?($.add(tt),Q(rt)):(W.add(at),y--):(u(ot,l),y--)}for(;y--;){const rt=i[y];x.has(rt.key)||u(rt,l)}for(;k;)Q(S[k-1]);return si(O),S}function ul(i,e){const o={},r={},n={$$scope:1};let a=i.length;for(;a--;){const l=i[a],h=e[a];if(h){for(const u in l)u in h||(r[u]=1);for(const u in h)n[u]||(o[u]=h[u],n[u]=1);i[a]=h}else for(const u in l)n[u]=1}for(const l in r)l in o||(o[l]=void 0);return o}function dl(i){return typeof i=="object"&&i!==null?i:{}}function Ic(i,e,o){const r=i.$$.props[e];r!==void 0&&(i.$$.bound[r]=o,o(i.$$.ctx[r]))}function ce(i){i&&i.c()}function re(i,e,o){const{fragment:r,after_update:n}=i.$$;r&&r.m(e,o),On(()=>{const a=i.$$.on_mount.map(ol).filter(lo);i.$$.on_destroy?i.$$.on_destroy.push(...a):si(a),i.$$.on_mount=[]}),n.forEach(On)}function ae(i,e){const o=i.$$;o.fragment!==null&&(zc(o.after_update),si(o.on_destroy),o.fragment&&o.fragment.d(e),o.on_destroy=o.fragment=null,o.ctx=[])}function Oc(i,e){i.$$.dirty[0]===-1&&(Wn.push(i),ll(),i.$$.dirty.fill(0)),i.$$.dirty[e/31|0]|=1<<e%31}function ki(i,e,o,r,n,a,l=null,h=[-1]){const u=ro;oo(i);const f=i.$$={fragment:null,ctx:[],props:a,update:Ft,not_equal:n,bound:Ys(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:Ys(),dirty:h,skip_bound:!1,root:e.target||u.$$.root};l&&l(f.root);let _=!1;if(f.ctx=o?o(i,e.props||{},(g,y,...k)=>{const P=k.length?k[0]:y;return f.ctx&&n(f.ctx[g],f.ctx[g]=P)&&(!f.skip_bound&&f.bound[g]&&f.bound[g](P),_&&Oc(i,g)),y}):[],f.update(),_=!0,si(f.before_update),f.fragment=r?r(f.ctx):!1,e.target){if(e.hydrate){const g=Mc(e.target);f.fragment&&f.fragment.l(g),g.forEach(Y)}else f.fragment&&f.fragment.c();e.intro&&B(i.$$.fragment),re(i,e.target,e.anchor),hl()}oo(u)}class Mi{constructor(){En(this,"$$");En(this,"$$set")}$destroy(){ae(this,1),this.$destroy=Ft}$on(e,o){if(!lo(o))return Ft;const r=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return r.push(o),()=>{const n=r.indexOf(o);n!==-1&&r.splice(n,1)}}$set(e){this.$$set&&!Lc(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Ac="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ac);const Un=[];function Do(i,e){return{subscribe:nt(i,e).subscribe}}function nt(i,e=Ft){let o;const r=new Set;function n(h){if(ui(i,h)&&(i=h,o)){const u=!Un.length;for(const f of r)f[1](),Un.push(f,i);if(u){for(let f=0;f<Un.length;f+=2)Un[f][0](Un[f+1]);Un.length=0}}}function a(h){n(h(i))}function l(h,u=Ft){const f=[h,u];return r.add(f),r.size===1&&(o=e(n,a)||Ft),h(i),()=>{r.delete(f),r.size===0&&o&&(o(),o=null)}}return{set:n,update:a,subscribe:l}}function so(i,e,o){const r=!Array.isArray(i),n=r?[i]:i;if(!n.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=e.length<2;return Do(o,(l,h)=>{let u=!1;const f=[];let _=0,g=Ft;const y=()=>{if(_)return;g();const P=e(r?f[0]:f,l,h);a?l(P):g=lo(P)?P:Ft},k=n.map((P,C)=>mi(P,S=>{f[C]=S,_&=~(1<<C),u&&y()},()=>{_|=1<<C}));return u=!0,y(),function(){si(k),g(),u=!1}})}function xo(){const i=new Map,{subscribe:e,set:o,update:r}=nt(i);return{subscribe:e,set:o,update:r,add:(a,l)=>(r(h=>(h.set(l,a),h)),i),get:a=>i.get(a)||null,getAll:()=>Array.from(i.values()),delete:a=>{let l=!1;return r(h=>(h.delete(a),l=!0,h)),l},count:()=>i.size}}function Nc(i){const{id:e,inputs:o,outputs:r,resizable:n,dimensions:a,editable:l,direction:h,zIndex:u,position:f,selectionColor:_,borderWidth:g,edge:y}=i,{bgColor:k,borderColor:P,rotation:C,borderRadius:S,connections:x,textColor:z,locked:O,group:W}=i,$=xo(),Q=(tt="self")=>{Lt($).forEach(at=>{(tt==="self"||Lt(at.direction)===tt)&&at.recalculatePosition()})};return{id:typeof e=="string"&&e.slice(0,2)==="N-"?e:`N-${e}`,position:nt({x:(f==null?void 0:f.x)||0,y:(f==null?void 0:f.y)||0}),dimensions:{width:nt((a==null?void 0:a.width)||0),height:nt((a==null?void 0:a.height)||(a==null?void 0:a.width))},group:nt(W||null),locked:nt(O||!1),inputs:nt(o),outputs:nt(r),recalculateAnchors:Q,rotation:nt(C||0),moving:nt(!1),resizingWidth:nt(!1),resizingHeight:nt(!1),rotating:nt(!1),editable:nt(l||!1),resizable:nt(n),anchors:$,zIndex:nt(u||2),collapsed:nt(!1),edge:y||null,borderRadius:nt(S),bgColor:nt(k||null),direction:nt(h),label:nt(i.label||""),borderColor:nt(P||null),borderWidth:nt(g),selectionColor:nt(_||null),textColor:nt(z||null),connections:nt(x)}}const Bc=10,Rc=100,Zc=50,Hc="#000",Fc="#fff",Gc="12px",qc=22,Uc=1.4,Wc=40;function jc(i,e){const o=[i,e].sort();return`${o[0]}+${o[1]}`}function Ks(i,e,o){var h,u,f,_,g;const{source:r,target:n}=i,l={id:r.id&&n.id?jc(r.id,n.id):"cursor",target:i.target,source:i.source,component:e,type:nt((o==null?void 0:o.type)||null),color:(o==null?void 0:o.color)||nt(null),width:nt((o==null?void 0:o.width)||0),animated:nt((o==null?void 0:o.animated)||!1),rendered:nt(!1),start:(o==null?void 0:o.start)||null,end:(o==null?void 0:o.end)||null};if(o!=null&&o.disconnect&&(l.disconnect=!0),o!=null&&o.label){const y={text:nt(o==null?void 0:o.label.text),color:nt(((h=o==null?void 0:o.label)==null?void 0:h.color)||Hc),textColor:nt(((u=o==null?void 0:o.label)==null?void 0:u.textColor)||Fc),fontSize:nt(((f=o==null?void 0:o.label)==null?void 0:f.fontSize)||Gc),dimensions:{width:nt(((_=o==null?void 0:o.label.dimensions)==null?void 0:_.width)||Rc),height:nt(((g=o==null?void 0:o.label.dimensions)==null?void 0:g.height)||Zc)},borderRadius:nt((o==null?void 0:o.label.borderRadius)||Bc)};l.label=y}return l}function Vc(){const i=new Map,e=new Set,{subscribe:o,set:r,update:n}=nt(i),a={subscribe:o,set:r,update:n,add:(l,h)=>{if(typeof h!="string"){const u=Array.from(h),f=u[0],_=u[1];if(f.connected.update(g=>g.add(_)),_.connected.update(g=>g.add(f)),a.match(...Array.from(h)).length)return;e.forEach(g=>g(l,"connection"))}n(u=>(u.set(h,l),u))},getAll:()=>Array.from(i.values()),get:l=>i.get(l)||null,match:(...l)=>Array.from(i.keys()).filter(h=>h==="cursor"?!1:l.every(u=>u?h.has(u):!0)),fetch:(l,h)=>{const u=Array.from(i.keys()).filter(f=>f==="cursor"?!1:[l,h].every(_=>_?f.has(_):!0))[0];return i.get(u)||null},delete:l=>{if(typeof l!="string"){const u=Array.from(l),f=u[0],_=u[1];f.connected.update(g=>(g.delete(_),g)),_.connected.update(g=>(g.delete(f),g))}let h=!1;return n(u=>{const f=u.get(l);return f&&(u.delete(l),h=!0,typeof l!="string"&&e.forEach(_=>_(f,"disconnection"))),u}),h},onEdgeChange:l=>(e.add(l),()=>e.delete(l)),count:()=>i.size};return a}function Yc(i,e){const o=i.clientX-e.clientX,r=i.clientY-e.clientY;return Math.sqrt(o*o+r*r)}function Xc(){const i=()=>Math.floor(Math.random()*256),e=i(),o=i(),r=i();return`rgb(${e},${o},${r})`}const Kc={"(":"round","[":"square","([":"stadium","[[":"subroutine","[(":"cylindrical","((":"circle","{":"rhombus","{{":"hexagon"},Js={"-":"straight","~":"bezier"},fl={"(":")","[":"]","{":"}"},Jc=/[-=~]*>(?:\s*\|(.+?)\|)?/g,Qc=i=>{const e=i.split(`
`),o={parentNodes:[],nodeList:{}};for(const r of e){const{parentNodes:n,childNodes:a,edge:l}=$c(r);for(const h of n){o.nodeList[h.id]||o.parentNodes.push(h);for(const u of a){if(o.nodeList[h.id]){if(o.nodeList[u.id]&&o.nodeList[u.id].children.some(({node:f})=>f.id===h.id))throw new Error("Circular reference detected");o.nodeList[h.id].children.push({node:o.nodeList[u.id]||u,...l})}else h.children.push({node:o.nodeList[u.id]||u,...l}),o.nodeList[h.id]=h;o.nodeList[u.id]?o.nodeList[u.id].parents.push({node:o.nodeList[h.id]||h}):(u.parents.push({node:o.nodeList[h.id]||h}),o.nodeList[u.id]=u),o.parentNodes=o.parentNodes.filter(f=>f.id!==u.id)}}}return o},$c=i=>{const e=[],o=[],r=i.trim();let n="";const a=r.match(Jc);if(a)n=a[0];else throw new Error("Invalid edge");const[l,h]=r.split(n);for(const f of l.split("&"))e.push(Qs(f));for(const f of h.split("&"))o.push(Qs(f));const u=th(n);return{parentNodes:e,childNodes:o,edge:u}},Qs=i=>{i=i.trim();const e=i[0],o=i.slice(1);let r="",n="";const a="Default",l={shape:""},h=[];for(let u=0;u<o.length;u++)if(eh(o[u]))h.push(o[u]);else if(fl[h[h.length-1]]===o[u]){n=Kc[h.join("")];break}else r+=o[u];return l.shape=n,l.content=r,{id:e,data:l,type:a,children:[],parents:[],depth:0,nesting:0}},th=i=>{i=i.trim();let e="";const[o,r]=i.split("|"),n=o[0];if(n in Js)e=Js[n];else throw new Error("Not a valid edge type");return r?{shape:e,content:r.trim(),length:Math.floor((o.trim().length-1)/2)}:{shape:e,length:Math.floor((o.trim().length-1)/2)}};function eh(i){return i in fl}function ih(){return Math.random().toString(36).substring(7)}function nh(i,e){const o=Math.sign(i.x).toString(),r=Math.sign(i.y).toString(),n=Math.sign(e.x).toString(),a=Math.sign(e.y).toString();return`${o}${r}${n}${a}`}function oh(i,e){return{1001:`a ${i} ${i} 0 0 1 ${i} ${i}`,"0110":`a ${i} ${i} 0 0 0 ${i} ${i}`,"100-1":`a ${i} ${i} 0 0 0 ${i} -${i}`,"0-110":`a ${i} ${i} 0 0 1 ${i} -${i}`,"-1001":`a ${i} ${i} 0 0 0 -${i} ${i}`,"01-10":`a ${i} ${i} 0 0 1 -${i} ${i}`,"-100-1":`a ${i} ${i} 0 0 1 -${i} -${i}`,"0-1-10":`a ${i} ${i} 0 0 0 -${i} -${i}`}[e]||""}function $s(i,e){const o=e*(Math.PI/180),r=i.x*Math.cos(o)-i.y*Math.sin(o),n=i.x*Math.sin(o)+i.y*Math.cos(o);return{x:r,y:n}}const sh=(i,e,o,r)=>i+` l ${e} ${o} `+r,Gi=nt({x:0,y:0}),ss=nt(0),ji=nt(!1),rs=nt(!1),_l=Do({x:0,y:0},i=>{const e=a=>{i({x:a.clientX,y:a.clientY})},o=a=>{if(a.touches.length===2){const l=Yc(a.touches[0],a.touches[1]);ss.set(l);const h={x:a.touches[0].clientX,y:a.touches[0].clientY};i(h)}else if(a.touches.length===1){const l=a.touches[0].clientX,h=a.touches[0].clientY;i({x:l,y:h}),ji.set(!0)}},r=a=>{o(a),window.addEventListener("touchend",n),window.addEventListener("touchmove",o)},n=()=>{ji.set(!1),ss.set(0),window.removeEventListener("touchmove",o)};return document.addEventListener("mousemove",e),window.addEventListener("touchstart",r,!0),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchstart",r),window.removeEventListener("touchmove",o),window.removeEventListener("touchend",n)}});function Xo(i){const e=i.style.width,o=i.style.height;i.style.width="fit-content",i.style.height="fit-content";const r=i.offsetWidth,n=i.offsetHeight;return i.style.width=e,i.style.height=o,[r,n]}function ml(i,e,o,r,n){const a={x:0,y:0},l=r.x-n.left-n.width/2,h=r.y-n.top-n.height/2,u=(l-o.x)/i,f=(h-o.y)/i;return a.x=l-u*e,a.y=h-f*e,a}const rh=3,ah=.1,io={north:{x:0,y:-1},south:{x:0,y:1},east:{x:1,y:0},west:{x:-1,y:0},self:{x:0,y:0}};function pl(i,e,o){const r=e*o,n=i-r;return Number(Math.max(ah,Math.min(rh,n)).toFixed(9))}const Io=(i,e,o,r,n,a,l)=>{const{clientX:h,clientY:u}=i,f=a,_=h-o,g=u-e,y=l.x,k=l.y,P=r*(1-a)/2,C=n*(1-a)/2,S=_-y-P,x=g-k-C,z=S/f,O=x/f;return{x:z,y:O}};function lh(i,e,o){const{top:r,left:n,width:a,height:l}=Lt(i),h=Lt(e.scale),u=Lt(e.translation);return{scaled:Io({clientX:o.x,clientY:o.y},r,n,a,l,h,u),scale:h}}function ch(i,e,o){const{scale:r,translation:n}=o,a=Lt(r),l=Lt(n),h=e.x-i.x,u=e.y-i.y,f=l.x+h*a,_=l.y+u*a;return{x:f,y:_}}function hh(i,e){return i.x*e.x+i.y*e.y}function uh(i,e,o){const r=[],n=e.x-i.x,a=e.y-i.y,l=fh(i.direction,e.direction),h=hh(i.direction,e.direction)===0,u=dh(i,e),f=oi(i.direction,-1,-1),_=oi(e.direction,-1,-1),g={x:Math.abs(i.direction.y),y:Math.abs(i.direction.x)},y=oi(i.direction,n-o*i.direction.x*(h?1:l?0:2),a-o*i.direction.y*(h?1:l?0:2)),k=oi(e.direction,n+o*e.direction.x*(h?1:l?0:2),a+o*e.direction.y*(h?1:l?0:2)),P=Math.sign(y.x)===-1||Math.sign(y.y)===-1,C=Math.sign(k.x)===1||Math.sign(k.y)===1,S=Math.abs(n),x=Math.abs(a),z=oi(i.direction,o,o),O=oi(_,o,o),W=oi(e.direction,o,o),$=oi(i.direction,S,x),Q=oi(_,S,x),rt=oi(i.direction,S/2,x/2),ot=oi(_,S/2,x/2),tt=oi(g,n,a),at=!u&&!C&&!P,K=i.x+z.x,N=i.y+z.y,F=e.x+W.x,j=e.y+W.y;if(P&&r.push(z),u&&!C&&!P)r.push($),r.push(Q);else if(l)P||r.push(oi(i.direction,o+S,o+x)),r.push(tt),C||r.push(oi(_,o+S,o+x));else if(at)r.push(rt),r.push(tt),r.push(ot);else if(P&&C)if(h){const _t=Math.abs(K-F),pt=Math.abs(N-j);r.push(oi(e.direction,S<o*2?e.direction.x*(n+e.direction.x*o):S+o,x<o*2?e.direction.y*(a+e.direction.y*o):x+o)),r.push(oi(f,_t,pt))}else{const _t=Math.abs(K-F),pt=Math.abs(N-j);r.push(oi(g,n/2,a/2)),r.push(oi(e.direction,_t,pt)),r.push(oi(g,n/2,a/2))}else if(P){const _t=Math.abs(K-e.x),pt=Math.abs(N-e.y);r.push(oi(_,S<o*2?S-o:S/2,x<o*2?x-o:x/2)),r.push(oi(f,_t,pt)),r.push(oi(_,Math.max(o,S/2),Math.max(o,x/2)))}else if(C){const _t=Math.abs(F-i.x),pt=Math.abs(j-i.y);r.push(oi(i.direction,Math.max(o,S/2),Math.max(o,x/2))),r.push(oi(e.direction,_t,pt)),r.push(oi(i.direction,S<o*2?S-o:S/2,x<o*2?x-o:x/2))}return C&&r.push(O),r}function dh(i,e){const{x:o,y:r}=i.direction,{x:n,y:a}=e.direction,l=e.x-i.x,h=e.y-i.y;return o*a===n*r?!1:Math.sign(h)===Math.sign(r+a)!=(Math.sign(l)===Math.sign(o+n))}function oi(i,e,o){return{x:i.x*e,y:i.y*o}}function fh(i,e){return i.x===e.x&&i.y===e.y}function _h(i,e){const{width:o,height:r}=i,{top:n,left:a,right:l,bottom:h}=e,u=l-a,f=h-n;if(!u||!f)return{x:null,y:null,scale:null};const _=a+u/2,g=n+f/2,y=Math.min(o/u,r/f)*.8,k=o/2,P=r/2,C=k-_,S=P-g;return{x:C*y,y:S*y,scale:y}}const Po=(i,e,o)=>Math.min(Math.abs(i||e)/2,o);function Ko(i,e){const r=i.getTotalLength()*e;return i.getPointAtLength(r)}function mh(i,e,o,r){return so([i,e,o,r],([a,l,h,u])=>{const f={clientX:a.x,clientY:a.y};return Io(f,l.top,l.left,l.width,l.height,u,h)})}function ph(i,e,o,r){const n=nt({top:1/0,left:1/0,right:-1/0,bottom:-1/0}),a=nt({top:1/0,left:1/0,right:-1/0,bottom:-1/0});let l,h=Lt(e),u=Lt(o),f=Lt(r),_=h.width/u,g=h.height/u;function y(){const{x:P,y:C}=Io({clientX:h.left,clientY:h.top},h.top,h.left,h.width,h.height,u,f),S=Lt(a);n.set({top:Math.min(S.top,C),left:Math.min(S.left,P),right:Math.max(S.right,P+_),bottom:Math.max(S.bottom,g+C)})}function k(P=!1){let C=1/0,S=1/0,x=-1/0,z=-1/0;for(const O of i.getAll()){console.log("dentro del for, este es e node:",O);const{x:W,y:$}=Lt(O.position),Q=Lt(O.dimensions.width),rt=Lt(O.dimensions.height);S=Math.min(S,W),C=Math.min(C,$),x=Math.max(x,W+Q),z=Math.max(z,$+rt)}a.set({top:C,left:S,right:x,bottom:z}),y(),P&&(l=requestAnimationFrame(()=>k(P)))}return i.subscribe(()=>{console.log("dentro del nodes.subscribe...........Aqui no estan llegando los nodes"),k()}),rs.subscribe(P=>{P&&k(P),P||cancelAnimationFrame(l)}),ji.subscribe(P=>{P&&k(P),P||cancelAnimationFrame(l)}),e.subscribe(()=>{h=Lt(e),_=h.width/u,g=h.height/u,y()}),o.subscribe(()=>{u=Lt(o),_=h.width/u,g=h.height/u,y()}),r.subscribe(()=>{f=Lt(r),y()}),{graphBounds:n,nodeBounds:a}}function gh(i,e,o){const{width:r,height:n,top:a,left:l}=i,h={clientX:r/2,clientY:n/2};return Io(h,a,l,r,n,o,e)}function gl(i,e){const{zoom:o,editable:r,translation:n,direction:a,locked:l,edge:h,nodes:u}=e,f=nt({x:(n==null?void 0:n.x)||0,y:(n==null?void 0:n.y)||0}),_=nt({top:0,left:0,width:0,height:0,bottom:0,right:0}),g=nt(o),y=nt(!1),k=xo(),P=ph(k,_,g,f),C=so([_,f,g],([x,z,O])=>gh(x,z,O));return{id:i,nodes:k,edges:Vc(),transforms:{translation:f,scale:g},maxZIndex:nt(2),dimensions:_,bounds:P,center:C,mounted:y,direction:a||"LR",editable:r||!1,edge:h||null,editing:nt(null),cursor:mh(_l,_,f,g),locked:nt(l||!1),groups:nt({selected:{parent:nt(null),nodes:nt(new Set)},hidden:{parent:nt(null),nodes:nt(new Set)}}),groupBoxes:xo(),activeGroup:nt(null),initialNodePositions:nt([])}}const Jo=xo(),Eo={width:200,height:100};function So(i,e){return{x:Math.round(i/Eo.width)*Eo.width,y:Math.round(e/Eo.height)*Eo.height}}const Co=10;function vl(i){const e=Lt(i);return Array.from(e).map(r=>Lt(r.position))}function vh(i,e){console.log("moveNodes called");let o;const r=Lt(i.groups),n=Lt(i.activeGroup);if(console.log("Graph Groups:",r),console.log("Active Group:",n),!n)return;const a=r[n].nodes;if(!a)return;const l=Lt(i.initialNodePositions),{x:h,y:u}=Lt(Gi),f=Array.from(Lt(a)),_=Lt(i.groupBoxes);console.log("Group Boxes:",_),f.forEach(y=>y.moving.set(!0)),g();function g(){const y=Lt(i.cursor);let k=y.x-h,P=y.y-u;if(e){const S=So(k,P);k=S.x,P=S.y}const C={x:k,y:P};f.forEach((S,x)=>{const{group:z,position:O}=S,W=l[x];let $;if(n==="selected"){const Q=Lt(z);Q&&($=_.get(Q))}if(!$)yh(W,C,O);else{const Q=Lt(S.dimensions.width),rt=Lt(S.dimensions.height),ot=bl($,Q,rt);yl(W,C,O,ot)}}),Lt(ji)?o=requestAnimationFrame(g):cancelAnimationFrame(o)}}function yh(i,e,o){o.set({x:i.x+e.x,y:i.y+e.y})}function yl(i,e,o,r){o.set({x:Math.min(Math.max(r.left,i.x+e.x),r.right),y:Math.min(Math.max(r.top,i.y+e.y),r.bottom)})}function bl(i,e,o){const{x:r,y:n}=Lt(i.position);return console.log("Group Box Position:",{x:r,y:n}),{left:r+Co,right:r+Lt(i.dimensions.width)-e-Co,top:n+Co,bottom:n+Lt(i.dimensions.height)-o-Co}}function tr(i=1,e,o,r=.1){const n=Lt(e),{width:a,height:l,top:h,left:u}=n,f=o.scale,_=Lt(o.translation),g=Lt(f),y=pl(g,i,r),k=ml(g,y,_,{x:a/2+u,y:l/2+h},n);f.set(y),o.translation.set(k)}function bh(i,e,o,r,n,a,l,h,u,f,_,g){const{width:y,height:k}=n,{x:P,y:C}=r,S=Lt(e.position),x=nt({x:P-S.x+y/2,y:C-S.y+k/2}),z=so([e.position,x],([tt,at])=>({x:tt.x+at.x,y:tt.y+at.y})),O=i.transforms,W=i.dimensions,$=nt(u||"self"),Q=()=>{const tt=document.getElementById(o),at=Lt($),K=io[at];if(!tt)return;const{x:N,y:F,width:j,height:_t}=tt.getBoundingClientRect(),pt=Lt(x),X=Lt(z),{scaled:q,scale:Dt}=lh(W,O,{x:N,y:F}),ut=q.x-X.x,wt=q.y-X.y;x.set({x:pt.x+ut+j/Dt/2+K.x*j/Dt/2,y:pt.y+wt+_t/Dt/2+K.y*_t/Dt/2})},rt=so([e.moving,e.resizingWidth,e.resizingHeight,e.rotating],([tt,at,K,N])=>tt||at||K||N),ot=so([e.rotation],([tt])=>tt);return{id:o,position:z,offset:x,direction:$,dynamic:nt(f||!1),type:h,edge:l,moving:rt,mounted:nt(!1),recalculatePosition:Q,connected:nt(new Set),store:a||null,inputKey:_||null,edgeColor:g||nt(null),rotation:ot,node:e}}function wh(i){var r,n;const e=JSON.parse(i);return gl(e.id,{...e,editable:e.editable,direction:e.direction,locked:e.locked,zoom:((r=e.transforms)==null?void 0:r.scale)??1,translation:((n=e.transforms)==null?void 0:n.translation)??{x:0,y:0},edge:e.edge})}function Lh(i){let e;const o=i[2].default,r=Ee(o,i,i[1],null);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,[a]){r&&r.p&&(!e||a&2)&&Te(r,o,n,n[1],e?Ce(o,n[1],a,null):Se(n[1]),null)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function kh(i,e,o){let{$$slots:r={},$$scope:n}=e,{edge:a}=e;return xe("edge",a),i.$$set=l=>{"edge"in l&&o(0,a=l.edge),"$$scope"in l&&o(1,n=l.$$scope)},[a,n,r]}class wl extends Mi{constructor(e){super(),ki(this,e,kh,Lh,ui,{edge:0})}}const Mh=i=>({hovering:i[0]&32768}),er=i=>({destroy:i[9],hovering:i[15]}),Ph=i=>({path:i[0]&4096,hovering:i[0]&32768}),ir=i=>({path:i[12],destroy:i[9],hovering:i[15]});function Eh(i){let e,o,r,n,a,l=(i[0]||i[1])&&nr(i);const h=i[91].default,u=Ee(h,i,i[90],ir),f=u||Ch(i);let _=i[10]&&or(i);return{c(){e=Jt("svg"),l&&l.c(),o=Jt("path"),f&&f.c(),_&&_.c(),p(o,"role","presentation"),p(o,"id",i[38]+"-target"),p(o,"class","target svelte-ppcocz"),p(o,"d",i[12]),jt(o,"cursor",i[38]==="cursor"||!i[4]&&!i[3]),lt(o,"cursor",i[4]||i[15]?"pointer":"move"),lt(o,"--prop-target-edge-color",i[4]||i[15]?i[8]||null:"transparent"),p(e,"class","edges-wrapper svelte-ppcocz"),lt(e,"z-index",i[17])},m(g,y){J(g,e,y),l&&l.m(e,null),w(e,o),i[94](o),f&&f.m(e,null),_&&_.m(e,null),i[95](e),r=!0,n||(a=[ft(o,"mousedown",function(){lo(i[4])&&i[4].apply(this,arguments)}),ft(o,"mouseenter",i[92]),ft(o,"mouseleave",i[93])],n=!0)},p(g,y){i=g,i[0]||i[1]?l?l.p(i,y):(l=nr(i),l.c(),l.m(e,o)):l&&(l.d(1),l=null),(!r||y[0]&4096)&&p(o,"d",i[12]),(!r||y[0]&24|y[1]&128)&&jt(o,"cursor",i[38]==="cursor"||!i[4]&&!i[3]),y[0]&32784&&lt(o,"cursor",i[4]||i[15]?"pointer":"move"),y[0]&33040&&lt(o,"--prop-target-edge-color",i[4]||i[15]?i[8]||null:"transparent"),u?u.p&&(!r||y[0]&36864|y[2]&268435456)&&Te(u,h,i,i[90],r?Ce(h,i[90],y,Ph):Se(i[90]),ir):f&&f.p&&(!r||y[0]&1052711)&&f.p(i,r?y:[-1,-1,-1,-1]),i[10]?_?(_.p(i,y),y[0]&1024&&B(_,1)):(_=or(i),_.c(),B(_,1),_.m(e,null)):_&&(we(),U(_,1,1,()=>{_=null}),Le()),y[0]&131072&&lt(e,"z-index",i[17])},i(g){r||(B(f,g),B(_),r=!0)},o(g){U(f,g),U(_),r=!1},d(g){g&&Y(e),l&&l.d(),i[94](null),f&&f.d(g),_&&_.d(),i[95](null),n=!1,si(a)}}}function nr(i){let e,o,r,n,a;return{c(){e=Jt("defs"),o=Jt("marker"),r=Jt("polygon"),n=Jt("marker"),a=Jt("polygon"),p(r,"class","arrow svelte-ppcocz"),p(r,"points","0 0, 15 5, 0 10"),lt(r,"--prop-edge-color",i[20]),p(o,"id",i[38]+"-end-arrow"),p(o,"viewBox","0 0 15 15"),p(o,"markerWidth","15"),p(o,"markerHeight","10"),p(o,"refX","12.5"),p(o,"refY","5"),p(o,"orient","auto"),p(a,"class","arrow svelte-ppcocz"),p(a,"points","0 5, 15 0, 15 10"),lt(a,"--prop-edge-color",i[20]),p(n,"id",i[38]+"-start-arrow"),p(n,"viewBox","0 0 15 15"),p(n,"markerWidth","15"),p(n,"markerHeight","10"),p(n,"refX","0"),p(n,"refY","5"),p(n,"orient","auto")},m(l,h){J(l,e,h),w(e,o),w(o,r),w(e,n),w(n,a)},p(l,h){h[0]&1048576&&lt(r,"--prop-edge-color",l[20]),h[0]&1048576&&lt(a,"--prop-edge-color",l[20])},d(l){l&&Y(e)}}}function Ch(i){let e,o,r;return{c(){e=Jt("path"),p(e,"id",i[38]),p(e,"class","edge svelte-ppcocz"),p(e,"d",i[12]),p(e,"marker-end",o=i[1]==="arrow"?`url(#${i[38]+"-end-arrow"})`:""),p(e,"marker-start",r=i[0]==="arrow"?`url(#${i[38]+"-start-arrow"})`:""),jt(e,"animate",i[2]),lt(e,"--prop-edge-color",i[20]),lt(e,"--prop-stroke-width",i[5]?i[5]+"px":null)},m(n,a){J(n,e,a)},p(n,a){a[0]&4096&&p(e,"d",n[12]),a[0]&2&&o!==(o=n[1]==="arrow"?`url(#${n[38]+"-end-arrow"})`:"")&&p(e,"marker-end",o),a[0]&1&&r!==(r=n[0]==="arrow"?`url(#${n[38]+"-start-arrow"})`:"")&&p(e,"marker-start",r),a[0]&4&&jt(e,"animate",n[2]),a[0]&1048576&&lt(e,"--prop-edge-color",n[20]),a[0]&32&&lt(e,"--prop-stroke-width",n[5]?n[5]+"px":null)},d(n){n&&Y(e)}}}function or(i){let e,o,r,n,a;const l=i[91].label,h=Ee(l,i,i[90],er),u=h||Th(i);return{c(){e=Jt("foreignObject"),o=T("span"),u&&u.c(),p(o,"class","label-wrapper svelte-ppcocz"),p(e,"x",r=i[14].x),p(e,"y",n=i[14].y),p(e,"width","100%"),p(e,"height","100%"),p(e,"class","svelte-ppcocz")},m(f,_){J(f,e,_),w(e,o),u&&u.m(o,null),a=!0},p(f,_){h?h.p&&(!a||_[0]&32768|_[2]&268435456)&&Te(h,l,f,f[90],a?Ce(l,f[90],_,Mh):Se(f[90]),er):u&&u.p&&(!a||_[0]&2240)&&u.p(f,a?_:[-1,-1,-1,-1]),(!a||_[0]&16384&&r!==(r=f[14].x))&&p(e,"x",r),(!a||_[0]&16384&&n!==(n=f[14].y))&&p(e,"y",n)},i(f){a||(B(u,f),a=!0)},o(f){U(u,f),a=!1},d(f){f&&Y(e),u&&u.d(f)}}}function Th(i){let e,o;return{c(){e=T("div"),o=Re(i[11]),p(e,"class","default-label svelte-ppcocz"),lt(e,"--prop-label-color",i[6]),lt(e,"--prop-label-text-color",i[7])},m(r,n){J(r,e,n),w(e,o)},p(r,n){n[0]&2048&&pi(o,r[11]),n[0]&64&&lt(e,"--prop-label-color",r[6]),n[0]&128&&lt(e,"--prop-label-text-color",r[7])},d(r){r&&Y(e)}}}function Sh(i){let e,o,r=i[23]&&i[24]&&Eh(i);return{c(){r&&r.c(),e=De()},m(n,a){r&&r.m(n,a),J(n,e,a),o=!0},p(n,a){n[23]&&n[24]&&r.p(n,a)},i(n){o||(B(r),o=!0)},o(n){U(r),o=!1},d(n){n&&Y(e),r&&r.d(n)}}}let Qo;function Dh(i){const e=i.parentNode;if(!e)return;e.removeChild(i);const o=document.querySelector(".svelvet-graph-wrapper");o&&o.appendChild(i)}function xh(i,e,o){var Ji,rn;let r,n,a,l,h,u,f,_,g,y,k,P,C,S,x,z,O,W,$,Q,rt,ot,tt,at,K,N,F,j,_t,pt,X,q,Dt=Ft,ut=()=>(Dt(),Dt=mi(_t,vt=>o(73,q=vt)),_t),wt,It=Ft,ht=()=>(It(),It=mi(j,vt=>o(74,wt=vt)),j),Z,et,G,it,Xt,me,gt,zt,Nt,bt,Kt,oe,pe,st,se=Ft,Ot=()=>(se(),se=mi(a,vt=>o(88,st=vt)),a),Bt,Gt=Ft,ee=()=>(Gt(),Gt=mi(n,vt=>o(89,Bt=vt)),n);i.$$.on_destroy.push(()=>Dt()),i.$$.on_destroy.push(()=>It()),i.$$.on_destroy.push(()=>se()),i.$$.on_destroy.push(()=>Gt());let{$$slots:he={},$$scope:Je}=e;const Ze=hs(he),qt=_e("edgeStore"),He=_e("edgeStyle"),Ve=_e("endStyles"),ze=_e("raiseEdgesOnSelect"),Vt=_e("edgesAboveNode");let{edge:ue=_e("edge")}=e,{straight:ve=He==="straight"}=e,{step:Qt=He==="step"}=e,{start:Ye=Ve[0]}=e,{end:di=Ve[1]}=e,{animate:ri=!1}=e,{label:Ie=""}=e,{enableHover:Zt=!1}=e,{edgeClick:Me=null}=e,{labelPosition:Qe=.5}=e,{width:fi=null}=e,{color:ai=null}=e,{labelColor:qe=null}=e,{textColor:Oe=null}=e,{cornerRadius:Ae=8}=e,{targetColor:li=null}=e;const $t=ue.source,ie=ue.target,ii=$t.direction;yt(i,ii,vt=>o(76,et=vt));const ni=ie.direction;yt(i,ni,vt=>o(75,Z=vt));const $e=$t.rotation;yt(i,$e,vt=>o(83,Nt=vt));const Ei=ie.rotation;yt(i,Ei,vt=>o(82,zt=vt));const Bi=$t.position;yt(i,Bi,vt=>o(87,pe=vt));const Ue=ie.position;yt(i,Ue,vt=>o(86,oe=vt));const kt=$t.dynamic;yt(i,kt,vt=>o(79,Xt=vt));const gi=ie.dynamic;yt(i,gi,vt=>o(78,it=vt));const ci=$t.moving;yt(i,ci,vt=>o(81,gt=vt));const ti=ie.moving;yt(i,ti,vt=>o(80,me=vt));const vi=(Ji=$t.node)==null?void 0:Ji.position;yt(i,vi,vt=>o(85,Kt=vt));const b=(rn=ie.node)==null?void 0:rn.position;yt(i,b,vt=>o(84,bt=vt));const mt=ue.type;yt(i,mt,vt=>o(77,G=vt));const Et=ue.id;let Pt,xt,A={x:0,y:0},Yt=!1,de=!1,te=!1,ge=!1,Xe=!1,We;ue.rendered.set(!0),Ki(()=>{setTimeout(()=>{xt&&o(14,A=Ko(xt,Qe))},0),Dh(We)}),rl(()=>{xt&&o(14,A=Ko(xt,Qe))}),co(()=>{We.remove(),cancelAnimationFrame(Qo)});function Ci(){Yt&&(xt&&o(14,A=Ko(xt,Qe)),Qo=requestAnimationFrame(Ci))}function Pi(){if($t.id===null||ie.id===null)return;const vt=qt.match($t,ie);qt.delete(vt[0]),$t==null||$t.connected.update(Rt=>(ie&&Rt.delete(ie),Rt)),ie==null||ie.connected.update(Rt=>($t&&Rt.delete($t),Rt))}const sn=()=>o(15,Xe=!0),Vi=()=>o(15,Xe=!1);function xi(vt){on[vt?"unshift":"push"](()=>{xt=vt,o(13,xt)})}function Ti(vt){on[vt?"unshift":"push"](()=>{We=vt,o(16,We)})}return i.$$set=vt=>{"edge"in vt&&o(39,ue=vt.edge),"straight"in vt&&o(40,ve=vt.straight),"step"in vt&&o(41,Qt=vt.step),"start"in vt&&o(0,Ye=vt.start),"end"in vt&&o(1,di=vt.end),"animate"in vt&&o(2,ri=vt.animate),"label"in vt&&o(42,Ie=vt.label),"enableHover"in vt&&o(3,Zt=vt.enableHover),"edgeClick"in vt&&o(4,Me=vt.edgeClick),"labelPosition"in vt&&o(43,Qe=vt.labelPosition),"width"in vt&&o(5,fi=vt.width),"color"in vt&&o(44,ai=vt.color),"labelColor"in vt&&o(6,qe=vt.labelColor),"textColor"in vt&&o(7,Oe=vt.textColor),"cornerRadius"in vt&&o(45,Ae=vt.cornerRadius),"targetColor"in vt&&o(8,li=vt.targetColor),"$$scope"in vt&&o(90,Je=vt.$$scope)},i.$$.update=()=>{var vt;if(i.$$.dirty[2]&196608&&o(55,r=Xt||it),i.$$.dirty[1]&256&&Ot(o(21,a=(vt=ue.label)==null?void 0:vt.text)),i.$$.dirty[1]&8192|i.$$.dirty[2]&134217728&&o(20,l=ai||Bt||null),i.$$.dirty[1]&2048|i.$$.dirty[2]&67108864&&o(11,h=Ie||st||""),i.$$.dirty[0]&2048&&o(10,u=h||Ze.label),i.$$.dirty[2]&33554432&&o(72,f=pe),i.$$.dirty[2]&16777216&&o(71,_=oe),i.$$.dirty[2]&8388608&&o(56,g=Kt),i.$$.dirty[2]&4194304&&o(57,y=bt),i.$$.dirty[2]&1024&&o(52,k=f.x),i.$$.dirty[2]&1024&&o(51,P=f.y),i.$$.dirty[2]&512&&o(54,C=_.x),i.$$.dirty[2]&512&&o(53,S=_.y),i.$$.dirty[1]&10485760&&o(70,x=C-k),i.$$.dirty[1]&5242880&&o(69,z=S-P),i.$$.dirty[2]&256&&o(68,O=Math.abs(x)),i.$$.dirty[2]&128&&o(67,W=Math.abs(z)),i.$$.dirty[2]&64&&o(65,$=Math.max(30,Math.min(600,O/2))),i.$$.dirty[2]&32&&o(63,Q=Math.max(30,Math.min(600,W/2))),i.$$.dirty[1]&117833728&&r&&$t.node&&ie.node){const Rt=y.x-g.x,ne=y.y-g.y;o(48,te=ne>0),o(49,ge=Rt>0);let _i,zi;if(te){const Fe=Lt($t.node.dimensions.height),fe=g.y+Fe;_i=y.y-fe}else{const Fe=Lt(ie.node.dimensions.height),fe=y.y+Fe;_i=g.y-fe}if(ge){const Fe=Lt($t.node.dimensions.width),fe=g.x+Fe;zi=y.x-fe}else{const Fe=Lt(ie.node.dimensions.width),fe=y.x+Fe;zi=g.x-fe}o(47,de=_i>zi)}if(i.$$.dirty[1]&17235968|i.$$.dirty[2]&196608&&r){let Rt,ne;de?(Rt=te?"south":"north",ne=te?"north":"south"):(Rt=ge?"east":"west",ne=ge?"west":"east"),Xt&&At(ii,et=Rt,et),it&&At(ni,Z=ne,Z)}if(i.$$.dirty[2]&2113536&&o(66,rt=$s(io[et],Nt||0)),i.$$.dirty[2]&1056768&&o(64,ot=$s(io[Z],zt||0)),i.$$.dirty[1]&2097152|i.$$.dirty[2]&24&&o(62,tt=k+rt.x*$),i.$$.dirty[1]&1048576|i.$$.dirty[2]&18&&o(61,at=P+rt.y*Q),i.$$.dirty[1]&8388608|i.$$.dirty[2]&12&&o(60,K=C+ot.x*$),i.$$.dirty[1]&4194304|i.$$.dirty[2]&6&&o(59,N=S+ot.y*Q),i.$$.dirty[1]&1879048192|i.$$.dirty[2]&1&&o(58,F=`C ${tt}, ${at} ${K}, ${N}`),i.$$.dirty[1]&149947904|i.$$.dirty[2]&32768&&(!Qt||Et==="cursor"||G==="bezier")&&o(12,Pt=`M ${k}, ${P} ${ve?"":F} ${C}, ${S}`),i.$$.dirty[0]&1024|i.$$.dirty[1]&32768|i.$$.dirty[2]&786432&&(u&&!Yt&&(gt||me||Et==="cursor")?(o(46,Yt=!0),Ci()):Yt&&!gt&&!me&&Et!=="cursor"&&(o(46,Yt=!1),cancelAnimationFrame(Qo))),i.$$.dirty[1]&15746048|i.$$.dirty[2]&57344&&Qt&&Et!=="cursor"&&!(G&&G==="bezier")){const Rt={x:k,y:P,direction:io[et]},ne={x:C,y:S,direction:io[Z]},_i=uh(Rt,ne,Wc),zi=(Fe,fe,Ht)=>{if(fe<_i.length-1){const ye=nh(Fe,_i[fe+1]);return oh(Ht,ye)}return""};o(12,Pt=_i.reduce((Fe,fe,Ht)=>{const ye=Math.sign(fe.x),hn=Math.sign(fe.y);let Ai=fe.x,yi=fe.y,Qi="";if(Ae){const qi=_i[Ht+1]||{x:0,y:0},Ni=_i[Ht-1]||{x:0,y:0},Ne=Po(fe.x,qi.x,Ae),je=Po(qi.y,fe.y,Ae),Yi=Po(Ni.x,fe.x,Ae),$i=Po(Ni.y,fe.y,Ae),Ri=Math.min(Yi,$i),Ke=Math.min(Ne,je);fe.x?Ai=fe.x-(Ke+Ri)*ye:yi=fe.y-(Ke+Ri)*hn,Qi=zi(fe,Ht,Ke)}return sh(Fe,Ai,yi,Qi)},`M ${k}, ${P}`))}i.$$.dirty[2]&6144&&o(50,pt=Math.max(wt,q)),i.$$.dirty[1]&524288|i.$$.dirty[2]&6144&&o(17,X=Vt==="all"?1e5:Vt?pt:ze===!0?pt-1:ze==="source"?wt-1:ze==="target"?q-1:0)},ee(o(22,n=($t==null?void 0:$t.edgeColor)||(ie==null?void 0:ie.edgeColor)||null)),ht(o(19,j=$t.node.zIndex||0)),ut(o(18,_t=ie.node.zIndex||0)),[Ye,di,ri,Zt,Me,fi,qe,Oe,li,Pi,u,h,Pt,xt,A,Xe,We,X,_t,j,l,a,n,$t,ie,ii,ni,$e,Ei,Bi,Ue,kt,gi,ci,ti,vi,b,mt,Et,ue,ve,Qt,Ie,Qe,ai,Ae,Yt,de,te,ge,pt,P,k,S,C,r,g,y,F,N,K,at,tt,Q,ot,$,rt,W,O,z,x,_,f,q,wt,Z,et,G,it,Xt,me,gt,zt,Nt,bt,Kt,oe,pe,st,Bt,Je,he,sn,Vi,xi,Ti]}class Ll extends Mi{constructor(e){super(),ki(this,e,xh,Sh,ui,{edge:39,straight:40,step:41,start:0,end:1,animate:2,label:42,enableHover:3,edgeClick:4,labelPosition:43,width:5,color:44,labelColor:6,textColor:7,cornerRadius:45,targetColor:8,destroy:9},null,[-1,-1,-1,-1])}get destroy(){return this.$$.ctx[9]}}function zh(i){let e;return{c(){e=T("div"),p(e,"class","svelvet-anchor svelte-19t6skv"),jt(e,"output",i[0]),jt(e,"input",i[1]),jt(e,"connected",i[3]),jt(e,"connecting",i[2]),jt(e,"hovering",i[4]),lt(e,"--prop-anchor-color",i[5])},m(o,r){J(o,e,r)},p(o,[r]){r&1&&jt(e,"output",o[0]),r&2&&jt(e,"input",o[1]),r&8&&jt(e,"connected",o[3]),r&4&&jt(e,"connecting",o[2]),r&16&&jt(e,"hovering",o[4]),r&32&&lt(e,"--prop-anchor-color",o[5])},i:Ft,o:Ft,d(o){o&&Y(e)}}}function Ih(i,e,o){let{output:r}=e,{input:n}=e,{connecting:a}=e,{connected:l}=e,{hovering:h}=e,{bgColor:u}=e;return i.$$set=f=>{"output"in f&&o(0,r=f.output),"input"in f&&o(1,n=f.input),"connecting"in f&&o(2,a=f.connecting),"connected"in f&&o(3,l=f.connected),"hovering"in f&&o(4,h=f.hovering),"bgColor"in f&&o(5,u=f.bgColor)},[r,n,a,l,h,u]}class Oh extends Mi{constructor(e){super(),ki(this,e,Ih,zh,ui,{output:0,input:1,connecting:2,connected:3,hovering:4,bgColor:5})}}const Ah=i=>({}),sr=i=>({});function rr(i){const e=i.slice(),o=e[7].component;return e[86]=o,e}function $o(i){const e=i.slice(),o=e[14].get("cursor");return e[7]=o,e}function ar(i,e,o){const r=i.slice();r[87]=e[o];const n=r[14].fetch(r[23],r[87]);return r[7]=n,r}const Nh=i=>({}),lr=i=>({});function ts(i){const e=i.slice(),o=e[7].component;return e[86]=o,e}const Bh=i=>({linked:i[0]&512,hovering:i[0]&1024,connecting:i[0]&2048}),cr=i=>{var e;return{linked:((e=i[9])==null?void 0:e.size)>=1,hovering:i[10],connecting:i[11]}};function hr(i){var r;let e,o;return e=new Oh({props:{output:i[2],input:i[1],connecting:i[11],hovering:i[10],bgColor:i[0],connected:((r=i[9])==null?void 0:r.size)>=1}}),{c(){ce(e.$$.fragment)},m(n,a){re(e,n,a),o=!0},p(n,a){var h;const l={};a[0]&4&&(l.output=n[2]),a[0]&2&&(l.input=n[1]),a[0]&2048&&(l.connecting=n[11]),a[0]&1024&&(l.hovering=n[10]),a[0]&1&&(l.bgColor=n[0]),a[0]&512&&(l.connected=((h=n[9])==null?void 0:h.size)>=1),e.$set(l)},i(n){o||(B(e.$$.fragment,n),o=!0)},o(n){U(e.$$.fragment,n),o=!1},d(n){ae(e,n)}}}function Rh(i){let e,o,r=!i[5]&&hr(i);return{c(){r&&r.c(),e=De()},m(n,a){r&&r.m(n,a),J(n,e,a),o=!0},p(n,a){n[5]?r&&(we(),U(r,1,1,()=>{r=null}),Le()):r?(r.p(n,a),a[0]&32&&B(r,1)):(r=hr(n),r.c(),B(r,1),r.m(e.parentNode,e))},i(n){o||(B(r),o=!0)},o(n){U(r),o=!1},d(n){n&&Y(e),r&&r.d(n)}}}function ur(i){let e,o;return e=new wl({props:{edge:i[7],$$slots:{default:[Gh]},$$scope:{ctx:i}}}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},p(r,n){const a={};n[0]&512&&(a.edge=r[7]),n[0]&512|n[1]&8388608&&(a.$$scope={dirty:n,ctx:r}),e.$set(a)},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Zh(i){let e,o;return e=new Ll({}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Hh(i){let e,o;return e=new i[86]({}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Fh(i){let e,o,r,n;const a=[Hh,Zh],l=[];function h(u,f){return u[86]?0:1}return e=h(i),o=l[e]=a[e](i),{c(){o.c(),r=De()},m(u,f){l[e].m(u,f),J(u,r,f),n=!0},p(u,f){let _=e;e=h(u),e!==_&&(we(),U(l[_],1,1,()=>{l[_]=null}),Le(),o=l[e],o||(o=l[e]=a[e](u),o.c()),B(o,1),o.m(r.parentNode,r))},i(u){n||(B(o),n=!0)},o(u){U(o),n=!1},d(u){u&&Y(r),l[e].d(u)}}}function Gh(i){let e;const o=i[50].edge,r=Ee(o,i,i[54],lr),n=r||Fh(i);return{c(){n&&n.c()},m(a,l){n&&n.m(a,l),e=!0},p(a,l){r?r.p&&(!e||l[1]&8388608)&&Te(r,o,a,a[54],e?Ce(o,a[54],l,Nh):Se(a[54]),lr):n&&n.p&&(!e||l[0]&512)&&n.p(a,e?l:[-1,-1,-1])},i(a){e||(B(n,a),e=!0)},o(a){U(n,a),e=!1},d(a){n&&n.d(a)}}}function dr(i,e){let o,r,n,a=e[7]&&e[7].source===e[23]&&ur(ts(e));return{key:i,first:null,c(){o=De(),a&&a.c(),r=De(),this.first=o},m(l,h){J(l,o,h),a&&a.m(l,h),J(l,r,h),n=!0},p(l,h){e=l,e[7]&&e[7].source===e[23]?a?(a.p(ts(e),h),h[0]&512&&B(a,1)):(a=ur(ts(e)),a.c(),B(a,1),a.m(r.parentNode,r)):a&&(we(),U(a,1,1,()=>{a=null}),Le())},i(l){n||(B(a),n=!0)},o(l){U(a),n=!1},d(l){l&&(Y(o),Y(r)),a&&a.d(l)}}}function fr(i){let e,o,r=i[7]&&qh(rr(i));return{c(){r&&r.c(),e=De()},m(n,a){r&&r.m(n,a),J(n,e,a),o=!0},p(n,a){n[7]&&r.p(rr(n),a)},i(n){o||(B(r),o=!0)},o(n){U(r),o=!1},d(n){n&&Y(e),r&&r.d(n)}}}function qh(i){let e,o;return e=new wl({props:{edge:i[7],$$slots:{default:[Vh]},$$scope:{ctx:i}}}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},p(r,n){const a={};n[1]&8388608&&(a.$$scope={dirty:n,ctx:r}),e.$set(a)},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Uh(i){let e,o;return e=new Ll({}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Wh(i){let e,o;return e=new i[86]({}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function jh(i){let e,o,r,n;const a=[Wh,Uh],l=[];function h(u,f){return u[86]?0:1}return e=h(i),o=l[e]=a[e](i),{c(){o.c(),r=De()},m(u,f){l[e].m(u,f),J(u,r,f),n=!0},p:Ft,i(u){n||(B(o),n=!0)},o(u){U(o),n=!1},d(u){u&&Y(r),l[e].d(u)}}}function Vh(i){let e;const o=i[50].edge,r=Ee(o,i,i[54],sr),n=r||jh(i);return{c(){n&&n.c()},m(a,l){n&&n.m(a,l),e=!0},p(a,l){r&&r.p&&(!e||l[1]&8388608)&&Te(r,o,a,a[54],e?Ce(o,a[54],l,Ah):Se(a[54]),sr)},i(a){e||(B(n,a),e=!0)},o(a){U(n,a),e=!1},d(a){n&&n.d(a)}}}function Yh(i){let e,o,r,n=[],a=new Map,l,h,u,f,_;const g=i[50].default,y=Ee(g,i,i[54],cr),k=y||Rh(i);let P=ke(Array.from(i[9]));const C=x=>x[87].id;for(let x=0;x<P.length;x+=1){let z=ar(i,P,x),O=C(z);a.set(O,n[x]=dr(O,z))}let S=i[11]&&fr($o(i));return{c(){var x;e=T("div"),k&&k.c(),r=V();for(let z=0;z<n.length;z+=1)n[z].c();l=V(),S&&S.c(),h=De(),p(e,"id",(x=i[23])==null?void 0:x.id),p(e,"class","anchor-wrapper svelte-bazd6o"),p(e,"role","button"),p(e,"tabindex","0"),p(e,"title",o=i[6]||""),jt(e,"locked",i[4])},m(x,z){J(x,e,z),k&&k.m(e,null),i[53](e),J(x,r,z);for(let O=0;O<n.length;O+=1)n[O]&&n[O].m(x,z);J(x,l,z),S&&S.m(x,z),J(x,h,z),u=!0,f||(_=[ft(e,"mouseenter",i[51]),ft(e,"mouseleave",i[52]),ft(e,"mousedown",nn(Xi(i[25]))),ft(e,"mouseup",nn(i[24])),ft(e,"touchstart",nn(Xi(i[25]))),ft(e,"touchend",nn(i[24]))],f=!0)},p(x,z){y?y.p&&(!u||z[0]&3584|z[1]&8388608)&&Te(y,g,x,x[54],u?Ce(g,x[54],z,Bh):Se(x[54]),cr):k&&k.p&&(!u||z[0]&3623)&&k.p(x,u?z:[-1,-1,-1]),(!u||z[0]&64&&o!==(o=x[6]||""))&&p(e,"title",o),(!u||z[0]&16)&&jt(e,"locked",x[4]),z[0]&8405504|z[1]&8388608&&(P=ke(Array.from(x[9])),we(),n=wn(n,z,C,1,x,P,a,l.parentNode,ao,dr,l,ar),Le()),x[11]?S?(S.p($o(x),z),z[0]&2048&&B(S,1)):(S=fr($o(x)),S.c(),B(S,1),S.m(h.parentNode,h)):S&&(we(),U(S,1,1,()=>{S=null}),Le())},i(x){if(!u){B(k,x);for(let z=0;z<P.length;z+=1)B(n[z]);B(S),u=!0}},o(x){U(k,x);for(let z=0;z<n.length;z+=1)U(n[z]);U(S),u=!1},d(x){x&&(Y(e),Y(r),Y(l),Y(h)),k&&k.d(x),i[53](null);for(let z=0;z<n.length;z+=1)n[z].d(x);S&&S.d(x),f=!1,si(_)}}}let es;const mn=nt(null);function Xh(i,e,o){if(e==="self")return;const r=i.parentNode;if(!r)return;r.removeChild(i);const n=document.querySelector(`#anchors-${e}-${o.id}`);n&&(n.appendChild(i),i&&o.recalculateAnchors())}function Kh(i,e,o){let r,n,a,l,h=Ft,u=()=>(h(),h=mi(gt,b=>o(55,l=b)),gt),f,_=Ft,g,y,k=Ft,P=()=>(k(),k=mi(n,b=>o(9,y=b)),n),C,S,x,z,O=Ft,W=()=>(O(),O=mi(a,b=>o(47,z=b)),a),$,Q,rt,ot;yt(i,mn,b=>o(42,f=b)),i.$$.on_destroy.push(()=>h()),i.$$.on_destroy.push(()=>_()),i.$$.on_destroy.push(()=>k()),i.$$.on_destroy.push(()=>O());let{$$slots:tt={},$$scope:at}=e;const K=_e("dynamic"),N=_e("node"),F=_e("edgeStore"),j=_e("cursorAnchor"),_t=_e("direction"),pt=_e("mounted");yt(i,pt,b=>o(49,Q=b));const X=_e("graph"),q=_e("nodeStore"),Dt=_e("graphEdge"),ut=_e("nodeConnectEvent");yt(i,ut,b=>o(43,g=b));const wt=_e("anchorsMounted");yt(i,wt,b=>o(56,rt=b));const It=_e("flowchart")||void 0;let{bgColor:ht=null}=e,{id:Z=0}=e,{input:et=!1}=e,{output:G=!1}=e,{multiple:it=G?!0:!et}=e,{dynamic:Xt=K||!1}=e,{edge:me=null}=e,{inputsStore:gt=null}=e;u();let{key:zt=null}=e,{outputStore:Nt=null}=e,{connections:bt=[]}=e,{edgeColor:Kt=nt(null)}=e,{edgeLabel:oe=""}=e,{locked:pe=!1}=e,{nodeConnect:st=!1}=e,{edgeStyle:se=null}=e,{endStyles:Ot=[null,null]}=e,{invisible:Bt=!1}=e,{direction:Gt=_t==="TD"?et?"north":"south":et?"west":"east"}=e,{title:ee=""}=e;const he=Yn(),Je=Yn();let Ze,qt=!1,He=!1,Ve=0,ze=et===G?null:et?"input":"output",Vt=[];const ue=N.edge,ve=N.anchors;yt(i,ve,b=>o(48,$=b));const Qt=N.resizingWidth;yt(i,Qt,b=>o(46,x=b));const Ye=N.resizingHeight;yt(i,Ye,b=>o(45,S=b));const di=N.rotating;yt(i,di,b=>o(44,C=b));const ri=N.connections;yt(i,ri,b=>o(57,ot=b));const Ie=`A-${Z||ve.count()+1}/${N.id}`,Zt=bh(X,N,Ie,{x:0,y:0},{width:0,height:0},gt||Nt||null,me||ue||Dt||null,ze,Gt,Xt,zt,Kt);ve.add(Zt,Zt.id),Ki(()=>{Ze&&Zt.recalculatePosition();const b=Array.from(Lt(N.anchors)).reduce((mt,[,Et])=>(Et.type==="output"&&mt++,mt),0);if(ot!=null&&ot.length&&!et){const mt=[];let Et=null;ot.forEach((Pt,xt)=>{Pt&&(Et===null&&(Et=xt),(xt-Et)%b===0?(Vt.push(Pt),mt.push(null)):mt.push(Pt))}),At(ri,ot=mt,ot)}At(wt,rt++,rt)}),rl(()=>{Ze&&Zt.recalculatePosition()}),co(()=>{$e(),cancelAnimationFrame(es)});function Me(b){var de;F.delete("cursor");const mt={x:b.changedTouches[0].clientX,y:b.changedTouches[0].clientY},Et=document.elementFromPoint(mt.x,mt.y);if(!Et)return;const Pt=Et.parentElement;if(!Pt)return;const xt=Pt.id,A=xt.split("/")[1],Yt=(de=q.get(A))==null?void 0:de.anchors.get(xt);Yt&&(F.delete("cursor"),Qe(Zt,Yt,b))}function Qe(b,mt,Et){const Pt=li(b,mt);Pt&&$t(),Et.shiftKey||ii(Pt)}function fi(b){if("changedTouches"in b&&r){Me(b);return}if(!r){if(y!=null&&y.size&&!it){F.delete("cursor"),b.shiftKey||ii(!1);return}f&&Ae(b)}}function ai(b){if(!pe){if(y!=null&&y.size&&!it&&!f)return Ei();if(!f)return qe();Ae(b)}}function qe(){et===G?(At(mn,f={anchor:Zt,store:null,key:null},f),Oe(Zt,j)):et?(At(mn,f={anchor:Zt,store:gt,key:zt},f),Oe(j,Zt)):G&&(At(mn,f={anchor:Zt,store:Nt,key:null},f),Oe(Zt,j))}function Oe(b,mt,Et=!1){const Pt={color:Kt,label:{text:oe}};Et&&(Pt.disconnect=!0),se&&(Pt.type=se),Ot[0]&&(Pt.start=Ot[0]),Ot[1]&&(Pt.start=Ot[1]);const xt=Ks({source:b,target:mt},(b==null?void 0:b.edge)||null,Pt);F.add(xt,"cursor")}function Ae(b){if(F.delete("cursor"),!f)return;const mt=f.anchor.type;if(f.anchor===Zt||mt===Zt.type&&mt){ii(!1);return}Zt.recalculatePosition();let Et,Pt;et===G?mt==="input"?(Et=Zt,Pt=f.anchor):(Et=f.anchor,Pt=Zt):et?(Et=f.anchor,Pt=Zt):(Et=Zt,Pt=f.anchor),Qe(Et,Pt,b)}function li(b,mt){if(b===mt||Lt(b.connected).has(Zt))return!1;const Et={color:Kt,label:{text:oe}};if(It){const xt=b.node.id.slice(2),A=It.nodeList[xt];if(A){const Yt=mt.node.id.slice(2),de=A.children.filter(te=>te.node.id===Yt)[0];if(de){const te=de;Et.label={text:te.content}}}}se&&(Et.type=se),Ot[0]&&(Et.start=Ot[0]),Ot[1]&&(Et.start=Ot[1]);const Pt=Ks({source:b,target:mt},(b==null?void 0:b.edge)||null,Et);return!b.node||!mt.node?!1:(F.add(Pt,new Set([b,mt,b.node,mt.node])),!0)}function $t(){if(et&&f&&f.store)l&&zt&&gt&&typeof gt.set=="function"&&typeof gt.update=="function"&&At(gt,l[zt]=f.store,l);else if(G&&f&&f.store){const{store:b,key:mt}=f;b&&mt&&typeof b.update=="function"&&b.update(Et=>(Nt&&(Et[mt]=Nt),Et))}}function ie(){l&&zt&&l[zt]&&At(gt,l[zt]=nt(Lt(l[zt])),l)}function ii(b){(b||!g)&&(At(mn,f=null,f),At(ut,g=null,g))}function ni(){qt&&(Ze&&Zt.recalculatePosition(),es=requestAnimationFrame(ni))}function $e(){F.delete("cursor"),F.match(Zt).forEach(mt=>F.delete(mt)),ii(!1),ie()}function Ei(){if(Lt(Zt.connected).size>1)return;const b=Array.from(Lt(Zt.connected))[0];if(b.type!=="input")if($e(),b.type==="output"){Oe(b,j,!0),ie();const mt=b.store;At(mn,f={anchor:b,store:mt,key:null},f)}else Oe(b,j,!0),At(mn,f={anchor:b,store:null,key:null},f)}function Bi(){Vt.forEach((b,mt)=>{if(!b)return;gi(b)&&o(26,bt[mt]=null,bt)}),o(41,Vt=Vt.filter(b=>b!==null))}function Ue(){bt.forEach(b=>{b&&gi(b)})}function kt(b){const mt=`N-${b[0]}`,Et=q.get(mt);if(!Et)return;const Pt=Et.anchors.get(`A-${b[1]}/N-${b[0]}`);if(!Pt)return;const xt=F.match(Zt,Pt);xt&&F.delete(xt[0])}const gi=b=>{let mt,Et,Pt=null;Array.isArray(b)?(mt=b[0].toString(),Et=b[1].toString()):(mt=b.toString(),Et=null);const xt=`N-${mt}`,A=q.get(xt);if(!A)return!1;if(Et){const Yt=`A-${Et}/${xt}`;Pt=A.anchors.get(Yt)||null}else{const Yt=Lt(A.anchors),de=Array.from(Yt.values());if(!de.length)return!1;Pt=de.reduce((te,ge)=>!te&&ge.type==="output"?null:ge.type==="output"?te:!te||Lt(ge.connected).size<Lt(te.connected).size?ge:te,null)}if(!Pt)return!1;if(li(Zt,Pt),Pt.store&&(gt||Nt)){if(et&&Pt.type==="output")l&&zt&&gt&&typeof gt.set=="function"&&typeof gt.update=="function"&&At(gt,l[zt]=Pt.store,l);else if(G&&Pt.type==="input"){const{store:Yt,inputKey:de}=Pt;Yt&&de&&typeof Yt.update=="function"&&Yt.update(te=>(Nt&&(te[de]=Nt),te))}}return!0},ci=()=>o(10,He=!0),ti=()=>o(10,He=!1);function vi(b){on[b?"unshift":"push"](()=>{Ze=b,o(8,Ze)})}return i.$$set=b=>{"bgColor"in b&&o(0,ht=b.bgColor),"id"in b&&o(27,Z=b.id),"input"in b&&o(1,et=b.input),"output"in b&&o(2,G=b.output),"multiple"in b&&o(28,it=b.multiple),"dynamic"in b&&o(29,Xt=b.dynamic),"edge"in b&&o(7,me=b.edge),"inputsStore"in b&&u(o(3,gt=b.inputsStore)),"key"in b&&o(30,zt=b.key),"outputStore"in b&&o(31,Nt=b.outputStore),"connections"in b&&o(26,bt=b.connections),"edgeColor"in b&&o(32,Kt=b.edgeColor),"edgeLabel"in b&&o(33,oe=b.edgeLabel),"locked"in b&&o(4,pe=b.locked),"nodeConnect"in b&&o(34,st=b.nodeConnect),"edgeStyle"in b&&o(35,se=b.edgeStyle),"endStyles"in b&&o(36,Ot=b.endStyles),"invisible"in b&&o(5,Bt=b.invisible),"direction"in b&&o(37,Gt=b.direction),"title"in b&&o(6,ee=b.title),"$$scope"in b&&o(54,at=b.$$scope)},i.$$.update=()=>{if(i.$$.dirty[1]&2048&&o(11,r=(f==null?void 0:f.anchor)===Zt),i.$$.dirty[0]&536871168|i.$$.dirty[1]&65536&&Xt&&Ze&&Xh(Ze,z,N),i.$$.dirty[0]&67108864|i.$$.dirty[1]&262144&&Q===q.count()&&bt.length&&Ue(),i.$$.dirty[1]&4104&&st&&g&&fi(g),i.$$.dirty[1]&263168&&Q===q.count()&&Vt.length&&Bi(),i.$$.dirty[0]&768|i.$$.dirty[1]&196608&&Ze&&Zt.recalculatePosition(),i.$$.dirty[1]&57600&&(!qt&&(x||S||C)?(o(39,qt=!0),ni()):!x&&!S&&qt&&!C&&(o(39,qt=!1),cancelAnimationFrame(es))),i.$$.dirty[0]&512|i.$$.dirty[1]&512&&y){if(y.size<Ve)Je("disconnection",{node:N,anchor:Zt});else if(y.size>Ve){const b=Array.from(y),mt=b[b.length-1];he("connection",{node:N,anchor:Zt,connectedNode:mt.node,connectedAnchor:mt})}o(40,Ve=y.size)}},P(o(13,n=Zt&&Zt.connected)),W(o(12,a=Zt==null?void 0:Zt.direction)),[ht,et,G,gt,pe,Bt,ee,me,Ze,y,He,r,a,n,F,pt,ut,wt,ve,Qt,Ye,di,ri,Zt,fi,ai,bt,Z,it,Xt,zt,Nt,Kt,oe,st,se,Ot,Gt,kt,qt,Ve,Vt,f,g,C,S,x,z,$,Q,tt,ci,ti,vi,at]}class Oo extends Mi{constructor(e){super(),ki(this,e,Kh,Yh,ui,{bgColor:0,id:27,input:1,output:2,multiple:28,dynamic:29,edge:7,inputsStore:3,key:30,outputStore:31,connections:26,edgeColor:32,edgeLabel:33,locked:4,nodeConnect:34,edgeStyle:35,endStyles:36,invisible:5,direction:37,title:6,disconnect:38},null,[-1,-1,-1])}get disconnect(){return this.$$.ctx[38]}}function _r(i){let e,o,r,n,a;return{c(){e=T("div"),o=V(),r=T("div"),p(e,"class","left svelte-1ryxg7v"),jt(e,"width",i[0]),p(r,"class","right svelte-1ryxg7v"),jt(r,"width",i[0])},m(l,h){J(l,e,h),J(l,o,h),J(l,r,h),n||(a=[Tn(i[16].call(null,e,{left:i[3]})),Tn(i[16].call(null,r,{right:i[4]}))],n=!0)},p(l,h){h[0]&1&&jt(e,"width",l[0]),h[0]&1&&jt(r,"width",l[0])},d(l){l&&(Y(e),Y(o),Y(r)),n=!1,si(a)}}}function mr(i){let e,o,r,n,a;return{c(){e=T("div"),o=V(),r=T("div"),p(e,"class","top svelte-1ryxg7v"),jt(e,"height",i[1]),p(r,"class","bottom svelte-1ryxg7v"),jt(r,"height",i[1])},m(l,h){J(l,e,h),J(l,o,h),J(l,r,h),n||(a=[Tn(i[16].call(null,e,{top:i[5]})),Tn(i[16].call(null,r,{bottom:i[6]}))],n=!0)},p(l,h){h[0]&2&&jt(e,"height",l[1]),h[0]&2&&jt(r,"height",l[1])},d(l){l&&(Y(e),Y(o),Y(r)),n=!1,si(a)}}}function Jh(i){let e,o,r;return{c(){e=T("div"),p(e,"class","svelte-1ryxg7v"),jt(e,"both",i[7])},m(n,a){J(n,e,a),o||(r=Tn(i[16].call(null,e,{both:i[7]})),o=!0)},p:Ft,d(n){n&&Y(e),o=!1,r()}}}function pr(i){let e,o,r;return{c(){e=T("div"),p(e,"class","svelte-1ryxg7v"),jt(e,"rotation",i[2])},m(n,a){J(n,e,a),o||(r=Tn(i[17].call(null,e)),o=!0)},p(n,a){a[0]&4&&jt(e,"rotation",n[2])},d(n){n&&Y(e),o=!1,r()}}}function Qh(i){let e,o,r,n,a=i[0]&&_r(i),l=i[1]&&mr(i),h=i[7]&&Jh(i),u=i[2]&&pr(i);return{c(){a&&a.c(),e=V(),l&&l.c(),o=V(),h&&h.c(),r=V(),u&&u.c(),n=De()},m(f,_){a&&a.m(f,_),J(f,e,_),l&&l.m(f,_),J(f,o,_),h&&h.m(f,_),J(f,r,_),u&&u.m(f,_),J(f,n,_)},p(f,_){f[0]?a?a.p(f,_):(a=_r(f),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null),f[1]?l?l.p(f,_):(l=mr(f),l.c(),l.m(o.parentNode,o)):l&&(l.d(1),l=null),f[7]&&h.p(f,_),f[2]?u?u.p(f,_):(u=pr(f),u.c(),u.m(n.parentNode,n)):u&&(u.d(1),u=null)},i:Ft,o:Ft,d(f){f&&(Y(e),Y(o),Y(r),Y(n)),a&&a.d(f),l&&l.d(f),h&&h.d(f),u&&u.d(f)}}}function $h(i){return i*(180/Math.PI)}function tu(i,e,o){let r,n,a,l,h,u,f,_,g,y,k,P;yt(i,Gi,gt=>o(38,f=gt));const C=_e("graph"),S=_e("node"),x=_e("resized");let{width:z=!1}=e,{height:O=!1}=e,{rotation:W=!1}=e,{minHeight:$=0}=e,{minWidth:Q=0}=e,rt,ot=z,tt=z,at=O,K=O,N=z&&O,F=0,j=0,_t=Lt(S.position);const pt=S.position;yt(i,pt,gt=>o(32,k=gt));const X=S.resizingWidth;yt(i,X,gt=>o(31,y=gt));const q=S.resizingHeight;yt(i,q,gt=>o(30,g=gt));const Dt=S.rotating;yt(i,Dt,gt=>o(28,u=gt));const ut=S.rotation;yt(i,ut,gt=>o(29,_=gt));const wt=S.dimensions.height;yt(i,wt,gt=>o(26,l=gt));const It=S.dimensions.width;yt(i,It,gt=>o(27,h=gt));const ht=C.cursor;yt(i,ht,gt=>o(33,P=gt));let Z,et,G=1;Ki(()=>{try{rt=document.querySelector(`#${S.id}`),rt&&o(19,[Q,$]=Xo(rt),Q,o(18,$))}catch(gt){console.error(gt)}});function it(gt,zt){const Nt=Kt=>{Kt.stopPropagation(),Kt.preventDefault(),zt.left||zt.top?o(23,G=-1):o(23,G=1),rs.set(!0),At(Gi,f=Lt(ht),f),o(21,Z=h),o(22,et=l),o(20,_t=k),zt.both?At(X,y=!0,y):At(X,y=!1,y),At(X,y=zt.left||zt.right||zt.both||!1,y),At(q,g=zt.top||zt.bottom||zt.both||!1,g),rt&&o(19,[Q,$]=Xo(rt),Q,o(18,$)),window.addEventListener("mouseup",bt)},bt=()=>{At(X,y=!1,y),At(q,g=!1,g),rs.set(!1),window.removeEventListener("mouseup",bt)};return gt.addEventListener("mousedown",Nt),{destroy(){gt.removeEventListener("mousedown",Nt)}}}function Xt(gt){const zt=bt=>{bt.stopPropagation(),bt.preventDefault(),F=_,At(Gi,f=Lt(ht),f);const Kt=f.x-a.x,oe=f.y-a.y;j=Math.atan2(oe,Kt),At(Dt,u=!0,u),window.addEventListener("mouseup",Nt)},Nt=()=>{At(Dt,u=!1,u),window.removeEventListener("mouseup",Nt)};return gt.addEventListener("mousedown",zt),{destroy(){gt.removeEventListener("mousedown",zt)}}}function me(){const gt=Lt(ht),zt=gt.x-a.x,Nt=gt.y-a.y,bt=Math.atan2(Nt,zt),Kt=j-bt;return F-$h(Kt)}return Sc(()=>{rt&&o(19,[Q,$]=Xo(rt),Q,o(18,$)),h<Q&&x.set(!1),l<$&&x.set(!1)}),i.$$set=gt=>{"width"in gt&&o(0,z=gt.width),"height"in gt&&o(1,O=gt.height),"rotation"in gt&&o(2,W=gt.rotation),"minHeight"in gt&&o(18,$=gt.minHeight),"minWidth"in gt&&o(19,Q=gt.minWidth)},i.$$.update=()=>{if(i.$$.dirty[0]&268435456|i.$$.dirty[1]&4&&u&&At(ut,_=me(),_),i.$$.dirty[0]&1624506368|i.$$.dirty[1]&4&&g){const gt=Lt(Gi),zt=P,Nt=Math.max($,et+(zt.y-gt.y)*G);Nt>$?(x.set(!0),At(wt,l=Nt,l)):x.set(!1),G===-1&&At(pt,k={x:_t.x,y:_t.y+zt.y-gt.y},k),_!==0&&S.position.update(bt=>({y:_t.y-(Nt-et)/2,x:bt.x}))}if(i.$$.dirty[0]&548929536|i.$$.dirty[1]&5&&y){const gt=Lt(Gi),zt=P,Nt=Math.max(Q,Z+(zt.x-gt.x)*G);Nt>Q?(x.set(!0),At(It,h=Nt,h)):x.set(!1),G===-1&&At(pt,k={x:_t.x+zt.x-gt.x,y:_t.y},k),_!==0&&S.position.update(bt=>({x:_t.x-(Nt-Z)/2,y:bt.y}))}i.$$.dirty[1]&2&&o(25,r=k.x),i.$$.dirty[1]&2&&o(24,n=k.y),i.$$.dirty[0]&251658240&&(a={x:r+h/2,y:n+l/2})},[z,O,W,ot,tt,at,K,N,pt,X,q,Dt,ut,wt,It,ht,it,Xt,$,Q,_t,Z,et,G,n,r,l,h,u,_,g,y,k,P]}class eu extends Mi{constructor(e){super(),ki(this,e,tu,Qh,ui,{width:0,height:1,rotation:2,minHeight:18,minWidth:19},null,[-1,-1])}}function gr(i,e,o){const r=i.slice();return r[28]=e[o],r[34]=o,r}function vr(i,e,o){const r=i.slice();return r[28]=e[o],r[34]=o,r}function yr(i,e,o){const r=i.slice();return r[28]=e[o],r}function br(i,e,o){const r=i.slice();return r[28]=e[o],r}function iu(i){let e,o=[],r=new Map,n,a,l=[],h=new Map,u,f=ke({length:i[2]});const _=k=>k[34];for(let k=0;k<f.length;k+=1){let P=vr(i,f,k),C=_(P);r.set(C,o[k]=wr(C,P))}let g=ke({length:i[3]});const y=k=>k[34];for(let k=0;k<g.length;k+=1){let P=gr(i,g,k),C=y(P);h.set(C,l[k]=Lr(C,P))}return{c(){e=T("div");for(let k=0;k<o.length;k+=1)o[k].c();n=V(),a=T("div");for(let k=0;k<l.length;k+=1)l[k].c();p(e,"class","input-anchors svelte-j5bq7k"),jt(e,"top",i[14]),jt(e,"left",i[16]),p(a,"class","output-anchors svelte-j5bq7k"),jt(a,"bottom",i[15]),jt(a,"right",i[17])},m(k,P){J(k,e,P);for(let C=0;C<o.length;C+=1)o[C]&&o[C].m(e,null);J(k,n,P),J(k,a,P);for(let C=0;C<l.length;C+=1)l[C]&&l[C].m(a,null);u=!0},p(k,P){P[0]&16388&&(f=ke({length:k[2]}),we(),o=wn(o,P,_,1,k,f,r,e,ao,wr,null,vr),Le()),P[0]&16392&&(g=ke({length:k[3]}),we(),l=wn(l,P,y,1,k,g,h,a,ao,Lr,null,gr),Le())},i(k){if(!u){for(let P=0;P<f.length;P+=1)B(o[P]);for(let P=0;P<g.length;P+=1)B(l[P]);u=!0}},o(k){for(let P=0;P<o.length;P+=1)U(o[P]);for(let P=0;P<l.length;P+=1)U(l[P]);u=!1},d(k){k&&(Y(e),Y(n),Y(a));for(let P=0;P<o.length;P+=1)o[P].d();for(let P=0;P<l.length;P+=1)l[P].d()}}}function nu(i){let e,o,r,n=ke({length:i[2]}),a=[];for(let _=0;_<n.length;_+=1)a[_]=kr(br(i,n,_));const l=_=>U(a[_],1,1,()=>{a[_]=null});let h=ke({length:i[3]}),u=[];for(let _=0;_<h.length;_+=1)u[_]=Mr(yr(i,h,_));const f=_=>U(u[_],1,1,()=>{u[_]=null});return{c(){for(let _=0;_<a.length;_+=1)a[_].c();e=V();for(let _=0;_<u.length;_+=1)u[_].c();o=De()},m(_,g){for(let y=0;y<a.length;y+=1)a[y]&&a[y].m(_,g);J(_,e,g);for(let y=0;y<u.length;y+=1)u[y]&&u[y].m(_,g);J(_,o,g),r=!0},p(_,g){if(g[0]&4){const y=n.length;n=ke({length:_[2]});let k;for(k=y;k<n.length;k+=1){const P=br(_,n,k);a[k]?B(a[k],1):(a[k]=kr(P),a[k].c(),B(a[k],1),a[k].m(e.parentNode,e))}for(we(),k=n.length;k<a.length;k+=1)l(k);Le()}if(g[0]&8){const y=h.length;h=ke({length:_[3]});let k;for(k=y;k<h.length;k+=1){const P=yr(_,h,k);u[k]?B(u[k],1):(u[k]=Mr(P),u[k].c(),B(u[k],1),u[k].m(o.parentNode,o))}for(we(),k=h.length;k<u.length;k+=1)f(k);Le()}},i(_){if(!r){for(let g=0;g<n.length;g+=1)B(a[g]);for(let g=0;g<h.length;g+=1)B(u[g]);r=!0}},o(_){a=a.filter(Boolean);for(let g=0;g<a.length;g+=1)U(a[g]);u=u.filter(Boolean);for(let g=0;g<u.length;g+=1)U(u[g]);r=!1},d(_){_&&(Y(e),Y(o)),Sn(a,_),Sn(u,_)}}}function wr(i,e){let o,r,n;return r=new Oo({props:{input:!0,direction:e[14]?"north":"west"}}),r.$on("connection",e[22]),r.$on("disconnection",e[23]),{key:i,first:null,c(){o=De(),ce(r.$$.fragment),this.first=o},m(a,l){J(a,o,l),re(r,a,l),n=!0},p(a,l){e=a},i(a){n||(B(r.$$.fragment,a),n=!0)},o(a){U(r.$$.fragment,a),n=!1},d(a){a&&Y(o),ae(r,a)}}}function Lr(i,e){let o,r,n;return r=new Oo({props:{output:!0,direction:e[14]?"south":"east"}}),r.$on("connection",e[24]),r.$on("disconnection",e[25]),{key:i,first:null,c(){o=De(),ce(r.$$.fragment),this.first=o},m(a,l){J(a,o,l),re(r,a,l),n=!0},p(a,l){e=a},i(a){n||(B(r.$$.fragment,a),n=!0)},o(a){U(r.$$.fragment,a),n=!1},d(a){a&&Y(o),ae(r,a)}}}function kr(i){let e,o;return e=new Oo({}),e.$on("connection",i[18]),e.$on("disconnection",i[19]),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Mr(i){let e,o;return e=new Oo({}),e.$on("connection",i[20]),e.$on("disconnection",i[21]),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Pr(i){let e,o;return e=new eu({props:{width:!0,height:!0,rotation:!0}}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function ou(i){let e,o,r,n,a,l,h,u=`${i[1]}px`,f;const _=[nu,iu],g=[];function y(P,C){return P[7]?0:1}o=y(i),r=g[o]=_[o](i);let k=i[6]&&Pr();return{c(){e=T("div"),r.c(),n=V(),a=T("p"),l=Re(i[5]),h=V(),k&&k.c(),p(a,"class","svelte-j5bq7k"),lt(a,"color",i[4]),p(e,"class","default-node svelte-j5bq7k"),jt(e,"selected",i[0]),lt(e,"border-radius",u)},m(P,C){J(P,e,C),g[o].m(e,null),w(e,n),w(e,a),w(a,l),w(e,h),k&&k.m(e,null),f=!0},p(P,C){r.p(P,C),(!f||C[0]&32)&&pi(l,P[5]),C[0]&16&&lt(a,"color",P[4]),P[6]?k?C[0]&64&&B(k,1):(k=Pr(),k.c(),B(k,1),k.m(e,null)):k&&(we(),U(k,1,1,()=>{k=null}),Le()),(!f||C[0]&1)&&jt(e,"selected",P[0]),C[0]&2&&u!==(u=`${P[1]}px`)&&lt(e,"border-radius",u)},i(P){f||(B(r),B(k),f=!0)},o(P){U(r),U(k),f=!1},d(P){P&&Y(e),g[o].d(),k&&k.d()}}}function su(i,e,o){let r,n,a,l,h,u;const f=_e("dynamic"),_=_e("node");let{selected:g}=e;const y=_.label;yt(i,y,_t=>o(5,h=_t));const k=_.borderRadius;yt(i,k,_t=>o(1,r=_t));const P=_.textColor;yt(i,P,_t=>o(4,l=_t));const C=_.inputs;yt(i,C,_t=>o(2,n=_t));const S=_.outputs;yt(i,S,_t=>o(3,a=_t));const x=_.resizable;yt(i,x,_t=>o(6,u=_t));const z=Lt(_.direction);let O=z==="TD",W=z==="TD",$=z!=="TD",Q=z!=="TD";function rt(_t){ei.call(this,i,_t)}function ot(_t){ei.call(this,i,_t)}function tt(_t){ei.call(this,i,_t)}function at(_t){ei.call(this,i,_t)}function K(_t){ei.call(this,i,_t)}function N(_t){ei.call(this,i,_t)}function F(_t){ei.call(this,i,_t)}function j(_t){ei.call(this,i,_t)}return i.$$set=_t=>{"selected"in _t&&o(0,g=_t.selected)},[g,r,n,a,l,h,u,f,y,k,P,C,S,x,O,W,$,Q,rt,ot,tt,at,K,N,F,j]}class ru extends Mi{constructor(e){super(),ki(this,e,su,ou,ui,{selected:0},null,[-1,-1])}}const au=i=>({}),Er=i=>({}),lu=i=>({}),Cr=i=>({}),cu=i=>({}),Tr=i=>({}),hu=i=>({}),Sr=i=>({}),uu=i=>({selected:i[0]&2048}),Dr=i=>({grabHandle:i[50],selected:i[11],destroy:i[48]}),du=i=>({selected:i[0]&2048}),xr=i=>({grabHandle:i[50],selected:i[11],destroy:i[48]});function zr(i){let e,o,r,n,a,l,h,u,f,_,g,y,k,P,C,S=`${i[14].y}px`,x=`${i[14].x}px`,z=`rotate(${i[20]}deg)`,O,W,$;const Q=[_u,fu],rt=[];function ot(X,q){return X[12]?1:0}o=ot(i),r=rt[o]=Q[o](i);const tt=i[61].anchorWest,at=Ee(tt,i,i[60],Sr),K=i[61].anchorEast,N=Ee(K,i,i[60],Tr),F=i[61].anchorNorth,j=Ee(F,i,i[60],Cr),_t=i[61].anchorSouth,pt=Ee(_t,i,i[60],Er);return{c(){e=T("div"),r.c(),n=V(),a=T("div"),at&&at.c(),h=V(),u=T("div"),N&&N.c(),_=V(),g=T("div"),j&&j.c(),k=V(),P=T("div"),pt&&pt.c(),p(a,"id",l=`anchors-west-${i[0].id}`),p(a,"class","anchors left svelte-1iknrz0"),p(u,"id",f=`anchors-east-${i[0].id}`),p(u,"class","anchors right svelte-1iknrz0"),p(g,"id",y=`anchors-north-${i[0].id}`),p(g,"class","anchors top svelte-1iknrz0"),p(P,"id",C=`anchors-south-${i[0].id}`),p(P,"class","anchors bottom svelte-1iknrz0"),p(e,"id",i[30]),p(e,"class","svelvet-node svelte-1iknrz0"),p(e,"role","button"),p(e,"title",i[10]),p(e,"tabindex",0),jt(e,"selected",i[11]),jt(e,"locked",i[16]||i[15]),lt(e,"top",S),lt(e,"left",x),lt(e,"z-index",i[17]),lt(e,"width",i[12]?i[19]+"px":"fit-content"),lt(e,"height",i[12]?i[18]+"px":"fit-content"),lt(e,"transform",z),lt(e,"--prop-background-color",i[21]||(i[1]||i[2]?null:"transparent")),lt(e,"--prop-text-color",i[22]),lt(e,"--prop-border-color",i[23]),lt(e,"--prop-selection-color",i[24]),lt(e,"--prop-border-radius",i[25]?`${i[25]}px`:i[1]||i[2]?null:"0px"),lt(e,"--prop-border-width",i[26]||(i[1]||i[2]?null:"0px"))},m(X,q){J(X,e,q),rt[o].m(e,null),w(e,n),w(e,a),at&&at.m(a,null),w(e,h),w(e,u),N&&N.m(u,null),w(e,_),w(e,g),j&&j.m(g,null),w(e,k),w(e,P),pt&&pt.m(P,null),O=!0,W||($=[ft(e,"contextmenu",nn(Xi(i[62]))),ft(e,"mouseup",i[49]),Tn(i[50].call(null,e))],W=!0)},p(X,q){let Dt=o;o=ot(X),o===Dt?rt[o].p(X,q):(we(),U(rt[Dt],1,1,()=>{rt[Dt]=null}),Le(),r=rt[o],r?r.p(X,q):(r=rt[o]=Q[o](X),r.c()),B(r,1),r.m(e,n)),at&&at.p&&(!O||q[1]&536870912)&&Te(at,tt,X,X[60],O?Ce(tt,X[60],q,hu):Se(X[60]),Sr),(!O||q[0]&1&&l!==(l=`anchors-west-${X[0].id}`))&&p(a,"id",l),N&&N.p&&(!O||q[1]&536870912)&&Te(N,K,X,X[60],O?Ce(K,X[60],q,cu):Se(X[60]),Tr),(!O||q[0]&1&&f!==(f=`anchors-east-${X[0].id}`))&&p(u,"id",f),j&&j.p&&(!O||q[1]&536870912)&&Te(j,F,X,X[60],O?Ce(F,X[60],q,lu):Se(X[60]),Cr),(!O||q[0]&1&&y!==(y=`anchors-north-${X[0].id}`))&&p(g,"id",y),pt&&pt.p&&(!O||q[1]&536870912)&&Te(pt,_t,X,X[60],O?Ce(_t,X[60],q,au):Se(X[60]),Er),(!O||q[0]&1&&C!==(C=`anchors-south-${X[0].id}`))&&p(P,"id",C),(!O||q[0]&1024)&&p(e,"title",X[10]),(!O||q[0]&2048)&&jt(e,"selected",X[11]),(!O||q[0]&98304)&&jt(e,"locked",X[16]||X[15]),q[0]&16384&&S!==(S=`${X[14].y}px`)&&lt(e,"top",S),q[0]&16384&&x!==(x=`${X[14].x}px`)&&lt(e,"left",x),q[0]&131072&&lt(e,"z-index",X[17]),q[0]&528384&&lt(e,"width",X[12]?X[19]+"px":"fit-content"),q[0]&266240&&lt(e,"height",X[12]?X[18]+"px":"fit-content"),q[0]&1048576&&z!==(z=`rotate(${X[20]}deg)`)&&lt(e,"transform",z),q[0]&2097158&&lt(e,"--prop-background-color",X[21]||(X[1]||X[2]?null:"transparent")),q[0]&4194304&&lt(e,"--prop-text-color",X[22]),q[0]&8388608&&lt(e,"--prop-border-color",X[23]),q[0]&16777216&&lt(e,"--prop-selection-color",X[24]),q[0]&33554438&&lt(e,"--prop-border-radius",X[25]?`${X[25]}px`:X[1]||X[2]?null:"0px"),q[0]&67108870&&lt(e,"--prop-border-width",X[26]||(X[1]||X[2]?null:"0px"))},i(X){O||(B(r),B(at,X),B(N,X),B(j,X),B(pt,X),O=!0)},o(X){U(r),U(at,X),U(N,X),U(j,X),U(pt,X),O=!1},d(X){X&&Y(e),rt[o].d(),at&&at.d(X),N&&N.d(X),j&&j.d(X),pt&&pt.d(X),W=!1,si($)}}}function fu(i){let e;const o=i[61].default,r=Ee(o,i,i[60],Dr);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,a){r&&r.p&&(!e||a[0]&2048|a[1]&536870912)&&Te(r,o,n,n[60],e?Ce(o,n[60],a,uu):Se(n[60]),Dr)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function _u(i){let e,o,r;const n=i[61].default,a=Ee(n,i,i[60],xr);return{c(){e=T("div"),a&&a.c(),On(()=>i[63].call(e)),lt(e,"width","fit-content"),lt(e,"height","fit-content")},m(l,h){J(l,e,h),a&&a.m(e,null),o=Ec(e,i[63].bind(e)),r=!0},p(l,h){a&&a.p&&(!r||h[0]&2048|h[1]&536870912)&&Te(a,n,l,l[60],r?Ce(n,l[60],h,du):Se(l[60]),xr)},i(l){r||(B(a,l),r=!0)},o(l){U(a,l),r=!1},d(l){l&&Y(e),a&&a.d(l),o()}}}function mu(i){let e,o,r=!i[13]&&zr(i);return{c(){r&&r.c(),e=De()},m(n,a){r&&r.m(n,a),J(n,e,a),o=!0},p(n,a){n[13]?r&&(we(),U(r,1,1,()=>{r=null}),Le()):r?(r.p(n,a),a[0]&8192&&B(r,1)):(r=zr(n),r.c(),B(r,1),r.m(e.parentNode,e))},i(n){o||(B(r),o=!0)},o(n){U(r),o=!1},d(n){n&&Y(e),r&&r.d(n)}}}const pu=new Set(["INPUT","SELECT","BUTTON","TEXTAREA"]);function gu(i,e,o){let r,n,a,l,h,u,f,_=Ft,g=()=>(_(),_=mi(qt,A=>o(66,f=A)),qt),y,k=Ft,P=()=>(k(),k=mi(Vt,A=>o(67,y=A)),Vt),C,S,x=Ft,z=()=>(x(),x=mi(ue,A=>o(68,S=A)),ue),O,W,$,Q=Ft,rt=()=>(Q(),Q=mi(ve,A=>o(71,$=A)),ve),ot,tt,at,K=Ft,N=()=>(K(),K=mi(Ze,A=>o(16,at=A)),Ze),F,j=Ft,_t=()=>(j(),j=mi(He,A=>o(73,F=A)),He),pt,X,q,Dt,ut=Ft,wt=()=>(ut(),ut=mi(Ve,A=>o(75,Dt=A)),Ve),It,ht,Z,et,G,it,Xt,me,gt,zt,Nt,bt;yt(i,Gi,A=>o(65,u=A)),yt(i,ji,A=>o(70,W=A)),i.$$.on_destroy.push(()=>_()),i.$$.on_destroy.push(()=>k()),i.$$.on_destroy.push(()=>x()),i.$$.on_destroy.push(()=>Q()),i.$$.on_destroy.push(()=>K()),i.$$.on_destroy.push(()=>j()),i.$$.on_destroy.push(()=>ut());let{$$slots:Kt={},$$scope:oe}=e;const pe=_e("mounted"),st=_e("duplicate");yt(i,st,A=>o(56,ht=A));const se=_e("graphDOMElement");yt(i,se,A=>o(74,X=A));const Ot=Yn();let{node:Bt}=e,{isDefault:Gt}=e,{useDefaults:ee}=e,{center:he}=e,{nodeStore:Je}=e,{locked:Ze}=e;N();let{groups:qt}=e;g();let{maxZIndex:He}=e;_t();let{centerPoint:Ve}=e;wt();let{cursor:ze}=e,{initialNodePositions:Vt}=e;P();let{activeGroup:ue}=e;z();let{editing:ve}=e;rt();let{dimensionsProvided:Qt=!1}=e,{title:Ye}=e;const di=nt(0),ri=nt(null);yt(i,ri,A=>o(64,h=A));const Ie=Bt.id,Zt=Bt.position;yt(i,Zt,A=>o(59,G=A));const Me=Bt.dimensions.width;yt(i,Me,A=>o(19,It=A));const Qe=Bt.dimensions.height;yt(i,Qe,A=>o(18,q=A));const fi=Bt.selectionColor;yt(i,fi,A=>o(24,zt=A));const ai=Bt.editable;yt(i,ai,A=>o(72,ot=A));const qe=Bt.locked;yt(i,qe,A=>o(15,tt=A));const Oe=Bt.zIndex;yt(i,Oe,A=>o(17,pt=A));const Ae=Bt.bgColor;yt(i,Ae,A=>o(21,Xt=A));const li=Bt.borderRadius;yt(i,li,A=>o(25,Nt=A));const $t=Bt.textColor;yt(i,$t,A=>o(22,me=A));const ie=Bt.group;yt(i,ie,A=>o(69,O=A));const ii=Bt.borderColor;yt(i,ii,A=>o(23,gt=A));const ni=Bt.borderWidth;yt(i,ni,A=>o(26,bt=A));const $e=Bt.rotation;yt(i,$e,A=>o(20,it=A));const{selected:Ei,hidden:Bi}=f,Ue=Bi.nodes;yt(i,Ue,A=>o(58,et=A));const kt=Ei.nodes;yt(i,kt,A=>o(55,C=A));const gi=nt(!1);yt(i,gi,A=>o(57,Z=A)),xe("node",Bt),xe("anchorsMounted",di),xe("resized",gi),xe("nodeConnectEvent",ri),Ki(()=>{if(he){const A={x:Dt.x-It/2,y:Dt.y-q/2};Bt.position.set(A),ji.set(!0),ji.set(!1)}pe.update(A=>A+1)}),co(()=>{n&&(C.delete(Bt),kt.set(C)),pe.update(A=>A-1)});function ci(){n?(Bt&&C.delete(Bt),kt.set(C)):(Bt&&C.add(Bt),kt.set(C))}function ti(A){At(Gi,u=Lt(ze),u),X.focus(),pt!==F&&pt!==1/0&&At(Oe,pt=At(He,++F,F),pt);const Yt=A.target;if(!pu.has(Yt.tagName)&&(A.preventDefault(),Ot("nodeClicked",{node:Bt,e:A}),!(at||tt))){if("touches"in A){if(A.touches&&A.touches.length>1)return}else A.button===2&&ot&&At(ve,$=Bt,$);At(ji,W=!0,W),vi(A)}}function vi(A){let Yt,de,te=!1;const ge=O;ge&&(Yt=f[ge],de=Lt(Yt.parent),te=de===Bt),te?At(ue,S=ge,S):At(ue,S="selected",S),!A.shiftKey&&n?At(ue,S="selected",S):(!A.shiftKey&&!n&&!A.shiftKey&&(C.clear(),kt.set(C)),ci()),At(Vt,y=vl(f.selected.nodes),y)}function b(){Je.delete(Ie)}function mt(A){const Yt=Lt(ze),de=Yt.x-u.x,te=Yt.y-u.y;Math.abs(de)+Math.abs(te)<4&&Ot("nodeReleased",{e:A,node:Bt}),At(ri,h=A,h)}function Et(A){return A.addEventListener("mousedown",ti),A.addEventListener("touchstart",ti),{destroy(){A.removeEventListener("mousedown",ti),A.removeEventListener("touchstart",ti)}}}function Pt(A){ei.call(this,i,A)}function xt(){q=this.clientHeight,Qe.set(q),It=this.clientWidth,Me.set(It)}return i.$$set=A=>{"node"in A&&o(0,Bt=A.node),"isDefault"in A&&o(1,Gt=A.isDefault),"useDefaults"in A&&o(2,ee=A.useDefaults),"center"in A&&o(51,he=A.center),"nodeStore"in A&&o(52,Je=A.nodeStore),"locked"in A&&N(o(3,Ze=A.locked)),"groups"in A&&g(o(4,qt=A.groups)),"maxZIndex"in A&&_t(o(5,He=A.maxZIndex)),"centerPoint"in A&&wt(o(6,Ve=A.centerPoint)),"cursor"in A&&o(53,ze=A.cursor),"initialNodePositions"in A&&P(o(7,Vt=A.initialNodePositions)),"activeGroup"in A&&z(o(8,ue=A.activeGroup)),"editing"in A&&rt(o(9,ve=A.editing)),"dimensionsProvided"in A&&o(54,Qt=A.dimensionsProvided),"title"in A&&o(10,Ye=A.title),"$$scope"in A&&o(60,oe=A.$$scope)},i.$$.update=()=>{i.$$.dirty[1]&268435456&&o(14,r=G),i.$$.dirty[0]&1|i.$$.dirty[1]&16777216&&o(11,n=C.has(Bt)),i.$$.dirty[0]&1|i.$$.dirty[1]&134217728&&o(13,a=et.has(Bt)),i.$$.dirty[1]&75497472&&o(12,l=Qt||Z),i.$$.dirty[0]&2049|i.$$.dirty[1]&33554432&&n&&ht&&Ot("duplicate",Bt)},[Bt,Gt,ee,Ze,qt,He,Ve,Vt,ue,ve,Ye,n,l,a,r,tt,at,pt,q,It,it,Xt,me,gt,zt,Nt,bt,st,se,ri,Ie,Zt,Me,Qe,fi,ai,qe,Oe,Ae,li,$t,ie,ii,ni,$e,Ue,kt,gi,b,mt,Et,he,Je,ze,Qt,C,ht,Z,et,G,oe,Kt,Pt,xt]}class vu extends Mi{constructor(e){super(),ki(this,e,gu,mu,ui,{node:0,isDefault:1,useDefaults:2,center:51,nodeStore:52,locked:3,groups:4,maxZIndex:5,centerPoint:6,cursor:53,initialNodePositions:7,activeGroup:8,editing:9,dimensionsProvided:54,title:10},null,[-1,-1,-1])}}const yu=i=>({selected:i[1]&262144,grabHandle:i[1]&524288,node:i[0]&128,destroy:i[1]&131072}),Ir=i=>({selected:i[49],grabHandle:i[50],disconnect:i[14],connect:i[13],node:i[7],destroy:i[48]}),bu=i=>({}),Or=i=>({slot:"anchorWest"}),wu=i=>({}),Ar=i=>({slot:"anchorEast"}),Lu=i=>({}),Nr=i=>({slot:"anchorNorth"}),ku=i=>({}),Br=i=>({slot:"anchorSouth"});function Rr(i){let e,o;return e=new vu({props:{node:i[7],center:i[5]||i[0]==="center",isDefault:i[8],useDefaults:i[4],dimensionsProvided:!!i[1]||!!i[2]||!!i[3]||i[8]||!1,nodeStore:i[11].nodes,locked:i[11].locked,groups:i[11].groups,title:i[6],maxZIndex:i[11].maxZIndex,centerPoint:i[11].center,cursor:i[11].cursor,activeGroup:i[11].activeGroup,editing:i[11].editing,initialNodePositions:i[11].initialNodePositions,$$slots:{anchorSouth:[Su],anchorNorth:[Tu],anchorEast:[Cu],anchorWest:[Eu],default:[Pu,({destroy:r,selected:n,grabHandle:a})=>({48:r,49:n,50:a}),({destroy:r,selected:n,grabHandle:a})=>[0,(r?131072:0)|(n?262144:0)|(a?524288:0)]]},$$scope:{ctx:i}}}),e.$on("nodeClicked",i[41]),e.$on("nodeMount",i[42]),e.$on("nodeReleased",i[43]),e.$on("duplicate",i[44]),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},p(r,n){const a={};n[0]&128&&(a.node=r[7]),n[0]&33&&(a.center=r[5]||r[0]==="center"),n[0]&256&&(a.isDefault=r[8]),n[0]&16&&(a.useDefaults=r[4]),n[0]&270&&(a.dimensionsProvided=!!r[1]||!!r[2]||!!r[3]||r[8]||!1),n[0]&64&&(a.title=r[6]),n[0]&384|n[1]&933888&&(a.$$scope={dirty:n,ctx:r}),e.$set(a)},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Zr(i){let e,o;return e=new ru({props:{selected:i[49]}}),e.$on("connection",i[39]),e.$on("disconnection",i[40]),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},p(r,n){const a={};n[1]&262144&&(a.selected=r[49]),e.$set(a)},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Mu(i){let e,o,r=i[8]&&Zr(i);return{c(){r&&r.c(),e=De()},m(n,a){r&&r.m(n,a),J(n,e,a),o=!0},p(n,a){n[8]?r?(r.p(n,a),a[0]&256&&B(r,1)):(r=Zr(n),r.c(),B(r,1),r.m(e.parentNode,e)):r&&(we(),U(r,1,1,()=>{r=null}),Le())},i(n){o||(B(r),o=!0)},o(n){U(r),o=!1},d(n){n&&Y(e),r&&r.d(n)}}}function Pu(i){let e;const o=i[38].default,r=Ee(o,i,i[45],Ir),n=r||Mu(i);return{c(){n&&n.c()},m(a,l){n&&n.m(a,l),e=!0},p(a,l){r?r.p&&(!e||l[0]&128|l[1]&933888)&&Te(r,o,a,a[45],e?Ce(o,a[45],l,yu):Se(a[45]),Ir):n&&n.p&&(!e||l[0]&256|l[1]&262144)&&n.p(a,e?l:[-1,-1])},i(a){e||(B(n,a),e=!0)},o(a){U(n,a),e=!1},d(a){n&&n.d(a)}}}function Eu(i){let e;const o=i[38].anchorWest,r=Ee(o,i,i[45],Or);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,a){r&&r.p&&(!e||a[1]&16384)&&Te(r,o,n,n[45],e?Ce(o,n[45],a,bu):Se(n[45]),Or)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function Cu(i){let e;const o=i[38].anchorEast,r=Ee(o,i,i[45],Ar);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,a){r&&r.p&&(!e||a[1]&16384)&&Te(r,o,n,n[45],e?Ce(o,n[45],a,wu):Se(n[45]),Ar)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function Tu(i){let e;const o=i[38].anchorNorth,r=Ee(o,i,i[45],Nr);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,a){r&&r.p&&(!e||a[1]&16384)&&Te(r,o,n,n[45],e?Ce(o,n[45],a,Lu):Se(n[45]),Nr)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function Su(i){let e;const o=i[38].anchorSouth,r=Ee(o,i,i[45],Br);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,a){r&&r.p&&(!e||a[1]&16384)&&Te(r,o,n,n[45],e?Ce(o,n[45],a,ku):Se(n[45]),Br)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function Du(i){let e=i[7]&&i[10].get(i[7].id),o,r,n=e&&Rr(i);return{c(){n&&n.c(),o=De()},m(a,l){n&&n.m(a,l),J(a,o,l),r=!0},p(a,l){l[0]&1152&&(e=a[7]&&a[10].get(a[7].id)),e?n?(n.p(a,l),l[0]&1152&&B(n,1)):(n=Rr(a),n.c(),B(n,1),n.m(o.parentNode,o)):n&&(we(),U(n,1,1,()=>{n=null}),Le())},i(a){r||(B(n),r=!0)},o(a){U(n),r=!1},d(a){a&&Y(o),n&&n.d(a)}}}function xu(i,e,o){let r,n,a=Ft,l=()=>(a(),a=mi(r,st=>o(37,n=st)),r),h;i.$$.on_destroy.push(()=>a());let{$$slots:u={},$$scope:f}=e;const _=hs(u),g=_e("graph"),y=_e("group");let{position:k={x:0,y:0}}=e,{drop:P=!1}=e,{dimensions:C=null}=e,{id:S=0}=e,{bgColor:x=null}=e,{borderRadius:z=null}=e,{borderColor:O=null}=e,{borderWidth:W=null}=e,{selectionColor:$=null}=e,{textColor:Q=null}=e,{resizable:rt=!1}=e,{label:ot=""}=e,{inputs:tt=1}=e,{outputs:at=1}=e,{width:K=null}=e,{height:N=null}=e,{TD:F=!1}=e,{LR:j=!1}=e,{zIndex:_t=1}=e,{editable:pt=!0}=e,{locked:X=!1}=e,{rotation:q=0}=e,{edge:Dt=null}=e,{connections:ut=[]}=e,{useDefaults:wt=!1}=e,{center:It=!1}=e,{dynamic:ht=!1}=e,{title:Z=""}=e;const et=g.nodes;yt(i,et,st=>o(10,h=st)),xe("dynamic",ht);let G,it=!0;Ki(()=>{const st=F?"TD":j?"LR":g.direction,se=g.groupBoxes.get(y),Ot=g.nodes.count()+1;o(8,it=!_.default),(_.anchorWest||_.anchorEast||_.anchorNorth||_.anchorSouth)&&o(8,it=!1);const Bt=C||(K||N?{width:K||N||200,height:N||K||100}:it?{width:200,height:100}:{width:0,height:0}),Gt={id:S||Ot,position:P==="cursor"?{x:Lt(g.cursor).x,y:Lt(g.cursor).y}:se?{x:Lt(se.position).x+k.x,y:Lt(se.position).y+k.y}:k,dimensions:Bt,editable:pt||g.editable,label:ot,group:y,resizable:rt,inputs:tt,outputs:at,zIndex:_t,direction:st,locked:X,rotation:q};ut.length&&(Gt.connections=ut),W&&(Gt.borderWidth=W),z&&(Gt.borderRadius=z),O&&(Gt.borderColor=O),$&&(Gt.selectionColor=$),Q&&(Gt.textColor=Q),x&&(Gt.bgColor=x),Dt&&(Gt.edge=Dt),o(7,G=Nc(Gt)),se&&g.groups.update(ee=>{const he=Lt(ee[y].nodes);return ee[y].nodes.set(new Set([...he,G])),ee}),g.nodes.add(G,G.id)}),co(()=>{g.nodes.delete(G.id)});function Xt(st){G&&G.connections.set([st])}function me(st){if(!G)return;(Array.isArray(st)?st:[st]).forEach(Ot=>{const[Bt,Gt]=Array.isArray(Ot)?Ot:[Ot,null],ee=`N-${Bt}`,he=g.nodes.get(ee);if(!he)return;let Je=null;const Ze=Gt?`A-${Gt}/${ee}`:null;Ze&&(Je=he.anchors.get(Ze));const qt=g.edges.match(G,he,Je);qt.length&&g.edges.delete(qt[qt.length-1])})}xe("connect",Xt),xe("disconnect",me);let gt=k;function zt(st){ei.call(this,i,st)}function Nt(st){ei.call(this,i,st)}function bt(st){ei.call(this,i,st)}function Kt(st){ei.call(this,i,st)}function oe(st){ei.call(this,i,st)}function pe(st){ei.call(this,i,st)}return i.$$set=st=>{"position"in st&&o(15,k=st.position),"drop"in st&&o(0,P=st.drop),"dimensions"in st&&o(1,C=st.dimensions),"id"in st&&o(16,S=st.id),"bgColor"in st&&o(17,x=st.bgColor),"borderRadius"in st&&o(18,z=st.borderRadius),"borderColor"in st&&o(19,O=st.borderColor),"borderWidth"in st&&o(20,W=st.borderWidth),"selectionColor"in st&&o(21,$=st.selectionColor),"textColor"in st&&o(22,Q=st.textColor),"resizable"in st&&o(23,rt=st.resizable),"label"in st&&o(24,ot=st.label),"inputs"in st&&o(25,tt=st.inputs),"outputs"in st&&o(26,at=st.outputs),"width"in st&&o(2,K=st.width),"height"in st&&o(3,N=st.height),"TD"in st&&o(27,F=st.TD),"LR"in st&&o(28,j=st.LR),"zIndex"in st&&o(29,_t=st.zIndex),"editable"in st&&o(30,pt=st.editable),"locked"in st&&o(31,X=st.locked),"rotation"in st&&o(32,q=st.rotation),"edge"in st&&o(33,Dt=st.edge),"connections"in st&&o(34,ut=st.connections),"useDefaults"in st&&o(4,wt=st.useDefaults),"center"in st&&o(5,It=st.center),"dynamic"in st&&o(35,ht=st.dynamic),"title"in st&&o(6,Z=st.title),"$$scope"in st&&o(45,f=st.$$scope)},i.$$.update=()=>{if(i.$$.dirty[0]&128|i.$$.dirty[1]&8&&G&&G.connections.set(ut),i.$$.dirty[0]&131200&&G&&G.bgColor.set(x),i.$$.dirty[0]&16777344&&G&&G.label.set(ot),i.$$.dirty[0]&4194432&&G&&G.textColor.set(Q),i.$$.dirty[0]&524416&&G&&G.borderColor.set(O),i.$$.dirty[0]&2097280&&G&&G.selectionColor.set($),i.$$.dirty[0]&8388736&&G&&G.resizable.set(rt),i.$$.dirty[0]&1073741952&&G&&G.editable.set(pt),i.$$.dirty[0]&128|i.$$.dirty[1]&1&&G&&G.locked.set(X),i.$$.dirty[0]&33554560&&G&&G.inputs.set(tt),i.$$.dirty[0]&67108992&&G&&G.outputs.set(at),i.$$.dirty[0]&536871040&&G&&G.zIndex.set(_t),i.$$.dirty[0]&128&&l(o(9,r=G&&(G==null?void 0:G.position))),i.$$.dirty[0]&32896|i.$$.dirty[1]&96&&G){const{x:st,y:se}=gt,{x:Ot,y:Bt}=n,{x:Gt,y:ee}=k;(Gt!==Ot||ee!==Bt)&&(Gt!==st||ee!==se?(o(36,gt=k),G.position.set(k)):(o(36,gt=n),o(15,k=n)))}i.$$.dirty[0]&33554560&&G&&G.inputs.set(tt),i.$$.dirty[0]&67108992&&G&&G.outputs.set(at)},[P,C,K,N,wt,It,Z,G,it,r,h,g,et,Xt,me,k,S,x,z,O,W,$,Q,rt,ot,tt,at,F,j,_t,pt,X,q,Dt,ut,ht,gt,n,u,zt,Nt,bt,Kt,oe,pe,f]}class us extends Mi{constructor(e){super(),ki(this,e,xu,Du,ui,{position:15,drop:0,dimensions:1,id:16,bgColor:17,borderRadius:18,borderColor:19,borderWidth:20,selectionColor:21,textColor:22,resizable:23,label:24,inputs:25,outputs:26,width:2,height:3,TD:27,LR:28,zIndex:29,editable:30,locked:31,rotation:32,edge:33,connections:34,useDefaults:4,center:5,dynamic:35,title:6},null,[-1,-1])}}function zu(i){i.parentNodes.forEach(a=>Iu(a));const[e,o]=Ou(i);Au(e,i),Nu(e);for(let a=0;a<10;a++){let l=!1;for(let h=0;h<=o;h++)if(e[h])for(let u=0;u<e[h].length;u++){const f=e[h][u],_=Ru(e,f,u);_&&(In(e[h],u,_),l=!0)}if(!l)break}const r=Zu(e);for(let a=0;a<10&&Hu(e,r);a++);for(let a=0;a<2;a++){let l=!1;for(let h=0;h<=o;h++)for(let u=0;u<e[h].length;u++){const f=e[h][u],_=Bu(e,f,u);_&&(In(e[h],u,_),l=!0)}if(!l)break}const n=[];for(let a=0;a<=o;a++)n.push(e[a]);return n}function Iu(i,e=0,o=0){const r=[],n=(a,l=0,h=0)=>{a.depth=Math.max(a.depth,l),a.nesting=Math.max(a.nesting,h),r.push(a);for(const u of a.children){const{node:f,length:_}=u;n(f,_+l,h+1)}};n(i,e,o);for(const a of r)if(a.children.length){a.nesting=a.children[0].node.nesting-1,a.depth=a.children[0].node.depth-a.children[0].length;for(const l of a.children)a.nesting=Math.min(a.nesting,l.node.nesting-1),a.depth=Math.min(a.depth,l.node.depth-l.length)}}function Ou(i){let e=0;const o={};for(const r in i.nodeList){const{depth:n,parents:a,children:l,type:h,data:u}=i.nodeList[r];e=Math.max(e,n),o[n]||(o[n]=[]);const f={id:r,label:u.content,children:[],parents:[],layer:n,type:h.trim()};u.props&&(f.propsId=u.props.trim());for(const _ of a)f.parents.push(_.node.id);for(const _ of l)f.children.push(_.node.id);o[n].push(f)}return[o,e]}function Au(i,e){for(const o in e.nodeList)for(const r of e.nodeList[o].children)if(r.node.depth-1>e.nodeList[o].depth){const n=e.nodeList[o].depth+1,a=r.node.depth-1,l=[];let h=0;for(let u=n;u<=a;u++){const f={id:`GHOST_${r.node.id}_${h}`,label:"",children:[],parents:[],layer:u,ignore:!0};l.push(f),h++}for(const u of r.node.parents)l[0].parents.push(u.node.id);l[l.length-1].children.push(r.node.id);for(let u=0;u<l.length-1;u++)l[u].children.push(`GHOST_${r.node.id}_${u+1}`);for(let u=a;u>=n;u--)l.length>0&&i[u].push(l[0]);for(const u of i[e.nodeList[o].depth])u.id===o&&(u.children.push(l[0].id),u.children=u.children.filter(f=>f!==r.node.id))}}function Nu(i){let e=0;for(const o in i)e=Math.max(i[o].length,e);for(const o in i)if(i[o].length<e){const r=Array.from({length:e-i[o].length},()=>({id:"NULL_NODE",children:[],parents:[],layer:parseInt(o),ignore:!0}));i[o]=i[o].concat(r)}}function Hr(i,e,o){let r=0,n=0;for(const a of e.parents){for(let l=0;l<i[e.layer-1].length;l++)if(a===i[e.layer-1][l].id){r+=Math.abs(o-l);break}n++}for(const a of e.children){for(let l=0;l<i[e.layer+1].length;l++)if(a===i[e.layer+1][l].id){r+=Math.abs(o-l);break}n++}return isNaN(r/n)?0:r/n}function Fr(i,e,o){let r=0,n=0;for(const a of e.parents){for(let l=0;l<i[e.layer-1].length;l++)if(a===i[e.layer-1][l].id){r+=Math.abs(o-l);break}n++}return isNaN(r/n)?0:r/n}function Gr(i,e,o){let r=0,n=0;for(const a of e.children){for(let l=0;l<i[e.layer+1].length;l++)if(a===i[e.layer+1][l].id){r+=Math.abs(o-l);break}n++}return isNaN(r/n)?0:r/n}function Bu(i,e,o){const r=as(i,e.layer);let n=0;e.layer===0?n=Gr(i,e,o):n=Fr(i,e,o);let a=n,l=o;for(let h=0;h<i[e.layer].length;h++)if(i[e.layer][h].id==="NULL_NODE"){In(i[e.layer],o,h);const f=as(i,e.layer);let _=0;e.layer===0?_=Gr(i,e,h):_=Fr(i,e,h),f<=r&&_<a&&(a=_,l=h),In(i[e.layer],h,o)}return l===o?null:l}function Ru(i,e,o){const r={};let n=1/0,a=0;for(let l=0;l<i[e.layer].length;l++){const h=Hr(i,e,l),u=Hr(i,i[e.layer][l],o);r[l]=h+u}for(const l in r)r[l]<n&&(n=r[l],a=parseInt(l));return a===o?null:a}function In(i,e,o){const r=i[e];i[e]=i[o],i[o]=r}function Zu(i){const e=[];for(const o in i)for(const r of i[o])e.push(r);return e.sort((o,r)=>r.parents.length+r.children.length-(o.parents.length+o.children.length))}function as(i,e){let o=0;for(let r=0;r<i[e].length;r++){const n=i[e][r],a=[],l=[];if(i[e-1])for(let h=r+1;h<i[e-1].length;h++)n.parents.includes(i[e-1][h].id)&&a.push(h);if(i[e+1])for(let h=r+1;h<i[e+1].length;h++)n.children.includes(i[e+1][h].id)&&l.push(h);for(let h=r+1;h<i[e].length;h++){const u=i[e][h];if(a.length)for(let f=0;f<i[e-1].length;f++)u.parents.includes(i[e-1][f].id)&&a.forEach(_=>{f<_&&o++});if(l.length)for(let f=0;f<i[e+1].length;f++)u.children.includes(i[e+1][f].id)&&l.forEach(_=>{f<_&&o++})}}return o}function Hu(i,e){let o=!1;for(const r of e){if(r.children.length+r.parents.length===0)return o;let n=0;for(let h=0;h<i[r.layer].length;h++)if(i[r.layer][h].id===r.id){n=h;break}let a=1/0,l=n;for(let h=0;h<i[r.layer].length;h++){In(i[r.layer],n,h);const u=as(i,r.layer);u<a&&(a=u,l=h),In(i[r.layer],h,n)}l!==n&&(In(i[r.layer],n,l),o=!0)}return o}function qr(i,e,o){const r=i.slice();return r[6]=e[o],r}function Ur(i,e,o){const r=i.slice();return r[9]=e[o],r}function Fu(i){let e,o;const r=[{label:i[9].label},{id:i[9].id},{TD:!0},i[0][i[9].id],{connections:i[9].children.map(Vr)}];let n={};for(let a=0;a<r.length;a+=1)n=cs(n,r[a]);return e=new us({props:n}),{c(){ce(e.$$.fragment)},m(a,l){re(e,a,l),o=!0},p(a,l){const h=l&3?ul(r,[l&2&&{label:a[9].label},l&2&&{id:a[9].id},r[2],dl(a[0][a[9].id]),l&2&&{connections:a[9].children.map(Vr)}]):{};e.$set(h)},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){U(e.$$.fragment,a),o=!1},d(a){ae(e,a)}}}function Wr(i){let e,o,r=!i[9].ignore&&Fu(i);return{c(){r&&r.c(),e=De()},m(n,a){r&&r.m(n,a),J(n,e,a),o=!0},p(n,a){n[9].ignore||r.p(n,a)},i(n){o||(B(r),o=!0)},o(n){U(r),o=!1},d(n){n&&Y(e),r&&r.d(n)}}}function jr(i){let e,o,r=ke(i[6]),n=[];for(let l=0;l<r.length;l+=1)n[l]=Wr(Ur(i,r,l));const a=l=>U(n[l],1,1,()=>{n[l]=null});return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=De()},m(l,h){for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(l,h);J(l,e,h),o=!0},p(l,h){if(h&3){r=ke(l[6]);let u;for(u=0;u<r.length;u+=1){const f=Ur(l,r,u);n[u]?(n[u].p(f,h),B(n[u],1)):(n[u]=Wr(f),n[u].c(),B(n[u],1),n[u].m(e.parentNode,e))}for(we(),u=r.length;u<n.length;u+=1)a(u);Le()}},i(l){if(!o){for(let h=0;h<r.length;h+=1)B(n[h]);o=!0}},o(l){n=n.filter(Boolean);for(let h=0;h<n.length;h+=1)U(n[h]);o=!1},d(l){l&&Y(e),Sn(n,l)}}}function Gu(i){let e,o,r=ke(i[1]),n=[];for(let l=0;l<r.length;l+=1)n[l]=jr(qr(i,r,l));const a=l=>U(n[l],1,1,()=>{n[l]=null});return{c(){for(let l=0;l<n.length;l+=1)n[l].c();e=De()},m(l,h){for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(l,h);J(l,e,h),o=!0},p(l,[h]){if(h&3){r=ke(l[1]);let u;for(u=0;u<r.length;u+=1){const f=qr(l,r,u);n[u]?(n[u].p(f,h),B(n[u],1)):(n[u]=jr(f),n[u].c(),B(n[u],1),n[u].m(e.parentNode,e))}for(we(),u=r.length;u<n.length;u+=1)a(u);Le()}},i(l){if(!o){for(let h=0;h<r.length;h+=1)B(n[h]);o=!0}},o(l){n=n.filter(Boolean);for(let h=0;h<n.length;h+=1)U(n[h]);o=!1},d(l){l&&Y(e),Sn(n,l)}}}const qu=100,Uu=100,Vr=i=>[i,"1"];function Wu(i,e,o){let{mermaid:r=""}=e,{mermaidConfig:n={}}=e;const a=Qc(r);xe("flowchart",a);const l=zu(a),h=_e("graph");let u;return Ki(()=>{h.nodes.subscribe(_=>u=Object.fromEntries(_));let f=0;for(const _ of l){let g=0,y=-1/0;for(const k of _)k.ignore||(u[`N-${k.id}`].position.update(()=>({x:g,y:f})),u[`N-${k.id}`].dimensions.width.subscribe(P=>g+=P),u[`N-${k.id}`].dimensions.height.subscribe(P=>y=Math.max(y,P))),g+=qu;f+=y+Uu}}),i.$$set=f=>{"mermaid"in f&&o(2,r=f.mermaid),"mermaidConfig"in f&&o(0,n=f.mermaidConfig)},[n,l,r]}class ju extends Mi{constructor(e){super(),ki(this,e,Wu,Gu,ui,{mermaid:2,mermaidConfig:0})}}const Vu="modulepreload",Yu=function(i){return"/"+i},Yr={},eo=function(e,o,r){let n=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),h=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));n=Promise.allSettled(o.map(u=>{if(u=Yu(u),u in Yr)return;Yr[u]=!0;const f=u.endsWith(".css"),_=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${_}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":Vu,f||(g.as="script"),g.crossOrigin="",g.href=u,h&&g.setAttribute("nonce",h),document.head.appendChild(g),f)return new Promise((y,k)=>{g.addEventListener("load",y),g.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(l){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l}return n.then(l=>{for(const h of l||[])h.status==="rejected"&&a(h.reason);return e().catch(a)})},Xu=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"],Ku=new Set(Xu),Xr=i=>Ku.has(i);function Ju(i){let e,o,r;return{c(){e=T("input"),p(e,"placeholder",i[0]),p(e,"type","text")},m(n,a){J(n,e,a),Ge(e,i[1]),o||(r=[ft(e,"keydown",nn(i[3])),ft(e,"click",nn(i[4])),ft(e,"mousedown",nn(i[5])),ft(e,"input",i[6])],o=!0)},p(n,[a]){a&1&&p(e,"placeholder",n[0]),a&2&&e.value!==n[1]&&Ge(e,n[1])},i:Ft,o:Ft,d(n){n&&Y(e),o=!1,si(r)}}}function Qu(i,e,o){let r,{placeholder:n}=e;const a=_e("textStore");yt(i,a,_=>o(1,r=_));function l(_){ei.call(this,i,_)}function h(_){ei.call(this,i,_)}function u(_){ei.call(this,i,_)}function f(){r=this.value,a.set(r)}return i.$$set=_=>{"placeholder"in _&&o(0,n=_.placeholder)},[n,r,a,l,h,u,f]}class $u extends Mi{constructor(e){super(),ki(this,e,Qu,Ju,ui,{placeholder:0})}}function td(i){let e,o,r,n,a,l,h,u,f,_,g,y,k;return l=new $u({props:{placeholder:"Node Label"}}),{c(){e=T("div"),o=T("span"),o.textContent="Editor",r=V(),n=T("button"),n.textContent="X",a=V(),ce(l.$$.fragment),h=V(),u=T("button"),u.textContent="Delete Node",f=V(),_=T("button"),_.textContent="Resize Node",lt(o,"color","white"),lt(o,"font-size","45px"),lt(n,"position","absolute"),lt(n,"top","10px"),lt(n,"right","10px"),p(e,"class","editor svelte-1nv0yho")},m(P,C){J(P,e,C),w(e,o),w(e,r),w(e,n),w(e,a),re(l,e,null),w(e,h),w(e,u),w(e,f),w(e,_),g=!0,y||(k=[ft(n,"click",i[6]),ft(u,"click",i[3]),ft(_,"click",i[4]),ft(e,"contextmenu",i[2])],y=!0)},p:Ft,i(P){g||(B(l.$$.fragment,P),g=!0)},o(P){U(l.$$.fragment,P),g=!1},d(P){P&&Y(e),ae(l),y=!1,si(k)}}}function ed(i){let e,o;return e=new us({props:{zIndex:1/0,position:i[0],bgColor:"white",id:"editor",$$slots:{default:[td]},$$scope:{ctx:i}}}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},p(r,[n]){const a={};n&1&&(a.position=r[0]),n&512&&(a.$$scope={dirty:n,ctx:r}),e.$set(a)},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function id(i,e,o){let{editing:r}=e;const n=_e("graph");xe("graph",n),xe("textStore",r.label),xe("colorStore",r.bgColor);let a={x:150,y:50};function l(_){_.preventDefault(),o(0,a={x:_.clientX,y:_.clientY}),n.editing.set(r)}function h(){n.nodes.delete(r.id),n.editing.set(null)}function u(){const _=r.id,g=n.nodes.get(_);if(g){const y=g.dimensions.width,k=g.dimensions.height,P=prompt("Enter new width (for example:250):",y?y.toString():""),C=prompt("Enter new height (for example:200):",k?k.toString():"");if(P===null||C===null)return;g.dimensions.width.set(parseInt(P,10)||0),g.dimensions.height.set(parseInt(C,10)||0),g.resizingWidth.set(!0),g.resizingHeight.set(!0)}}const f=()=>n.editing.set(null);return i.$$set=_=>{"editing"in _&&o(5,r=_.editing)},n.cursor,[a,n,l,h,u,r,f]}class nd extends Mi{constructor(e){super(),ki(this,e,id,ed,ui,{editing:5})}}function od(i){let e,o,r,n;return{c(){e=T("div"),o=T("div"),p(o,"class","bounding-box svelte-1e5jg43"),lt(o,"background-color",i[6]),p(e,"role","button"),p(e,"tabindex","0"),p(e,"class","bounding-box-border svelte-1e5jg43"),p(e,"id",i[2]),lt(e,"border","solid 4px "+i[6]),lt(e,"top",`${i[3].y}px`),lt(e,"left",`${i[3].x}px`),lt(e,"width",`${i[4]}px`),lt(e,"height",`${i[5]}px`)},m(a,l){J(a,e,l),w(e,o),r||(n=[ft(e,"contextmenu",nn(Xi(i[12]))),ft(e,"mousedown",nn(Xi(i[9])))],r=!0)},p(a,[l]){l&64&&lt(o,"background-color",a[6]),l&4&&p(e,"id",a[2]),l&64&&lt(e,"border","solid 4px "+a[6]);const h=l&64;(l&72||h)&&lt(e,"top",`${a[3].y}px`),(l&72||h)&&lt(e,"left",`${a[3].x}px`),(l&80||h)&&lt(e,"width",`${a[4]}px`),(l&96||h)&&lt(e,"height",`${a[5]}px`)},i:Ft,o:Ft,d(a){a&&Y(e),r=!1,si(n)}}}function sd(i,e,o){let r,n,a=Ft,l=()=>(a(),a=mi(k,$=>o(3,n=$)),k),h,u,f,_=Ft,g=()=>(_(),_=mi(P,$=>o(6,f=$)),P);i.$$.on_destroy.push(()=>a()),i.$$.on_destroy.push(()=>_());let{dimensions:y}=e,{position:k}=e;l();let{color:P}=e;g();let{groupName:C}=e;const{width:S,height:x}=y;yt(i,S,$=>o(4,h=$)),yt(i,x,$=>o(5,u=$));const z=Yn();function O(){z("groupClick",{groupName:C})}function W($){ei.call(this,i,$)}return i.$$set=$=>{"dimensions"in $&&o(10,y=$.dimensions),"position"in $&&l(o(0,k=$.position)),"color"in $&&g(o(1,P=$.color)),"groupName"in $&&o(11,C=$.groupName)},i.$$.update=()=>{i.$$.dirty&2048&&o(2,r=`${C}-bounding-box`)},[k,P,r,n,h,u,f,S,x,O,y,C,W]}class rd extends Mi{constructor(e){super(),ki(this,e,sd,od,ui,{dimensions:10,position:0,color:1,groupName:11})}}function Kr(i,e,o){const r=i.slice();return r[4]=e[o][0],r[5]=e[o][1],r}function Jr(i,e){let o,r,n;const a=[e[5],{groupName:e[4]}];let l={};for(let h=0;h<a.length;h+=1)l=cs(l,a[h]);return r=new rd({props:l}),r.$on("groupClick",e[2]),{key:i,first:null,c(){o=De(),ce(r.$$.fragment),this.first=o},m(h,u){J(h,o,u),re(r,h,u),n=!0},p(h,u){e=h;const f=u&1?ul(a,[dl(e[5]),{groupName:e[4]}]):{};r.$set(f)},i(h){n||(B(r.$$.fragment,h),n=!0)},o(h){U(r.$$.fragment,h),n=!1},d(h){h&&Y(o),ae(r,h)}}}function ad(i){let e=[],o=new Map,r,n,a=ke(Array.from(i[0]));const l=h=>h[4];for(let h=0;h<a.length;h+=1){let u=Kr(i,a,h),f=l(u);o.set(f,e[h]=Jr(f,u))}return{c(){for(let h=0;h<e.length;h+=1)e[h].c();r=De()},m(h,u){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(h,u);J(h,r,u),n=!0},p(h,[u]){u&1&&(a=ke(Array.from(h[0])),we(),e=wn(e,u,l,1,h,a,o,r.parentNode,ao,Jr,r,Kr),Le())},i(h){if(!n){for(let u=0;u<a.length;u+=1)B(e[u]);n=!0}},o(h){for(let u=0;u<e.length;u+=1)U(e[u]);n=!1},d(h){h&&Y(r);for(let u=0;u<e.length;u+=1)e[u].d(h)}}}function ld(i,e,o){let r;const a=_e("graph").groupBoxes;yt(i,a,h=>o(0,r=h));function l(h){ei.call(this,i,h)}return[r,a,l]}class cd extends Mi{constructor(e){super(),ki(this,e,ld,ad,ui,{})}}function hd(i){let e,o,r,n;const a=i[11].default,l=Ee(a,i,i[10],null);return{c(){e=T("div"),l&&l.c(),p(e,"class","svelvet-graph-wrapper svelte-19pa6i0"),p(e,"role","presentation"),lt(e,"transform",i[0])},m(h,u){J(h,e,u),l&&l.m(e,null),o=!0,r||(n=[ft(e,"contextmenu",no(Xi(i[12]))),ft(e,"click",no(Xi(i[13]))),ft(e,"touchstart",no(Xi(i[14])))],r=!0)},p(h,[u]){l&&l.p&&(!o||u&1024)&&Te(l,a,h,h[10],o?Ce(a,h[10],u,null):Se(h[10]),null),u&1&&lt(e,"transform",h[0])},i(h){o||(B(l,h),o=!0)},o(h){U(l,h),o=!1},d(h){h&&Y(e),l&&l.d(h),r=!1,si(n)}}}function ud(i,e,o){let r,n,a,l,h,{$$slots:u={},$$scope:f}=e;const _=_e("graph"),g=_.transforms,y=g.scale;yt(i,y,Q=>o(9,h=Q));const k=g.translation;yt(i,k,Q=>o(8,l=Q));const P=_.cursor;yt(i,P,Q=>o(15,a=Q));let{isMovable:C}=e,S,x=!1;function z(){At(k,l=ch(Lt(Gi),a,g),l),o(5,S=requestAnimationFrame(z))}function O(Q){ei.call(this,i,Q)}function W(Q){ei.call(this,i,Q)}function $(Q){ei.call(this,i,Q)}return i.$$set=Q=>{"isMovable"in Q&&o(4,C=Q.isMovable),"$$scope"in Q&&o(10,f=Q.$$scope)},i.$$.update=()=>{i.$$.dirty&256&&o(7,r=l),i.$$.dirty&640&&o(0,n=`translate(${r.x}px, ${r.y}px) scale(${h})`),i.$$.dirty&112&&(C&&!x?(o(6,x=!0),o(5,S=requestAnimationFrame(z))):(!C||!x)&&(o(6,x=!1),cancelAnimationFrame(S)))},[n,y,k,P,C,S,x,r,l,h,f,u,O,W,$]}class dd extends Mi{constructor(e){super(),ki(this,e,ud,hd,ui,{isMovable:4})}}function fd(i){let e,o,r;const n=i[8].default,a=Ee(n,i,i[9],null);return o=new cd({}),o.$on("groupClick",i[5]),{c(){a&&a.c(),e=V(),ce(o.$$.fragment)},m(l,h){a&&a.m(l,h),J(l,e,h),re(o,l,h),r=!0},p(l,h){a&&a.p&&(!r||h&512)&&Te(a,n,l,l[9],r?Ce(n,l[9],h,null):Se(l[9]),null)},i(l){r||(B(a,l),B(o.$$.fragment,l),r=!0)},o(l){U(a,l),U(o.$$.fragment,l),r=!1},d(l){l&&Y(e),a&&a.d(l),ae(o,l)}}}function _d(i){let e,o;return e=new dd({props:{isMovable:i[0],$$slots:{default:[fd]},$$scope:{ctx:i}}}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},p(r,[n]){const a={};n&1&&(a.isMovable=r[0]),n&512&&(a.$$scope={dirty:n,ctx:r}),e.$set(a)},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function md(i,e,o){let r,n,a,l,h,u;yt(i,Gi,O=>o(13,l=O)),yt(i,ji,O=>o(7,u=O));let{$$slots:f={},$$scope:_}=e;console.log("Componente GraphRenderer.svelte");const g=_e("graph"),y=_e("snapTo");let{isMovable:k}=e;const P=g.activeGroup;yt(i,P,O=>o(6,h=O));const C=g.groups;yt(i,C,O=>o(10,r=O));const S=g.initialNodePositions;yt(i,S,O=>o(11,n=O));const x=g.cursor;yt(i,x,O=>o(12,a=O));function z(O){At(ji,u=!0,u);const{groupName:W}=O.detail;At(P,h=W,h),At(Gi,l=a,l),At(S,n=vl(r[W].nodes),n)}return i.$$set=O=>{"isMovable"in O&&o(0,k=O.isMovable),"$$scope"in O&&o(9,_=O.$$scope)},i.$$.update=()=>{i.$$.dirty&192&&h&&u&&vh(g,y)},[k,P,C,S,x,z,h,u,f,_]}class pd extends Mi{constructor(e){super(),ki(this,e,md,_d,ui,{isMovable:0})}}function gd(i){let e,o;return{c(){e=Jt("line"),o=Jt("line"),p(e,"class","background-line svelte-rryw83"),p(e,"x1",i[11]),p(e,"y1",0),p(e,"x2",i[11]),p(e,"y2",i[6]),p(e,"stroke-width",i[5]),lt(e,"--calculated-dot-color",i[2]),p(o,"class","background-line svelte-rryw83"),p(o,"y1",i[11]),p(o,"x1",0),p(o,"y2",i[11]),p(o,"x2",i[6]),p(o,"stroke-width",i[5]),lt(o,"--calculated-dot-color",i[2])},m(r,n){J(r,e,n),J(r,o,n)},p(r,n){n&2048&&p(e,"x1",r[11]),n&2048&&p(e,"x2",r[11]),n&64&&p(e,"y2",r[6]),n&32&&p(e,"stroke-width",r[5]),n&4&&lt(e,"--calculated-dot-color",r[2]),n&2048&&p(o,"y1",r[11]),n&2048&&p(o,"y2",r[11]),n&64&&p(o,"x2",r[6]),n&32&&p(o,"stroke-width",r[5]),n&4&&lt(o,"--calculated-dot-color",r[2])},d(r){r&&(Y(e),Y(o))}}}function vd(i){let e;return{c(){e=Jt("circle"),p(e,"class","background-dot svelte-rryw83"),p(e,"r",i[5]),p(e,"cx",i[11]),p(e,"cy",i[11]),lt(e,"--calculated-dot-color",i[2])},m(o,r){J(o,e,r)},p(o,r){r&32&&p(e,"r",o[5]),r&2048&&p(e,"cx",o[11]),r&2048&&p(e,"cy",o[11]),r&4&&lt(e,"--calculated-dot-color",o[2])},d(o){o&&Y(e)}}}function Qr(i){let e,o,r;function n(h,u){if(h[0]==="dots")return bd;if(h[0]==="lines")return yd}let a=n(i),l=a&&a(i);return{c(){e=Jt("pattern"),l&&l.c(),p(e,"id","graph-coarse-pattern"),p(e,"x",i[7]),p(e,"y",i[8]),p(e,"width",o=i[6]*i[3]),p(e,"height",r=i[6]*i[3]),p(e,"patternUnits","userSpaceOnUse")},m(h,u){J(h,e,u),l&&l.m(e,null)},p(h,u){a===(a=n(h))&&l?l.p(h,u):(l&&l.d(1),l=a&&a(h),l&&(l.c(),l.m(e,null))),u&128&&p(e,"x",h[7]),u&256&&p(e,"y",h[8]),u&72&&o!==(o=h[6]*h[3])&&p(e,"width",o),u&72&&r!==(r=h[6]*h[3])&&p(e,"height",r)},d(h){h&&Y(e),l&&l.d()}}}function yd(i){let e,o,r,n,a,l;return{c(){e=Jt("line"),n=Jt("line"),p(e,"class","background-line svelte-rryw83"),p(e,"x1",i[11]),p(e,"y1",0),p(e,"x2",i[11]),p(e,"y2",o=i[6]*i[3]),p(e,"stroke-width",r=i[5]*1.2),lt(e,"--calculated-dot-color",i[2]),p(n,"class","background-line svelte-rryw83"),p(n,"y1",i[11]),p(n,"x1",0),p(n,"y2",i[11]),p(n,"x2",a=i[6]*i[3]),p(n,"stroke-width",l=i[5]*1.2),lt(n,"--calculated-dot-color",i[2])},m(h,u){J(h,e,u),J(h,n,u)},p(h,u){u&2048&&p(e,"x1",h[11]),u&2048&&p(e,"x2",h[11]),u&72&&o!==(o=h[6]*h[3])&&p(e,"y2",o),u&32&&r!==(r=h[5]*1.2)&&p(e,"stroke-width",r),u&4&&lt(e,"--calculated-dot-color",h[2]),u&2048&&p(n,"y1",h[11]),u&2048&&p(n,"y2",h[11]),u&72&&a!==(a=h[6]*h[3])&&p(n,"x2",a),u&32&&l!==(l=h[5]*1.2)&&p(n,"stroke-width",l),u&4&&lt(n,"--calculated-dot-color",h[2])},d(h){h&&(Y(e),Y(n))}}}function bd(i){let e,o;return{c(){e=Jt("circle"),p(e,"class","background-dot svelte-rryw83"),p(e,"r",o=i[5]*2),p(e,"cx",i[11]),p(e,"cy",i[11]),lt(e,"--calculated-dot-color",i[2])},m(r,n){J(r,e,n)},p(r,n){n&32&&o!==(o=r[5]*2)&&p(e,"r",o),n&2048&&p(e,"cx",r[11]),n&2048&&p(e,"cy",r[11]),n&4&&lt(e,"--calculated-dot-color",r[2])},d(r){r&&Y(e)}}}function $r(i){let e;return{c(){e=Jt("rect"),p(e,"width","100%"),p(e,"height","100%"),p(e,"fill","url(#graph-coarse-pattern)"),p(e,"opacity",i[10])},m(o,r){J(o,e,r)},p(o,r){r&1024&&p(e,"opacity",o[10])},d(o){o&&Y(e)}}}function wd(i){let e,o,r,n,a;function l(g,y){if(g[0]==="dots")return vd;if(g[0]==="lines")return gd}let h=l(i),u=h&&h(i),f=i[3]>0&&Qr(i),_=i[3]>0&&$r(i);return{c(){e=T("div"),o=Jt("svg"),r=Jt("defs"),n=Jt("pattern"),u&&u.c(),f&&f.c(),a=Jt("rect"),_&&_.c(),p(n,"id","graph-pattern"),p(n,"x",i[7]),p(n,"y",i[8]),p(n,"width",i[6]),p(n,"height",i[6]),p(n,"patternUnits","userSpaceOnUse"),p(a,"width","100%"),p(a,"height","100%"),p(a,"fill","url(#graph-pattern)"),p(a,"opacity",i[9]),p(o,"class","svelte-rryw83"),p(e,"id","background-wrapper"),p(e,"class","svelte-rryw83"),lt(e,"--calculated-background-color",i[1])},m(g,y){J(g,e,y),w(e,o),w(o,r),w(r,n),u&&u.m(n,null),f&&f.m(r,null),w(o,a),_&&_.m(o,null),i[24](e)},p(g,[y]){h===(h=l(g))&&u?u.p(g,y):(u&&u.d(1),u=h&&h(g),u&&(u.c(),u.m(n,null))),y&128&&p(n,"x",g[7]),y&256&&p(n,"y",g[8]),y&64&&p(n,"width",g[6]),y&64&&p(n,"height",g[6]),g[3]>0?f?f.p(g,y):(f=Qr(g),f.c(),f.m(r,null)):f&&(f.d(1),f=null),y&512&&p(a,"opacity",g[9]),g[3]>0?_?_.p(g,y):(_=$r(g),_.c(),_.m(o,null)):_&&(_.d(1),_=null),y&2&&lt(e,"--calculated-background-color",g[1])},i:Ft,o:Ft,d(g){g&&Y(e),u&&u.d(),f&&f.d(),_&&_.d(),i[24](null)}}}function Ld(i,e,o){let r,n,a,l,h,u,f;const _=_e("graph");let{style:g="dots"}=e,{gridWidth:y=qc}=e,{dotSize:k=Uc}=e,{bgColor:P=null}=e,{dotColor:C=null}=e,{opacityThreshold:S=3}=e,{majorGrid:x=0}=e,{minOpacity:z=.4}=e;const O=_.transforms,W=O.scale;yt(i,W,j=>o(22,u=j));const $=O.translation;yt(i,$,j=>o(23,f=j));let Q,rt,ot,tt,at,K=1,N=1;function F(j){on[j?"unshift":"push"](()=>{Q=j,o(4,Q)})}return i.$$set=j=>{"style"in j&&o(0,g=j.style),"gridWidth"in j&&o(14,y=j.gridWidth),"dotSize"in j&&o(15,k=j.dotSize),"bgColor"in j&&o(1,P=j.bgColor),"dotColor"in j&&o(2,C=j.dotColor),"opacityThreshold"in j&&o(16,S=j.opacityThreshold),"majorGrid"in j&&o(3,x=j.majorGrid),"minOpacity"in j&&o(17,z=j.minOpacity)},i.$$.update=()=>{i.$$.dirty&8388608&&o(21,r=f),i.$$.dirty&4194304&&o(20,n=u),i.$$.dirty&1064960&&o(6,a=n*y),i.$$.dirty&1081344&&o(5,l=n*k/2),i.$$.dirty&64&&o(11,h=a/2),i.$$.dirty&4128816&&(o(18,rt=(Q==null?void 0:Q.offsetWidth)||0),o(19,ot=(Q==null?void 0:Q.offsetHeight)||0),o(7,tt=(rt+l)*(1-n)/2+r.x),o(8,at=(ot+l)*(1-n)/2+r.y),o(9,K=n>S?1:n/S+z),o(10,N=n>S/3?1:n/(S/3)+z))},[g,P,C,x,Q,l,a,tt,at,K,N,h,W,$,y,k,S,z,rt,ot,n,r,u,f,F]}class kd extends Mi{constructor(e){super(),ki(this,e,Ld,wd,ui,{style:0,gridWidth:14,dotSize:15,bgColor:1,dotColor:2,opacityThreshold:16,majorGrid:3,minOpacity:17})}}function Md(i){let e,o;return{c(){e=T("div"),o=T("div"),p(o,"class","selection-box svelte-10ds4jd"),jt(o,"creating",i[0]),p(e,"class","selection-border svelte-10ds4jd"),jt(e,"creating",i[0]),lt(e,"--prop-selection-box-color",i[1]),lt(e,"height",i[4]),lt(e,"width",i[3]),lt(e,"top",i[6]),lt(e,"left",i[5])},m(r,n){J(r,e,n),w(e,o),i[18](o)},p(r,[n]){n&1&&jt(o,"creating",r[0]),n&1&&jt(e,"creating",r[0]),n&2&&lt(e,"--prop-selection-box-color",r[1]),n&16&&lt(e,"height",r[4]),n&8&&lt(e,"width",r[3]),n&64&&lt(e,"top",r[6]),n&32&&lt(e,"left",r[5])},i:Ft,o:Ft,d(r){r&&Y(e),i[18](null)}}}function Pd(i,e,o){let r,n,a,l,h,u,f,_,g,y,k=Ft,P=()=>(k(),k=mi(r,N=>o(20,y=N)),r),C,S;yt(i,_l,N=>o(16,C=N)),i.$$.on_destroy.push(()=>k());let{graph:x}=e,{anchor:z}=e,{adding:O=!1}=e,{creating:W=!1}=e,{color:$=null}=e;const{groups:Q}=x;yt(i,Q,N=>o(17,S=N));let rt,ot;Ki(tt);function tt(){rt=Array.from(document.querySelectorAll(".svelvet-node")).map(F=>{const{top:j,left:_t,width:pt,height:X}=F.getBoundingClientRect();return{id:F.id,top:j,left:_t,width:pt,height:X}})}function at(){if(!rt)return;const N=rt.reduce((F,j)=>{if(h+z.left<=j.left&&l+z.top<=j.top&&h+z.left+Math.abs(a)>=j.left+j.width&&l+z.top+Math.abs(n)>=j.top+j.height){const _t=j.id,pt=x.nodes.get(_t);if(!pt)return F;F.push(pt)}return F},[]);O?N.forEach(F=>{y.add(F)}):At(r,y=new Set(N),y),r.set(y)}function K(N){on[N?"unshift":"push"](()=>{ot=N,o(2,ot)})}return i.$$set=N=>{"graph"in N&&o(9,x=N.graph),"anchor"in N&&o(10,z=N.anchor),"adding"in N&&o(11,O=N.adding),"creating"in N&&o(0,W=N.creating),"color"in N&&o(1,$=N.color)},i.$$.update=()=>{i.$$.dirty&131072&&P(o(7,r=S.selected.nodes)),i.$$.dirty&66560&&o(12,n=C.y-z.y-z.top),i.$$.dirty&66560&&o(14,a=C.x-z.x-z.left),i.$$.dirty&5120&&o(13,l=Math.min(z.y,z.y+n)),i.$$.dirty&17408&&o(15,h=Math.min(z.x,z.x+a)),i.$$.dirty&8192&&o(6,u=`${l}px`),i.$$.dirty&32768&&o(5,f=`${h}px`),i.$$.dirty&4096&&o(4,_=`${Math.abs(n)}px`),i.$$.dirty&16384&&o(3,g=`${Math.abs(a)}px`),i.$$.dirty&20480&&(a||n)&&at()},[W,$,ot,g,_,f,u,r,Q,x,z,O,n,l,a,h,C,S,K]}class Ed extends Mi{constructor(e){super(),ki(this,e,Pd,Md,ui,{graph:9,anchor:10,adding:11,creating:0,color:1})}}const Cd=i=>({}),ta=i=>({}),Td=i=>({}),ea=i=>({}),Sd=i=>({}),ia=i=>({}),Dd=i=>({}),na=i=>({}),xd=i=>({}),oa=i=>({}),zd=i=>({}),sa=i=>({});function ra(i){let e,o;return e=new nd({props:{editing:i[24]}}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},p(r,n){const a={};n[0]&16777216&&(a.editing=r[24]),e.$set(a)},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Id(i){let e,o,r=i[24]&&ra(i);const n=i[56].default,a=Ee(n,i,i[58],null);return{c(){r&&r.c(),e=V(),a&&a.c()},m(l,h){r&&r.m(l,h),J(l,e,h),a&&a.m(l,h),o=!0},p(l,h){l[24]?r?(r.p(l,h),h[0]&16777216&&B(r,1)):(r=ra(l),r.c(),B(r,1),r.m(e.parentNode,e)):r&&(we(),U(r,1,1,()=>{r=null}),Le()),a&&a.p&&(!o||h[1]&134217728)&&Te(a,n,l,l[58],o?Ce(n,l[58],h,null):Se(l[58]),null)},i(l){o||(B(r),B(a,l),o=!0)},o(l){U(r),U(a,l),o=!1},d(l){l&&Y(e),r&&r.d(l),a&&a.d(l)}}}function Od(i){let e,o;return e=new kd({}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},p:Ft,i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Ad(i){let e;const o=i[56].background,r=Ee(o,i,i[58],sa);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,a){r&&r.p&&(!e||a[1]&134217728)&&Te(r,o,n,n[58],e?Ce(o,n[58],a,zd):Se(n[58]),sa)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function aa(i){let e,o,r;var n=i[14];function a(l,h){return{}}return n&&(e=pn(n,a())),{c(){e&&ce(e.$$.fragment),o=De()},m(l,h){e&&re(e,l,h),J(l,o,h),r=!0},p(l,h){if(h[0]&16384&&n!==(n=l[14])){if(e){we();const u=e;U(u.$$.fragment,1,0,()=>{ae(u,1)}),Le()}n?(e=pn(n,a()),ce(e.$$.fragment),B(e.$$.fragment,1),re(e,o.parentNode,o)):e=null}},i(l){r||(e&&B(e.$$.fragment,l),r=!0)},o(l){e&&U(e.$$.fragment,l),r=!1},d(l){l&&Y(o),e&&ae(e,l)}}}function la(i){let e,o,r;var n=i[15];function a(l,h){return{}}return n&&(e=pn(n,a())),{c(){e&&ce(e.$$.fragment),o=De()},m(l,h){e&&re(e,l,h),J(l,o,h),r=!0},p(l,h){if(h[0]&32768&&n!==(n=l[15])){if(e){we();const u=e;U(u.$$.fragment,1,0,()=>{ae(u,1)}),Le()}n?(e=pn(n,a()),ce(e.$$.fragment),B(e.$$.fragment,1),re(e,o.parentNode,o)):e=null}},i(l){r||(e&&B(e.$$.fragment,l),r=!0)},o(l){e&&U(e.$$.fragment,l),r=!1},d(l){l&&Y(o),e&&ae(e,l)}}}function ca(i){let e,o,r;var n=i[13];function a(l,h){return{}}return n&&(e=pn(n,a())),{c(){e&&ce(e.$$.fragment),o=De()},m(l,h){e&&re(e,l,h),J(l,o,h),r=!0},p(l,h){if(h[0]&8192&&n!==(n=l[13])){if(e){we();const u=e;U(u.$$.fragment,1,0,()=>{ae(u,1)}),Le()}n?(e=pn(n,a()),ce(e.$$.fragment),B(e.$$.fragment,1),re(e,o.parentNode,o)):e=null}},i(l){r||(e&&B(e.$$.fragment,l),r=!0)},o(l){e&&U(e.$$.fragment,l),r=!1},d(l){l&&Y(o),e&&ae(e,l)}}}function ha(i){let e,o,r;var n=i[16];function a(l,h){return{}}return n&&(e=pn(n,a())),{c(){e&&ce(e.$$.fragment),o=De()},m(l,h){e&&re(e,l,h),J(l,o,h),r=!0},p(l,h){if(h[0]&65536&&n!==(n=l[16])){if(e){we();const u=e;U(u.$$.fragment,1,0,()=>{ae(u,1)}),Le()}n?(e=pn(n,a()),ce(e.$$.fragment),B(e.$$.fragment,1),re(e,o.parentNode,o)):e=null}},i(l){r||(e&&B(e.$$.fragment,l),r=!0)},o(l){e&&U(e.$$.fragment,l),r=!1},d(l){l&&Y(o),e&&ae(e,l)}}}function ua(i){let e,o,r;var n=i[17];function a(l,h){return{}}return n&&(e=pn(n,a())),{c(){e&&ce(e.$$.fragment),o=De()},m(l,h){e&&re(e,l,h),J(l,o,h),r=!0},p(l,h){if(h[0]&131072&&n!==(n=l[17])){if(e){we();const u=e;U(u.$$.fragment,1,0,()=>{ae(u,1)}),Le()}n?(e=pn(n,a()),ce(e.$$.fragment),B(e.$$.fragment,1),re(e,o.parentNode,o)):e=null}},i(l){r||(e&&B(e.$$.fragment,l),r=!0)},o(l){e&&U(e.$$.fragment,l),r=!1},d(l){l&&Y(o),e&&ae(e,l)}}}function da(i){let e,o;return e=new Ed({props:{creating:i[20],anchor:i[18],graph:i[3],adding:i[21],color:i[9]}}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},p(r,n){const a={};n[0]&1048576&&(a.creating=r[20]),n[0]&262144&&(a.anchor=r[18]),n[0]&8&&(a.graph=r[3]),n[0]&2097152&&(a.adding=r[21]),n[0]&512&&(a.color=r[9]),e.$set(a)},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Nd(i){let e,o,r,n,a,l,h,u,f,_,g,y,k,P,C,S,x,z,O,W;o=new pd({props:{isMovable:i[22],$$slots:{default:[Id]},$$scope:{ctx:i}}});const $=[Ad,Od],Q=[];function rt(Z,et){return Z[10]?0:1}n=rt(i),a=Q[n]=$[n](i);let ot=i[0]&&aa(i),tt=i[1]&&la(i),at=i[6]&&ca(i),K=i[2]&&ha(i),N=i[12]&&ua(i);const F=i[56].minimap,j=Ee(F,i,i[58],oa),_t=i[56].drawer,pt=Ee(_t,i,i[58],na),X=i[56].controls,q=Ee(X,i,i[58],ia),Dt=i[56].toggle,ut=Ee(Dt,i,i[58],ea),wt=i[56].contrast,It=Ee(wt,i,i[58],ta);let ht=i[19]&&!i[8]&&da(i);return{c(){e=T("section"),ce(o.$$.fragment),r=V(),a.c(),l=V(),ot&&ot.c(),h=V(),tt&&tt.c(),u=V(),at&&at.c(),f=V(),K&&K.c(),_=V(),N&&N.c(),g=V(),j&&j.c(),y=V(),pt&&pt.c(),k=V(),q&&q.c(),P=V(),ut&&ut.c(),C=V(),It&&It.c(),S=V(),ht&&ht.c(),p(e,"role","presentation"),p(e,"id",x=i[3].id),p(e,"class","svelvet-wrapper svelte-13nq7cv"),p(e,"title",i[11]),p(e,"tabindex",0),lt(e,"width",i[4]?i[4]+"px":"100%"),lt(e,"height",i[5]?i[5]+"px":"100%"),lt(e,"cursor",i[7]?"move":"default")},m(Z,et){J(Z,e,et),re(o,e,null),w(e,r),Q[n].m(e,null),w(e,l),ot&&ot.m(e,null),w(e,h),tt&&tt.m(e,null),w(e,u),at&&at.m(e,null),w(e,f),K&&K.m(e,null),w(e,_),N&&N.m(e,null),w(e,g),j&&j.m(e,null),w(e,y),pt&&pt.m(e,null),w(e,k),q&&q.m(e,null),w(e,P),ut&&ut.m(e,null),w(e,C),It&&It.m(e,null),w(e,S),ht&&ht.m(e,null),i[57](e),z=!0,O||(W=[ft(window,"touchend",i[36]),ft(window,"mouseup",i[36]),ft(window,"resize",i[35]),ft(window,"scroll",i[35]),ft(e,"wheel",Xi(i[43])),ft(e,"mousedown",no(Xi(i[37]))),ft(e,"touchend",Xi(i[39])),ft(e,"touchstart",no(Xi(i[38]))),ft(e,"keydown",i[40]),ft(e,"keyup",i[42]),ft(e,"dragover",Xi(Bd)),ft(e,"drop",i[41])],O=!0)},p(Z,et){const G={};et[0]&4194304&&(G.isMovable=Z[22]),et[0]&16777216|et[1]&134217728&&(G.$$scope={dirty:et,ctx:Z}),o.$set(G);let it=n;n=rt(Z),n===it?Q[n].p(Z,et):(we(),U(Q[it],1,1,()=>{Q[it]=null}),Le(),a=Q[n],a?a.p(Z,et):(a=Q[n]=$[n](Z),a.c()),B(a,1),a.m(e,l)),Z[0]?ot?(ot.p(Z,et),et[0]&1&&B(ot,1)):(ot=aa(Z),ot.c(),B(ot,1),ot.m(e,h)):ot&&(we(),U(ot,1,1,()=>{ot=null}),Le()),Z[1]?tt?(tt.p(Z,et),et[0]&2&&B(tt,1)):(tt=la(Z),tt.c(),B(tt,1),tt.m(e,u)):tt&&(we(),U(tt,1,1,()=>{tt=null}),Le()),Z[6]?at?(at.p(Z,et),et[0]&64&&B(at,1)):(at=ca(Z),at.c(),B(at,1),at.m(e,f)):at&&(we(),U(at,1,1,()=>{at=null}),Le()),Z[2]?K?(K.p(Z,et),et[0]&4&&B(K,1)):(K=ha(Z),K.c(),B(K,1),K.m(e,_)):K&&(we(),U(K,1,1,()=>{K=null}),Le()),Z[12]?N?(N.p(Z,et),et[0]&4096&&B(N,1)):(N=ua(Z),N.c(),B(N,1),N.m(e,g)):N&&(we(),U(N,1,1,()=>{N=null}),Le()),j&&j.p&&(!z||et[1]&134217728)&&Te(j,F,Z,Z[58],z?Ce(F,Z[58],et,xd):Se(Z[58]),oa),pt&&pt.p&&(!z||et[1]&134217728)&&Te(pt,_t,Z,Z[58],z?Ce(_t,Z[58],et,Dd):Se(Z[58]),na),q&&q.p&&(!z||et[1]&134217728)&&Te(q,X,Z,Z[58],z?Ce(X,Z[58],et,Sd):Se(Z[58]),ia),ut&&ut.p&&(!z||et[1]&134217728)&&Te(ut,Dt,Z,Z[58],z?Ce(Dt,Z[58],et,Td):Se(Z[58]),ea),It&&It.p&&(!z||et[1]&134217728)&&Te(It,wt,Z,Z[58],z?Ce(wt,Z[58],et,Cd):Se(Z[58]),ta),Z[19]&&!Z[8]?ht?(ht.p(Z,et),et[0]&524544&&B(ht,1)):(ht=da(Z),ht.c(),B(ht,1),ht.m(e,null)):ht&&(we(),U(ht,1,1,()=>{ht=null}),Le()),(!z||et[0]&8&&x!==(x=Z[3].id))&&p(e,"id",x),(!z||et[0]&2048)&&p(e,"title",Z[11]),et[0]&16&&lt(e,"width",Z[4]?Z[4]+"px":"100%"),et[0]&32&&lt(e,"height",Z[5]?Z[5]+"px":"100%"),et[0]&128&&lt(e,"cursor",Z[7]?"move":"default")},i(Z){z||(B(o.$$.fragment,Z),B(a),B(ot),B(tt),B(at),B(K),B(N),B(j,Z),B(pt,Z),B(q,Z),B(ut,Z),B(It,Z),B(ht),z=!0)},o(Z){U(o.$$.fragment,Z),U(a),U(ot),U(tt),U(at),U(K),U(N),U(j,Z),U(pt,Z),U(q,Z),U(ut,Z),U(It,Z),U(ht),z=!1},d(Z){Z&&Y(e),ae(o),Q[n].d(),ot&&ot.d(),tt&&tt.d(),at&&at.d(),K&&K.d(),N&&N.d(),j&&j.d(Z),pt&&pt.d(Z),q&&q.d(Z),ut&&ut.d(Z),It&&It.d(Z),ht&&ht.d(),i[57](null),O=!1,si(W)}}}function Bd(i){i.preventDefault()}function Rd(i,e,o){let r,n,a,l,h,u,f,_,g,y,k,P,C,S,x;yt(i,ss,b=>o(70,f=b)),yt(i,Gi,b=>o(71,_=b)),yt(i,ji,b=>o(72,g=b)),yt(i,mn,b=>o(75,P=b));let{$$slots:z={},$$scope:O}=e,{graph:W}=e,{width:$}=e,{height:Q}=e,{minimap:rt=!1}=e,{controls:ot=!1}=e,{toggle:tt=!1}=e,{fixedZoom:at=!1}=e,{pannable:K=!0}=e,{disableSelection:N=!1}=e,{ZOOM_INCREMENT:F=.1}=e,{PAN_INCREMENT:j=50}=e,{PAN_TIME:_t=250}=e,{MAX_SCALE:pt=3}=e,{MIN_SCALE:X=.2}=e,{selectionColor:q}=e,{backgroundExists:Dt}=e,{fitView:ut=!1}=e,{trackpadPan:wt}=e,{modifier:It}=e,{theme:ht="light"}=e,{title:Z}=e,{drawer:et=!1}=e,{contrast:G=!1}=e;console.log("Initial Graph drawer prop:",et);let it;const Xt=Yn(),me={},gt=nt(!1),zt=nt(0),Nt=nt(null);yt(i,Nt,b=>o(23,h=b));const bt=W.cursor,Kt=W.transforms.scale;yt(i,Kt,b=>o(68,l=b));const oe=W.dimensions;yt(i,oe,b=>o(55,S=b));const pe=W.transforms.translation;yt(i,pe,b=>o(67,a=b));const st=W.groups;yt(i,st,b=>o(69,u=b));const se=W.groupBoxes,Ot=u.selected.nodes;yt(i,Ot,b=>o(66,n=b));const Bt=W.activeGroup;yt(i,Bt,b=>o(74,k=b));const Gt=W.initialNodePositions;yt(i,Gt,b=>o(73,y=b));const ee=W.editing;yt(i,ee,b=>o(24,x=b));const he=W.bounds.nodeBounds;yt(i,he,b=>o(76,C=b));let Je=0,Ze=1,qt={x:0,y:0,top:0,left:0},He=!1,Ve=!1,ze=!1,Vt=!1,ue=!1,ve=!1,Qt,Ye=null,di=null,ri=null,Ie=null,Zt=null;const Me={id:null,position:W.cursor,offset:nt({x:0,y:0}),connected:nt(new Set),dynamic:nt(!1),edge:null,edgeColor:nt(null),direction:nt("self"),inputKey:null,type:"output",moving:Do(!1),store:null,mounted:nt(!0),rotation:Do(0),node:{zIndex:nt(1/0),rotating:nt(!1),position:W.cursor,dimensions:{width:nt(0),height:nt(0)}}};xe("graphDOMElement",Nt),xe("cursorAnchor",Me),xe("duplicate",gt),xe("graph",W),xe("transforms",W.transforms),xe("dimensions",W.dimensions),xe("locked",W.locked),xe("groups",W.groups),xe("bounds",W.bounds),xe("edgeStore",W.edges),xe("nodeStore",W.nodes),xe("mounted",zt),Ki(()=>{console.log("Graph component mounted with drawer1:",et),li()});async function Qe(){await cl(),ji.set(!0);const{x:b,y:mt,scale:Et}=_h(Qt,C);b!==null&&mt!==null&&Et!==null&&(W.transforms.scale.set(Et),pe.set({x:b,y:mt})),ji.set(!1),o(54,ve=!0)}async function fi(){o(14,di=(await eo(async()=>{const{default:b}=await import("./Minimap-BBGNZUgr.js");return{default:b}},[])).default)}async function ai(){o(13,Ye=(await eo(async()=>{const{default:b}=await import("./ThemeToggle-BofurOVQ.js");return{default:b}},[])).default)}async function qe(){o(15,ri=(await eo(async()=>{const{default:b}=await import("./Controls-BeLp0NWk.js");return{default:b}},__vite__mapDeps([0,1]))).default)}async function Oe(){o(16,Ie=(await eo(async()=>{const{default:b}=await import("./DrawerController-CUoswhtj.js");return{default:b}},__vite__mapDeps([2,1,3]))).default)}async function Ae(){o(17,Zt=(await eo(async()=>{const{default:b}=await import("./ContrastTheme-Cv9l24Gg.js");return{default:b}},[])).default)}function li(){if(!h)return;const b=h.getBoundingClientRect();Qt={top:b.top,left:b.left,bottom:b.bottom,right:b.right,width:b.width,height:b.height},W.dimensions.set(Qt),ut==="resize"&&Qe()}function $t(b){if(Ve){const Pt=`${ih()}/${W.id}`,xt=Lt(bt),A=xt.x-_.x,Yt=xt.y-_.y,de=Math.min(_.y,_.y+Yt),te=Math.min(_.x,_.x+A),ge={width:nt(Math.abs(A)),height:nt(Math.abs(Yt))},Xe=nt({x:te,y:de}),We={group:nt(Pt),dimensions:ge,position:Xe,color:nt(Xc()),moving:nt(!1)};se.add(We,Pt),Array.from(n).forEach(Ci=>{Ci.group.set(Pt)}),st.update(Ci=>{const Pi={parent:nt(We),nodes:nt(new Set([...n,We]))};return Ci[Pt]=Pi,Ci}),At(Ot,n=new Set,n),o(20,Ve=!1),o(19,He=!1)}k&&Array.from(Lt(u[k].nodes)).forEach(Pt=>{const xt=So(Lt(Pt.position).x,Lt(Pt.position).y);Pt.position.set(xt),Pt.moving.set(!1)});const mt=W.edges.get("cursor");mt&&(W.edges.delete("cursor"),mt.disconnect||Xt("edgeDrop",{cursor:Lt(bt),source:{node:P==null?void 0:P.anchor.node.id.slice(2),anchor:P==null?void 0:P.anchor.id.split("/")[0].slice(2)}})),At(Bt,k=null,k),At(Gi,_={x:0,y:0},_),At(Gt,y=[],y),o(19,He=!1),o(22,Vt=!1),At(ji,g=!1,g),b.shiftKey||mn.set(null),o(18,qt.y=0,qt),o(18,qt.x=0,qt)}function ie(b){if(!K&&!(b.shiftKey||b.metaKey)||b.button===2)return;h&&h.focus();const{clientX:mt,clientY:Et}=b;if(At(Gi,_=Lt(bt),_),b.shiftKey||b.metaKey){b.preventDefault(),o(19,He=!0);const{top:Pt,left:xt}=r;o(18,qt.y=Et-Pt,qt),o(18,qt.x=mt-xt,qt),o(18,qt.top=Pt,qt),o(18,qt.left=xt,qt),b.shiftKey&&b.metaKey?o(20,Ve=!0):o(20,Ve=!1),b.metaKey&&!b.shiftKey?o(21,ze=!0):o(21,ze=!1)}else o(22,Vt=!0),At(Ot,n=new Set,n),Ot.set(n)}function ii(b){At(Ot,n=new Set,n),Ot.set(n),At(Gi,_=Lt(bt),_),o(22,Vt=!0),b.touches.length===2&&($e(),Je=f,Ze=l)}function ni(){o(22,Vt=!1),ue=!1}function $e(){ue||(ue=!0,it=requestAnimationFrame(Ei))}function Ei(){if(!ue){cancelAnimationFrame(it);return}const mt=f/Je;At(Kt,l=Ze*mt,l),it=requestAnimationFrame(Ei)}function Bi(b){const{key:mt,code:Et}=b,Pt=b.target;if(!(Pt.tagName=="INPUT"||Pt.tagName=="TEXTAREA")){if(Et==="KeyA"&&b[`${It}Key`]){const xt=W.nodes.getAll().filter(A=>!Lt(A.locked));At(Ot,n=new Set(xt),n)}else if(Xr(mt))ti(mt,b);else if(mt==="=")tr(-1,W.dimensions,W.transforms,F);else if(mt==="-")tr(1,W.dimensions,W.transforms,F);else if(mt==="0")Qe();else if(mt==="Control")u.selected.nodes.set(new Set);else if(Et==="KeyD"&&b[`${It}Key`])gt.set(!0),setTimeout(()=>{gt.set(!1)},100);else if(mt==="Tab"&&(b.altKey||b.ctrlKey))kt();else if(mt==="l")o(44,ht=ht==="light"?"dark":"light");else if(mt==="d")o(2,et=!et);else if(mt==="m")o(0,rt=!rt);else if(mt==="c")o(1,ot=!ot);else if(mt==="e"){const xt=Array.from(n)[0];W.editing.set(xt)}else return;b.preventDefault()}}function Ue(b){b.preventDefault();const mt=h==null?void 0:h.getBoundingClientRect();if(!mt)return;const Et=b.clientX-mt.left,Pt=b.clientY-mt.top,{x:xt,y:A}=So(Et,Pt);if(console.log(`Dropped Node at Snapped Position: (${xt}, ${A})`),!de)return;const Yt={id:`node-${Date.now()}`,rotation:nt(0),position:nt({x:xt,y:A}),moving:nt(!1),label:nt("New Node"),dimensions:{width:nt(200),height:nt(100)},inputs:nt(2),outputs:nt(2),anchors:nt([]),group:nt(null),collapsed:nt(!1),resizingWidth:nt(!1),resizingHeight:nt(!1),rotating:nt(!1),editable:nt(!0),locked:nt(!1),recalculateAnchors:te=>{},resizable:nt(!0),zIndex:nt(1),edge:null,direction:nt("TD"),borderRadius:nt(5),borderWidth:nt(1),connections:nt([]),bgColor:nt("#007bff"),borderColor:nt("#000"),selectionColor:nt("#ff0000"),textColor:nt("#fff")};let de=null;W.nodes.add(Yt,Yt.id),de=null}function kt(){const b=W.nodes.getAll(),mt=b.findIndex(Pt=>n.has(Pt)),Et=mt+1;n.delete(b[mt]),n.add(b[Et])}function gi(b){const{key:mt}=b;Xr(mt)?(clearInterval(me[mt]),delete me[mt]):mt==="Shift"&&mn.set(null)}function ci(b){if(at)return;const mt=b.shiftKey?.15:1,{clientX:Et,clientY:Pt,deltaY:xt}=b,A=a,Yt={x:Et,y:Pt};if((wt||b.metaKey)&&xt%1===0){At(pe,a={x:At(pe,a.x-=b.deltaX,a),y:At(pe,a.y-=b.deltaY,a)},a);return}if(l>=pt&&xt<0||l<=X&&xt>0)return;const de=Math.min(.009*mt*Math.abs(xt),.08),te=pl(l,Math.sign(xt),de),ge=ml(l,te,A,Yt,Qt);Kt.set(te),pe.set(ge)}function ti(b,mt){const Et=mt.shiftKey?2:1,Pt=b==="ArrowLeft"||b==="ArrowUp"?1:-1,xt=b==="ArrowLeft"||b==="ArrowRight",A=xt?a.x:a.y,Yt=A+Pt*j*Et;if(!me[b]){const de=performance.now();let te=setInterval(()=>{const ge=performance.now()-de;if(n.size===0){const Xe=A+(Yt-A)*(ge/_t);pe.set({x:xt?Xe:a.x,y:xt?a.y:Xe})}else{const Xe={x:xt?-Pt*2:0,y:xt?0:-Pt*2};Array.from(n).forEach(We=>{const Ci=Lt(We.position);let Pi;const sn=Lt(We.group),Vi=Lt(W.groupBoxes);if(sn&&(Pi=Vi.get(sn)),Pi){const xi=Lt(We.dimensions.width),Ti=Lt(We.dimensions.height),Ji=bl(Pi,xi,Ti);yl(Ci,Xe,We.position,Ji)}else{const xi={x:Ci.x+Xe.x,y:Ci.y+Xe.y},Ti=So(xi.x,xi.y);We.position.set(Ti)}})}},2);me[b]=te}}function vi(b){on[b?"unshift":"push"](()=>{h=b,Nt.set(h)})}return i.$$set=b=>{"graph"in b&&o(3,W=b.graph),"width"in b&&o(4,$=b.width),"height"in b&&o(5,Q=b.height),"minimap"in b&&o(0,rt=b.minimap),"controls"in b&&o(1,ot=b.controls),"toggle"in b&&o(6,tt=b.toggle),"fixedZoom"in b&&o(45,at=b.fixedZoom),"pannable"in b&&o(7,K=b.pannable),"disableSelection"in b&&o(8,N=b.disableSelection),"ZOOM_INCREMENT"in b&&o(46,F=b.ZOOM_INCREMENT),"PAN_INCREMENT"in b&&o(47,j=b.PAN_INCREMENT),"PAN_TIME"in b&&o(48,_t=b.PAN_TIME),"MAX_SCALE"in b&&o(49,pt=b.MAX_SCALE),"MIN_SCALE"in b&&o(50,X=b.MIN_SCALE),"selectionColor"in b&&o(9,q=b.selectionColor),"backgroundExists"in b&&o(10,Dt=b.backgroundExists),"fitView"in b&&o(51,ut=b.fitView),"trackpadPan"in b&&o(52,wt=b.trackpadPan),"modifier"in b&&o(53,It=b.modifier),"theme"in b&&o(44,ht=b.theme),"title"in b&&o(11,Z=b.title),"drawer"in b&&o(2,et=b.drawer),"contrast"in b&&o(12,G=b.contrast),"$$scope"in b&&o(58,O=b.$$scope)},i.$$.update=()=>{i.$$.dirty[1]&16777216&&(r=S),i.$$.dirty[1]&8192&&ht&&document.documentElement.setAttribute("svelvet-theme",ht),i.$$.dirty[1]&9437184&&!ve&&ut&&Qe(),i.$$.dirty[0]&8256&&tt&&!Ye&&ai(),i.$$.dirty[0]&16385&&rt&&!di&&fi(),i.$$.dirty[0]&32770&&ot&&!ri&&qe(),i.$$.dirty[0]&65540&&et&&!Ie&&Oe(),i.$$.dirty[0]&135168&&G&&!Zt&&Ae(),i.$$.dirty[0]&4&&console.log("Reactive Graph drawer prop:",et)},[rt,ot,et,W,$,Q,tt,K,N,q,Dt,Z,G,Ye,di,ri,Ie,Zt,qt,He,Ve,ze,Vt,h,x,Nt,Kt,oe,pe,st,Ot,Bt,Gt,ee,he,li,$t,ie,ii,ni,Bi,Ue,gi,ci,ht,at,F,j,_t,pt,X,ut,wt,It,ve,S,z,vi,O]}class Zd extends Mi{constructor(e){super(),ki(this,e,Rd,Nd,ui,{graph:3,width:4,height:5,minimap:0,controls:1,toggle:6,fixedZoom:45,pannable:7,disableSelection:8,ZOOM_INCREMENT:46,PAN_INCREMENT:47,PAN_TIME:48,MAX_SCALE:49,MIN_SCALE:50,selectionColor:9,backgroundExists:10,fitView:51,trackpadPan:52,modifier:53,theme:44,title:11,drawer:2,contrast:12},null,[-1,-1,-1])}}const Hd=i=>({}),fa=i=>({slot:"minimap"}),Fd=i=>({}),_a=i=>({slot:"controls"}),Gd=i=>({}),ma=i=>({slot:"background"}),qd=i=>({}),pa=i=>({slot:"toggle"}),Ud=i=>({}),ga=i=>({slot:"drawer"}),Wd=i=>({}),va=i=>({slot:"contrast"});function jd(i){let e;return{c(){e=T("div"),p(e,"class","svelvet-temp svelte-lsy29y"),lt(e,"width",i[2]?i[2]+"px":"100%"),lt(e,"height",i[3]?i[3]+"px":"100%")},m(o,r){J(o,e,r)},p(o,r){r[0]&4&&lt(e,"width",o[2]?o[2]+"px":"100%"),r[0]&8&&lt(e,"height",o[3]?o[3]+"px":"100%")},i:Ft,o:Ft,d(o){o&&Y(e)}}}function Vd(i){let e,o;return e=new Zd({props:{width:i[2],height:i[3],toggle:i[6],backgroundExists:i[19],minimap:i[4],graph:i[18],fitView:i[9],fixedZoom:i[16],pannable:i[17],theme:i[1],drawer:i[7],controls:i[5],selectionColor:i[10],disableSelection:i[11],trackpadPan:i[13],modifier:i[14],title:i[15],contrast:i[8],$$slots:{contrast:[tf],drawer:[$d],toggle:[Qd],background:[Jd],controls:[Kd],minimap:[Xd],default:[Yd]},$$scope:{ctx:i}}}),e.$on("edgeDrop",i[35]),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},p(r,n){const a={};n[0]&4&&(a.width=r[2]),n[0]&8&&(a.height=r[3]),n[0]&64&&(a.toggle=r[6]),n[0]&524288&&(a.backgroundExists=r[19]),n[0]&16&&(a.minimap=r[4]),n[0]&262144&&(a.graph=r[18]),n[0]&512&&(a.fitView=r[9]),n[0]&65536&&(a.fixedZoom=r[16]),n[0]&131072&&(a.pannable=r[17]),n[0]&2&&(a.theme=r[1]),n[0]&128&&(a.drawer=r[7]),n[0]&32&&(a.controls=r[5]),n[0]&1024&&(a.selectionColor=r[10]),n[0]&2048&&(a.disableSelection=r[11]),n[0]&8192&&(a.trackpadPan=r[13]),n[0]&16384&&(a.modifier=r[14]),n[0]&32768&&(a.title=r[15]),n[0]&256&&(a.contrast=r[8]),n[0]&4097|n[1]&32&&(a.$$scope={dirty:n,ctx:r}),e.$set(a)},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function ya(i){let e,o;return e=new ju({props:{mermaid:i[0],mermaidConfig:i[12]}}),{c(){ce(e.$$.fragment)},m(r,n){re(e,r,n),o=!0},p(r,n){const a={};n[0]&1&&(a.mermaid=r[0]),n[0]&4096&&(a.mermaidConfig=r[12]),e.$set(a)},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){U(e.$$.fragment,r),o=!1},d(r){ae(e,r)}}}function Yd(i){let e,o,r=i[0].length&&ya(i);const n=i[34].default,a=Ee(n,i,i[36],null);return{c(){r&&r.c(),e=V(),a&&a.c()},m(l,h){r&&r.m(l,h),J(l,e,h),a&&a.m(l,h),o=!0},p(l,h){l[0].length?r?(r.p(l,h),h[0]&1&&B(r,1)):(r=ya(l),r.c(),B(r,1),r.m(e.parentNode,e)):r&&(we(),U(r,1,1,()=>{r=null}),Le()),a&&a.p&&(!o||h[1]&32)&&Te(a,n,l,l[36],o?Ce(n,l[36],h,null):Se(l[36]),null)},i(l){o||(B(r),B(a,l),o=!0)},o(l){U(r),U(a,l),o=!1},d(l){l&&Y(e),r&&r.d(l),a&&a.d(l)}}}function Xd(i){let e;const o=i[34].minimap,r=Ee(o,i,i[36],fa);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,a){r&&r.p&&(!e||a[1]&32)&&Te(r,o,n,n[36],e?Ce(o,n[36],a,Hd):Se(n[36]),fa)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function Kd(i){let e;const o=i[34].controls,r=Ee(o,i,i[36],_a);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,a){r&&r.p&&(!e||a[1]&32)&&Te(r,o,n,n[36],e?Ce(o,n[36],a,Fd):Se(n[36]),_a)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function Jd(i){let e;const o=i[34].background,r=Ee(o,i,i[36],ma);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,a){r&&r.p&&(!e||a[1]&32)&&Te(r,o,n,n[36],e?Ce(o,n[36],a,Gd):Se(n[36]),ma)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function Qd(i){let e;const o=i[34].toggle,r=Ee(o,i,i[36],pa);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,a){r&&r.p&&(!e||a[1]&32)&&Te(r,o,n,n[36],e?Ce(o,n[36],a,qd):Se(n[36]),pa)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function $d(i){let e;const o=i[34].drawer,r=Ee(o,i,i[36],ga);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,a){r&&r.p&&(!e||a[1]&32)&&Te(r,o,n,n[36],e?Ce(o,n[36],a,Ud):Se(n[36]),ga)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function tf(i){let e;const o=i[34].contrast,r=Ee(o,i,i[36],va);return{c(){r&&r.c()},m(n,a){r&&r.m(n,a),e=!0},p(n,a){r&&r.p&&(!e||a[1]&32)&&Te(r,o,n,n[36],e?Ce(o,n[36],a,Wd):Se(n[36]),va)},i(n){e||(B(r,n),e=!0)},o(n){U(r,n),e=!1},d(n){r&&r.d(n)}}}function ef(i){let e,o,r,n;const a=[Vd,jd],l=[];function h(u,f){return u[18]?0:1}return e=h(i),o=l[e]=a[e](i),{c(){o.c(),r=De()},m(u,f){l[e].m(u,f),J(u,r,f),n=!0},p(u,f){let _=e;e=h(u),e===_?l[e].p(u,f):(we(),U(l[_],1,1,()=>{l[_]=null}),Le(),o=l[e],o?o.p(u,f):(o=l[e]=a[e](u),o.c()),B(o,1),o.m(r.parentNode,r))},i(u){n||(B(o),n=!0)},o(u){U(o),n=!1},d(u){u&&Y(r),l[e].d(u)}}}function nf(i,e,o){let r,n,{$$slots:a={},$$scope:l}=e;const h=hs(a);let{mermaid:u=""}=e,{theme:f="light"}=e,{id:_=0}=e,{snapTo:g=0}=e,{zoom:y=1}=e,{TD:k=!1}=e,{editable:P=!0}=e,{locked:C=!1}=e,{width:S=0}=e,{height:x=0}=e,{minimap:z=!1}=e,{controls:O=!1}=e,{toggle:W=!1}=e,{drawer:$=!1}=e,{contrast:Q=!1}=e,{fitView:rt=!1}=e,{selectionColor:ot="lightblue"}=e,{edgeStyle:tt="bezier"}=e,{endStyles:at=[null,null]}=e,{edge:K=null}=e,{disableSelection:N=!1}=e,{mermaidConfig:F={}}=e,{translation:j={x:0,y:0}}=e,{trackpadPan:_t=!1}=e,{modifier:pt="meta"}=e,{raiseEdgesOnSelect:X=!1}=e,{edgesAboveNode:q=!1}=e,{title:Dt=""}=e,{fixedZoom:ut=!1}=e,{pannable:wt=!0}=e;const It=Yn();let ht=null,Z=k?"TD":"LR";xe("snapTo",g),xe("edgeStyle",tt),xe("endStyles",at),xe("graphEdge",K),xe("raiseEdgesOnSelect",X),xe("edgesAboveNode",q),xe("graph",ht),Ki(()=>{console.log("Graph component mounted with drawer:",$);const it=localStorage.getItem("state");if(console.log("stateObject during onMount:",it),it)o(18,ht=wh(it)),console.log("This is the graph set using reloadStore",ht),Jo.add(ht,ht.id),console.log("graphStore updated",ht);else{let Xt=`G-${_||Jo.count()+1}`;o(18,ht=gl(Xt,{zoom:y,direction:Z,editable:P,locked:C,translation:j})),Jo.add(ht,Xt)}});function et(it,Xt){if(!ht)return;const me=`N-${it[0]}`,gt=ht.nodes.get(me);if(!gt)return;const zt=gt.anchors.get(`A-${it[1]}/N-${it[0]}`);if(!zt)return;const Nt=`N-${Xt[0]}`,bt=ht.nodes.get(Nt);if(!bt)return;const Kt=bt.anchors.get(`A-${Xt[1]}/N-${Xt[0]}`);if(!Kt)return;const oe=ht.edges.match(zt,Kt);oe&&ht.edges.delete(oe[0])}function G(it){ei.call(this,i,it)}return i.$$set=it=>{"mermaid"in it&&o(0,u=it.mermaid),"theme"in it&&o(1,f=it.theme),"id"in it&&o(20,_=it.id),"snapTo"in it&&o(21,g=it.snapTo),"zoom"in it&&o(22,y=it.zoom),"TD"in it&&o(23,k=it.TD),"editable"in it&&o(24,P=it.editable),"locked"in it&&o(25,C=it.locked),"width"in it&&o(2,S=it.width),"height"in it&&o(3,x=it.height),"minimap"in it&&o(4,z=it.minimap),"controls"in it&&o(5,O=it.controls),"toggle"in it&&o(6,W=it.toggle),"drawer"in it&&o(7,$=it.drawer),"contrast"in it&&o(8,Q=it.contrast),"fitView"in it&&o(9,rt=it.fitView),"selectionColor"in it&&o(10,ot=it.selectionColor),"edgeStyle"in it&&o(26,tt=it.edgeStyle),"endStyles"in it&&o(27,at=it.endStyles),"edge"in it&&o(28,K=it.edge),"disableSelection"in it&&o(11,N=it.disableSelection),"mermaidConfig"in it&&o(12,F=it.mermaidConfig),"translation"in it&&o(29,j=it.translation),"trackpadPan"in it&&o(13,_t=it.trackpadPan),"modifier"in it&&o(14,pt=it.modifier),"raiseEdgesOnSelect"in it&&o(30,X=it.raiseEdgesOnSelect),"edgesAboveNode"in it&&o(31,q=it.edgesAboveNode),"title"in it&&o(15,Dt=it.title),"fixedZoom"in it&&o(16,ut=it.fixedZoom),"pannable"in it&&o(17,wt=it.pannable),"$$scope"in it&&o(36,l=it.$$scope)},i.$$.update=()=>{i.$$.dirty[0]&262144&&o(33,n=ht&&ht.edges),i.$$.dirty[0]&4456448&&ht&&ht.transforms.scale.set(y),i.$$.dirty[1]&4&&n&&n.onEdgeChange((it,Xt)=>{It(Xt,{sourceAnchor:it.source,targetAnchor:it.target,sourceNode:it.source.node,targetNode:it.target.node})})},o(19,r=h.background),[u,f,S,x,z,O,W,$,Q,rt,ot,N,F,_t,pt,Dt,ut,wt,ht,r,_,g,y,k,P,C,tt,at,K,j,X,q,et,n,a,G,l]}class of extends Mi{constructor(e){super(),ki(this,e,nf,ef,ui,{mermaid:0,theme:1,id:20,snapTo:21,zoom:22,TD:23,editable:24,locked:25,width:2,height:3,minimap:4,controls:5,toggle:6,drawer:7,contrast:8,fitView:9,selectionColor:10,edgeStyle:26,endStyles:27,edge:28,disableSelection:11,mermaidConfig:12,translation:29,trackpadPan:13,modifier:14,raiseEdgesOnSelect:30,edgesAboveNode:31,title:15,fixedZoom:16,pannable:17,disconnect:32},null,[-1,-1])}get disconnect(){return this.$$.ctx[32]}}var sf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ls={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(i,e){(function(o,r){r(e)})(sf,function(o){var r="1.9.4";function n(t){var s,c,d,m;for(c=1,d=arguments.length;c<d;c++){m=arguments[c];for(s in m)t[s]=m[s]}return t}var a=Object.create||function(){function t(){}return function(s){return t.prototype=s,new t}}();function l(t,s){var c=Array.prototype.slice;if(t.bind)return t.bind.apply(t,c.call(arguments,1));var d=c.call(arguments,2);return function(){return t.apply(s,d.length?d.concat(c.call(arguments)):arguments)}}var h=0;function u(t){return"_leaflet_id"in t||(t._leaflet_id=++h),t._leaflet_id}function f(t,s,c){var d,m,v,E;return E=function(){d=!1,m&&(v.apply(c,m),m=!1)},v=function(){d?m=arguments:(t.apply(c,arguments),setTimeout(E,s),d=!0)},v}function _(t,s,c){var d=s[1],m=s[0],v=d-m;return t===d&&c?t:((t-m)%v+v)%v+m}function g(){return!1}function y(t,s){if(s===!1)return t;var c=Math.pow(10,s===void 0?6:s);return Math.round(t*c)/c}function k(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function P(t){return k(t).split(/\s+/)}function C(t,s){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?a(t.options):{});for(var c in s)t.options[c]=s[c];return t.options}function S(t,s,c){var d=[];for(var m in t)d.push(encodeURIComponent(c?m.toUpperCase():m)+"="+encodeURIComponent(t[m]));return(!s||s.indexOf("?")===-1?"?":"&")+d.join("&")}var x=/\{ *([\w_ -]+) *\}/g;function z(t,s){return t.replace(x,function(c,d){var m=s[d];if(m===void 0)throw new Error("No value provided for variable "+c);return typeof m=="function"&&(m=m(s)),m})}var O=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function W(t,s){for(var c=0;c<t.length;c++)if(t[c]===s)return c;return-1}var $="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function Q(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var rt=0;function ot(t){var s=+new Date,c=Math.max(0,16-(s-rt));return rt=s+c,window.setTimeout(t,c)}var tt=window.requestAnimationFrame||Q("RequestAnimationFrame")||ot,at=window.cancelAnimationFrame||Q("CancelAnimationFrame")||Q("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function K(t,s,c){if(c&&tt===ot)t.call(s);else return tt.call(window,l(t,s))}function N(t){t&&at.call(window,t)}var F={__proto__:null,extend:n,create:a,bind:l,get lastId(){return h},stamp:u,throttle:f,wrapNum:_,falseFn:g,formatNum:y,trim:k,splitWords:P,setOptions:C,getParamString:S,template:z,isArray:O,indexOf:W,emptyImageUrl:$,requestFn:tt,cancelFn:at,requestAnimFrame:K,cancelAnimFrame:N};function j(){}j.extend=function(t){var s=function(){C(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},c=s.__super__=this.prototype,d=a(c);d.constructor=s,s.prototype=d;for(var m in this)Object.prototype.hasOwnProperty.call(this,m)&&m!=="prototype"&&m!=="__super__"&&(s[m]=this[m]);return t.statics&&n(s,t.statics),t.includes&&(_t(t.includes),n.apply(null,[d].concat(t.includes))),n(d,t),delete d.statics,delete d.includes,d.options&&(d.options=c.options?a(c.options):{},n(d.options,t.options)),d._initHooks=[],d.callInitHooks=function(){if(!this._initHooksCalled){c.callInitHooks&&c.callInitHooks.call(this),this._initHooksCalled=!0;for(var v=0,E=d._initHooks.length;v<E;v++)d._initHooks[v].call(this)}},s},j.include=function(t){var s=this.prototype.options;return n(this.prototype,t),t.options&&(this.prototype.options=s,this.mergeOptions(t.options)),this},j.mergeOptions=function(t){return n(this.prototype.options,t),this},j.addInitHook=function(t){var s=Array.prototype.slice.call(arguments,1),c=typeof t=="function"?t:function(){this[t].apply(this,s)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(c),this};function _t(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=O(t)?t:[t];for(var s=0;s<t.length;s++)t[s]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var pt={on:function(t,s,c){if(typeof t=="object")for(var d in t)this._on(d,t[d],s);else{t=P(t);for(var m=0,v=t.length;m<v;m++)this._on(t[m],s,c)}return this},off:function(t,s,c){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var d in t)this._off(d,t[d],s);else{t=P(t);for(var m=arguments.length===1,v=0,E=t.length;v<E;v++)m?this._off(t[v]):this._off(t[v],s,c)}return this},_on:function(t,s,c,d){if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}if(this._listens(t,s,c)===!1){c===this&&(c=void 0);var m={fn:s,ctx:c};d&&(m.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(m)}},_off:function(t,s,c){var d,m,v;if(this._events&&(d=this._events[t],!!d)){if(arguments.length===1){if(this._firingCount)for(m=0,v=d.length;m<v;m++)d[m].fn=g;delete this._events[t];return}if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}var E=this._listens(t,s,c);if(E!==!1){var I=d[E];this._firingCount&&(I.fn=g,this._events[t]=d=d.slice()),d.splice(E,1)}}},fire:function(t,s,c){if(!this.listens(t,c))return this;var d=n({},s,{type:t,target:this,sourceTarget:s&&s.sourceTarget||this});if(this._events){var m=this._events[t];if(m){this._firingCount=this._firingCount+1||1;for(var v=0,E=m.length;v<E;v++){var I=m[v],R=I.fn;I.once&&this.off(t,R,I.ctx),R.call(I.ctx||this,d)}this._firingCount--}}return c&&this._propagateEvent(d),this},listens:function(t,s,c,d){typeof t!="string"&&console.warn('"string" type argument expected');var m=s;typeof s!="function"&&(d=!!s,m=void 0,c=void 0);var v=this._events&&this._events[t];if(v&&v.length&&this._listens(t,m,c)!==!1)return!0;if(d){for(var E in this._eventParents)if(this._eventParents[E].listens(t,s,c,d))return!0}return!1},_listens:function(t,s,c){if(!this._events)return!1;var d=this._events[t]||[];if(!s)return!!d.length;c===this&&(c=void 0);for(var m=0,v=d.length;m<v;m++)if(d[m].fn===s&&d[m].ctx===c)return m;return!1},once:function(t,s,c){if(typeof t=="object")for(var d in t)this._on(d,t[d],s,!0);else{t=P(t);for(var m=0,v=t.length;m<v;m++)this._on(t[m],s,c,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[u(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[u(t)],this},_propagateEvent:function(t){for(var s in this._eventParents)this._eventParents[s].fire(t.type,n({layer:t.target,propagatedFrom:t.target},t),!0)}};pt.addEventListener=pt.on,pt.removeEventListener=pt.clearAllEventListeners=pt.off,pt.addOneTimeEventListener=pt.once,pt.fireEvent=pt.fire,pt.hasEventListeners=pt.listens;var X=j.extend(pt);function q(t,s,c){this.x=c?Math.round(t):t,this.y=c?Math.round(s):s}var Dt=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};q.prototype={clone:function(){return new q(this.x,this.y)},add:function(t){return this.clone()._add(ut(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(ut(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new q(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new q(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Dt(this.x),this.y=Dt(this.y),this},distanceTo:function(t){t=ut(t);var s=t.x-this.x,c=t.y-this.y;return Math.sqrt(s*s+c*c)},equals:function(t){return t=ut(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=ut(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function ut(t,s,c){return t instanceof q?t:O(t)?new q(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new q(t.x,t.y):new q(t,s,c)}function wt(t,s){if(t)for(var c=s?[t,s]:t,d=0,m=c.length;d<m;d++)this.extend(c[d])}wt.prototype={extend:function(t){var s,c;if(!t)return this;if(t instanceof q||typeof t[0]=="number"||"x"in t)s=c=ut(t);else if(t=It(t),s=t.min,c=t.max,!s||!c)return this;return!this.min&&!this.max?(this.min=s.clone(),this.max=c.clone()):(this.min.x=Math.min(s.x,this.min.x),this.max.x=Math.max(c.x,this.max.x),this.min.y=Math.min(s.y,this.min.y),this.max.y=Math.max(c.y,this.max.y)),this},getCenter:function(t){return ut((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return ut(this.min.x,this.max.y)},getTopRight:function(){return ut(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var s,c;return typeof t[0]=="number"||t instanceof q?t=ut(t):t=It(t),t instanceof wt?(s=t.min,c=t.max):s=c=t,s.x>=this.min.x&&c.x<=this.max.x&&s.y>=this.min.y&&c.y<=this.max.y},intersects:function(t){t=It(t);var s=this.min,c=this.max,d=t.min,m=t.max,v=m.x>=s.x&&d.x<=c.x,E=m.y>=s.y&&d.y<=c.y;return v&&E},overlaps:function(t){t=It(t);var s=this.min,c=this.max,d=t.min,m=t.max,v=m.x>s.x&&d.x<c.x,E=m.y>s.y&&d.y<c.y;return v&&E},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var s=this.min,c=this.max,d=Math.abs(s.x-c.x)*t,m=Math.abs(s.y-c.y)*t;return It(ut(s.x-d,s.y-m),ut(c.x+d,c.y+m))},equals:function(t){return t?(t=It(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function It(t,s){return!t||t instanceof wt?t:new wt(t,s)}function ht(t,s){if(t)for(var c=s?[t,s]:t,d=0,m=c.length;d<m;d++)this.extend(c[d])}ht.prototype={extend:function(t){var s=this._southWest,c=this._northEast,d,m;if(t instanceof et)d=t,m=t;else if(t instanceof ht){if(d=t._southWest,m=t._northEast,!d||!m)return this}else return t?this.extend(G(t)||Z(t)):this;return!s&&!c?(this._southWest=new et(d.lat,d.lng),this._northEast=new et(m.lat,m.lng)):(s.lat=Math.min(d.lat,s.lat),s.lng=Math.min(d.lng,s.lng),c.lat=Math.max(m.lat,c.lat),c.lng=Math.max(m.lng,c.lng)),this},pad:function(t){var s=this._southWest,c=this._northEast,d=Math.abs(s.lat-c.lat)*t,m=Math.abs(s.lng-c.lng)*t;return new ht(new et(s.lat-d,s.lng-m),new et(c.lat+d,c.lng+m))},getCenter:function(){return new et((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new et(this.getNorth(),this.getWest())},getSouthEast:function(){return new et(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof et||"lat"in t?t=G(t):t=Z(t);var s=this._southWest,c=this._northEast,d,m;return t instanceof ht?(d=t.getSouthWest(),m=t.getNorthEast()):d=m=t,d.lat>=s.lat&&m.lat<=c.lat&&d.lng>=s.lng&&m.lng<=c.lng},intersects:function(t){t=Z(t);var s=this._southWest,c=this._northEast,d=t.getSouthWest(),m=t.getNorthEast(),v=m.lat>=s.lat&&d.lat<=c.lat,E=m.lng>=s.lng&&d.lng<=c.lng;return v&&E},overlaps:function(t){t=Z(t);var s=this._southWest,c=this._northEast,d=t.getSouthWest(),m=t.getNorthEast(),v=m.lat>s.lat&&d.lat<c.lat,E=m.lng>s.lng&&d.lng<c.lng;return v&&E},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,s){return t?(t=Z(t),this._southWest.equals(t.getSouthWest(),s)&&this._northEast.equals(t.getNorthEast(),s)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function Z(t,s){return t instanceof ht?t:new ht(t,s)}function et(t,s,c){if(isNaN(t)||isNaN(s))throw new Error("Invalid LatLng object: ("+t+", "+s+")");this.lat=+t,this.lng=+s,c!==void 0&&(this.alt=+c)}et.prototype={equals:function(t,s){if(!t)return!1;t=G(t);var c=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return c<=(s===void 0?1e-9:s)},toString:function(t){return"LatLng("+y(this.lat,t)+", "+y(this.lng,t)+")"},distanceTo:function(t){return Xt.distance(this,G(t))},wrap:function(){return Xt.wrapLatLng(this)},toBounds:function(t){var s=180*t/40075017,c=s/Math.cos(Math.PI/180*this.lat);return Z([this.lat-s,this.lng-c],[this.lat+s,this.lng+c])},clone:function(){return new et(this.lat,this.lng,this.alt)}};function G(t,s,c){return t instanceof et?t:O(t)&&typeof t[0]!="object"?t.length===3?new et(t[0],t[1],t[2]):t.length===2?new et(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new et(t.lat,"lng"in t?t.lng:t.lon,t.alt):s===void 0?null:new et(t,s,c)}var it={latLngToPoint:function(t,s){var c=this.projection.project(t),d=this.scale(s);return this.transformation._transform(c,d)},pointToLatLng:function(t,s){var c=this.scale(s),d=this.transformation.untransform(t,c);return this.projection.unproject(d)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var s=this.projection.bounds,c=this.scale(t),d=this.transformation.transform(s.min,c),m=this.transformation.transform(s.max,c);return new wt(d,m)},infinite:!1,wrapLatLng:function(t){var s=this.wrapLng?_(t.lng,this.wrapLng,!0):t.lng,c=this.wrapLat?_(t.lat,this.wrapLat,!0):t.lat,d=t.alt;return new et(c,s,d)},wrapLatLngBounds:function(t){var s=t.getCenter(),c=this.wrapLatLng(s),d=s.lat-c.lat,m=s.lng-c.lng;if(d===0&&m===0)return t;var v=t.getSouthWest(),E=t.getNorthEast(),I=new et(v.lat-d,v.lng-m),R=new et(E.lat-d,E.lng-m);return new ht(I,R)}},Xt=n({},it,{wrapLng:[-180,180],R:6371e3,distance:function(t,s){var c=Math.PI/180,d=t.lat*c,m=s.lat*c,v=Math.sin((s.lat-t.lat)*c/2),E=Math.sin((s.lng-t.lng)*c/2),I=v*v+Math.cos(d)*Math.cos(m)*E*E,R=2*Math.atan2(Math.sqrt(I),Math.sqrt(1-I));return this.R*R}}),me=6378137,gt={R:me,MAX_LATITUDE:85.0511287798,project:function(t){var s=Math.PI/180,c=this.MAX_LATITUDE,d=Math.max(Math.min(c,t.lat),-c),m=Math.sin(d*s);return new q(this.R*t.lng*s,this.R*Math.log((1+m)/(1-m))/2)},unproject:function(t){var s=180/Math.PI;return new et((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*s,t.x*s/this.R)},bounds:function(){var t=me*Math.PI;return new wt([-t,-t],[t,t])}()};function zt(t,s,c,d){if(O(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=s,this._c=c,this._d=d}zt.prototype={transform:function(t,s){return this._transform(t.clone(),s)},_transform:function(t,s){return s=s||1,t.x=s*(this._a*t.x+this._b),t.y=s*(this._c*t.y+this._d),t},untransform:function(t,s){return s=s||1,new q((t.x/s-this._b)/this._a,(t.y/s-this._d)/this._c)}};function Nt(t,s,c,d){return new zt(t,s,c,d)}var bt=n({},Xt,{code:"EPSG:3857",projection:gt,transformation:function(){var t=.5/(Math.PI*gt.R);return Nt(t,.5,-t,.5)}()}),Kt=n({},bt,{code:"EPSG:900913"});function oe(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function pe(t,s){var c="",d,m,v,E,I,R;for(d=0,v=t.length;d<v;d++){for(I=t[d],m=0,E=I.length;m<E;m++)R=I[m],c+=(m?"L":"M")+R.x+" "+R.y;c+=s?kt.svg?"z":"x":""}return c||"M0 0"}var st=document.documentElement.style,se="ActiveXObject"in window,Ot=se&&!document.addEventListener,Bt="msLaunchUri"in navigator&&!("documentMode"in document),Gt=Ue("webkit"),ee=Ue("android"),he=Ue("android 2")||Ue("android 3"),Je=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ze=ee&&Ue("Google")&&Je<537&&!("AudioNode"in window),qt=!!window.opera,He=!Bt&&Ue("chrome"),Ve=Ue("gecko")&&!Gt&&!qt&&!se,ze=!He&&Ue("safari"),Vt=Ue("phantom"),ue="OTransition"in st,ve=navigator.platform.indexOf("Win")===0,Qt=se&&"transition"in st,Ye="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!he,di="MozPerspective"in st,ri=!window.L_DISABLE_3D&&(Qt||Ye||di)&&!ue&&!Vt,Ie=typeof orientation<"u"||Ue("mobile"),Zt=Ie&&Gt,Me=Ie&&Ye,Qe=!window.PointerEvent&&window.MSPointerEvent,fi=!!(window.PointerEvent||Qe),ai="ontouchstart"in window||!!window.TouchEvent,qe=!window.L_NO_TOUCH&&(ai||fi),Oe=Ie&&qt,Ae=Ie&&Ve,li=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,$t=function(){var t=!1;try{var s=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",g,s),window.removeEventListener("testPassiveEventSupport",g,s)}catch{}return t}(),ie=function(){return!!document.createElement("canvas").getContext}(),ii=!!(document.createElementNS&&oe("svg").createSVGRect),ni=!!ii&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),$e=!ii&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var s=t.firstChild;return s.style.behavior="url(#default#VML)",s&&typeof s.adj=="object"}catch{return!1}}(),Ei=navigator.platform.indexOf("Mac")===0,Bi=navigator.platform.indexOf("Linux")===0;function Ue(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var kt={ie:se,ielt9:Ot,edge:Bt,webkit:Gt,android:ee,android23:he,androidStock:Ze,opera:qt,chrome:He,gecko:Ve,safari:ze,phantom:Vt,opera12:ue,win:ve,ie3d:Qt,webkit3d:Ye,gecko3d:di,any3d:ri,mobile:Ie,mobileWebkit:Zt,mobileWebkit3d:Me,msPointer:Qe,pointer:fi,touch:qe,touchNative:ai,mobileOpera:Oe,mobileGecko:Ae,retina:li,passiveEvents:$t,canvas:ie,svg:ii,vml:$e,inlineSvg:ni,mac:Ei,linux:Bi},gi=kt.msPointer?"MSPointerDown":"pointerdown",ci=kt.msPointer?"MSPointerMove":"pointermove",ti=kt.msPointer?"MSPointerUp":"pointerup",vi=kt.msPointer?"MSPointerCancel":"pointercancel",b={touchstart:gi,touchmove:ci,touchend:ti,touchcancel:vi},mt={touchstart:We,touchmove:Xe,touchend:Xe,touchcancel:Xe},Et={},Pt=!1;function xt(t,s,c){return s==="touchstart"&&ge(),mt[s]?(c=mt[s].bind(this,c),t.addEventListener(b[s],c,!1),c):(console.warn("wrong event specified:",s),g)}function A(t,s,c){if(!b[s]){console.warn("wrong event specified:",s);return}t.removeEventListener(b[s],c,!1)}function Yt(t){Et[t.pointerId]=t}function de(t){Et[t.pointerId]&&(Et[t.pointerId]=t)}function te(t){delete Et[t.pointerId]}function ge(){Pt||(document.addEventListener(gi,Yt,!0),document.addEventListener(ci,de,!0),document.addEventListener(ti,te,!0),document.addEventListener(vi,te,!0),Pt=!0)}function Xe(t,s){if(s.pointerType!==(s.MSPOINTER_TYPE_MOUSE||"mouse")){s.touches=[];for(var c in Et)s.touches.push(Et[c]);s.changedTouches=[s],t(s)}}function We(t,s){s.MSPOINTER_TYPE_TOUCH&&s.pointerType===s.MSPOINTER_TYPE_TOUCH&&Ct(s),Xe(t,s)}function Ci(t){var s={},c,d;for(d in t)c=t[d],s[d]=c&&c.bind?c.bind(t):c;return t=s,s.type="dblclick",s.detail=2,s.isTrusted=!1,s._simulated=!0,s}var Pi=200;function sn(t,s){t.addEventListener("dblclick",s);var c=0,d;function m(v){if(v.detail!==1){d=v.detail;return}if(!(v.pointerType==="mouse"||v.sourceCapabilities&&!v.sourceCapabilities.firesTouchEvents)){var E=Ui(v);if(!(E.some(function(R){return R instanceof HTMLLabelElement&&R.attributes.for})&&!E.some(function(R){return R instanceof HTMLInputElement||R instanceof HTMLSelectElement}))){var I=Date.now();I-c<=Pi?(d++,d===2&&s(Ci(v))):d=1,c=I}}}return t.addEventListener("click",m),{dblclick:s,simDblclick:m}}function Vi(t,s){t.removeEventListener("dblclick",s.dblclick),t.removeEventListener("click",s.simDblclick)}var xi=qi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ti=qi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Ji=Ti==="webkitTransition"||Ti==="OTransition"?Ti+"End":"transitionend";function rn(t){return typeof t=="string"?document.getElementById(t):t}function vt(t,s){var c=t.style[s]||t.currentStyle&&t.currentStyle[s];if((!c||c==="auto")&&document.defaultView){var d=document.defaultView.getComputedStyle(t,null);c=d?d[s]:null}return c==="auto"?null:c}function Rt(t,s,c){var d=document.createElement(t);return d.className=s||"",c&&c.appendChild(d),d}function ne(t){var s=t.parentNode;s&&s.removeChild(t)}function _i(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function zi(t){var s=t.parentNode;s&&s.lastChild!==t&&s.appendChild(t)}function Fe(t){var s=t.parentNode;s&&s.firstChild!==t&&s.insertBefore(t,s.firstChild)}function fe(t,s){if(t.classList!==void 0)return t.classList.contains(s);var c=Ai(t);return c.length>0&&new RegExp("(^|\\s)"+s+"(\\s|$)").test(c)}function Ht(t,s){if(t.classList!==void 0)for(var c=P(s),d=0,m=c.length;d<m;d++)t.classList.add(c[d]);else if(!fe(t,s)){var v=Ai(t);hn(t,(v?v+" ":"")+s)}}function ye(t,s){t.classList!==void 0?t.classList.remove(s):hn(t,k((" "+Ai(t)+" ").replace(" "+s+" "," ")))}function hn(t,s){t.className.baseVal===void 0?t.className=s:t.className.baseVal=s}function Ai(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function yi(t,s){"opacity"in t.style?t.style.opacity=s:"filter"in t.style&&Qi(t,s)}function Qi(t,s){var c=!1,d="DXImageTransform.Microsoft.Alpha";try{c=t.filters.item(d)}catch{if(s===1)return}s=Math.round(s*100),c?(c.Enabled=s!==100,c.Opacity=s):t.style.filter+=" progid:"+d+"(opacity="+s+")"}function qi(t){for(var s=document.documentElement.style,c=0;c<t.length;c++)if(t[c]in s)return t[c];return!1}function Ni(t,s,c){var d=s||new q(0,0);t.style[xi]=(kt.ie3d?"translate("+d.x+"px,"+d.y+"px)":"translate3d("+d.x+"px,"+d.y+"px,0)")+(c?" scale("+c+")":"")}function Ne(t,s){t._leaflet_pos=s,kt.any3d?Ni(t,s):(t.style.left=s.x+"px",t.style.top=s.y+"px")}function je(t){return t._leaflet_pos||new q(0,0)}var Yi,$i,Ri;if("onselectstart"in document)Yi=function(){Wt(window,"selectstart",Ct)},$i=function(){M(window,"selectstart",Ct)};else{var Ke=qi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Yi=function(){if(Ke){var t=document.documentElement.style;Ri=t[Ke],t[Ke]="none"}},$i=function(){Ke&&(document.documentElement.style[Ke]=Ri,Ri=void 0)}}function Ln(){Wt(window,"dragstart",Ct)}function un(){M(window,"dragstart",Ct)}var Ii,bi;function kn(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(an(),Ii=t,bi=t.style.outlineStyle,t.style.outlineStyle="none",Wt(window,"keydown",an))}function an(){Ii&&(Ii.style.outlineStyle=bi,Ii=void 0,bi=void 0,M(window,"keydown",an))}function Zi(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function wi(t){var s=t.getBoundingClientRect();return{x:s.width/t.offsetWidth||1,y:s.height/t.offsetHeight||1,boundingClientRect:s}}var Si={__proto__:null,TRANSFORM:xi,TRANSITION:Ti,TRANSITION_END:Ji,get:rn,getStyle:vt,create:Rt,remove:ne,empty:_i,toFront:zi,toBack:Fe,hasClass:fe,addClass:Ht,removeClass:ye,setClass:hn,getClass:Ai,setOpacity:yi,testProp:qi,setTransform:Ni,setPosition:Ne,getPosition:je,get disableTextSelection(){return Yi},get enableTextSelection(){return $i},disableImageDrag:Ln,enableImageDrag:un,preventOutline:kn,restoreOutline:an,getSizedParentNode:Zi,getScale:wi};function Wt(t,s,c,d){if(s&&typeof s=="object")for(var m in s)dt(t,m,s[m],c);else{s=P(s);for(var v=0,E=s.length;v<E;v++)dt(t,s[v],c,d)}return this}var Oi="_leaflet_events";function M(t,s,c,d){if(arguments.length===1)H(t),delete t[Oi];else if(s&&typeof s=="object")for(var m in s)Mt(t,m,s[m],c);else if(s=P(s),arguments.length===2)H(t,function(I){return W(s,I)!==-1});else for(var v=0,E=s.length;v<E;v++)Mt(t,s[v],c,d);return this}function H(t,s){for(var c in t[Oi]){var d=c.split(/\d/)[0];(!s||s(d))&&Mt(t,d,null,null,c)}}var D={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function dt(t,s,c,d){var m=s+u(c)+(d?"_"+u(d):"");if(t[Oi]&&t[Oi][m])return this;var v=function(I){return c.call(d||t,I||window.event)},E=v;!kt.touchNative&&kt.pointer&&s.indexOf("touch")===0?v=xt(t,s,v):kt.touch&&s==="dblclick"?v=sn(t,v):"addEventListener"in t?s==="touchstart"||s==="touchmove"||s==="wheel"||s==="mousewheel"?t.addEventListener(D[s]||s,v,kt.passiveEvents?{passive:!1}:!1):s==="mouseenter"||s==="mouseleave"?(v=function(I){I=I||window.event,Ao(t,I)&&E(I)},t.addEventListener(D[s],v,!1)):t.addEventListener(s,E,!1):t.attachEvent("on"+s,v),t[Oi]=t[Oi]||{},t[Oi][m]=v}function Mt(t,s,c,d,m){m=m||s+u(c)+(d?"_"+u(d):"");var v=t[Oi]&&t[Oi][m];if(!v)return this;!kt.touchNative&&kt.pointer&&s.indexOf("touch")===0?A(t,s,v):kt.touch&&s==="dblclick"?Vi(t,v):"removeEventListener"in t?t.removeEventListener(D[s]||s,v,!1):t.detachEvent("on"+s,v),t[Oi][m]=null}function St(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function hi(t){return dt(t,"wheel",St),this}function Pe(t){return Wt(t,"mousedown touchstart dblclick contextmenu",St),t._leaflet_disable_click=!0,this}function Ct(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Be(t){return Ct(t),St(t),this}function Ui(t){if(t.composedPath)return t.composedPath();for(var s=[],c=t.target;c;)s.push(c),c=c.parentNode;return s}function dn(t,s){if(!s)return new q(t.clientX,t.clientY);var c=wi(s),d=c.boundingClientRect;return new q((t.clientX-d.left)/c.x-s.clientLeft,(t.clientY-d.top)/c.y-s.clientTop)}var Nn=kt.linux&&kt.chrome?window.devicePixelRatio:kt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Dn(t){return kt.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/Nn:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function Ao(t,s){var c=s.relatedTarget;if(!c)return!0;try{for(;c&&c!==t;)c=c.parentNode}catch{return!1}return c!==t}var Pl={__proto__:null,on:Wt,off:M,stopPropagation:St,disableScrollPropagation:hi,disableClickPropagation:Pe,preventDefault:Ct,stop:Be,getPropagationPath:Ui,getMousePosition:dn,getWheelDelta:Dn,isExternalTarget:Ao,addListener:Wt,removeListener:M},ds=X.extend({run:function(t,s,c,d){this.stop(),this._el=t,this._inProgress=!0,this._duration=c||.25,this._easeOutPower=1/Math.max(d||.5,.2),this._startPos=je(t),this._offset=s.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=K(this._animate,this),this._step()},_step:function(t){var s=+new Date-this._startTime,c=this._duration*1e3;s<c?this._runFrame(this._easeOut(s/c),t):(this._runFrame(1),this._complete())},_runFrame:function(t,s){var c=this._startPos.add(this._offset.multiplyBy(t));s&&c._round(),Ne(this._el,c),this.fire("step")},_complete:function(){N(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),be=X.extend({options:{crs:bt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,s){s=C(this,s),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),s.maxBounds&&this.setMaxBounds(s.maxBounds),s.zoom!==void 0&&(this._zoom=this._limitZoom(s.zoom)),s.center&&s.zoom!==void 0&&this.setView(G(s.center),s.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ti&&kt.any3d&&!kt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Wt(this._proxy,Ji,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,s,c){if(s=s===void 0?this._zoom:this._limitZoom(s),t=this._limitCenter(G(t),s,this.options.maxBounds),c=c||{},this._stop(),this._loaded&&!c.reset&&c!==!0){c.animate!==void 0&&(c.zoom=n({animate:c.animate},c.zoom),c.pan=n({animate:c.animate,duration:c.duration},c.pan));var d=this._zoom!==s?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,s,c.zoom):this._tryAnimatedPan(t,c.pan);if(d)return clearTimeout(this._sizeTimer),this}return this._resetView(t,s,c.pan&&c.pan.noMoveStart),this},setZoom:function(t,s){return this._loaded?this.setView(this.getCenter(),t,{zoom:s}):(this._zoom=t,this)},zoomIn:function(t,s){return t=t||(kt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,s)},zoomOut:function(t,s){return t=t||(kt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,s)},setZoomAround:function(t,s,c){var d=this.getZoomScale(s),m=this.getSize().divideBy(2),v=t instanceof q?t:this.latLngToContainerPoint(t),E=v.subtract(m).multiplyBy(1-1/d),I=this.containerPointToLatLng(m.add(E));return this.setView(I,s,{zoom:c})},_getBoundsCenterZoom:function(t,s){s=s||{},t=t.getBounds?t.getBounds():Z(t);var c=ut(s.paddingTopLeft||s.padding||[0,0]),d=ut(s.paddingBottomRight||s.padding||[0,0]),m=this.getBoundsZoom(t,!1,c.add(d));if(m=typeof s.maxZoom=="number"?Math.min(s.maxZoom,m):m,m===1/0)return{center:t.getCenter(),zoom:m};var v=d.subtract(c).divideBy(2),E=this.project(t.getSouthWest(),m),I=this.project(t.getNorthEast(),m),R=this.unproject(E.add(I).divideBy(2).add(v),m);return{center:R,zoom:m}},fitBounds:function(t,s){if(t=Z(t),!t.isValid())throw new Error("Bounds are not valid.");var c=this._getBoundsCenterZoom(t,s);return this.setView(c.center,c.zoom,s)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,s){return this.setView(t,this._zoom,{pan:s})},panBy:function(t,s){if(t=ut(t).round(),s=s||{},!t.x&&!t.y)return this.fire("moveend");if(s.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new ds,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),s.noMoveStart||this.fire("movestart"),s.animate!==!1){Ht(this._mapPane,"leaflet-pan-anim");var c=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,c,s.duration||.25,s.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,s,c){if(c=c||{},c.animate===!1||!kt.any3d)return this.setView(t,s,c);this._stop();var d=this.project(this.getCenter()),m=this.project(t),v=this.getSize(),E=this._zoom;t=G(t),s=s===void 0?E:s;var I=Math.max(v.x,v.y),R=I*this.getZoomScale(E,s),ct=m.distanceTo(d)||1,Tt=1.42,Ut=Tt*Tt;function le(Li){var ko=Li?-1:1,fc=Li?R:I,_c=R*R-I*I+ko*Ut*Ut*ct*ct,mc=2*fc*Ut*ct,jo=_c/mc,js=Math.sqrt(jo*jo+1)-jo,pc=js<1e-9?-18:Math.log(js);return pc}function Hi(Li){return(Math.exp(Li)-Math.exp(-Li))/2}function Di(Li){return(Math.exp(Li)+Math.exp(-Li))/2}function en(Li){return Hi(Li)/Di(Li)}var Wi=le(0);function Gn(Li){return I*(Di(Wi)/Di(Wi+Tt*Li))}function cc(Li){return I*(Di(Wi)*en(Wi+Tt*Li)-Hi(Wi))/Ut}function hc(Li){return 1-Math.pow(1-Li,1.5)}var uc=Date.now(),Us=(le(1)-Wi)/Tt,dc=c.duration?1e3*c.duration:1e3*Us*.8;function Ws(){var Li=(Date.now()-uc)/dc,ko=hc(Li)*Us;Li<=1?(this._flyToFrame=K(Ws,this),this._move(this.unproject(d.add(m.subtract(d).multiplyBy(cc(ko)/ct)),E),this.getScaleZoom(I/Gn(ko),E),{flyTo:!0})):this._move(t,s)._moveEnd(!0)}return this._moveStart(!0,c.noMoveStart),Ws.call(this),this},flyToBounds:function(t,s){var c=this._getBoundsCenterZoom(t,s);return this.flyTo(c.center,c.zoom,s)},setMaxBounds:function(t){return t=Z(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var s=this.options.minZoom;return this.options.minZoom=t,this._loaded&&s!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var s=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&s!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,s){this._enforcingBounds=!0;var c=this.getCenter(),d=this._limitCenter(c,this._zoom,Z(t));return c.equals(d)||this.panTo(d,s),this._enforcingBounds=!1,this},panInside:function(t,s){s=s||{};var c=ut(s.paddingTopLeft||s.padding||[0,0]),d=ut(s.paddingBottomRight||s.padding||[0,0]),m=this.project(this.getCenter()),v=this.project(t),E=this.getPixelBounds(),I=It([E.min.add(c),E.max.subtract(d)]),R=I.getSize();if(!I.contains(v)){this._enforcingBounds=!0;var ct=v.subtract(I.getCenter()),Tt=I.extend(v).getSize().subtract(R);m.x+=ct.x<0?-Tt.x:Tt.x,m.y+=ct.y<0?-Tt.y:Tt.y,this.panTo(this.unproject(m),s),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=n({animate:!1,pan:!0},t===!0?{animate:!0}:t);var s=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var c=this.getSize(),d=s.divideBy(2).round(),m=c.divideBy(2).round(),v=d.subtract(m);return!v.x&&!v.y?this:(t.animate&&t.pan?this.panBy(v):(t.pan&&this._rawPanBy(v),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:s,newSize:c}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=n({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var s=l(this._handleGeolocationResponse,this),c=l(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(s,c,t):navigator.geolocation.getCurrentPosition(s,c,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var s=t.code,c=t.message||(s===1?"permission denied":s===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:s,message:"Geolocation error: "+c+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var s=t.coords.latitude,c=t.coords.longitude,d=new et(s,c),m=d.toBounds(t.coords.accuracy*2),v=this._locateOptions;if(v.setView){var E=this.getBoundsZoom(m);this.setView(d,v.maxZoom?Math.min(E,v.maxZoom):E)}var I={latlng:d,bounds:m,timestamp:t.timestamp};for(var R in t.coords)typeof t.coords[R]=="number"&&(I[R]=t.coords[R]);this.fire("locationfound",I)}},addHandler:function(t,s){if(!s)return this;var c=this[t]=new s(this);return this._handlers.push(c),this.options[t]&&c.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ne(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(N(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)ne(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,s){var c="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),d=Rt("div",c,s||this._mapPane);return t&&(this._panes[t]=d),d},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),s=this.unproject(t.getBottomLeft()),c=this.unproject(t.getTopRight());return new ht(s,c)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,s,c){t=Z(t),c=ut(c||[0,0]);var d=this.getZoom()||0,m=this.getMinZoom(),v=this.getMaxZoom(),E=t.getNorthWest(),I=t.getSouthEast(),R=this.getSize().subtract(c),ct=It(this.project(I,d),this.project(E,d)).getSize(),Tt=kt.any3d?this.options.zoomSnap:1,Ut=R.x/ct.x,le=R.y/ct.y,Hi=s?Math.max(Ut,le):Math.min(Ut,le);return d=this.getScaleZoom(Hi,d),Tt&&(d=Math.round(d/(Tt/100))*(Tt/100),d=s?Math.ceil(d/Tt)*Tt:Math.floor(d/Tt)*Tt),Math.max(m,Math.min(v,d))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new q(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,s){var c=this._getTopLeftPoint(t,s);return new wt(c,c.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,s){var c=this.options.crs;return s=s===void 0?this._zoom:s,c.scale(t)/c.scale(s)},getScaleZoom:function(t,s){var c=this.options.crs;s=s===void 0?this._zoom:s;var d=c.zoom(t*c.scale(s));return isNaN(d)?1/0:d},project:function(t,s){return s=s===void 0?this._zoom:s,this.options.crs.latLngToPoint(G(t),s)},unproject:function(t,s){return s=s===void 0?this._zoom:s,this.options.crs.pointToLatLng(ut(t),s)},layerPointToLatLng:function(t){var s=ut(t).add(this.getPixelOrigin());return this.unproject(s)},latLngToLayerPoint:function(t){var s=this.project(G(t))._round();return s._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(G(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(Z(t))},distance:function(t,s){return this.options.crs.distance(G(t),G(s))},containerPointToLayerPoint:function(t){return ut(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return ut(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var s=this.containerPointToLayerPoint(ut(t));return this.layerPointToLatLng(s)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(G(t)))},mouseEventToContainerPoint:function(t){return dn(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var s=this._container=rn(t);if(s){if(s._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Wt(s,"scroll",this._onScroll,this),this._containerId=u(s)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&kt.any3d,Ht(t,"leaflet-container"+(kt.touch?" leaflet-touch":"")+(kt.retina?" leaflet-retina":"")+(kt.ielt9?" leaflet-oldie":"")+(kt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var s=vt(t,"position");s!=="absolute"&&s!=="relative"&&s!=="fixed"&&s!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ne(this._mapPane,new q(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Ht(t.markerPane,"leaflet-zoom-hide"),Ht(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,s,c){Ne(this._mapPane,new q(0,0));var d=!this._loaded;this._loaded=!0,s=this._limitZoom(s),this.fire("viewprereset");var m=this._zoom!==s;this._moveStart(m,c)._move(t,s)._moveEnd(m),this.fire("viewreset"),d&&this.fire("load")},_moveStart:function(t,s){return t&&this.fire("zoomstart"),s||this.fire("movestart"),this},_move:function(t,s,c,d){s===void 0&&(s=this._zoom);var m=this._zoom!==s;return this._zoom=s,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),d?c&&c.pinch&&this.fire("zoom",c):((m||c&&c.pinch)&&this.fire("zoom",c),this.fire("move",c)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return N(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){Ne(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[u(this._container)]=this;var s=t?M:Wt;s(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&s(window,"resize",this._onResize,this),kt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){N(this._resizeRequest),this._resizeRequest=K(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,s){for(var c=[],d,m=s==="mouseout"||s==="mouseover",v=t.target||t.srcElement,E=!1;v;){if(d=this._targets[u(v)],d&&(s==="click"||s==="preclick")&&this._draggableMoved(d)){E=!0;break}if(d&&d.listens(s,!0)&&(m&&!Ao(v,t)||(c.push(d),m))||v===this._container)break;v=v.parentNode}return!c.length&&!E&&!m&&this.listens(s,!0)&&(c=[this]),c},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var s=t.target||t.srcElement;if(!(!this._loaded||s._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(s))){var c=t.type;c==="mousedown"&&kn(s),this._fireDOMEvent(t,c)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,s,c){if(t.type==="click"){var d=n({},t);d.type="preclick",this._fireDOMEvent(d,d.type,c)}var m=this._findEventTargets(t,s);if(c){for(var v=[],E=0;E<c.length;E++)c[E].listens(s,!0)&&v.push(c[E]);m=v.concat(m)}if(m.length){s==="contextmenu"&&Ct(t);var I=m[0],R={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var ct=I.getLatLng&&(!I._radius||I._radius<=10);R.containerPoint=ct?this.latLngToContainerPoint(I.getLatLng()):this.mouseEventToContainerPoint(t),R.layerPoint=this.containerPointToLayerPoint(R.containerPoint),R.latlng=ct?I.getLatLng():this.layerPointToLatLng(R.layerPoint)}for(E=0;E<m.length;E++)if(m[E].fire(s,R,!0),R.originalEvent._stopped||m[E].options.bubblingMouseEvents===!1&&W(this._mouseEvents,s)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,s=this._handlers.length;t<s;t++)this._handlers[t].disable()},whenReady:function(t,s){return this._loaded?t.call(s||this,{target:this}):this.on("load",t,s),this},_getMapPanePos:function(){return je(this._mapPane)||new q(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,s){var c=t&&s!==void 0?this._getNewPixelOrigin(t,s):this.getPixelOrigin();return c.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,s){var c=this.getSize()._divideBy(2);return this.project(t,s)._subtract(c)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,s,c){var d=this._getNewPixelOrigin(c,s);return this.project(t,s)._subtract(d)},_latLngBoundsToNewLayerBounds:function(t,s,c){var d=this._getNewPixelOrigin(c,s);return It([this.project(t.getSouthWest(),s)._subtract(d),this.project(t.getNorthWest(),s)._subtract(d),this.project(t.getSouthEast(),s)._subtract(d),this.project(t.getNorthEast(),s)._subtract(d)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,s,c){if(!c)return t;var d=this.project(t,s),m=this.getSize().divideBy(2),v=new wt(d.subtract(m),d.add(m)),E=this._getBoundsOffset(v,c,s);return Math.abs(E.x)<=1&&Math.abs(E.y)<=1?t:this.unproject(d.add(E),s)},_limitOffset:function(t,s){if(!s)return t;var c=this.getPixelBounds(),d=new wt(c.min.add(t),c.max.add(t));return t.add(this._getBoundsOffset(d,s))},_getBoundsOffset:function(t,s,c){var d=It(this.project(s.getNorthEast(),c),this.project(s.getSouthWest(),c)),m=d.min.subtract(t.min),v=d.max.subtract(t.max),E=this._rebound(m.x,-v.x),I=this._rebound(m.y,-v.y);return new q(E,I)},_rebound:function(t,s){return t+s>0?Math.round(t-s)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(s))},_limitZoom:function(t){var s=this.getMinZoom(),c=this.getMaxZoom(),d=kt.any3d?this.options.zoomSnap:1;return d&&(t=Math.round(t/d)*d),Math.max(s,Math.min(c,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ye(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,s){var c=this._getCenterOffset(t)._trunc();return(s&&s.animate)!==!0&&!this.getSize().contains(c)?!1:(this.panBy(c,s),!0)},_createAnimProxy:function(){var t=this._proxy=Rt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(s){var c=xi,d=this._proxy.style[c];Ni(this._proxy,this.project(s.center,s.zoom),this.getZoomScale(s.zoom,1)),d===this._proxy.style[c]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ne(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),s=this.getZoom();Ni(this._proxy,this.project(t,s),this.getZoomScale(s,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,s,c){if(this._animatingZoom)return!0;if(c=c||{},!this._zoomAnimated||c.animate===!1||this._nothingToAnimate()||Math.abs(s-this._zoom)>this.options.zoomAnimationThreshold)return!1;var d=this.getZoomScale(s),m=this._getCenterOffset(t)._divideBy(1-1/d);return c.animate!==!0&&!this.getSize().contains(m)?!1:(K(function(){this._moveStart(!0,c.noMoveStart||!1)._animateZoom(t,s,!0)},this),!0)},_animateZoom:function(t,s,c,d){this._mapPane&&(c&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=s,Ht(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:s,noUpdate:d}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ye(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function El(t,s){return new be(t,s)}var ln=j.extend({options:{position:"topright"},initialize:function(t){C(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var s=this._map;return s&&s.removeControl(this),this.options.position=t,s&&s.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var s=this._container=this.onAdd(t),c=this.getPosition(),d=t._controlCorners[c];return Ht(s,"leaflet-control"),c.indexOf("bottom")!==-1?d.insertBefore(s,d.firstChild):d.appendChild(s),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ne(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Xn=function(t){return new ln(t)};be.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},s="leaflet-",c=this._controlContainer=Rt("div",s+"control-container",this._container);function d(m,v){var E=s+m+" "+s+v;t[m+v]=Rt("div",E,c)}d("top","left"),d("top","right"),d("bottom","left"),d("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ne(this._controlCorners[t]);ne(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var fs=ln.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,s,c,d){return c<d?-1:d<c?1:0}},initialize:function(t,s,c){C(this,c),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var d in t)this._addLayer(t[d],d);for(d in s)this._addLayer(s[d],d,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return ln.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,s){return this._addLayer(t,s),this._map?this._update():this},addOverlay:function(t,s){return this._addLayer(t,s,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var s=this._getLayer(u(t));return s&&this._layers.splice(this._layers.indexOf(s),1),this._map?this._update():this},expand:function(){Ht(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(Ht(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):ye(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ye(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",s=this._container=Rt("div",t),c=this.options.collapsed;s.setAttribute("aria-haspopup",!0),Pe(s),hi(s);var d=this._section=Rt("section",t+"-list");c&&(this._map.on("click",this.collapse,this),Wt(s,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var m=this._layersLink=Rt("a",t+"-toggle",s);m.href="#",m.title="Layers",m.setAttribute("role","button"),Wt(m,{keydown:function(v){v.keyCode===13&&this._expandSafely()},click:function(v){Ct(v),this._expandSafely()}},this),c||this.expand(),this._baseLayersList=Rt("div",t+"-base",d),this._separator=Rt("div",t+"-separator",d),this._overlaysList=Rt("div",t+"-overlays",d),s.appendChild(d)},_getLayer:function(t){for(var s=0;s<this._layers.length;s++)if(this._layers[s]&&u(this._layers[s].layer)===t)return this._layers[s]},_addLayer:function(t,s,c){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:s,overlay:c}),this.options.sortLayers&&this._layers.sort(l(function(d,m){return this.options.sortFunction(d.layer,m.layer,d.name,m.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;_i(this._baseLayersList),_i(this._overlaysList),this._layerControlInputs=[];var t,s,c,d,m=0;for(c=0;c<this._layers.length;c++)d=this._layers[c],this._addItem(d),s=s||d.overlay,t=t||!d.overlay,m+=d.overlay?0:1;return this.options.hideSingleBase&&(t=t&&m>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=s&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var s=this._getLayer(u(t.target)),c=s.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;c&&this._map.fire(c,s)},_createRadioElement:function(t,s){var c='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(s?' checked="checked"':"")+"/>",d=document.createElement("div");return d.innerHTML=c,d.firstChild},_addItem:function(t){var s=document.createElement("label"),c=this._map.hasLayer(t.layer),d;t.overlay?(d=document.createElement("input"),d.type="checkbox",d.className="leaflet-control-layers-selector",d.defaultChecked=c):d=this._createRadioElement("leaflet-base-layers_"+u(this),c),this._layerControlInputs.push(d),d.layerId=u(t.layer),Wt(d,"click",this._onInputClick,this);var m=document.createElement("span");m.innerHTML=" "+t.name;var v=document.createElement("span");s.appendChild(v),v.appendChild(d),v.appendChild(m);var E=t.overlay?this._overlaysList:this._baseLayersList;return E.appendChild(s),this._checkDisabledLayers(),s},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,s,c,d=[],m=[];this._handlingClick=!0;for(var v=t.length-1;v>=0;v--)s=t[v],c=this._getLayer(s.layerId).layer,s.checked?d.push(c):s.checked||m.push(c);for(v=0;v<m.length;v++)this._map.hasLayer(m[v])&&this._map.removeLayer(m[v]);for(v=0;v<d.length;v++)this._map.hasLayer(d[v])||this._map.addLayer(d[v]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,s,c,d=this._map.getZoom(),m=t.length-1;m>=0;m--)s=t[m],c=this._getLayer(s.layerId).layer,s.disabled=c.options.minZoom!==void 0&&d<c.options.minZoom||c.options.maxZoom!==void 0&&d>c.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,Wt(t,"click",Ct),this.expand();var s=this;setTimeout(function(){M(t,"click",Ct),s._preventClick=!1})}}),Cl=function(t,s,c){return new fs(t,s,c)},No=ln.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var s="leaflet-control-zoom",c=Rt("div",s+" leaflet-bar"),d=this.options;return this._zoomInButton=this._createButton(d.zoomInText,d.zoomInTitle,s+"-in",c,this._zoomIn),this._zoomOutButton=this._createButton(d.zoomOutText,d.zoomOutTitle,s+"-out",c,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),c},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,s,c,d,m){var v=Rt("a",c,d);return v.innerHTML=t,v.href="#",v.title=s,v.setAttribute("role","button"),v.setAttribute("aria-label",s),Pe(v),Wt(v,"click",Be),Wt(v,"click",m,this),Wt(v,"click",this._refocusOnMap,this),v},_updateDisabled:function(){var t=this._map,s="leaflet-disabled";ye(this._zoomInButton,s),ye(this._zoomOutButton,s),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(Ht(this._zoomOutButton,s),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(Ht(this._zoomInButton,s),this._zoomInButton.setAttribute("aria-disabled","true"))}});be.mergeOptions({zoomControl:!0}),be.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new No,this.addControl(this.zoomControl))});var Tl=function(t){return new No(t)},_s=ln.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var s="leaflet-control-scale",c=Rt("div",s),d=this.options;return this._addScales(d,s+"-line",c),t.on(d.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),c},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,s,c){t.metric&&(this._mScale=Rt("div",s,c)),t.imperial&&(this._iScale=Rt("div",s,c))},_update:function(){var t=this._map,s=t.getSize().y/2,c=t.distance(t.containerPointToLatLng([0,s]),t.containerPointToLatLng([this.options.maxWidth,s]));this._updateScales(c)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var s=this._getRoundNum(t),c=s<1e3?s+" m":s/1e3+" km";this._updateScale(this._mScale,c,s/t)},_updateImperial:function(t){var s=t*3.2808399,c,d,m;s>5280?(c=s/5280,d=this._getRoundNum(c),this._updateScale(this._iScale,d+" mi",d/c)):(m=this._getRoundNum(s),this._updateScale(this._iScale,m+" ft",m/s))},_updateScale:function(t,s,c){t.style.width=Math.round(this.options.maxWidth*c)+"px",t.innerHTML=s},_getRoundNum:function(t){var s=Math.pow(10,(Math.floor(t)+"").length-1),c=t/s;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:1,s*c}}),Sl=function(t){return new _s(t)},Dl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Bo=ln.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(kt.inlineSvg?Dl+" ":"")+"Leaflet</a>"},initialize:function(t){C(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=Rt("div","leaflet-control-attribution"),Pe(this._container);for(var s in t._layers)t._layers[s].getAttribution&&this.addAttribution(t._layers[s].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var s in this._attributions)this._attributions[s]&&t.push(s);var c=[];this.options.prefix&&c.push(this.options.prefix),t.length&&c.push(t.join(", ")),this._container.innerHTML=c.join(' <span aria-hidden="true">|</span> ')}}});be.mergeOptions({attributionControl:!0}),be.addInitHook(function(){this.options.attributionControl&&new Bo().addTo(this)});var xl=function(t){return new Bo(t)};ln.Layers=fs,ln.Zoom=No,ln.Scale=_s,ln.Attribution=Bo,Xn.layers=Cl,Xn.zoom=Tl,Xn.scale=Sl,Xn.attribution=xl;var fn=j.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});fn.addTo=function(t,s){return t.addHandler(s,this),this};var zl={Events:pt},ms=kt.touch?"touchstart mousedown":"mousedown",Mn=X.extend({options:{clickTolerance:3},initialize:function(t,s,c,d){C(this,d),this._element=t,this._dragStartTarget=s||t,this._preventOutline=c},enable:function(){this._enabled||(Wt(this._dragStartTarget,ms,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Mn._dragging===this&&this.finishDrag(!0),M(this._dragStartTarget,ms,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!fe(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){Mn._dragging===this&&this.finishDrag();return}if(!(Mn._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(Mn._dragging=this,this._preventOutline&&kn(this._element),Ln(),Yi(),!this._moving)){this.fire("down");var s=t.touches?t.touches[0]:t,c=Zi(this._element);this._startPoint=new q(s.clientX,s.clientY),this._startPos=je(this._element),this._parentScale=wi(c);var d=t.type==="mousedown";Wt(document,d?"mousemove":"touchmove",this._onMove,this),Wt(document,d?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var s=t.touches&&t.touches.length===1?t.touches[0]:t,c=new q(s.clientX,s.clientY)._subtract(this._startPoint);!c.x&&!c.y||Math.abs(c.x)+Math.abs(c.y)<this.options.clickTolerance||(c.x/=this._parentScale.x,c.y/=this._parentScale.y,Ct(t),this._moved||(this.fire("dragstart"),this._moved=!0,Ht(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Ht(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(c),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),Ne(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){ye(document.body,"leaflet-dragging"),this._lastTarget&&(ye(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),M(document,"mousemove touchmove",this._onMove,this),M(document,"mouseup touchend touchcancel",this._onUp,this),un(),$i();var s=this._moved&&this._moving;this._moving=!1,Mn._dragging=!1,s&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function ps(t,s,c){var d,m=[1,4,2,8],v,E,I,R,ct,Tt,Ut,le;for(v=0,Tt=t.length;v<Tt;v++)t[v]._code=xn(t[v],s);for(I=0;I<4;I++){for(Ut=m[I],d=[],v=0,Tt=t.length,E=Tt-1;v<Tt;E=v++)R=t[v],ct=t[E],R._code&Ut?ct._code&Ut||(le=uo(ct,R,Ut,s,c),le._code=xn(le,s),d.push(le)):(ct._code&Ut&&(le=uo(ct,R,Ut,s,c),le._code=xn(le,s),d.push(le)),d.push(R));t=d}return t}function gs(t,s){var c,d,m,v,E,I,R,ct,Tt;if(!t||t.length===0)throw new Error("latlngs not passed");tn(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var Ut=G([0,0]),le=Z(t),Hi=le.getNorthWest().distanceTo(le.getSouthWest())*le.getNorthEast().distanceTo(le.getNorthWest());Hi<1700&&(Ut=Ro(t));var Di=t.length,en=[];for(c=0;c<Di;c++){var Wi=G(t[c]);en.push(s.project(G([Wi.lat-Ut.lat,Wi.lng-Ut.lng])))}for(I=R=ct=0,c=0,d=Di-1;c<Di;d=c++)m=en[c],v=en[d],E=m.y*v.x-v.y*m.x,R+=(m.x+v.x)*E,ct+=(m.y+v.y)*E,I+=E*3;I===0?Tt=en[0]:Tt=[R/I,ct/I];var Gn=s.unproject(ut(Tt));return G([Gn.lat+Ut.lat,Gn.lng+Ut.lng])}function Ro(t){for(var s=0,c=0,d=0,m=0;m<t.length;m++){var v=G(t[m]);s+=v.lat,c+=v.lng,d++}return G([s/d,c/d])}var Il={__proto__:null,clipPolygon:ps,polygonCenter:gs,centroid:Ro};function vs(t,s){if(!s||!t.length)return t.slice();var c=s*s;return t=Nl(t,c),t=Al(t,c),t}function ys(t,s,c){return Math.sqrt(Kn(t,s,c,!0))}function Ol(t,s,c){return Kn(t,s,c)}function Al(t,s){var c=t.length,d=typeof Uint8Array<"u"?Uint8Array:Array,m=new d(c);m[0]=m[c-1]=1,Zo(t,m,s,0,c-1);var v,E=[];for(v=0;v<c;v++)m[v]&&E.push(t[v]);return E}function Zo(t,s,c,d,m){var v=0,E,I,R;for(I=d+1;I<=m-1;I++)R=Kn(t[I],t[d],t[m],!0),R>v&&(E=I,v=R);v>c&&(s[E]=1,Zo(t,s,c,d,E),Zo(t,s,c,E,m))}function Nl(t,s){for(var c=[t[0]],d=1,m=0,v=t.length;d<v;d++)Bl(t[d],t[m])>s&&(c.push(t[d]),m=d);return m<v-1&&c.push(t[v-1]),c}var bs;function ws(t,s,c,d,m){var v=d?bs:xn(t,c),E=xn(s,c),I,R,ct;for(bs=E;;){if(!(v|E))return[t,s];if(v&E)return!1;I=v||E,R=uo(t,s,I,c,m),ct=xn(R,c),I===v?(t=R,v=ct):(s=R,E=ct)}}function uo(t,s,c,d,m){var v=s.x-t.x,E=s.y-t.y,I=d.min,R=d.max,ct,Tt;return c&8?(ct=t.x+v*(R.y-t.y)/E,Tt=R.y):c&4?(ct=t.x+v*(I.y-t.y)/E,Tt=I.y):c&2?(ct=R.x,Tt=t.y+E*(R.x-t.x)/v):c&1&&(ct=I.x,Tt=t.y+E*(I.x-t.x)/v),new q(ct,Tt,m)}function xn(t,s){var c=0;return t.x<s.min.x?c|=1:t.x>s.max.x&&(c|=2),t.y<s.min.y?c|=4:t.y>s.max.y&&(c|=8),c}function Bl(t,s){var c=s.x-t.x,d=s.y-t.y;return c*c+d*d}function Kn(t,s,c,d){var m=s.x,v=s.y,E=c.x-m,I=c.y-v,R=E*E+I*I,ct;return R>0&&(ct=((t.x-m)*E+(t.y-v)*I)/R,ct>1?(m=c.x,v=c.y):ct>0&&(m+=E*ct,v+=I*ct)),E=t.x-m,I=t.y-v,d?E*E+I*I:new q(m,v)}function tn(t){return!O(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function Ls(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),tn(t)}function ks(t,s){var c,d,m,v,E,I,R,ct;if(!t||t.length===0)throw new Error("latlngs not passed");tn(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var Tt=G([0,0]),Ut=Z(t),le=Ut.getNorthWest().distanceTo(Ut.getSouthWest())*Ut.getNorthEast().distanceTo(Ut.getNorthWest());le<1700&&(Tt=Ro(t));var Hi=t.length,Di=[];for(c=0;c<Hi;c++){var en=G(t[c]);Di.push(s.project(G([en.lat-Tt.lat,en.lng-Tt.lng])))}for(c=0,d=0;c<Hi-1;c++)d+=Di[c].distanceTo(Di[c+1])/2;if(d===0)ct=Di[0];else for(c=0,v=0;c<Hi-1;c++)if(E=Di[c],I=Di[c+1],m=E.distanceTo(I),v+=m,v>d){R=(v-d)/m,ct=[I.x-R*(I.x-E.x),I.y-R*(I.y-E.y)];break}var Wi=s.unproject(ut(ct));return G([Wi.lat+Tt.lat,Wi.lng+Tt.lng])}var Rl={__proto__:null,simplify:vs,pointToSegmentDistance:ys,closestPointOnSegment:Ol,clipSegment:ws,_getEdgeIntersection:uo,_getBitCode:xn,_sqClosestPointOnSegment:Kn,isFlat:tn,_flat:Ls,polylineCenter:ks},Ho={project:function(t){return new q(t.lng,t.lat)},unproject:function(t){return new et(t.y,t.x)},bounds:new wt([-180,-90],[180,90])},Fo={R:6378137,R_MINOR:6356752314245179e-9,bounds:new wt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var s=Math.PI/180,c=this.R,d=t.lat*s,m=this.R_MINOR/c,v=Math.sqrt(1-m*m),E=v*Math.sin(d),I=Math.tan(Math.PI/4-d/2)/Math.pow((1-E)/(1+E),v/2);return d=-c*Math.log(Math.max(I,1e-10)),new q(t.lng*s*c,d)},unproject:function(t){for(var s=180/Math.PI,c=this.R,d=this.R_MINOR/c,m=Math.sqrt(1-d*d),v=Math.exp(-t.y/c),E=Math.PI/2-2*Math.atan(v),I=0,R=.1,ct;I<15&&Math.abs(R)>1e-7;I++)ct=m*Math.sin(E),ct=Math.pow((1-ct)/(1+ct),m/2),R=Math.PI/2-2*Math.atan(v*ct)-E,E+=R;return new et(E*s,t.x*s/c)}},Zl={__proto__:null,LonLat:Ho,Mercator:Fo,SphericalMercator:gt},Hl=n({},Xt,{code:"EPSG:3395",projection:Fo,transformation:function(){var t=.5/(Math.PI*Fo.R);return Nt(t,.5,-t,.5)}()}),Ms=n({},Xt,{code:"EPSG:4326",projection:Ho,transformation:Nt(1/180,1,-1/180,.5)}),Fl=n({},it,{projection:Ho,transformation:Nt(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,s){var c=s.lng-t.lng,d=s.lat-t.lat;return Math.sqrt(c*c+d*d)},infinite:!0});it.Earth=Xt,it.EPSG3395=Hl,it.EPSG3857=bt,it.EPSG900913=Kt,it.EPSG4326=Ms,it.Simple=Fl;var cn=X.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[u(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[u(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var s=t.target;if(s.hasLayer(this)){if(this._map=s,this._zoomAnimated=s._zoomAnimated,this.getEvents){var c=this.getEvents();s.on(c,this),this.once("remove",function(){s.off(c,this)},this)}this.onAdd(s),this.fire("add"),s.fire("layeradd",{layer:this})}}});be.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var s=u(t);return this._layers[s]?this:(this._layers[s]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var s=u(t);return this._layers[s]?(this._loaded&&t.onRemove(this),delete this._layers[s],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return u(t)in this._layers},eachLayer:function(t,s){for(var c in this._layers)t.call(s,this._layers[c]);return this},_addLayers:function(t){t=t?O(t)?t:[t]:[];for(var s=0,c=t.length;s<c;s++)this.addLayer(t[s])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[u(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var s=u(t);this._zoomBoundLayers[s]&&(delete this._zoomBoundLayers[s],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,s=-1/0,c=this._getZoomSpan();for(var d in this._zoomBoundLayers){var m=this._zoomBoundLayers[d].options;t=m.minZoom===void 0?t:Math.min(t,m.minZoom),s=m.maxZoom===void 0?s:Math.max(s,m.maxZoom)}this._layersMaxZoom=s===-1/0?void 0:s,this._layersMinZoom=t===1/0?void 0:t,c!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Bn=cn.extend({initialize:function(t,s){C(this,s),this._layers={};var c,d;if(t)for(c=0,d=t.length;c<d;c++)this.addLayer(t[c])},addLayer:function(t){var s=this.getLayerId(t);return this._layers[s]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var s=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[s]&&this._map.removeLayer(this._layers[s]),delete this._layers[s],this},hasLayer:function(t){var s=typeof t=="number"?t:this.getLayerId(t);return s in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var s=Array.prototype.slice.call(arguments,1),c,d;for(c in this._layers)d=this._layers[c],d[t]&&d[t].apply(d,s);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,s){for(var c in this._layers)t.call(s,this._layers[c]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return u(t)}}),Gl=function(t,s){return new Bn(t,s)},gn=Bn.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Bn.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Bn.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new ht;for(var s in this._layers){var c=this._layers[s];t.extend(c.getBounds?c.getBounds():c.getLatLng())}return t}}),ql=function(t,s){return new gn(t,s)},Rn=j.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){C(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,s){var c=this._getIconUrl(t);if(!c){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var d=this._createImg(c,s&&s.tagName==="IMG"?s:null);return this._setIconStyles(d,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),d},_setIconStyles:function(t,s){var c=this.options,d=c[s+"Size"];typeof d=="number"&&(d=[d,d]);var m=ut(d),v=ut(s==="shadow"&&c.shadowAnchor||c.iconAnchor||m&&m.divideBy(2,!0));t.className="leaflet-marker-"+s+" "+(c.className||""),v&&(t.style.marginLeft=-v.x+"px",t.style.marginTop=-v.y+"px"),m&&(t.style.width=m.x+"px",t.style.height=m.y+"px")},_createImg:function(t,s){return s=s||document.createElement("img"),s.src=t,s},_getIconUrl:function(t){return kt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function Ul(t){return new Rn(t)}var Jn=Rn.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof Jn.imagePath!="string"&&(Jn.imagePath=this._detectIconPath()),(this.options.imagePath||Jn.imagePath)+Rn.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var s=function(c,d,m){var v=d.exec(c);return v&&v[m]};return t=s(t,/^url\((['"])?(.+)\1\)$/,2),t&&s(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=Rt("div","leaflet-default-icon-path",document.body),s=vt(t,"background-image")||vt(t,"backgroundImage");if(document.body.removeChild(t),s=this._stripUrl(s),s)return s;var c=document.querySelector('link[href$="leaflet.css"]');return c?c.href.substring(0,c.href.length-11-1):""}}),Ps=fn.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new Mn(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Ht(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ye(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var s=this._marker,c=s._map,d=this._marker.options.autoPanSpeed,m=this._marker.options.autoPanPadding,v=je(s._icon),E=c.getPixelBounds(),I=c.getPixelOrigin(),R=It(E.min._subtract(I).add(m),E.max._subtract(I).subtract(m));if(!R.contains(v)){var ct=ut((Math.max(R.max.x,v.x)-R.max.x)/(E.max.x-R.max.x)-(Math.min(R.min.x,v.x)-R.min.x)/(E.min.x-R.min.x),(Math.max(R.max.y,v.y)-R.max.y)/(E.max.y-R.max.y)-(Math.min(R.min.y,v.y)-R.min.y)/(E.min.y-R.min.y)).multiplyBy(d);c.panBy(ct,{animate:!1}),this._draggable._newPos._add(ct),this._draggable._startPos._add(ct),Ne(s._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=K(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(N(this._panRequest),this._panRequest=K(this._adjustPan.bind(this,t)))},_onDrag:function(t){var s=this._marker,c=s._shadow,d=je(s._icon),m=s._map.layerPointToLatLng(d);c&&Ne(c,d),s._latlng=m,t.latlng=m,t.oldLatLng=this._oldLatLng,s.fire("move",t).fire("drag",t)},_onDragEnd:function(t){N(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),fo=cn.extend({options:{icon:new Jn,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,s){C(this,s),this._latlng=G(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var s=this._latlng;return this._latlng=G(t),this.update(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,s="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),c=t.icon.createIcon(this._icon),d=!1;c!==this._icon&&(this._icon&&this._removeIcon(),d=!0,t.title&&(c.title=t.title),c.tagName==="IMG"&&(c.alt=t.alt||"")),Ht(c,s),t.keyboard&&(c.tabIndex="0",c.setAttribute("role","button")),this._icon=c,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Wt(c,"focus",this._panOnFocus,this);var m=t.icon.createShadow(this._shadow),v=!1;m!==this._shadow&&(this._removeShadow(),v=!0),m&&(Ht(m,s),m.alt=""),this._shadow=m,t.opacity<1&&this._updateOpacity(),d&&this.getPane().appendChild(this._icon),this._initInteraction(),m&&v&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&M(this._icon,"focus",this._panOnFocus,this),ne(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ne(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&Ne(this._icon,t),this._shadow&&Ne(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var s=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(s)},_initInteraction:function(){if(this.options.interactive&&(Ht(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ps)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ps(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&yi(this._icon,t),this._shadow&&yi(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var s=this.options.icon.options,c=s.iconSize?ut(s.iconSize):ut(0,0),d=s.iconAnchor?ut(s.iconAnchor):ut(0,0);t.panInside(this._latlng,{paddingTopLeft:d,paddingBottomRight:c.subtract(d)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Wl(t,s){return new fo(t,s)}var Pn=cn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return C(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),_o=Pn.extend({options:{fill:!0,radius:10},initialize:function(t,s){C(this,s),this._latlng=G(t),this._radius=this.options.radius},setLatLng:function(t){var s=this._latlng;return this._latlng=G(t),this.redraw(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var s=t&&t.radius||this._radius;return Pn.prototype.setStyle.call(this,t),this.setRadius(s),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,s=this._radiusY||t,c=this._clickTolerance(),d=[t+c,s+c];this._pxBounds=new wt(this._point.subtract(d),this._point.add(d))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function jl(t,s){return new _o(t,s)}var Go=_o.extend({initialize:function(t,s,c){if(typeof s=="number"&&(s=n({},c,{radius:s})),C(this,s),this._latlng=G(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new ht(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Pn.prototype.setStyle,_project:function(){var t=this._latlng.lng,s=this._latlng.lat,c=this._map,d=c.options.crs;if(d.distance===Xt.distance){var m=Math.PI/180,v=this._mRadius/Xt.R/m,E=c.project([s+v,t]),I=c.project([s-v,t]),R=E.add(I).divideBy(2),ct=c.unproject(R).lat,Tt=Math.acos((Math.cos(v*m)-Math.sin(s*m)*Math.sin(ct*m))/(Math.cos(s*m)*Math.cos(ct*m)))/m;(isNaN(Tt)||Tt===0)&&(Tt=v/Math.cos(Math.PI/180*s)),this._point=R.subtract(c.getPixelOrigin()),this._radius=isNaN(Tt)?0:R.x-c.project([ct,t-Tt]).x,this._radiusY=R.y-E.y}else{var Ut=d.unproject(d.project(this._latlng).subtract([this._mRadius,0]));this._point=c.latLngToLayerPoint(this._latlng),this._radius=this._point.x-c.latLngToLayerPoint(Ut).x}this._updateBounds()}});function Vl(t,s,c){return new Go(t,s,c)}var vn=Pn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,s){C(this,s),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var s=1/0,c=null,d=Kn,m,v,E=0,I=this._parts.length;E<I;E++)for(var R=this._parts[E],ct=1,Tt=R.length;ct<Tt;ct++){m=R[ct-1],v=R[ct];var Ut=d(t,m,v,!0);Ut<s&&(s=Ut,c=d(t,m,v))}return c&&(c.distance=Math.sqrt(s)),c},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ks(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,s){return s=s||this._defaultShape(),t=G(t),s.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new ht,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return tn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var s=[],c=tn(t),d=0,m=t.length;d<m;d++)c?(s[d]=G(t[d]),this._bounds.extend(s[d])):s[d]=this._convertLatLngs(t[d]);return s},_project:function(){var t=new wt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),s=new q(t,t);this._rawPxBounds&&(this._pxBounds=new wt([this._rawPxBounds.min.subtract(s),this._rawPxBounds.max.add(s)]))},_projectLatlngs:function(t,s,c){var d=t[0]instanceof et,m=t.length,v,E;if(d){for(E=[],v=0;v<m;v++)E[v]=this._map.latLngToLayerPoint(t[v]),c.extend(E[v]);s.push(E)}else for(v=0;v<m;v++)this._projectLatlngs(t[v],s,c)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var s=this._parts,c,d,m,v,E,I,R;for(c=0,m=0,v=this._rings.length;c<v;c++)for(R=this._rings[c],d=0,E=R.length;d<E-1;d++)I=ws(R[d],R[d+1],t,d,!0),I&&(s[m]=s[m]||[],s[m].push(I[0]),(I[1]!==R[d+1]||d===E-2)&&(s[m].push(I[1]),m++))}},_simplifyPoints:function(){for(var t=this._parts,s=this.options.smoothFactor,c=0,d=t.length;c<d;c++)t[c]=vs(t[c],s)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,s){var c,d,m,v,E,I,R=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(c=0,v=this._parts.length;c<v;c++)for(I=this._parts[c],d=0,E=I.length,m=E-1;d<E;m=d++)if(!(!s&&d===0)&&ys(t,I[m],I[d])<=R)return!0;return!1}});function Yl(t,s){return new vn(t,s)}vn._flat=Ls;var Zn=vn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return gs(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var s=vn.prototype._convertLatLngs.call(this,t),c=s.length;return c>=2&&s[0]instanceof et&&s[0].equals(s[c-1])&&s.pop(),s},_setLatLngs:function(t){vn.prototype._setLatLngs.call(this,t),tn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return tn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,s=this.options.weight,c=new q(s,s);if(t=new wt(t.min.subtract(c),t.max.add(c)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var d=0,m=this._rings.length,v;d<m;d++)v=ps(this._rings[d],t,!0),v.length&&this._parts.push(v)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var s=!1,c,d,m,v,E,I,R,ct;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(v=0,R=this._parts.length;v<R;v++)for(c=this._parts[v],E=0,ct=c.length,I=ct-1;E<ct;I=E++)d=c[E],m=c[I],d.y>t.y!=m.y>t.y&&t.x<(m.x-d.x)*(t.y-d.y)/(m.y-d.y)+d.x&&(s=!s);return s||vn.prototype._containsPoint.call(this,t,!0)}});function Xl(t,s){return new Zn(t,s)}var yn=gn.extend({initialize:function(t,s){C(this,s),this._layers={},t&&this.addData(t)},addData:function(t){var s=O(t)?t:t.features,c,d,m;if(s){for(c=0,d=s.length;c<d;c++)m=s[c],(m.geometries||m.geometry||m.features||m.coordinates)&&this.addData(m);return this}var v=this.options;if(v.filter&&!v.filter(t))return this;var E=mo(t,v);return E?(E.feature=vo(t),E.defaultOptions=E.options,this.resetStyle(E),v.onEachFeature&&v.onEachFeature(t,E),this.addLayer(E)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=n({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(s){this._setLayerStyle(s,t)},this)},_setLayerStyle:function(t,s){t.setStyle&&(typeof s=="function"&&(s=s(t.feature)),t.setStyle(s))}});function mo(t,s){var c=t.type==="Feature"?t.geometry:t,d=c?c.coordinates:null,m=[],v=s&&s.pointToLayer,E=s&&s.coordsToLatLng||qo,I,R,ct,Tt;if(!d&&!c)return null;switch(c.type){case"Point":return I=E(d),Es(v,t,I,s);case"MultiPoint":for(ct=0,Tt=d.length;ct<Tt;ct++)I=E(d[ct]),m.push(Es(v,t,I,s));return new gn(m);case"LineString":case"MultiLineString":return R=po(d,c.type==="LineString"?0:1,E),new vn(R,s);case"Polygon":case"MultiPolygon":return R=po(d,c.type==="Polygon"?1:2,E),new Zn(R,s);case"GeometryCollection":for(ct=0,Tt=c.geometries.length;ct<Tt;ct++){var Ut=mo({geometry:c.geometries[ct],type:"Feature",properties:t.properties},s);Ut&&m.push(Ut)}return new gn(m);case"FeatureCollection":for(ct=0,Tt=c.features.length;ct<Tt;ct++){var le=mo(c.features[ct],s);le&&m.push(le)}return new gn(m);default:throw new Error("Invalid GeoJSON object.")}}function Es(t,s,c,d){return t?t(s,c):new fo(c,d&&d.markersInheritOptions&&d)}function qo(t){return new et(t[1],t[0],t[2])}function po(t,s,c){for(var d=[],m=0,v=t.length,E;m<v;m++)E=s?po(t[m],s-1,c):(c||qo)(t[m]),d.push(E);return d}function Uo(t,s){return t=G(t),t.alt!==void 0?[y(t.lng,s),y(t.lat,s),y(t.alt,s)]:[y(t.lng,s),y(t.lat,s)]}function go(t,s,c,d){for(var m=[],v=0,E=t.length;v<E;v++)m.push(s?go(t[v],tn(t[v])?0:s-1,c,d):Uo(t[v],d));return!s&&c&&m.length>0&&m.push(m[0].slice()),m}function Hn(t,s){return t.feature?n({},t.feature,{geometry:s}):vo(s)}function vo(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var Wo={toGeoJSON:function(t){return Hn(this,{type:"Point",coordinates:Uo(this.getLatLng(),t)})}};fo.include(Wo),Go.include(Wo),_o.include(Wo),vn.include({toGeoJSON:function(t){var s=!tn(this._latlngs),c=go(this._latlngs,s?1:0,!1,t);return Hn(this,{type:(s?"Multi":"")+"LineString",coordinates:c})}}),Zn.include({toGeoJSON:function(t){var s=!tn(this._latlngs),c=s&&!tn(this._latlngs[0]),d=go(this._latlngs,c?2:s?1:0,!0,t);return s||(d=[d]),Hn(this,{type:(c?"Multi":"")+"Polygon",coordinates:d})}}),Bn.include({toMultiPoint:function(t){var s=[];return this.eachLayer(function(c){s.push(c.toGeoJSON(t).geometry.coordinates)}),Hn(this,{type:"MultiPoint",coordinates:s})},toGeoJSON:function(t){var s=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(s==="MultiPoint")return this.toMultiPoint(t);var c=s==="GeometryCollection",d=[];return this.eachLayer(function(m){if(m.toGeoJSON){var v=m.toGeoJSON(t);if(c)d.push(v.geometry);else{var E=vo(v);E.type==="FeatureCollection"?d.push.apply(d,E.features):d.push(E)}}}),c?Hn(this,{geometries:d,type:"GeometryCollection"}):{type:"FeatureCollection",features:d}}});function Cs(t,s){return new yn(t,s)}var Kl=Cs,yo=cn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,s,c){this._url=t,this._bounds=Z(s),C(this,c)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Ht(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ne(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&zi(this._image),this},bringToBack:function(){return this._map&&Fe(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=Z(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",s=this._image=t?this._url:Rt("img");if(Ht(s,"leaflet-image-layer"),this._zoomAnimated&&Ht(s,"leaflet-zoom-animated"),this.options.className&&Ht(s,this.options.className),s.onselectstart=g,s.onmousemove=g,s.onload=l(this.fire,this,"load"),s.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(s.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=s.src;return}s.src=this._url,s.alt=this.options.alt},_animateZoom:function(t){var s=this._map.getZoomScale(t.zoom),c=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;Ni(this._image,c,s)},_reset:function(){var t=this._image,s=new wt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),c=s.getSize();Ne(t,s.min),t.style.width=c.x+"px",t.style.height=c.y+"px"},_updateOpacity:function(){yi(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Jl=function(t,s,c){return new yo(t,s,c)},Ts=yo.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",s=this._image=t?this._url:Rt("video");if(Ht(s,"leaflet-image-layer"),this._zoomAnimated&&Ht(s,"leaflet-zoom-animated"),this.options.className&&Ht(s,this.options.className),s.onselectstart=g,s.onmousemove=g,s.onloadeddata=l(this.fire,this,"load"),t){for(var c=s.getElementsByTagName("source"),d=[],m=0;m<c.length;m++)d.push(c[m].src);this._url=c.length>0?d:[s.src];return}O(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(s.style,"objectFit")&&(s.style.objectFit="fill"),s.autoplay=!!this.options.autoplay,s.loop=!!this.options.loop,s.muted=!!this.options.muted,s.playsInline=!!this.options.playsInline;for(var v=0;v<this._url.length;v++){var E=Rt("source");E.src=this._url[v],s.appendChild(E)}}});function Ql(t,s,c){return new Ts(t,s,c)}var Ss=yo.extend({_initImage:function(){var t=this._image=this._url;Ht(t,"leaflet-image-layer"),this._zoomAnimated&&Ht(t,"leaflet-zoom-animated"),this.options.className&&Ht(t,this.options.className),t.onselectstart=g,t.onmousemove=g}});function $l(t,s,c){return new Ss(t,s,c)}var _n=cn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,s){t&&(t instanceof et||O(t))?(this._latlng=G(t),C(this,s)):(C(this,t),this._source=s),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&yi(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&yi(this._container,1),this.bringToFront(),this.options.interactive&&(Ht(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(yi(this._container,0),this._removeTimeout=setTimeout(l(ne,void 0,this._container),200)):ne(this._container),this.options.interactive&&(ye(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=G(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&zi(this._container),this},bringToBack:function(){return this._map&&Fe(this._container),this},_prepareOpen:function(t){var s=this._source;if(!s._map)return!1;if(s instanceof gn){s=null;var c=this._source._layers;for(var d in c)if(c[d]._map){s=c[d];break}if(!s)return!1;this._source=s}if(!t)if(s.getCenter)t=s.getCenter();else if(s.getLatLng)t=s.getLatLng();else if(s.getBounds)t=s.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,s=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof s=="string")t.innerHTML=s;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(s)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),s=ut(this.options.offset),c=this._getAnchor();this._zoomAnimated?Ne(this._container,t.add(c)):s=s.add(t).add(c);var d=this._containerBottom=-s.y,m=this._containerLeft=-Math.round(this._containerWidth/2)+s.x;this._container.style.bottom=d+"px",this._container.style.left=m+"px"}},_getAnchor:function(){return[0,0]}});be.include({_initOverlay:function(t,s,c,d){var m=s;return m instanceof t||(m=new t(d).setContent(s)),c&&m.setLatLng(c),m}}),cn.include({_initOverlay:function(t,s,c,d){var m=c;return m instanceof t?(C(m,d),m._source=this):(m=s&&!d?s:new t(d,this),m.setContent(c)),m}});var bo=_n.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,_n.prototype.openOn.call(this,t)},onAdd:function(t){_n.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Pn||this._source.on("preclick",St))},onRemove:function(t){_n.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Pn||this._source.off("preclick",St))},getEvents:function(){var t=_n.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",s=this._container=Rt("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),c=this._wrapper=Rt("div",t+"-content-wrapper",s);if(this._contentNode=Rt("div",t+"-content",c),Pe(s),hi(this._contentNode),Wt(s,"contextmenu",St),this._tipContainer=Rt("div",t+"-tip-container",s),this._tip=Rt("div",t+"-tip",this._tipContainer),this.options.closeButton){var d=this._closeButton=Rt("a",t+"-close-button",s);d.setAttribute("role","button"),d.setAttribute("aria-label","Close popup"),d.href="#close",d.innerHTML='<span aria-hidden="true">&#215;</span>',Wt(d,"click",function(m){Ct(m),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,s=t.style;s.width="",s.whiteSpace="nowrap";var c=t.offsetWidth;c=Math.min(c,this.options.maxWidth),c=Math.max(c,this.options.minWidth),s.width=c+1+"px",s.whiteSpace="",s.height="";var d=t.offsetHeight,m=this.options.maxHeight,v="leaflet-popup-scrolled";m&&d>m?(s.height=m+"px",Ht(t,v)):ye(t,v),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var s=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),c=this._getAnchor();Ne(this._container,s.add(c))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,s=parseInt(vt(this._container,"marginBottom"),10)||0,c=this._container.offsetHeight+s,d=this._containerWidth,m=new q(this._containerLeft,-c-this._containerBottom);m._add(je(this._container));var v=t.layerPointToContainerPoint(m),E=ut(this.options.autoPanPadding),I=ut(this.options.autoPanPaddingTopLeft||E),R=ut(this.options.autoPanPaddingBottomRight||E),ct=t.getSize(),Tt=0,Ut=0;v.x+d+R.x>ct.x&&(Tt=v.x+d-ct.x+R.x),v.x-Tt-I.x<0&&(Tt=v.x-I.x),v.y+c+R.y>ct.y&&(Ut=v.y+c-ct.y+R.y),v.y-Ut-I.y<0&&(Ut=v.y-I.y),(Tt||Ut)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([Tt,Ut]))}},_getAnchor:function(){return ut(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),tc=function(t,s){return new bo(t,s)};be.mergeOptions({closePopupOnClick:!0}),be.include({openPopup:function(t,s,c){return this._initOverlay(bo,t,s,c).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),cn.include({bindPopup:function(t,s){return this._popup=this._initOverlay(bo,this._popup,t,s),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof gn||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){Be(t);var s=t.layer||t.target;if(this._popup._source===s&&!(s instanceof Pn)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=s,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var wo=_n.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){_n.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){_n.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=_n.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",s=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Rt("div",s),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var s,c,d=this._map,m=this._container,v=d.latLngToContainerPoint(d.getCenter()),E=d.layerPointToContainerPoint(t),I=this.options.direction,R=m.offsetWidth,ct=m.offsetHeight,Tt=ut(this.options.offset),Ut=this._getAnchor();I==="top"?(s=R/2,c=ct):I==="bottom"?(s=R/2,c=0):I==="center"?(s=R/2,c=ct/2):I==="right"?(s=0,c=ct/2):I==="left"?(s=R,c=ct/2):E.x<v.x?(I="right",s=0,c=ct/2):(I="left",s=R+(Tt.x+Ut.x)*2,c=ct/2),t=t.subtract(ut(s,c,!0)).add(Tt).add(Ut),ye(m,"leaflet-tooltip-right"),ye(m,"leaflet-tooltip-left"),ye(m,"leaflet-tooltip-top"),ye(m,"leaflet-tooltip-bottom"),Ht(m,"leaflet-tooltip-"+I),Ne(m,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&yi(this._container,t)},_animateZoom:function(t){var s=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(s)},_getAnchor:function(){return ut(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),ec=function(t,s){return new wo(t,s)};be.include({openTooltip:function(t,s,c){return this._initOverlay(wo,t,s,c).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),cn.include({bindTooltip:function(t,s){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(wo,this._tooltip,t,s),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var s=t?"off":"on",c={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?c.add=this._openTooltip:(c.mouseover=this._openTooltip,c.mouseout=this.closeTooltip,c.click=this._openTooltip,this._map?this._addFocusListeners():c.add=this._addFocusListeners),this._tooltip.options.sticky&&(c.mousemove=this._moveTooltip),this[s](c),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof gn||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var s=typeof t.getElement=="function"&&t.getElement();s&&(Wt(s,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),Wt(s,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var s=typeof t.getElement=="function"&&t.getElement();s&&s.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var s=this;this._map.once("moveend",function(){s._openOnceFlag=!1,s._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var s=t.latlng,c,d;this._tooltip.options.sticky&&t.originalEvent&&(c=this._map.mouseEventToContainerPoint(t.originalEvent),d=this._map.containerPointToLayerPoint(c),s=this._map.layerPointToLatLng(d)),this._tooltip.setLatLng(s)}});var Ds=Rn.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var s=t&&t.tagName==="DIV"?t:document.createElement("div"),c=this.options;if(c.html instanceof Element?(_i(s),s.appendChild(c.html)):s.innerHTML=c.html!==!1?c.html:"",c.bgPos){var d=ut(c.bgPos);s.style.backgroundPosition=-d.x+"px "+-d.y+"px"}return this._setIconStyles(s,"icon"),s},createShadow:function(){return null}});function ic(t){return new Ds(t)}Rn.Default=Jn;var Qn=cn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:kt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){C(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ne(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(zi(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Fe(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof q?t:new q(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var s=this.getPane().children,c=-t(-1/0,1/0),d=0,m=s.length,v;d<m;d++)v=s[d].style.zIndex,s[d]!==this._container&&v&&(c=t(c,+v));isFinite(c)&&(this.options.zIndex=c+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!kt.ielt9){yi(this._container,this.options.opacity);var t=+new Date,s=!1,c=!1;for(var d in this._tiles){var m=this._tiles[d];if(!(!m.current||!m.loaded)){var v=Math.min(1,(t-m.loaded)/200);yi(m.el,v),v<1?s=!0:(m.active?c=!0:this._onOpaqueTile(m),m.active=!0)}}c&&!this._noPrune&&this._pruneTiles(),s&&(N(this._fadeFrame),this._fadeFrame=K(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=Rt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,s=this.options.maxZoom;if(t!==void 0){for(var c in this._levels)c=Number(c),this._levels[c].el.children.length||c===t?(this._levels[c].el.style.zIndex=s-Math.abs(t-c),this._onUpdateLevel(c)):(ne(this._levels[c].el),this._removeTilesAtZoom(c),this._onRemoveLevel(c),delete this._levels[c]);var d=this._levels[t],m=this._map;return d||(d=this._levels[t]={},d.el=Rt("div","leaflet-tile-container leaflet-zoom-animated",this._container),d.el.style.zIndex=s,d.origin=m.project(m.unproject(m.getPixelOrigin()),t).round(),d.zoom=t,this._setZoomTransform(d,m.getCenter(),m.getZoom()),g(d.el.offsetWidth),this._onCreateLevel(d)),this._level=d,d}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var t,s,c=this._map.getZoom();if(c>this.options.maxZoom||c<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)s=this._tiles[t],s.retain=s.current;for(t in this._tiles)if(s=this._tiles[t],s.current&&!s.active){var d=s.coords;this._retainParent(d.x,d.y,d.z,d.z-5)||this._retainChildren(d.x,d.y,d.z,d.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var s in this._tiles)this._tiles[s].coords.z===t&&this._removeTile(s)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ne(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,s,c,d){var m=Math.floor(t/2),v=Math.floor(s/2),E=c-1,I=new q(+m,+v);I.z=+E;var R=this._tileCoordsToKey(I),ct=this._tiles[R];return ct&&ct.active?(ct.retain=!0,!0):(ct&&ct.loaded&&(ct.retain=!0),E>d?this._retainParent(m,v,E,d):!1)},_retainChildren:function(t,s,c,d){for(var m=2*t;m<2*t+2;m++)for(var v=2*s;v<2*s+2;v++){var E=new q(m,v);E.z=c+1;var I=this._tileCoordsToKey(E),R=this._tiles[I];if(R&&R.active){R.retain=!0;continue}else R&&R.loaded&&(R.retain=!0);c+1<d&&this._retainChildren(m,v,c+1,d)}},_resetView:function(t){var s=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),s,s)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var s=this.options;return s.minNativeZoom!==void 0&&t<s.minNativeZoom?s.minNativeZoom:s.maxNativeZoom!==void 0&&s.maxNativeZoom<t?s.maxNativeZoom:t},_setView:function(t,s,c,d){var m=Math.round(s);this.options.maxZoom!==void 0&&m>this.options.maxZoom||this.options.minZoom!==void 0&&m<this.options.minZoom?m=void 0:m=this._clampZoom(m);var v=this.options.updateWhenZooming&&m!==this._tileZoom;(!d||v)&&(this._tileZoom=m,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),m!==void 0&&this._update(t),c||this._pruneTiles(),this._noPrune=!!c),this._setZoomTransforms(t,s)},_setZoomTransforms:function(t,s){for(var c in this._levels)this._setZoomTransform(this._levels[c],t,s)},_setZoomTransform:function(t,s,c){var d=this._map.getZoomScale(c,t.zoom),m=t.origin.multiplyBy(d).subtract(this._map._getNewPixelOrigin(s,c)).round();kt.any3d?Ni(t.el,m,d):Ne(t.el,m)},_resetGrid:function(){var t=this._map,s=t.options.crs,c=this._tileSize=this.getTileSize(),d=this._tileZoom,m=this._map.getPixelWorldBounds(this._tileZoom);m&&(this._globalTileRange=this._pxBoundsToTileRange(m)),this._wrapX=s.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,s.wrapLng[0]],d).x/c.x),Math.ceil(t.project([0,s.wrapLng[1]],d).x/c.y)],this._wrapY=s.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([s.wrapLat[0],0],d).y/c.x),Math.ceil(t.project([s.wrapLat[1],0],d).y/c.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var s=this._map,c=s._animatingZoom?Math.max(s._animateToZoom,s.getZoom()):s.getZoom(),d=s.getZoomScale(c,this._tileZoom),m=s.project(t,this._tileZoom).floor(),v=s.getSize().divideBy(d*2);return new wt(m.subtract(v),m.add(v))},_update:function(t){var s=this._map;if(s){var c=this._clampZoom(s.getZoom());if(t===void 0&&(t=s.getCenter()),this._tileZoom!==void 0){var d=this._getTiledPixelBounds(t),m=this._pxBoundsToTileRange(d),v=m.getCenter(),E=[],I=this.options.keepBuffer,R=new wt(m.getBottomLeft().subtract([I,-I]),m.getTopRight().add([I,-I]));if(!(isFinite(m.min.x)&&isFinite(m.min.y)&&isFinite(m.max.x)&&isFinite(m.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ct in this._tiles){var Tt=this._tiles[ct].coords;(Tt.z!==this._tileZoom||!R.contains(new q(Tt.x,Tt.y)))&&(this._tiles[ct].current=!1)}if(Math.abs(c-this._tileZoom)>1){this._setView(t,c);return}for(var Ut=m.min.y;Ut<=m.max.y;Ut++)for(var le=m.min.x;le<=m.max.x;le++){var Hi=new q(le,Ut);if(Hi.z=this._tileZoom,!!this._isValidTile(Hi)){var Di=this._tiles[this._tileCoordsToKey(Hi)];Di?Di.current=!0:E.push(Hi)}}if(E.sort(function(Wi,Gn){return Wi.distanceTo(v)-Gn.distanceTo(v)}),E.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var en=document.createDocumentFragment();for(le=0;le<E.length;le++)this._addTile(E[le],en);this._level.el.appendChild(en)}}}},_isValidTile:function(t){var s=this._map.options.crs;if(!s.infinite){var c=this._globalTileRange;if(!s.wrapLng&&(t.x<c.min.x||t.x>c.max.x)||!s.wrapLat&&(t.y<c.min.y||t.y>c.max.y))return!1}if(!this.options.bounds)return!0;var d=this._tileCoordsToBounds(t);return Z(this.options.bounds).overlaps(d)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var s=this._map,c=this.getTileSize(),d=t.scaleBy(c),m=d.add(c),v=s.unproject(d,t.z),E=s.unproject(m,t.z);return[v,E]},_tileCoordsToBounds:function(t){var s=this._tileCoordsToNwSe(t),c=new ht(s[0],s[1]);return this.options.noWrap||(c=this._map.wrapLatLngBounds(c)),c},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var s=t.split(":"),c=new q(+s[0],+s[1]);return c.z=+s[2],c},_removeTile:function(t){var s=this._tiles[t];s&&(ne(s.el),delete this._tiles[t],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){Ht(t,"leaflet-tile");var s=this.getTileSize();t.style.width=s.x+"px",t.style.height=s.y+"px",t.onselectstart=g,t.onmousemove=g,kt.ielt9&&this.options.opacity<1&&yi(t,this.options.opacity)},_addTile:function(t,s){var c=this._getTilePos(t),d=this._tileCoordsToKey(t),m=this.createTile(this._wrapCoords(t),l(this._tileReady,this,t));this._initTile(m),this.createTile.length<2&&K(l(this._tileReady,this,t,null,m)),Ne(m,c),this._tiles[d]={el:m,coords:t,current:!0},s.appendChild(m),this.fire("tileloadstart",{tile:m,coords:t})},_tileReady:function(t,s,c){s&&this.fire("tileerror",{error:s,tile:c,coords:t});var d=this._tileCoordsToKey(t);c=this._tiles[d],c&&(c.loaded=+new Date,this._map._fadeAnimated?(yi(c.el,0),N(this._fadeFrame),this._fadeFrame=K(this._updateOpacity,this)):(c.active=!0,this._pruneTiles()),s||(Ht(c.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:c.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),kt.ielt9||!this._map._fadeAnimated?K(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var s=new q(this._wrapX?_(t.x,this._wrapX):t.x,this._wrapY?_(t.y,this._wrapY):t.y);return s.z=t.z,s},_pxBoundsToTileRange:function(t){var s=this.getTileSize();return new wt(t.min.unscaleBy(s).floor(),t.max.unscaleBy(s).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function nc(t){return new Qn(t)}var Fn=Qn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,s){this._url=t,s=C(this,s),s.detectRetina&&kt.retina&&s.maxZoom>0?(s.tileSize=Math.floor(s.tileSize/2),s.zoomReverse?(s.zoomOffset--,s.minZoom=Math.min(s.maxZoom,s.minZoom+1)):(s.zoomOffset++,s.maxZoom=Math.max(s.minZoom,s.maxZoom-1)),s.minZoom=Math.max(0,s.minZoom)):s.zoomReverse?s.minZoom=Math.min(s.maxZoom,s.minZoom):s.maxZoom=Math.max(s.minZoom,s.maxZoom),typeof s.subdomains=="string"&&(s.subdomains=s.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,s){return this._url===t&&s===void 0&&(s=!0),this._url=t,s||this.redraw(),this},createTile:function(t,s){var c=document.createElement("img");return Wt(c,"load",l(this._tileOnLoad,this,s,c)),Wt(c,"error",l(this._tileOnError,this,s,c)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(c.referrerPolicy=this.options.referrerPolicy),c.alt="",c.src=this.getTileUrl(t),c},getTileUrl:function(t){var s={r:kt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var c=this._globalTileRange.max.y-t.y;this.options.tms&&(s.y=c),s["-y"]=c}return z(this._url,n(s,this.options))},_tileOnLoad:function(t,s){kt.ielt9?setTimeout(l(t,this,null,s),0):t(null,s)},_tileOnError:function(t,s,c){var d=this.options.errorTileUrl;d&&s.getAttribute("src")!==d&&(s.src=d),t(c,s)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,s=this.options.maxZoom,c=this.options.zoomReverse,d=this.options.zoomOffset;return c&&(t=s-t),t+d},_getSubdomain:function(t){var s=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[s]},_abortLoading:function(){var t,s;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(s=this._tiles[t].el,s.onload=g,s.onerror=g,!s.complete)){s.src=$;var c=this._tiles[t].coords;ne(s),delete this._tiles[t],this.fire("tileabort",{tile:s,coords:c})}},_removeTile:function(t){var s=this._tiles[t];if(s)return s.el.setAttribute("src",$),Qn.prototype._removeTile.call(this,t)},_tileReady:function(t,s,c){if(!(!this._map||c&&c.getAttribute("src")===$))return Qn.prototype._tileReady.call(this,t,s,c)}});function xs(t,s){return new Fn(t,s)}var zs=Fn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,s){this._url=t;var c=n({},this.defaultWmsParams);for(var d in s)d in this.options||(c[d]=s[d]);s=C(this,s);var m=s.detectRetina&&kt.retina?2:1,v=this.getTileSize();c.width=v.x*m,c.height=v.y*m,this.wmsParams=c},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var s=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[s]=this._crs.code,Fn.prototype.onAdd.call(this,t)},getTileUrl:function(t){var s=this._tileCoordsToNwSe(t),c=this._crs,d=It(c.project(s[0]),c.project(s[1])),m=d.min,v=d.max,E=(this._wmsVersion>=1.3&&this._crs===Ms?[m.y,m.x,v.y,v.x]:[m.x,m.y,v.x,v.y]).join(","),I=Fn.prototype.getTileUrl.call(this,t);return I+S(this.wmsParams,I,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+E},setParams:function(t,s){return n(this.wmsParams,t),s||this.redraw(),this}});function oc(t,s){return new zs(t,s)}Fn.WMS=zs,xs.wms=oc;var bn=cn.extend({options:{padding:.1},initialize:function(t){C(this,t),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Ht(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,s){var c=this._map.getZoomScale(s,this._zoom),d=this._map.getSize().multiplyBy(.5+this.options.padding),m=this._map.project(this._center,s),v=d.multiplyBy(-c).add(m).subtract(this._map._getNewPixelOrigin(t,s));kt.any3d?Ni(this._container,v,c):Ne(this._container,v)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,s=this._map.getSize(),c=this._map.containerPointToLayerPoint(s.multiplyBy(-t)).round();this._bounds=new wt(c,c.add(s.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Is=bn.extend({options:{tolerance:0},getEvents:function(){var t=bn.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){bn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Wt(t,"mousemove",this._onMouseMove,this),Wt(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Wt(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){N(this._redrawRequest),delete this._ctx,ne(this._container),M(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var s in this._layers)t=this._layers[s],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){bn.prototype._update.call(this);var t=this._bounds,s=this._container,c=t.getSize(),d=kt.retina?2:1;Ne(s,t.min),s.width=d*c.x,s.height=d*c.y,s.style.width=c.x+"px",s.style.height=c.y+"px",kt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){bn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[u(t)]=t;var s=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=s),this._drawLast=s,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var s=t._order,c=s.next,d=s.prev;c?c.prev=d:this._drawLast=d,d?d.next=c:this._drawFirst=c,delete t._order,delete this._layers[u(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var s=t.options.dashArray.split(/[, ]+/),c=[],d,m;for(m=0;m<s.length;m++){if(d=Number(s[m]),isNaN(d))return;c.push(d)}t.options._dashArray=c}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||K(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var s=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new wt,this._redrawBounds.extend(t._pxBounds.min.subtract([s,s])),this._redrawBounds.extend(t._pxBounds.max.add([s,s]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var s=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,s.x,s.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,s=this._redrawBounds;if(this._ctx.save(),s){var c=s.getSize();this._ctx.beginPath(),this._ctx.rect(s.min.x,s.min.y,c.x,c.y),this._ctx.clip()}this._drawing=!0;for(var d=this._drawFirst;d;d=d.next)t=d.layer,(!s||t._pxBounds&&t._pxBounds.intersects(s))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,s){if(this._drawing){var c,d,m,v,E=t._parts,I=E.length,R=this._ctx;if(I){for(R.beginPath(),c=0;c<I;c++){for(d=0,m=E[c].length;d<m;d++)v=E[c][d],R[d?"lineTo":"moveTo"](v.x,v.y);s&&R.closePath()}this._fillStroke(R,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var s=t._point,c=this._ctx,d=Math.max(Math.round(t._radius),1),m=(Math.max(Math.round(t._radiusY),1)||d)/d;m!==1&&(c.save(),c.scale(1,m)),c.beginPath(),c.arc(s.x,s.y/m,d,0,Math.PI*2,!1),m!==1&&c.restore(),this._fillStroke(c,t)}},_fillStroke:function(t,s){var c=s.options;c.fill&&(t.globalAlpha=c.fillOpacity,t.fillStyle=c.fillColor||c.color,t.fill(c.fillRule||"evenodd")),c.stroke&&c.weight!==0&&(t.setLineDash&&t.setLineDash(s.options&&s.options._dashArray||[]),t.globalAlpha=c.opacity,t.lineWidth=c.weight,t.strokeStyle=c.color,t.lineCap=c.lineCap,t.lineJoin=c.lineJoin,t.stroke())},_onClick:function(t){for(var s=this._map.mouseEventToLayerPoint(t),c,d,m=this._drawFirst;m;m=m.next)c=m.layer,c.options.interactive&&c._containsPoint(s)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(c))&&(d=c);this._fireEvent(d?[d]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var s=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,s)}},_handleMouseOut:function(t){var s=this._hoveredLayer;s&&(ye(this._container,"leaflet-interactive"),this._fireEvent([s],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,s){if(!this._mouseHoverThrottled){for(var c,d,m=this._drawFirst;m;m=m.next)c=m.layer,c.options.interactive&&c._containsPoint(s)&&(d=c);d!==this._hoveredLayer&&(this._handleMouseOut(t),d&&(Ht(this._container,"leaflet-interactive"),this._fireEvent([d],t,"mouseover"),this._hoveredLayer=d)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,s,c){this._map._fireDOMEvent(s,c||s.type,t)},_bringToFront:function(t){var s=t._order;if(s){var c=s.next,d=s.prev;if(c)c.prev=d;else return;d?d.next=c:c&&(this._drawFirst=c),s.prev=this._drawLast,this._drawLast.next=s,s.next=null,this._drawLast=s,this._requestRedraw(t)}},_bringToBack:function(t){var s=t._order;if(s){var c=s.next,d=s.prev;if(d)d.next=c;else return;c?c.prev=d:d&&(this._drawLast=d),s.prev=null,s.next=this._drawFirst,this._drawFirst.prev=s,this._drawFirst=s,this._requestRedraw(t)}}});function Os(t){return kt.canvas?new Is(t):null}var $n=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),sc={_initContainer:function(){this._container=Rt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(bn.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var s=t._container=$n("shape");Ht(s,"leaflet-vml-shape "+(this.options.className||"")),s.coordsize="1 1",t._path=$n("path"),s.appendChild(t._path),this._updateStyle(t),this._layers[u(t)]=t},_addPath:function(t){var s=t._container;this._container.appendChild(s),t.options.interactive&&t.addInteractiveTarget(s)},_removePath:function(t){var s=t._container;ne(s),t.removeInteractiveTarget(s),delete this._layers[u(t)]},_updateStyle:function(t){var s=t._stroke,c=t._fill,d=t.options,m=t._container;m.stroked=!!d.stroke,m.filled=!!d.fill,d.stroke?(s||(s=t._stroke=$n("stroke")),m.appendChild(s),s.weight=d.weight+"px",s.color=d.color,s.opacity=d.opacity,d.dashArray?s.dashStyle=O(d.dashArray)?d.dashArray.join(" "):d.dashArray.replace(/( *, *)/g," "):s.dashStyle="",s.endcap=d.lineCap.replace("butt","flat"),s.joinstyle=d.lineJoin):s&&(m.removeChild(s),t._stroke=null),d.fill?(c||(c=t._fill=$n("fill")),m.appendChild(c),c.color=d.fillColor||d.color,c.opacity=d.fillOpacity):c&&(m.removeChild(c),t._fill=null)},_updateCircle:function(t){var s=t._point.round(),c=Math.round(t._radius),d=Math.round(t._radiusY||c);this._setPath(t,t._empty()?"M0 0":"AL "+s.x+","+s.y+" "+c+","+d+" 0,"+65535*360)},_setPath:function(t,s){t._path.v=s},_bringToFront:function(t){zi(t._container)},_bringToBack:function(t){Fe(t._container)}},Lo=kt.vml?$n:oe,to=bn.extend({_initContainer:function(){this._container=Lo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Lo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ne(this._container),M(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){bn.prototype._update.call(this);var t=this._bounds,s=t.getSize(),c=this._container;(!this._svgSize||!this._svgSize.equals(s))&&(this._svgSize=s,c.setAttribute("width",s.x),c.setAttribute("height",s.y)),Ne(c,t.min),c.setAttribute("viewBox",[t.min.x,t.min.y,s.x,s.y].join(" ")),this.fire("update")}},_initPath:function(t){var s=t._path=Lo("path");t.options.className&&Ht(s,t.options.className),t.options.interactive&&Ht(s,"leaflet-interactive"),this._updateStyle(t),this._layers[u(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ne(t._path),t.removeInteractiveTarget(t._path),delete this._layers[u(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var s=t._path,c=t.options;s&&(c.stroke?(s.setAttribute("stroke",c.color),s.setAttribute("stroke-opacity",c.opacity),s.setAttribute("stroke-width",c.weight),s.setAttribute("stroke-linecap",c.lineCap),s.setAttribute("stroke-linejoin",c.lineJoin),c.dashArray?s.setAttribute("stroke-dasharray",c.dashArray):s.removeAttribute("stroke-dasharray"),c.dashOffset?s.setAttribute("stroke-dashoffset",c.dashOffset):s.removeAttribute("stroke-dashoffset")):s.setAttribute("stroke","none"),c.fill?(s.setAttribute("fill",c.fillColor||c.color),s.setAttribute("fill-opacity",c.fillOpacity),s.setAttribute("fill-rule",c.fillRule||"evenodd")):s.setAttribute("fill","none"))},_updatePoly:function(t,s){this._setPath(t,pe(t._parts,s))},_updateCircle:function(t){var s=t._point,c=Math.max(Math.round(t._radius),1),d=Math.max(Math.round(t._radiusY),1)||c,m="a"+c+","+d+" 0 1,0 ",v=t._empty()?"M0 0":"M"+(s.x-c)+","+s.y+m+c*2+",0 "+m+-c*2+",0 ";this._setPath(t,v)},_setPath:function(t,s){t._path.setAttribute("d",s)},_bringToFront:function(t){zi(t._path)},_bringToBack:function(t){Fe(t._path)}});kt.vml&&to.include(sc);function As(t){return kt.svg||kt.vml?new to(t):null}be.include({getRenderer:function(t){var s=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return s||(s=this._renderer=this._createRenderer()),this.hasLayer(s)||this.addLayer(s),s},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var s=this._paneRenderers[t];return s===void 0&&(s=this._createRenderer({pane:t}),this._paneRenderers[t]=s),s},_createRenderer:function(t){return this.options.preferCanvas&&Os(t)||As(t)}});var Ns=Zn.extend({initialize:function(t,s){Zn.prototype.initialize.call(this,this._boundsToLatLngs(t),s)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=Z(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function rc(t,s){return new Ns(t,s)}to.create=Lo,to.pointsToPath=pe,yn.geometryToLayer=mo,yn.coordsToLatLng=qo,yn.coordsToLatLngs=po,yn.latLngToCoords=Uo,yn.latLngsToCoords=go,yn.getFeature=Hn,yn.asFeature=vo,be.mergeOptions({boxZoom:!0});var Bs=fn.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Wt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){M(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ne(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Yi(),Ln(),this._startPoint=this._map.mouseEventToContainerPoint(t),Wt(document,{contextmenu:Be,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=Rt("div","leaflet-zoom-box",this._container),Ht(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var s=new wt(this._point,this._startPoint),c=s.getSize();Ne(this._box,s.min),this._box.style.width=c.x+"px",this._box.style.height=c.y+"px"},_finish:function(){this._moved&&(ne(this._box),ye(this._container,"leaflet-crosshair")),$i(),un(),M(document,{contextmenu:Be,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var s=new ht(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(s).fire("boxzoomend",{boxZoomBounds:s})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});be.addInitHook("addHandler","boxZoom",Bs),be.mergeOptions({doubleClickZoom:!0});var Rs=fn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var s=this._map,c=s.getZoom(),d=s.options.zoomDelta,m=t.originalEvent.shiftKey?c-d:c+d;s.options.doubleClickZoom==="center"?s.setZoom(m):s.setZoomAround(t.containerPoint,m)}});be.addInitHook("addHandler","doubleClickZoom",Rs),be.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Zs=fn.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new Mn(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}Ht(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ye(this._map._container,"leaflet-grab"),ye(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var s=Z(this._map.options.maxBounds);this._offsetLimit=It(this._map.latLngToContainerPoint(s.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(s.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var s=this._lastTime=+new Date,c=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(c),this._times.push(s),this._prunePositions(s)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),s=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=s.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,s){return t-(t-s)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),s=this._offsetLimit;t.x<s.min.x&&(t.x=this._viscousLimit(t.x,s.min.x)),t.y<s.min.y&&(t.y=this._viscousLimit(t.y,s.min.y)),t.x>s.max.x&&(t.x=this._viscousLimit(t.x,s.max.x)),t.y>s.max.y&&(t.y=this._viscousLimit(t.y,s.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,s=Math.round(t/2),c=this._initialWorldOffset,d=this._draggable._newPos.x,m=(d-s+c)%t+s-c,v=(d+s+c)%t-s-c,E=Math.abs(m+c)<Math.abs(v+c)?m:v;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=E},_onDragEnd:function(t){var s=this._map,c=s.options,d=!c.inertia||t.noInertia||this._times.length<2;if(s.fire("dragend",t),d)s.fire("moveend");else{this._prunePositions(+new Date);var m=this._lastPos.subtract(this._positions[0]),v=(this._lastTime-this._times[0])/1e3,E=c.easeLinearity,I=m.multiplyBy(E/v),R=I.distanceTo([0,0]),ct=Math.min(c.inertiaMaxSpeed,R),Tt=I.multiplyBy(ct/R),Ut=ct/(c.inertiaDeceleration*E),le=Tt.multiplyBy(-Ut/2).round();!le.x&&!le.y?s.fire("moveend"):(le=s._limitOffset(le,s.options.maxBounds),K(function(){s.panBy(le,{duration:Ut,easeLinearity:E,noMoveStart:!0,animate:!0})}))}}});be.addInitHook("addHandler","dragging",Zs),be.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Hs=fn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Wt(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),M(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,s=document.documentElement,c=t.scrollTop||s.scrollTop,d=t.scrollLeft||s.scrollLeft;this._map._container.focus(),window.scrollTo(d,c)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var s=this._panKeys={},c=this.keyCodes,d,m;for(d=0,m=c.left.length;d<m;d++)s[c.left[d]]=[-1*t,0];for(d=0,m=c.right.length;d<m;d++)s[c.right[d]]=[t,0];for(d=0,m=c.down.length;d<m;d++)s[c.down[d]]=[0,t];for(d=0,m=c.up.length;d<m;d++)s[c.up[d]]=[0,-1*t]},_setZoomDelta:function(t){var s=this._zoomKeys={},c=this.keyCodes,d,m;for(d=0,m=c.zoomIn.length;d<m;d++)s[c.zoomIn[d]]=t;for(d=0,m=c.zoomOut.length;d<m;d++)s[c.zoomOut[d]]=-t},_addHooks:function(){Wt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){M(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var s=t.keyCode,c=this._map,d;if(s in this._panKeys){if(!c._panAnim||!c._panAnim._inProgress)if(d=this._panKeys[s],t.shiftKey&&(d=ut(d).multiplyBy(3)),c.options.maxBounds&&(d=c._limitOffset(ut(d),c.options.maxBounds)),c.options.worldCopyJump){var m=c.wrapLatLng(c.unproject(c.project(c.getCenter()).add(d)));c.panTo(m)}else c.panBy(d)}else if(s in this._zoomKeys)c.setZoom(c.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[s]);else if(s===27&&c._popup&&c._popup.options.closeOnEscapeKey)c.closePopup();else return;Be(t)}}});be.addInitHook("addHandler","keyboard",Hs),be.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Fs=fn.extend({addHooks:function(){Wt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){M(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var s=Dn(t),c=this._map.options.wheelDebounceTime;this._delta+=s,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var d=Math.max(c-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),d),Be(t)},_performZoom:function(){var t=this._map,s=t.getZoom(),c=this._map.options.zoomSnap||0;t._stop();var d=this._delta/(this._map.options.wheelPxPerZoomLevel*4),m=4*Math.log(2/(1+Math.exp(-Math.abs(d))))/Math.LN2,v=c?Math.ceil(m/c)*c:m,E=t._limitZoom(s+(this._delta>0?v:-v))-s;this._delta=0,this._startTime=null,E&&(t.options.scrollWheelZoom==="center"?t.setZoom(s+E):t.setZoomAround(this._lastMousePos,s+E))}});be.addInitHook("addHandler","scrollWheelZoom",Fs);var ac=600;be.mergeOptions({tapHold:kt.touchNative&&kt.safari&&kt.mobile,tapTolerance:15});var Gs=fn.extend({addHooks:function(){Wt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){M(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var s=t.touches[0];this._startPos=this._newPos=new q(s.clientX,s.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(Wt(document,"touchend",Ct),Wt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",s))},this),ac),Wt(document,"touchend touchcancel contextmenu",this._cancel,this),Wt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){M(document,"touchend",Ct),M(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),M(document,"touchend touchcancel contextmenu",this._cancel,this),M(document,"touchmove",this._onMove,this)},_onMove:function(t){var s=t.touches[0];this._newPos=new q(s.clientX,s.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,s){var c=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:s.screenX,screenY:s.screenY,clientX:s.clientX,clientY:s.clientY});c._simulated=!0,s.target.dispatchEvent(c)}});be.addInitHook("addHandler","tapHold",Gs),be.mergeOptions({touchZoom:kt.touch,bounceAtZoomLimits:!0});var qs=fn.extend({addHooks:function(){Ht(this._map._container,"leaflet-touch-zoom"),Wt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ye(this._map._container,"leaflet-touch-zoom"),M(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var s=this._map;if(!(!t.touches||t.touches.length!==2||s._animatingZoom||this._zooming)){var c=s.mouseEventToContainerPoint(t.touches[0]),d=s.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=s.getSize()._divideBy(2),this._startLatLng=s.containerPointToLatLng(this._centerPoint),s.options.touchZoom!=="center"&&(this._pinchStartLatLng=s.containerPointToLatLng(c.add(d)._divideBy(2))),this._startDist=c.distanceTo(d),this._startZoom=s.getZoom(),this._moved=!1,this._zooming=!0,s._stop(),Wt(document,"touchmove",this._onTouchMove,this),Wt(document,"touchend touchcancel",this._onTouchEnd,this),Ct(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var s=this._map,c=s.mouseEventToContainerPoint(t.touches[0]),d=s.mouseEventToContainerPoint(t.touches[1]),m=c.distanceTo(d)/this._startDist;if(this._zoom=s.getScaleZoom(m,this._startZoom),!s.options.bounceAtZoomLimits&&(this._zoom<s.getMinZoom()&&m<1||this._zoom>s.getMaxZoom()&&m>1)&&(this._zoom=s._limitZoom(this._zoom)),s.options.touchZoom==="center"){if(this._center=this._startLatLng,m===1)return}else{var v=c._add(d)._divideBy(2)._subtract(this._centerPoint);if(m===1&&v.x===0&&v.y===0)return;this._center=s.unproject(s.project(this._pinchStartLatLng,this._zoom).subtract(v),this._zoom)}this._moved||(s._moveStart(!0,!1),this._moved=!0),N(this._animRequest);var E=l(s._move,s,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=K(E,this,!0),Ct(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,N(this._animRequest),M(document,"touchmove",this._onTouchMove,this),M(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});be.addInitHook("addHandler","touchZoom",qs),be.BoxZoom=Bs,be.DoubleClickZoom=Rs,be.Drag=Zs,be.Keyboard=Hs,be.ScrollWheelZoom=Fs,be.TapHold=Gs,be.TouchZoom=qs,o.Bounds=wt,o.Browser=kt,o.CRS=it,o.Canvas=Is,o.Circle=Go,o.CircleMarker=_o,o.Class=j,o.Control=ln,o.DivIcon=Ds,o.DivOverlay=_n,o.DomEvent=Pl,o.DomUtil=Si,o.Draggable=Mn,o.Evented=X,o.FeatureGroup=gn,o.GeoJSON=yn,o.GridLayer=Qn,o.Handler=fn,o.Icon=Rn,o.ImageOverlay=yo,o.LatLng=et,o.LatLngBounds=ht,o.Layer=cn,o.LayerGroup=Bn,o.LineUtil=Rl,o.Map=be,o.Marker=fo,o.Mixin=zl,o.Path=Pn,o.Point=q,o.PolyUtil=Il,o.Polygon=Zn,o.Polyline=vn,o.Popup=bo,o.PosAnimation=ds,o.Projection=Zl,o.Rectangle=Ns,o.Renderer=bn,o.SVG=to,o.SVGOverlay=Ss,o.TileLayer=Fn,o.Tooltip=wo,o.Transformation=zt,o.Util=F,o.VideoOverlay=Ts,o.bind=l,o.bounds=It,o.canvas=Os,o.circle=Vl,o.circleMarker=jl,o.control=Xn,o.divIcon=ic,o.extend=n,o.featureGroup=ql,o.geoJSON=Cs,o.geoJson=Kl,o.gridLayer=nc,o.icon=Ul,o.imageOverlay=Jl,o.latLng=G,o.latLngBounds=Z,o.layerGroup=Gl,o.map=El,o.marker=Wl,o.point=ut,o.polygon=Xl,o.polyline=Yl,o.popup=tc,o.rectangle=rc,o.setOptions=C,o.stamp=u,o.svg=As,o.svgOverlay=$l,o.tileLayer=xs,o.tooltip=ec,o.transformation=Nt,o.version=r,o.videoOverlay=Ql;var lc=window.L;o.noConflict=function(){return window.L=lc,this},window.L=o})})(ls,ls.exports);var Fi=ls.exports;(function(i,e,o){function r(n,a){for(;(n=n.parentElement)&&!n.classList.contains(a););return n}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(n,a){this._map=n,this._container=n._container,this._overlayPane=n._panes.overlayPane,this._popupPane=n._panes.popupPane,a&&a.shapeOptions&&(a.shapeOptions=L.Util.extend({},this.options.shapeOptions,a.shapeOptions)),L.setOptions(this,a);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var n=this._map;n&&(L.DomUtil.disableTextSelection(),n.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(n){L.setOptions(this,n)},_fireCreatedEvent:function(n){this._map.fire(L.Draw.Event.CREATED,{layer:n,layerType:this.type})},_cancelDrawing:function(n){n.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(n,a){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,a&&a.drawError&&(a.drawError=L.Util.extend({},this.options.drawError,a.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,n,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var n=this._markers.pop(),a=this._poly,l=a.getLatLngs(),h=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(n),a.getLatLngs().length<2&&this._map.removeLayer(a),this._vertexChanged(h,!1)}},addVertex:function(n){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(n))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(n)),this._poly.addLatLng(n),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(n,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var n=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),a=this._poly.newLatLngIntersects(n[n.length-1]);if(!this.options.allowIntersection&&a||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(n){var a=this._map.mouseEventToLayerPoint(n.originalEvent),l=this._map.layerPointToLatLng(a);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(a),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(n.originalEvent)},_vertexChanged:function(n,a){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(n,a),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(n){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(n),this._clickHandled=!0,this._disableNewMarkers();var a=n.originalEvent,l=a.clientX,h=a.clientY;this._startPoint.call(this,l,h)}},_startPoint:function(n,a){this._mouseDownOrigin=L.point(n,a)},_onMouseUp:function(n){var a=n.originalEvent,l=a.clientX,h=a.clientY;this._endPoint.call(this,l,h,n),this._clickHandled=null},_endPoint:function(n,a,l){if(this._mouseDownOrigin){var h=L.point(n,a).distanceTo(this._mouseDownOrigin),u=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):u<10&&L.Browser.touch?this._finishShape():Math.abs(h)<9*(i.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(n){var a,l,h=n.originalEvent;!h.touches||!h.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(a=h.touches[0].clientX,l=h.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,a,l),this._endPoint.call(this,a,l,n),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(n){var a;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var h=this._map.latLngToContainerPoint(l.getLatLng()),u=new L.Marker(n,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),f=this._map.latLngToContainerPoint(u.getLatLng());a=h.distanceTo(f)}else a=1/0;return a},_updateFinishHandler:function(){var n=this._markers.length;n>1&&this._markers[n-1].on("click",this._finishShape,this),n>2&&this._markers[n-2].off("click",this._finishShape,this)},_createMarker:function(n){var a=new L.Marker(n,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(a),a},_updateGuide:function(n){var a=this._markers?this._markers.length:0;a>0&&(n=n||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[a-1].getLatLng()),n))},_updateTooltip:function(n){var a=this._getTooltipText();n&&this._tooltip.updatePosition(n),this._errorShown||this._tooltip.updateContent(a)},_drawGuide:function(n,a){var l,h,u,f=Math.floor(Math.sqrt(Math.pow(a.x-n.x,2)+Math.pow(a.y-n.y,2))),_=this.options.guidelineDistance,g=this.options.maxGuideLineLength,y=f>g?f-g:_;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));y<f;y+=this.options.guidelineDistance)l=y/f,h={x:Math.floor(n.x*(1-l)+l*a.x),y:Math.floor(n.y*(1-l)+l*a.y)},u=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),u.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(u,h)},_updateGuideColor:function(n){if(this._guidesContainer)for(var a=0,l=this._guidesContainer.childNodes.length;a<l;a++)this._guidesContainer.childNodes[a].style.backgroundColor=n},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var n,a,l=this.options.showLength;return this._markers.length===0?n={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(a=l?this._getMeasurementString():"",n=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:a}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:a}),n},_updateRunningMeasure:function(n,a){var l,h,u=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=u-(a?2:1),h=L.GeometryUtil.isVersion07x()?n.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(n,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=h*(a?1:-1))},_getMeasurementString:function(){var n,a=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return n=L.GeometryUtil.isVersion07x()?l&&a&&a.distanceTo?this._measurementRunningTotal+a.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&a?this._measurementRunningTotal+this._map.distance(a,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(n,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var n=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,n)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(n,a){L.Draw.Polyline.prototype.initialize.call(this,n,a),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var n=this._markers.length;n===1&&this._markers[0].on("click",this._finishShape,this),n>2&&(this._markers[n-1].on("dblclick",this._finishShape,this),n>3&&this._markers[n-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var n,a;return this._markers.length===0?n=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(n=L.drawLocal.draw.handlers.polygon.tooltip.cont,a=this._getMeasurementString()):(n=L.drawLocal.draw.handlers.polygon.tooltip.end,a=this._getMeasurementString()),{text:n,subtext:a}},_getMeasurementString:function(){var n=this._area,a="";return n||this.options.showLength?(this.options.showLength&&(a=L.Draw.Polyline.prototype._getMeasurementString.call(this)),n&&(a+="<br>"+L.GeometryUtil.readableArea(n,this.options.metric,this.options.precision)),a):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(n,a){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,n,a)},_cleanUpShape:function(){var n=this._markers.length;n>0&&(this._markers[0].off("click",this._finishShape,this),n>2&&this._markers[n-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(n,a){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,n,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),e.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),L.DomEvent.off(e,"touchend",this._onMouseUp,this),e.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(n){this._isDrawing=!0,this._startLatLng=n.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).on(e,"touchend",this._onMouseUp,this).preventDefault(n.originalEvent)},_onMouseMove:function(n){var a=n.latlng;this._tooltip.updatePosition(a),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(a))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(n,a){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,n,a)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(n){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!r(n.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(n){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,n)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,n),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var n=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,n)},_getTooltipText:function(){var n,a,l,h=L.Draw.SimpleShape.prototype._getTooltipText.call(this),u=this._shape,f=this.options.showArea;return u&&(n=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),a=L.GeometryUtil.geodesicArea(n),l=f?L.GeometryUtil.readableArea(a,this.options.metric):""),{text:h.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(n,a){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,n,a)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(n){var a=n.latlng;this._tooltip.updatePosition(a),this._mouseMarker.setLatLng(a),this._marker?(a=this._mouseMarker.getLatLng(),this._marker.setLatLng(a)):(this._marker=this._createMarker(a),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(n){return new L.Marker(n,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(n){this._onMouseMove(n),this._onClick()},_fireCreatedEvent:function(){var n=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,n)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(n,a){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,n,a)},_fireCreatedEvent:function(){var n=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,n)},_createMarker:function(n){return new L.CircleMarker(n,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(n,a){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,n,a)},_drawShape:function(n){if(L.GeometryUtil.isVersion07x())var a=this._startLatLng.distanceTo(n);else var a=this._map.distance(this._startLatLng,n);this._shape?this._shape.setRadius(a):(this._shape=new L.Circle(this._startLatLng,a,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var n=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,n)},_onMouseMove:function(n){var a,l=n.latlng,h=this.options.showRadius,u=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),a=this._shape.getRadius().toFixed(1);var f="";h&&(f=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(a,u,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:f})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(n,a){this._marker=n,L.setOptions(this,a)},addHooks:function(){var n=this._marker;n.dragging.enable(),n.on("dragend",this._onDragEnd,n),this._toggleMarkerHighlight()},removeHooks:function(){var n=this._marker;n.dragging.disable(),n.off("dragend",this._onDragEnd,n),this._toggleMarkerHighlight()},_onDragEnd:function(n){var a=n.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_toggleMarkerHighlight:function(){var n=this._marker._icon;n&&(n.style.display="none",L.DomUtil.hasClass(n,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(n,"leaflet-edit-marker-selected"),this._offsetMarker(n,-4)):(L.DomUtil.addClass(n,"leaflet-edit-marker-selected"),this._offsetMarker(n,4)),n.style.display="")},_offsetMarker:function(n,a){var l=parseInt(n.style.marginTop,10)-a,h=parseInt(n.style.marginLeft,10)-a;n.style.marginTop=l+"px",n.style.marginLeft=h+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(n){this.latlngs=[n._latlngs],n._holes&&(this.latlngs=this.latlngs.concat(n._holes)),this._poly=n,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(n){for(var a=0;a<this._verticesHandlers.length;a++)n(this._verticesHandlers[a])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(n){n.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(n){n.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(n){n.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var n=0;n<this.latlngs.length;n++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[n],this._poly.options.poly))},_updateLatLngs:function(n){this.latlngs=[n.layer._latlngs],n.layer._holes&&(this.latlngs=this.latlngs.concat(n.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(n,a,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=n,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=a,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var n=this._poly,a=n._path;n instanceof L.Polygon||(n.options.fill=!1,n.options.editing&&(n.options.editing.fill=!1)),a&&n.options.editing&&n.options.editing.className&&(n.options.original.className&&n.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(a,l)}),n.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(a,l)})),n.setStyle(n.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var n=this._poly,a=n._path;a&&n.options.editing&&n.options.editing.className&&(n.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(a,l)}),n.options.original.className&&n.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(a,l)})),n.setStyle(n.options.original),n._map&&(n._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var n,a,l,h,u=this._defaultShape();for(n=0,l=u.length;n<l;n++)h=this._createMarker(u[n],n),h.on("click",this._onMarkerClick,this),h.on("contextmenu",this._onContextMenu,this),this._markers.push(h);var f,_;for(n=0,a=l-1;n<l;a=n++)(n!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(f=this._markers[a],_=this._markers[n],this._createMiddleMarker(f,_),this._updatePrevNext(f,_))},_createMarker:function(n,a){var l=new L.Marker.Touch(n,{draggable:!0,icon:this.options.icon});return l._origLatLng=n,l._index=a,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var n=this._defaultShape(),a=[].splice.apply(n,arguments);return this._poly._convertLatLngs(n,!0),this._poly.redraw(),a},_removeMarker:function(n){var a=n._index;this._markerGroup.removeLayer(n),this._markers.splice(a,1),this._spliceLatLngs(a,1),this._updateIndexes(a,-1),n.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(n){var a=n.target,l=this._poly,h=L.LatLngUtil.cloneLatLng(a._origLatLng);if(L.extend(a._origLatLng,a._latlng),l.options.poly){var u=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(a._origLatLng,h),a.setLatLng(h);var f=l.options.color;l.setStyle({color:this.options.drawError.color}),u&&u.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:f}),u&&u.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}a._middleLeft&&a._middleLeft.setLatLng(this._getMiddleLatLng(a._prev,a)),a._middleRight&&a._middleRight.setLatLng(this._getMiddleLatLng(a,a._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var _=this._poly.getLatLngs();this._poly._convertLatLngs(_,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(n){var a=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=n.target;this._defaultShape().length<a||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(n){var a=n.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:a,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(n){var a=this._map.mouseEventToLayerPoint(n.originalEvent.touches[0]),l=this._map.layerPointToLatLng(a),h=n.target;L.extend(h._origLatLng,l),h._middleLeft&&h._middleLeft.setLatLng(this._getMiddleLatLng(h._prev,h)),h._middleRight&&h._middleRight.setLatLng(this._getMiddleLatLng(h,h._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(n,a){this._markerGroup.eachLayer(function(l){l._index>n&&(l._index+=a)})},_createMiddleMarker:function(n,a){var l,h,u,f=this._getMiddleLatLng(n,a),_=this._createMarker(f);_.setOpacity(.6),n._middleRight=a._middleLeft=_,h=function(){_.off("touchmove",h,this);var g=a._index;_._index=g,_.off("click",l,this).on("click",this._onMarkerClick,this),f.lat=_.getLatLng().lat,f.lng=_.getLatLng().lng,this._spliceLatLngs(g,0,f),this._markers.splice(g,0,_),_.setOpacity(1),this._updateIndexes(g,1),a._index++,this._updatePrevNext(n,_),this._updatePrevNext(_,a),this._poly.fire("editstart")},u=function(){_.off("dragstart",h,this),_.off("dragend",u,this),_.off("touchmove",h,this),this._createMiddleMarker(n,_),this._createMiddleMarker(_,a)},l=function(){h.call(this),u.call(this),this._fireEdit()},_.on("click",l,this).on("dragstart",h,this).on("dragend",u,this).on("touchmove",h,this),this._markerGroup.addLayer(_)},_updatePrevNext:function(n,a){n&&(n._next=a),a&&(a._prev=n)},_getMiddleLatLng:function(n,a){var l=this._poly._map,h=l.project(n.getLatLng()),u=l.project(a.getLatLng());return l.unproject(h._add(u)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(n,a){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=n,L.Util.setOptions(this,a)},addHooks:function(){var n=this._shape;this._shape._map&&(this._map=this._shape._map,n.setStyle(n.options.editing),n._map&&(this._map=n._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var n=this._shape;if(n.setStyle(n.options.original),n._map){this._unbindMarker(this._moveMarker);for(var a=0,l=this._resizeMarkers.length;a<l;a++)this._unbindMarker(this._resizeMarkers[a]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(n,a){var l=new L.Marker.Touch(n,{draggable:!0,icon:a,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(n){n.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(n){n.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(n){n.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(n){var a=n.target,l=a.getLatLng();a===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(n){n.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(n){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,n),typeof this._getCorners=="function"){var a=this._getCorners(),l=n.target,h=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=a[(h+2)%4],this._toggleCornerMarkers(0,h)}this._shape.fire("editstart")},_onTouchMove:function(n){var a=this._map.mouseEventToLayerPoint(n.originalEvent.touches[0]),l=this._map.layerPointToLatLng(a);return n.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(n){n.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var n=this._shape.getBounds(),a=n.getCenter();this._moveMarker=this._createMarker(a,this.options.moveIcon)},_createResizeMarker:function(){var n=this._getCorners();this._resizeMarkers=[];for(var a=0,l=n.length;a<l;a++)this._resizeMarkers.push(this._createMarker(n[a],this.options.resizeIcon)),this._resizeMarkers[a]._cornerIndex=a},_onMarkerDragStart:function(n){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,n);var a=this._getCorners(),l=n.target,h=l._cornerIndex;this._oppositeCorner=a[(h+2)%4],this._toggleCornerMarkers(0,h)},_onMarkerDragEnd:function(n){var a,l,h=n.target;h===this._moveMarker&&(a=this._shape.getBounds(),l=a.getCenter(),h.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,n)},_move:function(n){for(var a,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),h=this._shape.getBounds(),u=h.getCenter(),f=[],_=0,g=l.length;_<g;_++)a=[l[_].lat-u.lat,l[_].lng-u.lng],f.push([n.lat+a[0],n.lng+a[1]]);this._shape.setLatLngs(f),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(n){var a;this._shape.setBounds(L.latLngBounds(n,this._oppositeCorner)),a=this._shape.getBounds(),this._moveMarker.setLatLng(a.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var n=this._shape.getBounds();return[n.getNorthWest(),n.getNorthEast(),n.getSouthEast(),n.getSouthWest()]},_toggleCornerMarkers:function(n){for(var a=0,l=this._resizeMarkers.length;a<l;a++)this._resizeMarkers[a].setOpacity(n)},_repositionCornerMarkers:function(){for(var n=this._getCorners(),a=0,l=this._resizeMarkers.length;a<l;a++)this._resizeMarkers[a].setLatLng(n[a])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var n=this._shape.getLatLng();this._moveMarker=this._createMarker(n,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(n){if(this._resizeMarkers.length){var a=this._getResizeMarkerPoint(n);this._resizeMarkers[0].setLatLng(a)}this._shape.setLatLng(n),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var n=this._shape.getLatLng(),a=this._getResizeMarkerPoint(n);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(a,this.options.resizeIcon))},_getResizeMarkerPoint:function(n){var a=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(n);return this._map.unproject([l.x+a,l.y-a])},_resize:function(n){var a=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=a.distanceTo(n):radius=this._map.distance(a,n),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(n){this._map=n,this._container=n._container,this._pane=n._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(n,a){var l={};if(n.touches!==void 0){if(!n.touches.length)return;l=n.touches[0]}else if(n.pointerType!=="touch"||(l=n,!this._filterClick(n)))return;var h=this._map.mouseEventToContainerPoint(l),u=this._map.mouseEventToLayerPoint(l),f=this._map.layerPointToLatLng(u);this._map.fire(a,{latlng:f,layerPoint:u,containerPoint:h,pageX:l.pageX,pageY:l.pageY,originalEvent:n})},_filterClick:function(n){var a=n.timeStamp||n.originalEvent.timeStamp,l=L.DomEvent._lastClick&&a-L.DomEvent._lastClick;return l&&l>100&&l<500||n.target._simulatedClick&&!n._simulated?(L.DomEvent.stop(n),!1):(L.DomEvent._lastClick=a,!0)},_onTouchStart:function(n){this._map._loaded&&this._touchEvent(n,"touchstart")},_onTouchEnd:function(n){this._map._loaded&&this._touchEvent(n,"touchend")},_onTouchCancel:function(n){if(this._map._loaded){var a="touchcancel";this._detectIE()&&(a="pointercancel"),this._touchEvent(n,a)}},_onTouchLeave:function(n){this._map._loaded&&this._touchEvent(n,"touchleave")},_onTouchMove:function(n){this._map._loaded&&this._touchEvent(n,"touchmove")},_detectIE:function(){var n=i.navigator.userAgent,a=n.indexOf("MSIE ");if(a>0)return parseInt(n.substring(a+5,n.indexOf(".",a)),10);if(n.indexOf("Trident/")>0){var l=n.indexOf("rv:");return parseInt(n.substring(l+3,n.indexOf(".",l)),10)}var h=n.indexOf("Edge/");return h>0&&parseInt(n.substring(h+5,n.indexOf(".",h)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var n=this._icon,a=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?a.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):a.concat(["touchcancel"]),L.DomUtil.addClass(n,"leaflet-clickable"),L.DomEvent.on(n,"click",this._onMouseClick,this),L.DomEvent.on(n,"keypress",this._onKeyPress,this);for(var l=0;l<a.length;l++)L.DomEvent.on(n,a[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var n=i.navigator.userAgent,a=n.indexOf("MSIE ");if(a>0)return parseInt(n.substring(a+5,n.indexOf(".",a)),10);if(n.indexOf("Trident/")>0){var l=n.indexOf("rv:");return parseInt(n.substring(l+3,n.indexOf(".",l)),10)}var h=n.indexOf("Edge/");return h>0&&parseInt(n.substring(h+5,n.indexOf(".",h)),10)}}),L.LatLngUtil={cloneLatLngs:function(n){for(var a=[],l=0,h=n.length;l<h;l++)Array.isArray(n[l])?a.push(L.LatLngUtil.cloneLatLngs(n[l])):a.push(this.cloneLatLng(n[l]));return a},cloneLatLng:function(n){return L.latLng(n.lat,n.lng)}},function(){var n={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(a){var l,h,u=a.length,f=0,_=Math.PI/180;if(u>2){for(var g=0;g<u;g++)l=a[g],h=a[(g+1)%u],f+=(h.lng-l.lng)*_*(2+Math.sin(l.lat*_)+Math.sin(h.lat*_));f=6378137*f*6378137/2}return Math.abs(f)},formattedNumber:function(a,l){var h=parseFloat(a).toFixed(l),u=L.drawLocal.format&&L.drawLocal.format.numeric,f=u&&u.delimiters,_=f&&f.thousands,g=f&&f.decimal;if(_||g){var y=h.split(".");h=_?y[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+_):y[0],g=g||".",y.length>1&&(h=h+g+y[1])}return h},readableArea:function(a,l,_){var u,f,_=L.Util.extend({},n,_);return l?(f=["ha","m"],type=typeof l,type==="string"?f=[l]:type!=="boolean"&&(f=l),u=a>=1e6&&f.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*a,_.km)+" kmÂ²":a>=1e4&&f.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*a,_.ha)+" ha":L.GeometryUtil.formattedNumber(a,_.m)+" mÂ²"):(a/=.836127,u=a>=3097600?L.GeometryUtil.formattedNumber(a/3097600,_.mi)+" miÂ²":a>=4840?L.GeometryUtil.formattedNumber(a/4840,_.ac)+" acres":L.GeometryUtil.formattedNumber(a,_.yd)+" ydÂ²"),u},readableDistance:function(a,l,h,u,g){var _,g=L.Util.extend({},n,g);switch(l?typeof l=="string"?l:"metric":h?"feet":u?"nauticalMile":"yards"){case"metric":_=a>1e3?L.GeometryUtil.formattedNumber(a/1e3,g.km)+" km":L.GeometryUtil.formattedNumber(a,g.m)+" m";break;case"feet":a*=3.28083,_=L.GeometryUtil.formattedNumber(a,g.ft)+" ft";break;case"nauticalMile":a*=.53996,_=L.GeometryUtil.formattedNumber(a/1e3,g.nm)+" nm";break;case"yards":default:a*=1.09361,_=a>1760?L.GeometryUtil.formattedNumber(a/1760,g.mi)+" miles":L.GeometryUtil.formattedNumber(a,g.yd)+" yd"}return _},isVersion07x:function(){var a=L.version.split(".");return parseInt(a[0],10)===0&&parseInt(a[1],10)===7}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(n,a,l,h){return this._checkCounterclockwise(n,l,h)!==this._checkCounterclockwise(a,l,h)&&this._checkCounterclockwise(n,a,l)!==this._checkCounterclockwise(n,a,h)},_checkCounterclockwise:function(n,a,l){return(l.y-n.y)*(a.x-n.x)>(a.y-n.y)*(l.x-n.x)}}),L.Polyline.include({intersects:function(){var n,a,l,h=this._getProjectedPoints(),u=h?h.length:0;if(this._tooFewPointsForIntersection())return!1;for(n=u-1;n>=3;n--)if(a=h[n-1],l=h[n],this._lineSegmentsIntersectsRange(a,l,n-2))return!0;return!1},newLatLngIntersects:function(n,a){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(n),a)},newPointIntersects:function(n,a){var l=this._getProjectedPoints(),h=l?l.length:0,u=l?l[h-1]:null,f=h-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(u,n,f,a?1:0)},_tooFewPointsForIntersection:function(n){var a=this._getProjectedPoints(),l=a?a.length:0;return l+=n||0,!a||l<=3},_lineSegmentsIntersectsRange:function(n,a,l,h){var u,f,_=this._getProjectedPoints();h=h||0;for(var g=l;g>h;g--)if(u=_[g-1],f=_[g],L.LineUtil.segmentsIntersect(n,a,u,f))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var n=[],a=this._defaultShape(),l=0;l<a.length;l++)n.push(this._map.latLngToLayerPoint(a[l]));return n}}),L.Polygon.include({intersects:function(){var n,a,l,h,u=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(n=u.length,a=u[0],l=u[n-1],h=n-2,this._lineSegmentsIntersectsRange(l,a,h,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(n){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,n);var a;this._toolbars={},L.DrawToolbar&&this.options.draw&&(a=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=a,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(a=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=a,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(n){var a,l=L.DomUtil.create("div","leaflet-draw"),h=!1;for(var u in this._toolbars)this._toolbars.hasOwnProperty(u)&&(a=this._toolbars[u].addToolbar(n))&&(h||(L.DomUtil.hasClass(a,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(a.childNodes[0],"leaflet-draw-toolbar-top"),h=!0),l.appendChild(a));return l},onRemove:function(){for(var n in this._toolbars)this._toolbars.hasOwnProperty(n)&&this._toolbars[n].removeToolbar()},setDrawingOptions:function(n){for(var a in this._toolbars)this._toolbars[a]instanceof L.DrawToolbar&&this._toolbars[a].setOptions(n)},_toolbarEnabled:function(n){var a=n.target;for(var l in this._toolbars)this._toolbars[l]!==a&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(n){L.setOptions(this,n),this._modes={},this._actionButtons=[],this._activeMode=null;var a=L.version.split(".");parseInt(a[0],10)===1&&parseInt(a[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(n){var a,l=L.DomUtil.create("div","leaflet-draw-section"),h=0,u=this._toolbarClass||"",f=this.getModeHandlers(n);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=n,a=0;a<f.length;a++)f[a].enabled&&this._initModeHandler(f[a].handler,this._toolbarContainer,h++,u,f[a].title);if(h)return this._lastButtonIndex=--h,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var n in this._modes)this._modes.hasOwnProperty(n)&&(this._disposeButton(this._modes[n].button,this._modes[n].handler.enable,this._modes[n].handler),this._modes[n].handler.disable(),this._modes[n].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var a=0,l=this._actionButtons.length;a<l;a++)this._disposeButton(this._actionButtons[a].button,this._actionButtons[a].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(n,a,l,h,u){var f=n.type;this._modes[f]={},this._modes[f].handler=n,this._modes[f].button=this._createButton({type:f,title:u,className:h+"-"+f,container:a,callback:this._modes[f].handler.enable,context:this._modes[f].handler}),this._modes[f].buttonIndex=l,this._modes[f].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!i.MSStream},_createButton:function(n){var a=L.DomUtil.create("a",n.className||"",n.container),l=L.DomUtil.create("span","sr-only",n.container);a.href="#",a.appendChild(l),n.title&&(a.title=n.title,l.innerHTML=n.title),n.text&&(a.innerHTML=n.text,l.innerHTML=n.text);var h=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(a,"click",L.DomEvent.stopPropagation).on(a,"mousedown",L.DomEvent.stopPropagation).on(a,"dblclick",L.DomEvent.stopPropagation).on(a,"touchstart",L.DomEvent.stopPropagation).on(a,"click",L.DomEvent.preventDefault).on(a,h,n.callback,n.context),a},_disposeButton:function(n,a){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(n,"click",L.DomEvent.stopPropagation).off(n,"mousedown",L.DomEvent.stopPropagation).off(n,"dblclick",L.DomEvent.stopPropagation).off(n,"touchstart",L.DomEvent.stopPropagation).off(n,"click",L.DomEvent.preventDefault).off(n,l,a)},_handlerActivated:function(n){this.disable(),this._activeMode=this._modes[n.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(n){var a,l,h,u,f=this._actionsContainer,_=this.getActions(n),g=_.length;for(l=0,h=this._actionButtons.length;l<h;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];f.firstChild;)f.removeChild(f.firstChild);for(var y=0;y<g;y++)"enabled"in _[y]&&!_[y].enabled||(a=L.DomUtil.create("li","",f),u=this._createButton({title:_[y].title,text:_[y].text,container:a,callback:_[y].callback,context:_[y].context}),this._actionButtons.push({button:u,callback:_[y].callback}))},_showActionsToolbar:function(){var n=this._activeMode.buttonIndex,a=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",n===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),n===a&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(n){this._map=n,this._popupPane=n._panes.popupPane,this._visible=!1,this._container=n.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(n){return this._container?(n.subtext=n.subtext||"",n.subtext.length!==0||this._singleLineLabel?n.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(n.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+n.subtext+"</span><br />":"")+"<span>"+n.text+"</span>",n.text||n.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(n){var a=this._map.latLngToLayerPoint(n),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,a)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(n){for(var a in this.options)this.options.hasOwnProperty(a)&&n[a]&&(n[a]=L.extend({},this.options[a],n[a]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,n)},getModeHandlers:function(n){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(n,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(n,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(n,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(n,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(n,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(n,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(n){return[{enabled:n.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:n.completeShape,context:n},{enabled:n.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:n.deleteLastVertex,context:n},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(n){L.setOptions(this,n);for(var a in this._modes)this._modes.hasOwnProperty(a)&&n.hasOwnProperty(a)&&this._modes[a].handler.setOptions(n[a])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(n){n.edit&&(n.edit.selectedPathOptions===void 0&&(n.edit.selectedPathOptions=this.options.edit.selectedPathOptions),n.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,n.edit.selectedPathOptions)),n.remove&&(n.remove=L.extend({},this.options.remove,n.remove)),n.poly&&(n.poly=L.extend({},this.options.poly,n.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,n),this._selectedFeatureCount=0},getModeHandlers:function(n){var a=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(n,{featureGroup:a,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(n,{featureGroup:a}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(n){var a=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return n.removeAllLayers&&a.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),a},addToolbar:function(n){var a=L.Toolbar.prototype.addToolbar.call(this,n);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),a},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var n,a=this.options.featureGroup,l=a.getLayers().length!==0;this.options.edit&&(n=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(n,"leaflet-disabled"):L.DomUtil.addClass(n,"leaflet-disabled"),n.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(n=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(n,"leaflet-disabled"):L.DomUtil.addClass(n,"leaflet-disabled"),n.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(n,a){if(L.Handler.prototype.initialize.call(this,n),L.setOptions(this,a),this._featureGroup=a.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var n=this._map;n&&(n.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),n._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(n){this._revertLayer(n)},this)},save:function(){var n=new L.LayerGroup;this._featureGroup.eachLayer(function(a){a.edited&&(n.addLayer(a),a.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:n})},_backupLayer:function(n){var a=L.Util.stamp(n);this._uneditedLayerProps[a]||(n instanceof L.Polyline||n instanceof L.Polygon||n instanceof L.Rectangle?this._uneditedLayerProps[a]={latlngs:L.LatLngUtil.cloneLatLngs(n.getLatLngs())}:n instanceof L.Circle?this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(n.getLatLng()),radius:n.getRadius()}:(n instanceof L.Marker||n instanceof L.CircleMarker)&&(this._uneditedLayerProps[a]={latlng:L.LatLngUtil.cloneLatLng(n.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(n){var a=L.Util.stamp(n);n.edited=!1,this._uneditedLayerProps.hasOwnProperty(a)&&(n instanceof L.Polyline||n instanceof L.Polygon||n instanceof L.Rectangle?n.setLatLngs(this._uneditedLayerProps[a].latlngs):n instanceof L.Circle?(n.setLatLng(this._uneditedLayerProps[a].latlng),n.setRadius(this._uneditedLayerProps[a].radius)):(n instanceof L.Marker||n instanceof L.CircleMarker)&&n.setLatLng(this._uneditedLayerProps[a].latlng),n.fire("revert-edited",{layer:n}))},_enableLayerEdit:function(n){var a,l,h=n.layer||n.target||n;this._backupLayer(h),this.options.poly&&(l=L.Util.extend({},this.options.poly),h.options.poly=l),this.options.selectedPathOptions&&(a=L.Util.extend({},this.options.selectedPathOptions),a.maintainColor&&(a.color=h.options.color,a.fillColor=h.options.fillColor),h.options.original=L.extend({},h.options),h.options.editing=a),h instanceof L.Marker?(h.editing&&h.editing.enable(),h.dragging.enable(),h.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):h.editing.enable()},_disableLayerEdit:function(n){var a=n.layer||n.target||n;a.edited=!1,a.editing&&a.editing.disable(),delete a.options.editing,delete a.options.original,this._selectedPathOptions&&(a instanceof L.Marker?this._toggleMarkerHighlight(a):(a.setStyle(a.options.previousOptions),delete a.options.previousOptions)),a instanceof L.Marker?(a.dragging.disable(),a.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):a.editing.disable()},_onMouseMove:function(n){this._tooltip.updatePosition(n.latlng)},_onMarkerDragEnd:function(n){var a=n.target;a.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:a})},_onTouchMove:function(n){var a=n.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(a),h=this._map.layerPointToLatLng(l);n.target.setLatLng(h)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(n,a){if(L.Handler.prototype.initialize.call(this,n),L.Util.setOptions(this,a),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var n=this._map;n&&(n.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(n){this._deletableLayers.addLayer(n),n.fire("revert-deleted",{layer:n})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(n){this._removeLayer({layer:n})},this),this.save()},_enableLayerDelete:function(n){(n.layer||n.target||n).on("click",this._removeLayer,this)},_disableLayerDelete:function(n){var a=n.layer||n.target||n;a.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(a)},_removeLayer:function(n){var a=n.layer||n.target||n;this._deletableLayers.removeLayer(a),this._deletedLayers.addLayer(a),a.fire("deleted")},_onMouseMove:function(n){this._tooltip.updatePosition(n.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const{Map:ho}=kc;function ba(i,e,o){const r=i.slice();return r[145]=e[o],r[147]=o,r}function wa(i,e,o){const r=i.slice();return r[148]=e[o],r[149]=e,r[150]=o,r}function La(i,e,o){const r=i.slice();return r[151]=e[o],r}function ka(i,e,o){const r=i.slice();return r[154]=e[o],r}function is(i){const e=i.slice(),o=e[56](e[154].source);e[157]=o;const r=e[56](e[154].target);return e[158]=r,e}function Ma(i,e,o){const r=i.slice();return r[159]=e[o],r[160]=e,r[161]=o,r}function Pa(i,e,o){const r=i.slice();return r[158]=e[o],r}function Ea(i,e,o){const r=i.slice();return r[166]=e[o],r}function Ca(i,e,o){const r=i.slice();return r[154]=e[o],r}function Ta(i,e,o){const r=i.slice();return r[171]=e[o],r}function Sa(i){let e,o=i[171].icon+"",r;return{c(){e=new Tc(!1),r=De(),e.a=r},m(n,a){e.m(o,n,a),J(n,r,a)},p(n,a){a[0]&256&&o!==(o=n[171].icon+"")&&e.p(o)},d(n){n&&(Y(r),e.d())}}}function Da(i){let e,o=i[171].label+"",r;return{c(){e=T("span"),r=Re(o)},m(n,a){J(n,e,a),w(e,r)},p(n,a){a[0]&256&&o!==(o=n[171].label+"")&&pi(r,o)},d(n){n&&Y(e)}}}function xa(i){let e,o,r,n,a,l,h=i[171].icon&&Sa(i),u=i[171].label&&Da(i);function f(){return i[73](i[171])}return{c(){e=T("button"),h&&h.c(),o=V(),u&&u.c(),r=V(),p(e,"class","icon-btn plugin-btn svelte-1xqemrv"),p(e,"title",n=i[171].label||i[171].id)},m(_,g){J(_,e,g),h&&h.m(e,null),w(e,o),u&&u.m(e,null),w(e,r),a||(l=ft(e,"click",f),a=!0)},p(_,g){i=_,i[171].icon?h?h.p(i,g):(h=Sa(i),h.c(),h.m(e,o)):h&&(h.d(1),h=null),i[171].label?u?u.p(i,g):(u=Da(i),u.c(),u.m(e,r)):u&&(u.d(1),u=null),g[0]&256&&n!==(n=i[171].label||i[171].id)&&p(e,"title",n)},d(_){_&&Y(e),h&&h.d(),u&&u.d(),a=!1,l()}}}function rf(i){let e=[],o=new ho,r,n=ke(i[2]);const a=l=>l[154].id;for(let l=0;l<n.length;l+=1){let h=Ca(i,n,l),u=a(h);o.set(u,e[l]=za(u,h))}return{c(){for(let l=0;l<e.length;l+=1)e[l].c();r=De()},m(l,h){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(l,h);J(l,r,h)},p(l,h){h[0]&4|h[1]&128&&(n=ke(l[2]),e=wn(e,h,a,1,l,n,o,r.parentNode,zo,za,r,Ca))},d(l){l&&Y(r);for(let h=0;h<e.length;h+=1)e[h].d(l)}}}function af(i){let e;return{c(){e=T("div"),e.textContent="(none)",p(e,"class","muted small txt svelte-1xqemrv")},m(o,r){J(o,e,r)},p:Ft,d(o){o&&Y(e)}}}function za(i,e){let o,r=e[154].source+"",n,a,l=e[154].target+"",h,u,f,_,g,y;function k(){return e[77](e[154])}return{key:i,first:null,c(){o=T("span"),n=Re(r),a=Re("â†’"),h=Re(l),u=V(),f=T("button"),f.textContent="Ã—",_=V(),p(f,"class","pill-x svelte-1xqemrv"),p(f,"aria-label","Remove edge"),p(o,"class","edge-pill svelte-1xqemrv"),p(o,"title","Click Ã— to remove"),this.first=o},m(P,C){J(P,o,C),w(o,n),w(o,a),w(o,h),w(o,u),w(o,f),w(o,_),g||(y=ft(f,"click",k),g=!0)},p(P,C){e=P,C[0]&4&&r!==(r=e[154].source+"")&&pi(n,r),C[0]&4&&l!==(l=e[154].target+"")&&pi(h,l)},d(P){P&&Y(o),g=!1,y()}}}function Ia(i){let e,o,r,n,a,l,h,u,f,_;return{c(){e=T("div"),o=T("span"),r=Re("connecting from "),n=T("code"),a=Re(i[9]),l=Re(" â€” click a nodeâ€™s â—€ to finish"),h=V(),u=T("button"),u.textContent="cancel",p(o,"class","txt svelte-1xqemrv"),p(u,"class","pill-x svelte-1xqemrv"),p(e,"class","pending small svelte-1xqemrv")},m(g,y){J(g,e,y),w(e,o),w(o,r),w(o,n),w(n,a),w(o,l),w(e,h),w(e,u),f||(_=ft(u,"click",i[45]),f=!0)},p(g,y){y[0]&512&&pi(a,g[9])},d(g){g&&Y(e),f=!1,_()}}}function lf(i){let e,o=[],r=new ho,n=ke(i[36]);const a=l=>l[166].id;for(let l=0;l<n.length;l+=1){let h=Ea(i,n,l),u=a(h);r.set(u,o[l]=Oa(u,h))}return{c(){e=T("div");for(let l=0;l<o.length;l+=1)o[l].c();p(e,"class","tool-list svelte-1xqemrv")},m(l,h){J(l,e,h);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(e,null)},p(l,h){h[1]&1140850720|h[2]&3&&(n=ke(l[36]),o=wn(o,h,a,1,l,n,r,e,zo,Oa,null,Ea))},d(l){l&&Y(e);for(let h=0;h<o.length;h+=1)o[h].d()}}}function cf(i){let e;return{c(){e=T("div"),e.textContent="(no scheduled jobs)",p(e,"class","muted small txt svelte-1xqemrv")},m(o,r){J(o,e,r)},p:Ft,d(o){o&&Y(e)}}}function Oa(i,e){let o,r,n,a,l=tl(e[166].next_run_time)+"",h,u,f,_,g,y,k,P,C,S,x,z,O,W,$,Q;function rt(){return e[78](e[166])}function ot(){return e[79](e[166])}function tt(){return e[80](e[166])}function at(){return e[81](e[166])}function K(){return e[82](e[166])}return{key:i,first:null,c(){o=T("div"),r=T("div"),n=T("div"),a=T("time"),h=Re(l),f=V(),_=T("div"),g=T("button"),g.textContent="Run now",y=V(),k=T("button"),k.textContent="Pause",P=V(),C=T("button"),C.textContent="Resume",S=V(),x=T("button"),x.textContent="Logs",z=V(),O=T("button"),O.textContent="Delete",W=V(),p(a,"datetime",u=e[166].next_run_time),p(n,"class","schedule-date svelte-1xqemrv"),p(r,"class","schedule-head svelte-1xqemrv"),p(g,"class","pill-x svelte-1xqemrv"),p(g,"title","Run now"),p(k,"class","pill-x svelte-1xqemrv"),p(k,"title","Pause"),p(C,"class","pill-x svelte-1xqemrv"),p(C,"title","Resume"),p(x,"class","pill-x svelte-1xqemrv"),p(x,"title","Logs"),p(O,"class","pill-x svelte-1xqemrv"),p(O,"title","Delete"),p(_,"class","schedule-actions svelte-1xqemrv"),p(o,"class","tool schedule-card svelte-1xqemrv"),this.first=o},m(N,F){J(N,o,F),w(o,r),w(r,n),w(n,a),w(a,h),w(o,f),w(o,_),w(_,g),w(_,y),w(_,k),w(_,P),w(_,C),w(_,S),w(_,x),w(_,z),w(_,O),w(o,W),$||(Q=[ft(g,"click",rt),ft(k,"click",ot),ft(C,"click",tt),ft(x,"click",at),ft(O,"click",K)],$=!0)},p(N,F){e=N,F[1]&32&&l!==(l=tl(e[166].next_run_time)+"")&&pi(h,l),F[1]&32&&u!==(u=e[166].next_run_time)&&p(a,"datetime",u)},d(N){N&&Y(o),$=!1,si(Q)}}}function Aa(i){let e,o=i[158].name+"",r,n;return{c(){e=T("option"),r=Re(o),e.__value=n=i[158].name,Ge(e,e.__value)},m(a,l){J(a,e,l),w(e,r)},p(a,l){l[0]&1024&&o!==(o=a[158].name+"")&&pi(r,o),l[0]&1024&&n!==(n=a[158].name)&&(e.__value=n,Ge(e,e.__value))},d(a){a&&Y(e)}}}function hf(i){let e,o,r=i[159].label+"",n,a,l,h,u,f,_,g,y,k,P,C,S,x,z,O,W,$,Q,rt,ot;function tt(){return i[83](i[159])}function at(){return i[84](i[159])}function K(){return i[85](i[159])}let N=ke(i[10]),F=[];for(let Dt=0;Dt<N.length;Dt+=1)F[Dt]=Aa(Pa(i,N,Dt));function j(){i[86].call(P,i[161])}function _t(){return i[87](i[161],i[159])}function pt(){return i[88](i[159])}function X(){return i[89](i[159],i[161])}function q(){return i[90](i[159])}return{c(){e=T("div"),o=T("div"),n=Re(r),a=V(),l=T("button"),h=V(),u=T("button"),_=V(),g=T("button"),g.textContent="ðŸ—‘",y=V(),k=T("div"),P=T("select");for(let Dt=0;Dt<F.length;Dt+=1)F[Dt].c();C=V(),S=T("button"),S.textContent="âš™",x=V(),z=T("button"),z.textContent="ðŸ‘",O=V(),W=T("button"),W.textContent="â–¶",Q=V(),p(o,"class","node-title svelte-1xqemrv"),p(l,"class","dot in svelte-1xqemrv"),p(l,"title","input"),p(u,"class","dot out svelte-1xqemrv"),p(u,"title","output"),p(u,"aria-pressed",f=i[9]===i[159].id),p(g,"class","node-del svelte-1xqemrv"),p(g,"title","delete node"),p(P,"class","svelte-1xqemrv"),i[1][i[161]].type===void 0&&On(j),p(S,"class","edit-btn svelte-1xqemrv"),p(z,"class","preview-btn svelte-1xqemrv"),p(z,"title","Preview on map"),p(W,"class","runone-btn svelte-1xqemrv"),p(W,"title","Run this node only"),p(k,"class","node-config svelte-1xqemrv"),p(e,"class","node svelte-1xqemrv"),p(e,"aria-selected",$=i[162]?"true":"false")},m(Dt,ut){J(Dt,e,ut),w(e,o),w(o,n),w(e,a),w(e,l),w(e,h),w(e,u),w(e,_),w(e,g),w(e,y),w(e,k),w(k,P);for(let wt=0;wt<F.length;wt+=1)F[wt]&&F[wt].m(P,null);Vn(P,i[1][i[161]].type,!0),w(k,C),w(k,S),w(k,x),w(k,z),w(k,O),w(k,W),J(Dt,Q,ut),rt||(ot=[ft(l,"click",tt),ft(u,"click",at),ft(g,"click",K),ft(P,"change",j),ft(P,"change",_t),ft(S,"click",pt),ft(z,"click",X),ft(W,"click",q),Tn(i[163].call(null,e))],rt=!0)},p(Dt,ut){if(i=Dt,ut[0]&2&&r!==(r=i[159].label+"")&&pi(n,r),ut[0]&1538&&f!==(f=i[9]===i[159].id)&&p(u,"aria-pressed",f),ut[0]&1024){N=ke(i[10]);let wt;for(wt=0;wt<N.length;wt+=1){const It=Pa(i,N,wt);F[wt]?F[wt].p(It,ut):(F[wt]=Aa(It),F[wt].c(),F[wt].m(P,null))}for(;wt<F.length;wt+=1)F[wt].d(1);F.length=N.length}ut[0]&1026&&Vn(P,i[1][i[161]].type),ut[5]&128&&$!==($=i[162]?"true":"false")&&p(e,"aria-selected",$)},d(Dt){Dt&&(Y(e),Y(Q)),Sn(F,Dt),rt=!1,si(ot)}}}function Na(i,e){let o,r,n,a;function l(u){e[91](u,e[161])}let h={id:e[159].id,width:kl,height:Ml,$$slots:{default:[hf,({selected:u,grabHandle:f})=>({162:u,163:f}),({selected:u,grabHandle:f})=>[0,0,0,0,0,(u?128:0)|(f?256:0)]]},$$scope:{ctx:e}};return e[1][e[161]].position!==void 0&&(h.position=e[1][e[161]].position),r=new us({props:h}),on.push(()=>Ic(r,"position",l)),{key:i,first:null,c(){o=De(),ce(r.$$.fragment),this.first=o},m(u,f){J(u,o,f),re(r,u,f),a=!0},p(u,f){e=u;const _={};f[0]&2&&(_.id=e[159].id),f[0]&1562|f[5]&524416&&(_.$$scope={dirty:f,ctx:e}),!n&&f[0]&2&&(n=!0,_.position=e[1][e[161]].position,Dc(()=>n=!1)),r.$set(_)},i(u){a||(B(r.$$.fragment,u),a=!0)},o(u){U(r.$$.fragment,u),a=!1},d(u){u&&Y(o),ae(r,u)}}}function Ba(i){let e,o;return{c(){e=Jt("path"),p(e,"d",o=`M ${i[47](i[157])} ${i[48](i[157])}
                          C ${i[47](i[157])+60} ${i[48](i[157])},
                            ${i[46](i[158])-60} ${i[48](i[158])},
                            ${i[46](i[158])} ${i[48](i[158])}`),p(e,"class","cable svelte-1xqemrv"),p(e,"marker-end","url(#arrow)")},m(r,n){J(r,e,n)},p(r,n){n[0]&4&&o!==(o=`M ${r[47](r[157])} ${r[48](r[157])}
                          C ${r[47](r[157])+60} ${r[48](r[157])},
                            ${r[46](r[158])-60} ${r[48](r[158])},
                            ${r[46](r[158])} ${r[48](r[158])}`)&&p(e,"d",o)},d(r){r&&Y(e)}}}function Ra(i,e){let o,r=e[37](e[154].source)&&e[37](e[154].target),n,a=r&&Ba(is(e));return{key:i,first:null,c(){o=De(),a&&a.c(),n=De(),this.first=o},m(l,h){J(l,o,h),a&&a.m(l,h),J(l,n,h)},p(l,h){e=l,h[0]&4&&(r=e[37](e[154].source)&&e[37](e[154].target)),r?a?a.p(is(e),h):(a=Ba(is(e)),a.c(),a.m(n.parentNode,n)):a&&(a.d(1),a=null)},d(l){l&&(Y(o),Y(n)),a&&a.d(l)}}}function Za(i){let e,o,r,n=[],a=new ho,l,h=ke(i[2]);const u=f=>f[154].id;for(let f=0;f<h.length;f+=1){let _=ka(i,h,f),g=u(_);a.set(g,n[f]=Ra(g,_))}return{c(){e=Jt("defs"),o=Jt("marker"),r=Jt("path");for(let f=0;f<n.length;f+=1)n[f].c();l=De(),p(r,"d","M 0 0 L 10 5 L 0 10 z"),p(o,"id","arrow"),p(o,"viewBox","0 0 10 10"),p(o,"refX","9"),p(o,"refY","5"),p(o,"markerWidth","6"),p(o,"markerHeight","6"),p(o,"orient","auto-start-reverse")},m(f,_){J(f,e,_),w(e,o),w(o,r);for(let g=0;g<n.length;g+=1)n[g]&&n[g].m(f,_);J(f,l,_)},p(f,_){_[0]&4|_[1]&33783872&&(h=ke(f[2]),n=wn(n,_,u,1,f,h,a,l.parentNode,zo,Ra,l,ka))},d(f){f&&(Y(e),Y(l));for(let _=0;_<n.length;_+=1)n[_].d(f)}}}function uf(i){let e=[],o=new ho,r,n,a=i[14],l,h,u=ke(i[1]);const f=g=>g[159].id;for(let g=0;g<u.length;g+=1){let y=Ma(i,u,g),k=f(y);o.set(k,e[g]=Na(k,y))}let _=Za(i);return{c(){for(let g=0;g<e.length;g+=1)e[g].c();r=V(),n=Jt("svg"),_.c(),p(n,"class","edges-overlay svelte-1xqemrv"),p(n,"viewBox",l=`0 0 ${i[16]} ${i[17]}`),p(n,"preserveAspectRatio","none")},m(g,y){for(let k=0;k<e.length;k+=1)e[k]&&e[k].m(g,y);J(g,r,y),J(g,n,y),_.m(n,null),h=!0},p(g,y){y[0]&1562|y[1]&10498816|y[5]&128&&(u=ke(g[1]),we(),e=wn(e,y,f,1,g,u,o,r.parentNode,ao,Na,r,Ma),Le()),y[0]&16384&&ui(a,a=g[14])?(_.d(1),_=Za(g),_.c(),_.m(n,null)):_.p(g,y),(!h||y[0]&196608&&l!==(l=`0 0 ${g[16]} ${g[17]}`))&&p(n,"viewBox",l)},i(g){if(!h){for(let y=0;y<u.length;y+=1)B(e[y]);h=!0}},o(g){for(let y=0;y<e.length;y+=1)U(e[y]);h=!1},d(g){g&&(Y(r),Y(n));for(let y=0;y<e.length;y+=1)e[y].d(g);_.d(g)}}}function Ha(i){let e,o,r,n,a,l,h=i[22].label+"",u,f,_,g,y,k,P,C,S,x,z,O,W,$;function Q(tt,at){return tt[26]?df:ff}let rt=Q(i),ot=rt(i);return{c(){e=T("div"),o=V(),r=T("div"),n=T("div"),a=T("h3"),l=Re("Edit Args â€” "),u=Re(h),f=V(),_=T("div"),g=T("button"),g.textContent="Form",y=V(),k=T("button"),k.textContent="Advanced JSON",P=V(),ot.c(),C=V(),S=T("div"),x=T("button"),x.textContent="Cancel",z=V(),O=T("button"),O.textContent="Save",p(e,"class","modal-backdrop svelte-1xqemrv"),p(a,"class","svelte-1xqemrv"),p(g,"class","svelte-1xqemrv"),jt(g,"seg-active",!i[26]),p(k,"class","svelte-1xqemrv"),jt(k,"seg-active",i[26]),p(_,"class","seg svelte-1xqemrv"),p(n,"class","modal-head svelte-1xqemrv"),p(x,"class","btn svelte-1xqemrv"),p(O,"class","btn primary svelte-1xqemrv"),p(S,"class","modal-actions svelte-1xqemrv"),p(r,"class","modal svelte-1xqemrv")},m(tt,at){J(tt,e,at),J(tt,o,at),J(tt,r,at),w(r,n),w(n,a),w(a,l),w(a,u),w(n,f),w(n,_),w(_,g),w(_,y),w(_,k),w(r,P),ot.m(r,null),w(r,C),w(r,S),w(S,x),w(S,z),w(S,O),W||($=[ft(e,"click",i[95]),ft(g,"click",i[96]),ft(k,"click",i[97]),ft(x,"click",i[105]),ft(O,"click",i[55]),ft(r,"click",nn(i[72]))],W=!0)},p(tt,at){at[0]&4194304&&h!==(h=tt[22].label+"")&&pi(u,h),at[0]&67108864&&jt(g,"seg-active",!tt[26]),at[0]&67108864&&jt(k,"seg-active",tt[26]),rt===(rt=Q(tt))&&ot?ot.p(tt,at):(ot.d(1),ot=rt(tt),ot&&(ot.c(),ot.m(r,C)))},d(tt){tt&&(Y(e),Y(o),Y(r)),ot.d(),W=!1,si($)}}}function df(i){let e,o,r;return{c(){e=T("textarea"),p(e,"class","json-area svelte-1xqemrv")},m(n,a){J(n,e,a),Ge(e,i[23]),o||(r=ft(e,"input",i[104]),o=!0)},p(n,a){a[0]&8388608&&Ge(e,n[23])},d(n){n&&Y(e),o=!1,r()}}}function ff(i){let e,o=ke(i[24]),r=[];for(let n=0;n<o.length;n+=1)r[n]=Ga(wa(i,o,n));return{c(){e=T("div");for(let n=0;n<r.length;n+=1)r[n].c();p(e,"class","form-grid svelte-1xqemrv")},m(n,a){J(n,e,a);for(let l=0;l<r.length;l+=1)r[l]&&r[l].m(e,null)},p(n,a){if(a[0]&50331648){o=ke(n[24]);let l;for(l=0;l<o.length;l+=1){const h=wa(n,o,l);r[l]?r[l].p(h,a):(r[l]=Ga(h),r[l].c(),r[l].m(e,null))}for(;l<r.length;l+=1)r[l].d(1);r.length=o.length}},d(n){n&&Y(e),Sn(r,n)}}}function _f(i){let e,o,r,n=ke($a(i[148])),a=[];for(let h=0;h<n.length;h+=1)a[h]=Fa(La(i,n,h));function l(){i[103].call(e,i[148])}return{c(){e=T("select");for(let h=0;h<a.length;h+=1)a[h].c();p(e,"class","svelte-1xqemrv"),i[25][i[148].key]===void 0&&On(l)},m(h,u){J(h,e,u);for(let f=0;f<a.length;f+=1)a[f]&&a[f].m(e,null);Vn(e,i[25][i[148].key],!0),o||(r=ft(e,"change",l),o=!0)},p(h,u){if(i=h,u[0]&16777216){n=ke($a(i[148]));let f;for(f=0;f<n.length;f+=1){const _=La(i,n,f);a[f]?a[f].p(_,u):(a[f]=Fa(_),a[f].c(),a[f].m(e,null))}for(;f<a.length;f+=1)a[f].d(1);a.length=n.length}u[0]&50331648&&Vn(e,i[25][i[148].key])},d(h){h&&Y(e),Sn(a,h),o=!1,r()}}}function mf(i){let e,o,r,n,a,l=Qa(i[148])+"",h,u,f;function _(){i[102].call(e,i[148])}return{c(){e=T("input"),r=V(),n=T("small"),a=Re("Comma-separated "),h=Re(l),p(e,"type","text"),p(e,"placeholder",o=Ja(i[148])),p(e,"class","svelte-1xqemrv"),p(n,"class","muted svelte-1xqemrv")},m(g,y){J(g,e,y),Ge(e,i[25][i[148].key]),J(g,r,y),J(g,n,y),w(n,a),w(n,h),u||(f=ft(e,"input",_),u=!0)},p(g,y){i=g,y[0]&16777216&&o!==(o=Ja(i[148]))&&p(e,"placeholder",o),y[0]&50331648&&e.value!==i[25][i[148].key]&&Ge(e,i[25][i[148].key]),y[0]&16777216&&l!==(l=Qa(i[148])+"")&&pi(h,l)},d(g){g&&(Y(e),Y(r),Y(n)),u=!1,f()}}}function pf(i){let e,o,r,n,a;function l(){i[101].call(e,i[148])}return{c(){e=T("textarea"),p(e,"rows",o=Xa(i[148])),p(e,"placeholder",r=Ka(i[148])),p(e,"class","svelte-1xqemrv")},m(h,u){J(h,e,u),Ge(e,i[25][i[148].key]),n||(a=ft(e,"input",l),n=!0)},p(h,u){i=h,u[0]&16777216&&o!==(o=Xa(i[148]))&&p(e,"rows",o),u[0]&16777216&&r!==(r=Ka(i[148]))&&p(e,"placeholder",r),u[0]&50331648&&Ge(e,i[25][i[148].key])},d(h){h&&Y(e),n=!1,a()}}}function gf(i){let e,o,r,n,a,l;function h(){i[100].call(o,i[148])}return{c(){e=T("label"),o=T("input"),r=V(),n=T("span"),p(o,"type","checkbox"),p(o,"class","svelte-1xqemrv"),p(e,"class","switch svelte-1xqemrv")},m(u,f){J(u,e,f),w(e,o),o.checked=i[25][i[148].key],w(e,r),w(e,n),a||(l=ft(o,"change",h),a=!0)},p(u,f){i=u,f[0]&50331648&&(o.checked=i[25][i[148].key])},d(u){u&&Y(e),a=!1,l()}}}function vf(i){let e,o,r,n;function a(){i[99].call(e,i[148])}return{c(){e=T("input"),p(e,"type","number"),p(e,"step",o=i[148].step??1),p(e,"class","svelte-1xqemrv")},m(l,h){J(l,e,h),Ge(e,i[25][i[148].key]),r||(n=ft(e,"input",a),r=!0)},p(l,h){i=l,h[0]&16777216&&o!==(o=i[148].step??1)&&p(e,"step",o),h[0]&50331648&&Cn(e.value)!==i[25][i[148].key]&&Ge(e,i[25][i[148].key])},d(l){l&&Y(e),r=!1,n()}}}function yf(i){let e,o,r,n;function a(){i[98].call(e,i[148])}return{c(){e=T("input"),p(e,"type","text"),p(e,"placeholder",o=i[148].placeholder??""),p(e,"class","svelte-1xqemrv")},m(l,h){J(l,e,h),Ge(e,i[25][i[148].key]),r||(n=ft(e,"input",a),r=!0)},p(l,h){i=l,h[0]&16777216&&o!==(o=i[148].placeholder??"")&&p(e,"placeholder",o),h[0]&50331648&&e.value!==i[25][i[148].key]&&Ge(e,i[25][i[148].key])},d(l){l&&Y(e),r=!1,n()}}}function Fa(i){let e,o=i[151]+"",r,n;return{c(){e=T("option"),r=Re(o),e.__value=n=i[151],Ge(e,e.__value)},m(a,l){J(a,e,l),w(e,r)},p(a,l){l[0]&16777216&&o!==(o=a[151]+"")&&pi(r,o),l[0]&16777216&&n!==(n=a[151])&&(e.__value=n,Ge(e,e.__value))},d(a){a&&Y(e)}}}function Ga(i){let e,o,r=i[148].label+"",n,a,l;function h(_,g){if(_[148].type==="string")return yf;if(_[148].type==="number")return vf;if(_[148].type==="boolean")return gf;if(_[148].type==="textarea")return pf;if(_[148].type==="array")return mf;if(_[148].type==="select")return _f}let u=h(i),f=u&&u(i);return{c(){e=T("div"),o=T("label"),n=Re(r),a=V(),f&&f.c(),l=V(),p(o,"class","svelte-1xqemrv"),p(e,"class","form-row svelte-1xqemrv")},m(_,g){J(_,e,g),w(e,o),w(o,n),w(e,a),f&&f.m(e,null),w(e,l)},p(_,g){g[0]&16777216&&r!==(r=_[148].label+"")&&pi(n,r),u===(u=h(_))&&f?f.p(_,g):(f&&f.d(1),f=u&&u(_),f&&(f.c(),f.m(e,l)))},d(_){_&&Y(e),f&&f.d()}}}function qa(i){let e,o,r,n,a,l,h,u,f,_,g,y,k,P,C,S,x,z,O,W,$=i[34]?"Schedulingâ€¦":"Create schedule",Q,rt,ot;function tt(F,j){return F[28]==="once"?Lf:F[28]==="interval"?wf:bf}let at=tt(i),K=at(i),N=i[35]&&Ua(i);return{c(){e=T("div"),o=V(),r=T("div"),n=T("div"),n.innerHTML='<h3 class="svelte-1xqemrv">Schedule Pipeline (active connected graph)</h3>',a=V(),l=T("div"),h=T("div"),u=T("label"),u.textContent="Mode",f=V(),_=T("select"),g=T("option"),g.textContent="Once",y=T("option"),y.textContent="Interval",k=T("option"),k.textContent="Cron",P=V(),K.c(),C=V(),N&&N.c(),S=V(),x=T("div"),z=T("button"),z.textContent="Cancel",O=V(),W=T("button"),Q=Re($),p(e,"class","modal-backdrop svelte-1xqemrv"),p(n,"class","modal-head svelte-1xqemrv"),p(u,"class","svelte-1xqemrv"),g.__value="once",Ge(g,g.__value),y.__value="interval",Ge(y,y.__value),k.__value="cron",Ge(k,k.__value),p(_,"class","svelte-1xqemrv"),i[28]===void 0&&On(()=>i[107].call(_)),p(h,"class","form-row svelte-1xqemrv"),p(l,"class","form-grid svelte-1xqemrv"),p(z,"class","btn svelte-1xqemrv"),p(W,"class","btn primary svelte-1xqemrv"),W.disabled=i[34],p(x,"class","modal-actions svelte-1xqemrv"),p(r,"class","modal svelte-1xqemrv")},m(F,j){J(F,e,j),J(F,o,j),J(F,r,j),w(r,n),w(r,a),w(r,l),w(l,h),w(h,u),w(h,f),w(h,_),w(_,g),w(_,y),w(_,k),Vn(_,i[28],!0),w(l,P),K.m(l,null),w(l,C),N&&N.m(l,null),w(r,S),w(r,x),w(x,z),w(x,O),w(x,W),w(W,Q),rt||(ot=[ft(e,"click",i[106]),ft(_,"change",i[107]),ft(z,"click",i[113]),ft(W,"click",i[59]),ft(r,"click",nn(i[71]))],rt=!0)},p(F,j){j[0]&268435456&&Vn(_,F[28]),at===(at=tt(F))&&K?K.p(F,j):(K.d(1),K=at(F),K&&(K.c(),K.m(l,C))),F[35]?N?N.p(F,j):(N=Ua(F),N.c(),N.m(l,null)):N&&(N.d(1),N=null),j[1]&8&&$!==($=F[34]?"Schedulingâ€¦":"Create schedule")&&pi(Q,$),j[1]&8&&(W.disabled=F[34])},d(F){F&&(Y(e),Y(o),Y(r)),K.d(),N&&N.d(),rt=!1,si(ot)}}}function bf(i){let e,o,r,n,a,l,h,u;return{c(){e=T("div"),o=T("label"),o.textContent="Cron (UTC)",r=V(),n=T("input"),a=V(),l=T("small"),l.innerHTML="Example: <code>0 5 * * *</code> = 05:00 UTC daily",p(o,"class","svelte-1xqemrv"),p(n,"type","text"),p(n,"placeholder","0 5 * * *"),p(n,"class","svelte-1xqemrv"),p(l,"class","muted svelte-1xqemrv"),p(e,"class","form-row svelte-1xqemrv")},m(f,_){J(f,e,_),w(e,o),w(e,r),w(e,n),Ge(n,i[33]),w(e,a),w(e,l),h||(u=ft(n,"input",i[112]),h=!0)},p(f,_){_[1]&4&&n.value!==f[33]&&Ge(n,f[33])},d(f){f&&Y(e),h=!1,u()}}}function wf(i){let e,o,r,n,a,l,h,u,f,_,g,y,k;return{c(){e=T("div"),o=T("label"),o.textContent="Interval",r=V(),n=T("div"),a=T("input"),l=V(),h=T("input"),u=V(),f=T("input"),_=V(),g=T("small"),g.textContent="At least one of hours/minutes/seconds must be > 0.",p(o,"class","svelte-1xqemrv"),p(a,"type","number"),p(a,"min","0"),p(a,"placeholder","hours"),p(a,"class","svelte-1xqemrv"),p(h,"type","number"),p(h,"min","0"),p(h,"placeholder","minutes"),p(h,"class","svelte-1xqemrv"),p(f,"type","number"),p(f,"min","0"),p(f,"placeholder","seconds"),p(f,"class","svelte-1xqemrv"),lt(n,"display","grid"),lt(n,"grid-template-columns","repeat(3, 1fr)"),lt(n,"gap","8px"),p(g,"class","muted svelte-1xqemrv"),p(e,"class","form-row svelte-1xqemrv")},m(P,C){J(P,e,C),w(e,o),w(e,r),w(e,n),w(n,a),Ge(a,i[30]),w(n,l),w(n,h),Ge(h,i[31]),w(n,u),w(n,f),Ge(f,i[32]),w(e,_),w(e,g),y||(k=[ft(a,"input",i[109]),ft(h,"input",i[110]),ft(f,"input",i[111])],y=!0)},p(P,C){C[0]&1073741824&&Cn(a.value)!==P[30]&&Ge(a,P[30]),C[1]&1&&Cn(h.value)!==P[31]&&Ge(h,P[31]),C[1]&2&&Cn(f.value)!==P[32]&&Ge(f,P[32])},d(P){P&&Y(e),y=!1,si(k)}}}function Lf(i){let e,o,r,n,a,l,h,u;return{c(){e=T("div"),o=T("label"),o.textContent="Date & time (your local)",r=V(),n=T("input"),a=V(),l=T("small"),l.textContent="Stored & executed in UTC on the server.",p(o,"class","svelte-1xqemrv"),p(n,"type","datetime-local"),p(l,"class","muted svelte-1xqemrv"),p(e,"class","form-row svelte-1xqemrv")},m(f,_){J(f,e,_),w(e,o),w(e,r),w(e,n),Ge(n,i[29]),w(e,a),w(e,l),h||(u=ft(n,"input",i[108]),h=!0)},p(f,_){_[0]&536870912&&Ge(n,f[29])},d(f){f&&Y(e),h=!1,u()}}}function Ua(i){let e,o,r;return{c(){e=T("div"),o=T("div"),r=Re(i[35]),p(o,"class","muted svelte-1xqemrv"),lt(o,"color","#ffb4b4"),p(e,"class","form-row svelte-1xqemrv")},m(n,a){J(n,e,a),w(e,o),w(o,r)},p(n,a){a[1]&16&&pi(r,n[35])},d(n){n&&Y(e)}}}function kf(i){let e,o=[],r=new ho,n=ke(i[11]);const a=l=>l[147];for(let l=0;l<n.length;l+=1){let h=ba(i,n,l),u=a(h);r.set(u,o[l]=Wa(u,h))}return{c(){e=T("ul");for(let l=0;l<o.length;l+=1)o[l].c();p(e,"class","svelte-1xqemrv")},m(l,h){J(l,e,h);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(e,null)},p(l,h){h[0]&2048&&(n=ke(l[11]),o=wn(o,h,a,1,l,n,r,e,zo,Wa,null,ba))},d(l){l&&Y(e);for(let h=0;h<o.length;h+=1)o[h].d()}}}function Mf(i){let e;return{c(){e=T("div"),e.textContent="No logs yet. Run the pipeline to see Python prints/stdout.",p(e,"class","muted small svelte-1xqemrv")},m(o,r){J(o,e,r)},p:Ft,d(o){o&&Y(e)}}}function Wa(i,e){let o,r,n=e[145].nodeId+"",a,l,h=e[145].text+"",u,f,_;return{key:i,first:null,c(){o=T("li"),r=T("code"),a=Re(n),l=Re(" â€” "),u=Re(h),f=V(),p(r,"class","svelte-1xqemrv"),p(o,"class",_=Xs(e[145].ok?"ok":"err")+" svelte-1xqemrv"),this.first=o},m(g,y){J(g,o,y),w(o,r),w(r,a),w(o,l),w(o,u),w(o,f)},p(g,y){e=g,y[0]&2048&&n!==(n=e[145].nodeId+"")&&pi(a,n),y[0]&2048&&h!==(h=e[145].text+"")&&pi(u,h),y[0]&2048&&_!==(_=Xs(e[145].ok?"ok":"err")+" svelte-1xqemrv")&&p(o,"class",_)},d(g){g&&Y(o)}}}function ja(i){let e,o,r;return{c(){e=T("div"),o=Re(i[5]),p(e,"class",r="toast toast-"+i[6]+" svelte-1xqemrv")},m(n,a){J(n,e,a),w(e,o)},p(n,a){a[0]&32&&pi(o,n[5]),a[0]&64&&r!==(r="toast toast-"+n[6]+" svelte-1xqemrv")&&p(e,"class",r)},d(n){n&&Y(e)}}}function Pf(i){let e,o,r,n,a,l,h,u,f,_,g,y,k,P,C,S,x,z,O,W,$,Q,rt,ot,tt,at,K,N,F,j,_t,pt,X,q,Dt,ut,wt,It,ht,Z,et,G,it,Xt,me,gt,zt,Nt,bt,Kt,oe,pe=i[0]==="dark"?"Dark":"Light",st,se,Ot,Bt,Gt,ee,he,Je,Ze,qt,He,Ve,ze,Vt,ue,ve,Qt,Ye=i[12]?"Runningâ€¦":"Run",di,ri,Ie,Zt,Me,Qe,fi,ai,qe,Oe,Ae,li,$t,ie,ii,ni,$e,Ei,Bi,Ue,kt,gi,ci,ti,vi,b,mt,Et,Pt,xt,A,Yt,de,te,ge,Xe,We,Ci,Pi,sn,Vi,xi,Ti,Ji,rn,vt,Rt,ne,_i,zi,Fe,fe,Ht,ye,hn,Ai,yi,Qi,qi,Ni,Ne,je,Yi,$i,Ri=ke(i[8]),Ke=[];for(let D=0;D<Ri.length;D+=1)Ke[D]=xa(Ta(i,Ri,D));function Ln(D,dt){return D[2].length===0?af:rf}let un=Ln(i),Ii=un(i),bi=i[9]&&Ia(i);function kn(D,dt){return D[36].length===0?cf:lf}let an=kn(i),Zi=an(i);We=new of({props:{width:i[16],height:i[17],theme:i[0],$$slots:{default:[uf]},$$scope:{ctx:i}}});let wi=i[22]&&Ha(i),Si=i[27]&&qa(i);function Wt(D,dt){return D[11].length===0?Mf:kf}let Oi=Wt(i),M=Oi(i),H=i[7]&&ja(i);return{c(){e=T("div"),o=T("header"),r=T("div"),n=T("button"),n.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',a=V(),l=T("div"),l.innerHTML='<span class="title svelte-1xqemrv">SATERYS</span>',h=V(),u=T("div"),u.innerHTML='<div class="hint svelte-1xqemrv">Build pipelines â€” click a nodeâ€™s â—€ / â–¶ to connect</div>',f=V(),_=T("div");for(let D=0;D<Ke.length;D+=1)Ke[D].c();g=V(),y=T("button"),k=Jt("svg"),P=Jt("path"),C=V(),S=T("span"),S.textContent="Run",z=V(),O=T("button"),O.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z" stroke="currentColor" stroke-width="2" fill="none"></path><path d="M7 3v6h10" stroke="currentColor" stroke-width="2" fill="none"></path><path d="M17 21v-8H7v8" stroke="currentColor" stroke-width="2" fill="none"></path></svg> <span>Save</span>',W=V(),$=T("button"),$.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M3 15v4a2 2 0 002 2h14a2 2 0 002-2v-4M17 9l-5 5-5-5M12 4v10" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Load</span>',Q=V(),rt=T("button"),rt.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M8 7V4m8 3V4M5 11h14M7 21h10a2 2 0 002-2V8a2 2 0 00-2-2H7a2 2 0 00-2 2v11a2 2 0 002 2zm5-6v-3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span>Schedule</span>',ot=V(),tt=T("button"),tt.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2zm2 4l3 3-3 3m5 0h5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Logs</span>',at=V(),K=T("button"),N=Jt("svg"),F=Jt("path"),j=V(),_t=T("span"),_t.textContent="Layers",pt=V(),X=T("button"),X.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Load SHP</span>',q=V(),Dt=T("button"),Dt.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z" stroke="currentColor" stroke-width="2" fill="none"></path><circle cx="12" cy="15" r="2" fill="currentColor"></circle></svg> <span>Save SHP</span>',ut=V(),wt=T("button"),wt.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M3 6h18M9 6V4a1 1 0 011-1h4a1 1 0 011 1v2m2 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h12z" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Clear Vec</span>',It=V(),ht=T("button"),Z=Jt("svg"),et=Jt("path"),G=Jt("path"),it=V(),Xt=T("span"),Xt.textContent="3D",gt=V(),zt=T("button"),Nt=Jt("svg"),bt=Jt("path"),Kt=V(),oe=T("span"),st=Re(pe),se=V(),Ot=T("button"),Ot.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span>Add</span>',Bt=V(),Gt=T("div"),ee=T("aside"),he=T("div"),Je=T("div"),Je.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M5 12h14M12 5v14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span class="txt svelte-1xqemrv">Tools</span>',Ze=V(),qt=T("div"),He=T("button"),He.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span class="txt svelte-1xqemrv">Add Node</span>',Ve=V(),ze=T("button"),Vt=Jt("svg"),ue=Jt("path"),ve=V(),Qt=T("span"),di=Re(Ye),ri=V(),Ie=T("button"),Zt=Jt("svg"),Me=Jt("path"),Qe=V(),fi=T("span"),fi.textContent="Clear Layers",ai=V(),qe=T("button"),Oe=Jt("svg"),Ae=Jt("path"),li=V(),$t=T("span"),ie=Re("Theme: "),ii=Re(i[0]),ni=V(),$e=T("div"),Ei=T("div"),Ei.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 12l7-7 4 4 7-7" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span class="txt svelte-1xqemrv">Edges</span>',Bi=V(),Ue=T("div"),Ii.c(),kt=V(),bi&&bi.c(),gi=V(),ci=T("div"),ti=T("div"),vi=Jt("svg"),b=Jt("path"),mt=V(),Et=T("span"),Et.textContent="Schedules",Pt=V(),xt=T("button"),xt.textContent="â†»",A=V(),Zi.c(),de=V(),te=T("div"),ge=T("div"),Xe=T("div"),ce(We.$$.fragment),Ci=V(),Pi=T("div"),sn=V(),Vi=T("div"),xi=T("div"),Ji=V(),wi&&wi.c(),rn=V(),Si&&Si.c(),vt=V(),Rt=T("div"),ne=T("div"),_i=T("div"),_i.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2zm2 4l3 3-3 3m5 0h5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Pipeline Logs</span>',zi=V(),Fe=T("div"),fe=T("button"),fe.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M9 9h11v11H9zM5 5h11v11" stroke="currentColor" stroke-width="2" fill="none"></path></svg>',Ht=V(),ye=T("button"),ye.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 6h18M9 6v12m6-12v12M5 6l1-3h12l1 3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',hn=V(),Ai=T("button"),Ai.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M6 6l12 12M6 18L18 6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',yi=V(),Qi=T("div"),M.c(),Ni=V(),H&&H.c(),Ne=De(),p(n,"class","icon-btn ghost svelte-1xqemrv"),p(n,"title","Toggle sidebar"),p(l,"class","brand svelte-1xqemrv"),p(r,"class","left svelte-1xqemrv"),p(u,"class","center svelte-1xqemrv"),p(P,"d","M8 5v14l11-7z"),p(P,"fill","currentColor"),p(k,"viewBox","0 0 24 24"),p(k,"width","18"),p(k,"height","18"),p(y,"class","icon-btn svelte-1xqemrv"),p(y,"title",x=i[12]?"Runningâ€¦":"Run pipeline"),y.disabled=i[12],p(O,"class","icon-btn svelte-1xqemrv"),p(O,"title","Save workflow"),p($,"class","icon-btn svelte-1xqemrv"),p($,"title","Load workflow"),p(rt,"class","icon-btn svelte-1xqemrv"),p(rt,"title","Schedule pipeline"),p(tt,"class","icon-btn svelte-1xqemrv"),p(tt,"title","Toggle logs"),p(F,"d","M12 3l9 5-9 5-9-5 9-5zm0 8l9 5-9 5-9-5"),p(F,"stroke","currentColor"),p(F,"stroke-width","2"),p(F,"fill","none"),p(F,"stroke-linejoin","round"),p(N,"viewBox","0 0 24 24"),p(N,"width","18"),p(N,"height","18"),p(K,"class","icon-btn svelte-1xqemrv"),p(K,"title","Clear map layers"),K.disabled=i[50].size===0,p(X,"class","icon-btn svelte-1xqemrv"),p(X,"title","Load shapefile"),p(Dt,"class","icon-btn svelte-1xqemrv"),p(Dt,"title","Save shapefile"),p(wt,"class","icon-btn svelte-1xqemrv"),p(wt,"title","Clear vector data"),p(et,"d","M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"),p(et,"stroke","currentColor"),p(et,"stroke-width","2"),p(et,"fill","none"),p(G,"d","M3.27 6.96L12 12.01l8.73-5.05M12 22.08V12"),p(G,"stroke","currentColor"),p(G,"stroke-width","2"),p(G,"fill","none"),p(G,"stroke-linecap","round"),p(G,"stroke-linejoin","round"),p(Z,"viewBox","0 0 24 24"),p(Z,"width","18"),p(Z,"height","18"),p(ht,"class","icon-btn svelte-1xqemrv"),p(ht,"title",me=i[21]?"3D mode ON":"3D mode OFF"),jt(ht,"primary",i[21]),p(bt,"d","M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"),p(bt,"stroke","currentColor"),p(bt,"stroke-width","2"),p(bt,"fill","none"),p(Nt,"viewBox","0 0 24 24"),p(Nt,"width","18"),p(Nt,"height","18"),p(zt,"class","icon-btn svelte-1xqemrv"),p(zt,"title","Toggle theme"),p(Ot,"class","icon-btn primary svelte-1xqemrv"),p(Ot,"title","Add node"),p(_,"class","right svelte-1xqemrv"),p(o,"class","topbar glass svelte-1xqemrv"),p(Je,"class","section-title svelte-1xqemrv"),p(He,"class","tool svelte-1xqemrv"),p(He,"title","Add node"),p(ue,"d","M8 5v14l11-7z"),p(ue,"fill","currentColor"),p(Vt,"viewBox","0 0 24 24"),p(Vt,"width","16"),p(Vt,"height","16"),p(Qt,"class","txt svelte-1xqemrv"),p(ze,"class","tool svelte-1xqemrv"),ze.disabled=i[12],p(ze,"title","Run pipeline"),p(Me,"d","M12 3l9 5-9 5-9-5 9-5zm0 8l9 5-9 5-9-5"),p(Me,"stroke","currentColor"),p(Me,"stroke-width","2"),p(Me,"fill","none"),p(Me,"stroke-linejoin","round"),p(Zt,"viewBox","0 0 24 24"),p(Zt,"width","16"),p(Zt,"height","16"),p(fi,"class","txt svelte-1xqemrv"),p(Ie,"class","tool svelte-1xqemrv"),Ie.disabled=i[50].size===0,p(Ie,"title","Clear overlay layers"),p(Ae,"d","M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"),p(Ae,"stroke","currentColor"),p(Ae,"stroke-width","2"),p(Ae,"fill","none"),p(Oe,"viewBox","0 0 24 24"),p(Oe,"width","16"),p(Oe,"height","16"),p($t,"class","txt svelte-1xqemrv"),p(qe,"class","tool svelte-1xqemrv"),p(qe,"title","Toggle theme"),p(qt,"class","tool-list svelte-1xqemrv"),p(he,"class","section"),p(Ei,"class","section-title svelte-1xqemrv"),p(Ue,"class","edge-chips svelte-1xqemrv"),p($e,"class","section"),p(b,"d","M6 6h12v12H6zM9 3h6M3 9h6M15 21h6M3 15h6"),p(b,"stroke","currentColor"),p(b,"stroke-width","2"),p(b,"fill","none"),p(b,"stroke-linecap","round"),p(vi,"viewBox","0 0 24 24"),p(vi,"width","16"),p(vi,"height","16"),p(Et,"class","txt svelte-1xqemrv"),p(xt,"class","pill-x svelte-1xqemrv"),p(xt,"title","Refresh"),p(ti,"class","section-title svelte-1xqemrv"),p(ci,"class","section"),p(ee,"class","sidebar svelte-1xqemrv"),p(ee,"data-collapsed",Yt=i[13]?"true":"false"),p(Xe,"class","split-left svelte-1xqemrv"),lt(Xe,"width",i[18]+"%"),p(Pi,"class","split-handle svelte-1xqemrv"),p(Pi,"role","separator"),p(Pi,"aria-orientation","vertical"),p(Pi,"aria-label","Resize split"),p(xi,"class","map svelte-1xqemrv"),p(Vi,"class","split-right svelte-1xqemrv"),p(ge,"class","split-container svelte-1xqemrv"),p(te,"class","work svelte-1xqemrv"),p(Gt,"class","main svelte-1xqemrv"),p(Gt,"data-collapsed",Ti=i[13]?"true":"false"),p(_i,"class","logs-title svelte-1xqemrv"),p(fe,"class","icon-btn svelte-1xqemrv"),p(fe,"title","Copy all"),p(ye,"class","icon-btn svelte-1xqemrv"),p(ye,"title","Clear"),p(Ai,"class","icon-btn svelte-1xqemrv"),p(Ai,"title","Close"),p(Fe,"class","logs-actions svelte-1xqemrv"),p(ne,"class","logs-header svelte-1xqemrv"),p(Qi,"class","logs-body svelte-1xqemrv"),p(Rt,"class","logs-drawer svelte-1xqemrv"),p(Rt,"data-open",qi=i[4]?"true":"false"),p(e,"class","app-root svelte-1xqemrv")},m(D,dt){J(D,e,dt),w(e,o),w(o,r),w(r,n),w(r,a),w(r,l),w(o,h),w(o,u),w(o,f),w(o,_);for(let Mt=0;Mt<Ke.length;Mt+=1)Ke[Mt]&&Ke[Mt].m(_,null);w(_,g),w(_,y),w(y,k),w(k,P),w(y,C),w(y,S),w(_,z),w(_,O),w(_,W),w(_,$),w(_,Q),w(_,rt),w(_,ot),w(_,tt),w(_,at),w(_,K),w(K,N),w(N,F),w(K,j),w(K,_t),w(_,pt),w(_,X),w(_,q),w(_,Dt),w(_,ut),w(_,wt),w(_,It),w(_,ht),w(ht,Z),w(Z,et),w(Z,G),w(ht,it),w(ht,Xt),w(_,gt),w(_,zt),w(zt,Nt),w(Nt,bt),w(zt,Kt),w(zt,oe),w(oe,st),w(_,se),w(_,Ot),w(e,Bt),w(e,Gt),w(Gt,ee),w(ee,he),w(he,Je),w(he,Ze),w(he,qt),w(qt,He),w(qt,Ve),w(qt,ze),w(ze,Vt),w(Vt,ue),w(ze,ve),w(ze,Qt),w(Qt,di),w(qt,ri),w(qt,Ie),w(Ie,Zt),w(Zt,Me),w(Ie,Qe),w(Ie,fi),w(qt,ai),w(qt,qe),w(qe,Oe),w(Oe,Ae),w(qe,li),w(qe,$t),w($t,ie),w($t,ii),w(ee,ni),w(ee,$e),w($e,Ei),w($e,Bi),w($e,Ue),Ii.m(Ue,null),w($e,kt),bi&&bi.m($e,null),w(ee,gi),w(ee,ci),w(ci,ti),w(ti,vi),w(vi,b),w(ti,mt),w(ti,Et),w(ti,Pt),w(ti,xt),w(ci,A),Zi.m(ci,null),w(Gt,de),w(Gt,te),w(te,ge),w(ge,Xe),re(We,Xe,null),i[92](Xe),w(ge,Ci),w(ge,Pi),w(ge,sn),w(ge,Vi),w(Vi,xi),i[93](xi),i[94](Vi),w(e,Ji),wi&&wi.m(e,null),w(e,rn),Si&&Si.m(e,null),w(e,vt),w(e,Rt),w(Rt,ne),w(ne,_i),w(ne,zi),w(ne,Fe),w(Fe,fe),w(Fe,Ht),w(Fe,ye),w(Fe,hn),w(Fe,Ai),w(Rt,yi),w(Rt,Qi),M.m(Qi,null),J(D,Ni,dt),H&&H.m(D,dt),J(D,Ne,dt),je=!0,Yi||($i=[ft(n,"click",i[51]),ft(y,"click",i[41]),ft(O,"click",i[68]),ft($,"click",i[69]),ft(rt,"click",i[58]),ft(tt,"click",i[74]),ft(K,"click",i[53]),ft(X,"click",i[64]),ft(Dt,"click",i[65]),ft(wt,"click",i[66]),ft(ht,"click",i[67]),ft(zt,"click",i[75]),ft(Ot,"click",i[42]),ft(He,"click",i[42]),ft(ze,"click",i[41]),ft(Ie,"click",i[53]),ft(qe,"click",i[76]),ft(xt,"click",i[60]),ft(Pi,"mousedown",i[49]),ft(fe,"click",i[114]),ft(ye,"click",i[115]),ft(Ai,"click",i[116])],Yi=!0)},p(D,dt){if(dt[0]&256){Ri=ke(D[8]);let St;for(St=0;St<Ri.length;St+=1){const hi=Ta(D,Ri,St);Ke[St]?Ke[St].p(hi,dt):(Ke[St]=xa(hi),Ke[St].c(),Ke[St].m(_,g))}for(;St<Ke.length;St+=1)Ke[St].d(1);Ke.length=Ri.length}(!je||dt[0]&4096&&x!==(x=D[12]?"Runningâ€¦":"Run pipeline"))&&p(y,"title",x),(!je||dt[0]&4096)&&(y.disabled=D[12]),(!je||dt[0]&2097152&&me!==(me=D[21]?"3D mode ON":"3D mode OFF"))&&p(ht,"title",me),(!je||dt[0]&2097152)&&jt(ht,"primary",D[21]),(!je||dt[0]&1)&&pe!==(pe=D[0]==="dark"?"Dark":"Light")&&pi(st,pe),(!je||dt[0]&4096)&&Ye!==(Ye=D[12]?"Runningâ€¦":"Run")&&pi(di,Ye),(!je||dt[0]&4096)&&(ze.disabled=D[12]),(!je||dt[0]&1)&&pi(ii,D[0]),un===(un=Ln(D))&&Ii?Ii.p(D,dt):(Ii.d(1),Ii=un(D),Ii&&(Ii.c(),Ii.m(Ue,null))),D[9]?bi?bi.p(D,dt):(bi=Ia(D),bi.c(),bi.m($e,null)):bi&&(bi.d(1),bi=null),an===(an=kn(D))&&Zi?Zi.p(D,dt):(Zi.d(1),Zi=an(D),Zi&&(Zi.c(),Zi.m(ci,null))),(!je||dt[0]&8192&&Yt!==(Yt=D[13]?"true":"false"))&&p(ee,"data-collapsed",Yt);const Mt={};dt[0]&65536&&(Mt.width=D[16]),dt[0]&131072&&(Mt.height=D[17]),dt[0]&1&&(Mt.theme=D[0]),dt[0]&214558|dt[5]&524288&&(Mt.$$scope={dirty:dt,ctx:D}),We.$set(Mt),(!je||dt[0]&262144)&&lt(Xe,"width",D[18]+"%"),(!je||dt[0]&8192&&Ti!==(Ti=D[13]?"true":"false"))&&p(Gt,"data-collapsed",Ti),D[22]?wi?wi.p(D,dt):(wi=Ha(D),wi.c(),wi.m(e,rn)):wi&&(wi.d(1),wi=null),D[27]?Si?Si.p(D,dt):(Si=qa(D),Si.c(),Si.m(e,vt)):Si&&(Si.d(1),Si=null),Oi===(Oi=Wt(D))&&M?M.p(D,dt):(M.d(1),M=Oi(D),M&&(M.c(),M.m(Qi,null))),(!je||dt[0]&16&&qi!==(qi=D[4]?"true":"false"))&&p(Rt,"data-open",qi),D[7]?H?H.p(D,dt):(H=ja(D),H.c(),H.m(Ne.parentNode,Ne)):H&&(H.d(1),H=null)},i(D){je||(B(We.$$.fragment,D),je=!0)},o(D){U(We.$$.fragment,D),je=!1},d(D){D&&(Y(e),Y(Ni),Y(Ne)),Sn(Ke,D),Ii.d(),bi&&bi.d(),Zi.d(),ae(We),i[92](null),i[93](null),i[94](null),wi&&wi.d(),Si&&Si.d(),M.d(),H&&H.d(D),Yi=!1,si($i)}}}const kl=230,Ml=80,Ef=10,Va=10,Cf=3.5;function Tf(i){const e=[];if(!i||typeof i!="object")return e;for(const[o,r]of Object.entries(i))typeof r=="string"?e.push({key:o,label:o,type:"string"}):typeof r=="number"?e.push({key:o,label:o,type:"number"}):typeof r=="boolean"?e.push({key:o,label:o,type:"boolean"}):Array.isArray(r)?e.push({key:o,label:o,type:"array",itemType:typeof r[0]=="number"?"number":"string"}):e.push({key:o,label:o,type:"textarea"});return e}function Sf(i,e){const o=i.map(u=>u.id),r=new Set(o),n=new Map,a=new Map;for(const u of o)n.set(u,[]),a.set(u,0);for(const u of e)!r.has(u.source)||!r.has(u.target)||(n.get(u.source).push(u.target),a.set(u.target,(a.get(u.target)||0)+1));const l=[];for(const u of o)(a.get(u)||0)===0&&l.push(u);const h=[];for(;l.length;){const u=l.shift();h.push(u);for(const f of n.get(u))a.set(f,(a.get(f)||0)-1),(a.get(f)||0)===0&&l.push(f)}return h}async function Ya(i,e={}){return await(await fetch("/run_node",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nodeId:i.id,type:i.type,args:i.args??{},inputs:e})})).json().catch(()=>({ok:!1,error:"Bad JSON"}))}function Xa(i){return i.rows??6}function Ka(i){return i.placeholder??""}function Ja(i){return i.hint??"comma-separated"}function Qa(i){return i.itemType??"values"}function $a(i){return i.options??[]}function tl(i){return i?new Date(i).toLocaleString():"â€”"}async function Df(i){await fetch(`/pipeline/schedules/${i}/run-now`,{method:"POST"}).catch(()=>{})}function xf(i,e,o){let r="dark",n="",a="info",l=!1;function h(M,H="info"){o(5,n=M),o(6,a=H),o(7,l=!0),setTimeout(()=>{o(7,l=!1)},3e3)}wc({api:{fetch:async(M,H)=>{const D=(M.startsWith("http"),M);return fetch(D,H)}},jobs:{run:async(M,H)=>{try{await H(D=>{console.log(`${M}: ${D}%`)})}catch(D){h(`Job failed: ${(D==null?void 0:D.message)||D}`,"error")}}},commands:{execute:async M=>{try{await M.do()}catch(H){h(`Command failed: ${(H==null?void 0:H.message)||H}`,"error")}}},layers:{addFromId:M=>{console.log("addFromId:",M)},remove:M=>{console.log("remove layer:",M)},getSelected:()=>[],firstRaster:()=>null},selection:{firstRaster:()=>null},toast:{info:M=>h(M,"info"),success:M=>h(M,"success"),error:M=>h(M,"error")},entitlements:{has:M=>!0},theme:r});let f=[],_=[],g=1,y=[],k=1,P=null,C={},S=[{name:"hello",default_args:{name:"world"}},{name:"sum",default_args:{nums:[1,2,3]}},{name:"script",default_args:{code:"print('hello')"}},{name:"raster.input",default_args:{path:""}}];Ki(async()=>{try{const H=await(await fetch("/node_types")).json();Array.isArray(H==null?void 0:H.types)&&o(10,S=H.types)}catch{}});const x={hello:[{key:"name",label:"Name",type:"string",placeholder:"world"}],sum:[{key:"nums",label:"Numbers",type:"array",itemType:"number",hint:"e.g., 1,2,3"}],script:[{key:"code",label:"Code",type:"textarea",rows:8,placeholder:"print('hello')"}],"raster.input":[{key:"path",label:"Raster path",type:"string",placeholder:"/path/to.tif"}]};function z(M){var dt;const H=x[M];if(H)return H;const D=(dt=S.find(Mt=>Mt.name===M))==null?void 0:dt.default_args;return Tf(D??{})}const O=M=>_.find(H=>H.id===M);function W(M,H){!O(M)||!O(H)||M===H||y.some(D=>D.source===M&&D.target===H)||o(2,y=[...y,{id:`e${k++}`,source:M,target:H}])}function $(M){o(2,y=y.filter(H=>H.id!==M))}function Q(M){if(Kt.has(M)&&bt&&oe){const H=Kt.get(M);bt.removeLayer(H),oe.removeLayer(H),Kt.delete(M)}o(1,_=_.filter(H=>H.id!==M)),delete C[M]}function rt(){const M=new Set;for(const Mt of y)M.add(Mt.source),M.add(Mt.target);const H=_.filter(Mt=>M.has(Mt.id)),D=new Set(H.map(Mt=>Mt.id)),dt=y.filter(Mt=>D.has(Mt.source)&&D.has(Mt.target));return{activeNodes:H,activeEdges:dt}}let ot=[],tt=!1,at={},K=!1,N=!1;function F(M,H,D){o(11,ot=[...ot,{nodeId:M,ok:H,text:D}]),K&&requestAnimationFrame(()=>{const dt=document.querySelector(".logs-body");dt&&(dt.scrollTop=dt.scrollHeight)})}async function j(){var Mt;o(12,tt=!0),o(11,ot=[]),at={},o(4,K=!0);const{activeNodes:M,activeEdges:H}=rt();if(M.length===0){F("system",!1,"No connected nodes to run."),o(12,tt=!1);return}const D=Sf(M,H);D.length!==M.length&&F("system",!1,"Warning: cycle detected; running partial order.");const dt={};for(const St of H)(dt[Mt=St.target]??(dt[Mt]=[])).push(St.source);for(const St of D){const hi=O(St),Pe={};for(const Ct of dt[St]??[])Pe[Ct]=at[Ct];F(St,!0,"â–¶ Runningâ€¦");try{const Ct=await Ya(hi,Pe);if(Array.isArray(Ct==null?void 0:Ct.logs))for(const Be of Ct.logs)F(St,!0,String(Be));if(typeof(Ct==null?void 0:Ct.stdout)=="string"&&Ct.stdout.trim())for(const Be of Ct.stdout.split(/\r?\n/))Be.trim()&&F(St,!0,Be);if(Ct!=null&&Ct.ok){const Be=Ct.output??{};at[St]=Be;const Ui=typeof Be=="string"?Be:Be.text??JSON.stringify(Be);F(St,!0,`âœ… ${Ui}`)}else F(St,!1,`âŒ ${(Ct==null?void 0:Ct.error)||"Unknown error"}`)}catch(Ct){F(St,!1,`âŒ Exception: ${(Ct==null?void 0:Ct.message)||Ct}`)}}o(12,tt=!1)}function _t(){const M=`n${g++}`,H=S[0]||{name:"hello",default_args:{name:M}},D=120+_.length%6*260,dt=140+Math.floor(_.length/6)*140,Mt=JSON.parse(JSON.stringify(H.default_args||{})),St=`${H.name} (${M})`;o(1,_=[..._,{id:M,position:{x:D,y:dt},label:St,type:H.name,args:Mt}]),o(3,C[M]=JSON.stringify(Mt,null,2),C)}function pt(M){o(9,P=M)}function X(M){P&&W(P,M),o(9,P=null)}function q(){o(9,P=null)}const Dt=M=>M.position.x,ut=M=>M.position.x+kl,wt=M=>M.position.y+Ml/2;let It="",ht=null,Z=1200,et=650,G=null;function it(){ht&&(G&&G.disconnect(),G=new ResizeObserver(()=>{ht&&(o(16,Z=Math.max(320,Math.floor(ht.clientWidth-1))),o(17,et=Math.max(240,Math.floor(ht.clientHeight-1))))}),G.observe(ht))}let Xt=60,me=!1;function gt(M){me=!0,M.preventDefault()}function zt(M){if(!me||!ht||!ht.parentElement)return;const D=ht.parentElement.getBoundingClientRect(),dt=M.clientX-D.left,Mt=Math.max(20,Math.min(80,dt/D.width*100));o(18,Xt=Mt)}function Nt(){me=!1}Ki(()=>(window.addEventListener("mousemove",zt),window.addEventListener("mouseup",Nt),()=>{window.removeEventListener("mousemove",zt),window.removeEventListener("mouseup",Nt)}));let bt=null,Kt=new Map,oe=null,pe=null,st=null,se=null,Ot=null,Bt=null,Gt=!1,ee=null,he=null;const Je={r:100,g:100,b:120};function Ze(){!bt||!st||(se&&se.disconnect(),se=new ResizeObserver(()=>{requestAnimationFrame(()=>bt&&bt.invalidateSize())}),se.observe(st))}function qt(){o(13,N=!N),requestAnimationFrame(()=>bt==null?void 0:bt.invalidateSize())}Ki(()=>{let M=!1;const H=()=>bt&&bt.invalidateSize();return Promise.resolve().then(async()=>{if(await cl(),!M&&(it(),!bt&&pe)){bt=Fi.map(pe,{zoomControl:!0,attributionControl:!1}).setView([0,0],2);const D={"ðŸ—ºï¸ OpenStreetMap":Fi.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{opacity:.9,minZoom:1,maxZoom:22,attribution:"Â© OpenStreetMap contributors"}),"ðŸŒŒ OSM (Dark-ish)":Fi.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",{opacity:.95,minZoom:1,maxZoom:22,attribution:"Â© OpenStreetMap, Â© CartoDB"}),"ðŸ›°ï¸ Esri World Imagery":Fi.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{opacity:1,minZoom:1,maxZoom:19,attribution:"Tiles Â© Esri"}),"ðŸ—ºï¸ Carto Positron":Fi.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{opacity:.95,minZoom:1,maxZoom:22,attribution:"Â© OpenStreetMap, Â© CartoDB"}),"â›°ï¸ OpenTopoMap":Fi.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{opacity:.95,minZoom:1,maxZoom:17,attribution:"Â© OpenStreetMap, Â© OpenTopoMap"})};D["ðŸ›°ï¸ Esri World Imagery"].addTo(bt),oe=Fi.control.layers(D,{},{position:"topright",collapsed:!1}),oe.addTo(bt),Ot=new Fi.FeatureGroup,bt.addLayer(Ot),Bt=new Fi.Control.Draw({edit:{featureGroup:Ot},draw:{polygon:!0,polyline:!0,rectangle:!0,circle:!0,marker:!0,circlemarker:!1}}),bt.addControl(Bt),bt.on(Fi.Draw.Event.CREATED,dt=>{const Mt=dt.layer;Ot==null||Ot.addLayer(Mt),F("vector",!0,`Created ${dt.layerType}`)}),Ze(),window.addEventListener("resize",H)}}),()=>{M=!0,window.removeEventListener("resize",H),se==null||se.disconnect(),G==null||G.disconnect()}});function He(M,H){var dt;const D=at[M.id];return D&&typeof D=="object"&&D.type==="raster"&&D.path?D.path:M.type==="raster.input"&&typeof((dt=_[H].args)==null?void 0:dt.path)=="string"?_[H].args.path:null}async function Ve(M,H){if(!bt||!oe){alert("Map not ready yet.");return}const D=He(M,H);if(!D){alert("No raster path available. Run the pipeline or set args.path for raster.input.");return}const dt=M.id;await fetch("/preview/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:dt,path:D})});const Mt=`/preview/tile/${dt}/{z}/{x}/{y}.png`,St=`${M.label} (${M.id})`;if(Kt.has(dt)){const Pe=Kt.get(dt);bt.removeLayer(Pe),oe.removeLayer(Pe),Kt.delete(dt)}const hi=Fi.tileLayer(Mt,{tms:!1,opacity:.8,maxZoom:22});Kt.set(dt,hi),hi.addTo(bt),oe.addOverlay(hi,St);try{const Pe=await fetch(`/preview/bounds/${dt}`).then(Dn=>Dn.json()),[Ct,Be,Ui,dn]=Pe.bounds,Nn=Fi.latLngBounds([Be,Ct],[dn,Ui]);bt.fitBounds(Nn,{padding:[10,10],animate:!0})}catch(Pe){console.warn("Failed to get bounds for zoom:",Pe)}}function ze(){if(!(!bt||!oe)){for(const[,M]of Kt)bt.removeLayer(M),oe.removeLayer(M);Kt.clear()}}let Vt=null,ue="",ve=[],Qt={},Ye=!1;function di(M){var dt;o(22,Vt=M),o(24,ve=z(M.type)),o(25,Qt={});const D={...((dt=S.find(Mt=>Mt.name===M.type))==null?void 0:dt.default_args)??{},...M.args??{}};for(const Mt of ve)o(25,Qt[Mt.key]=D[Mt.key],Qt);o(23,ue=JSON.stringify(M.args??{},null,2)),o(26,Ye=!1)}function ri(){if(!Vt)return;const M={};for(const H of ve){let D=Qt[H.key];if(H.type==="number"&&(D=Number(D)),H.type==="array"){if(Array.isArray(D))M[H.key]=D;else if(typeof D=="string"){const dt=D.split(",").map(Mt=>Mt.trim()).filter(Boolean);M[H.key]=H.itemType==="number"?dt.map(Number):dt}else M[H.key]=[];continue}H.type==="boolean"&&(D=!!D),M[H.key]=D}o(22,Vt.args=M,Vt),o(3,C[Vt.id]=JSON.stringify(M,null,2),C)}function Ie(){if(Vt)if(Ye)try{const M=JSON.parse(ue||"{}");o(22,Vt.args=M,Vt),o(3,C[Vt.id]=JSON.stringify(M,null,2),C),o(22,Vt=null)}catch{alert("Invalid JSON")}else ri(),o(22,Vt=null)}const Zt=M=>{const H=_.find(D=>D.id===M);if(!H)throw new Error(`Node not found: ${M}`);return H};let Me=null;async function Qe(M){o(4,K=!0),o(11,ot=[]),await fi(M),Me&&clearInterval(Me),o(70,Me=setInterval(()=>fi(M),1e3))}async function fi(M){try{const H=await fetch(`/pipeline/schedules/${M}/runs`).then(Mt=>Mt.json());if(!Array.isArray(H)||H.length===0){o(11,ot=[{nodeId:"system",ok:!0,text:"(no runs yet)"}]);return}const D=H[0],dt=await fetch(`/pipeline/schedules/runs/${D.id}`).then(Mt=>Mt.json());o(11,ot=dt.logs.map(Mt=>({nodeId:dt.status==="running"?"run":dt.status==="success"?"ok":"err",ok:!/âŒ|exception/i.test(Mt),text:Mt}))),dt.status!=="running"&&Me&&(clearInterval(Me),o(70,Me=null))}catch{o(11,ot=[{nodeId:"system",ok:!1,text:"Failed to fetch run logs"}])}}co(()=>{Me&&clearInterval(Me)});let ai=!1,qe="once",Oe="",Ae=0,li=0,$t=0,ie="0 5 * * *",ii=!1,ni="",$e=[];function Ei(){const{activeNodes:M}=rt();if(M.length===0){alert("No connected nodes to schedule. Connect nodes with edges first.");return}o(27,ai=!0),o(28,qe="once"),o(29,Oe=""),o(30,Ae=o(31,li=o(32,$t=0))),o(33,ie="0 5 * * *"),o(35,ni="")}function Bi(){const{activeNodes:M,activeEdges:H}=rt(),D=M.map(Mt=>({id:Mt.id,type:Mt.type,args:Mt.args??{}})),dt=H.map(Mt=>({source:Mt.source,target:Mt.target}));return{nodes:D,edges:dt}}async function Ue(){const M=Bi();if(M.nodes.length===0){o(35,ni="Nothing to schedule (empty graph).");return}const H={mode:qe,graph:M};if(qe==="once"){if(!Oe){o(35,ni="Please pick a date & time.");return}H.run_at=new Date(Oe).toISOString()}else if(qe==="interval"){if(H.hours=Number(Ae)||0,H.minutes=Number(li)||0,H.seconds=Number($t)||0,!(H.hours||H.minutes||H.seconds)){o(35,ni="Interval must be > 0.");return}}else if(H.cron=(ie||"").trim(),!H.cron){o(35,ni="Cron expression is required.");return}o(34,ii=!0),o(35,ni="");try{const D=await fetch("/pipeline/schedules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(H)});if(!D.ok)throw new Error(`HTTP ${D.status}`);await D.json(),o(27,ai=!1),await kt()}catch(D){o(35,ni=`Failed to create schedule: ${(D==null?void 0:D.message)||D}`)}finally{o(34,ii=!1)}}async function kt(){try{const M=await fetch("/pipeline/schedules");if(M.ok){o(36,$e=await M.json());return}}catch{}try{const M=await fetch("/schedules");M.ok&&o(36,$e=await M.json())}catch{}}async function gi(M){await fetch(`/pipeline/schedules/${M}`,{method:"DELETE"}).catch(()=>{}),await kt()}async function ci(M){await fetch(`/pipeline/schedules/${M}/pause`,{method:"POST"}).catch(()=>{}),await kt()}async function ti(M){await fetch(`/pipeline/schedules/${M}/resume`,{method:"POST"}).catch(()=>{}),await kt()}Ki(async()=>{await kt().catch(()=>{})});async function vi(){const M=document.createElement("input");M.type="file",M.accept=".zip",M.onchange=async H=>{var dt,Mt;const D=(dt=H.target.files)==null?void 0:dt[0];if(D)try{const St=new FormData;St.append("file",D);const hi=await fetch("/vector/upload",{method:"POST",body:St});if(!hi.ok)throw new Error(`HTTP ${hi.status}`);const Pe=await hi.json();if(bt&&Ot){const Ct=Fi.geoJSON(Pe,{style:{color:"#3388ff",weight:2,opacity:.8,fillOpacity:.3}});Ct.eachLayer(Ui=>{Ot==null||Ot.addLayer(Ui)});const Be=Ct.getBounds();Be.isValid()&&bt.fitBounds(Be,{padding:[20,20]}),F("vector",!0,`Loaded shapefile with ${((Mt=Pe.features)==null?void 0:Mt.length)||0} features`),o(4,K=!0)}}catch(St){const hi=St instanceof Error?St.message:String(St);alert(`Failed to load shapefile: ${hi}`),F("vector",!1,`Failed to load shapefile: ${hi}`),o(4,K=!0)}},M.click()}async function b(){if(!Ot||Ot.getLayers().length===0){alert("No vector data to save. Draw some features on the map first.");return}try{const M=Ot.toGeoJSON(),H=prompt("Enter filename (without extension):","vector_data");if(!H)return;const D=await fetch("/vector/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({geojson:M,filename:H})});if(!D.ok)throw new Error(`HTTP ${D.status}`);const dt=await D.blob(),Mt=URL.createObjectURL(dt),St=document.createElement("a");St.href=Mt,St.download=`${H}.zip`,St.click(),URL.revokeObjectURL(Mt),F("vector",!0,`Saved ${Ot.getLayers().length} features as shapefile`),o(4,K=!0)}catch(M){const H=M instanceof Error?M.message:String(M);alert(`Failed to save shapefile: ${H}`),F("vector",!1,`Failed to save shapefile: ${H}`),o(4,K=!0)}}function mt(){Ot&&(Ot.clearLayers(),F("vector",!0,"Cleared all vector data"),o(4,K=!0))}function Et(){if(bt)if(o(21,Gt=!Gt),Gt){const M=bt.getZoom();ee=Fi.tileLayer("https://tiles.wmflabs.org/hillshading/{z}/{x}/{y}.png",{opacity:.4,maxZoom:18,attribution:"Â© OpenStreetMap contributors, Hillshading: Colin Marquardt"}),ee.addTo(bt),M>=15&&Pt(),bt.on("moveend",Pt),F("3d",!0,"3D mode enabled - Terrain hillshading and buildings layer active"),o(4,K=!0)}else ee&&bt&&(bt.removeLayer(ee),ee=null),he&&bt&&(bt.removeLayer(he),he=null),bt.off("moveend",Pt),F("3d",!0,"3D mode disabled"),o(4,K=!0)}async function Pt(){if(!bt||!Gt||bt.getZoom()<15)return;const H=bt.getBounds(),D=`${H.getSouth()},${H.getWest()},${H.getNorth()},${H.getEast()}`;try{const dt=`[out:json][timeout:${Ef}];(way["building"](${D}););out geom;`,Mt=`https://overpass-api.de/api/interpreter?data=${encodeURIComponent(dt)}`,St=await fetch(Mt);if(!St.ok)return;const hi=await St.json();he&&bt&&(bt.removeLayer(he),he=null);const Pe=hi.elements.filter(Ct=>Ct.type==="way").map(Ct=>{var dn,Nn;const Be=Ct.geometry.map(Dn=>[Dn.lon,Dn.lat]);let Ui=Va;return(dn=Ct.tags)!=null&&dn.height&&parseFloat(Ct.tags.height)>0?Ui=parseFloat(Ct.tags.height):(Nn=Ct.tags)!=null&&Nn["building:levels"]&&parseInt(Ct.tags["building:levels"])>0&&(Ui=parseInt(Ct.tags["building:levels"])*Cf),{type:"Feature",properties:{height:Ui},geometry:{type:"Polygon",coordinates:[Be]}}});Pe.length>0&&(he=Fi.geoJSON({type:"FeatureCollection",features:Pe},{style:Ct=>{var dn;const Be=((dn=Ct==null?void 0:Ct.properties)==null?void 0:dn.height)||Va,Ui=Math.max(.3,Math.min(1,Be/50));return{fillColor:`rgba(${Je.r}, ${Je.g}, ${Je.b}, ${Ui})`,color:"#444",weight:1,fillOpacity:.7,className:"buildings-3d"}}}),he.addTo(bt))}catch(dt){console.warn("Failed to fetch buildings:",dt)}}function xt(){const M={nodes:_.map(St=>({id:St.id,position:St.position,label:St.label,type:St.type,args:St.args})),edges:y.map(St=>({id:St.id,source:St.source,target:St.target}))},H=JSON.stringify(M,null,2),D=new Blob([H],{type:"application/json"}),dt=URL.createObjectURL(D),Mt=document.createElement("a");Mt.href=dt,Mt.download=`saterys-workflow-${new Date().toISOString().replace(/:/g,"-").split(".")[0]}.json`,Mt.click(),URL.revokeObjectURL(dt)}function A(){const M=document.createElement("input");M.type="file",M.accept=".json",M.onchange=async H=>{var dt;const D=(dt=H.target.files)==null?void 0:dt[0];if(D)try{const Mt=await D.text(),St=JSON.parse(Mt);if(!St.nodes||!Array.isArray(St.nodes)){alert("Invalid workflow file: missing nodes array");return}o(1,_=[]),o(2,y=[]),o(3,C={}),ze(),o(1,_=St.nodes.map(Pe=>({id:Pe.id||`n${g++}`,position:Pe.position||{x:100,y:100},label:Pe.label||"unknown",type:Pe.type||"hello",args:Pe.args||{}}))),g=Math.max(..._.map(Pe=>{const Ct=Pe.id.match(/^n(\d+)$/);return Ct?parseInt(Ct[1]):0}),0)+1,St.edges&&Array.isArray(St.edges)&&(o(2,y=St.edges.map(Ct=>({id:Ct.id||`e${k++}`,source:Ct.source,target:Ct.target}))),k=Math.max(...y.map(Ct=>{const Be=Ct.id.match(/^e(\d+)$/);return Be?parseInt(Be[1]):0}),0)+1);for(const Pe of _)o(3,C[Pe.id]=JSON.stringify(Pe.args||{},null,2),C);F("system",!0,`Loaded workflow with ${_.length} nodes and ${y.length} edges`),o(4,K=!0)}catch(Mt){alert(`Failed to load workflow: ${Mt instanceof Error?Mt.message:String(Mt)}`)}},M.click()}function Yt(M){ei.call(this,i,M)}function de(M){ei.call(this,i,M)}const te=M=>M.run(nl()),ge=()=>o(4,K=!K),Xe=()=>o(0,r=r==="dark"?"light":"dark"),We=()=>o(0,r=r==="dark"?"light":"dark"),Ci=M=>$(M.id),Pi=M=>{Df(M.id),Qe(M.id)},sn=M=>ci(M.id),Vi=M=>ti(M.id),xi=M=>Qe(M.id),Ti=M=>gi(M.id),Ji=M=>X(M.id),rn=M=>pt(M.id),vt=M=>Q(M.id);function Rt(M){_[M].type=Vo(this),o(1,_),o(10,S)}const ne=(M,H)=>{const D=S.find(Mt=>Mt.name===_[M].type),dt=(D==null?void 0:D.default_args)??{};o(1,_[M].args=JSON.parse(JSON.stringify(dt)),_),o(1,_[M].label=`${_[M].type} (${H.id})`,_),o(3,C[H.id]=JSON.stringify(_[M].args,null,2),C)},_i=M=>di(M),zi=(M,H)=>Ve(M,H),Fe=async M=>{var H;try{const D=await Ya(M,{});o(4,K=!0),F(M.id,!!(D!=null&&D.ok),D!=null&&D.ok?((H=D==null?void 0:D.output)==null?void 0:H.message)||"Started":(D==null?void 0:D.error)||"Error")}catch(D){F(M.id,!1,`Exception: ${typeof D=="object"&&D!==null&&"message"in D?D.message:String(D)}`),o(4,K=!0)}};function fe(M,H){i.$$.not_equal(_[H].position,M)&&(_[H].position=M,o(1,_))}function Ht(M){on[M?"unshift":"push"](()=>{ht=M,o(15,ht)})}function ye(M){on[M?"unshift":"push"](()=>{pe=M,o(19,pe)})}function hn(M){on[M?"unshift":"push"](()=>{st=M,o(20,st)})}const Ai=()=>o(22,Vt=null),yi=()=>o(26,Ye=!1),Qi=()=>o(26,Ye=!0);function qi(M){Qt[M.key]=this.value,o(25,Qt),o(24,ve)}function Ni(M){Qt[M.key]=Cn(this.value),o(25,Qt),o(24,ve)}function Ne(M){Qt[M.key]=this.checked,o(25,Qt),o(24,ve)}function je(M){Qt[M.key]=this.value,o(25,Qt),o(24,ve)}function Yi(M){Qt[M.key]=this.value,o(25,Qt),o(24,ve)}function $i(M){Qt[M.key]=Vo(this),o(25,Qt),o(24,ve)}function Ri(){ue=this.value,o(23,ue)}const Ke=()=>o(22,Vt=null),Ln=()=>o(27,ai=!1);function un(){qe=Vo(this),o(28,qe)}function Ii(){Oe=this.value,o(29,Oe)}function bi(){Ae=Cn(this.value),o(30,Ae)}function kn(){li=Cn(this.value),o(31,li)}function an(){$t=Cn(this.value),o(32,$t)}function Zi(){ie=this.value,o(33,ie)}const wi=()=>o(27,ai=!1),Si=()=>navigator.clipboard.writeText(ot.map(M=>`[${M.nodeId}] ${M.ok?"OK":"ERR"} ${M.text}`).join(`
`)),Wt=()=>o(11,ot=[]),Oi=()=>o(4,K=!1);return i.$$.update=()=>{if(i.$$.dirty[0]&1&&document!=null&&document.body&&(document.body.dataset.theme=r),i.$$.dirty[0]&10){for(const M of _)if(C[M.id]===void 0)try{o(3,C[M.id]=JSON.stringify(M.args??{},null,2),C)}catch{o(3,C[M.id]="{}",C)}}if(i.$$.dirty[0]&6){const M=new Set(_.map(D=>D.id)),H=y.filter(D=>M.has(D.source)&&M.has(D.target));H.length!==y.length&&o(2,y=H)}i.$$.dirty[0]&2&&o(14,It=_.map(M=>`${M.id}:${M.position.x},${M.position.y}`).join("|")),i.$$.dirty[0]&16|i.$$.dirty[2]&256&&!K&&Me&&(clearInterval(Me),o(70,Me=null))},o(8,f=bc()),[r,_,y,C,K,n,a,l,f,P,S,ot,tt,N,It,ht,Z,et,Xt,pe,st,Gt,Vt,ue,ve,Qt,Ye,ai,qe,Oe,Ae,li,$t,ie,ii,ni,$e,O,$,Q,F,j,_t,pt,X,q,Dt,ut,wt,gt,Kt,qt,Ve,ze,di,Ie,Zt,Qe,Ei,Ue,kt,gi,ci,ti,vi,b,mt,Et,xt,A,Me,Yt,de,te,ge,Xe,We,Ci,Pi,sn,Vi,xi,Ti,Ji,rn,vt,Rt,ne,_i,zi,Fe,fe,Ht,ye,hn,Ai,yi,Qi,qi,Ni,Ne,je,Yi,$i,Ri,Ke,Ln,un,Ii,bi,kn,an,Zi,wi,Si,Wt,Oi]}class zf extends Mi{constructor(e){super(),ki(this,e,xf,Pf,ui,{},null,[-1,-1,-1,-1,-1,-1])}}new zf({target:document.getElementById("app")});export{co as $,ae as A,ul as B,dl as C,re as D,ce as E,Lt as F,si as G,pi as H,nn as I,Re as J,Jo as K,Ee as L,Te as M,Se as N,Ce as O,tr as P,ji as Q,_h as R,Mi as S,Ge as T,Cn as U,Vn as V,Xi as W,On as X,Vo as Y,nt as Z,on as _,lt as a,So as a0,Jt as a1,pn as a2,zo as a3,J as b,p as c,Y as d,T as e,yt as f,mi as g,ke as h,ki as i,U as j,B as k,ft as l,we as m,Ft as n,Ki as o,ao as p,Le as q,w as r,ui as s,jt as t,wn as u,V as v,_e as w,Io as x,De as y,cs as z};
