const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Controls-3r3r0iOH.js","assets/Icon-c1yk_MDd.js","assets/DrawerController-IAzRTCF_.js","assets/DrawerController-ZXfKNTdC.css"])))=>i.map(i=>d[i]);
var cu=Object.defineProperty;var hu=(n,e,i)=>e in n?cu(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i;var Fo=(n,e,i)=>hu(n,typeof e!="symbol"?e+"":e,i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function i(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=i(r);fetch(r.href,a)}})();function Gt(){}function ss(n,e){for(const i in e)n[i]=e[i];return n}function Kl(n){return n()}function Vs(){return Object.create(null)}function $e(n){n.forEach(Kl)}function no(n){return typeof n=="function"}function un(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function fu(n){return Object.keys(n).length===0}function fn(n,...e){if(n==null){for(const s of e)s(void 0);return Gt}const i=n.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function wt(n){let e;return fn(n,i=>e=i)(),e}function pt(n,e,i){n.$$.on_destroy.push(fn(e,i))}function Ce(n,e,i,s){if(n){const r=Jl(n,e,i,s);return n[0](r)}}function Jl(n,e,i,s){return n[1]&&s?ss(i.ctx.slice(),n[1](s(e))):i.ctx}function Se(n,e,i,s){if(n[2]&&s){const r=n[2](s(i));if(e.dirty===void 0)return r;if(typeof r=="object"){const a=[],u=Math.max(e.dirty.length,r.length);for(let c=0;c<u;c+=1)a[c]=e.dirty[c]|r[c];return a}return e.dirty|r}return e.dirty}function Me(n,e,i,s,r,a){if(r){const u=Jl(e,i,s,a);n.p(u,r)}}function Te(n){if(n.ctx.length>32){const e=[],i=n.ctx.length/32;for(let s=0;s<i;s++)e[s]=-1;return e}return-1}function rs(n){const e={};for(const i in n)e[i]=!0;return e}function Xs(n){return n??""}function Bt(n,e,i){return n.set(i),e}function pi(n){return n&&no(n.destroy)?n.destroy:Gt}const du=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function y(n,e){n.appendChild(e)}function G(n,e,i){n.insertBefore(e,i||null)}function F(n){n.parentNode&&n.parentNode.removeChild(n)}function Li(n,e){for(let i=0;i<n.length;i+=1)n[i]&&n[i].d(e)}function M(n){return document.createElement(n)}function ee(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function re(n){return document.createTextNode(n)}function V(){return re(" ")}function ze(){return re("")}function ht(n,e,i,s){return n.addEventListener(e,i,s),()=>n.removeEventListener(e,i,s)}function jn(n){return function(e){return e.preventDefault(),n.call(this,e)}}function Wn(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function Ji(n){return function(e){e.target===this&&n.call(this,e)}}function m(n,e,i){i==null?n.removeAttribute(e):n.getAttribute(e)!==i&&n.setAttribute(e,i)}function mi(n){return n===""?null:+n}function _u(n){return Array.from(n.childNodes)}function an(n,e){e=""+e,n.data!==e&&(n.data=e)}function Le(n,e){n.value=e??""}function at(n,e,i,s){i==null?n.style.removeProperty(e):n.style.setProperty(e,i,"")}function gi(n,e,i){for(let s=0;s<n.options.length;s+=1){const r=n.options[s];if(r.__value===e){r.selected=!0;return}}(!i||e!==void 0)&&(n.selectedIndex=-1)}function vo(n){const e=n.querySelector(":checked");return e&&e.__value}let yo;function mu(){if(yo===void 0){yo=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{yo=!0}}return yo}function pu(n,e){getComputedStyle(n).position==="static"&&(n.style.position="relative");const s=M("iframe");s.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),s.setAttribute("aria-hidden","true"),s.tabIndex=-1;const r=mu();let a;return r?(s.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",a=ht(window,"message",u=>{u.source===s.contentWindow&&e()})):(s.src="about:blank",s.onload=()=>{a=ht(s.contentWindow,"resize",e),e()}),y(n,s),()=>{(r||a&&s.contentWindow)&&a(),F(s)}}function $t(n,e,i){n.classList.toggle(e,!!i)}function gu(n,e,{bubbles:i=!1,cancelable:s=!1}={}){return new CustomEvent(n,{detail:e,bubbles:i,cancelable:s})}function ii(n,e){return new n(e)}let to;function Qi(n){to=n}function Ci(){if(!to)throw new Error("Function called outside component initialization");return to}function vu(n){Ci().$$.before_update.push(n)}function Hn(n){Ci().$$.on_mount.push(n)}function Ql(n){Ci().$$.after_update.push(n)}function io(n){Ci().$$.on_destroy.push(n)}function Zi(){const n=Ci();return(e,i,{cancelable:s=!1}={})=>{const r=n.$$.callbacks[e];if(r){const a=gu(e,i,{cancelable:s});return r.slice().forEach(u=>{u.call(n,a)}),!a.defaultPrevented}return!0}}function Ie(n,e){return Ci().$$.context.set(n,e),e}function me(n){return Ci().$$.context.get(n)}function Xe(n,e){const i=n.$$.callbacks[e.type];i&&i.slice().forEach(s=>s.call(this,e))}const Oi=[],Xn=[];let Bi=[];const $o=[],$l=Promise.resolve();let ts=!1;function ta(){ts||(ts=!0,$l.then(na))}function ea(){return ta(),$l}function vi(n){Bi.push(n)}function yu(n){$o.push(n)}const Go=new Set;let Ii=0;function na(){if(Ii!==0)return;const n=to;do{try{for(;Ii<Oi.length;){const e=Oi[Ii];Ii++,Qi(e),wu(e.$$)}}catch(e){throw Oi.length=0,Ii=0,e}for(Qi(null),Oi.length=0,Ii=0;Xn.length;)Xn.pop()();for(let e=0;e<Bi.length;e+=1){const i=Bi[e];Go.has(i)||(Go.add(i),i())}Bi.length=0}while(Oi.length);for(;$o.length;)$o.pop()();ts=!1,Go.clear(),Qi(n)}function wu(n){if(n.fragment!==null){n.update(),$e(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(vi)}}function bu(n){const e=[],i=[];Bi.forEach(s=>n.indexOf(s)===-1?e.push(s):i.push(s)),i.forEach(s=>s()),Bi=e}const Po=new Set;let ki;function ve(){ki={r:0,c:[],p:ki}}function ye(){ki.r||$e(ki.c),ki=ki.p}function B(n,e){n&&n.i&&(Po.delete(n),n.i(e))}function q(n,e,i,s){if(n&&n.o){if(Po.has(n))return;Po.add(n),ki.c.push(()=>{Po.delete(n),s&&(i&&n.d(1),s())}),n.o(e)}else s&&s()}function Ae(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Mo(n,e){n.d(1),e.delete(n.key)}function eo(n,e){q(n,1,1,()=>{e.delete(n.key)})}function hi(n,e,i,s,r,a,u,c,f,d,p,g){let k=n.length,b=a.length,P=k;const S={};for(;P--;)S[n[P].key]=P;const z=[],A=new Map,E=new Map,O=[];for(P=b;P--;){const tt=g(r,a,P),J=i(tt);let et=u.get(J);et?O.push(()=>et.p(tt,e)):(et=d(J,tt),et.c()),A.set(J,z[P]=et),J in S&&E.set(J,Math.abs(P-S[J]))}const Z=new Set,Y=new Set;function j(tt){B(tt,1),tt.m(c,p),u.set(tt.key,tt),p=tt.first,b--}for(;k&&b;){const tt=z[b-1],J=n[k-1],et=tt.key,ot=J.key;tt===J?(p=tt.first,k--,b--):A.has(ot)?!u.has(et)||Z.has(et)?j(tt):Y.has(ot)?k--:E.get(et)>E.get(ot)?(Y.add(et),j(tt)):(Z.add(ot),k--):(f(J,u),k--)}for(;k--;){const tt=n[k];A.has(tt.key)||f(tt,u)}for(;b;)j(z[b-1]);return $e(O),z}function ia(n,e){const i={},s={},r={$$scope:1};let a=n.length;for(;a--;){const u=n[a],c=e[a];if(c){for(const f in u)f in c||(s[f]=1);for(const f in c)r[f]||(i[f]=c[f],r[f]=1);n[a]=c}else for(const f in u)r[f]=1}for(const u in s)u in i||(i[u]=void 0);return i}function oa(n){return typeof n=="object"&&n!==null?n:{}}function ku(n,e,i){const s=n.$$.props[e];s!==void 0&&(n.$$.bound[s]=i,i(n.$$.ctx[s]))}function he(n){n&&n.c()}function le(n,e,i){const{fragment:s,after_update:r}=n.$$;s&&s.m(e,i),vi(()=>{const a=n.$$.on_mount.map(Kl).filter(no);n.$$.on_destroy?n.$$.on_destroy.push(...a):$e(a),n.$$.on_mount=[]}),r.forEach(vi)}function ae(n,e){const i=n.$$;i.fragment!==null&&(bu(i.after_update),$e(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function Pu(n,e){n.$$.dirty[0]===-1&&(Oi.push(n),ta(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function mn(n,e,i,s,r,a,u=null,c=[-1]){const f=to;Qi(n);const d=n.$$={fragment:null,ctx:[],props:a,update:Gt,not_equal:r,bound:Vs(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:Vs(),dirty:c,skip_bound:!1,root:e.target||f.$$.root};u&&u(d.root);let p=!1;if(d.ctx=i?i(n,e.props||{},(g,k,...b)=>{const P=b.length?b[0]:k;return d.ctx&&r(d.ctx[g],d.ctx[g]=P)&&(!d.skip_bound&&d.bound[g]&&d.bound[g](P),p&&Pu(n,g)),k}):[],d.update(),p=!0,$e(d.before_update),d.fragment=s?s(d.ctx):!1,e.target){if(e.hydrate){const g=_u(e.target);d.fragment&&d.fragment.l(g),g.forEach(F)}else d.fragment&&d.fragment.c();e.intro&&B(n.$$.fragment),le(n,e.target,e.anchor),na()}Qi(f)}class pn{constructor(){Fo(this,"$$");Fo(this,"$$set")}$destroy(){ae(this,1),this.$destroy=Gt}$on(e,i){if(!no(i))return Gt;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(i),()=>{const r=s.indexOf(i);r!==-1&&s.splice(r,1)}}$set(e){this.$$set&&!fu(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Lu="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Lu);const xi=[];function Co(n,e){return{subscribe:it(n,e).subscribe}}function it(n,e=Gt){let i;const s=new Set;function r(c){if(un(n,c)&&(n=c,i)){const f=!xi.length;for(const d of s)d[1](),xi.push(d,n);if(f){for(let d=0;d<xi.length;d+=2)xi[d][0](xi[d+1]);xi.length=0}}}function a(c){r(c(n))}function u(c,f=Gt){const d=[c,f];return s.add(d),s.size===1&&(i=e(r,a)||Gt),c(n),()=>{s.delete(d),s.size===0&&i&&(i(),i=null)}}return{set:r,update:a,subscribe:u}}function $i(n,e,i){const s=!Array.isArray(n),r=s?[n]:n;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=e.length<2;return Co(i,(u,c)=>{let f=!1;const d=[];let p=0,g=Gt;const k=()=>{if(p)return;g();const P=e(s?d[0]:d,u,c);a?u(P):g=no(P)?P:Gt},b=r.map((P,S)=>fn(P,z=>{d[S]=z,p&=~(1<<S),f&&k()},()=>{p|=1<<S}));return f=!0,k(),function(){$e(b),g(),f=!1}})}function So(){const n=new Map,{subscribe:e,set:i,update:s}=it(n);return{subscribe:e,set:i,update:s,add:(a,u)=>(s(c=>(c.set(u,a),c)),n),get:a=>n.get(a)||null,getAll:()=>Array.from(n.values()),delete:a=>{let u=!1;return s(c=>(c.delete(a),u=!0,c)),u},count:()=>n.size}}function Cu(n){const{id:e,inputs:i,outputs:s,resizable:r,dimensions:a,editable:u,direction:c,zIndex:f,position:d,selectionColor:p,borderWidth:g,edge:k}=n,{bgColor:b,borderColor:P,rotation:S,borderRadius:z,connections:A,textColor:E,locked:O,group:Z}=n,Y=So(),j=(et="self")=>{wt(Y).forEach(ot=>{(et==="self"||wt(ot.direction)===et)&&ot.recalculatePosition()})};return{id:typeof e=="string"&&e.slice(0,2)==="N-"?e:`N-${e}`,position:it({x:(d==null?void 0:d.x)||0,y:(d==null?void 0:d.y)||0}),dimensions:{width:it((a==null?void 0:a.width)||0),height:it((a==null?void 0:a.height)||(a==null?void 0:a.width))},group:it(Z||null),locked:it(O||!1),inputs:it(i),outputs:it(s),recalculateAnchors:j,rotation:it(S||0),moving:it(!1),resizingWidth:it(!1),resizingHeight:it(!1),rotating:it(!1),editable:it(u||!1),resizable:it(r),anchors:Y,zIndex:it(f||2),collapsed:it(!1),edge:k||null,borderRadius:it(z),bgColor:it(b||null),direction:it(c),label:it(n.label||""),borderColor:it(P||null),borderWidth:it(g),selectionColor:it(p||null),textColor:it(E||null),connections:it(A)}}const Su=10,Mu=100,Tu=50,Eu="#000",Au="#fff",zu="12px",Nu=22,Iu=1.4,xu=40;function Ou(n,e){const i=[n,e].sort();return`${i[0]}+${i[1]}`}function Ys(n,e,i){var c,f,d,p,g;const{source:s,target:r}=n,u={id:s.id&&r.id?Ou(s.id,r.id):"cursor",target:n.target,source:n.source,component:e,type:it((i==null?void 0:i.type)||null),color:(i==null?void 0:i.color)||it(null),width:it((i==null?void 0:i.width)||0),animated:it((i==null?void 0:i.animated)||!1),rendered:it(!1),start:(i==null?void 0:i.start)||null,end:(i==null?void 0:i.end)||null};if(i!=null&&i.disconnect&&(u.disconnect=!0),i!=null&&i.label){const k={text:it(i==null?void 0:i.label.text),color:it(((c=i==null?void 0:i.label)==null?void 0:c.color)||Eu),textColor:it(((f=i==null?void 0:i.label)==null?void 0:f.textColor)||Au),fontSize:it(((d=i==null?void 0:i.label)==null?void 0:d.fontSize)||zu),dimensions:{width:it(((p=i==null?void 0:i.label.dimensions)==null?void 0:p.width)||Mu),height:it(((g=i==null?void 0:i.label.dimensions)==null?void 0:g.height)||Tu)},borderRadius:it((i==null?void 0:i.label.borderRadius)||Su)};u.label=k}return u}function Bu(){const n=new Map,e=new Set,{subscribe:i,set:s,update:r}=it(n),a={subscribe:i,set:s,update:r,add:(u,c)=>{if(typeof c!="string"){const f=Array.from(c),d=f[0],p=f[1];if(d.connected.update(g=>g.add(p)),p.connected.update(g=>g.add(d)),a.match(...Array.from(c)).length)return;e.forEach(g=>g(u,"connection"))}r(f=>(f.set(c,u),f))},getAll:()=>Array.from(n.values()),get:u=>n.get(u)||null,match:(...u)=>Array.from(n.keys()).filter(c=>c==="cursor"?!1:u.every(f=>f?c.has(f):!0)),fetch:(u,c)=>{const f=Array.from(n.keys()).filter(d=>d==="cursor"?!1:[u,c].every(p=>p?d.has(p):!0))[0];return n.get(f)||null},delete:u=>{if(typeof u!="string"){const f=Array.from(u),d=f[0],p=f[1];d.connected.update(g=>(g.delete(p),g)),p.connected.update(g=>(g.delete(d),g))}let c=!1;return r(f=>{const d=f.get(u);return d&&(f.delete(u),c=!0,typeof u!="string"&&e.forEach(p=>p(d,"disconnection"))),f}),c},onEdgeChange:u=>(e.add(u),()=>e.delete(u)),count:()=>n.size};return a}function Zu(n,e){const i=n.clientX-e.clientX,s=n.clientY-e.clientY;return Math.sqrt(i*i+s*s)}function Du(){const n=()=>Math.floor(Math.random()*256),e=n(),i=n(),s=n();return`rgb(${e},${i},${s})`}const Ru={"(":"round","[":"square","([":"stadium","[[":"subroutine","[(":"cylindrical","((":"circle","{":"rhombus","{{":"hexagon"},qs={"-":"straight","~":"bezier"},sa={"(":")","[":"]","{":"}"},ju=/[-=~]*>(?:\s*\|(.+?)\|)?/g,Wu=n=>{const e=n.split(`
`),i={parentNodes:[],nodeList:{}};for(const s of e){const{parentNodes:r,childNodes:a,edge:u}=Hu(s);for(const c of r){i.nodeList[c.id]||i.parentNodes.push(c);for(const f of a){if(i.nodeList[c.id]){if(i.nodeList[f.id]&&i.nodeList[f.id].children.some(({node:d})=>d.id===c.id))throw new Error("Circular reference detected");i.nodeList[c.id].children.push({node:i.nodeList[f.id]||f,...u})}else c.children.push({node:i.nodeList[f.id]||f,...u}),i.nodeList[c.id]=c;i.nodeList[f.id]?i.nodeList[f.id].parents.push({node:i.nodeList[c.id]||c}):(f.parents.push({node:i.nodeList[c.id]||c}),i.nodeList[f.id]=f),i.parentNodes=i.parentNodes.filter(d=>d.id!==f.id)}}}return i},Hu=n=>{const e=[],i=[],s=n.trim();let r="";const a=s.match(ju);if(a)r=a[0];else throw new Error("Invalid edge");const[u,c]=s.split(r);for(const d of u.split("&"))e.push(Ks(d));for(const d of c.split("&"))i.push(Ks(d));const f=Fu(r);return{parentNodes:e,childNodes:i,edge:f}},Ks=n=>{n=n.trim();const e=n[0],i=n.slice(1);let s="",r="";const a="Default",u={shape:""},c=[];for(let f=0;f<i.length;f++)if(Gu(i[f]))c.push(i[f]);else if(sa[c[c.length-1]]===i[f]){r=Ru[c.join("")];break}else s+=i[f];return u.shape=r,u.content=s,{id:e,data:u,type:a,children:[],parents:[],depth:0,nesting:0}},Fu=n=>{n=n.trim();let e="";const[i,s]=n.split("|"),r=i[0];if(r in qs)e=qs[r];else throw new Error("Not a valid edge type");return s?{shape:e,content:s.trim(),length:Math.floor((i.trim().length-1)/2)}:{shape:e,length:Math.floor((i.trim().length-1)/2)}};function Gu(n){return n in sa}function Uu(){return Math.random().toString(36).substring(7)}function Vu(n,e){const i=Math.sign(n.x).toString(),s=Math.sign(n.y).toString(),r=Math.sign(e.x).toString(),a=Math.sign(e.y).toString();return`${i}${s}${r}${a}`}function Xu(n,e){return{1001:`a ${n} ${n} 0 0 1 ${n} ${n}`,"0110":`a ${n} ${n} 0 0 0 ${n} ${n}`,"100-1":`a ${n} ${n} 0 0 0 ${n} -${n}`,"0-110":`a ${n} ${n} 0 0 1 ${n} -${n}`,"-1001":`a ${n} ${n} 0 0 0 -${n} ${n}`,"01-10":`a ${n} ${n} 0 0 1 -${n} ${n}`,"-100-1":`a ${n} ${n} 0 0 1 -${n} -${n}`,"0-1-10":`a ${n} ${n} 0 0 0 -${n} -${n}`}[e]||""}function Js(n,e){const i=e*(Math.PI/180),s=n.x*Math.cos(i)-n.y*Math.sin(i),r=n.x*Math.sin(i)+n.y*Math.cos(i);return{x:s,y:r}}const Yu=(n,e,i,s)=>n+` l ${e} ${i} `+s,On=it({x:0,y:0}),es=it(0),Zn=it(!1),ns=it(!1),ra=Co({x:0,y:0},n=>{const e=a=>{n({x:a.clientX,y:a.clientY})},i=a=>{if(a.touches.length===2){const u=Zu(a.touches[0],a.touches[1]);es.set(u);const c={x:a.touches[0].clientX,y:a.touches[0].clientY};n(c)}else if(a.touches.length===1){const u=a.touches[0].clientX,c=a.touches[0].clientY;n({x:u,y:c}),Zn.set(!0)}},s=a=>{i(a),window.addEventListener("touchend",r),window.addEventListener("touchmove",i)},r=()=>{Zn.set(!1),es.set(0),window.removeEventListener("touchmove",i)};return document.addEventListener("mousemove",e),window.addEventListener("touchstart",s,!0),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchstart",s),window.removeEventListener("touchmove",i),window.removeEventListener("touchend",r)}});function Uo(n){const e=n.style.width,i=n.style.height;n.style.width="fit-content",n.style.height="fit-content";const s=n.offsetWidth,r=n.offsetHeight;return n.style.width=e,n.style.height=i,[s,r]}function la(n,e,i,s,r){const a={x:0,y:0},u=s.x-r.left-r.width/2,c=s.y-r.top-r.height/2,f=(u-i.x)/n,d=(c-i.y)/n;return a.x=u-f*e,a.y=c-d*e,a}const qu=3,Ku=.1,Ki={north:{x:0,y:-1},south:{x:0,y:1},east:{x:1,y:0},west:{x:-1,y:0},self:{x:0,y:0}};function aa(n,e,i){const s=e*i,r=n-s;return Number(Math.max(Ku,Math.min(qu,r)).toFixed(9))}const To=(n,e,i,s,r,a,u)=>{const{clientX:c,clientY:f}=n,d=a,p=c-i,g=f-e,k=u.x,b=u.y,P=s*(1-a)/2,S=r*(1-a)/2,z=p-k-P,A=g-b-S,E=z/d,O=A/d;return{x:E,y:O}};function Ju(n,e,i){const{top:s,left:r,width:a,height:u}=wt(n),c=wt(e.scale),f=wt(e.translation);return{scaled:To({clientX:i.x,clientY:i.y},s,r,a,u,c,f),scale:c}}function Qu(n,e,i){const{scale:s,translation:r}=i,a=wt(s),u=wt(r),c=e.x-n.x,f=e.y-n.y,d=u.x+c*a,p=u.y+f*a;return{x:d,y:p}}function $u(n,e){return n.x*e.x+n.y*e.y}function tc(n,e,i){const s=[],r=e.x-n.x,a=e.y-n.y,u=nc(n.direction,e.direction),c=$u(n.direction,e.direction)===0,f=ec(n,e),d=Qe(n.direction,-1,-1),p=Qe(e.direction,-1,-1),g={x:Math.abs(n.direction.y),y:Math.abs(n.direction.x)},k=Qe(n.direction,r-i*n.direction.x*(c?1:u?0:2),a-i*n.direction.y*(c?1:u?0:2)),b=Qe(e.direction,r+i*e.direction.x*(c?1:u?0:2),a+i*e.direction.y*(c?1:u?0:2)),P=Math.sign(k.x)===-1||Math.sign(k.y)===-1,S=Math.sign(b.x)===1||Math.sign(b.y)===1,z=Math.abs(r),A=Math.abs(a),E=Qe(n.direction,i,i),O=Qe(p,i,i),Z=Qe(e.direction,i,i),Y=Qe(n.direction,z,A),j=Qe(p,z,A),tt=Qe(n.direction,z/2,A/2),J=Qe(p,z/2,A/2),et=Qe(g,r,a),ot=!f&&!S&&!P,lt=n.x+E.x,N=n.y+E.y,nt=e.x+Z.x,X=e.y+Z.y;if(P&&s.push(E),f&&!S&&!P)s.push(Y),s.push(j);else if(u)P||s.push(Qe(n.direction,i+z,i+A)),s.push(et),S||s.push(Qe(p,i+z,i+A));else if(ot)s.push(tt),s.push(et),s.push(J);else if(P&&S)if(c){const ct=Math.abs(lt-nt),dt=Math.abs(N-X);s.push(Qe(e.direction,z<i*2?e.direction.x*(r+e.direction.x*i):z+i,A<i*2?e.direction.y*(a+e.direction.y*i):A+i)),s.push(Qe(d,ct,dt))}else{const ct=Math.abs(lt-nt),dt=Math.abs(N-X);s.push(Qe(g,r/2,a/2)),s.push(Qe(e.direction,ct,dt)),s.push(Qe(g,r/2,a/2))}else if(P){const ct=Math.abs(lt-e.x),dt=Math.abs(N-e.y);s.push(Qe(p,z<i*2?z-i:z/2,A<i*2?A-i:A/2)),s.push(Qe(d,ct,dt)),s.push(Qe(p,Math.max(i,z/2),Math.max(i,A/2)))}else if(S){const ct=Math.abs(nt-n.x),dt=Math.abs(X-n.y);s.push(Qe(n.direction,Math.max(i,z/2),Math.max(i,A/2))),s.push(Qe(e.direction,ct,dt)),s.push(Qe(n.direction,z<i*2?z-i:z/2,A<i*2?A-i:A/2))}return S&&s.push(O),s}function ec(n,e){const{x:i,y:s}=n.direction,{x:r,y:a}=e.direction,u=e.x-n.x,c=e.y-n.y;return i*a===r*s?!1:Math.sign(c)===Math.sign(s+a)!=(Math.sign(u)===Math.sign(i+r))}function Qe(n,e,i){return{x:n.x*e,y:n.y*i}}function nc(n,e){return n.x===e.x&&n.y===e.y}function ic(n,e){const{width:i,height:s}=n,{top:r,left:a,right:u,bottom:c}=e,f=u-a,d=c-r;if(!f||!d)return{x:null,y:null,scale:null};const p=a+f/2,g=r+d/2,k=Math.min(i/f,s/d)*.8,b=i/2,P=s/2,S=b-p,z=P-g;return{x:S*k,y:z*k,scale:k}}const wo=(n,e,i)=>Math.min(Math.abs(n||e)/2,i);function Vo(n,e){const s=n.getTotalLength()*e;return n.getPointAtLength(s)}function oc(n,e,i,s){return $i([n,e,i,s],([a,u,c,f])=>{const d={clientX:a.x,clientY:a.y};return To(d,u.top,u.left,u.width,u.height,f,c)})}function sc(n,e,i,s){const r=it({top:1/0,left:1/0,right:-1/0,bottom:-1/0}),a=it({top:1/0,left:1/0,right:-1/0,bottom:-1/0});let u,c=wt(e),f=wt(i),d=wt(s),p=c.width/f,g=c.height/f;function k(){const{x:P,y:S}=To({clientX:c.left,clientY:c.top},c.top,c.left,c.width,c.height,f,d),z=wt(a);r.set({top:Math.min(z.top,S),left:Math.min(z.left,P),right:Math.max(z.right,P+p),bottom:Math.max(z.bottom,g+S)})}function b(P=!1){let S=1/0,z=1/0,A=-1/0,E=-1/0;for(const O of n.getAll()){console.log("dentro del for, este es e node:",O);const{x:Z,y:Y}=wt(O.position),j=wt(O.dimensions.width),tt=wt(O.dimensions.height);z=Math.min(z,Z),S=Math.min(S,Y),A=Math.max(A,Z+j),E=Math.max(E,Y+tt)}a.set({top:S,left:z,right:A,bottom:E}),k(),P&&(u=requestAnimationFrame(()=>b(P)))}return n.subscribe(()=>{console.log("dentro del nodes.subscribe...........Aqui no estan llegando los nodes"),b()}),ns.subscribe(P=>{P&&b(P),P||cancelAnimationFrame(u)}),Zn.subscribe(P=>{P&&b(P),P||cancelAnimationFrame(u)}),e.subscribe(()=>{c=wt(e),p=c.width/f,g=c.height/f,k()}),i.subscribe(()=>{f=wt(i),p=c.width/f,g=c.height/f,k()}),s.subscribe(()=>{d=wt(s),k()}),{graphBounds:r,nodeBounds:a}}function rc(n,e,i){const{width:s,height:r,top:a,left:u}=n,c={clientX:s/2,clientY:r/2};return To(c,a,u,s,r,i,e)}function ua(n,e){const{zoom:i,editable:s,translation:r,direction:a,locked:u,edge:c,nodes:f}=e,d=it({x:(r==null?void 0:r.x)||0,y:(r==null?void 0:r.y)||0}),p=it({top:0,left:0,width:0,height:0,bottom:0,right:0}),g=it(i),k=it(!1),b=So(),P=sc(b,p,g,d),S=$i([p,d,g],([A,E,O])=>rc(A,E,O));return{id:n,nodes:b,edges:Bu(),transforms:{translation:d,scale:g},maxZIndex:it(2),dimensions:p,bounds:P,center:S,mounted:k,direction:a||"LR",editable:s||!1,edge:c||null,editing:it(null),cursor:oc(ra,p,d,g),locked:it(u||!1),groups:it({selected:{parent:it(null),nodes:it(new Set)},hidden:{parent:it(null),nodes:it(new Set)}}),groupBoxes:So(),activeGroup:it(null),initialNodePositions:it([])}}const Xo=So(),bo={width:200,height:100};function Lo(n,e){return{x:Math.round(n/bo.width)*bo.width,y:Math.round(e/bo.height)*bo.height}}const ko=10;function ca(n){const e=wt(n);return Array.from(e).map(s=>wt(s.position))}function lc(n,e){console.log("moveNodes called");let i;const s=wt(n.groups),r=wt(n.activeGroup);if(console.log("Graph Groups:",s),console.log("Active Group:",r),!r)return;const a=s[r].nodes;if(!a)return;const u=wt(n.initialNodePositions),{x:c,y:f}=wt(On),d=Array.from(wt(a)),p=wt(n.groupBoxes);console.log("Group Boxes:",p),d.forEach(k=>k.moving.set(!0)),g();function g(){const k=wt(n.cursor);let b=k.x-c,P=k.y-f;if(e){const z=Lo(b,P);b=z.x,P=z.y}const S={x:b,y:P};d.forEach((z,A)=>{const{group:E,position:O}=z,Z=u[A];let Y;if(r==="selected"){const j=wt(E);j&&(Y=p.get(j))}if(!Y)ac(Z,S,O);else{const j=wt(z.dimensions.width),tt=wt(z.dimensions.height),J=fa(Y,j,tt);ha(Z,S,O,J)}}),wt(Zn)?i=requestAnimationFrame(g):cancelAnimationFrame(i)}}function ac(n,e,i){i.set({x:n.x+e.x,y:n.y+e.y})}function ha(n,e,i,s){i.set({x:Math.min(Math.max(s.left,n.x+e.x),s.right),y:Math.min(Math.max(s.top,n.y+e.y),s.bottom)})}function fa(n,e,i){const{x:s,y:r}=wt(n.position);return console.log("Group Box Position:",{x:s,y:r}),{left:s+ko,right:s+wt(n.dimensions.width)-e-ko,top:r+ko,bottom:r+wt(n.dimensions.height)-i-ko}}function Qs(n=1,e,i,s=.1){const r=wt(e),{width:a,height:u,top:c,left:f}=r,d=i.scale,p=wt(i.translation),g=wt(d),k=aa(g,n,s),b=la(g,k,p,{x:a/2+f,y:u/2+c},r);d.set(k),i.translation.set(b)}function uc(n,e,i,s,r,a,u,c,f,d,p,g){const{width:k,height:b}=r,{x:P,y:S}=s,z=wt(e.position),A=it({x:P-z.x+k/2,y:S-z.y+b/2}),E=$i([e.position,A],([et,ot])=>({x:et.x+ot.x,y:et.y+ot.y})),O=n.transforms,Z=n.dimensions,Y=it(f||"self"),j=()=>{const et=document.getElementById(i),ot=wt(Y),lt=Ki[ot];if(!et)return;const{x:N,y:nt,width:X,height:ct}=et.getBoundingClientRect(),dt=wt(A),Q=wt(E),{scaled:W,scale:At}=Ju(Z,O,{x:N,y:nt}),st=W.x-Q.x,yt=W.y-Q.y;A.set({x:dt.x+st+X/At/2+lt.x*X/At/2,y:dt.y+yt+ct/At/2+lt.y*ct/At/2})},tt=$i([e.moving,e.resizingWidth,e.resizingHeight,e.rotating],([et,ot,lt,N])=>et||ot||lt||N),J=$i([e.rotation],([et])=>et);return{id:i,position:E,offset:A,direction:Y,dynamic:it(d||!1),type:c,edge:u,moving:tt,mounted:it(!1),recalculatePosition:j,connected:it(new Set),store:a||null,inputKey:p||null,edgeColor:g||it(null),rotation:J,node:e}}function cc(n){var s,r;const e=JSON.parse(n);return ua(e.id,{...e,editable:e.editable,direction:e.direction,locked:e.locked,zoom:((s=e.transforms)==null?void 0:s.scale)??1,translation:((r=e.transforms)==null?void 0:r.translation)??{x:0,y:0},edge:e.edge})}function hc(n){let e;const i=n[2].default,s=Ce(i,n,n[1],null);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,[a]){s&&s.p&&(!e||a&2)&&Me(s,i,r,r[1],e?Se(i,r[1],a,null):Te(r[1]),null)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function fc(n,e,i){let{$$slots:s={},$$scope:r}=e,{edge:a}=e;return Ie("edge",a),n.$$set=u=>{"edge"in u&&i(0,a=u.edge),"$$scope"in u&&i(1,r=u.$$scope)},[a,r,s]}class da extends pn{constructor(e){super(),mn(this,e,fc,hc,un,{edge:0})}}const dc=n=>({hovering:n[0]&32768}),$s=n=>({destroy:n[9],hovering:n[15]}),_c=n=>({path:n[0]&4096,hovering:n[0]&32768}),tr=n=>({path:n[12],destroy:n[9],hovering:n[15]});function mc(n){let e,i,s,r,a,u=(n[0]||n[1])&&er(n);const c=n[91].default,f=Ce(c,n,n[90],tr),d=f||pc(n);let p=n[10]&&nr(n);return{c(){e=ee("svg"),u&&u.c(),i=ee("path"),d&&d.c(),p&&p.c(),m(i,"role","presentation"),m(i,"id",n[38]+"-target"),m(i,"class","target svelte-ppcocz"),m(i,"d",n[12]),$t(i,"cursor",n[38]==="cursor"||!n[4]&&!n[3]),at(i,"cursor",n[4]||n[15]?"pointer":"move"),at(i,"--prop-target-edge-color",n[4]||n[15]?n[8]||null:"transparent"),m(e,"class","edges-wrapper svelte-ppcocz"),at(e,"z-index",n[17])},m(g,k){G(g,e,k),u&&u.m(e,null),y(e,i),n[94](i),d&&d.m(e,null),p&&p.m(e,null),n[95](e),s=!0,r||(a=[ht(i,"mousedown",function(){no(n[4])&&n[4].apply(this,arguments)}),ht(i,"mouseenter",n[92]),ht(i,"mouseleave",n[93])],r=!0)},p(g,k){n=g,n[0]||n[1]?u?u.p(n,k):(u=er(n),u.c(),u.m(e,i)):u&&(u.d(1),u=null),(!s||k[0]&4096)&&m(i,"d",n[12]),(!s||k[0]&24|k[1]&128)&&$t(i,"cursor",n[38]==="cursor"||!n[4]&&!n[3]),k[0]&32784&&at(i,"cursor",n[4]||n[15]?"pointer":"move"),k[0]&33040&&at(i,"--prop-target-edge-color",n[4]||n[15]?n[8]||null:"transparent"),f?f.p&&(!s||k[0]&36864|k[2]&268435456)&&Me(f,c,n,n[90],s?Se(c,n[90],k,_c):Te(n[90]),tr):d&&d.p&&(!s||k[0]&1052711)&&d.p(n,s?k:[-1,-1,-1,-1]),n[10]?p?(p.p(n,k),k[0]&1024&&B(p,1)):(p=nr(n),p.c(),B(p,1),p.m(e,null)):p&&(ve(),q(p,1,1,()=>{p=null}),ye()),k[0]&131072&&at(e,"z-index",n[17])},i(g){s||(B(d,g),B(p),s=!0)},o(g){q(d,g),q(p),s=!1},d(g){g&&F(e),u&&u.d(),n[94](null),d&&d.d(g),p&&p.d(),n[95](null),r=!1,$e(a)}}}function er(n){let e,i,s,r,a;return{c(){e=ee("defs"),i=ee("marker"),s=ee("polygon"),r=ee("marker"),a=ee("polygon"),m(s,"class","arrow svelte-ppcocz"),m(s,"points","0 0, 15 5, 0 10"),at(s,"--prop-edge-color",n[20]),m(i,"id",n[38]+"-end-arrow"),m(i,"viewBox","0 0 15 15"),m(i,"markerWidth","15"),m(i,"markerHeight","10"),m(i,"refX","12.5"),m(i,"refY","5"),m(i,"orient","auto"),m(a,"class","arrow svelte-ppcocz"),m(a,"points","0 5, 15 0, 15 10"),at(a,"--prop-edge-color",n[20]),m(r,"id",n[38]+"-start-arrow"),m(r,"viewBox","0 0 15 15"),m(r,"markerWidth","15"),m(r,"markerHeight","10"),m(r,"refX","0"),m(r,"refY","5"),m(r,"orient","auto")},m(u,c){G(u,e,c),y(e,i),y(i,s),y(e,r),y(r,a)},p(u,c){c[0]&1048576&&at(s,"--prop-edge-color",u[20]),c[0]&1048576&&at(a,"--prop-edge-color",u[20])},d(u){u&&F(e)}}}function pc(n){let e,i,s;return{c(){e=ee("path"),m(e,"id",n[38]),m(e,"class","edge svelte-ppcocz"),m(e,"d",n[12]),m(e,"marker-end",i=n[1]==="arrow"?`url(#${n[38]+"-end-arrow"})`:""),m(e,"marker-start",s=n[0]==="arrow"?`url(#${n[38]+"-start-arrow"})`:""),$t(e,"animate",n[2]),at(e,"--prop-edge-color",n[20]),at(e,"--prop-stroke-width",n[5]?n[5]+"px":null)},m(r,a){G(r,e,a)},p(r,a){a[0]&4096&&m(e,"d",r[12]),a[0]&2&&i!==(i=r[1]==="arrow"?`url(#${r[38]+"-end-arrow"})`:"")&&m(e,"marker-end",i),a[0]&1&&s!==(s=r[0]==="arrow"?`url(#${r[38]+"-start-arrow"})`:"")&&m(e,"marker-start",s),a[0]&4&&$t(e,"animate",r[2]),a[0]&1048576&&at(e,"--prop-edge-color",r[20]),a[0]&32&&at(e,"--prop-stroke-width",r[5]?r[5]+"px":null)},d(r){r&&F(e)}}}function nr(n){let e,i,s,r,a;const u=n[91].label,c=Ce(u,n,n[90],$s),f=c||gc(n);return{c(){e=ee("foreignObject"),i=M("span"),f&&f.c(),m(i,"class","label-wrapper svelte-ppcocz"),m(e,"x",s=n[14].x),m(e,"y",r=n[14].y),m(e,"width","100%"),m(e,"height","100%"),m(e,"class","svelte-ppcocz")},m(d,p){G(d,e,p),y(e,i),f&&f.m(i,null),a=!0},p(d,p){c?c.p&&(!a||p[0]&32768|p[2]&268435456)&&Me(c,u,d,d[90],a?Se(u,d[90],p,dc):Te(d[90]),$s):f&&f.p&&(!a||p[0]&2240)&&f.p(d,a?p:[-1,-1,-1,-1]),(!a||p[0]&16384&&s!==(s=d[14].x))&&m(e,"x",s),(!a||p[0]&16384&&r!==(r=d[14].y))&&m(e,"y",r)},i(d){a||(B(f,d),a=!0)},o(d){q(f,d),a=!1},d(d){d&&F(e),f&&f.d(d)}}}function gc(n){let e,i;return{c(){e=M("div"),i=re(n[11]),m(e,"class","default-label svelte-ppcocz"),at(e,"--prop-label-color",n[6]),at(e,"--prop-label-text-color",n[7])},m(s,r){G(s,e,r),y(e,i)},p(s,r){r[0]&2048&&an(i,s[11]),r[0]&64&&at(e,"--prop-label-color",s[6]),r[0]&128&&at(e,"--prop-label-text-color",s[7])},d(s){s&&F(e)}}}function vc(n){let e,i,s=n[23]&&n[24]&&mc(n);return{c(){s&&s.c(),e=ze()},m(r,a){s&&s.m(r,a),G(r,e,a),i=!0},p(r,a){r[23]&&r[24]&&s.p(r,a)},i(r){i||(B(s),i=!0)},o(r){q(s),i=!1},d(r){r&&F(e),s&&s.d(r)}}}let Yo;function yc(n){const e=n.parentNode;if(!e)return;e.removeChild(n);const i=document.querySelector(".svelvet-graph-wrapper");i&&i.appendChild(n)}function wc(n,e,i){var Rn,$n;let s,r,a,u,c,f,d,p,g,k,b,P,S,z,A,E,O,Z,Y,j,tt,J,et,ot,lt,N,nt,X,ct,dt,Q,W,At=Gt,st=()=>(At(),At=fn(ct,gt=>i(73,W=gt)),ct),yt,Lt=Gt,_t=()=>(Lt(),Lt=fn(X,gt=>i(74,yt=gt)),X),R,U,H,K,Nt,Wt,rt,Ct,Mt,xt,qt,we,fe,$,Ot=Gt,zt=()=>(Ot(),Ot=fn(a,gt=>i(88,$=gt)),a),Tt,Ft=Gt,Ut=()=>(Ft(),Ft=fn(r,gt=>i(89,Tt=gt)),r);n.$$.on_destroy.push(()=>At()),n.$$.on_destroy.push(()=>Lt()),n.$$.on_destroy.push(()=>Ot()),n.$$.on_destroy.push(()=>Ft());let{$$slots:xe={},$$scope:Ke}=e;const De=rs(xe),Yt=me("edgeStore"),Re=me("edgeStyle"),ie=me("endStyles"),tn=me("raiseEdgesOnSelect"),be=me("edgesAboveNode");let{edge:pe=me("edge")}=e,{straight:Ee=Re==="straight"}=e,{step:je=Re==="step"}=e,{start:We=ie[0]}=e,{end:en=ie[1]}=e,{animate:ke=!1}=e,{label:He=""}=e,{enableHover:jt=!1}=e,{edgeClick:Ge=null}=e,{labelPosition:Ye=.5}=e,{width:bn=null}=e,{color:nn=null}=e,{labelColor:on=null}=e,{textColor:Oe=null}=e,{cornerRadius:Fe=8}=e,{targetColor:gn=null}=e;const ue=pe.source,de=pe.target,qe=ue.direction;pt(n,qe,gt=>i(76,U=gt));const kn=de.direction;pt(n,kn,gt=>i(75,R=gt));const vn=ue.rotation;pt(n,vn,gt=>i(83,Mt=gt));const Nn=de.rotation;pt(n,Nn,gt=>i(82,Ct=gt));const Mn=ue.position;pt(n,Mn,gt=>i(87,fe=gt));const Be=de.position;pt(n,Be,gt=>i(86,we=gt));const bt=ue.dynamic;pt(n,bt,gt=>i(79,Nt=gt));const yn=de.dynamic;pt(n,yn,gt=>i(78,K=gt));const wn=ue.moving;pt(n,wn,gt=>i(81,rt=gt));const cn=de.moving;pt(n,cn,gt=>i(80,Wt=gt));const Pn=(Rn=ue.node)==null?void 0:Rn.position;pt(n,Pn,gt=>i(85,qt=gt));const w=($n=de.node)==null?void 0:$n.position;pt(n,w,gt=>i(84,xt=gt));const mt=pe.type;pt(n,mt,gt=>i(77,H=gt));const Pt=pe.id;let kt,Et,x={x:0,y:0},Kt=!1,_e=!1,Jt=!1,Pe=!1,sn=!1,Ue;pe.rendered.set(!0),Hn(()=>{setTimeout(()=>{Et&&i(14,x=Vo(Et,Ye))},0),yc(Ue)}),Ql(()=>{Et&&i(14,x=Vo(Et,Ye))}),io(()=>{Ue.remove(),cancelAnimationFrame(Yo)});function Ln(){Kt&&(Et&&i(14,x=Vo(Et,Ye)),Yo=requestAnimationFrame(Ln))}function Cn(){if(ue.id===null||de.id===null)return;const gt=Yt.match(ue,de);Yt.delete(gt[0]),ue==null||ue.connected.update(Ht=>(de&&Ht.delete(de),Ht)),de==null||de.connected.update(Ht=>(ue&&Ht.delete(ue),Ht))}const Yn=()=>i(15,sn=!0),Dn=()=>i(15,sn=!1);function Tn(gt){Xn[gt?"unshift":"push"](()=>{Et=gt,i(13,Et)})}function Ve(gt){Xn[gt?"unshift":"push"](()=>{Ue=gt,i(16,Ue)})}return n.$$set=gt=>{"edge"in gt&&i(39,pe=gt.edge),"straight"in gt&&i(40,Ee=gt.straight),"step"in gt&&i(41,je=gt.step),"start"in gt&&i(0,We=gt.start),"end"in gt&&i(1,en=gt.end),"animate"in gt&&i(2,ke=gt.animate),"label"in gt&&i(42,He=gt.label),"enableHover"in gt&&i(3,jt=gt.enableHover),"edgeClick"in gt&&i(4,Ge=gt.edgeClick),"labelPosition"in gt&&i(43,Ye=gt.labelPosition),"width"in gt&&i(5,bn=gt.width),"color"in gt&&i(44,nn=gt.color),"labelColor"in gt&&i(6,on=gt.labelColor),"textColor"in gt&&i(7,Oe=gt.textColor),"cornerRadius"in gt&&i(45,Fe=gt.cornerRadius),"targetColor"in gt&&i(8,gn=gt.targetColor),"$$scope"in gt&&i(90,Ke=gt.$$scope)},n.$$.update=()=>{var gt;if(n.$$.dirty[2]&196608&&i(55,s=Nt||K),n.$$.dirty[1]&256&&zt(i(21,a=(gt=pe.label)==null?void 0:gt.text)),n.$$.dirty[1]&8192|n.$$.dirty[2]&134217728&&i(20,u=nn||Tt||null),n.$$.dirty[1]&2048|n.$$.dirty[2]&67108864&&i(11,c=He||$||""),n.$$.dirty[0]&2048&&i(10,f=c||De.label),n.$$.dirty[2]&33554432&&i(72,d=fe),n.$$.dirty[2]&16777216&&i(71,p=we),n.$$.dirty[2]&8388608&&i(56,g=qt),n.$$.dirty[2]&4194304&&i(57,k=xt),n.$$.dirty[2]&1024&&i(52,b=d.x),n.$$.dirty[2]&1024&&i(51,P=d.y),n.$$.dirty[2]&512&&i(54,S=p.x),n.$$.dirty[2]&512&&i(53,z=p.y),n.$$.dirty[1]&10485760&&i(70,A=S-b),n.$$.dirty[1]&5242880&&i(69,E=z-P),n.$$.dirty[2]&256&&i(68,O=Math.abs(A)),n.$$.dirty[2]&128&&i(67,Z=Math.abs(E)),n.$$.dirty[2]&64&&i(65,Y=Math.max(30,Math.min(600,O/2))),n.$$.dirty[2]&32&&i(63,j=Math.max(30,Math.min(600,Z/2))),n.$$.dirty[1]&117833728&&s&&ue.node&&de.node){const Ht=k.x-g.x,te=k.y-g.y;i(48,Jt=te>0),i(49,Pe=Ht>0);let Ne,En;if(Jt){const Je=wt(ue.node.dimensions.height),oe=g.y+Je;Ne=k.y-oe}else{const Je=wt(de.node.dimensions.height),oe=k.y+Je;Ne=g.y-oe}if(Pe){const Je=wt(ue.node.dimensions.width),oe=g.x+Je;En=k.x-oe}else{const Je=wt(de.node.dimensions.width),oe=k.x+Je;En=g.x-oe}i(47,_e=Ne>En)}if(n.$$.dirty[1]&17235968|n.$$.dirty[2]&196608&&s){let Ht,te;_e?(Ht=Jt?"south":"north",te=Jt?"north":"south"):(Ht=Pe?"east":"west",te=Pe?"west":"east"),Nt&&Bt(qe,U=Ht,U),K&&Bt(kn,R=te,R)}if(n.$$.dirty[2]&2113536&&i(66,tt=Js(Ki[U],Mt||0)),n.$$.dirty[2]&1056768&&i(64,J=Js(Ki[R],Ct||0)),n.$$.dirty[1]&2097152|n.$$.dirty[2]&24&&i(62,et=b+tt.x*Y),n.$$.dirty[1]&1048576|n.$$.dirty[2]&18&&i(61,ot=P+tt.y*j),n.$$.dirty[1]&8388608|n.$$.dirty[2]&12&&i(60,lt=S+J.x*Y),n.$$.dirty[1]&4194304|n.$$.dirty[2]&6&&i(59,N=z+J.y*j),n.$$.dirty[1]&1879048192|n.$$.dirty[2]&1&&i(58,nt=`C ${et}, ${ot} ${lt}, ${N}`),n.$$.dirty[1]&149947904|n.$$.dirty[2]&32768&&(!je||Pt==="cursor"||H==="bezier")&&i(12,kt=`M ${b}, ${P} ${Ee?"":nt} ${S}, ${z}`),n.$$.dirty[0]&1024|n.$$.dirty[1]&32768|n.$$.dirty[2]&786432&&(f&&!Kt&&(rt||Wt||Pt==="cursor")?(i(46,Kt=!0),Ln()):Kt&&!rt&&!Wt&&Pt!=="cursor"&&(i(46,Kt=!1),cancelAnimationFrame(Yo))),n.$$.dirty[1]&15746048|n.$$.dirty[2]&57344&&je&&Pt!=="cursor"&&!(H&&H==="bezier")){const Ht={x:b,y:P,direction:Ki[U]},te={x:S,y:z,direction:Ki[R]},Ne=tc(Ht,te,xu),En=(Je,oe,It)=>{if(oe<Ne.length-1){const ne=Vu(Je,Ne[oe+1]);return Xu(It,ne)}return""};i(12,kt=Ne.reduce((Je,oe,It)=>{const ne=Math.sign(oe.x),rn=Math.sign(oe.y);let Fn=oe.x,ln=oe.y,An="";if(Fe){const Zt=Ne[It+1]||{x:0,y:0},se=Ne[It-1]||{x:0,y:0},Ze=wo(oe.x,Zt.x,Fe),qn=wo(Zt.y,oe.y,Fe),oi=wo(se.x,oe.x,Fe),si=wo(se.y,oe.y,Fe),fi=Math.min(oi,si),Kn=Math.min(Ze,qn);oe.x?Fn=oe.x-(Kn+fi)*ne:ln=oe.y-(Kn+fi)*rn,An=En(oe,It,Kn)}return Yu(Je,Fn,ln,An)},`M ${b}, ${P}`))}n.$$.dirty[2]&6144&&i(50,dt=Math.max(yt,W)),n.$$.dirty[1]&524288|n.$$.dirty[2]&6144&&i(17,Q=be==="all"?1e5:be?dt:tn===!0?dt-1:tn==="source"?yt-1:tn==="target"?W-1:0)},Ut(i(22,r=(ue==null?void 0:ue.edgeColor)||(de==null?void 0:de.edgeColor)||null)),_t(i(19,X=ue.node.zIndex||0)),st(i(18,ct=de.node.zIndex||0)),[We,en,ke,jt,Ge,bn,on,Oe,gn,Cn,f,c,kt,Et,x,sn,Ue,Q,ct,X,u,a,r,ue,de,qe,kn,vn,Nn,Mn,Be,bt,yn,wn,cn,Pn,w,mt,Pt,pe,Ee,je,He,Ye,nn,Fe,Kt,_e,Jt,Pe,dt,P,b,z,S,s,g,k,nt,N,lt,ot,et,j,J,Y,tt,Z,O,E,A,p,d,W,yt,R,U,H,K,Nt,Wt,rt,Ct,Mt,xt,qt,we,fe,$,Tt,Ke,xe,Yn,Dn,Tn,Ve]}class _a extends pn{constructor(e){super(),mn(this,e,wc,vc,un,{edge:39,straight:40,step:41,start:0,end:1,animate:2,label:42,enableHover:3,edgeClick:4,labelPosition:43,width:5,color:44,labelColor:6,textColor:7,cornerRadius:45,targetColor:8,destroy:9},null,[-1,-1,-1,-1])}get destroy(){return this.$$.ctx[9]}}function bc(n){let e;return{c(){e=M("div"),m(e,"class","svelvet-anchor svelte-19t6skv"),$t(e,"output",n[0]),$t(e,"input",n[1]),$t(e,"connected",n[3]),$t(e,"connecting",n[2]),$t(e,"hovering",n[4]),at(e,"--prop-anchor-color",n[5])},m(i,s){G(i,e,s)},p(i,[s]){s&1&&$t(e,"output",i[0]),s&2&&$t(e,"input",i[1]),s&8&&$t(e,"connected",i[3]),s&4&&$t(e,"connecting",i[2]),s&16&&$t(e,"hovering",i[4]),s&32&&at(e,"--prop-anchor-color",i[5])},i:Gt,o:Gt,d(i){i&&F(e)}}}function kc(n,e,i){let{output:s}=e,{input:r}=e,{connecting:a}=e,{connected:u}=e,{hovering:c}=e,{bgColor:f}=e;return n.$$set=d=>{"output"in d&&i(0,s=d.output),"input"in d&&i(1,r=d.input),"connecting"in d&&i(2,a=d.connecting),"connected"in d&&i(3,u=d.connected),"hovering"in d&&i(4,c=d.hovering),"bgColor"in d&&i(5,f=d.bgColor)},[s,r,a,u,c,f]}class Pc extends pn{constructor(e){super(),mn(this,e,kc,bc,un,{output:0,input:1,connecting:2,connected:3,hovering:4,bgColor:5})}}const Lc=n=>({}),ir=n=>({});function or(n){const e=n.slice(),i=e[7].component;return e[86]=i,e}function qo(n){const e=n.slice(),i=e[14].get("cursor");return e[7]=i,e}function sr(n,e,i){const s=n.slice();s[87]=e[i];const r=s[14].fetch(s[23],s[87]);return s[7]=r,s}const Cc=n=>({}),rr=n=>({});function Ko(n){const e=n.slice(),i=e[7].component;return e[86]=i,e}const Sc=n=>({linked:n[0]&512,hovering:n[0]&1024,connecting:n[0]&2048}),lr=n=>{var e;return{linked:((e=n[9])==null?void 0:e.size)>=1,hovering:n[10],connecting:n[11]}};function ar(n){var s;let e,i;return e=new Pc({props:{output:n[2],input:n[1],connecting:n[11],hovering:n[10],bgColor:n[0],connected:((s=n[9])==null?void 0:s.size)>=1}}),{c(){he(e.$$.fragment)},m(r,a){le(e,r,a),i=!0},p(r,a){var c;const u={};a[0]&4&&(u.output=r[2]),a[0]&2&&(u.input=r[1]),a[0]&2048&&(u.connecting=r[11]),a[0]&1024&&(u.hovering=r[10]),a[0]&1&&(u.bgColor=r[0]),a[0]&512&&(u.connected=((c=r[9])==null?void 0:c.size)>=1),e.$set(u)},i(r){i||(B(e.$$.fragment,r),i=!0)},o(r){q(e.$$.fragment,r),i=!1},d(r){ae(e,r)}}}function Mc(n){let e,i,s=!n[5]&&ar(n);return{c(){s&&s.c(),e=ze()},m(r,a){s&&s.m(r,a),G(r,e,a),i=!0},p(r,a){r[5]?s&&(ve(),q(s,1,1,()=>{s=null}),ye()):s?(s.p(r,a),a[0]&32&&B(s,1)):(s=ar(r),s.c(),B(s,1),s.m(e.parentNode,e))},i(r){i||(B(s),i=!0)},o(r){q(s),i=!1},d(r){r&&F(e),s&&s.d(r)}}}function ur(n){let e,i;return e=new da({props:{edge:n[7],$$slots:{default:[zc]},$$scope:{ctx:n}}}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},p(s,r){const a={};r[0]&512&&(a.edge=s[7]),r[0]&512|r[1]&8388608&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Tc(n){let e,i;return e=new _a({}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Ec(n){let e,i;return e=new n[86]({}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Ac(n){let e,i,s,r;const a=[Ec,Tc],u=[];function c(f,d){return f[86]?0:1}return e=c(n),i=u[e]=a[e](n),{c(){i.c(),s=ze()},m(f,d){u[e].m(f,d),G(f,s,d),r=!0},p(f,d){let p=e;e=c(f),e!==p&&(ve(),q(u[p],1,1,()=>{u[p]=null}),ye(),i=u[e],i||(i=u[e]=a[e](f),i.c()),B(i,1),i.m(s.parentNode,s))},i(f){r||(B(i),r=!0)},o(f){q(i),r=!1},d(f){f&&F(s),u[e].d(f)}}}function zc(n){let e;const i=n[50].edge,s=Ce(i,n,n[54],rr),r=s||Ac(n);return{c(){r&&r.c()},m(a,u){r&&r.m(a,u),e=!0},p(a,u){s?s.p&&(!e||u[1]&8388608)&&Me(s,i,a,a[54],e?Se(i,a[54],u,Cc):Te(a[54]),rr):r&&r.p&&(!e||u[0]&512)&&r.p(a,e?u:[-1,-1,-1])},i(a){e||(B(r,a),e=!0)},o(a){q(r,a),e=!1},d(a){r&&r.d(a)}}}function cr(n,e){let i,s,r,a=e[7]&&e[7].source===e[23]&&ur(Ko(e));return{key:n,first:null,c(){i=ze(),a&&a.c(),s=ze(),this.first=i},m(u,c){G(u,i,c),a&&a.m(u,c),G(u,s,c),r=!0},p(u,c){e=u,e[7]&&e[7].source===e[23]?a?(a.p(Ko(e),c),c[0]&512&&B(a,1)):(a=ur(Ko(e)),a.c(),B(a,1),a.m(s.parentNode,s)):a&&(ve(),q(a,1,1,()=>{a=null}),ye())},i(u){r||(B(a),r=!0)},o(u){q(a),r=!1},d(u){u&&(F(i),F(s)),a&&a.d(u)}}}function hr(n){let e,i,s=n[7]&&Nc(or(n));return{c(){s&&s.c(),e=ze()},m(r,a){s&&s.m(r,a),G(r,e,a),i=!0},p(r,a){r[7]&&s.p(or(r),a)},i(r){i||(B(s),i=!0)},o(r){q(s),i=!1},d(r){r&&F(e),s&&s.d(r)}}}function Nc(n){let e,i;return e=new da({props:{edge:n[7],$$slots:{default:[Bc]},$$scope:{ctx:n}}}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},p(s,r){const a={};r[1]&8388608&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Ic(n){let e,i;return e=new _a({}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function xc(n){let e,i;return e=new n[86]({}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Oc(n){let e,i,s,r;const a=[xc,Ic],u=[];function c(f,d){return f[86]?0:1}return e=c(n),i=u[e]=a[e](n),{c(){i.c(),s=ze()},m(f,d){u[e].m(f,d),G(f,s,d),r=!0},p:Gt,i(f){r||(B(i),r=!0)},o(f){q(i),r=!1},d(f){f&&F(s),u[e].d(f)}}}function Bc(n){let e;const i=n[50].edge,s=Ce(i,n,n[54],ir),r=s||Oc(n);return{c(){r&&r.c()},m(a,u){r&&r.m(a,u),e=!0},p(a,u){s&&s.p&&(!e||u[1]&8388608)&&Me(s,i,a,a[54],e?Se(i,a[54],u,Lc):Te(a[54]),ir)},i(a){e||(B(r,a),e=!0)},o(a){q(r,a),e=!1},d(a){r&&r.d(a)}}}function Zc(n){let e,i,s,r=[],a=new Map,u,c,f,d,p;const g=n[50].default,k=Ce(g,n,n[54],lr),b=k||Mc(n);let P=Ae(Array.from(n[9]));const S=A=>A[87].id;for(let A=0;A<P.length;A+=1){let E=sr(n,P,A),O=S(E);a.set(O,r[A]=cr(O,E))}let z=n[11]&&hr(qo(n));return{c(){var A;e=M("div"),b&&b.c(),s=V();for(let E=0;E<r.length;E+=1)r[E].c();u=V(),z&&z.c(),c=ze(),m(e,"id",(A=n[23])==null?void 0:A.id),m(e,"class","anchor-wrapper svelte-bazd6o"),m(e,"role","button"),m(e,"tabindex","0"),m(e,"title",i=n[6]||""),$t(e,"locked",n[4])},m(A,E){G(A,e,E),b&&b.m(e,null),n[53](e),G(A,s,E);for(let O=0;O<r.length;O+=1)r[O]&&r[O].m(A,E);G(A,u,E),z&&z.m(A,E),G(A,c,E),f=!0,d||(p=[ht(e,"mouseenter",n[51]),ht(e,"mouseleave",n[52]),ht(e,"mousedown",Wn(jn(n[25]))),ht(e,"mouseup",Wn(n[24])),ht(e,"touchstart",Wn(jn(n[25]))),ht(e,"touchend",Wn(n[24]))],d=!0)},p(A,E){k?k.p&&(!f||E[0]&3584|E[1]&8388608)&&Me(k,g,A,A[54],f?Se(g,A[54],E,Sc):Te(A[54]),lr):b&&b.p&&(!f||E[0]&3623)&&b.p(A,f?E:[-1,-1,-1]),(!f||E[0]&64&&i!==(i=A[6]||""))&&m(e,"title",i),(!f||E[0]&16)&&$t(e,"locked",A[4]),E[0]&8405504|E[1]&8388608&&(P=Ae(Array.from(A[9])),ve(),r=hi(r,E,S,1,A,P,a,u.parentNode,eo,cr,u,sr),ye()),A[11]?z?(z.p(qo(A),E),E[0]&2048&&B(z,1)):(z=hr(qo(A)),z.c(),B(z,1),z.m(c.parentNode,c)):z&&(ve(),q(z,1,1,()=>{z=null}),ye())},i(A){if(!f){B(b,A);for(let E=0;E<P.length;E+=1)B(r[E]);B(z),f=!0}},o(A){q(b,A);for(let E=0;E<r.length;E+=1)q(r[E]);q(z),f=!1},d(A){A&&(F(e),F(s),F(u),F(c)),b&&b.d(A),n[53](null);for(let E=0;E<r.length;E+=1)r[E].d(A);z&&z.d(A),d=!1,$e(p)}}}let Jo;const ni=it(null);function Dc(n,e,i){if(e==="self")return;const s=n.parentNode;if(!s)return;s.removeChild(n);const r=document.querySelector(`#anchors-${e}-${i.id}`);r&&(r.appendChild(n),n&&i.recalculateAnchors())}function Rc(n,e,i){let s,r,a,u,c=Gt,f=()=>(c(),c=fn(rt,w=>i(55,u=w)),rt),d,p=Gt,g,k,b=Gt,P=()=>(b(),b=fn(r,w=>i(9,k=w)),r),S,z,A,E,O=Gt,Z=()=>(O(),O=fn(a,w=>i(47,E=w)),a),Y,j,tt,J;pt(n,ni,w=>i(42,d=w)),n.$$.on_destroy.push(()=>c()),n.$$.on_destroy.push(()=>p()),n.$$.on_destroy.push(()=>b()),n.$$.on_destroy.push(()=>O());let{$$slots:et={},$$scope:ot}=e;const lt=me("dynamic"),N=me("node"),nt=me("edgeStore"),X=me("cursorAnchor"),ct=me("direction"),dt=me("mounted");pt(n,dt,w=>i(49,j=w));const Q=me("graph"),W=me("nodeStore"),At=me("graphEdge"),st=me("nodeConnectEvent");pt(n,st,w=>i(43,g=w));const yt=me("anchorsMounted");pt(n,yt,w=>i(56,tt=w));const Lt=me("flowchart")||void 0;let{bgColor:_t=null}=e,{id:R=0}=e,{input:U=!1}=e,{output:H=!1}=e,{multiple:K=H?!0:!U}=e,{dynamic:Nt=lt||!1}=e,{edge:Wt=null}=e,{inputsStore:rt=null}=e;f();let{key:Ct=null}=e,{outputStore:Mt=null}=e,{connections:xt=[]}=e,{edgeColor:qt=it(null)}=e,{edgeLabel:we=""}=e,{locked:fe=!1}=e,{nodeConnect:$=!1}=e,{edgeStyle:Ot=null}=e,{endStyles:zt=[null,null]}=e,{invisible:Tt=!1}=e,{direction:Ft=ct==="TD"?U?"north":"south":U?"west":"east"}=e,{title:Ut=""}=e;const xe=Zi(),Ke=Zi();let De,Yt=!1,Re=!1,ie=0,tn=U===H?null:U?"input":"output",be=[];const pe=N.edge,Ee=N.anchors;pt(n,Ee,w=>i(48,Y=w));const je=N.resizingWidth;pt(n,je,w=>i(46,A=w));const We=N.resizingHeight;pt(n,We,w=>i(45,z=w));const en=N.rotating;pt(n,en,w=>i(44,S=w));const ke=N.connections;pt(n,ke,w=>i(57,J=w));const He=`A-${R||Ee.count()+1}/${N.id}`,jt=uc(Q,N,He,{x:0,y:0},{width:0,height:0},rt||Mt||null,Wt||pe||At||null,tn,Ft,Nt,Ct,qt);Ee.add(jt,jt.id),Hn(()=>{De&&jt.recalculatePosition();const w=Array.from(wt(N.anchors)).reduce((mt,[,Pt])=>(Pt.type==="output"&&mt++,mt),0);if(J!=null&&J.length&&!U){const mt=[];let Pt=null;J.forEach((kt,Et)=>{kt&&(Pt===null&&(Pt=Et),(Et-Pt)%w===0?(be.push(kt),mt.push(null)):mt.push(kt))}),Bt(ke,J=mt,J)}Bt(yt,tt++,tt)}),Ql(()=>{De&&jt.recalculatePosition()}),io(()=>{vn(),cancelAnimationFrame(Jo)});function Ge(w){var _e;nt.delete("cursor");const mt={x:w.changedTouches[0].clientX,y:w.changedTouches[0].clientY},Pt=document.elementFromPoint(mt.x,mt.y);if(!Pt)return;const kt=Pt.parentElement;if(!kt)return;const Et=kt.id,x=Et.split("/")[1],Kt=(_e=W.get(x))==null?void 0:_e.anchors.get(Et);Kt&&(nt.delete("cursor"),Ye(jt,Kt,w))}function Ye(w,mt,Pt){const kt=gn(w,mt);kt&&ue(),Pt.shiftKey||qe(kt)}function bn(w){if("changedTouches"in w&&s){Ge(w);return}if(!s){if(k!=null&&k.size&&!K){nt.delete("cursor"),w.shiftKey||qe(!1);return}d&&Fe(w)}}function nn(w){if(!fe){if(k!=null&&k.size&&!K&&!d)return Nn();if(!d)return on();Fe(w)}}function on(){U===H?(Bt(ni,d={anchor:jt,store:null,key:null},d),Oe(jt,X)):U?(Bt(ni,d={anchor:jt,store:rt,key:Ct},d),Oe(X,jt)):H&&(Bt(ni,d={anchor:jt,store:Mt,key:null},d),Oe(jt,X))}function Oe(w,mt,Pt=!1){const kt={color:qt,label:{text:we}};Pt&&(kt.disconnect=!0),Ot&&(kt.type=Ot),zt[0]&&(kt.start=zt[0]),zt[1]&&(kt.start=zt[1]);const Et=Ys({source:w,target:mt},(w==null?void 0:w.edge)||null,kt);nt.add(Et,"cursor")}function Fe(w){if(nt.delete("cursor"),!d)return;const mt=d.anchor.type;if(d.anchor===jt||mt===jt.type&&mt){qe(!1);return}jt.recalculatePosition();let Pt,kt;U===H?mt==="input"?(Pt=jt,kt=d.anchor):(Pt=d.anchor,kt=jt):U?(Pt=d.anchor,kt=jt):(Pt=jt,kt=d.anchor),Ye(Pt,kt,w)}function gn(w,mt){if(w===mt||wt(w.connected).has(jt))return!1;const Pt={color:qt,label:{text:we}};if(Lt){const Et=w.node.id.slice(2),x=Lt.nodeList[Et];if(x){const Kt=mt.node.id.slice(2),_e=x.children.filter(Jt=>Jt.node.id===Kt)[0];if(_e){const Jt=_e;Pt.label={text:Jt.content}}}}Ot&&(Pt.type=Ot),zt[0]&&(Pt.start=zt[0]),zt[1]&&(Pt.start=zt[1]);const kt=Ys({source:w,target:mt},(w==null?void 0:w.edge)||null,Pt);return!w.node||!mt.node?!1:(nt.add(kt,new Set([w,mt,w.node,mt.node])),!0)}function ue(){if(U&&d&&d.store)u&&Ct&&rt&&typeof rt.set=="function"&&typeof rt.update=="function"&&Bt(rt,u[Ct]=d.store,u);else if(H&&d&&d.store){const{store:w,key:mt}=d;w&&mt&&typeof w.update=="function"&&w.update(Pt=>(Mt&&(Pt[mt]=Mt),Pt))}}function de(){u&&Ct&&u[Ct]&&Bt(rt,u[Ct]=it(wt(u[Ct])),u)}function qe(w){(w||!g)&&(Bt(ni,d=null,d),Bt(st,g=null,g))}function kn(){Yt&&(De&&jt.recalculatePosition(),Jo=requestAnimationFrame(kn))}function vn(){nt.delete("cursor"),nt.match(jt).forEach(mt=>nt.delete(mt)),qe(!1),de()}function Nn(){if(wt(jt.connected).size>1)return;const w=Array.from(wt(jt.connected))[0];if(w.type!=="input")if(vn(),w.type==="output"){Oe(w,X,!0),de();const mt=w.store;Bt(ni,d={anchor:w,store:mt,key:null},d)}else Oe(w,X,!0),Bt(ni,d={anchor:w,store:null,key:null},d)}function Mn(){be.forEach((w,mt)=>{if(!w)return;yn(w)&&i(26,xt[mt]=null,xt)}),i(41,be=be.filter(w=>w!==null))}function Be(){xt.forEach(w=>{w&&yn(w)})}function bt(w){const mt=`N-${w[0]}`,Pt=W.get(mt);if(!Pt)return;const kt=Pt.anchors.get(`A-${w[1]}/N-${w[0]}`);if(!kt)return;const Et=nt.match(jt,kt);Et&&nt.delete(Et[0])}const yn=w=>{let mt,Pt,kt=null;Array.isArray(w)?(mt=w[0].toString(),Pt=w[1].toString()):(mt=w.toString(),Pt=null);const Et=`N-${mt}`,x=W.get(Et);if(!x)return!1;if(Pt){const Kt=`A-${Pt}/${Et}`;kt=x.anchors.get(Kt)||null}else{const Kt=wt(x.anchors),_e=Array.from(Kt.values());if(!_e.length)return!1;kt=_e.reduce((Jt,Pe)=>!Jt&&Pe.type==="output"?null:Pe.type==="output"?Jt:!Jt||wt(Pe.connected).size<wt(Jt.connected).size?Pe:Jt,null)}if(!kt)return!1;if(gn(jt,kt),kt.store&&(rt||Mt)){if(U&&kt.type==="output")u&&Ct&&rt&&typeof rt.set=="function"&&typeof rt.update=="function"&&Bt(rt,u[Ct]=kt.store,u);else if(H&&kt.type==="input"){const{store:Kt,inputKey:_e}=kt;Kt&&_e&&typeof Kt.update=="function"&&Kt.update(Jt=>(Mt&&(Jt[_e]=Mt),Jt))}}return!0},wn=()=>i(10,Re=!0),cn=()=>i(10,Re=!1);function Pn(w){Xn[w?"unshift":"push"](()=>{De=w,i(8,De)})}return n.$$set=w=>{"bgColor"in w&&i(0,_t=w.bgColor),"id"in w&&i(27,R=w.id),"input"in w&&i(1,U=w.input),"output"in w&&i(2,H=w.output),"multiple"in w&&i(28,K=w.multiple),"dynamic"in w&&i(29,Nt=w.dynamic),"edge"in w&&i(7,Wt=w.edge),"inputsStore"in w&&f(i(3,rt=w.inputsStore)),"key"in w&&i(30,Ct=w.key),"outputStore"in w&&i(31,Mt=w.outputStore),"connections"in w&&i(26,xt=w.connections),"edgeColor"in w&&i(32,qt=w.edgeColor),"edgeLabel"in w&&i(33,we=w.edgeLabel),"locked"in w&&i(4,fe=w.locked),"nodeConnect"in w&&i(34,$=w.nodeConnect),"edgeStyle"in w&&i(35,Ot=w.edgeStyle),"endStyles"in w&&i(36,zt=w.endStyles),"invisible"in w&&i(5,Tt=w.invisible),"direction"in w&&i(37,Ft=w.direction),"title"in w&&i(6,Ut=w.title),"$$scope"in w&&i(54,ot=w.$$scope)},n.$$.update=()=>{if(n.$$.dirty[1]&2048&&i(11,s=(d==null?void 0:d.anchor)===jt),n.$$.dirty[0]&536871168|n.$$.dirty[1]&65536&&Nt&&De&&Dc(De,E,N),n.$$.dirty[0]&67108864|n.$$.dirty[1]&262144&&j===W.count()&&xt.length&&Be(),n.$$.dirty[1]&4104&&$&&g&&bn(g),n.$$.dirty[1]&263168&&j===W.count()&&be.length&&Mn(),n.$$.dirty[0]&768|n.$$.dirty[1]&196608&&De&&jt.recalculatePosition(),n.$$.dirty[1]&57600&&(!Yt&&(A||z||S)?(i(39,Yt=!0),kn()):!A&&!z&&Yt&&!S&&(i(39,Yt=!1),cancelAnimationFrame(Jo))),n.$$.dirty[0]&512|n.$$.dirty[1]&512&&k){if(k.size<ie)Ke("disconnection",{node:N,anchor:jt});else if(k.size>ie){const w=Array.from(k),mt=w[w.length-1];xe("connection",{node:N,anchor:jt,connectedNode:mt.node,connectedAnchor:mt})}i(40,ie=k.size)}},P(i(13,r=jt&&jt.connected)),Z(i(12,a=jt==null?void 0:jt.direction)),[_t,U,H,rt,fe,Tt,Ut,Wt,De,k,Re,s,a,r,nt,dt,st,yt,Ee,je,We,en,ke,jt,bn,nn,xt,R,K,Nt,Ct,Mt,qt,we,$,Ot,zt,Ft,bt,Yt,ie,be,d,g,S,z,A,E,Y,j,et,wn,cn,Pn,ot]}class Eo extends pn{constructor(e){super(),mn(this,e,Rc,Zc,un,{bgColor:0,id:27,input:1,output:2,multiple:28,dynamic:29,edge:7,inputsStore:3,key:30,outputStore:31,connections:26,edgeColor:32,edgeLabel:33,locked:4,nodeConnect:34,edgeStyle:35,endStyles:36,invisible:5,direction:37,title:6,disconnect:38},null,[-1,-1,-1])}get disconnect(){return this.$$.ctx[38]}}function fr(n){let e,i,s,r,a;return{c(){e=M("div"),i=V(),s=M("div"),m(e,"class","left svelte-1ryxg7v"),$t(e,"width",n[0]),m(s,"class","right svelte-1ryxg7v"),$t(s,"width",n[0])},m(u,c){G(u,e,c),G(u,i,c),G(u,s,c),r||(a=[pi(n[16].call(null,e,{left:n[3]})),pi(n[16].call(null,s,{right:n[4]}))],r=!0)},p(u,c){c[0]&1&&$t(e,"width",u[0]),c[0]&1&&$t(s,"width",u[0])},d(u){u&&(F(e),F(i),F(s)),r=!1,$e(a)}}}function dr(n){let e,i,s,r,a;return{c(){e=M("div"),i=V(),s=M("div"),m(e,"class","top svelte-1ryxg7v"),$t(e,"height",n[1]),m(s,"class","bottom svelte-1ryxg7v"),$t(s,"height",n[1])},m(u,c){G(u,e,c),G(u,i,c),G(u,s,c),r||(a=[pi(n[16].call(null,e,{top:n[5]})),pi(n[16].call(null,s,{bottom:n[6]}))],r=!0)},p(u,c){c[0]&2&&$t(e,"height",u[1]),c[0]&2&&$t(s,"height",u[1])},d(u){u&&(F(e),F(i),F(s)),r=!1,$e(a)}}}function jc(n){let e,i,s;return{c(){e=M("div"),m(e,"class","svelte-1ryxg7v"),$t(e,"both",n[7])},m(r,a){G(r,e,a),i||(s=pi(n[16].call(null,e,{both:n[7]})),i=!0)},p:Gt,d(r){r&&F(e),i=!1,s()}}}function _r(n){let e,i,s;return{c(){e=M("div"),m(e,"class","svelte-1ryxg7v"),$t(e,"rotation",n[2])},m(r,a){G(r,e,a),i||(s=pi(n[17].call(null,e)),i=!0)},p(r,a){a[0]&4&&$t(e,"rotation",r[2])},d(r){r&&F(e),i=!1,s()}}}function Wc(n){let e,i,s,r,a=n[0]&&fr(n),u=n[1]&&dr(n),c=n[7]&&jc(n),f=n[2]&&_r(n);return{c(){a&&a.c(),e=V(),u&&u.c(),i=V(),c&&c.c(),s=V(),f&&f.c(),r=ze()},m(d,p){a&&a.m(d,p),G(d,e,p),u&&u.m(d,p),G(d,i,p),c&&c.m(d,p),G(d,s,p),f&&f.m(d,p),G(d,r,p)},p(d,p){d[0]?a?a.p(d,p):(a=fr(d),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null),d[1]?u?u.p(d,p):(u=dr(d),u.c(),u.m(i.parentNode,i)):u&&(u.d(1),u=null),d[7]&&c.p(d,p),d[2]?f?f.p(d,p):(f=_r(d),f.c(),f.m(r.parentNode,r)):f&&(f.d(1),f=null)},i:Gt,o:Gt,d(d){d&&(F(e),F(i),F(s),F(r)),a&&a.d(d),u&&u.d(d),c&&c.d(d),f&&f.d(d)}}}function Hc(n){return n*(180/Math.PI)}function Fc(n,e,i){let s,r,a,u,c,f,d,p,g,k,b,P;pt(n,On,rt=>i(38,d=rt));const S=me("graph"),z=me("node"),A=me("resized");let{width:E=!1}=e,{height:O=!1}=e,{rotation:Z=!1}=e,{minHeight:Y=0}=e,{minWidth:j=0}=e,tt,J=E,et=E,ot=O,lt=O,N=E&&O,nt=0,X=0,ct=wt(z.position);const dt=z.position;pt(n,dt,rt=>i(32,b=rt));const Q=z.resizingWidth;pt(n,Q,rt=>i(31,k=rt));const W=z.resizingHeight;pt(n,W,rt=>i(30,g=rt));const At=z.rotating;pt(n,At,rt=>i(28,f=rt));const st=z.rotation;pt(n,st,rt=>i(29,p=rt));const yt=z.dimensions.height;pt(n,yt,rt=>i(26,u=rt));const Lt=z.dimensions.width;pt(n,Lt,rt=>i(27,c=rt));const _t=S.cursor;pt(n,_t,rt=>i(33,P=rt));let R,U,H=1;Hn(()=>{try{tt=document.querySelector(`#${z.id}`),tt&&i(19,[j,Y]=Uo(tt),j,i(18,Y))}catch(rt){console.error(rt)}});function K(rt,Ct){const Mt=qt=>{qt.stopPropagation(),qt.preventDefault(),Ct.left||Ct.top?i(23,H=-1):i(23,H=1),ns.set(!0),Bt(On,d=wt(_t),d),i(21,R=c),i(22,U=u),i(20,ct=b),Ct.both?Bt(Q,k=!0,k):Bt(Q,k=!1,k),Bt(Q,k=Ct.left||Ct.right||Ct.both||!1,k),Bt(W,g=Ct.top||Ct.bottom||Ct.both||!1,g),tt&&i(19,[j,Y]=Uo(tt),j,i(18,Y)),window.addEventListener("mouseup",xt)},xt=()=>{Bt(Q,k=!1,k),Bt(W,g=!1,g),ns.set(!1),window.removeEventListener("mouseup",xt)};return rt.addEventListener("mousedown",Mt),{destroy(){rt.removeEventListener("mousedown",Mt)}}}function Nt(rt){const Ct=xt=>{xt.stopPropagation(),xt.preventDefault(),nt=p,Bt(On,d=wt(_t),d);const qt=d.x-a.x,we=d.y-a.y;X=Math.atan2(we,qt),Bt(At,f=!0,f),window.addEventListener("mouseup",Mt)},Mt=()=>{Bt(At,f=!1,f),window.removeEventListener("mouseup",Mt)};return rt.addEventListener("mousedown",Ct),{destroy(){rt.removeEventListener("mousedown",Ct)}}}function Wt(){const rt=wt(_t),Ct=rt.x-a.x,Mt=rt.y-a.y,xt=Math.atan2(Mt,Ct),qt=X-xt;return nt-Hc(qt)}return vu(()=>{tt&&i(19,[j,Y]=Uo(tt),j,i(18,Y)),c<j&&A.set(!1),u<Y&&A.set(!1)}),n.$$set=rt=>{"width"in rt&&i(0,E=rt.width),"height"in rt&&i(1,O=rt.height),"rotation"in rt&&i(2,Z=rt.rotation),"minHeight"in rt&&i(18,Y=rt.minHeight),"minWidth"in rt&&i(19,j=rt.minWidth)},n.$$.update=()=>{if(n.$$.dirty[0]&268435456|n.$$.dirty[1]&4&&f&&Bt(st,p=Wt(),p),n.$$.dirty[0]&1624506368|n.$$.dirty[1]&4&&g){const rt=wt(On),Ct=P,Mt=Math.max(Y,U+(Ct.y-rt.y)*H);Mt>Y?(A.set(!0),Bt(yt,u=Mt,u)):A.set(!1),H===-1&&Bt(dt,b={x:ct.x,y:ct.y+Ct.y-rt.y},b),p!==0&&z.position.update(xt=>({y:ct.y-(Mt-U)/2,x:xt.x}))}if(n.$$.dirty[0]&548929536|n.$$.dirty[1]&5&&k){const rt=wt(On),Ct=P,Mt=Math.max(j,R+(Ct.x-rt.x)*H);Mt>j?(A.set(!0),Bt(Lt,c=Mt,c)):A.set(!1),H===-1&&Bt(dt,b={x:ct.x+Ct.x-rt.x,y:ct.y},b),p!==0&&z.position.update(xt=>({x:ct.x-(Mt-R)/2,y:xt.y}))}n.$$.dirty[1]&2&&i(25,s=b.x),n.$$.dirty[1]&2&&i(24,r=b.y),n.$$.dirty[0]&251658240&&(a={x:s+c/2,y:r+u/2})},[E,O,Z,J,et,ot,lt,N,dt,Q,W,At,st,yt,Lt,_t,K,Nt,Y,j,ct,R,U,H,r,s,u,c,f,p,g,k,b,P]}class Gc extends pn{constructor(e){super(),mn(this,e,Fc,Wc,un,{width:0,height:1,rotation:2,minHeight:18,minWidth:19},null,[-1,-1])}}function mr(n,e,i){const s=n.slice();return s[28]=e[i],s[34]=i,s}function pr(n,e,i){const s=n.slice();return s[28]=e[i],s[34]=i,s}function gr(n,e,i){const s=n.slice();return s[28]=e[i],s}function vr(n,e,i){const s=n.slice();return s[28]=e[i],s}function Uc(n){let e,i=[],s=new Map,r,a,u=[],c=new Map,f,d=Ae({length:n[2]});const p=b=>b[34];for(let b=0;b<d.length;b+=1){let P=pr(n,d,b),S=p(P);s.set(S,i[b]=yr(S,P))}let g=Ae({length:n[3]});const k=b=>b[34];for(let b=0;b<g.length;b+=1){let P=mr(n,g,b),S=k(P);c.set(S,u[b]=wr(S,P))}return{c(){e=M("div");for(let b=0;b<i.length;b+=1)i[b].c();r=V(),a=M("div");for(let b=0;b<u.length;b+=1)u[b].c();m(e,"class","input-anchors svelte-j5bq7k"),$t(e,"top",n[14]),$t(e,"left",n[16]),m(a,"class","output-anchors svelte-j5bq7k"),$t(a,"bottom",n[15]),$t(a,"right",n[17])},m(b,P){G(b,e,P);for(let S=0;S<i.length;S+=1)i[S]&&i[S].m(e,null);G(b,r,P),G(b,a,P);for(let S=0;S<u.length;S+=1)u[S]&&u[S].m(a,null);f=!0},p(b,P){P[0]&16388&&(d=Ae({length:b[2]}),ve(),i=hi(i,P,p,1,b,d,s,e,eo,yr,null,pr),ye()),P[0]&16392&&(g=Ae({length:b[3]}),ve(),u=hi(u,P,k,1,b,g,c,a,eo,wr,null,mr),ye())},i(b){if(!f){for(let P=0;P<d.length;P+=1)B(i[P]);for(let P=0;P<g.length;P+=1)B(u[P]);f=!0}},o(b){for(let P=0;P<i.length;P+=1)q(i[P]);for(let P=0;P<u.length;P+=1)q(u[P]);f=!1},d(b){b&&(F(e),F(r),F(a));for(let P=0;P<i.length;P+=1)i[P].d();for(let P=0;P<u.length;P+=1)u[P].d()}}}function Vc(n){let e,i,s,r=Ae({length:n[2]}),a=[];for(let p=0;p<r.length;p+=1)a[p]=br(vr(n,r,p));const u=p=>q(a[p],1,1,()=>{a[p]=null});let c=Ae({length:n[3]}),f=[];for(let p=0;p<c.length;p+=1)f[p]=kr(gr(n,c,p));const d=p=>q(f[p],1,1,()=>{f[p]=null});return{c(){for(let p=0;p<a.length;p+=1)a[p].c();e=V();for(let p=0;p<f.length;p+=1)f[p].c();i=ze()},m(p,g){for(let k=0;k<a.length;k+=1)a[k]&&a[k].m(p,g);G(p,e,g);for(let k=0;k<f.length;k+=1)f[k]&&f[k].m(p,g);G(p,i,g),s=!0},p(p,g){if(g[0]&4){const k=r.length;r=Ae({length:p[2]});let b;for(b=k;b<r.length;b+=1){const P=vr(p,r,b);a[b]?B(a[b],1):(a[b]=br(P),a[b].c(),B(a[b],1),a[b].m(e.parentNode,e))}for(ve(),b=r.length;b<a.length;b+=1)u(b);ye()}if(g[0]&8){const k=c.length;c=Ae({length:p[3]});let b;for(b=k;b<c.length;b+=1){const P=gr(p,c,b);f[b]?B(f[b],1):(f[b]=kr(P),f[b].c(),B(f[b],1),f[b].m(i.parentNode,i))}for(ve(),b=c.length;b<f.length;b+=1)d(b);ye()}},i(p){if(!s){for(let g=0;g<r.length;g+=1)B(a[g]);for(let g=0;g<c.length;g+=1)B(f[g]);s=!0}},o(p){a=a.filter(Boolean);for(let g=0;g<a.length;g+=1)q(a[g]);f=f.filter(Boolean);for(let g=0;g<f.length;g+=1)q(f[g]);s=!1},d(p){p&&(F(e),F(i)),Li(a,p),Li(f,p)}}}function yr(n,e){let i,s,r;return s=new Eo({props:{input:!0,direction:e[14]?"north":"west"}}),s.$on("connection",e[22]),s.$on("disconnection",e[23]),{key:n,first:null,c(){i=ze(),he(s.$$.fragment),this.first=i},m(a,u){G(a,i,u),le(s,a,u),r=!0},p(a,u){e=a},i(a){r||(B(s.$$.fragment,a),r=!0)},o(a){q(s.$$.fragment,a),r=!1},d(a){a&&F(i),ae(s,a)}}}function wr(n,e){let i,s,r;return s=new Eo({props:{output:!0,direction:e[14]?"south":"east"}}),s.$on("connection",e[24]),s.$on("disconnection",e[25]),{key:n,first:null,c(){i=ze(),he(s.$$.fragment),this.first=i},m(a,u){G(a,i,u),le(s,a,u),r=!0},p(a,u){e=a},i(a){r||(B(s.$$.fragment,a),r=!0)},o(a){q(s.$$.fragment,a),r=!1},d(a){a&&F(i),ae(s,a)}}}function br(n){let e,i;return e=new Eo({}),e.$on("connection",n[18]),e.$on("disconnection",n[19]),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function kr(n){let e,i;return e=new Eo({}),e.$on("connection",n[20]),e.$on("disconnection",n[21]),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Pr(n){let e,i;return e=new Gc({props:{width:!0,height:!0,rotation:!0}}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Xc(n){let e,i,s,r,a,u,c,f=`${n[1]}px`,d;const p=[Vc,Uc],g=[];function k(P,S){return P[7]?0:1}i=k(n),s=g[i]=p[i](n);let b=n[6]&&Pr();return{c(){e=M("div"),s.c(),r=V(),a=M("p"),u=re(n[5]),c=V(),b&&b.c(),m(a,"class","svelte-j5bq7k"),at(a,"color",n[4]),m(e,"class","default-node svelte-j5bq7k"),$t(e,"selected",n[0]),at(e,"border-radius",f)},m(P,S){G(P,e,S),g[i].m(e,null),y(e,r),y(e,a),y(a,u),y(e,c),b&&b.m(e,null),d=!0},p(P,S){s.p(P,S),(!d||S[0]&32)&&an(u,P[5]),S[0]&16&&at(a,"color",P[4]),P[6]?b?S[0]&64&&B(b,1):(b=Pr(),b.c(),B(b,1),b.m(e,null)):b&&(ve(),q(b,1,1,()=>{b=null}),ye()),(!d||S[0]&1)&&$t(e,"selected",P[0]),S[0]&2&&f!==(f=`${P[1]}px`)&&at(e,"border-radius",f)},i(P){d||(B(s),B(b),d=!0)},o(P){q(s),q(b),d=!1},d(P){P&&F(e),g[i].d(),b&&b.d()}}}function Yc(n,e,i){let s,r,a,u,c,f;const d=me("dynamic"),p=me("node");let{selected:g}=e;const k=p.label;pt(n,k,ct=>i(5,c=ct));const b=p.borderRadius;pt(n,b,ct=>i(1,s=ct));const P=p.textColor;pt(n,P,ct=>i(4,u=ct));const S=p.inputs;pt(n,S,ct=>i(2,r=ct));const z=p.outputs;pt(n,z,ct=>i(3,a=ct));const A=p.resizable;pt(n,A,ct=>i(6,f=ct));const E=wt(p.direction);let O=E==="TD",Z=E==="TD",Y=E!=="TD",j=E!=="TD";function tt(ct){Xe.call(this,n,ct)}function J(ct){Xe.call(this,n,ct)}function et(ct){Xe.call(this,n,ct)}function ot(ct){Xe.call(this,n,ct)}function lt(ct){Xe.call(this,n,ct)}function N(ct){Xe.call(this,n,ct)}function nt(ct){Xe.call(this,n,ct)}function X(ct){Xe.call(this,n,ct)}return n.$$set=ct=>{"selected"in ct&&i(0,g=ct.selected)},[g,s,r,a,u,c,f,d,k,b,P,S,z,A,O,Z,Y,j,tt,J,et,ot,lt,N,nt,X]}class qc extends pn{constructor(e){super(),mn(this,e,Yc,Xc,un,{selected:0},null,[-1,-1])}}const Kc=n=>({}),Lr=n=>({}),Jc=n=>({}),Cr=n=>({}),Qc=n=>({}),Sr=n=>({}),$c=n=>({}),Mr=n=>({}),th=n=>({selected:n[0]&2048}),Tr=n=>({grabHandle:n[50],selected:n[11],destroy:n[48]}),eh=n=>({selected:n[0]&2048}),Er=n=>({grabHandle:n[50],selected:n[11],destroy:n[48]});function Ar(n){let e,i,s,r,a,u,c,f,d,p,g,k,b,P,S,z=`${n[14].y}px`,A=`${n[14].x}px`,E=`rotate(${n[20]}deg)`,O,Z,Y;const j=[ih,nh],tt=[];function J(Q,W){return Q[12]?1:0}i=J(n),s=tt[i]=j[i](n);const et=n[61].anchorWest,ot=Ce(et,n,n[60],Mr),lt=n[61].anchorEast,N=Ce(lt,n,n[60],Sr),nt=n[61].anchorNorth,X=Ce(nt,n,n[60],Cr),ct=n[61].anchorSouth,dt=Ce(ct,n,n[60],Lr);return{c(){e=M("div"),s.c(),r=V(),a=M("div"),ot&&ot.c(),c=V(),f=M("div"),N&&N.c(),p=V(),g=M("div"),X&&X.c(),b=V(),P=M("div"),dt&&dt.c(),m(a,"id",u=`anchors-west-${n[0].id}`),m(a,"class","anchors left svelte-1iknrz0"),m(f,"id",d=`anchors-east-${n[0].id}`),m(f,"class","anchors right svelte-1iknrz0"),m(g,"id",k=`anchors-north-${n[0].id}`),m(g,"class","anchors top svelte-1iknrz0"),m(P,"id",S=`anchors-south-${n[0].id}`),m(P,"class","anchors bottom svelte-1iknrz0"),m(e,"id",n[30]),m(e,"class","svelvet-node svelte-1iknrz0"),m(e,"role","button"),m(e,"title",n[10]),m(e,"tabindex",0),$t(e,"selected",n[11]),$t(e,"locked",n[16]||n[15]),at(e,"top",z),at(e,"left",A),at(e,"z-index",n[17]),at(e,"width",n[12]?n[19]+"px":"fit-content"),at(e,"height",n[12]?n[18]+"px":"fit-content"),at(e,"transform",E),at(e,"--prop-background-color",n[21]||(n[1]||n[2]?null:"transparent")),at(e,"--prop-text-color",n[22]),at(e,"--prop-border-color",n[23]),at(e,"--prop-selection-color",n[24]),at(e,"--prop-border-radius",n[25]?`${n[25]}px`:n[1]||n[2]?null:"0px"),at(e,"--prop-border-width",n[26]||(n[1]||n[2]?null:"0px"))},m(Q,W){G(Q,e,W),tt[i].m(e,null),y(e,r),y(e,a),ot&&ot.m(a,null),y(e,c),y(e,f),N&&N.m(f,null),y(e,p),y(e,g),X&&X.m(g,null),y(e,b),y(e,P),dt&&dt.m(P,null),O=!0,Z||(Y=[ht(e,"contextmenu",Wn(jn(n[62]))),ht(e,"mouseup",n[49]),pi(n[50].call(null,e))],Z=!0)},p(Q,W){let At=i;i=J(Q),i===At?tt[i].p(Q,W):(ve(),q(tt[At],1,1,()=>{tt[At]=null}),ye(),s=tt[i],s?s.p(Q,W):(s=tt[i]=j[i](Q),s.c()),B(s,1),s.m(e,r)),ot&&ot.p&&(!O||W[1]&536870912)&&Me(ot,et,Q,Q[60],O?Se(et,Q[60],W,$c):Te(Q[60]),Mr),(!O||W[0]&1&&u!==(u=`anchors-west-${Q[0].id}`))&&m(a,"id",u),N&&N.p&&(!O||W[1]&536870912)&&Me(N,lt,Q,Q[60],O?Se(lt,Q[60],W,Qc):Te(Q[60]),Sr),(!O||W[0]&1&&d!==(d=`anchors-east-${Q[0].id}`))&&m(f,"id",d),X&&X.p&&(!O||W[1]&536870912)&&Me(X,nt,Q,Q[60],O?Se(nt,Q[60],W,Jc):Te(Q[60]),Cr),(!O||W[0]&1&&k!==(k=`anchors-north-${Q[0].id}`))&&m(g,"id",k),dt&&dt.p&&(!O||W[1]&536870912)&&Me(dt,ct,Q,Q[60],O?Se(ct,Q[60],W,Kc):Te(Q[60]),Lr),(!O||W[0]&1&&S!==(S=`anchors-south-${Q[0].id}`))&&m(P,"id",S),(!O||W[0]&1024)&&m(e,"title",Q[10]),(!O||W[0]&2048)&&$t(e,"selected",Q[11]),(!O||W[0]&98304)&&$t(e,"locked",Q[16]||Q[15]),W[0]&16384&&z!==(z=`${Q[14].y}px`)&&at(e,"top",z),W[0]&16384&&A!==(A=`${Q[14].x}px`)&&at(e,"left",A),W[0]&131072&&at(e,"z-index",Q[17]),W[0]&528384&&at(e,"width",Q[12]?Q[19]+"px":"fit-content"),W[0]&266240&&at(e,"height",Q[12]?Q[18]+"px":"fit-content"),W[0]&1048576&&E!==(E=`rotate(${Q[20]}deg)`)&&at(e,"transform",E),W[0]&2097158&&at(e,"--prop-background-color",Q[21]||(Q[1]||Q[2]?null:"transparent")),W[0]&4194304&&at(e,"--prop-text-color",Q[22]),W[0]&8388608&&at(e,"--prop-border-color",Q[23]),W[0]&16777216&&at(e,"--prop-selection-color",Q[24]),W[0]&33554438&&at(e,"--prop-border-radius",Q[25]?`${Q[25]}px`:Q[1]||Q[2]?null:"0px"),W[0]&67108870&&at(e,"--prop-border-width",Q[26]||(Q[1]||Q[2]?null:"0px"))},i(Q){O||(B(s),B(ot,Q),B(N,Q),B(X,Q),B(dt,Q),O=!0)},o(Q){q(s),q(ot,Q),q(N,Q),q(X,Q),q(dt,Q),O=!1},d(Q){Q&&F(e),tt[i].d(),ot&&ot.d(Q),N&&N.d(Q),X&&X.d(Q),dt&&dt.d(Q),Z=!1,$e(Y)}}}function nh(n){let e;const i=n[61].default,s=Ce(i,n,n[60],Tr);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[0]&2048|a[1]&536870912)&&Me(s,i,r,r[60],e?Se(i,r[60],a,th):Te(r[60]),Tr)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function ih(n){let e,i,s;const r=n[61].default,a=Ce(r,n,n[60],Er);return{c(){e=M("div"),a&&a.c(),vi(()=>n[63].call(e)),at(e,"width","fit-content"),at(e,"height","fit-content")},m(u,c){G(u,e,c),a&&a.m(e,null),i=pu(e,n[63].bind(e)),s=!0},p(u,c){a&&a.p&&(!s||c[0]&2048|c[1]&536870912)&&Me(a,r,u,u[60],s?Se(r,u[60],c,eh):Te(u[60]),Er)},i(u){s||(B(a,u),s=!0)},o(u){q(a,u),s=!1},d(u){u&&F(e),a&&a.d(u),i()}}}function oh(n){let e,i,s=!n[13]&&Ar(n);return{c(){s&&s.c(),e=ze()},m(r,a){s&&s.m(r,a),G(r,e,a),i=!0},p(r,a){r[13]?s&&(ve(),q(s,1,1,()=>{s=null}),ye()):s?(s.p(r,a),a[0]&8192&&B(s,1)):(s=Ar(r),s.c(),B(s,1),s.m(e.parentNode,e))},i(r){i||(B(s),i=!0)},o(r){q(s),i=!1},d(r){r&&F(e),s&&s.d(r)}}}const sh=new Set(["INPUT","SELECT","BUTTON","TEXTAREA"]);function rh(n,e,i){let s,r,a,u,c,f,d,p=Gt,g=()=>(p(),p=fn(Yt,x=>i(66,d=x)),Yt),k,b=Gt,P=()=>(b(),b=fn(be,x=>i(67,k=x)),be),S,z,A=Gt,E=()=>(A(),A=fn(pe,x=>i(68,z=x)),pe),O,Z,Y,j=Gt,tt=()=>(j(),j=fn(Ee,x=>i(71,Y=x)),Ee),J,et,ot,lt=Gt,N=()=>(lt(),lt=fn(De,x=>i(16,ot=x)),De),nt,X=Gt,ct=()=>(X(),X=fn(Re,x=>i(73,nt=x)),Re),dt,Q,W,At,st=Gt,yt=()=>(st(),st=fn(ie,x=>i(75,At=x)),ie),Lt,_t,R,U,H,K,Nt,Wt,rt,Ct,Mt,xt;pt(n,On,x=>i(65,f=x)),pt(n,Zn,x=>i(70,Z=x)),n.$$.on_destroy.push(()=>p()),n.$$.on_destroy.push(()=>b()),n.$$.on_destroy.push(()=>A()),n.$$.on_destroy.push(()=>j()),n.$$.on_destroy.push(()=>lt()),n.$$.on_destroy.push(()=>X()),n.$$.on_destroy.push(()=>st());let{$$slots:qt={},$$scope:we}=e;const fe=me("mounted"),$=me("duplicate");pt(n,$,x=>i(56,_t=x));const Ot=me("graphDOMElement");pt(n,Ot,x=>i(74,Q=x));const zt=Zi();let{node:Tt}=e,{isDefault:Ft}=e,{useDefaults:Ut}=e,{center:xe}=e,{nodeStore:Ke}=e,{locked:De}=e;N();let{groups:Yt}=e;g();let{maxZIndex:Re}=e;ct();let{centerPoint:ie}=e;yt();let{cursor:tn}=e,{initialNodePositions:be}=e;P();let{activeGroup:pe}=e;E();let{editing:Ee}=e;tt();let{dimensionsProvided:je=!1}=e,{title:We}=e;const en=it(0),ke=it(null);pt(n,ke,x=>i(64,c=x));const He=Tt.id,jt=Tt.position;pt(n,jt,x=>i(59,H=x));const Ge=Tt.dimensions.width;pt(n,Ge,x=>i(19,Lt=x));const Ye=Tt.dimensions.height;pt(n,Ye,x=>i(18,W=x));const bn=Tt.selectionColor;pt(n,bn,x=>i(24,Ct=x));const nn=Tt.editable;pt(n,nn,x=>i(72,J=x));const on=Tt.locked;pt(n,on,x=>i(15,et=x));const Oe=Tt.zIndex;pt(n,Oe,x=>i(17,dt=x));const Fe=Tt.bgColor;pt(n,Fe,x=>i(21,Nt=x));const gn=Tt.borderRadius;pt(n,gn,x=>i(25,Mt=x));const ue=Tt.textColor;pt(n,ue,x=>i(22,Wt=x));const de=Tt.group;pt(n,de,x=>i(69,O=x));const qe=Tt.borderColor;pt(n,qe,x=>i(23,rt=x));const kn=Tt.borderWidth;pt(n,kn,x=>i(26,xt=x));const vn=Tt.rotation;pt(n,vn,x=>i(20,K=x));const{selected:Nn,hidden:Mn}=d,Be=Mn.nodes;pt(n,Be,x=>i(58,U=x));const bt=Nn.nodes;pt(n,bt,x=>i(55,S=x));const yn=it(!1);pt(n,yn,x=>i(57,R=x)),Ie("node",Tt),Ie("anchorsMounted",en),Ie("resized",yn),Ie("nodeConnectEvent",ke),Hn(()=>{if(xe){const x={x:At.x-Lt/2,y:At.y-W/2};Tt.position.set(x),Zn.set(!0),Zn.set(!1)}fe.update(x=>x+1)}),io(()=>{r&&(S.delete(Tt),bt.set(S)),fe.update(x=>x-1)});function wn(){r?(Tt&&S.delete(Tt),bt.set(S)):(Tt&&S.add(Tt),bt.set(S))}function cn(x){Bt(On,f=wt(tn),f),Q.focus(),dt!==nt&&dt!==1/0&&Bt(Oe,dt=Bt(Re,++nt,nt),dt);const Kt=x.target;if(!sh.has(Kt.tagName)&&(x.preventDefault(),zt("nodeClicked",{node:Tt,e:x}),!(ot||et))){if("touches"in x){if(x.touches&&x.touches.length>1)return}else x.button===2&&J&&Bt(Ee,Y=Tt,Y);Bt(Zn,Z=!0,Z),Pn(x)}}function Pn(x){let Kt,_e,Jt=!1;const Pe=O;Pe&&(Kt=d[Pe],_e=wt(Kt.parent),Jt=_e===Tt),Jt?Bt(pe,z=Pe,z):Bt(pe,z="selected",z),!x.shiftKey&&r?Bt(pe,z="selected",z):(!x.shiftKey&&!r&&!x.shiftKey&&(S.clear(),bt.set(S)),wn()),Bt(be,k=ca(d.selected.nodes),k)}function w(){Ke.delete(He)}function mt(x){const Kt=wt(tn),_e=Kt.x-f.x,Jt=Kt.y-f.y;Math.abs(_e)+Math.abs(Jt)<4&&zt("nodeReleased",{e:x,node:Tt}),Bt(ke,c=x,c)}function Pt(x){return x.addEventListener("mousedown",cn),x.addEventListener("touchstart",cn),{destroy(){x.removeEventListener("mousedown",cn),x.removeEventListener("touchstart",cn)}}}function kt(x){Xe.call(this,n,x)}function Et(){W=this.clientHeight,Ye.set(W),Lt=this.clientWidth,Ge.set(Lt)}return n.$$set=x=>{"node"in x&&i(0,Tt=x.node),"isDefault"in x&&i(1,Ft=x.isDefault),"useDefaults"in x&&i(2,Ut=x.useDefaults),"center"in x&&i(51,xe=x.center),"nodeStore"in x&&i(52,Ke=x.nodeStore),"locked"in x&&N(i(3,De=x.locked)),"groups"in x&&g(i(4,Yt=x.groups)),"maxZIndex"in x&&ct(i(5,Re=x.maxZIndex)),"centerPoint"in x&&yt(i(6,ie=x.centerPoint)),"cursor"in x&&i(53,tn=x.cursor),"initialNodePositions"in x&&P(i(7,be=x.initialNodePositions)),"activeGroup"in x&&E(i(8,pe=x.activeGroup)),"editing"in x&&tt(i(9,Ee=x.editing)),"dimensionsProvided"in x&&i(54,je=x.dimensionsProvided),"title"in x&&i(10,We=x.title),"$$scope"in x&&i(60,we=x.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&268435456&&i(14,s=H),n.$$.dirty[0]&1|n.$$.dirty[1]&16777216&&i(11,r=S.has(Tt)),n.$$.dirty[0]&1|n.$$.dirty[1]&134217728&&i(13,a=U.has(Tt)),n.$$.dirty[1]&75497472&&i(12,u=je||R),n.$$.dirty[0]&2049|n.$$.dirty[1]&33554432&&r&&_t&&zt("duplicate",Tt)},[Tt,Ft,Ut,De,Yt,Re,ie,be,pe,Ee,We,r,u,a,s,et,ot,dt,W,Lt,K,Nt,Wt,rt,Ct,Mt,xt,$,Ot,ke,He,jt,Ge,Ye,bn,nn,on,Oe,Fe,gn,ue,de,qe,kn,vn,Be,bt,yn,w,mt,Pt,xe,Ke,tn,je,S,_t,R,U,H,we,qt,kt,Et]}class lh extends pn{constructor(e){super(),mn(this,e,rh,oh,un,{node:0,isDefault:1,useDefaults:2,center:51,nodeStore:52,locked:3,groups:4,maxZIndex:5,centerPoint:6,cursor:53,initialNodePositions:7,activeGroup:8,editing:9,dimensionsProvided:54,title:10},null,[-1,-1,-1])}}const ah=n=>({selected:n[1]&262144,grabHandle:n[1]&524288,node:n[0]&128,destroy:n[1]&131072}),zr=n=>({selected:n[49],grabHandle:n[50],disconnect:n[14],connect:n[13],node:n[7],destroy:n[48]}),uh=n=>({}),Nr=n=>({slot:"anchorWest"}),ch=n=>({}),Ir=n=>({slot:"anchorEast"}),hh=n=>({}),xr=n=>({slot:"anchorNorth"}),fh=n=>({}),Or=n=>({slot:"anchorSouth"});function Br(n){let e,i;return e=new lh({props:{node:n[7],center:n[5]||n[0]==="center",isDefault:n[8],useDefaults:n[4],dimensionsProvided:!!n[1]||!!n[2]||!!n[3]||n[8]||!1,nodeStore:n[11].nodes,locked:n[11].locked,groups:n[11].groups,title:n[6],maxZIndex:n[11].maxZIndex,centerPoint:n[11].center,cursor:n[11].cursor,activeGroup:n[11].activeGroup,editing:n[11].editing,initialNodePositions:n[11].initialNodePositions,$$slots:{anchorSouth:[vh],anchorNorth:[gh],anchorEast:[ph],anchorWest:[mh],default:[_h,({destroy:s,selected:r,grabHandle:a})=>({48:s,49:r,50:a}),({destroy:s,selected:r,grabHandle:a})=>[0,(s?131072:0)|(r?262144:0)|(a?524288:0)]]},$$scope:{ctx:n}}}),e.$on("nodeClicked",n[41]),e.$on("nodeMount",n[42]),e.$on("nodeReleased",n[43]),e.$on("duplicate",n[44]),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},p(s,r){const a={};r[0]&128&&(a.node=s[7]),r[0]&33&&(a.center=s[5]||s[0]==="center"),r[0]&256&&(a.isDefault=s[8]),r[0]&16&&(a.useDefaults=s[4]),r[0]&270&&(a.dimensionsProvided=!!s[1]||!!s[2]||!!s[3]||s[8]||!1),r[0]&64&&(a.title=s[6]),r[0]&384|r[1]&933888&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Zr(n){let e,i;return e=new qc({props:{selected:n[49]}}),e.$on("connection",n[39]),e.$on("disconnection",n[40]),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},p(s,r){const a={};r[1]&262144&&(a.selected=s[49]),e.$set(a)},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function dh(n){let e,i,s=n[8]&&Zr(n);return{c(){s&&s.c(),e=ze()},m(r,a){s&&s.m(r,a),G(r,e,a),i=!0},p(r,a){r[8]?s?(s.p(r,a),a[0]&256&&B(s,1)):(s=Zr(r),s.c(),B(s,1),s.m(e.parentNode,e)):s&&(ve(),q(s,1,1,()=>{s=null}),ye())},i(r){i||(B(s),i=!0)},o(r){q(s),i=!1},d(r){r&&F(e),s&&s.d(r)}}}function _h(n){let e;const i=n[38].default,s=Ce(i,n,n[45],zr),r=s||dh(n);return{c(){r&&r.c()},m(a,u){r&&r.m(a,u),e=!0},p(a,u){s?s.p&&(!e||u[0]&128|u[1]&933888)&&Me(s,i,a,a[45],e?Se(i,a[45],u,ah):Te(a[45]),zr):r&&r.p&&(!e||u[0]&256|u[1]&262144)&&r.p(a,e?u:[-1,-1])},i(a){e||(B(r,a),e=!0)},o(a){q(r,a),e=!1},d(a){r&&r.d(a)}}}function mh(n){let e;const i=n[38].anchorWest,s=Ce(i,n,n[45],Nr);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&16384)&&Me(s,i,r,r[45],e?Se(i,r[45],a,uh):Te(r[45]),Nr)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function ph(n){let e;const i=n[38].anchorEast,s=Ce(i,n,n[45],Ir);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&16384)&&Me(s,i,r,r[45],e?Se(i,r[45],a,ch):Te(r[45]),Ir)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function gh(n){let e;const i=n[38].anchorNorth,s=Ce(i,n,n[45],xr);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&16384)&&Me(s,i,r,r[45],e?Se(i,r[45],a,hh):Te(r[45]),xr)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function vh(n){let e;const i=n[38].anchorSouth,s=Ce(i,n,n[45],Or);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&16384)&&Me(s,i,r,r[45],e?Se(i,r[45],a,fh):Te(r[45]),Or)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function yh(n){let e=n[7]&&n[10].get(n[7].id),i,s,r=e&&Br(n);return{c(){r&&r.c(),i=ze()},m(a,u){r&&r.m(a,u),G(a,i,u),s=!0},p(a,u){u[0]&1152&&(e=a[7]&&a[10].get(a[7].id)),e?r?(r.p(a,u),u[0]&1152&&B(r,1)):(r=Br(a),r.c(),B(r,1),r.m(i.parentNode,i)):r&&(ve(),q(r,1,1,()=>{r=null}),ye())},i(a){s||(B(r),s=!0)},o(a){q(r),s=!1},d(a){a&&F(i),r&&r.d(a)}}}function wh(n,e,i){let s,r,a=Gt,u=()=>(a(),a=fn(s,$=>i(37,r=$)),s),c;n.$$.on_destroy.push(()=>a());let{$$slots:f={},$$scope:d}=e;const p=rs(f),g=me("graph"),k=me("group");let{position:b={x:0,y:0}}=e,{drop:P=!1}=e,{dimensions:S=null}=e,{id:z=0}=e,{bgColor:A=null}=e,{borderRadius:E=null}=e,{borderColor:O=null}=e,{borderWidth:Z=null}=e,{selectionColor:Y=null}=e,{textColor:j=null}=e,{resizable:tt=!1}=e,{label:J=""}=e,{inputs:et=1}=e,{outputs:ot=1}=e,{width:lt=null}=e,{height:N=null}=e,{TD:nt=!1}=e,{LR:X=!1}=e,{zIndex:ct=1}=e,{editable:dt=!0}=e,{locked:Q=!1}=e,{rotation:W=0}=e,{edge:At=null}=e,{connections:st=[]}=e,{useDefaults:yt=!1}=e,{center:Lt=!1}=e,{dynamic:_t=!1}=e,{title:R=""}=e;const U=g.nodes;pt(n,U,$=>i(10,c=$)),Ie("dynamic",_t);let H,K=!0;Hn(()=>{const $=nt?"TD":X?"LR":g.direction,Ot=g.groupBoxes.get(k),zt=g.nodes.count()+1;i(8,K=!p.default),(p.anchorWest||p.anchorEast||p.anchorNorth||p.anchorSouth)&&i(8,K=!1);const Tt=S||(lt||N?{width:lt||N||200,height:N||lt||100}:K?{width:200,height:100}:{width:0,height:0}),Ft={id:z||zt,position:P==="cursor"?{x:wt(g.cursor).x,y:wt(g.cursor).y}:Ot?{x:wt(Ot.position).x+b.x,y:wt(Ot.position).y+b.y}:b,dimensions:Tt,editable:dt||g.editable,label:J,group:k,resizable:tt,inputs:et,outputs:ot,zIndex:ct,direction:$,locked:Q,rotation:W};st.length&&(Ft.connections=st),Z&&(Ft.borderWidth=Z),E&&(Ft.borderRadius=E),O&&(Ft.borderColor=O),Y&&(Ft.selectionColor=Y),j&&(Ft.textColor=j),A&&(Ft.bgColor=A),At&&(Ft.edge=At),i(7,H=Cu(Ft)),Ot&&g.groups.update(Ut=>{const xe=wt(Ut[k].nodes);return Ut[k].nodes.set(new Set([...xe,H])),Ut}),g.nodes.add(H,H.id)}),io(()=>{g.nodes.delete(H.id)});function Nt($){H&&H.connections.set([$])}function Wt($){if(!H)return;(Array.isArray($)?$:[$]).forEach(zt=>{const[Tt,Ft]=Array.isArray(zt)?zt:[zt,null],Ut=`N-${Tt}`,xe=g.nodes.get(Ut);if(!xe)return;let Ke=null;const De=Ft?`A-${Ft}/${Ut}`:null;De&&(Ke=xe.anchors.get(De));const Yt=g.edges.match(H,xe,Ke);Yt.length&&g.edges.delete(Yt[Yt.length-1])})}Ie("connect",Nt),Ie("disconnect",Wt);let rt=b;function Ct($){Xe.call(this,n,$)}function Mt($){Xe.call(this,n,$)}function xt($){Xe.call(this,n,$)}function qt($){Xe.call(this,n,$)}function we($){Xe.call(this,n,$)}function fe($){Xe.call(this,n,$)}return n.$$set=$=>{"position"in $&&i(15,b=$.position),"drop"in $&&i(0,P=$.drop),"dimensions"in $&&i(1,S=$.dimensions),"id"in $&&i(16,z=$.id),"bgColor"in $&&i(17,A=$.bgColor),"borderRadius"in $&&i(18,E=$.borderRadius),"borderColor"in $&&i(19,O=$.borderColor),"borderWidth"in $&&i(20,Z=$.borderWidth),"selectionColor"in $&&i(21,Y=$.selectionColor),"textColor"in $&&i(22,j=$.textColor),"resizable"in $&&i(23,tt=$.resizable),"label"in $&&i(24,J=$.label),"inputs"in $&&i(25,et=$.inputs),"outputs"in $&&i(26,ot=$.outputs),"width"in $&&i(2,lt=$.width),"height"in $&&i(3,N=$.height),"TD"in $&&i(27,nt=$.TD),"LR"in $&&i(28,X=$.LR),"zIndex"in $&&i(29,ct=$.zIndex),"editable"in $&&i(30,dt=$.editable),"locked"in $&&i(31,Q=$.locked),"rotation"in $&&i(32,W=$.rotation),"edge"in $&&i(33,At=$.edge),"connections"in $&&i(34,st=$.connections),"useDefaults"in $&&i(4,yt=$.useDefaults),"center"in $&&i(5,Lt=$.center),"dynamic"in $&&i(35,_t=$.dynamic),"title"in $&&i(6,R=$.title),"$$scope"in $&&i(45,d=$.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&128|n.$$.dirty[1]&8&&H&&H.connections.set(st),n.$$.dirty[0]&131200&&H&&H.bgColor.set(A),n.$$.dirty[0]&16777344&&H&&H.label.set(J),n.$$.dirty[0]&4194432&&H&&H.textColor.set(j),n.$$.dirty[0]&524416&&H&&H.borderColor.set(O),n.$$.dirty[0]&2097280&&H&&H.selectionColor.set(Y),n.$$.dirty[0]&8388736&&H&&H.resizable.set(tt),n.$$.dirty[0]&1073741952&&H&&H.editable.set(dt),n.$$.dirty[0]&128|n.$$.dirty[1]&1&&H&&H.locked.set(Q),n.$$.dirty[0]&33554560&&H&&H.inputs.set(et),n.$$.dirty[0]&67108992&&H&&H.outputs.set(ot),n.$$.dirty[0]&536871040&&H&&H.zIndex.set(ct),n.$$.dirty[0]&128&&u(i(9,s=H&&(H==null?void 0:H.position))),n.$$.dirty[0]&32896|n.$$.dirty[1]&96&&H){const{x:$,y:Ot}=rt,{x:zt,y:Tt}=r,{x:Ft,y:Ut}=b;(Ft!==zt||Ut!==Tt)&&(Ft!==$||Ut!==Ot?(i(36,rt=b),H.position.set(b)):(i(36,rt=r),i(15,b=r)))}n.$$.dirty[0]&33554560&&H&&H.inputs.set(et),n.$$.dirty[0]&67108992&&H&&H.outputs.set(ot)},[P,S,lt,N,yt,Lt,R,H,K,s,c,g,U,Nt,Wt,b,z,A,E,O,Z,Y,j,tt,J,et,ot,nt,X,ct,dt,Q,W,At,st,_t,rt,r,f,Ct,Mt,xt,qt,we,fe,d]}class ls extends pn{constructor(e){super(),mn(this,e,wh,yh,un,{position:15,drop:0,dimensions:1,id:16,bgColor:17,borderRadius:18,borderColor:19,borderWidth:20,selectionColor:21,textColor:22,resizable:23,label:24,inputs:25,outputs:26,width:2,height:3,TD:27,LR:28,zIndex:29,editable:30,locked:31,rotation:32,edge:33,connections:34,useDefaults:4,center:5,dynamic:35,title:6},null,[-1,-1])}}function bh(n){n.parentNodes.forEach(a=>kh(a));const[e,i]=Ph(n);Lh(e,n),Ch(e);for(let a=0;a<10;a++){let u=!1;for(let c=0;c<=i;c++)if(e[c])for(let f=0;f<e[c].length;f++){const d=e[c][f],p=Mh(e,d,f);p&&(Pi(e[c],f,p),u=!0)}if(!u)break}const s=Th(e);for(let a=0;a<10&&Eh(e,s);a++);for(let a=0;a<2;a++){let u=!1;for(let c=0;c<=i;c++)for(let f=0;f<e[c].length;f++){const d=e[c][f],p=Sh(e,d,f);p&&(Pi(e[c],f,p),u=!0)}if(!u)break}const r=[];for(let a=0;a<=i;a++)r.push(e[a]);return r}function kh(n,e=0,i=0){const s=[],r=(a,u=0,c=0)=>{a.depth=Math.max(a.depth,u),a.nesting=Math.max(a.nesting,c),s.push(a);for(const f of a.children){const{node:d,length:p}=f;r(d,p+u,c+1)}};r(n,e,i);for(const a of s)if(a.children.length){a.nesting=a.children[0].node.nesting-1,a.depth=a.children[0].node.depth-a.children[0].length;for(const u of a.children)a.nesting=Math.min(a.nesting,u.node.nesting-1),a.depth=Math.min(a.depth,u.node.depth-u.length)}}function Ph(n){let e=0;const i={};for(const s in n.nodeList){const{depth:r,parents:a,children:u,type:c,data:f}=n.nodeList[s];e=Math.max(e,r),i[r]||(i[r]=[]);const d={id:s,label:f.content,children:[],parents:[],layer:r,type:c.trim()};f.props&&(d.propsId=f.props.trim());for(const p of a)d.parents.push(p.node.id);for(const p of u)d.children.push(p.node.id);i[r].push(d)}return[i,e]}function Lh(n,e){for(const i in e.nodeList)for(const s of e.nodeList[i].children)if(s.node.depth-1>e.nodeList[i].depth){const r=e.nodeList[i].depth+1,a=s.node.depth-1,u=[];let c=0;for(let f=r;f<=a;f++){const d={id:`GHOST_${s.node.id}_${c}`,label:"",children:[],parents:[],layer:f,ignore:!0};u.push(d),c++}for(const f of s.node.parents)u[0].parents.push(f.node.id);u[u.length-1].children.push(s.node.id);for(let f=0;f<u.length-1;f++)u[f].children.push(`GHOST_${s.node.id}_${f+1}`);for(let f=a;f>=r;f--)u.length>0&&n[f].push(u[0]);for(const f of n[e.nodeList[i].depth])f.id===i&&(f.children.push(u[0].id),f.children=f.children.filter(d=>d!==s.node.id))}}function Ch(n){let e=0;for(const i in n)e=Math.max(n[i].length,e);for(const i in n)if(n[i].length<e){const s=Array.from({length:e-n[i].length},()=>({id:"NULL_NODE",children:[],parents:[],layer:parseInt(i),ignore:!0}));n[i]=n[i].concat(s)}}function Dr(n,e,i){let s=0,r=0;for(const a of e.parents){for(let u=0;u<n[e.layer-1].length;u++)if(a===n[e.layer-1][u].id){s+=Math.abs(i-u);break}r++}for(const a of e.children){for(let u=0;u<n[e.layer+1].length;u++)if(a===n[e.layer+1][u].id){s+=Math.abs(i-u);break}r++}return isNaN(s/r)?0:s/r}function Rr(n,e,i){let s=0,r=0;for(const a of e.parents){for(let u=0;u<n[e.layer-1].length;u++)if(a===n[e.layer-1][u].id){s+=Math.abs(i-u);break}r++}return isNaN(s/r)?0:s/r}function jr(n,e,i){let s=0,r=0;for(const a of e.children){for(let u=0;u<n[e.layer+1].length;u++)if(a===n[e.layer+1][u].id){s+=Math.abs(i-u);break}r++}return isNaN(s/r)?0:s/r}function Sh(n,e,i){const s=is(n,e.layer);let r=0;e.layer===0?r=jr(n,e,i):r=Rr(n,e,i);let a=r,u=i;for(let c=0;c<n[e.layer].length;c++)if(n[e.layer][c].id==="NULL_NODE"){Pi(n[e.layer],i,c);const d=is(n,e.layer);let p=0;e.layer===0?p=jr(n,e,c):p=Rr(n,e,c),d<=s&&p<a&&(a=p,u=c),Pi(n[e.layer],c,i)}return u===i?null:u}function Mh(n,e,i){const s={};let r=1/0,a=0;for(let u=0;u<n[e.layer].length;u++){const c=Dr(n,e,u),f=Dr(n,n[e.layer][u],i);s[u]=c+f}for(const u in s)s[u]<r&&(r=s[u],a=parseInt(u));return a===i?null:a}function Pi(n,e,i){const s=n[e];n[e]=n[i],n[i]=s}function Th(n){const e=[];for(const i in n)for(const s of n[i])e.push(s);return e.sort((i,s)=>s.parents.length+s.children.length-(i.parents.length+i.children.length))}function is(n,e){let i=0;for(let s=0;s<n[e].length;s++){const r=n[e][s],a=[],u=[];if(n[e-1])for(let c=s+1;c<n[e-1].length;c++)r.parents.includes(n[e-1][c].id)&&a.push(c);if(n[e+1])for(let c=s+1;c<n[e+1].length;c++)r.children.includes(n[e+1][c].id)&&u.push(c);for(let c=s+1;c<n[e].length;c++){const f=n[e][c];if(a.length)for(let d=0;d<n[e-1].length;d++)f.parents.includes(n[e-1][d].id)&&a.forEach(p=>{d<p&&i++});if(u.length)for(let d=0;d<n[e+1].length;d++)f.children.includes(n[e+1][d].id)&&u.forEach(p=>{d<p&&i++})}}return i}function Eh(n,e){let i=!1;for(const s of e){if(s.children.length+s.parents.length===0)return i;let r=0;for(let c=0;c<n[s.layer].length;c++)if(n[s.layer][c].id===s.id){r=c;break}let a=1/0,u=r;for(let c=0;c<n[s.layer].length;c++){Pi(n[s.layer],r,c);const f=is(n,s.layer);f<a&&(a=f,u=c),Pi(n[s.layer],c,r)}u!==r&&(Pi(n[s.layer],r,u),i=!0)}return i}function Wr(n,e,i){const s=n.slice();return s[6]=e[i],s}function Hr(n,e,i){const s=n.slice();return s[9]=e[i],s}function Ah(n){let e,i;const s=[{label:n[9].label},{id:n[9].id},{TD:!0},n[0][n[9].id],{connections:n[9].children.map(Ur)}];let r={};for(let a=0;a<s.length;a+=1)r=ss(r,s[a]);return e=new ls({props:r}),{c(){he(e.$$.fragment)},m(a,u){le(e,a,u),i=!0},p(a,u){const c=u&3?ia(s,[u&2&&{label:a[9].label},u&2&&{id:a[9].id},s[2],oa(a[0][a[9].id]),u&2&&{connections:a[9].children.map(Ur)}]):{};e.$set(c)},i(a){i||(B(e.$$.fragment,a),i=!0)},o(a){q(e.$$.fragment,a),i=!1},d(a){ae(e,a)}}}function Fr(n){let e,i,s=!n[9].ignore&&Ah(n);return{c(){s&&s.c(),e=ze()},m(r,a){s&&s.m(r,a),G(r,e,a),i=!0},p(r,a){r[9].ignore||s.p(r,a)},i(r){i||(B(s),i=!0)},o(r){q(s),i=!1},d(r){r&&F(e),s&&s.d(r)}}}function Gr(n){let e,i,s=Ae(n[6]),r=[];for(let u=0;u<s.length;u+=1)r[u]=Fr(Hr(n,s,u));const a=u=>q(r[u],1,1,()=>{r[u]=null});return{c(){for(let u=0;u<r.length;u+=1)r[u].c();e=ze()},m(u,c){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(u,c);G(u,e,c),i=!0},p(u,c){if(c&3){s=Ae(u[6]);let f;for(f=0;f<s.length;f+=1){const d=Hr(u,s,f);r[f]?(r[f].p(d,c),B(r[f],1)):(r[f]=Fr(d),r[f].c(),B(r[f],1),r[f].m(e.parentNode,e))}for(ve(),f=s.length;f<r.length;f+=1)a(f);ye()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)B(r[c]);i=!0}},o(u){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)q(r[c]);i=!1},d(u){u&&F(e),Li(r,u)}}}function zh(n){let e,i,s=Ae(n[1]),r=[];for(let u=0;u<s.length;u+=1)r[u]=Gr(Wr(n,s,u));const a=u=>q(r[u],1,1,()=>{r[u]=null});return{c(){for(let u=0;u<r.length;u+=1)r[u].c();e=ze()},m(u,c){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(u,c);G(u,e,c),i=!0},p(u,[c]){if(c&3){s=Ae(u[1]);let f;for(f=0;f<s.length;f+=1){const d=Wr(u,s,f);r[f]?(r[f].p(d,c),B(r[f],1)):(r[f]=Gr(d),r[f].c(),B(r[f],1),r[f].m(e.parentNode,e))}for(ve(),f=s.length;f<r.length;f+=1)a(f);ye()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)B(r[c]);i=!0}},o(u){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)q(r[c]);i=!1},d(u){u&&F(e),Li(r,u)}}}const Nh=100,Ih=100,Ur=n=>[n,"1"];function xh(n,e,i){let{mermaid:s=""}=e,{mermaidConfig:r={}}=e;const a=Wu(s);Ie("flowchart",a);const u=bh(a),c=me("graph");let f;return Hn(()=>{c.nodes.subscribe(p=>f=Object.fromEntries(p));let d=0;for(const p of u){let g=0,k=-1/0;for(const b of p)b.ignore||(f[`N-${b.id}`].position.update(()=>({x:g,y:d})),f[`N-${b.id}`].dimensions.width.subscribe(P=>g+=P),f[`N-${b.id}`].dimensions.height.subscribe(P=>k=Math.max(k,P))),g+=Nh;d+=k+Ih}}),n.$$set=d=>{"mermaid"in d&&i(2,s=d.mermaid),"mermaidConfig"in d&&i(0,r=d.mermaidConfig)},[r,u,s]}class Oh extends pn{constructor(e){super(),mn(this,e,xh,zh,un,{mermaid:2,mermaidConfig:0})}}const Bh="modulepreload",Zh=function(n){return"/"+n},Vr={},qi=function(e,i,s){let r=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),c=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));r=Promise.allSettled(i.map(f=>{if(f=Zh(f),f in Vr)return;Vr[f]=!0;const d=f.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${p}`))return;const g=document.createElement("link");if(g.rel=d?"stylesheet":Bh,d||(g.as="script"),g.crossOrigin="",g.href=f,c&&g.setAttribute("nonce",c),document.head.appendChild(g),d)return new Promise((k,b)=>{g.addEventListener("load",k),g.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return r.then(u=>{for(const c of u||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})},Dh=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"],Rh=new Set(Dh),Xr=n=>Rh.has(n);function jh(n){let e,i,s;return{c(){e=M("input"),m(e,"placeholder",n[0]),m(e,"type","text")},m(r,a){G(r,e,a),Le(e,n[1]),i||(s=[ht(e,"keydown",Wn(n[3])),ht(e,"click",Wn(n[4])),ht(e,"mousedown",Wn(n[5])),ht(e,"input",n[6])],i=!0)},p(r,[a]){a&1&&m(e,"placeholder",r[0]),a&2&&e.value!==r[1]&&Le(e,r[1])},i:Gt,o:Gt,d(r){r&&F(e),i=!1,$e(s)}}}function Wh(n,e,i){let s,{placeholder:r}=e;const a=me("textStore");pt(n,a,p=>i(1,s=p));function u(p){Xe.call(this,n,p)}function c(p){Xe.call(this,n,p)}function f(p){Xe.call(this,n,p)}function d(){s=this.value,a.set(s)}return n.$$set=p=>{"placeholder"in p&&i(0,r=p.placeholder)},[r,s,a,u,c,f,d]}class Hh extends pn{constructor(e){super(),mn(this,e,Wh,jh,un,{placeholder:0})}}function Fh(n){let e,i,s,r,a,u,c,f,d,p,g,k,b;return u=new Hh({props:{placeholder:"Node Label"}}),{c(){e=M("div"),i=M("span"),i.textContent="Editor",s=V(),r=M("button"),r.textContent="X",a=V(),he(u.$$.fragment),c=V(),f=M("button"),f.textContent="Delete Node",d=V(),p=M("button"),p.textContent="Resize Node",at(i,"color","white"),at(i,"font-size","45px"),at(r,"position","absolute"),at(r,"top","10px"),at(r,"right","10px"),m(e,"class","editor svelte-1nv0yho")},m(P,S){G(P,e,S),y(e,i),y(e,s),y(e,r),y(e,a),le(u,e,null),y(e,c),y(e,f),y(e,d),y(e,p),g=!0,k||(b=[ht(r,"click",n[6]),ht(f,"click",n[3]),ht(p,"click",n[4]),ht(e,"contextmenu",n[2])],k=!0)},p:Gt,i(P){g||(B(u.$$.fragment,P),g=!0)},o(P){q(u.$$.fragment,P),g=!1},d(P){P&&F(e),ae(u),k=!1,$e(b)}}}function Gh(n){let e,i;return e=new ls({props:{zIndex:1/0,position:n[0],bgColor:"white",id:"editor",$$slots:{default:[Fh]},$$scope:{ctx:n}}}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},p(s,[r]){const a={};r&1&&(a.position=s[0]),r&512&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Uh(n,e,i){let{editing:s}=e;const r=me("graph");Ie("graph",r),Ie("textStore",s.label),Ie("colorStore",s.bgColor);let a={x:150,y:50};function u(p){p.preventDefault(),i(0,a={x:p.clientX,y:p.clientY}),r.editing.set(s)}function c(){r.nodes.delete(s.id),r.editing.set(null)}function f(){const p=s.id,g=r.nodes.get(p);if(g){const k=g.dimensions.width,b=g.dimensions.height,P=prompt("Enter new width (for example:250):",k?k.toString():""),S=prompt("Enter new height (for example:200):",b?b.toString():"");if(P===null||S===null)return;g.dimensions.width.set(parseInt(P,10)||0),g.dimensions.height.set(parseInt(S,10)||0),g.resizingWidth.set(!0),g.resizingHeight.set(!0)}}const d=()=>r.editing.set(null);return n.$$set=p=>{"editing"in p&&i(5,s=p.editing)},r.cursor,[a,r,u,c,f,s,d]}class Vh extends pn{constructor(e){super(),mn(this,e,Uh,Gh,un,{editing:5})}}function Xh(n){let e,i,s,r;return{c(){e=M("div"),i=M("div"),m(i,"class","bounding-box svelte-1e5jg43"),at(i,"background-color",n[6]),m(e,"role","button"),m(e,"tabindex","0"),m(e,"class","bounding-box-border svelte-1e5jg43"),m(e,"id",n[2]),at(e,"border","solid 4px "+n[6]),at(e,"top",`${n[3].y}px`),at(e,"left",`${n[3].x}px`),at(e,"width",`${n[4]}px`),at(e,"height",`${n[5]}px`)},m(a,u){G(a,e,u),y(e,i),s||(r=[ht(e,"contextmenu",Wn(jn(n[12]))),ht(e,"mousedown",Wn(jn(n[9])))],s=!0)},p(a,[u]){u&64&&at(i,"background-color",a[6]),u&4&&m(e,"id",a[2]),u&64&&at(e,"border","solid 4px "+a[6]);const c=u&64;(u&72||c)&&at(e,"top",`${a[3].y}px`),(u&72||c)&&at(e,"left",`${a[3].x}px`),(u&80||c)&&at(e,"width",`${a[4]}px`),(u&96||c)&&at(e,"height",`${a[5]}px`)},i:Gt,o:Gt,d(a){a&&F(e),s=!1,$e(r)}}}function Yh(n,e,i){let s,r,a=Gt,u=()=>(a(),a=fn(b,Y=>i(3,r=Y)),b),c,f,d,p=Gt,g=()=>(p(),p=fn(P,Y=>i(6,d=Y)),P);n.$$.on_destroy.push(()=>a()),n.$$.on_destroy.push(()=>p());let{dimensions:k}=e,{position:b}=e;u();let{color:P}=e;g();let{groupName:S}=e;const{width:z,height:A}=k;pt(n,z,Y=>i(4,c=Y)),pt(n,A,Y=>i(5,f=Y));const E=Zi();function O(){E("groupClick",{groupName:S})}function Z(Y){Xe.call(this,n,Y)}return n.$$set=Y=>{"dimensions"in Y&&i(10,k=Y.dimensions),"position"in Y&&u(i(0,b=Y.position)),"color"in Y&&g(i(1,P=Y.color)),"groupName"in Y&&i(11,S=Y.groupName)},n.$$.update=()=>{n.$$.dirty&2048&&i(2,s=`${S}-bounding-box`)},[b,P,s,r,c,f,d,z,A,O,k,S,Z]}class qh extends pn{constructor(e){super(),mn(this,e,Yh,Xh,un,{dimensions:10,position:0,color:1,groupName:11})}}function Yr(n,e,i){const s=n.slice();return s[4]=e[i][0],s[5]=e[i][1],s}function qr(n,e){let i,s,r;const a=[e[5],{groupName:e[4]}];let u={};for(let c=0;c<a.length;c+=1)u=ss(u,a[c]);return s=new qh({props:u}),s.$on("groupClick",e[2]),{key:n,first:null,c(){i=ze(),he(s.$$.fragment),this.first=i},m(c,f){G(c,i,f),le(s,c,f),r=!0},p(c,f){e=c;const d=f&1?ia(a,[oa(e[5]),{groupName:e[4]}]):{};s.$set(d)},i(c){r||(B(s.$$.fragment,c),r=!0)},o(c){q(s.$$.fragment,c),r=!1},d(c){c&&F(i),ae(s,c)}}}function Kh(n){let e=[],i=new Map,s,r,a=Ae(Array.from(n[0]));const u=c=>c[4];for(let c=0;c<a.length;c+=1){let f=Yr(n,a,c),d=u(f);i.set(d,e[c]=qr(d,f))}return{c(){for(let c=0;c<e.length;c+=1)e[c].c();s=ze()},m(c,f){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(c,f);G(c,s,f),r=!0},p(c,[f]){f&1&&(a=Ae(Array.from(c[0])),ve(),e=hi(e,f,u,1,c,a,i,s.parentNode,eo,qr,s,Yr),ye())},i(c){if(!r){for(let f=0;f<a.length;f+=1)B(e[f]);r=!0}},o(c){for(let f=0;f<e.length;f+=1)q(e[f]);r=!1},d(c){c&&F(s);for(let f=0;f<e.length;f+=1)e[f].d(c)}}}function Jh(n,e,i){let s;const a=me("graph").groupBoxes;pt(n,a,c=>i(0,s=c));function u(c){Xe.call(this,n,c)}return[s,a,u]}class Qh extends pn{constructor(e){super(),mn(this,e,Jh,Kh,un,{})}}function $h(n){let e,i,s,r;const a=n[11].default,u=Ce(a,n,n[10],null);return{c(){e=M("div"),u&&u.c(),m(e,"class","svelvet-graph-wrapper svelte-19pa6i0"),m(e,"role","presentation"),at(e,"transform",n[0])},m(c,f){G(c,e,f),u&&u.m(e,null),i=!0,s||(r=[ht(e,"contextmenu",Ji(jn(n[12]))),ht(e,"click",Ji(jn(n[13]))),ht(e,"touchstart",Ji(jn(n[14])))],s=!0)},p(c,[f]){u&&u.p&&(!i||f&1024)&&Me(u,a,c,c[10],i?Se(a,c[10],f,null):Te(c[10]),null),f&1&&at(e,"transform",c[0])},i(c){i||(B(u,c),i=!0)},o(c){q(u,c),i=!1},d(c){c&&F(e),u&&u.d(c),s=!1,$e(r)}}}function tf(n,e,i){let s,r,a,u,c,{$$slots:f={},$$scope:d}=e;const p=me("graph"),g=p.transforms,k=g.scale;pt(n,k,j=>i(9,c=j));const b=g.translation;pt(n,b,j=>i(8,u=j));const P=p.cursor;pt(n,P,j=>i(15,a=j));let{isMovable:S}=e,z,A=!1;function E(){Bt(b,u=Qu(wt(On),a,g),u),i(5,z=requestAnimationFrame(E))}function O(j){Xe.call(this,n,j)}function Z(j){Xe.call(this,n,j)}function Y(j){Xe.call(this,n,j)}return n.$$set=j=>{"isMovable"in j&&i(4,S=j.isMovable),"$$scope"in j&&i(10,d=j.$$scope)},n.$$.update=()=>{n.$$.dirty&256&&i(7,s=u),n.$$.dirty&640&&i(0,r=`translate(${s.x}px, ${s.y}px) scale(${c})`),n.$$.dirty&112&&(S&&!A?(i(6,A=!0),i(5,z=requestAnimationFrame(E))):(!S||!A)&&(i(6,A=!1),cancelAnimationFrame(z)))},[r,k,b,P,S,z,A,s,u,c,d,f,O,Z,Y]}class ef extends pn{constructor(e){super(),mn(this,e,tf,$h,un,{isMovable:4})}}function nf(n){let e,i,s;const r=n[8].default,a=Ce(r,n,n[9],null);return i=new Qh({}),i.$on("groupClick",n[5]),{c(){a&&a.c(),e=V(),he(i.$$.fragment)},m(u,c){a&&a.m(u,c),G(u,e,c),le(i,u,c),s=!0},p(u,c){a&&a.p&&(!s||c&512)&&Me(a,r,u,u[9],s?Se(r,u[9],c,null):Te(u[9]),null)},i(u){s||(B(a,u),B(i.$$.fragment,u),s=!0)},o(u){q(a,u),q(i.$$.fragment,u),s=!1},d(u){u&&F(e),a&&a.d(u),ae(i,u)}}}function of(n){let e,i;return e=new ef({props:{isMovable:n[0],$$slots:{default:[nf]},$$scope:{ctx:n}}}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},p(s,[r]){const a={};r&1&&(a.isMovable=s[0]),r&512&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function sf(n,e,i){let s,r,a,u,c,f;pt(n,On,O=>i(13,u=O)),pt(n,Zn,O=>i(7,f=O));let{$$slots:d={},$$scope:p}=e;console.log("Componente GraphRenderer.svelte");const g=me("graph"),k=me("snapTo");let{isMovable:b}=e;const P=g.activeGroup;pt(n,P,O=>i(6,c=O));const S=g.groups;pt(n,S,O=>i(10,s=O));const z=g.initialNodePositions;pt(n,z,O=>i(11,r=O));const A=g.cursor;pt(n,A,O=>i(12,a=O));function E(O){Bt(Zn,f=!0,f);const{groupName:Z}=O.detail;Bt(P,c=Z,c),Bt(On,u=a,u),Bt(z,r=ca(s[Z].nodes),r)}return n.$$set=O=>{"isMovable"in O&&i(0,b=O.isMovable),"$$scope"in O&&i(9,p=O.$$scope)},n.$$.update=()=>{n.$$.dirty&192&&c&&f&&lc(g,k)},[b,P,S,z,A,E,c,f,d,p]}class rf extends pn{constructor(e){super(),mn(this,e,sf,of,un,{isMovable:0})}}function lf(n){let e,i;return{c(){e=ee("line"),i=ee("line"),m(e,"class","background-line svelte-rryw83"),m(e,"x1",n[11]),m(e,"y1",0),m(e,"x2",n[11]),m(e,"y2",n[6]),m(e,"stroke-width",n[5]),at(e,"--calculated-dot-color",n[2]),m(i,"class","background-line svelte-rryw83"),m(i,"y1",n[11]),m(i,"x1",0),m(i,"y2",n[11]),m(i,"x2",n[6]),m(i,"stroke-width",n[5]),at(i,"--calculated-dot-color",n[2])},m(s,r){G(s,e,r),G(s,i,r)},p(s,r){r&2048&&m(e,"x1",s[11]),r&2048&&m(e,"x2",s[11]),r&64&&m(e,"y2",s[6]),r&32&&m(e,"stroke-width",s[5]),r&4&&at(e,"--calculated-dot-color",s[2]),r&2048&&m(i,"y1",s[11]),r&2048&&m(i,"y2",s[11]),r&64&&m(i,"x2",s[6]),r&32&&m(i,"stroke-width",s[5]),r&4&&at(i,"--calculated-dot-color",s[2])},d(s){s&&(F(e),F(i))}}}function af(n){let e;return{c(){e=ee("circle"),m(e,"class","background-dot svelte-rryw83"),m(e,"r",n[5]),m(e,"cx",n[11]),m(e,"cy",n[11]),at(e,"--calculated-dot-color",n[2])},m(i,s){G(i,e,s)},p(i,s){s&32&&m(e,"r",i[5]),s&2048&&m(e,"cx",i[11]),s&2048&&m(e,"cy",i[11]),s&4&&at(e,"--calculated-dot-color",i[2])},d(i){i&&F(e)}}}function Kr(n){let e,i,s;function r(c,f){if(c[0]==="dots")return cf;if(c[0]==="lines")return uf}let a=r(n),u=a&&a(n);return{c(){e=ee("pattern"),u&&u.c(),m(e,"id","graph-coarse-pattern"),m(e,"x",n[7]),m(e,"y",n[8]),m(e,"width",i=n[6]*n[3]),m(e,"height",s=n[6]*n[3]),m(e,"patternUnits","userSpaceOnUse")},m(c,f){G(c,e,f),u&&u.m(e,null)},p(c,f){a===(a=r(c))&&u?u.p(c,f):(u&&u.d(1),u=a&&a(c),u&&(u.c(),u.m(e,null))),f&128&&m(e,"x",c[7]),f&256&&m(e,"y",c[8]),f&72&&i!==(i=c[6]*c[3])&&m(e,"width",i),f&72&&s!==(s=c[6]*c[3])&&m(e,"height",s)},d(c){c&&F(e),u&&u.d()}}}function uf(n){let e,i,s,r,a,u;return{c(){e=ee("line"),r=ee("line"),m(e,"class","background-line svelte-rryw83"),m(e,"x1",n[11]),m(e,"y1",0),m(e,"x2",n[11]),m(e,"y2",i=n[6]*n[3]),m(e,"stroke-width",s=n[5]*1.2),at(e,"--calculated-dot-color",n[2]),m(r,"class","background-line svelte-rryw83"),m(r,"y1",n[11]),m(r,"x1",0),m(r,"y2",n[11]),m(r,"x2",a=n[6]*n[3]),m(r,"stroke-width",u=n[5]*1.2),at(r,"--calculated-dot-color",n[2])},m(c,f){G(c,e,f),G(c,r,f)},p(c,f){f&2048&&m(e,"x1",c[11]),f&2048&&m(e,"x2",c[11]),f&72&&i!==(i=c[6]*c[3])&&m(e,"y2",i),f&32&&s!==(s=c[5]*1.2)&&m(e,"stroke-width",s),f&4&&at(e,"--calculated-dot-color",c[2]),f&2048&&m(r,"y1",c[11]),f&2048&&m(r,"y2",c[11]),f&72&&a!==(a=c[6]*c[3])&&m(r,"x2",a),f&32&&u!==(u=c[5]*1.2)&&m(r,"stroke-width",u),f&4&&at(r,"--calculated-dot-color",c[2])},d(c){c&&(F(e),F(r))}}}function cf(n){let e,i;return{c(){e=ee("circle"),m(e,"class","background-dot svelte-rryw83"),m(e,"r",i=n[5]*2),m(e,"cx",n[11]),m(e,"cy",n[11]),at(e,"--calculated-dot-color",n[2])},m(s,r){G(s,e,r)},p(s,r){r&32&&i!==(i=s[5]*2)&&m(e,"r",i),r&2048&&m(e,"cx",s[11]),r&2048&&m(e,"cy",s[11]),r&4&&at(e,"--calculated-dot-color",s[2])},d(s){s&&F(e)}}}function Jr(n){let e;return{c(){e=ee("rect"),m(e,"width","100%"),m(e,"height","100%"),m(e,"fill","url(#graph-coarse-pattern)"),m(e,"opacity",n[10])},m(i,s){G(i,e,s)},p(i,s){s&1024&&m(e,"opacity",i[10])},d(i){i&&F(e)}}}function hf(n){let e,i,s,r,a;function u(g,k){if(g[0]==="dots")return af;if(g[0]==="lines")return lf}let c=u(n),f=c&&c(n),d=n[3]>0&&Kr(n),p=n[3]>0&&Jr(n);return{c(){e=M("div"),i=ee("svg"),s=ee("defs"),r=ee("pattern"),f&&f.c(),d&&d.c(),a=ee("rect"),p&&p.c(),m(r,"id","graph-pattern"),m(r,"x",n[7]),m(r,"y",n[8]),m(r,"width",n[6]),m(r,"height",n[6]),m(r,"patternUnits","userSpaceOnUse"),m(a,"width","100%"),m(a,"height","100%"),m(a,"fill","url(#graph-pattern)"),m(a,"opacity",n[9]),m(i,"class","svelte-rryw83"),m(e,"id","background-wrapper"),m(e,"class","svelte-rryw83"),at(e,"--calculated-background-color",n[1])},m(g,k){G(g,e,k),y(e,i),y(i,s),y(s,r),f&&f.m(r,null),d&&d.m(s,null),y(i,a),p&&p.m(i,null),n[24](e)},p(g,[k]){c===(c=u(g))&&f?f.p(g,k):(f&&f.d(1),f=c&&c(g),f&&(f.c(),f.m(r,null))),k&128&&m(r,"x",g[7]),k&256&&m(r,"y",g[8]),k&64&&m(r,"width",g[6]),k&64&&m(r,"height",g[6]),g[3]>0?d?d.p(g,k):(d=Kr(g),d.c(),d.m(s,null)):d&&(d.d(1),d=null),k&512&&m(a,"opacity",g[9]),g[3]>0?p?p.p(g,k):(p=Jr(g),p.c(),p.m(i,null)):p&&(p.d(1),p=null),k&2&&at(e,"--calculated-background-color",g[1])},i:Gt,o:Gt,d(g){g&&F(e),f&&f.d(),d&&d.d(),p&&p.d(),n[24](null)}}}function ff(n,e,i){let s,r,a,u,c,f,d;const p=me("graph");let{style:g="dots"}=e,{gridWidth:k=Nu}=e,{dotSize:b=Iu}=e,{bgColor:P=null}=e,{dotColor:S=null}=e,{opacityThreshold:z=3}=e,{majorGrid:A=0}=e,{minOpacity:E=.4}=e;const O=p.transforms,Z=O.scale;pt(n,Z,X=>i(22,f=X));const Y=O.translation;pt(n,Y,X=>i(23,d=X));let j,tt,J,et,ot,lt=1,N=1;function nt(X){Xn[X?"unshift":"push"](()=>{j=X,i(4,j)})}return n.$$set=X=>{"style"in X&&i(0,g=X.style),"gridWidth"in X&&i(14,k=X.gridWidth),"dotSize"in X&&i(15,b=X.dotSize),"bgColor"in X&&i(1,P=X.bgColor),"dotColor"in X&&i(2,S=X.dotColor),"opacityThreshold"in X&&i(16,z=X.opacityThreshold),"majorGrid"in X&&i(3,A=X.majorGrid),"minOpacity"in X&&i(17,E=X.minOpacity)},n.$$.update=()=>{n.$$.dirty&8388608&&i(21,s=d),n.$$.dirty&4194304&&i(20,r=f),n.$$.dirty&1064960&&i(6,a=r*k),n.$$.dirty&1081344&&i(5,u=r*b/2),n.$$.dirty&64&&i(11,c=a/2),n.$$.dirty&4128816&&(i(18,tt=(j==null?void 0:j.offsetWidth)||0),i(19,J=(j==null?void 0:j.offsetHeight)||0),i(7,et=(tt+u)*(1-r)/2+s.x),i(8,ot=(J+u)*(1-r)/2+s.y),i(9,lt=r>z?1:r/z+E),i(10,N=r>z/3?1:r/(z/3)+E))},[g,P,S,A,j,u,a,et,ot,lt,N,c,Z,Y,k,b,z,E,tt,J,r,s,f,d,nt]}class df extends pn{constructor(e){super(),mn(this,e,ff,hf,un,{style:0,gridWidth:14,dotSize:15,bgColor:1,dotColor:2,opacityThreshold:16,majorGrid:3,minOpacity:17})}}function _f(n){let e,i;return{c(){e=M("div"),i=M("div"),m(i,"class","selection-box svelte-10ds4jd"),$t(i,"creating",n[0]),m(e,"class","selection-border svelte-10ds4jd"),$t(e,"creating",n[0]),at(e,"--prop-selection-box-color",n[1]),at(e,"height",n[4]),at(e,"width",n[3]),at(e,"top",n[6]),at(e,"left",n[5])},m(s,r){G(s,e,r),y(e,i),n[18](i)},p(s,[r]){r&1&&$t(i,"creating",s[0]),r&1&&$t(e,"creating",s[0]),r&2&&at(e,"--prop-selection-box-color",s[1]),r&16&&at(e,"height",s[4]),r&8&&at(e,"width",s[3]),r&64&&at(e,"top",s[6]),r&32&&at(e,"left",s[5])},i:Gt,o:Gt,d(s){s&&F(e),n[18](null)}}}function mf(n,e,i){let s,r,a,u,c,f,d,p,g,k,b=Gt,P=()=>(b(),b=fn(s,N=>i(20,k=N)),s),S,z;pt(n,ra,N=>i(16,S=N)),n.$$.on_destroy.push(()=>b());let{graph:A}=e,{anchor:E}=e,{adding:O=!1}=e,{creating:Z=!1}=e,{color:Y=null}=e;const{groups:j}=A;pt(n,j,N=>i(17,z=N));let tt,J;Hn(et);function et(){tt=Array.from(document.querySelectorAll(".svelvet-node")).map(nt=>{const{top:X,left:ct,width:dt,height:Q}=nt.getBoundingClientRect();return{id:nt.id,top:X,left:ct,width:dt,height:Q}})}function ot(){if(!tt)return;const N=tt.reduce((nt,X)=>{if(c+E.left<=X.left&&u+E.top<=X.top&&c+E.left+Math.abs(a)>=X.left+X.width&&u+E.top+Math.abs(r)>=X.top+X.height){const ct=X.id,dt=A.nodes.get(ct);if(!dt)return nt;nt.push(dt)}return nt},[]);O?N.forEach(nt=>{k.add(nt)}):Bt(s,k=new Set(N),k),s.set(k)}function lt(N){Xn[N?"unshift":"push"](()=>{J=N,i(2,J)})}return n.$$set=N=>{"graph"in N&&i(9,A=N.graph),"anchor"in N&&i(10,E=N.anchor),"adding"in N&&i(11,O=N.adding),"creating"in N&&i(0,Z=N.creating),"color"in N&&i(1,Y=N.color)},n.$$.update=()=>{n.$$.dirty&131072&&P(i(7,s=z.selected.nodes)),n.$$.dirty&66560&&i(12,r=S.y-E.y-E.top),n.$$.dirty&66560&&i(14,a=S.x-E.x-E.left),n.$$.dirty&5120&&i(13,u=Math.min(E.y,E.y+r)),n.$$.dirty&17408&&i(15,c=Math.min(E.x,E.x+a)),n.$$.dirty&8192&&i(6,f=`${u}px`),n.$$.dirty&32768&&i(5,d=`${c}px`),n.$$.dirty&4096&&i(4,p=`${Math.abs(r)}px`),n.$$.dirty&16384&&i(3,g=`${Math.abs(a)}px`),n.$$.dirty&20480&&(a||r)&&ot()},[Z,Y,J,g,p,d,f,s,j,A,E,O,r,u,a,c,S,z,lt]}class pf extends pn{constructor(e){super(),mn(this,e,mf,_f,un,{graph:9,anchor:10,adding:11,creating:0,color:1})}}const gf=n=>({}),Qr=n=>({}),vf=n=>({}),$r=n=>({}),yf=n=>({}),tl=n=>({}),wf=n=>({}),el=n=>({}),bf=n=>({}),nl=n=>({}),kf=n=>({}),il=n=>({});function ol(n){let e,i;return e=new Vh({props:{editing:n[24]}}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},p(s,r){const a={};r[0]&16777216&&(a.editing=s[24]),e.$set(a)},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Pf(n){let e,i,s=n[24]&&ol(n);const r=n[56].default,a=Ce(r,n,n[58],null);return{c(){s&&s.c(),e=V(),a&&a.c()},m(u,c){s&&s.m(u,c),G(u,e,c),a&&a.m(u,c),i=!0},p(u,c){u[24]?s?(s.p(u,c),c[0]&16777216&&B(s,1)):(s=ol(u),s.c(),B(s,1),s.m(e.parentNode,e)):s&&(ve(),q(s,1,1,()=>{s=null}),ye()),a&&a.p&&(!i||c[1]&134217728)&&Me(a,r,u,u[58],i?Se(r,u[58],c,null):Te(u[58]),null)},i(u){i||(B(s),B(a,u),i=!0)},o(u){q(s),q(a,u),i=!1},d(u){u&&F(e),s&&s.d(u),a&&a.d(u)}}}function Lf(n){let e,i;return e=new df({}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},p:Gt,i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Cf(n){let e;const i=n[56].background,s=Ce(i,n,n[58],il);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&134217728)&&Me(s,i,r,r[58],e?Se(i,r[58],a,kf):Te(r[58]),il)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function sl(n){let e,i,s;var r=n[14];function a(u,c){return{}}return r&&(e=ii(r,a())),{c(){e&&he(e.$$.fragment),i=ze()},m(u,c){e&&le(e,u,c),G(u,i,c),s=!0},p(u,c){if(c[0]&16384&&r!==(r=u[14])){if(e){ve();const f=e;q(f.$$.fragment,1,0,()=>{ae(f,1)}),ye()}r?(e=ii(r,a()),he(e.$$.fragment),B(e.$$.fragment,1),le(e,i.parentNode,i)):e=null}},i(u){s||(e&&B(e.$$.fragment,u),s=!0)},o(u){e&&q(e.$$.fragment,u),s=!1},d(u){u&&F(i),e&&ae(e,u)}}}function rl(n){let e,i,s;var r=n[15];function a(u,c){return{}}return r&&(e=ii(r,a())),{c(){e&&he(e.$$.fragment),i=ze()},m(u,c){e&&le(e,u,c),G(u,i,c),s=!0},p(u,c){if(c[0]&32768&&r!==(r=u[15])){if(e){ve();const f=e;q(f.$$.fragment,1,0,()=>{ae(f,1)}),ye()}r?(e=ii(r,a()),he(e.$$.fragment),B(e.$$.fragment,1),le(e,i.parentNode,i)):e=null}},i(u){s||(e&&B(e.$$.fragment,u),s=!0)},o(u){e&&q(e.$$.fragment,u),s=!1},d(u){u&&F(i),e&&ae(e,u)}}}function ll(n){let e,i,s;var r=n[13];function a(u,c){return{}}return r&&(e=ii(r,a())),{c(){e&&he(e.$$.fragment),i=ze()},m(u,c){e&&le(e,u,c),G(u,i,c),s=!0},p(u,c){if(c[0]&8192&&r!==(r=u[13])){if(e){ve();const f=e;q(f.$$.fragment,1,0,()=>{ae(f,1)}),ye()}r?(e=ii(r,a()),he(e.$$.fragment),B(e.$$.fragment,1),le(e,i.parentNode,i)):e=null}},i(u){s||(e&&B(e.$$.fragment,u),s=!0)},o(u){e&&q(e.$$.fragment,u),s=!1},d(u){u&&F(i),e&&ae(e,u)}}}function al(n){let e,i,s;var r=n[16];function a(u,c){return{}}return r&&(e=ii(r,a())),{c(){e&&he(e.$$.fragment),i=ze()},m(u,c){e&&le(e,u,c),G(u,i,c),s=!0},p(u,c){if(c[0]&65536&&r!==(r=u[16])){if(e){ve();const f=e;q(f.$$.fragment,1,0,()=>{ae(f,1)}),ye()}r?(e=ii(r,a()),he(e.$$.fragment),B(e.$$.fragment,1),le(e,i.parentNode,i)):e=null}},i(u){s||(e&&B(e.$$.fragment,u),s=!0)},o(u){e&&q(e.$$.fragment,u),s=!1},d(u){u&&F(i),e&&ae(e,u)}}}function ul(n){let e,i,s;var r=n[17];function a(u,c){return{}}return r&&(e=ii(r,a())),{c(){e&&he(e.$$.fragment),i=ze()},m(u,c){e&&le(e,u,c),G(u,i,c),s=!0},p(u,c){if(c[0]&131072&&r!==(r=u[17])){if(e){ve();const f=e;q(f.$$.fragment,1,0,()=>{ae(f,1)}),ye()}r?(e=ii(r,a()),he(e.$$.fragment),B(e.$$.fragment,1),le(e,i.parentNode,i)):e=null}},i(u){s||(e&&B(e.$$.fragment,u),s=!0)},o(u){e&&q(e.$$.fragment,u),s=!1},d(u){u&&F(i),e&&ae(e,u)}}}function cl(n){let e,i;return e=new pf({props:{creating:n[20],anchor:n[18],graph:n[3],adding:n[21],color:n[9]}}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},p(s,r){const a={};r[0]&1048576&&(a.creating=s[20]),r[0]&262144&&(a.anchor=s[18]),r[0]&8&&(a.graph=s[3]),r[0]&2097152&&(a.adding=s[21]),r[0]&512&&(a.color=s[9]),e.$set(a)},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Sf(n){let e,i,s,r,a,u,c,f,d,p,g,k,b,P,S,z,A,E,O,Z;i=new rf({props:{isMovable:n[22],$$slots:{default:[Pf]},$$scope:{ctx:n}}});const Y=[Cf,Lf],j=[];function tt(R,U){return R[10]?0:1}r=tt(n),a=j[r]=Y[r](n);let J=n[0]&&sl(n),et=n[1]&&rl(n),ot=n[6]&&ll(n),lt=n[2]&&al(n),N=n[12]&&ul(n);const nt=n[56].minimap,X=Ce(nt,n,n[58],nl),ct=n[56].drawer,dt=Ce(ct,n,n[58],el),Q=n[56].controls,W=Ce(Q,n,n[58],tl),At=n[56].toggle,st=Ce(At,n,n[58],$r),yt=n[56].contrast,Lt=Ce(yt,n,n[58],Qr);let _t=n[19]&&!n[8]&&cl(n);return{c(){e=M("section"),he(i.$$.fragment),s=V(),a.c(),u=V(),J&&J.c(),c=V(),et&&et.c(),f=V(),ot&&ot.c(),d=V(),lt&&lt.c(),p=V(),N&&N.c(),g=V(),X&&X.c(),k=V(),dt&&dt.c(),b=V(),W&&W.c(),P=V(),st&&st.c(),S=V(),Lt&&Lt.c(),z=V(),_t&&_t.c(),m(e,"role","presentation"),m(e,"id",A=n[3].id),m(e,"class","svelvet-wrapper svelte-13nq7cv"),m(e,"title",n[11]),m(e,"tabindex",0),at(e,"width",n[4]?n[4]+"px":"100%"),at(e,"height",n[5]?n[5]+"px":"100%"),at(e,"cursor",n[7]?"move":"default")},m(R,U){G(R,e,U),le(i,e,null),y(e,s),j[r].m(e,null),y(e,u),J&&J.m(e,null),y(e,c),et&&et.m(e,null),y(e,f),ot&&ot.m(e,null),y(e,d),lt&&lt.m(e,null),y(e,p),N&&N.m(e,null),y(e,g),X&&X.m(e,null),y(e,k),dt&&dt.m(e,null),y(e,b),W&&W.m(e,null),y(e,P),st&&st.m(e,null),y(e,S),Lt&&Lt.m(e,null),y(e,z),_t&&_t.m(e,null),n[57](e),E=!0,O||(Z=[ht(window,"touchend",n[36]),ht(window,"mouseup",n[36]),ht(window,"resize",n[35]),ht(window,"scroll",n[35]),ht(e,"wheel",jn(n[43])),ht(e,"mousedown",Ji(jn(n[37]))),ht(e,"touchend",jn(n[39])),ht(e,"touchstart",Ji(jn(n[38]))),ht(e,"keydown",n[40]),ht(e,"keyup",n[42]),ht(e,"dragover",jn(Mf)),ht(e,"drop",n[41])],O=!0)},p(R,U){const H={};U[0]&4194304&&(H.isMovable=R[22]),U[0]&16777216|U[1]&134217728&&(H.$$scope={dirty:U,ctx:R}),i.$set(H);let K=r;r=tt(R),r===K?j[r].p(R,U):(ve(),q(j[K],1,1,()=>{j[K]=null}),ye(),a=j[r],a?a.p(R,U):(a=j[r]=Y[r](R),a.c()),B(a,1),a.m(e,u)),R[0]?J?(J.p(R,U),U[0]&1&&B(J,1)):(J=sl(R),J.c(),B(J,1),J.m(e,c)):J&&(ve(),q(J,1,1,()=>{J=null}),ye()),R[1]?et?(et.p(R,U),U[0]&2&&B(et,1)):(et=rl(R),et.c(),B(et,1),et.m(e,f)):et&&(ve(),q(et,1,1,()=>{et=null}),ye()),R[6]?ot?(ot.p(R,U),U[0]&64&&B(ot,1)):(ot=ll(R),ot.c(),B(ot,1),ot.m(e,d)):ot&&(ve(),q(ot,1,1,()=>{ot=null}),ye()),R[2]?lt?(lt.p(R,U),U[0]&4&&B(lt,1)):(lt=al(R),lt.c(),B(lt,1),lt.m(e,p)):lt&&(ve(),q(lt,1,1,()=>{lt=null}),ye()),R[12]?N?(N.p(R,U),U[0]&4096&&B(N,1)):(N=ul(R),N.c(),B(N,1),N.m(e,g)):N&&(ve(),q(N,1,1,()=>{N=null}),ye()),X&&X.p&&(!E||U[1]&134217728)&&Me(X,nt,R,R[58],E?Se(nt,R[58],U,bf):Te(R[58]),nl),dt&&dt.p&&(!E||U[1]&134217728)&&Me(dt,ct,R,R[58],E?Se(ct,R[58],U,wf):Te(R[58]),el),W&&W.p&&(!E||U[1]&134217728)&&Me(W,Q,R,R[58],E?Se(Q,R[58],U,yf):Te(R[58]),tl),st&&st.p&&(!E||U[1]&134217728)&&Me(st,At,R,R[58],E?Se(At,R[58],U,vf):Te(R[58]),$r),Lt&&Lt.p&&(!E||U[1]&134217728)&&Me(Lt,yt,R,R[58],E?Se(yt,R[58],U,gf):Te(R[58]),Qr),R[19]&&!R[8]?_t?(_t.p(R,U),U[0]&524544&&B(_t,1)):(_t=cl(R),_t.c(),B(_t,1),_t.m(e,null)):_t&&(ve(),q(_t,1,1,()=>{_t=null}),ye()),(!E||U[0]&8&&A!==(A=R[3].id))&&m(e,"id",A),(!E||U[0]&2048)&&m(e,"title",R[11]),U[0]&16&&at(e,"width",R[4]?R[4]+"px":"100%"),U[0]&32&&at(e,"height",R[5]?R[5]+"px":"100%"),U[0]&128&&at(e,"cursor",R[7]?"move":"default")},i(R){E||(B(i.$$.fragment,R),B(a),B(J),B(et),B(ot),B(lt),B(N),B(X,R),B(dt,R),B(W,R),B(st,R),B(Lt,R),B(_t),E=!0)},o(R){q(i.$$.fragment,R),q(a),q(J),q(et),q(ot),q(lt),q(N),q(X,R),q(dt,R),q(W,R),q(st,R),q(Lt,R),q(_t),E=!1},d(R){R&&F(e),ae(i),j[r].d(),J&&J.d(),et&&et.d(),ot&&ot.d(),lt&&lt.d(),N&&N.d(),X&&X.d(R),dt&&dt.d(R),W&&W.d(R),st&&st.d(R),Lt&&Lt.d(R),_t&&_t.d(),n[57](null),O=!1,$e(Z)}}}function Mf(n){n.preventDefault()}function Tf(n,e,i){let s,r,a,u,c,f,d,p,g,k,b,P,S,z,A;pt(n,es,w=>i(70,d=w)),pt(n,On,w=>i(71,p=w)),pt(n,Zn,w=>i(72,g=w)),pt(n,ni,w=>i(75,P=w));let{$$slots:E={},$$scope:O}=e,{graph:Z}=e,{width:Y}=e,{height:j}=e,{minimap:tt=!1}=e,{controls:J=!1}=e,{toggle:et=!1}=e,{fixedZoom:ot=!1}=e,{pannable:lt=!0}=e,{disableSelection:N=!1}=e,{ZOOM_INCREMENT:nt=.1}=e,{PAN_INCREMENT:X=50}=e,{PAN_TIME:ct=250}=e,{MAX_SCALE:dt=3}=e,{MIN_SCALE:Q=.2}=e,{selectionColor:W}=e,{backgroundExists:At}=e,{fitView:st=!1}=e,{trackpadPan:yt}=e,{modifier:Lt}=e,{theme:_t="light"}=e,{title:R}=e,{drawer:U=!1}=e,{contrast:H=!1}=e;console.log("Initial Graph drawer prop:",U);let K;const Nt=Zi(),Wt={},rt=it(!1),Ct=it(0),Mt=it(null);pt(n,Mt,w=>i(23,c=w));const xt=Z.cursor,qt=Z.transforms.scale;pt(n,qt,w=>i(68,u=w));const we=Z.dimensions;pt(n,we,w=>i(55,z=w));const fe=Z.transforms.translation;pt(n,fe,w=>i(67,a=w));const $=Z.groups;pt(n,$,w=>i(69,f=w));const Ot=Z.groupBoxes,zt=f.selected.nodes;pt(n,zt,w=>i(66,r=w));const Tt=Z.activeGroup;pt(n,Tt,w=>i(74,b=w));const Ft=Z.initialNodePositions;pt(n,Ft,w=>i(73,k=w));const Ut=Z.editing;pt(n,Ut,w=>i(24,A=w));const xe=Z.bounds.nodeBounds;pt(n,xe,w=>i(76,S=w));let Ke=0,De=1,Yt={x:0,y:0,top:0,left:0},Re=!1,ie=!1,tn=!1,be=!1,pe=!1,Ee=!1,je,We=null,en=null,ke=null,He=null,jt=null;const Ge={id:null,position:Z.cursor,offset:it({x:0,y:0}),connected:it(new Set),dynamic:it(!1),edge:null,edgeColor:it(null),direction:it("self"),inputKey:null,type:"output",moving:Co(!1),store:null,mounted:it(!0),rotation:Co(0),node:{zIndex:it(1/0),rotating:it(!1),position:Z.cursor,dimensions:{width:it(0),height:it(0)}}};Ie("graphDOMElement",Mt),Ie("cursorAnchor",Ge),Ie("duplicate",rt),Ie("graph",Z),Ie("transforms",Z.transforms),Ie("dimensions",Z.dimensions),Ie("locked",Z.locked),Ie("groups",Z.groups),Ie("bounds",Z.bounds),Ie("edgeStore",Z.edges),Ie("nodeStore",Z.nodes),Ie("mounted",Ct),Hn(()=>{console.log("Graph component mounted with drawer1:",U),gn()});async function Ye(){await ea(),Zn.set(!0);const{x:w,y:mt,scale:Pt}=ic(je,S);w!==null&&mt!==null&&Pt!==null&&(Z.transforms.scale.set(Pt),fe.set({x:w,y:mt})),Zn.set(!1),i(54,Ee=!0)}async function bn(){i(14,en=(await qi(async()=>{const{default:w}=await import("./Minimap-C_z_fKDs.js");return{default:w}},[])).default)}async function nn(){i(13,We=(await qi(async()=>{const{default:w}=await import("./ThemeToggle-BazHQlLN.js");return{default:w}},[])).default)}async function on(){i(15,ke=(await qi(async()=>{const{default:w}=await import("./Controls-3r3r0iOH.js");return{default:w}},__vite__mapDeps([0,1]))).default)}async function Oe(){i(16,He=(await qi(async()=>{const{default:w}=await import("./DrawerController-IAzRTCF_.js");return{default:w}},__vite__mapDeps([2,1,3]))).default)}async function Fe(){i(17,jt=(await qi(async()=>{const{default:w}=await import("./ContrastTheme-BPfd7GIm.js");return{default:w}},[])).default)}function gn(){if(!c)return;const w=c.getBoundingClientRect();je={top:w.top,left:w.left,bottom:w.bottom,right:w.right,width:w.width,height:w.height},Z.dimensions.set(je),st==="resize"&&Ye()}function ue(w){if(ie){const kt=`${Uu()}/${Z.id}`,Et=wt(xt),x=Et.x-p.x,Kt=Et.y-p.y,_e=Math.min(p.y,p.y+Kt),Jt=Math.min(p.x,p.x+x),Pe={width:it(Math.abs(x)),height:it(Math.abs(Kt))},sn=it({x:Jt,y:_e}),Ue={group:it(kt),dimensions:Pe,position:sn,color:it(Du()),moving:it(!1)};Ot.add(Ue,kt),Array.from(r).forEach(Ln=>{Ln.group.set(kt)}),$.update(Ln=>{const Cn={parent:it(Ue),nodes:it(new Set([...r,Ue]))};return Ln[kt]=Cn,Ln}),Bt(zt,r=new Set,r),i(20,ie=!1),i(19,Re=!1)}b&&Array.from(wt(f[b].nodes)).forEach(kt=>{const Et=Lo(wt(kt.position).x,wt(kt.position).y);kt.position.set(Et),kt.moving.set(!1)});const mt=Z.edges.get("cursor");mt&&(Z.edges.delete("cursor"),mt.disconnect||Nt("edgeDrop",{cursor:wt(xt),source:{node:P==null?void 0:P.anchor.node.id.slice(2),anchor:P==null?void 0:P.anchor.id.split("/")[0].slice(2)}})),Bt(Tt,b=null,b),Bt(On,p={x:0,y:0},p),Bt(Ft,k=[],k),i(19,Re=!1),i(22,be=!1),Bt(Zn,g=!1,g),w.shiftKey||ni.set(null),i(18,Yt.y=0,Yt),i(18,Yt.x=0,Yt)}function de(w){if(!lt&&!(w.shiftKey||w.metaKey)||w.button===2)return;c&&c.focus();const{clientX:mt,clientY:Pt}=w;if(Bt(On,p=wt(xt),p),w.shiftKey||w.metaKey){w.preventDefault(),i(19,Re=!0);const{top:kt,left:Et}=s;i(18,Yt.y=Pt-kt,Yt),i(18,Yt.x=mt-Et,Yt),i(18,Yt.top=kt,Yt),i(18,Yt.left=Et,Yt),w.shiftKey&&w.metaKey?i(20,ie=!0):i(20,ie=!1),w.metaKey&&!w.shiftKey?i(21,tn=!0):i(21,tn=!1)}else i(22,be=!0),Bt(zt,r=new Set,r),zt.set(r)}function qe(w){Bt(zt,r=new Set,r),zt.set(r),Bt(On,p=wt(xt),p),i(22,be=!0),w.touches.length===2&&(vn(),Ke=d,De=u)}function kn(){i(22,be=!1),pe=!1}function vn(){pe||(pe=!0,K=requestAnimationFrame(Nn))}function Nn(){if(!pe){cancelAnimationFrame(K);return}const mt=d/Ke;Bt(qt,u=De*mt,u),K=requestAnimationFrame(Nn)}function Mn(w){const{key:mt,code:Pt}=w,kt=w.target;if(!(kt.tagName=="INPUT"||kt.tagName=="TEXTAREA")){if(Pt==="KeyA"&&w[`${Lt}Key`]){const Et=Z.nodes.getAll().filter(x=>!wt(x.locked));Bt(zt,r=new Set(Et),r)}else if(Xr(mt))cn(mt,w);else if(mt==="=")Qs(-1,Z.dimensions,Z.transforms,nt);else if(mt==="-")Qs(1,Z.dimensions,Z.transforms,nt);else if(mt==="0")Ye();else if(mt==="Control")f.selected.nodes.set(new Set);else if(Pt==="KeyD"&&w[`${Lt}Key`])rt.set(!0),setTimeout(()=>{rt.set(!1)},100);else if(mt==="Tab"&&(w.altKey||w.ctrlKey))bt();else if(mt==="l")i(44,_t=_t==="light"?"dark":"light");else if(mt==="d")i(2,U=!U);else if(mt==="m")i(0,tt=!tt);else if(mt==="c")i(1,J=!J);else if(mt==="e"){const Et=Array.from(r)[0];Z.editing.set(Et)}else return;w.preventDefault()}}function Be(w){w.preventDefault();const mt=c==null?void 0:c.getBoundingClientRect();if(!mt)return;const Pt=w.clientX-mt.left,kt=w.clientY-mt.top,{x:Et,y:x}=Lo(Pt,kt);if(console.log(`Dropped Node at Snapped Position: (${Et}, ${x})`),!_e)return;const Kt={id:`node-${Date.now()}`,rotation:it(0),position:it({x:Et,y:x}),moving:it(!1),label:it("New Node"),dimensions:{width:it(200),height:it(100)},inputs:it(2),outputs:it(2),anchors:it([]),group:it(null),collapsed:it(!1),resizingWidth:it(!1),resizingHeight:it(!1),rotating:it(!1),editable:it(!0),locked:it(!1),recalculateAnchors:Jt=>{},resizable:it(!0),zIndex:it(1),edge:null,direction:it("TD"),borderRadius:it(5),borderWidth:it(1),connections:it([]),bgColor:it("#007bff"),borderColor:it("#000"),selectionColor:it("#ff0000"),textColor:it("#fff")};let _e=null;Z.nodes.add(Kt,Kt.id),_e=null}function bt(){const w=Z.nodes.getAll(),mt=w.findIndex(kt=>r.has(kt)),Pt=mt+1;r.delete(w[mt]),r.add(w[Pt])}function yn(w){const{key:mt}=w;Xr(mt)?(clearInterval(Wt[mt]),delete Wt[mt]):mt==="Shift"&&ni.set(null)}function wn(w){if(ot)return;const mt=w.shiftKey?.15:1,{clientX:Pt,clientY:kt,deltaY:Et}=w,x=a,Kt={x:Pt,y:kt};if((yt||w.metaKey)&&Et%1===0){Bt(fe,a={x:Bt(fe,a.x-=w.deltaX,a),y:Bt(fe,a.y-=w.deltaY,a)},a);return}if(u>=dt&&Et<0||u<=Q&&Et>0)return;const _e=Math.min(.009*mt*Math.abs(Et),.08),Jt=aa(u,Math.sign(Et),_e),Pe=la(u,Jt,x,Kt,je);qt.set(Jt),fe.set(Pe)}function cn(w,mt){const Pt=mt.shiftKey?2:1,kt=w==="ArrowLeft"||w==="ArrowUp"?1:-1,Et=w==="ArrowLeft"||w==="ArrowRight",x=Et?a.x:a.y,Kt=x+kt*X*Pt;if(!Wt[w]){const _e=performance.now();let Jt=setInterval(()=>{const Pe=performance.now()-_e;if(r.size===0){const sn=x+(Kt-x)*(Pe/ct);fe.set({x:Et?sn:a.x,y:Et?a.y:sn})}else{const sn={x:Et?-kt*2:0,y:Et?0:-kt*2};Array.from(r).forEach(Ue=>{const Ln=wt(Ue.position);let Cn;const Yn=wt(Ue.group),Dn=wt(Z.groupBoxes);if(Yn&&(Cn=Dn.get(Yn)),Cn){const Tn=wt(Ue.dimensions.width),Ve=wt(Ue.dimensions.height),Rn=fa(Cn,Tn,Ve);ha(Ln,sn,Ue.position,Rn)}else{const Tn={x:Ln.x+sn.x,y:Ln.y+sn.y},Ve=Lo(Tn.x,Tn.y);Ue.position.set(Ve)}})}},2);Wt[w]=Jt}}function Pn(w){Xn[w?"unshift":"push"](()=>{c=w,Mt.set(c)})}return n.$$set=w=>{"graph"in w&&i(3,Z=w.graph),"width"in w&&i(4,Y=w.width),"height"in w&&i(5,j=w.height),"minimap"in w&&i(0,tt=w.minimap),"controls"in w&&i(1,J=w.controls),"toggle"in w&&i(6,et=w.toggle),"fixedZoom"in w&&i(45,ot=w.fixedZoom),"pannable"in w&&i(7,lt=w.pannable),"disableSelection"in w&&i(8,N=w.disableSelection),"ZOOM_INCREMENT"in w&&i(46,nt=w.ZOOM_INCREMENT),"PAN_INCREMENT"in w&&i(47,X=w.PAN_INCREMENT),"PAN_TIME"in w&&i(48,ct=w.PAN_TIME),"MAX_SCALE"in w&&i(49,dt=w.MAX_SCALE),"MIN_SCALE"in w&&i(50,Q=w.MIN_SCALE),"selectionColor"in w&&i(9,W=w.selectionColor),"backgroundExists"in w&&i(10,At=w.backgroundExists),"fitView"in w&&i(51,st=w.fitView),"trackpadPan"in w&&i(52,yt=w.trackpadPan),"modifier"in w&&i(53,Lt=w.modifier),"theme"in w&&i(44,_t=w.theme),"title"in w&&i(11,R=w.title),"drawer"in w&&i(2,U=w.drawer),"contrast"in w&&i(12,H=w.contrast),"$$scope"in w&&i(58,O=w.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&16777216&&(s=z),n.$$.dirty[1]&8192&&_t&&document.documentElement.setAttribute("svelvet-theme",_t),n.$$.dirty[1]&9437184&&!Ee&&st&&Ye(),n.$$.dirty[0]&8256&&et&&!We&&nn(),n.$$.dirty[0]&16385&&tt&&!en&&bn(),n.$$.dirty[0]&32770&&J&&!ke&&on(),n.$$.dirty[0]&65540&&U&&!He&&Oe(),n.$$.dirty[0]&135168&&H&&!jt&&Fe(),n.$$.dirty[0]&4&&console.log("Reactive Graph drawer prop:",U)},[tt,J,U,Z,Y,j,et,lt,N,W,At,R,H,We,en,ke,He,jt,Yt,Re,ie,tn,be,c,A,Mt,qt,we,fe,$,zt,Tt,Ft,Ut,xe,gn,ue,de,qe,kn,Mn,Be,yn,wn,_t,ot,nt,X,ct,dt,Q,st,yt,Lt,Ee,z,E,Pn,O]}class Ef extends pn{constructor(e){super(),mn(this,e,Tf,Sf,un,{graph:3,width:4,height:5,minimap:0,controls:1,toggle:6,fixedZoom:45,pannable:7,disableSelection:8,ZOOM_INCREMENT:46,PAN_INCREMENT:47,PAN_TIME:48,MAX_SCALE:49,MIN_SCALE:50,selectionColor:9,backgroundExists:10,fitView:51,trackpadPan:52,modifier:53,theme:44,title:11,drawer:2,contrast:12},null,[-1,-1,-1])}}const Af=n=>({}),hl=n=>({slot:"minimap"}),zf=n=>({}),fl=n=>({slot:"controls"}),Nf=n=>({}),dl=n=>({slot:"background"}),If=n=>({}),_l=n=>({slot:"toggle"}),xf=n=>({}),ml=n=>({slot:"drawer"}),Of=n=>({}),pl=n=>({slot:"contrast"});function Bf(n){let e;return{c(){e=M("div"),m(e,"class","svelvet-temp svelte-lsy29y"),at(e,"width",n[2]?n[2]+"px":"100%"),at(e,"height",n[3]?n[3]+"px":"100%")},m(i,s){G(i,e,s)},p(i,s){s[0]&4&&at(e,"width",i[2]?i[2]+"px":"100%"),s[0]&8&&at(e,"height",i[3]?i[3]+"px":"100%")},i:Gt,o:Gt,d(i){i&&F(e)}}}function Zf(n){let e,i;return e=new Ef({props:{width:n[2],height:n[3],toggle:n[6],backgroundExists:n[19],minimap:n[4],graph:n[18],fitView:n[9],fixedZoom:n[16],pannable:n[17],theme:n[1],drawer:n[7],controls:n[5],selectionColor:n[10],disableSelection:n[11],trackpadPan:n[13],modifier:n[14],title:n[15],contrast:n[8],$$slots:{contrast:[Gf],drawer:[Ff],toggle:[Hf],background:[Wf],controls:[jf],minimap:[Rf],default:[Df]},$$scope:{ctx:n}}}),e.$on("edgeDrop",n[35]),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},p(s,r){const a={};r[0]&4&&(a.width=s[2]),r[0]&8&&(a.height=s[3]),r[0]&64&&(a.toggle=s[6]),r[0]&524288&&(a.backgroundExists=s[19]),r[0]&16&&(a.minimap=s[4]),r[0]&262144&&(a.graph=s[18]),r[0]&512&&(a.fitView=s[9]),r[0]&65536&&(a.fixedZoom=s[16]),r[0]&131072&&(a.pannable=s[17]),r[0]&2&&(a.theme=s[1]),r[0]&128&&(a.drawer=s[7]),r[0]&32&&(a.controls=s[5]),r[0]&1024&&(a.selectionColor=s[10]),r[0]&2048&&(a.disableSelection=s[11]),r[0]&8192&&(a.trackpadPan=s[13]),r[0]&16384&&(a.modifier=s[14]),r[0]&32768&&(a.title=s[15]),r[0]&256&&(a.contrast=s[8]),r[0]&4097|r[1]&32&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function gl(n){let e,i;return e=new Oh({props:{mermaid:n[0],mermaidConfig:n[12]}}),{c(){he(e.$$.fragment)},m(s,r){le(e,s,r),i=!0},p(s,r){const a={};r[0]&1&&(a.mermaid=s[0]),r[0]&4096&&(a.mermaidConfig=s[12]),e.$set(a)},i(s){i||(B(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){ae(e,s)}}}function Df(n){let e,i,s=n[0].length&&gl(n);const r=n[34].default,a=Ce(r,n,n[36],null);return{c(){s&&s.c(),e=V(),a&&a.c()},m(u,c){s&&s.m(u,c),G(u,e,c),a&&a.m(u,c),i=!0},p(u,c){u[0].length?s?(s.p(u,c),c[0]&1&&B(s,1)):(s=gl(u),s.c(),B(s,1),s.m(e.parentNode,e)):s&&(ve(),q(s,1,1,()=>{s=null}),ye()),a&&a.p&&(!i||c[1]&32)&&Me(a,r,u,u[36],i?Se(r,u[36],c,null):Te(u[36]),null)},i(u){i||(B(s),B(a,u),i=!0)},o(u){q(s),q(a,u),i=!1},d(u){u&&F(e),s&&s.d(u),a&&a.d(u)}}}function Rf(n){let e;const i=n[34].minimap,s=Ce(i,n,n[36],hl);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&32)&&Me(s,i,r,r[36],e?Se(i,r[36],a,Af):Te(r[36]),hl)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function jf(n){let e;const i=n[34].controls,s=Ce(i,n,n[36],fl);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&32)&&Me(s,i,r,r[36],e?Se(i,r[36],a,zf):Te(r[36]),fl)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function Wf(n){let e;const i=n[34].background,s=Ce(i,n,n[36],dl);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&32)&&Me(s,i,r,r[36],e?Se(i,r[36],a,Nf):Te(r[36]),dl)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function Hf(n){let e;const i=n[34].toggle,s=Ce(i,n,n[36],_l);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&32)&&Me(s,i,r,r[36],e?Se(i,r[36],a,If):Te(r[36]),_l)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function Ff(n){let e;const i=n[34].drawer,s=Ce(i,n,n[36],ml);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&32)&&Me(s,i,r,r[36],e?Se(i,r[36],a,xf):Te(r[36]),ml)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function Gf(n){let e;const i=n[34].contrast,s=Ce(i,n,n[36],pl);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&32)&&Me(s,i,r,r[36],e?Se(i,r[36],a,Of):Te(r[36]),pl)},i(r){e||(B(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function Uf(n){let e,i,s,r;const a=[Zf,Bf],u=[];function c(f,d){return f[18]?0:1}return e=c(n),i=u[e]=a[e](n),{c(){i.c(),s=ze()},m(f,d){u[e].m(f,d),G(f,s,d),r=!0},p(f,d){let p=e;e=c(f),e===p?u[e].p(f,d):(ve(),q(u[p],1,1,()=>{u[p]=null}),ye(),i=u[e],i?i.p(f,d):(i=u[e]=a[e](f),i.c()),B(i,1),i.m(s.parentNode,s))},i(f){r||(B(i),r=!0)},o(f){q(i),r=!1},d(f){f&&F(s),u[e].d(f)}}}function Vf(n,e,i){let s,r,{$$slots:a={},$$scope:u}=e;const c=rs(a);let{mermaid:f=""}=e,{theme:d="light"}=e,{id:p=0}=e,{snapTo:g=0}=e,{zoom:k=1}=e,{TD:b=!1}=e,{editable:P=!0}=e,{locked:S=!1}=e,{width:z=0}=e,{height:A=0}=e,{minimap:E=!1}=e,{controls:O=!1}=e,{toggle:Z=!1}=e,{drawer:Y=!1}=e,{contrast:j=!1}=e,{fitView:tt=!1}=e,{selectionColor:J="lightblue"}=e,{edgeStyle:et="bezier"}=e,{endStyles:ot=[null,null]}=e,{edge:lt=null}=e,{disableSelection:N=!1}=e,{mermaidConfig:nt={}}=e,{translation:X={x:0,y:0}}=e,{trackpadPan:ct=!1}=e,{modifier:dt="meta"}=e,{raiseEdgesOnSelect:Q=!1}=e,{edgesAboveNode:W=!1}=e,{title:At=""}=e,{fixedZoom:st=!1}=e,{pannable:yt=!0}=e;const Lt=Zi();let _t=null,R=b?"TD":"LR";Ie("snapTo",g),Ie("edgeStyle",et),Ie("endStyles",ot),Ie("graphEdge",lt),Ie("raiseEdgesOnSelect",Q),Ie("edgesAboveNode",W),Ie("graph",_t),Hn(()=>{console.log("Graph component mounted with drawer:",Y);const K=localStorage.getItem("state");if(console.log("stateObject during onMount:",K),K)i(18,_t=cc(K)),console.log("This is the graph set using reloadStore",_t),Xo.add(_t,_t.id),console.log("graphStore updated",_t);else{let Nt=`G-${p||Xo.count()+1}`;i(18,_t=ua(Nt,{zoom:k,direction:R,editable:P,locked:S,translation:X})),Xo.add(_t,Nt)}});function U(K,Nt){if(!_t)return;const Wt=`N-${K[0]}`,rt=_t.nodes.get(Wt);if(!rt)return;const Ct=rt.anchors.get(`A-${K[1]}/N-${K[0]}`);if(!Ct)return;const Mt=`N-${Nt[0]}`,xt=_t.nodes.get(Mt);if(!xt)return;const qt=xt.anchors.get(`A-${Nt[1]}/N-${Nt[0]}`);if(!qt)return;const we=_t.edges.match(Ct,qt);we&&_t.edges.delete(we[0])}function H(K){Xe.call(this,n,K)}return n.$$set=K=>{"mermaid"in K&&i(0,f=K.mermaid),"theme"in K&&i(1,d=K.theme),"id"in K&&i(20,p=K.id),"snapTo"in K&&i(21,g=K.snapTo),"zoom"in K&&i(22,k=K.zoom),"TD"in K&&i(23,b=K.TD),"editable"in K&&i(24,P=K.editable),"locked"in K&&i(25,S=K.locked),"width"in K&&i(2,z=K.width),"height"in K&&i(3,A=K.height),"minimap"in K&&i(4,E=K.minimap),"controls"in K&&i(5,O=K.controls),"toggle"in K&&i(6,Z=K.toggle),"drawer"in K&&i(7,Y=K.drawer),"contrast"in K&&i(8,j=K.contrast),"fitView"in K&&i(9,tt=K.fitView),"selectionColor"in K&&i(10,J=K.selectionColor),"edgeStyle"in K&&i(26,et=K.edgeStyle),"endStyles"in K&&i(27,ot=K.endStyles),"edge"in K&&i(28,lt=K.edge),"disableSelection"in K&&i(11,N=K.disableSelection),"mermaidConfig"in K&&i(12,nt=K.mermaidConfig),"translation"in K&&i(29,X=K.translation),"trackpadPan"in K&&i(13,ct=K.trackpadPan),"modifier"in K&&i(14,dt=K.modifier),"raiseEdgesOnSelect"in K&&i(30,Q=K.raiseEdgesOnSelect),"edgesAboveNode"in K&&i(31,W=K.edgesAboveNode),"title"in K&&i(15,At=K.title),"fixedZoom"in K&&i(16,st=K.fixedZoom),"pannable"in K&&i(17,yt=K.pannable),"$$scope"in K&&i(36,u=K.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&262144&&i(33,r=_t&&_t.edges),n.$$.dirty[0]&4456448&&_t&&_t.transforms.scale.set(k),n.$$.dirty[1]&4&&r&&r.onEdgeChange((K,Nt)=>{Lt(Nt,{sourceAnchor:K.source,targetAnchor:K.target,sourceNode:K.source.node,targetNode:K.target.node})})},i(19,s=c.background),[f,d,z,A,E,O,Z,Y,j,tt,J,N,nt,ct,dt,At,st,yt,_t,s,p,g,k,b,P,S,et,ot,lt,X,Q,W,U,r,a,H,u]}class Xf extends pn{constructor(e){super(),mn(this,e,Vf,Uf,un,{mermaid:0,theme:1,id:20,snapTo:21,zoom:22,TD:23,editable:24,locked:25,width:2,height:3,minimap:4,controls:5,toggle:6,drawer:7,contrast:8,fitView:9,selectionColor:10,edgeStyle:26,endStyles:27,edge:28,disableSelection:11,mermaidConfig:12,translation:29,trackpadPan:13,modifier:14,raiseEdgesOnSelect:30,edgesAboveNode:31,title:15,fixedZoom:16,pannable:17,disconnect:32},null,[-1,-1])}get disconnect(){return this.$$.ctx[32]}}var Yf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},os={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(n,e){(function(i,s){s(e)})(Yf,function(i){var s="1.9.4";function r(t){var o,l,h,_;for(l=1,h=arguments.length;l<h;l++){_=arguments[l];for(o in _)t[o]=_[o]}return t}var a=Object.create||function(){function t(){}return function(o){return t.prototype=o,new t}}();function u(t,o){var l=Array.prototype.slice;if(t.bind)return t.bind.apply(t,l.call(arguments,1));var h=l.call(arguments,2);return function(){return t.apply(o,h.length?h.concat(l.call(arguments)):arguments)}}var c=0;function f(t){return"_leaflet_id"in t||(t._leaflet_id=++c),t._leaflet_id}function d(t,o,l){var h,_,v,C;return C=function(){h=!1,_&&(v.apply(l,_),_=!1)},v=function(){h?_=arguments:(t.apply(l,arguments),setTimeout(C,o),h=!0)},v}function p(t,o,l){var h=o[1],_=o[0],v=h-_;return t===h&&l?t:((t-_)%v+v)%v+_}function g(){return!1}function k(t,o){if(o===!1)return t;var l=Math.pow(10,o===void 0?6:o);return Math.round(t*l)/l}function b(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function P(t){return b(t).split(/\s+/)}function S(t,o){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?a(t.options):{});for(var l in o)t.options[l]=o[l];return t.options}function z(t,o,l){var h=[];for(var _ in t)h.push(encodeURIComponent(l?_.toUpperCase():_)+"="+encodeURIComponent(t[_]));return(!o||o.indexOf("?")===-1?"?":"&")+h.join("&")}var A=/\{ *([\w_ -]+) *\}/g;function E(t,o){return t.replace(A,function(l,h){var _=o[h];if(_===void 0)throw new Error("No value provided for variable "+l);return typeof _=="function"&&(_=_(o)),_})}var O=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function Z(t,o){for(var l=0;l<t.length;l++)if(t[l]===o)return l;return-1}var Y="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function j(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var tt=0;function J(t){var o=+new Date,l=Math.max(0,16-(o-tt));return tt=o+l,window.setTimeout(t,l)}var et=window.requestAnimationFrame||j("RequestAnimationFrame")||J,ot=window.cancelAnimationFrame||j("CancelAnimationFrame")||j("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function lt(t,o,l){if(l&&et===J)t.call(o);else return et.call(window,u(t,o))}function N(t){t&&ot.call(window,t)}var nt={__proto__:null,extend:r,create:a,bind:u,get lastId(){return c},stamp:f,throttle:d,wrapNum:p,falseFn:g,formatNum:k,trim:b,splitWords:P,setOptions:S,getParamString:z,template:E,isArray:O,indexOf:Z,emptyImageUrl:Y,requestFn:et,cancelFn:ot,requestAnimFrame:lt,cancelAnimFrame:N};function X(){}X.extend=function(t){var o=function(){S(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},l=o.__super__=this.prototype,h=a(l);h.constructor=o,o.prototype=h;for(var _ in this)Object.prototype.hasOwnProperty.call(this,_)&&_!=="prototype"&&_!=="__super__"&&(o[_]=this[_]);return t.statics&&r(o,t.statics),t.includes&&(ct(t.includes),r.apply(null,[h].concat(t.includes))),r(h,t),delete h.statics,delete h.includes,h.options&&(h.options=l.options?a(l.options):{},r(h.options,t.options)),h._initHooks=[],h.callInitHooks=function(){if(!this._initHooksCalled){l.callInitHooks&&l.callInitHooks.call(this),this._initHooksCalled=!0;for(var v=0,C=h._initHooks.length;v<C;v++)h._initHooks[v].call(this)}},o},X.include=function(t){var o=this.prototype.options;return r(this.prototype,t),t.options&&(this.prototype.options=o,this.mergeOptions(t.options)),this},X.mergeOptions=function(t){return r(this.prototype.options,t),this},X.addInitHook=function(t){var o=Array.prototype.slice.call(arguments,1),l=typeof t=="function"?t:function(){this[t].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(l),this};function ct(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=O(t)?t:[t];for(var o=0;o<t.length;o++)t[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var dt={on:function(t,o,l){if(typeof t=="object")for(var h in t)this._on(h,t[h],o);else{t=P(t);for(var _=0,v=t.length;_<v;_++)this._on(t[_],o,l)}return this},off:function(t,o,l){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var h in t)this._off(h,t[h],o);else{t=P(t);for(var _=arguments.length===1,v=0,C=t.length;v<C;v++)_?this._off(t[v]):this._off(t[v],o,l)}return this},_on:function(t,o,l,h){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(t,o,l)===!1){l===this&&(l=void 0);var _={fn:o,ctx:l};h&&(_.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(_)}},_off:function(t,o,l){var h,_,v;if(this._events&&(h=this._events[t],!!h)){if(arguments.length===1){if(this._firingCount)for(_=0,v=h.length;_<v;_++)h[_].fn=g;delete this._events[t];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var C=this._listens(t,o,l);if(C!==!1){var I=h[C];this._firingCount&&(I.fn=g,this._events[t]=h=h.slice()),h.splice(C,1)}}},fire:function(t,o,l){if(!this.listens(t,l))return this;var h=r({},o,{type:t,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var _=this._events[t];if(_){this._firingCount=this._firingCount+1||1;for(var v=0,C=_.length;v<C;v++){var I=_[v],D=I.fn;I.once&&this.off(t,D,I.ctx),D.call(I.ctx||this,h)}this._firingCount--}}return l&&this._propagateEvent(h),this},listens:function(t,o,l,h){typeof t!="string"&&console.warn('"string" type argument expected');var _=o;typeof o!="function"&&(h=!!o,_=void 0,l=void 0);var v=this._events&&this._events[t];if(v&&v.length&&this._listens(t,_,l)!==!1)return!0;if(h){for(var C in this._eventParents)if(this._eventParents[C].listens(t,o,l,h))return!0}return!1},_listens:function(t,o,l){if(!this._events)return!1;var h=this._events[t]||[];if(!o)return!!h.length;l===this&&(l=void 0);for(var _=0,v=h.length;_<v;_++)if(h[_].fn===o&&h[_].ctx===l)return _;return!1},once:function(t,o,l){if(typeof t=="object")for(var h in t)this._on(h,t[h],o,!0);else{t=P(t);for(var _=0,v=t.length;_<v;_++)this._on(t[_],o,l,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[f(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[f(t)],this},_propagateEvent:function(t){for(var o in this._eventParents)this._eventParents[o].fire(t.type,r({layer:t.target,propagatedFrom:t.target},t),!0)}};dt.addEventListener=dt.on,dt.removeEventListener=dt.clearAllEventListeners=dt.off,dt.addOneTimeEventListener=dt.once,dt.fireEvent=dt.fire,dt.hasEventListeners=dt.listens;var Q=X.extend(dt);function W(t,o,l){this.x=l?Math.round(t):t,this.y=l?Math.round(o):o}var At=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};W.prototype={clone:function(){return new W(this.x,this.y)},add:function(t){return this.clone()._add(st(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(st(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new W(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new W(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=At(this.x),this.y=At(this.y),this},distanceTo:function(t){t=st(t);var o=t.x-this.x,l=t.y-this.y;return Math.sqrt(o*o+l*l)},equals:function(t){return t=st(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=st(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+k(this.x)+", "+k(this.y)+")"}};function st(t,o,l){return t instanceof W?t:O(t)?new W(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new W(t.x,t.y):new W(t,o,l)}function yt(t,o){if(t)for(var l=o?[t,o]:t,h=0,_=l.length;h<_;h++)this.extend(l[h])}yt.prototype={extend:function(t){var o,l;if(!t)return this;if(t instanceof W||typeof t[0]=="number"||"x"in t)o=l=st(t);else if(t=Lt(t),o=t.min,l=t.max,!o||!l)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=l.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(l.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(l.y,this.max.y)),this},getCenter:function(t){return st((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return st(this.min.x,this.max.y)},getTopRight:function(){return st(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var o,l;return typeof t[0]=="number"||t instanceof W?t=st(t):t=Lt(t),t instanceof yt?(o=t.min,l=t.max):o=l=t,o.x>=this.min.x&&l.x<=this.max.x&&o.y>=this.min.y&&l.y<=this.max.y},intersects:function(t){t=Lt(t);var o=this.min,l=this.max,h=t.min,_=t.max,v=_.x>=o.x&&h.x<=l.x,C=_.y>=o.y&&h.y<=l.y;return v&&C},overlaps:function(t){t=Lt(t);var o=this.min,l=this.max,h=t.min,_=t.max,v=_.x>o.x&&h.x<l.x,C=_.y>o.y&&h.y<l.y;return v&&C},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var o=this.min,l=this.max,h=Math.abs(o.x-l.x)*t,_=Math.abs(o.y-l.y)*t;return Lt(st(o.x-h,o.y-_),st(l.x+h,l.y+_))},equals:function(t){return t?(t=Lt(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function Lt(t,o){return!t||t instanceof yt?t:new yt(t,o)}function _t(t,o){if(t)for(var l=o?[t,o]:t,h=0,_=l.length;h<_;h++)this.extend(l[h])}_t.prototype={extend:function(t){var o=this._southWest,l=this._northEast,h,_;if(t instanceof U)h=t,_=t;else if(t instanceof _t){if(h=t._southWest,_=t._northEast,!h||!_)return this}else return t?this.extend(H(t)||R(t)):this;return!o&&!l?(this._southWest=new U(h.lat,h.lng),this._northEast=new U(_.lat,_.lng)):(o.lat=Math.min(h.lat,o.lat),o.lng=Math.min(h.lng,o.lng),l.lat=Math.max(_.lat,l.lat),l.lng=Math.max(_.lng,l.lng)),this},pad:function(t){var o=this._southWest,l=this._northEast,h=Math.abs(o.lat-l.lat)*t,_=Math.abs(o.lng-l.lng)*t;return new _t(new U(o.lat-h,o.lng-_),new U(l.lat+h,l.lng+_))},getCenter:function(){return new U((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new U(this.getNorth(),this.getWest())},getSouthEast:function(){return new U(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof U||"lat"in t?t=H(t):t=R(t);var o=this._southWest,l=this._northEast,h,_;return t instanceof _t?(h=t.getSouthWest(),_=t.getNorthEast()):h=_=t,h.lat>=o.lat&&_.lat<=l.lat&&h.lng>=o.lng&&_.lng<=l.lng},intersects:function(t){t=R(t);var o=this._southWest,l=this._northEast,h=t.getSouthWest(),_=t.getNorthEast(),v=_.lat>=o.lat&&h.lat<=l.lat,C=_.lng>=o.lng&&h.lng<=l.lng;return v&&C},overlaps:function(t){t=R(t);var o=this._southWest,l=this._northEast,h=t.getSouthWest(),_=t.getNorthEast(),v=_.lat>o.lat&&h.lat<l.lat,C=_.lng>o.lng&&h.lng<l.lng;return v&&C},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,o){return t?(t=R(t),this._southWest.equals(t.getSouthWest(),o)&&this._northEast.equals(t.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function R(t,o){return t instanceof _t?t:new _t(t,o)}function U(t,o,l){if(isNaN(t)||isNaN(o))throw new Error("Invalid LatLng object: ("+t+", "+o+")");this.lat=+t,this.lng=+o,l!==void 0&&(this.alt=+l)}U.prototype={equals:function(t,o){if(!t)return!1;t=H(t);var l=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return l<=(o===void 0?1e-9:o)},toString:function(t){return"LatLng("+k(this.lat,t)+", "+k(this.lng,t)+")"},distanceTo:function(t){return Nt.distance(this,H(t))},wrap:function(){return Nt.wrapLatLng(this)},toBounds:function(t){var o=180*t/40075017,l=o/Math.cos(Math.PI/180*this.lat);return R([this.lat-o,this.lng-l],[this.lat+o,this.lng+l])},clone:function(){return new U(this.lat,this.lng,this.alt)}};function H(t,o,l){return t instanceof U?t:O(t)&&typeof t[0]!="object"?t.length===3?new U(t[0],t[1],t[2]):t.length===2?new U(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new U(t.lat,"lng"in t?t.lng:t.lon,t.alt):o===void 0?null:new U(t,o,l)}var K={latLngToPoint:function(t,o){var l=this.projection.project(t),h=this.scale(o);return this.transformation._transform(l,h)},pointToLatLng:function(t,o){var l=this.scale(o),h=this.transformation.untransform(t,l);return this.projection.unproject(h)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var o=this.projection.bounds,l=this.scale(t),h=this.transformation.transform(o.min,l),_=this.transformation.transform(o.max,l);return new yt(h,_)},infinite:!1,wrapLatLng:function(t){var o=this.wrapLng?p(t.lng,this.wrapLng,!0):t.lng,l=this.wrapLat?p(t.lat,this.wrapLat,!0):t.lat,h=t.alt;return new U(l,o,h)},wrapLatLngBounds:function(t){var o=t.getCenter(),l=this.wrapLatLng(o),h=o.lat-l.lat,_=o.lng-l.lng;if(h===0&&_===0)return t;var v=t.getSouthWest(),C=t.getNorthEast(),I=new U(v.lat-h,v.lng-_),D=new U(C.lat-h,C.lng-_);return new _t(I,D)}},Nt=r({},K,{wrapLng:[-180,180],R:6371e3,distance:function(t,o){var l=Math.PI/180,h=t.lat*l,_=o.lat*l,v=Math.sin((o.lat-t.lat)*l/2),C=Math.sin((o.lng-t.lng)*l/2),I=v*v+Math.cos(h)*Math.cos(_)*C*C,D=2*Math.atan2(Math.sqrt(I),Math.sqrt(1-I));return this.R*D}}),Wt=6378137,rt={R:Wt,MAX_LATITUDE:85.0511287798,project:function(t){var o=Math.PI/180,l=this.MAX_LATITUDE,h=Math.max(Math.min(l,t.lat),-l),_=Math.sin(h*o);return new W(this.R*t.lng*o,this.R*Math.log((1+_)/(1-_))/2)},unproject:function(t){var o=180/Math.PI;return new U((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*o,t.x*o/this.R)},bounds:function(){var t=Wt*Math.PI;return new yt([-t,-t],[t,t])}()};function Ct(t,o,l,h){if(O(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=o,this._c=l,this._d=h}Ct.prototype={transform:function(t,o){return this._transform(t.clone(),o)},_transform:function(t,o){return o=o||1,t.x=o*(this._a*t.x+this._b),t.y=o*(this._c*t.y+this._d),t},untransform:function(t,o){return o=o||1,new W((t.x/o-this._b)/this._a,(t.y/o-this._d)/this._c)}};function Mt(t,o,l,h){return new Ct(t,o,l,h)}var xt=r({},Nt,{code:"EPSG:3857",projection:rt,transformation:function(){var t=.5/(Math.PI*rt.R);return Mt(t,.5,-t,.5)}()}),qt=r({},xt,{code:"EPSG:900913"});function we(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function fe(t,o){var l="",h,_,v,C,I,D;for(h=0,v=t.length;h<v;h++){for(I=t[h],_=0,C=I.length;_<C;_++)D=I[_],l+=(_?"L":"M")+D.x+" "+D.y;l+=o?bt.svg?"z":"x":""}return l||"M0 0"}var $=document.documentElement.style,Ot="ActiveXObject"in window,zt=Ot&&!document.addEventListener,Tt="msLaunchUri"in navigator&&!("documentMode"in document),Ft=Be("webkit"),Ut=Be("android"),xe=Be("android 2")||Be("android 3"),Ke=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),De=Ut&&Be("Google")&&Ke<537&&!("AudioNode"in window),Yt=!!window.opera,Re=!Tt&&Be("chrome"),ie=Be("gecko")&&!Ft&&!Yt&&!Ot,tn=!Re&&Be("safari"),be=Be("phantom"),pe="OTransition"in $,Ee=navigator.platform.indexOf("Win")===0,je=Ot&&"transition"in $,We="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!xe,en="MozPerspective"in $,ke=!window.L_DISABLE_3D&&(je||We||en)&&!pe&&!be,He=typeof orientation<"u"||Be("mobile"),jt=He&&Ft,Ge=He&&We,Ye=!window.PointerEvent&&window.MSPointerEvent,bn=!!(window.PointerEvent||Ye),nn="ontouchstart"in window||!!window.TouchEvent,on=!window.L_NO_TOUCH&&(nn||bn),Oe=He&&Yt,Fe=He&&ie,gn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,ue=function(){var t=!1;try{var o=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",g,o),window.removeEventListener("testPassiveEventSupport",g,o)}catch{}return t}(),de=function(){return!!document.createElement("canvas").getContext}(),qe=!!(document.createElementNS&&we("svg").createSVGRect),kn=!!qe&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),vn=!qe&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var o=t.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}}(),Nn=navigator.platform.indexOf("Mac")===0,Mn=navigator.platform.indexOf("Linux")===0;function Be(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var bt={ie:Ot,ielt9:zt,edge:Tt,webkit:Ft,android:Ut,android23:xe,androidStock:De,opera:Yt,chrome:Re,gecko:ie,safari:tn,phantom:be,opera12:pe,win:Ee,ie3d:je,webkit3d:We,gecko3d:en,any3d:ke,mobile:He,mobileWebkit:jt,mobileWebkit3d:Ge,msPointer:Ye,pointer:bn,touch:on,touchNative:nn,mobileOpera:Oe,mobileGecko:Fe,retina:gn,passiveEvents:ue,canvas:de,svg:qe,vml:vn,inlineSvg:kn,mac:Nn,linux:Mn},yn=bt.msPointer?"MSPointerDown":"pointerdown",wn=bt.msPointer?"MSPointerMove":"pointermove",cn=bt.msPointer?"MSPointerUp":"pointerup",Pn=bt.msPointer?"MSPointerCancel":"pointercancel",w={touchstart:yn,touchmove:wn,touchend:cn,touchcancel:Pn},mt={touchstart:Ue,touchmove:sn,touchend:sn,touchcancel:sn},Pt={},kt=!1;function Et(t,o,l){return o==="touchstart"&&Pe(),mt[o]?(l=mt[o].bind(this,l),t.addEventListener(w[o],l,!1),l):(console.warn("wrong event specified:",o),g)}function x(t,o,l){if(!w[o]){console.warn("wrong event specified:",o);return}t.removeEventListener(w[o],l,!1)}function Kt(t){Pt[t.pointerId]=t}function _e(t){Pt[t.pointerId]&&(Pt[t.pointerId]=t)}function Jt(t){delete Pt[t.pointerId]}function Pe(){kt||(document.addEventListener(yn,Kt,!0),document.addEventListener(wn,_e,!0),document.addEventListener(cn,Jt,!0),document.addEventListener(Pn,Jt,!0),kt=!0)}function sn(t,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var l in Pt)o.touches.push(Pt[l]);o.changedTouches=[o],t(o)}}function Ue(t,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&zn(o),sn(t,o)}function Ln(t){var o={},l,h;for(h in t)l=t[h],o[h]=l&&l.bind?l.bind(t):l;return t=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var Cn=200;function Yn(t,o){t.addEventListener("dblclick",o);var l=0,h;function _(v){if(v.detail!==1){h=v.detail;return}if(!(v.pointerType==="mouse"||v.sourceCapabilities&&!v.sourceCapabilities.firesTouchEvents)){var C=as(v);if(!(C.some(function(D){return D instanceof HTMLLabelElement&&D.attributes.for})&&!C.some(function(D){return D instanceof HTMLInputElement||D instanceof HTMLSelectElement}))){var I=Date.now();I-l<=Cn?(h++,h===2&&o(Ln(v))):h=1,l=I}}}return t.addEventListener("click",_),{dblclick:o,simDblclick:_}}function Dn(t,o){t.removeEventListener("dblclick",o.dblclick),t.removeEventListener("click",o.simDblclick)}var Tn=Zt(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ve=Zt(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Rn=Ve==="webkitTransition"||Ve==="OTransition"?Ve+"End":"transitionend";function $n(t){return typeof t=="string"?document.getElementById(t):t}function gt(t,o){var l=t.style[o]||t.currentStyle&&t.currentStyle[o];if((!l||l==="auto")&&document.defaultView){var h=document.defaultView.getComputedStyle(t,null);l=h?h[o]:null}return l==="auto"?null:l}function Ht(t,o,l){var h=document.createElement(t);return h.className=o||"",l&&l.appendChild(h),h}function te(t){var o=t.parentNode;o&&o.removeChild(t)}function Ne(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function En(t){var o=t.parentNode;o&&o.lastChild!==t&&o.appendChild(t)}function Je(t){var o=t.parentNode;o&&o.firstChild!==t&&o.insertBefore(t,o.firstChild)}function oe(t,o){if(t.classList!==void 0)return t.classList.contains(o);var l=Fn(t);return l.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(l)}function It(t,o){if(t.classList!==void 0)for(var l=P(o),h=0,_=l.length;h<_;h++)t.classList.add(l[h]);else if(!oe(t,o)){var v=Fn(t);rn(t,(v?v+" ":"")+o)}}function ne(t,o){t.classList!==void 0?t.classList.remove(o):rn(t,b((" "+Fn(t)+" ").replace(" "+o+" "," ")))}function rn(t,o){t.className.baseVal===void 0?t.className=o:t.className.baseVal=o}function Fn(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function ln(t,o){"opacity"in t.style?t.style.opacity=o:"filter"in t.style&&An(t,o)}function An(t,o){var l=!1,h="DXImageTransform.Microsoft.Alpha";try{l=t.filters.item(h)}catch{if(o===1)return}o=Math.round(o*100),l?(l.Enabled=o!==100,l.Opacity=o):t.style.filter+=" progid:"+h+"(opacity="+o+")"}function Zt(t){for(var o=document.documentElement.style,l=0;l<t.length;l++)if(t[l]in o)return t[l];return!1}function se(t,o,l){var h=o||new W(0,0);t.style[Tn]=(bt.ie3d?"translate("+h.x+"px,"+h.y+"px)":"translate3d("+h.x+"px,"+h.y+"px,0)")+(l?" scale("+l+")":"")}function Ze(t,o){t._leaflet_pos=o,bt.any3d?se(t,o):(t.style.left=o.x+"px",t.style.top=o.y+"px")}function qn(t){return t._leaflet_pos||new W(0,0)}var oi,si,fi;if("onselectstart"in document)oi=function(){Dt(window,"selectstart",zn)},si=function(){Rt(window,"selectstart",zn)};else{var Kn=Zt(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);oi=function(){if(Kn){var t=document.documentElement.style;fi=t[Kn],t[Kn]="none"}},si=function(){Kn&&(document.documentElement.style[Kn]=fi,fi=void 0)}}function Di(){Dt(window,"dragstart",zn)}function Ri(){Rt(window,"dragstart",zn)}var Si,T;function ft(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(vt(),Si=t,T=t.style.outlineStyle,t.style.outlineStyle="none",Dt(window,"keydown",vt))}function vt(){Si&&(Si.style.outlineStyle=T,Si=void 0,T=void 0,Rt(window,"keydown",vt))}function Qt(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function Xt(t){var o=t.getBoundingClientRect();return{x:o.width/t.offsetWidth||1,y:o.height/t.offsetHeight||1,boundingClientRect:o}}var dn={__proto__:null,TRANSFORM:Tn,TRANSITION:Ve,TRANSITION_END:Rn,get:$n,getStyle:gt,create:Ht,remove:te,empty:Ne,toFront:En,toBack:Je,hasClass:oe,addClass:It,removeClass:ne,setClass:rn,getClass:Fn,setOpacity:ln,testProp:Zt,setTransform:se,setPosition:Ze,getPosition:qn,get disableTextSelection(){return oi},get enableTextSelection(){return si},disableImageDrag:Di,enableImageDrag:Ri,preventOutline:ft,restoreOutline:vt,getSizedParentNode:Qt,getScale:Xt};function Dt(t,o,l,h){if(o&&typeof o=="object")for(var _ in o)ji(t,_,o[_],l);else{o=P(o);for(var v=0,C=o.length;v<C;v++)ji(t,o[v],l,h)}return this}var hn="_leaflet_events";function Rt(t,o,l,h){if(arguments.length===1)In(t),delete t[hn];else if(o&&typeof o=="object")for(var _ in o)Wi(t,_,o[_],l);else if(o=P(o),arguments.length===2)In(t,function(I){return Z(o,I)!==-1});else for(var v=0,C=o.length;v<C;v++)Wi(t,o[v],l,h);return this}function In(t,o){for(var l in t[hn]){var h=l.split(/\d/)[0];(!o||o(h))&&Wi(t,h,null,null,l)}}var yi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function ji(t,o,l,h){var _=o+f(l)+(h?"_"+f(h):"");if(t[hn]&&t[hn][_])return this;var v=function(I){return l.call(h||t,I||window.event)},C=v;!bt.touchNative&&bt.pointer&&o.indexOf("touch")===0?v=Et(t,o,v):bt.touch&&o==="dblclick"?v=Yn(t,v):"addEventListener"in t?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?t.addEventListener(yi[o]||o,v,bt.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(v=function(I){I=I||window.event,zo(t,I)&&C(I)},t.addEventListener(yi[o],v,!1)):t.addEventListener(o,C,!1):t.attachEvent("on"+o,v),t[hn]=t[hn]||{},t[hn][_]=v}function Wi(t,o,l,h,_){_=_||o+f(l)+(h?"_"+f(h):"");var v=t[hn]&&t[hn][_];if(!v)return this;!bt.touchNative&&bt.pointer&&o.indexOf("touch")===0?x(t,o,v):bt.touch&&o==="dblclick"?Dn(t,v):"removeEventListener"in t?t.removeEventListener(yi[o]||o,v,!1):t.detachEvent("on"+o,v),t[hn][_]=null}function Gn(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function Ao(t){return ji(t,"wheel",Gn),this}function Hi(t){return Dt(t,"mousedown touchstart dblclick contextmenu",Gn),t._leaflet_disable_click=!0,this}function zn(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function wi(t){return zn(t),Gn(t),this}function as(t){if(t.composedPath)return t.composedPath();for(var o=[],l=t.target;l;)o.push(l),l=l.parentNode;return o}function us(t,o){if(!o)return new W(t.clientX,t.clientY);var l=Xt(o),h=l.boundingClientRect;return new W((t.clientX-h.left)/l.x-o.clientLeft,(t.clientY-h.top)/l.y-o.clientTop)}var ga=bt.linux&&bt.chrome?window.devicePixelRatio:bt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function cs(t){return bt.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/ga:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function zo(t,o){var l=o.relatedTarget;if(!l)return!0;try{for(;l&&l!==t;)l=l.parentNode}catch{return!1}return l!==t}var va={__proto__:null,on:Dt,off:Rt,stopPropagation:Gn,disableScrollPropagation:Ao,disableClickPropagation:Hi,preventDefault:zn,stop:wi,getPropagationPath:as,getMousePosition:us,getWheelDelta:cs,isExternalTarget:zo,addListener:Dt,removeListener:Rt},hs=Q.extend({run:function(t,o,l,h){this.stop(),this._el=t,this._inProgress=!0,this._duration=l||.25,this._easeOutPower=1/Math.max(h||.5,.2),this._startPos=qn(t),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=lt(this._animate,this),this._step()},_step:function(t){var o=+new Date-this._startTime,l=this._duration*1e3;o<l?this._runFrame(this._easeOut(o/l),t):(this._runFrame(1),this._complete())},_runFrame:function(t,o){var l=this._startPos.add(this._offset.multiplyBy(t));o&&l._round(),Ze(this._el,l),this.fire("step")},_complete:function(){N(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),ge=Q.extend({options:{crs:xt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,o){o=S(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=u(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView(H(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ve&&bt.any3d&&!bt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Dt(this._proxy,Rn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,o,l){if(o=o===void 0?this._zoom:this._limitZoom(o),t=this._limitCenter(H(t),o,this.options.maxBounds),l=l||{},this._stop(),this._loaded&&!l.reset&&l!==!0){l.animate!==void 0&&(l.zoom=r({animate:l.animate},l.zoom),l.pan=r({animate:l.animate,duration:l.duration},l.pan));var h=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,o,l.zoom):this._tryAnimatedPan(t,l.pan);if(h)return clearTimeout(this._sizeTimer),this}return this._resetView(t,o,l.pan&&l.pan.noMoveStart),this},setZoom:function(t,o){return this._loaded?this.setView(this.getCenter(),t,{zoom:o}):(this._zoom=t,this)},zoomIn:function(t,o){return t=t||(bt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,o)},zoomOut:function(t,o){return t=t||(bt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,o)},setZoomAround:function(t,o,l){var h=this.getZoomScale(o),_=this.getSize().divideBy(2),v=t instanceof W?t:this.latLngToContainerPoint(t),C=v.subtract(_).multiplyBy(1-1/h),I=this.containerPointToLatLng(_.add(C));return this.setView(I,o,{zoom:l})},_getBoundsCenterZoom:function(t,o){o=o||{},t=t.getBounds?t.getBounds():R(t);var l=st(o.paddingTopLeft||o.padding||[0,0]),h=st(o.paddingBottomRight||o.padding||[0,0]),_=this.getBoundsZoom(t,!1,l.add(h));if(_=typeof o.maxZoom=="number"?Math.min(o.maxZoom,_):_,_===1/0)return{center:t.getCenter(),zoom:_};var v=h.subtract(l).divideBy(2),C=this.project(t.getSouthWest(),_),I=this.project(t.getNorthEast(),_),D=this.unproject(C.add(I).divideBy(2).add(v),_);return{center:D,zoom:_}},fitBounds:function(t,o){if(t=R(t),!t.isValid())throw new Error("Bounds are not valid.");var l=this._getBoundsCenterZoom(t,o);return this.setView(l.center,l.zoom,o)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,o){return this.setView(t,this._zoom,{pan:o})},panBy:function(t,o){if(t=st(t).round(),o=o||{},!t.x&&!t.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new hs,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){It(this._mapPane,"leaflet-pan-anim");var l=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,l,o.duration||.25,o.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,o,l){if(l=l||{},l.animate===!1||!bt.any3d)return this.setView(t,o,l);this._stop();var h=this.project(this.getCenter()),_=this.project(t),v=this.getSize(),C=this._zoom;t=H(t),o=o===void 0?C:o;var I=Math.max(v.x,v.y),D=I*this.getZoomScale(C,o),ut=_.distanceTo(h)||1,St=1.42,Vt=St*St;function ce(_n){var go=_n?-1:1,ru=_n?D:I,lu=D*D-I*I+go*Vt*Vt*ut*ut,au=2*ru*Vt*ut,Ho=lu/au,Us=Math.sqrt(Ho*Ho+1)-Ho,uu=Us<1e-9?-18:Math.log(Us);return uu}function xn(_n){return(Math.exp(_n)-Math.exp(-_n))/2}function Sn(_n){return(Math.exp(_n)+Math.exp(-_n))/2}function Vn(_n){return xn(_n)/Sn(_n)}var Bn=ce(0);function Ni(_n){return I*(Sn(Bn)/Sn(Bn+St*_n))}function nu(_n){return I*(Sn(Bn)*Vn(Bn+St*_n)-xn(Bn))/Vt}function iu(_n){return 1-Math.pow(1-_n,1.5)}var ou=Date.now(),Fs=(ce(1)-Bn)/St,su=l.duration?1e3*l.duration:1e3*Fs*.8;function Gs(){var _n=(Date.now()-ou)/su,go=iu(_n)*Fs;_n<=1?(this._flyToFrame=lt(Gs,this),this._move(this.unproject(h.add(_.subtract(h).multiplyBy(nu(go)/ut)),C),this.getScaleZoom(I/Ni(go),C),{flyTo:!0})):this._move(t,o)._moveEnd(!0)}return this._moveStart(!0,l.noMoveStart),Gs.call(this),this},flyToBounds:function(t,o){var l=this._getBoundsCenterZoom(t,o);return this.flyTo(l.center,l.zoom,o)},setMaxBounds:function(t){return t=R(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var o=this.options.minZoom;return this.options.minZoom=t,this._loaded&&o!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var o=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&o!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,o){this._enforcingBounds=!0;var l=this.getCenter(),h=this._limitCenter(l,this._zoom,R(t));return l.equals(h)||this.panTo(h,o),this._enforcingBounds=!1,this},panInside:function(t,o){o=o||{};var l=st(o.paddingTopLeft||o.padding||[0,0]),h=st(o.paddingBottomRight||o.padding||[0,0]),_=this.project(this.getCenter()),v=this.project(t),C=this.getPixelBounds(),I=Lt([C.min.add(l),C.max.subtract(h)]),D=I.getSize();if(!I.contains(v)){this._enforcingBounds=!0;var ut=v.subtract(I.getCenter()),St=I.extend(v).getSize().subtract(D);_.x+=ut.x<0?-St.x:St.x,_.y+=ut.y<0?-St.y:St.y,this.panTo(this.unproject(_),o),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=r({animate:!1,pan:!0},t===!0?{animate:!0}:t);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var l=this.getSize(),h=o.divideBy(2).round(),_=l.divideBy(2).round(),v=h.subtract(_);return!v.x&&!v.y?this:(t.animate&&t.pan?this.panBy(v):(t.pan&&this._rawPanBy(v),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(u(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:l}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=r({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=u(this._handleGeolocationResponse,this),l=u(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,l,t):navigator.geolocation.getCurrentPosition(o,l,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var o=t.code,l=t.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+l+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var o=t.coords.latitude,l=t.coords.longitude,h=new U(o,l),_=h.toBounds(t.coords.accuracy*2),v=this._locateOptions;if(v.setView){var C=this.getBoundsZoom(_);this.setView(h,v.maxZoom?Math.min(C,v.maxZoom):C)}var I={latlng:h,bounds:_,timestamp:t.timestamp};for(var D in t.coords)typeof t.coords[D]=="number"&&(I[D]=t.coords[D]);this.fire("locationfound",I)}},addHandler:function(t,o){if(!o)return this;var l=this[t]=new o(this);return this._handlers.push(l),this.options[t]&&l.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),te(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(N(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)te(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,o){var l="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),h=Ht("div",l,o||this._mapPane);return t&&(this._panes[t]=h),h},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),o=this.unproject(t.getBottomLeft()),l=this.unproject(t.getTopRight());return new _t(o,l)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,o,l){t=R(t),l=st(l||[0,0]);var h=this.getZoom()||0,_=this.getMinZoom(),v=this.getMaxZoom(),C=t.getNorthWest(),I=t.getSouthEast(),D=this.getSize().subtract(l),ut=Lt(this.project(I,h),this.project(C,h)).getSize(),St=bt.any3d?this.options.zoomSnap:1,Vt=D.x/ut.x,ce=D.y/ut.y,xn=o?Math.max(Vt,ce):Math.min(Vt,ce);return h=this.getScaleZoom(xn,h),St&&(h=Math.round(h/(St/100))*(St/100),h=o?Math.ceil(h/St)*St:Math.floor(h/St)*St),Math.max(_,Math.min(v,h))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new W(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,o){var l=this._getTopLeftPoint(t,o);return new yt(l,l.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,o){var l=this.options.crs;return o=o===void 0?this._zoom:o,l.scale(t)/l.scale(o)},getScaleZoom:function(t,o){var l=this.options.crs;o=o===void 0?this._zoom:o;var h=l.zoom(t*l.scale(o));return isNaN(h)?1/0:h},project:function(t,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint(H(t),o)},unproject:function(t,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(st(t),o)},layerPointToLatLng:function(t){var o=st(t).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(t){var o=this.project(H(t))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(H(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(R(t))},distance:function(t,o){return this.options.crs.distance(H(t),H(o))},containerPointToLayerPoint:function(t){return st(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return st(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var o=this.containerPointToLayerPoint(st(t));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(H(t)))},mouseEventToContainerPoint:function(t){return us(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var o=this._container=$n(t);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Dt(o,"scroll",this._onScroll,this),this._containerId=f(o)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&bt.any3d,It(t,"leaflet-container"+(bt.touch?" leaflet-touch":"")+(bt.retina?" leaflet-retina":"")+(bt.ielt9?" leaflet-oldie":"")+(bt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=gt(t,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ze(this._mapPane,new W(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(It(t.markerPane,"leaflet-zoom-hide"),It(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,o,l){Ze(this._mapPane,new W(0,0));var h=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var _=this._zoom!==o;this._moveStart(_,l)._move(t,o)._moveEnd(_),this.fire("viewreset"),h&&this.fire("load")},_moveStart:function(t,o){return t&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(t,o,l,h){o===void 0&&(o=this._zoom);var _=this._zoom!==o;return this._zoom=o,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),h?l&&l.pinch&&this.fire("zoom",l):((_||l&&l.pinch)&&this.fire("zoom",l),this.fire("move",l)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return N(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){Ze(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[f(this._container)]=this;var o=t?Rt:Dt;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),bt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){N(this._resizeRequest),this._resizeRequest=lt(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,o){for(var l=[],h,_=o==="mouseout"||o==="mouseover",v=t.target||t.srcElement,C=!1;v;){if(h=this._targets[f(v)],h&&(o==="click"||o==="preclick")&&this._draggableMoved(h)){C=!0;break}if(h&&h.listens(o,!0)&&(_&&!zo(v,t)||(l.push(h),_))||v===this._container)break;v=v.parentNode}return!l.length&&!C&&!_&&this.listens(o,!0)&&(l=[this]),l},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var o=t.target||t.srcElement;if(!(!this._loaded||o._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(o))){var l=t.type;l==="mousedown"&&ft(o),this._fireDOMEvent(t,l)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,o,l){if(t.type==="click"){var h=r({},t);h.type="preclick",this._fireDOMEvent(h,h.type,l)}var _=this._findEventTargets(t,o);if(l){for(var v=[],C=0;C<l.length;C++)l[C].listens(o,!0)&&v.push(l[C]);_=v.concat(_)}if(_.length){o==="contextmenu"&&zn(t);var I=_[0],D={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var ut=I.getLatLng&&(!I._radius||I._radius<=10);D.containerPoint=ut?this.latLngToContainerPoint(I.getLatLng()):this.mouseEventToContainerPoint(t),D.layerPoint=this.containerPointToLayerPoint(D.containerPoint),D.latlng=ut?I.getLatLng():this.layerPointToLatLng(D.layerPoint)}for(C=0;C<_.length;C++)if(_[C].fire(o,D,!0),D.originalEvent._stopped||_[C].options.bubblingMouseEvents===!1&&Z(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,o=this._handlers.length;t<o;t++)this._handlers[t].disable()},whenReady:function(t,o){return this._loaded?t.call(o||this,{target:this}):this.on("load",t,o),this},_getMapPanePos:function(){return qn(this._mapPane)||new W(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,o){var l=t&&o!==void 0?this._getNewPixelOrigin(t,o):this.getPixelOrigin();return l.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,o){var l=this.getSize()._divideBy(2);return this.project(t,o)._subtract(l)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,o,l){var h=this._getNewPixelOrigin(l,o);return this.project(t,o)._subtract(h)},_latLngBoundsToNewLayerBounds:function(t,o,l){var h=this._getNewPixelOrigin(l,o);return Lt([this.project(t.getSouthWest(),o)._subtract(h),this.project(t.getNorthWest(),o)._subtract(h),this.project(t.getSouthEast(),o)._subtract(h),this.project(t.getNorthEast(),o)._subtract(h)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,o,l){if(!l)return t;var h=this.project(t,o),_=this.getSize().divideBy(2),v=new yt(h.subtract(_),h.add(_)),C=this._getBoundsOffset(v,l,o);return Math.abs(C.x)<=1&&Math.abs(C.y)<=1?t:this.unproject(h.add(C),o)},_limitOffset:function(t,o){if(!o)return t;var l=this.getPixelBounds(),h=new yt(l.min.add(t),l.max.add(t));return t.add(this._getBoundsOffset(h,o))},_getBoundsOffset:function(t,o,l){var h=Lt(this.project(o.getNorthEast(),l),this.project(o.getSouthWest(),l)),_=h.min.subtract(t.min),v=h.max.subtract(t.max),C=this._rebound(_.x,-v.x),I=this._rebound(_.y,-v.y);return new W(C,I)},_rebound:function(t,o){return t+o>0?Math.round(t-o)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(o))},_limitZoom:function(t){var o=this.getMinZoom(),l=this.getMaxZoom(),h=bt.any3d?this.options.zoomSnap:1;return h&&(t=Math.round(t/h)*h),Math.max(o,Math.min(l,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ne(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,o){var l=this._getCenterOffset(t)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(l)?!1:(this.panBy(l,o),!0)},_createAnimProxy:function(){var t=this._proxy=Ht("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(o){var l=Tn,h=this._proxy.style[l];se(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),h===this._proxy.style[l]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){te(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),o=this.getZoom();se(this._proxy,this.project(t,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,o,l){if(this._animatingZoom)return!0;if(l=l||{},!this._zoomAnimated||l.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var h=this.getZoomScale(o),_=this._getCenterOffset(t)._divideBy(1-1/h);return l.animate!==!0&&!this.getSize().contains(_)?!1:(lt(function(){this._moveStart(!0,l.noMoveStart||!1)._animateZoom(t,o,!0)},this),!0)},_animateZoom:function(t,o,l,h){this._mapPane&&(l&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=o,It(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:o,noUpdate:h}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(u(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ne(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ya(t,o){return new ge(t,o)}var Jn=X.extend({options:{position:"topright"},initialize:function(t){S(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var o=this._map;return o&&o.removeControl(this),this.options.position=t,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var o=this._container=this.onAdd(t),l=this.getPosition(),h=t._controlCorners[l];return It(o,"leaflet-control"),l.indexOf("bottom")!==-1?h.insertBefore(o,h.firstChild):h.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(te(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Fi=function(t){return new Jn(t)};ge.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},o="leaflet-",l=this._controlContainer=Ht("div",o+"control-container",this._container);function h(_,v){var C=o+_+" "+o+v;t[_+v]=Ht("div",C,l)}h("top","left"),h("top","right"),h("bottom","left"),h("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)te(this._controlCorners[t]);te(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var fs=Jn.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,o,l,h){return l<h?-1:h<l?1:0}},initialize:function(t,o,l){S(this,l),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var h in t)this._addLayer(t[h],h);for(h in o)this._addLayer(o[h],h,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Jn.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,o){return this._addLayer(t,o),this._map?this._update():this},addOverlay:function(t,o){return this._addLayer(t,o,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var o=this._getLayer(f(t));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){It(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(It(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):ne(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ne(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",o=this._container=Ht("div",t),l=this.options.collapsed;o.setAttribute("aria-haspopup",!0),Hi(o),Ao(o);var h=this._section=Ht("section",t+"-list");l&&(this._map.on("click",this.collapse,this),Dt(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var _=this._layersLink=Ht("a",t+"-toggle",o);_.href="#",_.title="Layers",_.setAttribute("role","button"),Dt(_,{keydown:function(v){v.keyCode===13&&this._expandSafely()},click:function(v){zn(v),this._expandSafely()}},this),l||this.expand(),this._baseLayersList=Ht("div",t+"-base",h),this._separator=Ht("div",t+"-separator",h),this._overlaysList=Ht("div",t+"-overlays",h),o.appendChild(h)},_getLayer:function(t){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&f(this._layers[o].layer)===t)return this._layers[o]},_addLayer:function(t,o,l){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:o,overlay:l}),this.options.sortLayers&&this._layers.sort(u(function(h,_){return this.options.sortFunction(h.layer,_.layer,h.name,_.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ne(this._baseLayersList),Ne(this._overlaysList),this._layerControlInputs=[];var t,o,l,h,_=0;for(l=0;l<this._layers.length;l++)h=this._layers[l],this._addItem(h),o=o||h.overlay,t=t||!h.overlay,_+=h.overlay?0:1;return this.options.hideSingleBase&&(t=t&&_>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=o&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var o=this._getLayer(f(t.target)),l=o.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;l&&this._map.fire(l,o)},_createRadioElement:function(t,o){var l='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(o?' checked="checked"':"")+"/>",h=document.createElement("div");return h.innerHTML=l,h.firstChild},_addItem:function(t){var o=document.createElement("label"),l=this._map.hasLayer(t.layer),h;t.overlay?(h=document.createElement("input"),h.type="checkbox",h.className="leaflet-control-layers-selector",h.defaultChecked=l):h=this._createRadioElement("leaflet-base-layers_"+f(this),l),this._layerControlInputs.push(h),h.layerId=f(t.layer),Dt(h,"click",this._onInputClick,this);var _=document.createElement("span");_.innerHTML=" "+t.name;var v=document.createElement("span");o.appendChild(v),v.appendChild(h),v.appendChild(_);var C=t.overlay?this._overlaysList:this._baseLayersList;return C.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,o,l,h=[],_=[];this._handlingClick=!0;for(var v=t.length-1;v>=0;v--)o=t[v],l=this._getLayer(o.layerId).layer,o.checked?h.push(l):o.checked||_.push(l);for(v=0;v<_.length;v++)this._map.hasLayer(_[v])&&this._map.removeLayer(_[v]);for(v=0;v<h.length;v++)this._map.hasLayer(h[v])||this._map.addLayer(h[v]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,o,l,h=this._map.getZoom(),_=t.length-1;_>=0;_--)o=t[_],l=this._getLayer(o.layerId).layer,o.disabled=l.options.minZoom!==void 0&&h<l.options.minZoom||l.options.maxZoom!==void 0&&h>l.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,Dt(t,"click",zn),this.expand();var o=this;setTimeout(function(){Rt(t,"click",zn),o._preventClick=!1})}}),wa=function(t,o,l){return new fs(t,o,l)},No=Jn.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var o="leaflet-control-zoom",l=Ht("div",o+" leaflet-bar"),h=this.options;return this._zoomInButton=this._createButton(h.zoomInText,h.zoomInTitle,o+"-in",l,this._zoomIn),this._zoomOutButton=this._createButton(h.zoomOutText,h.zoomOutTitle,o+"-out",l,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),l},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,o,l,h,_){var v=Ht("a",l,h);return v.innerHTML=t,v.href="#",v.title=o,v.setAttribute("role","button"),v.setAttribute("aria-label",o),Hi(v),Dt(v,"click",wi),Dt(v,"click",_,this),Dt(v,"click",this._refocusOnMap,this),v},_updateDisabled:function(){var t=this._map,o="leaflet-disabled";ne(this._zoomInButton,o),ne(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(It(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(It(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});ge.mergeOptions({zoomControl:!0}),ge.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new No,this.addControl(this.zoomControl))});var ba=function(t){return new No(t)},ds=Jn.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var o="leaflet-control-scale",l=Ht("div",o),h=this.options;return this._addScales(h,o+"-line",l),t.on(h.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),l},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,o,l){t.metric&&(this._mScale=Ht("div",o,l)),t.imperial&&(this._iScale=Ht("div",o,l))},_update:function(){var t=this._map,o=t.getSize().y/2,l=t.distance(t.containerPointToLatLng([0,o]),t.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(l)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var o=this._getRoundNum(t),l=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,l,o/t)},_updateImperial:function(t){var o=t*3.2808399,l,h,_;o>5280?(l=o/5280,h=this._getRoundNum(l),this._updateScale(this._iScale,h+" mi",h/l)):(_=this._getRoundNum(o),this._updateScale(this._iScale,_+" ft",_/o))},_updateScale:function(t,o,l){t.style.width=Math.round(this.options.maxWidth*l)+"px",t.innerHTML=o},_getRoundNum:function(t){var o=Math.pow(10,(Math.floor(t)+"").length-1),l=t/o;return l=l>=10?10:l>=5?5:l>=3?3:l>=2?2:1,o*l}}),ka=function(t){return new ds(t)},Pa='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Io=Jn.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(bt.inlineSvg?Pa+" ":"")+"Leaflet</a>"},initialize:function(t){S(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=Ht("div","leaflet-control-attribution"),Hi(this._container);for(var o in t._layers)t._layers[o].getAttribution&&this.addAttribution(t._layers[o].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var o in this._attributions)this._attributions[o]&&t.push(o);var l=[];this.options.prefix&&l.push(this.options.prefix),t.length&&l.push(t.join(", ")),this._container.innerHTML=l.join(' <span aria-hidden="true">|</span> ')}}});ge.mergeOptions({attributionControl:!0}),ge.addInitHook(function(){this.options.attributionControl&&new Io().addTo(this)});var La=function(t){return new Io(t)};Jn.Layers=fs,Jn.Zoom=No,Jn.Scale=ds,Jn.Attribution=Io,Fi.layers=wa,Fi.zoom=ba,Fi.scale=ka,Fi.attribution=La;var ti=X.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ti.addTo=function(t,o){return t.addHandler(o,this),this};var Ca={Events:dt},_s=bt.touch?"touchstart mousedown":"mousedown",di=Q.extend({options:{clickTolerance:3},initialize:function(t,o,l,h){S(this,h),this._element=t,this._dragStartTarget=o||t,this._preventOutline=l},enable:function(){this._enabled||(Dt(this._dragStartTarget,_s,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(di._dragging===this&&this.finishDrag(!0),Rt(this._dragStartTarget,_s,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!oe(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){di._dragging===this&&this.finishDrag();return}if(!(di._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(di._dragging=this,this._preventOutline&&ft(this._element),Di(),oi(),!this._moving)){this.fire("down");var o=t.touches?t.touches[0]:t,l=Qt(this._element);this._startPoint=new W(o.clientX,o.clientY),this._startPos=qn(this._element),this._parentScale=Xt(l);var h=t.type==="mousedown";Dt(document,h?"mousemove":"touchmove",this._onMove,this),Dt(document,h?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var o=t.touches&&t.touches.length===1?t.touches[0]:t,l=new W(o.clientX,o.clientY)._subtract(this._startPoint);!l.x&&!l.y||Math.abs(l.x)+Math.abs(l.y)<this.options.clickTolerance||(l.x/=this._parentScale.x,l.y/=this._parentScale.y,zn(t),this._moved||(this.fire("dragstart"),this._moved=!0,It(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),It(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(l),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),Ze(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){ne(document.body,"leaflet-dragging"),this._lastTarget&&(ne(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Rt(document,"mousemove touchmove",this._onMove,this),Rt(document,"mouseup touchend touchcancel",this._onUp,this),Ri(),si();var o=this._moved&&this._moving;this._moving=!1,di._dragging=!1,o&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function ms(t,o,l){var h,_=[1,4,2,8],v,C,I,D,ut,St,Vt,ce;for(v=0,St=t.length;v<St;v++)t[v]._code=bi(t[v],o);for(I=0;I<4;I++){for(Vt=_[I],h=[],v=0,St=t.length,C=St-1;v<St;C=v++)D=t[v],ut=t[C],D._code&Vt?ut._code&Vt||(ce=so(ut,D,Vt,o,l),ce._code=bi(ce,o),h.push(ce)):(ut._code&Vt&&(ce=so(ut,D,Vt,o,l),ce._code=bi(ce,o),h.push(ce)),h.push(D));t=h}return t}function ps(t,o){var l,h,_,v,C,I,D,ut,St;if(!t||t.length===0)throw new Error("latlngs not passed");Un(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var Vt=H([0,0]),ce=R(t),xn=ce.getNorthWest().distanceTo(ce.getSouthWest())*ce.getNorthEast().distanceTo(ce.getNorthWest());xn<1700&&(Vt=xo(t));var Sn=t.length,Vn=[];for(l=0;l<Sn;l++){var Bn=H(t[l]);Vn.push(o.project(H([Bn.lat-Vt.lat,Bn.lng-Vt.lng])))}for(I=D=ut=0,l=0,h=Sn-1;l<Sn;h=l++)_=Vn[l],v=Vn[h],C=_.y*v.x-v.y*_.x,D+=(_.x+v.x)*C,ut+=(_.y+v.y)*C,I+=C*3;I===0?St=Vn[0]:St=[D/I,ut/I];var Ni=o.unproject(st(St));return H([Ni.lat+Vt.lat,Ni.lng+Vt.lng])}function xo(t){for(var o=0,l=0,h=0,_=0;_<t.length;_++){var v=H(t[_]);o+=v.lat,l+=v.lng,h++}return H([o/h,l/h])}var Sa={__proto__:null,clipPolygon:ms,polygonCenter:ps,centroid:xo};function gs(t,o){if(!o||!t.length)return t.slice();var l=o*o;return t=Ea(t,l),t=Ta(t,l),t}function vs(t,o,l){return Math.sqrt(Gi(t,o,l,!0))}function Ma(t,o,l){return Gi(t,o,l)}function Ta(t,o){var l=t.length,h=typeof Uint8Array<"u"?Uint8Array:Array,_=new h(l);_[0]=_[l-1]=1,Oo(t,_,o,0,l-1);var v,C=[];for(v=0;v<l;v++)_[v]&&C.push(t[v]);return C}function Oo(t,o,l,h,_){var v=0,C,I,D;for(I=h+1;I<=_-1;I++)D=Gi(t[I],t[h],t[_],!0),D>v&&(C=I,v=D);v>l&&(o[C]=1,Oo(t,o,l,h,C),Oo(t,o,l,C,_))}function Ea(t,o){for(var l=[t[0]],h=1,_=0,v=t.length;h<v;h++)Aa(t[h],t[_])>o&&(l.push(t[h]),_=h);return _<v-1&&l.push(t[v-1]),l}var ys;function ws(t,o,l,h,_){var v=h?ys:bi(t,l),C=bi(o,l),I,D,ut;for(ys=C;;){if(!(v|C))return[t,o];if(v&C)return!1;I=v||C,D=so(t,o,I,l,_),ut=bi(D,l),I===v?(t=D,v=ut):(o=D,C=ut)}}function so(t,o,l,h,_){var v=o.x-t.x,C=o.y-t.y,I=h.min,D=h.max,ut,St;return l&8?(ut=t.x+v*(D.y-t.y)/C,St=D.y):l&4?(ut=t.x+v*(I.y-t.y)/C,St=I.y):l&2?(ut=D.x,St=t.y+C*(D.x-t.x)/v):l&1&&(ut=I.x,St=t.y+C*(I.x-t.x)/v),new W(ut,St,_)}function bi(t,o){var l=0;return t.x<o.min.x?l|=1:t.x>o.max.x&&(l|=2),t.y<o.min.y?l|=4:t.y>o.max.y&&(l|=8),l}function Aa(t,o){var l=o.x-t.x,h=o.y-t.y;return l*l+h*h}function Gi(t,o,l,h){var _=o.x,v=o.y,C=l.x-_,I=l.y-v,D=C*C+I*I,ut;return D>0&&(ut=((t.x-_)*C+(t.y-v)*I)/D,ut>1?(_=l.x,v=l.y):ut>0&&(_+=C*ut,v+=I*ut)),C=t.x-_,I=t.y-v,h?C*C+I*I:new W(_,v)}function Un(t){return!O(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function bs(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Un(t)}function ks(t,o){var l,h,_,v,C,I,D,ut;if(!t||t.length===0)throw new Error("latlngs not passed");Un(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var St=H([0,0]),Vt=R(t),ce=Vt.getNorthWest().distanceTo(Vt.getSouthWest())*Vt.getNorthEast().distanceTo(Vt.getNorthWest());ce<1700&&(St=xo(t));var xn=t.length,Sn=[];for(l=0;l<xn;l++){var Vn=H(t[l]);Sn.push(o.project(H([Vn.lat-St.lat,Vn.lng-St.lng])))}for(l=0,h=0;l<xn-1;l++)h+=Sn[l].distanceTo(Sn[l+1])/2;if(h===0)ut=Sn[0];else for(l=0,v=0;l<xn-1;l++)if(C=Sn[l],I=Sn[l+1],_=C.distanceTo(I),v+=_,v>h){D=(v-h)/_,ut=[I.x-D*(I.x-C.x),I.y-D*(I.y-C.y)];break}var Bn=o.unproject(st(ut));return H([Bn.lat+St.lat,Bn.lng+St.lng])}var za={__proto__:null,simplify:gs,pointToSegmentDistance:vs,closestPointOnSegment:Ma,clipSegment:ws,_getEdgeIntersection:so,_getBitCode:bi,_sqClosestPointOnSegment:Gi,isFlat:Un,_flat:bs,polylineCenter:ks},Bo={project:function(t){return new W(t.lng,t.lat)},unproject:function(t){return new U(t.y,t.x)},bounds:new yt([-180,-90],[180,90])},Zo={R:6378137,R_MINOR:6356752314245179e-9,bounds:new yt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var o=Math.PI/180,l=this.R,h=t.lat*o,_=this.R_MINOR/l,v=Math.sqrt(1-_*_),C=v*Math.sin(h),I=Math.tan(Math.PI/4-h/2)/Math.pow((1-C)/(1+C),v/2);return h=-l*Math.log(Math.max(I,1e-10)),new W(t.lng*o*l,h)},unproject:function(t){for(var o=180/Math.PI,l=this.R,h=this.R_MINOR/l,_=Math.sqrt(1-h*h),v=Math.exp(-t.y/l),C=Math.PI/2-2*Math.atan(v),I=0,D=.1,ut;I<15&&Math.abs(D)>1e-7;I++)ut=_*Math.sin(C),ut=Math.pow((1-ut)/(1+ut),_/2),D=Math.PI/2-2*Math.atan(v*ut)-C,C+=D;return new U(C*o,t.x*o/l)}},Na={__proto__:null,LonLat:Bo,Mercator:Zo,SphericalMercator:rt},Ia=r({},Nt,{code:"EPSG:3395",projection:Zo,transformation:function(){var t=.5/(Math.PI*Zo.R);return Mt(t,.5,-t,.5)}()}),Ps=r({},Nt,{code:"EPSG:4326",projection:Bo,transformation:Mt(1/180,1,-1/180,.5)}),xa=r({},K,{projection:Bo,transformation:Mt(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,o){var l=o.lng-t.lng,h=o.lat-t.lat;return Math.sqrt(l*l+h*h)},infinite:!0});K.Earth=Nt,K.EPSG3395=Ia,K.EPSG3857=xt,K.EPSG900913=qt,K.EPSG4326=Ps,K.Simple=xa;var Qn=Q.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[f(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[f(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var o=t.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var l=this.getEvents();o.on(l,this),this.once("remove",function(){o.off(l,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});ge.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var o=f(t);return this._layers[o]?this:(this._layers[o]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var o=f(t);return this._layers[o]?(this._loaded&&t.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return f(t)in this._layers},eachLayer:function(t,o){for(var l in this._layers)t.call(o,this._layers[l]);return this},_addLayers:function(t){t=t?O(t)?t:[t]:[];for(var o=0,l=t.length;o<l;o++)this.addLayer(t[o])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[f(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var o=f(t);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,o=-1/0,l=this._getZoomSpan();for(var h in this._zoomBoundLayers){var _=this._zoomBoundLayers[h].options;t=_.minZoom===void 0?t:Math.min(t,_.minZoom),o=_.maxZoom===void 0?o:Math.max(o,_.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=t===1/0?void 0:t,l!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Mi=Qn.extend({initialize:function(t,o){S(this,o),this._layers={};var l,h;if(t)for(l=0,h=t.length;l<h;l++)this.addLayer(t[l])},addLayer:function(t){var o=this.getLayerId(t);return this._layers[o]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var o=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(t){var o=typeof t=="number"?t:this.getLayerId(t);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var o=Array.prototype.slice.call(arguments,1),l,h;for(l in this._layers)h=this._layers[l],h[t]&&h[t].apply(h,o);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,o){for(var l in this._layers)t.call(o,this._layers[l]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return f(t)}}),Oa=function(t,o){return new Mi(t,o)},ri=Mi.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Mi.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Mi.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new _t;for(var o in this._layers){var l=this._layers[o];t.extend(l.getBounds?l.getBounds():l.getLatLng())}return t}}),Ba=function(t,o){return new ri(t,o)},Ti=X.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){S(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,o){var l=this._getIconUrl(t);if(!l){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var h=this._createImg(l,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(h,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),h},_setIconStyles:function(t,o){var l=this.options,h=l[o+"Size"];typeof h=="number"&&(h=[h,h]);var _=st(h),v=st(o==="shadow"&&l.shadowAnchor||l.iconAnchor||_&&_.divideBy(2,!0));t.className="leaflet-marker-"+o+" "+(l.className||""),v&&(t.style.marginLeft=-v.x+"px",t.style.marginTop=-v.y+"px"),_&&(t.style.width=_.x+"px",t.style.height=_.y+"px")},_createImg:function(t,o){return o=o||document.createElement("img"),o.src=t,o},_getIconUrl:function(t){return bt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function Za(t){return new Ti(t)}var Ui=Ti.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof Ui.imagePath!="string"&&(Ui.imagePath=this._detectIconPath()),(this.options.imagePath||Ui.imagePath)+Ti.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var o=function(l,h,_){var v=h.exec(l);return v&&v[_]};return t=o(t,/^url\((['"])?(.+)\1\)$/,2),t&&o(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=Ht("div","leaflet-default-icon-path",document.body),o=gt(t,"background-image")||gt(t,"backgroundImage");if(document.body.removeChild(t),o=this._stripUrl(o),o)return o;var l=document.querySelector('link[href$="leaflet.css"]');return l?l.href.substring(0,l.href.length-11-1):""}}),Ls=ti.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new di(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),It(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ne(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var o=this._marker,l=o._map,h=this._marker.options.autoPanSpeed,_=this._marker.options.autoPanPadding,v=qn(o._icon),C=l.getPixelBounds(),I=l.getPixelOrigin(),D=Lt(C.min._subtract(I).add(_),C.max._subtract(I).subtract(_));if(!D.contains(v)){var ut=st((Math.max(D.max.x,v.x)-D.max.x)/(C.max.x-D.max.x)-(Math.min(D.min.x,v.x)-D.min.x)/(C.min.x-D.min.x),(Math.max(D.max.y,v.y)-D.max.y)/(C.max.y-D.max.y)-(Math.min(D.min.y,v.y)-D.min.y)/(C.min.y-D.min.y)).multiplyBy(h);l.panBy(ut,{animate:!1}),this._draggable._newPos._add(ut),this._draggable._startPos._add(ut),Ze(o._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=lt(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(N(this._panRequest),this._panRequest=lt(this._adjustPan.bind(this,t)))},_onDrag:function(t){var o=this._marker,l=o._shadow,h=qn(o._icon),_=o._map.layerPointToLatLng(h);l&&Ze(l,h),o._latlng=_,t.latlng=_,t.oldLatLng=this._oldLatLng,o.fire("move",t).fire("drag",t)},_onDragEnd:function(t){N(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),ro=Qn.extend({options:{icon:new Ui,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,o){S(this,o),this._latlng=H(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var o=this._latlng;return this._latlng=H(t),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),l=t.icon.createIcon(this._icon),h=!1;l!==this._icon&&(this._icon&&this._removeIcon(),h=!0,t.title&&(l.title=t.title),l.tagName==="IMG"&&(l.alt=t.alt||"")),It(l,o),t.keyboard&&(l.tabIndex="0",l.setAttribute("role","button")),this._icon=l,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Dt(l,"focus",this._panOnFocus,this);var _=t.icon.createShadow(this._shadow),v=!1;_!==this._shadow&&(this._removeShadow(),v=!0),_&&(It(_,o),_.alt=""),this._shadow=_,t.opacity<1&&this._updateOpacity(),h&&this.getPane().appendChild(this._icon),this._initInteraction(),_&&v&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Rt(this._icon,"focus",this._panOnFocus,this),te(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&te(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&Ze(this._icon,t),this._shadow&&Ze(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(It(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ls)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ls(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&ln(this._icon,t),this._shadow&&ln(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var o=this.options.icon.options,l=o.iconSize?st(o.iconSize):st(0,0),h=o.iconAnchor?st(o.iconAnchor):st(0,0);t.panInside(this._latlng,{paddingTopLeft:h,paddingBottomRight:l.subtract(h)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Da(t,o){return new ro(t,o)}var _i=Qn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return S(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),lo=_i.extend({options:{fill:!0,radius:10},initialize:function(t,o){S(this,o),this._latlng=H(t),this._radius=this.options.radius},setLatLng:function(t){var o=this._latlng;return this._latlng=H(t),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var o=t&&t.radius||this._radius;return _i.prototype.setStyle.call(this,t),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,o=this._radiusY||t,l=this._clickTolerance(),h=[t+l,o+l];this._pxBounds=new yt(this._point.subtract(h),this._point.add(h))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ra(t,o){return new lo(t,o)}var Do=lo.extend({initialize:function(t,o,l){if(typeof o=="number"&&(o=r({},l,{radius:o})),S(this,o),this._latlng=H(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new _t(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:_i.prototype.setStyle,_project:function(){var t=this._latlng.lng,o=this._latlng.lat,l=this._map,h=l.options.crs;if(h.distance===Nt.distance){var _=Math.PI/180,v=this._mRadius/Nt.R/_,C=l.project([o+v,t]),I=l.project([o-v,t]),D=C.add(I).divideBy(2),ut=l.unproject(D).lat,St=Math.acos((Math.cos(v*_)-Math.sin(o*_)*Math.sin(ut*_))/(Math.cos(o*_)*Math.cos(ut*_)))/_;(isNaN(St)||St===0)&&(St=v/Math.cos(Math.PI/180*o)),this._point=D.subtract(l.getPixelOrigin()),this._radius=isNaN(St)?0:D.x-l.project([ut,t-St]).x,this._radiusY=D.y-C.y}else{var Vt=h.unproject(h.project(this._latlng).subtract([this._mRadius,0]));this._point=l.latLngToLayerPoint(this._latlng),this._radius=this._point.x-l.latLngToLayerPoint(Vt).x}this._updateBounds()}});function ja(t,o,l){return new Do(t,o,l)}var li=_i.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,o){S(this,o),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var o=1/0,l=null,h=Gi,_,v,C=0,I=this._parts.length;C<I;C++)for(var D=this._parts[C],ut=1,St=D.length;ut<St;ut++){_=D[ut-1],v=D[ut];var Vt=h(t,_,v,!0);Vt<o&&(o=Vt,l=h(t,_,v))}return l&&(l.distance=Math.sqrt(o)),l},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ks(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,o){return o=o||this._defaultShape(),t=H(t),o.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new _t,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Un(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var o=[],l=Un(t),h=0,_=t.length;h<_;h++)l?(o[h]=H(t[h]),this._bounds.extend(o[h])):o[h]=this._convertLatLngs(t[h]);return o},_project:function(){var t=new yt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),o=new W(t,t);this._rawPxBounds&&(this._pxBounds=new yt([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(t,o,l){var h=t[0]instanceof U,_=t.length,v,C;if(h){for(C=[],v=0;v<_;v++)C[v]=this._map.latLngToLayerPoint(t[v]),l.extend(C[v]);o.push(C)}else for(v=0;v<_;v++)this._projectLatlngs(t[v],o,l)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,l,h,_,v,C,I,D;for(l=0,_=0,v=this._rings.length;l<v;l++)for(D=this._rings[l],h=0,C=D.length;h<C-1;h++)I=ws(D[h],D[h+1],t,h,!0),I&&(o[_]=o[_]||[],o[_].push(I[0]),(I[1]!==D[h+1]||h===C-2)&&(o[_].push(I[1]),_++))}},_simplifyPoints:function(){for(var t=this._parts,o=this.options.smoothFactor,l=0,h=t.length;l<h;l++)t[l]=gs(t[l],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,o){var l,h,_,v,C,I,D=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(l=0,v=this._parts.length;l<v;l++)for(I=this._parts[l],h=0,C=I.length,_=C-1;h<C;_=h++)if(!(!o&&h===0)&&vs(t,I[_],I[h])<=D)return!0;return!1}});function Wa(t,o){return new li(t,o)}li._flat=bs;var Ei=li.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ps(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var o=li.prototype._convertLatLngs.call(this,t),l=o.length;return l>=2&&o[0]instanceof U&&o[0].equals(o[l-1])&&o.pop(),o},_setLatLngs:function(t){li.prototype._setLatLngs.call(this,t),Un(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Un(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,o=this.options.weight,l=new W(o,o);if(t=new yt(t.min.subtract(l),t.max.add(l)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var h=0,_=this._rings.length,v;h<_;h++)v=ms(this._rings[h],t,!0),v.length&&this._parts.push(v)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var o=!1,l,h,_,v,C,I,D,ut;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(v=0,D=this._parts.length;v<D;v++)for(l=this._parts[v],C=0,ut=l.length,I=ut-1;C<ut;I=C++)h=l[C],_=l[I],h.y>t.y!=_.y>t.y&&t.x<(_.x-h.x)*(t.y-h.y)/(_.y-h.y)+h.x&&(o=!o);return o||li.prototype._containsPoint.call(this,t,!0)}});function Ha(t,o){return new Ei(t,o)}var ai=ri.extend({initialize:function(t,o){S(this,o),this._layers={},t&&this.addData(t)},addData:function(t){var o=O(t)?t:t.features,l,h,_;if(o){for(l=0,h=o.length;l<h;l++)_=o[l],(_.geometries||_.geometry||_.features||_.coordinates)&&this.addData(_);return this}var v=this.options;if(v.filter&&!v.filter(t))return this;var C=ao(t,v);return C?(C.feature=ho(t),C.defaultOptions=C.options,this.resetStyle(C),v.onEachFeature&&v.onEachFeature(t,C),this.addLayer(C)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=r({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(o){this._setLayerStyle(o,t)},this)},_setLayerStyle:function(t,o){t.setStyle&&(typeof o=="function"&&(o=o(t.feature)),t.setStyle(o))}});function ao(t,o){var l=t.type==="Feature"?t.geometry:t,h=l?l.coordinates:null,_=[],v=o&&o.pointToLayer,C=o&&o.coordsToLatLng||Ro,I,D,ut,St;if(!h&&!l)return null;switch(l.type){case"Point":return I=C(h),Cs(v,t,I,o);case"MultiPoint":for(ut=0,St=h.length;ut<St;ut++)I=C(h[ut]),_.push(Cs(v,t,I,o));return new ri(_);case"LineString":case"MultiLineString":return D=uo(h,l.type==="LineString"?0:1,C),new li(D,o);case"Polygon":case"MultiPolygon":return D=uo(h,l.type==="Polygon"?1:2,C),new Ei(D,o);case"GeometryCollection":for(ut=0,St=l.geometries.length;ut<St;ut++){var Vt=ao({geometry:l.geometries[ut],type:"Feature",properties:t.properties},o);Vt&&_.push(Vt)}return new ri(_);case"FeatureCollection":for(ut=0,St=l.features.length;ut<St;ut++){var ce=ao(l.features[ut],o);ce&&_.push(ce)}return new ri(_);default:throw new Error("Invalid GeoJSON object.")}}function Cs(t,o,l,h){return t?t(o,l):new ro(l,h&&h.markersInheritOptions&&h)}function Ro(t){return new U(t[1],t[0],t[2])}function uo(t,o,l){for(var h=[],_=0,v=t.length,C;_<v;_++)C=o?uo(t[_],o-1,l):(l||Ro)(t[_]),h.push(C);return h}function jo(t,o){return t=H(t),t.alt!==void 0?[k(t.lng,o),k(t.lat,o),k(t.alt,o)]:[k(t.lng,o),k(t.lat,o)]}function co(t,o,l,h){for(var _=[],v=0,C=t.length;v<C;v++)_.push(o?co(t[v],Un(t[v])?0:o-1,l,h):jo(t[v],h));return!o&&l&&_.length>0&&_.push(_[0].slice()),_}function Ai(t,o){return t.feature?r({},t.feature,{geometry:o}):ho(o)}function ho(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var Wo={toGeoJSON:function(t){return Ai(this,{type:"Point",coordinates:jo(this.getLatLng(),t)})}};ro.include(Wo),Do.include(Wo),lo.include(Wo),li.include({toGeoJSON:function(t){var o=!Un(this._latlngs),l=co(this._latlngs,o?1:0,!1,t);return Ai(this,{type:(o?"Multi":"")+"LineString",coordinates:l})}}),Ei.include({toGeoJSON:function(t){var o=!Un(this._latlngs),l=o&&!Un(this._latlngs[0]),h=co(this._latlngs,l?2:o?1:0,!0,t);return o||(h=[h]),Ai(this,{type:(l?"Multi":"")+"Polygon",coordinates:h})}}),Mi.include({toMultiPoint:function(t){var o=[];return this.eachLayer(function(l){o.push(l.toGeoJSON(t).geometry.coordinates)}),Ai(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(t){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(t);var l=o==="GeometryCollection",h=[];return this.eachLayer(function(_){if(_.toGeoJSON){var v=_.toGeoJSON(t);if(l)h.push(v.geometry);else{var C=ho(v);C.type==="FeatureCollection"?h.push.apply(h,C.features):h.push(C)}}}),l?Ai(this,{geometries:h,type:"GeometryCollection"}):{type:"FeatureCollection",features:h}}});function Ss(t,o){return new ai(t,o)}var Fa=Ss,fo=Qn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,o,l){this._url=t,this._bounds=R(o),S(this,l)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(It(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){te(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&En(this._image),this},bringToBack:function(){return this._map&&Je(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=R(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",o=this._image=t?this._url:Ht("img");if(It(o,"leaflet-image-layer"),this._zoomAnimated&&It(o,"leaflet-zoom-animated"),this.options.className&&It(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onload=u(this.fire,this,"load"),o.onerror=u(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(t){var o=this._map.getZoomScale(t.zoom),l=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;se(this._image,l,o)},_reset:function(){var t=this._image,o=new yt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),l=o.getSize();Ze(t,o.min),t.style.width=l.x+"px",t.style.height=l.y+"px"},_updateOpacity:function(){ln(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Ga=function(t,o,l){return new fo(t,o,l)},Ms=fo.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",o=this._image=t?this._url:Ht("video");if(It(o,"leaflet-image-layer"),this._zoomAnimated&&It(o,"leaflet-zoom-animated"),this.options.className&&It(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onloadeddata=u(this.fire,this,"load"),t){for(var l=o.getElementsByTagName("source"),h=[],_=0;_<l.length;_++)h.push(l[_].src);this._url=l.length>0?h:[o.src];return}O(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var v=0;v<this._url.length;v++){var C=Ht("source");C.src=this._url[v],o.appendChild(C)}}});function Ua(t,o,l){return new Ms(t,o,l)}var Ts=fo.extend({_initImage:function(){var t=this._image=this._url;It(t,"leaflet-image-layer"),this._zoomAnimated&&It(t,"leaflet-zoom-animated"),this.options.className&&It(t,this.options.className),t.onselectstart=g,t.onmousemove=g}});function Va(t,o,l){return new Ts(t,o,l)}var ei=Qn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,o){t&&(t instanceof U||O(t))?(this._latlng=H(t),S(this,o)):(S(this,t),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&ln(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&ln(this._container,1),this.bringToFront(),this.options.interactive&&(It(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(ln(this._container,0),this._removeTimeout=setTimeout(u(te,void 0,this._container),200)):te(this._container),this.options.interactive&&(ne(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=H(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&En(this._container),this},bringToBack:function(){return this._map&&Je(this._container),this},_prepareOpen:function(t){var o=this._source;if(!o._map)return!1;if(o instanceof ri){o=null;var l=this._source._layers;for(var h in l)if(l[h]._map){o=l[h];break}if(!o)return!1;this._source=o}if(!t)if(o.getCenter)t=o.getCenter();else if(o.getLatLng)t=o.getLatLng();else if(o.getBounds)t=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")t.innerHTML=o;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),o=st(this.options.offset),l=this._getAnchor();this._zoomAnimated?Ze(this._container,t.add(l)):o=o.add(t).add(l);var h=this._containerBottom=-o.y,_=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=h+"px",this._container.style.left=_+"px"}},_getAnchor:function(){return[0,0]}});ge.include({_initOverlay:function(t,o,l,h){var _=o;return _ instanceof t||(_=new t(h).setContent(o)),l&&_.setLatLng(l),_}}),Qn.include({_initOverlay:function(t,o,l,h){var _=l;return _ instanceof t?(S(_,h),_._source=this):(_=o&&!h?o:new t(h,this),_.setContent(l)),_}});var _o=ei.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,ei.prototype.openOn.call(this,t)},onAdd:function(t){ei.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof _i||this._source.on("preclick",Gn))},onRemove:function(t){ei.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof _i||this._source.off("preclick",Gn))},getEvents:function(){var t=ei.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",o=this._container=Ht("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),l=this._wrapper=Ht("div",t+"-content-wrapper",o);if(this._contentNode=Ht("div",t+"-content",l),Hi(o),Ao(this._contentNode),Dt(o,"contextmenu",Gn),this._tipContainer=Ht("div",t+"-tip-container",o),this._tip=Ht("div",t+"-tip",this._tipContainer),this.options.closeButton){var h=this._closeButton=Ht("a",t+"-close-button",o);h.setAttribute("role","button"),h.setAttribute("aria-label","Close popup"),h.href="#close",h.innerHTML='<span aria-hidden="true">&#215;</span>',Dt(h,"click",function(_){zn(_),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,o=t.style;o.width="",o.whiteSpace="nowrap";var l=t.offsetWidth;l=Math.min(l,this.options.maxWidth),l=Math.max(l,this.options.minWidth),o.width=l+1+"px",o.whiteSpace="",o.height="";var h=t.offsetHeight,_=this.options.maxHeight,v="leaflet-popup-scrolled";_&&h>_?(o.height=_+"px",It(t,v)):ne(t,v),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),l=this._getAnchor();Ze(this._container,o.add(l))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,o=parseInt(gt(this._container,"marginBottom"),10)||0,l=this._container.offsetHeight+o,h=this._containerWidth,_=new W(this._containerLeft,-l-this._containerBottom);_._add(qn(this._container));var v=t.layerPointToContainerPoint(_),C=st(this.options.autoPanPadding),I=st(this.options.autoPanPaddingTopLeft||C),D=st(this.options.autoPanPaddingBottomRight||C),ut=t.getSize(),St=0,Vt=0;v.x+h+D.x>ut.x&&(St=v.x+h-ut.x+D.x),v.x-St-I.x<0&&(St=v.x-I.x),v.y+l+D.y>ut.y&&(Vt=v.y+l-ut.y+D.y),v.y-Vt-I.y<0&&(Vt=v.y-I.y),(St||Vt)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([St,Vt]))}},_getAnchor:function(){return st(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Xa=function(t,o){return new _o(t,o)};ge.mergeOptions({closePopupOnClick:!0}),ge.include({openPopup:function(t,o,l){return this._initOverlay(_o,t,o,l).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),Qn.include({bindPopup:function(t,o){return this._popup=this._initOverlay(_o,this._popup,t,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof ri||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){wi(t);var o=t.layer||t.target;if(this._popup._source===o&&!(o instanceof _i)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=o,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var mo=ei.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){ei.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){ei.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=ei.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",o=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Ht("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var o,l,h=this._map,_=this._container,v=h.latLngToContainerPoint(h.getCenter()),C=h.layerPointToContainerPoint(t),I=this.options.direction,D=_.offsetWidth,ut=_.offsetHeight,St=st(this.options.offset),Vt=this._getAnchor();I==="top"?(o=D/2,l=ut):I==="bottom"?(o=D/2,l=0):I==="center"?(o=D/2,l=ut/2):I==="right"?(o=0,l=ut/2):I==="left"?(o=D,l=ut/2):C.x<v.x?(I="right",o=0,l=ut/2):(I="left",o=D+(St.x+Vt.x)*2,l=ut/2),t=t.subtract(st(o,l,!0)).add(St).add(Vt),ne(_,"leaflet-tooltip-right"),ne(_,"leaflet-tooltip-left"),ne(_,"leaflet-tooltip-top"),ne(_,"leaflet-tooltip-bottom"),It(_,"leaflet-tooltip-"+I),Ze(_,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&ln(this._container,t)},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(o)},_getAnchor:function(){return st(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ya=function(t,o){return new mo(t,o)};ge.include({openTooltip:function(t,o,l){return this._initOverlay(mo,t,o,l).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Qn.include({bindTooltip:function(t,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(mo,this._tooltip,t,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var o=t?"off":"on",l={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?l.add=this._openTooltip:(l.mouseover=this._openTooltip,l.mouseout=this.closeTooltip,l.click=this._openTooltip,this._map?this._addFocusListeners():l.add=this._addFocusListeners),this._tooltip.options.sticky&&(l.mousemove=this._moveTooltip),this[o](l),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof ri||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var o=typeof t.getElement=="function"&&t.getElement();o&&(Dt(o,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),Dt(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var o=typeof t.getElement=="function"&&t.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var o=t.latlng,l,h;this._tooltip.options.sticky&&t.originalEvent&&(l=this._map.mouseEventToContainerPoint(t.originalEvent),h=this._map.containerPointToLayerPoint(l),o=this._map.layerPointToLatLng(h)),this._tooltip.setLatLng(o)}});var Es=Ti.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var o=t&&t.tagName==="DIV"?t:document.createElement("div"),l=this.options;if(l.html instanceof Element?(Ne(o),o.appendChild(l.html)):o.innerHTML=l.html!==!1?l.html:"",l.bgPos){var h=st(l.bgPos);o.style.backgroundPosition=-h.x+"px "+-h.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function qa(t){return new Es(t)}Ti.Default=Ui;var Vi=Qn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:bt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){S(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),te(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(En(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Je(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof W?t:new W(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var o=this.getPane().children,l=-t(-1/0,1/0),h=0,_=o.length,v;h<_;h++)v=o[h].style.zIndex,o[h]!==this._container&&v&&(l=t(l,+v));isFinite(l)&&(this.options.zIndex=l+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!bt.ielt9){ln(this._container,this.options.opacity);var t=+new Date,o=!1,l=!1;for(var h in this._tiles){var _=this._tiles[h];if(!(!_.current||!_.loaded)){var v=Math.min(1,(t-_.loaded)/200);ln(_.el,v),v<1?o=!0:(_.active?l=!0:this._onOpaqueTile(_),_.active=!0)}}l&&!this._noPrune&&this._pruneTiles(),o&&(N(this._fadeFrame),this._fadeFrame=lt(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=Ht("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,o=this.options.maxZoom;if(t!==void 0){for(var l in this._levels)l=Number(l),this._levels[l].el.children.length||l===t?(this._levels[l].el.style.zIndex=o-Math.abs(t-l),this._onUpdateLevel(l)):(te(this._levels[l].el),this._removeTilesAtZoom(l),this._onRemoveLevel(l),delete this._levels[l]);var h=this._levels[t],_=this._map;return h||(h=this._levels[t]={},h.el=Ht("div","leaflet-tile-container leaflet-zoom-animated",this._container),h.el.style.zIndex=o,h.origin=_.project(_.unproject(_.getPixelOrigin()),t).round(),h.zoom=t,this._setZoomTransform(h,_.getCenter(),_.getZoom()),g(h.el.offsetWidth),this._onCreateLevel(h)),this._level=h,h}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var t,o,l=this._map.getZoom();if(l>this.options.maxZoom||l<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)o=this._tiles[t],o.retain=o.current;for(t in this._tiles)if(o=this._tiles[t],o.current&&!o.active){var h=o.coords;this._retainParent(h.x,h.y,h.z,h.z-5)||this._retainChildren(h.x,h.y,h.z,h.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var o in this._tiles)this._tiles[o].coords.z===t&&this._removeTile(o)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)te(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,o,l,h){var _=Math.floor(t/2),v=Math.floor(o/2),C=l-1,I=new W(+_,+v);I.z=+C;var D=this._tileCoordsToKey(I),ut=this._tiles[D];return ut&&ut.active?(ut.retain=!0,!0):(ut&&ut.loaded&&(ut.retain=!0),C>h?this._retainParent(_,v,C,h):!1)},_retainChildren:function(t,o,l,h){for(var _=2*t;_<2*t+2;_++)for(var v=2*o;v<2*o+2;v++){var C=new W(_,v);C.z=l+1;var I=this._tileCoordsToKey(C),D=this._tiles[I];if(D&&D.active){D.retain=!0;continue}else D&&D.loaded&&(D.retain=!0);l+1<h&&this._retainChildren(_,v,l+1,h)}},_resetView:function(t){var o=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var o=this.options;return o.minNativeZoom!==void 0&&t<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<t?o.maxNativeZoom:t},_setView:function(t,o,l,h){var _=Math.round(o);this.options.maxZoom!==void 0&&_>this.options.maxZoom||this.options.minZoom!==void 0&&_<this.options.minZoom?_=void 0:_=this._clampZoom(_);var v=this.options.updateWhenZooming&&_!==this._tileZoom;(!h||v)&&(this._tileZoom=_,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),_!==void 0&&this._update(t),l||this._pruneTiles(),this._noPrune=!!l),this._setZoomTransforms(t,o)},_setZoomTransforms:function(t,o){for(var l in this._levels)this._setZoomTransform(this._levels[l],t,o)},_setZoomTransform:function(t,o,l){var h=this._map.getZoomScale(l,t.zoom),_=t.origin.multiplyBy(h).subtract(this._map._getNewPixelOrigin(o,l)).round();bt.any3d?se(t.el,_,h):Ze(t.el,_)},_resetGrid:function(){var t=this._map,o=t.options.crs,l=this._tileSize=this.getTileSize(),h=this._tileZoom,_=this._map.getPixelWorldBounds(this._tileZoom);_&&(this._globalTileRange=this._pxBoundsToTileRange(_)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,o.wrapLng[0]],h).x/l.x),Math.ceil(t.project([0,o.wrapLng[1]],h).x/l.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([o.wrapLat[0],0],h).y/l.x),Math.ceil(t.project([o.wrapLat[1],0],h).y/l.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var o=this._map,l=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),h=o.getZoomScale(l,this._tileZoom),_=o.project(t,this._tileZoom).floor(),v=o.getSize().divideBy(h*2);return new yt(_.subtract(v),_.add(v))},_update:function(t){var o=this._map;if(o){var l=this._clampZoom(o.getZoom());if(t===void 0&&(t=o.getCenter()),this._tileZoom!==void 0){var h=this._getTiledPixelBounds(t),_=this._pxBoundsToTileRange(h),v=_.getCenter(),C=[],I=this.options.keepBuffer,D=new yt(_.getBottomLeft().subtract([I,-I]),_.getTopRight().add([I,-I]));if(!(isFinite(_.min.x)&&isFinite(_.min.y)&&isFinite(_.max.x)&&isFinite(_.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ut in this._tiles){var St=this._tiles[ut].coords;(St.z!==this._tileZoom||!D.contains(new W(St.x,St.y)))&&(this._tiles[ut].current=!1)}if(Math.abs(l-this._tileZoom)>1){this._setView(t,l);return}for(var Vt=_.min.y;Vt<=_.max.y;Vt++)for(var ce=_.min.x;ce<=_.max.x;ce++){var xn=new W(ce,Vt);if(xn.z=this._tileZoom,!!this._isValidTile(xn)){var Sn=this._tiles[this._tileCoordsToKey(xn)];Sn?Sn.current=!0:C.push(xn)}}if(C.sort(function(Bn,Ni){return Bn.distanceTo(v)-Ni.distanceTo(v)}),C.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Vn=document.createDocumentFragment();for(ce=0;ce<C.length;ce++)this._addTile(C[ce],Vn);this._level.el.appendChild(Vn)}}}},_isValidTile:function(t){var o=this._map.options.crs;if(!o.infinite){var l=this._globalTileRange;if(!o.wrapLng&&(t.x<l.min.x||t.x>l.max.x)||!o.wrapLat&&(t.y<l.min.y||t.y>l.max.y))return!1}if(!this.options.bounds)return!0;var h=this._tileCoordsToBounds(t);return R(this.options.bounds).overlaps(h)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var o=this._map,l=this.getTileSize(),h=t.scaleBy(l),_=h.add(l),v=o.unproject(h,t.z),C=o.unproject(_,t.z);return[v,C]},_tileCoordsToBounds:function(t){var o=this._tileCoordsToNwSe(t),l=new _t(o[0],o[1]);return this.options.noWrap||(l=this._map.wrapLatLngBounds(l)),l},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var o=t.split(":"),l=new W(+o[0],+o[1]);return l.z=+o[2],l},_removeTile:function(t){var o=this._tiles[t];o&&(te(o.el),delete this._tiles[t],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){It(t,"leaflet-tile");var o=this.getTileSize();t.style.width=o.x+"px",t.style.height=o.y+"px",t.onselectstart=g,t.onmousemove=g,bt.ielt9&&this.options.opacity<1&&ln(t,this.options.opacity)},_addTile:function(t,o){var l=this._getTilePos(t),h=this._tileCoordsToKey(t),_=this.createTile(this._wrapCoords(t),u(this._tileReady,this,t));this._initTile(_),this.createTile.length<2&&lt(u(this._tileReady,this,t,null,_)),Ze(_,l),this._tiles[h]={el:_,coords:t,current:!0},o.appendChild(_),this.fire("tileloadstart",{tile:_,coords:t})},_tileReady:function(t,o,l){o&&this.fire("tileerror",{error:o,tile:l,coords:t});var h=this._tileCoordsToKey(t);l=this._tiles[h],l&&(l.loaded=+new Date,this._map._fadeAnimated?(ln(l.el,0),N(this._fadeFrame),this._fadeFrame=lt(this._updateOpacity,this)):(l.active=!0,this._pruneTiles()),o||(It(l.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:l.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),bt.ielt9||!this._map._fadeAnimated?lt(this._pruneTiles,this):setTimeout(u(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var o=new W(this._wrapX?p(t.x,this._wrapX):t.x,this._wrapY?p(t.y,this._wrapY):t.y);return o.z=t.z,o},_pxBoundsToTileRange:function(t){var o=this.getTileSize();return new yt(t.min.unscaleBy(o).floor(),t.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Ka(t){return new Vi(t)}var zi=Vi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,o){this._url=t,o=S(this,o),o.detectRetina&&bt.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,o){return this._url===t&&o===void 0&&(o=!0),this._url=t,o||this.redraw(),this},createTile:function(t,o){var l=document.createElement("img");return Dt(l,"load",u(this._tileOnLoad,this,o,l)),Dt(l,"error",u(this._tileOnError,this,o,l)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(l.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(l.referrerPolicy=this.options.referrerPolicy),l.alt="",l.src=this.getTileUrl(t),l},getTileUrl:function(t){var o={r:bt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var l=this._globalTileRange.max.y-t.y;this.options.tms&&(o.y=l),o["-y"]=l}return E(this._url,r(o,this.options))},_tileOnLoad:function(t,o){bt.ielt9?setTimeout(u(t,this,null,o),0):t(null,o)},_tileOnError:function(t,o,l){var h=this.options.errorTileUrl;h&&o.getAttribute("src")!==h&&(o.src=h),t(l,o)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,o=this.options.maxZoom,l=this.options.zoomReverse,h=this.options.zoomOffset;return l&&(t=o-t),t+h},_getSubdomain:function(t){var o=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var t,o;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(o=this._tiles[t].el,o.onload=g,o.onerror=g,!o.complete)){o.src=Y;var l=this._tiles[t].coords;te(o),delete this._tiles[t],this.fire("tileabort",{tile:o,coords:l})}},_removeTile:function(t){var o=this._tiles[t];if(o)return o.el.setAttribute("src",Y),Vi.prototype._removeTile.call(this,t)},_tileReady:function(t,o,l){if(!(!this._map||l&&l.getAttribute("src")===Y))return Vi.prototype._tileReady.call(this,t,o,l)}});function As(t,o){return new zi(t,o)}var zs=zi.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,o){this._url=t;var l=r({},this.defaultWmsParams);for(var h in o)h in this.options||(l[h]=o[h]);o=S(this,o);var _=o.detectRetina&&bt.retina?2:1,v=this.getTileSize();l.width=v.x*_,l.height=v.y*_,this.wmsParams=l},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,zi.prototype.onAdd.call(this,t)},getTileUrl:function(t){var o=this._tileCoordsToNwSe(t),l=this._crs,h=Lt(l.project(o[0]),l.project(o[1])),_=h.min,v=h.max,C=(this._wmsVersion>=1.3&&this._crs===Ps?[_.y,_.x,v.y,v.x]:[_.x,_.y,v.x,v.y]).join(","),I=zi.prototype.getTileUrl.call(this,t);return I+z(this.wmsParams,I,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+C},setParams:function(t,o){return r(this.wmsParams,t),o||this.redraw(),this}});function Ja(t,o){return new zs(t,o)}zi.WMS=zs,As.wms=Ja;var ui=Qn.extend({options:{padding:.1},initialize:function(t){S(this,t),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),It(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,o){var l=this._map.getZoomScale(o,this._zoom),h=this._map.getSize().multiplyBy(.5+this.options.padding),_=this._map.project(this._center,o),v=h.multiplyBy(-l).add(_).subtract(this._map._getNewPixelOrigin(t,o));bt.any3d?se(this._container,v,l):Ze(this._container,v)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,o=this._map.getSize(),l=this._map.containerPointToLayerPoint(o.multiplyBy(-t)).round();this._bounds=new yt(l,l.add(o.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ns=ui.extend({options:{tolerance:0},getEvents:function(){var t=ui.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ui.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Dt(t,"mousemove",this._onMouseMove,this),Dt(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Dt(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){N(this._redrawRequest),delete this._ctx,te(this._container),Rt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var o in this._layers)t=this._layers[o],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ui.prototype._update.call(this);var t=this._bounds,o=this._container,l=t.getSize(),h=bt.retina?2:1;Ze(o,t.min),o.width=h*l.x,o.height=h*l.y,o.style.width=l.x+"px",o.style.height=l.y+"px",bt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){ui.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[f(t)]=t;var o=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var o=t._order,l=o.next,h=o.prev;l?l.prev=h:this._drawLast=h,h?h.next=l:this._drawFirst=l,delete t._order,delete this._layers[f(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var o=t.options.dashArray.split(/[, ]+/),l=[],h,_;for(_=0;_<o.length;_++){if(h=Number(o[_]),isNaN(h))return;l.push(h)}t.options._dashArray=l}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||lt(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var o=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new yt,this._redrawBounds.extend(t._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(t._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var o=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,o=this._redrawBounds;if(this._ctx.save(),o){var l=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,l.x,l.y),this._ctx.clip()}this._drawing=!0;for(var h=this._drawFirst;h;h=h.next)t=h.layer,(!o||t._pxBounds&&t._pxBounds.intersects(o))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,o){if(this._drawing){var l,h,_,v,C=t._parts,I=C.length,D=this._ctx;if(I){for(D.beginPath(),l=0;l<I;l++){for(h=0,_=C[l].length;h<_;h++)v=C[l][h],D[h?"lineTo":"moveTo"](v.x,v.y);o&&D.closePath()}this._fillStroke(D,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var o=t._point,l=this._ctx,h=Math.max(Math.round(t._radius),1),_=(Math.max(Math.round(t._radiusY),1)||h)/h;_!==1&&(l.save(),l.scale(1,_)),l.beginPath(),l.arc(o.x,o.y/_,h,0,Math.PI*2,!1),_!==1&&l.restore(),this._fillStroke(l,t)}},_fillStroke:function(t,o){var l=o.options;l.fill&&(t.globalAlpha=l.fillOpacity,t.fillStyle=l.fillColor||l.color,t.fill(l.fillRule||"evenodd")),l.stroke&&l.weight!==0&&(t.setLineDash&&t.setLineDash(o.options&&o.options._dashArray||[]),t.globalAlpha=l.opacity,t.lineWidth=l.weight,t.strokeStyle=l.color,t.lineCap=l.lineCap,t.lineJoin=l.lineJoin,t.stroke())},_onClick:function(t){for(var o=this._map.mouseEventToLayerPoint(t),l,h,_=this._drawFirst;_;_=_.next)l=_.layer,l.options.interactive&&l._containsPoint(o)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(l))&&(h=l);this._fireEvent(h?[h]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,o)}},_handleMouseOut:function(t){var o=this._hoveredLayer;o&&(ne(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,o){if(!this._mouseHoverThrottled){for(var l,h,_=this._drawFirst;_;_=_.next)l=_.layer,l.options.interactive&&l._containsPoint(o)&&(h=l);h!==this._hoveredLayer&&(this._handleMouseOut(t),h&&(It(this._container,"leaflet-interactive"),this._fireEvent([h],t,"mouseover"),this._hoveredLayer=h)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(u(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,o,l){this._map._fireDOMEvent(o,l||o.type,t)},_bringToFront:function(t){var o=t._order;if(o){var l=o.next,h=o.prev;if(l)l.prev=h;else return;h?h.next=l:l&&(this._drawFirst=l),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(t)}},_bringToBack:function(t){var o=t._order;if(o){var l=o.next,h=o.prev;if(h)h.next=l;else return;l?l.prev=h:h&&(this._drawLast=h),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(t)}}});function Is(t){return bt.canvas?new Ns(t):null}var Xi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Qa={_initContainer:function(){this._container=Ht("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ui.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var o=t._container=Xi("shape");It(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",t._path=Xi("path"),o.appendChild(t._path),this._updateStyle(t),this._layers[f(t)]=t},_addPath:function(t){var o=t._container;this._container.appendChild(o),t.options.interactive&&t.addInteractiveTarget(o)},_removePath:function(t){var o=t._container;te(o),t.removeInteractiveTarget(o),delete this._layers[f(t)]},_updateStyle:function(t){var o=t._stroke,l=t._fill,h=t.options,_=t._container;_.stroked=!!h.stroke,_.filled=!!h.fill,h.stroke?(o||(o=t._stroke=Xi("stroke")),_.appendChild(o),o.weight=h.weight+"px",o.color=h.color,o.opacity=h.opacity,h.dashArray?o.dashStyle=O(h.dashArray)?h.dashArray.join(" "):h.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=h.lineCap.replace("butt","flat"),o.joinstyle=h.lineJoin):o&&(_.removeChild(o),t._stroke=null),h.fill?(l||(l=t._fill=Xi("fill")),_.appendChild(l),l.color=h.fillColor||h.color,l.opacity=h.fillOpacity):l&&(_.removeChild(l),t._fill=null)},_updateCircle:function(t){var o=t._point.round(),l=Math.round(t._radius),h=Math.round(t._radiusY||l);this._setPath(t,t._empty()?"M0 0":"AL "+o.x+","+o.y+" "+l+","+h+" 0,"+65535*360)},_setPath:function(t,o){t._path.v=o},_bringToFront:function(t){En(t._container)},_bringToBack:function(t){Je(t._container)}},po=bt.vml?Xi:we,Yi=ui.extend({_initContainer:function(){this._container=po("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=po("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){te(this._container),Rt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ui.prototype._update.call(this);var t=this._bounds,o=t.getSize(),l=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,l.setAttribute("width",o.x),l.setAttribute("height",o.y)),Ze(l,t.min),l.setAttribute("viewBox",[t.min.x,t.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(t){var o=t._path=po("path");t.options.className&&It(o,t.options.className),t.options.interactive&&It(o,"leaflet-interactive"),this._updateStyle(t),this._layers[f(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){te(t._path),t.removeInteractiveTarget(t._path),delete this._layers[f(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var o=t._path,l=t.options;o&&(l.stroke?(o.setAttribute("stroke",l.color),o.setAttribute("stroke-opacity",l.opacity),o.setAttribute("stroke-width",l.weight),o.setAttribute("stroke-linecap",l.lineCap),o.setAttribute("stroke-linejoin",l.lineJoin),l.dashArray?o.setAttribute("stroke-dasharray",l.dashArray):o.removeAttribute("stroke-dasharray"),l.dashOffset?o.setAttribute("stroke-dashoffset",l.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),l.fill?(o.setAttribute("fill",l.fillColor||l.color),o.setAttribute("fill-opacity",l.fillOpacity),o.setAttribute("fill-rule",l.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(t,o){this._setPath(t,fe(t._parts,o))},_updateCircle:function(t){var o=t._point,l=Math.max(Math.round(t._radius),1),h=Math.max(Math.round(t._radiusY),1)||l,_="a"+l+","+h+" 0 1,0 ",v=t._empty()?"M0 0":"M"+(o.x-l)+","+o.y+_+l*2+",0 "+_+-l*2+",0 ";this._setPath(t,v)},_setPath:function(t,o){t._path.setAttribute("d",o)},_bringToFront:function(t){En(t._path)},_bringToBack:function(t){Je(t._path)}});bt.vml&&Yi.include(Qa);function xs(t){return bt.svg||bt.vml?new Yi(t):null}ge.include({getRenderer:function(t){var o=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var o=this._paneRenderers[t];return o===void 0&&(o=this._createRenderer({pane:t}),this._paneRenderers[t]=o),o},_createRenderer:function(t){return this.options.preferCanvas&&Is(t)||xs(t)}});var Os=Ei.extend({initialize:function(t,o){Ei.prototype.initialize.call(this,this._boundsToLatLngs(t),o)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=R(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function $a(t,o){return new Os(t,o)}Yi.create=po,Yi.pointsToPath=fe,ai.geometryToLayer=ao,ai.coordsToLatLng=Ro,ai.coordsToLatLngs=uo,ai.latLngToCoords=jo,ai.latLngsToCoords=co,ai.getFeature=Ai,ai.asFeature=ho,ge.mergeOptions({boxZoom:!0});var Bs=ti.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Dt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Rt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){te(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),oi(),Di(),this._startPoint=this._map.mouseEventToContainerPoint(t),Dt(document,{contextmenu:wi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=Ht("div","leaflet-zoom-box",this._container),It(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var o=new yt(this._point,this._startPoint),l=o.getSize();Ze(this._box,o.min),this._box.style.width=l.x+"px",this._box.style.height=l.y+"px"},_finish:function(){this._moved&&(te(this._box),ne(this._container,"leaflet-crosshair")),si(),Ri(),Rt(document,{contextmenu:wi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(u(this._resetState,this),0);var o=new _t(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ge.addInitHook("addHandler","boxZoom",Bs),ge.mergeOptions({doubleClickZoom:!0});var Zs=ti.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var o=this._map,l=o.getZoom(),h=o.options.zoomDelta,_=t.originalEvent.shiftKey?l-h:l+h;o.options.doubleClickZoom==="center"?o.setZoom(_):o.setZoomAround(t.containerPoint,_)}});ge.addInitHook("addHandler","doubleClickZoom",Zs),ge.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Ds=ti.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new di(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}It(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ne(this._map._container,"leaflet-grab"),ne(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=R(this._map.options.maxBounds);this._offsetLimit=Lt(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var o=this._lastTime=+new Date,l=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(l),this._times.push(o),this._prunePositions(o)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,o){return t-(t-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;t.x<o.min.x&&(t.x=this._viscousLimit(t.x,o.min.x)),t.y<o.min.y&&(t.y=this._viscousLimit(t.y,o.min.y)),t.x>o.max.x&&(t.x=this._viscousLimit(t.x,o.max.x)),t.y>o.max.y&&(t.y=this._viscousLimit(t.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,o=Math.round(t/2),l=this._initialWorldOffset,h=this._draggable._newPos.x,_=(h-o+l)%t+o-l,v=(h+o+l)%t-o-l,C=Math.abs(_+l)<Math.abs(v+l)?_:v;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=C},_onDragEnd:function(t){var o=this._map,l=o.options,h=!l.inertia||t.noInertia||this._times.length<2;if(o.fire("dragend",t),h)o.fire("moveend");else{this._prunePositions(+new Date);var _=this._lastPos.subtract(this._positions[0]),v=(this._lastTime-this._times[0])/1e3,C=l.easeLinearity,I=_.multiplyBy(C/v),D=I.distanceTo([0,0]),ut=Math.min(l.inertiaMaxSpeed,D),St=I.multiplyBy(ut/D),Vt=ut/(l.inertiaDeceleration*C),ce=St.multiplyBy(-Vt/2).round();!ce.x&&!ce.y?o.fire("moveend"):(ce=o._limitOffset(ce,o.options.maxBounds),lt(function(){o.panBy(ce,{duration:Vt,easeLinearity:C,noMoveStart:!0,animate:!0})}))}}});ge.addInitHook("addHandler","dragging",Ds),ge.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Rs=ti.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Dt(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Rt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,o=document.documentElement,l=t.scrollTop||o.scrollTop,h=t.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(h,l)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var o=this._panKeys={},l=this.keyCodes,h,_;for(h=0,_=l.left.length;h<_;h++)o[l.left[h]]=[-1*t,0];for(h=0,_=l.right.length;h<_;h++)o[l.right[h]]=[t,0];for(h=0,_=l.down.length;h<_;h++)o[l.down[h]]=[0,t];for(h=0,_=l.up.length;h<_;h++)o[l.up[h]]=[0,-1*t]},_setZoomDelta:function(t){var o=this._zoomKeys={},l=this.keyCodes,h,_;for(h=0,_=l.zoomIn.length;h<_;h++)o[l.zoomIn[h]]=t;for(h=0,_=l.zoomOut.length;h<_;h++)o[l.zoomOut[h]]=-t},_addHooks:function(){Dt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Rt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var o=t.keyCode,l=this._map,h;if(o in this._panKeys){if(!l._panAnim||!l._panAnim._inProgress)if(h=this._panKeys[o],t.shiftKey&&(h=st(h).multiplyBy(3)),l.options.maxBounds&&(h=l._limitOffset(st(h),l.options.maxBounds)),l.options.worldCopyJump){var _=l.wrapLatLng(l.unproject(l.project(l.getCenter()).add(h)));l.panTo(_)}else l.panBy(h)}else if(o in this._zoomKeys)l.setZoom(l.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&l._popup&&l._popup.options.closeOnEscapeKey)l.closePopup();else return;wi(t)}}});ge.addInitHook("addHandler","keyboard",Rs),ge.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var js=ti.extend({addHooks:function(){Dt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Rt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var o=cs(t),l=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var h=Math.max(l-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(u(this._performZoom,this),h),wi(t)},_performZoom:function(){var t=this._map,o=t.getZoom(),l=this._map.options.zoomSnap||0;t._stop();var h=this._delta/(this._map.options.wheelPxPerZoomLevel*4),_=4*Math.log(2/(1+Math.exp(-Math.abs(h))))/Math.LN2,v=l?Math.ceil(_/l)*l:_,C=t._limitZoom(o+(this._delta>0?v:-v))-o;this._delta=0,this._startTime=null,C&&(t.options.scrollWheelZoom==="center"?t.setZoom(o+C):t.setZoomAround(this._lastMousePos,o+C))}});ge.addInitHook("addHandler","scrollWheelZoom",js);var tu=600;ge.mergeOptions({tapHold:bt.touchNative&&bt.safari&&bt.mobile,tapTolerance:15});var Ws=ti.extend({addHooks:function(){Dt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Rt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var o=t.touches[0];this._startPos=this._newPos=new W(o.clientX,o.clientY),this._holdTimeout=setTimeout(u(function(){this._cancel(),this._isTapValid()&&(Dt(document,"touchend",zn),Dt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),tu),Dt(document,"touchend touchcancel contextmenu",this._cancel,this),Dt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){Rt(document,"touchend",zn),Rt(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),Rt(document,"touchend touchcancel contextmenu",this._cancel,this),Rt(document,"touchmove",this._onMove,this)},_onMove:function(t){var o=t.touches[0];this._newPos=new W(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,o){var l=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});l._simulated=!0,o.target.dispatchEvent(l)}});ge.addInitHook("addHandler","tapHold",Ws),ge.mergeOptions({touchZoom:bt.touch,bounceAtZoomLimits:!0});var Hs=ti.extend({addHooks:function(){It(this._map._container,"leaflet-touch-zoom"),Dt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ne(this._map._container,"leaflet-touch-zoom"),Rt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var o=this._map;if(!(!t.touches||t.touches.length!==2||o._animatingZoom||this._zooming)){var l=o.mouseEventToContainerPoint(t.touches[0]),h=o.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(l.add(h)._divideBy(2))),this._startDist=l.distanceTo(h),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),Dt(document,"touchmove",this._onTouchMove,this),Dt(document,"touchend touchcancel",this._onTouchEnd,this),zn(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var o=this._map,l=o.mouseEventToContainerPoint(t.touches[0]),h=o.mouseEventToContainerPoint(t.touches[1]),_=l.distanceTo(h)/this._startDist;if(this._zoom=o.getScaleZoom(_,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&_<1||this._zoom>o.getMaxZoom()&&_>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,_===1)return}else{var v=l._add(h)._divideBy(2)._subtract(this._centerPoint);if(_===1&&v.x===0&&v.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(v),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),N(this._animRequest);var C=u(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=lt(C,this,!0),zn(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,N(this._animRequest),Rt(document,"touchmove",this._onTouchMove,this),Rt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});ge.addInitHook("addHandler","touchZoom",Hs),ge.BoxZoom=Bs,ge.DoubleClickZoom=Zs,ge.Drag=Ds,ge.Keyboard=Rs,ge.ScrollWheelZoom=js,ge.TapHold=Ws,ge.TouchZoom=Hs,i.Bounds=yt,i.Browser=bt,i.CRS=K,i.Canvas=Ns,i.Circle=Do,i.CircleMarker=lo,i.Class=X,i.Control=Jn,i.DivIcon=Es,i.DivOverlay=ei,i.DomEvent=va,i.DomUtil=dn,i.Draggable=di,i.Evented=Q,i.FeatureGroup=ri,i.GeoJSON=ai,i.GridLayer=Vi,i.Handler=ti,i.Icon=Ti,i.ImageOverlay=fo,i.LatLng=U,i.LatLngBounds=_t,i.Layer=Qn,i.LayerGroup=Mi,i.LineUtil=za,i.Map=ge,i.Marker=ro,i.Mixin=Ca,i.Path=_i,i.Point=W,i.PolyUtil=Sa,i.Polygon=Ei,i.Polyline=li,i.Popup=_o,i.PosAnimation=hs,i.Projection=Na,i.Rectangle=Os,i.Renderer=ui,i.SVG=Yi,i.SVGOverlay=Ts,i.TileLayer=zi,i.Tooltip=mo,i.Transformation=Ct,i.Util=nt,i.VideoOverlay=Ms,i.bind=u,i.bounds=Lt,i.canvas=Is,i.circle=ja,i.circleMarker=Ra,i.control=Fi,i.divIcon=qa,i.extend=r,i.featureGroup=Ba,i.geoJSON=Ss,i.geoJson=Fa,i.gridLayer=Ka,i.icon=Za,i.imageOverlay=Ga,i.latLng=H,i.latLngBounds=R,i.layerGroup=Oa,i.map=ya,i.marker=Da,i.point=st,i.polygon=Ha,i.polyline=Wa,i.popup=Xa,i.rectangle=$a,i.setOptions=S,i.stamp=f,i.svg=xs,i.svgOverlay=Va,i.tileLayer=As,i.tooltip=Ya,i.transformation=Mt,i.version=s,i.videoOverlay=Ua;var eu=window.L;i.noConflict=function(){return window.L=eu,this},window.L=i})})(os,os.exports);var ci=os.exports;const{Map:oo}=du;function vl(n,e,i){const s=n.slice();return s[137]=e[i],s[139]=i,s}function yl(n,e,i){const s=n.slice();return s[140]=e[i],s[141]=e,s[142]=i,s}function wl(n,e,i){const s=n.slice();return s[143]=e[i],s}function bl(n,e,i){const s=n.slice();return s[146]=e[i],s}function Qo(n){const e=n.slice(),i=e[55](e[146].source);e[149]=i;const s=e[55](e[146].target);return e[150]=s,e}function kl(n,e,i){const s=n.slice();return s[151]=e[i],s[152]=e,s[153]=i,s}function Pl(n,e,i){const s=n.slice();return s[150]=e[i],s}function Ll(n,e,i){const s=n.slice();return s[158]=e[i],s}function Cl(n,e,i){const s=n.slice();return s[146]=e[i],s}function qf(n){let e=[],i=new oo,s,r=Ae(n[2]);const a=u=>u[146].id;for(let u=0;u<r.length;u+=1){let c=Cl(n,r,u),f=a(c);i.set(f,e[u]=Sl(f,c))}return{c(){for(let u=0;u<e.length;u+=1)e[u].c();s=ze()},m(u,c){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(u,c);G(u,s,c)},p(u,c){c[0]&4|c[1]&64&&(r=Ae(u[2]),e=hi(e,c,a,1,u,r,i,s.parentNode,Mo,Sl,s,Cl))},d(u){u&&F(s);for(let c=0;c<e.length;c+=1)e[c].d(u)}}}function Kf(n){let e;return{c(){e=M("div"),e.textContent="(none)",m(e,"class","muted small txt svelte-jiwe3x")},m(i,s){G(i,e,s)},p:Gt,d(i){i&&F(e)}}}function Sl(n,e){let i,s=e[146].source+"",r,a,u=e[146].target+"",c,f,d,p,g,k;function b(){return e[72](e[146])}return{key:n,first:null,c(){i=M("span"),r=re(s),a=re(""),c=re(u),f=V(),d=M("button"),d.textContent="",p=V(),m(d,"class","pill-x svelte-jiwe3x"),m(d,"aria-label","Remove edge"),m(i,"class","edge-pill svelte-jiwe3x"),m(i,"title","Click  to remove"),this.first=i},m(P,S){G(P,i,S),y(i,r),y(i,a),y(i,c),y(i,f),y(i,d),y(i,p),g||(k=ht(d,"click",b),g=!0)},p(P,S){e=P,S[0]&4&&s!==(s=e[146].source+"")&&an(r,s),S[0]&4&&u!==(u=e[146].target+"")&&an(c,u)},d(P){P&&F(i),g=!1,k()}}}function Ml(n){let e,i,s,r,a,u,c,f,d,p;return{c(){e=M("div"),i=M("span"),s=re("connecting from "),r=M("code"),a=re(n[5]),u=re("  click a nodes  to finish"),c=V(),f=M("button"),f.textContent="cancel",m(i,"class","txt svelte-jiwe3x"),m(f,"class","pill-x svelte-jiwe3x"),m(e,"class","pending small svelte-jiwe3x")},m(g,k){G(g,e,k),y(e,i),y(i,s),y(i,r),y(r,a),y(i,u),y(e,c),y(e,f),d||(p=ht(f,"click",n[44]),d=!0)},p(g,k){k[0]&32&&an(a,g[5])},d(g){g&&F(e),d=!1,p()}}}function Jf(n){let e,i=[],s=new oo,r=Ae(n[35]);const a=u=>u[158].id;for(let u=0;u<r.length;u+=1){let c=Ll(n,r,u),f=a(c);s.set(f,i[u]=Tl(f,c))}return{c(){e=M("div");for(let u=0;u<i.length;u+=1)i[u].c();m(e,"class","tool-list svelte-jiwe3x")},m(u,c){G(u,e,c);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null)},p(u,c){c[1]&1644167184|c[2]&1&&(r=Ae(u[35]),i=hi(i,c,a,1,u,r,s,e,Mo,Tl,null,Ll))},d(u){u&&F(e);for(let c=0;c<i.length;c+=1)i[c].d()}}}function Qf(n){let e;return{c(){e=M("div"),e.textContent="(no scheduled jobs)",m(e,"class","muted small txt svelte-jiwe3x")},m(i,s){G(i,e,s)},p:Gt,d(i){i&&F(e)}}}function Tl(n,e){let i,s,r,a,u=ql(e[158].next_run_time)+"",c,f,d,p,g,k,b,P,S,z,A,E,O,Z,Y,j;function tt(){return e[73](e[158])}function J(){return e[74](e[158])}function et(){return e[75](e[158])}function ot(){return e[76](e[158])}function lt(){return e[77](e[158])}return{key:n,first:null,c(){i=M("div"),s=M("div"),r=M("div"),a=M("time"),c=re(u),d=V(),p=M("div"),g=M("button"),g.textContent="Run now",k=V(),b=M("button"),b.textContent="Pause",P=V(),S=M("button"),S.textContent="Resume",z=V(),A=M("button"),A.textContent="Logs",E=V(),O=M("button"),O.textContent="Delete",Z=V(),m(a,"datetime",f=e[158].next_run_time),m(r,"class","schedule-date svelte-jiwe3x"),m(s,"class","schedule-head svelte-jiwe3x"),m(g,"class","pill-x svelte-jiwe3x"),m(g,"title","Run now"),m(b,"class","pill-x svelte-jiwe3x"),m(b,"title","Pause"),m(S,"class","pill-x svelte-jiwe3x"),m(S,"title","Resume"),m(A,"class","pill-x svelte-jiwe3x"),m(A,"title","Logs"),m(O,"class","pill-x svelte-jiwe3x"),m(O,"title","Delete"),m(p,"class","schedule-actions svelte-jiwe3x"),m(i,"class","tool schedule-card svelte-jiwe3x"),this.first=i},m(N,nt){G(N,i,nt),y(i,s),y(s,r),y(r,a),y(a,c),y(i,d),y(i,p),y(p,g),y(p,k),y(p,b),y(p,P),y(p,S),y(p,z),y(p,A),y(p,E),y(p,O),y(i,Z),Y||(j=[ht(g,"click",tt),ht(b,"click",J),ht(S,"click",et),ht(A,"click",ot),ht(O,"click",lt)],Y=!0)},p(N,nt){e=N,nt[1]&16&&u!==(u=ql(e[158].next_run_time)+"")&&an(c,u),nt[1]&16&&f!==(f=e[158].next_run_time)&&m(a,"datetime",f)},d(N){N&&F(i),Y=!1,$e(j)}}}function El(n){let e,i=n[150].name+"",s,r;return{c(){e=M("option"),s=re(i),e.__value=r=n[150].name,Le(e,e.__value)},m(a,u){G(a,e,u),y(e,s)},p(a,u){u[0]&64&&i!==(i=a[150].name+"")&&an(s,i),u[0]&64&&r!==(r=a[150].name)&&(e.__value=r,Le(e,e.__value))},d(a){a&&F(e)}}}function $f(n){let e,i,s=n[151].label+"",r,a,u,c,f,d,p,g,k,b,P,S,z,A,E,O,Z,Y,j,tt,J;function et(){return n[78](n[151])}function ot(){return n[79](n[151])}function lt(){return n[80](n[151])}let N=Ae(n[6]),nt=[];for(let At=0;At<N.length;At+=1)nt[At]=El(Pl(n,N,At));function X(){n[81].call(P,n[153])}function ct(){return n[82](n[153],n[151])}function dt(){return n[83](n[151])}function Q(){return n[84](n[151],n[153])}function W(){return n[85](n[151])}return{c(){e=M("div"),i=M("div"),r=re(s),a=V(),u=M("button"),c=V(),f=M("button"),p=V(),g=M("button"),g.textContent="",k=V(),b=M("div"),P=M("select");for(let At=0;At<nt.length;At+=1)nt[At].c();S=V(),z=M("button"),z.textContent="",A=V(),E=M("button"),E.textContent="",O=V(),Z=M("button"),Z.textContent="",j=V(),m(i,"class","node-title svelte-jiwe3x"),m(u,"class","dot in svelte-jiwe3x"),m(u,"title","input"),m(f,"class","dot out svelte-jiwe3x"),m(f,"title","output"),m(f,"aria-pressed",d=n[5]===n[151].id),m(g,"class","node-del svelte-jiwe3x"),m(g,"title","delete node"),m(P,"class","svelte-jiwe3x"),n[1][n[153]].type===void 0&&vi(X),m(z,"class","edit-btn svelte-jiwe3x"),m(E,"class","preview-btn svelte-jiwe3x"),m(E,"title","Preview on map"),m(Z,"class","runone-btn svelte-jiwe3x"),m(Z,"title","Run this node only"),m(b,"class","node-config svelte-jiwe3x"),m(e,"class","node svelte-jiwe3x"),m(e,"aria-selected",Y=n[154]?"true":"false")},m(At,st){G(At,e,st),y(e,i),y(i,r),y(e,a),y(e,u),y(e,c),y(e,f),y(e,p),y(e,g),y(e,k),y(e,b),y(b,P);for(let yt=0;yt<nt.length;yt+=1)nt[yt]&&nt[yt].m(P,null);gi(P,n[1][n[153]].type,!0),y(b,S),y(b,z),y(b,A),y(b,E),y(b,O),y(b,Z),G(At,j,st),tt||(J=[ht(u,"click",et),ht(f,"click",ot),ht(g,"click",lt),ht(P,"change",X),ht(P,"change",ct),ht(z,"click",dt),ht(E,"click",Q),ht(Z,"click",W),pi(n[155].call(null,e))],tt=!0)},p(At,st){if(n=At,st[0]&2&&s!==(s=n[151].label+"")&&an(r,s),st[0]&98&&d!==(d=n[5]===n[151].id)&&m(f,"aria-pressed",d),st[0]&64){N=Ae(n[6]);let yt;for(yt=0;yt<N.length;yt+=1){const Lt=Pl(n,N,yt);nt[yt]?nt[yt].p(Lt,st):(nt[yt]=El(Lt),nt[yt].c(),nt[yt].m(P,null))}for(;yt<nt.length;yt+=1)nt[yt].d(1);nt.length=N.length}st[0]&66&&gi(P,n[1][n[153]].type),st[4]&1073741824&&Y!==(Y=n[154]?"true":"false")&&m(e,"aria-selected",Y)},d(At){At&&(F(e),F(j)),Li(nt,At),tt=!1,$e(J)}}}function Al(n,e){let i,s,r,a;function u(f){e[86](f,e[153])}let c={id:e[151].id,width:ma,height:pa,$$slots:{default:[$f,({selected:f,grabHandle:d})=>({154:f,155:d}),({selected:f,grabHandle:d})=>[0,0,0,0,f?1073741824:0,d?1:0]]},$$scope:{ctx:e}};return e[1][e[153]].position!==void 0&&(c.position=e[1][e[153]].position),s=new ls({props:c}),Xn.push(()=>ku(s,"position",u)),{key:n,first:null,c(){i=ze(),he(s.$$.fragment),this.first=i},m(f,d){G(f,i,d),le(s,f,d),a=!0},p(f,d){e=f;const p={};d[0]&2&&(p.id=e[151].id),d[0]&122|d[4]&1073741824|d[5]&256&&(p.$$scope={dirty:d,ctx:e}),!r&&d[0]&2&&(r=!0,p.position=e[1][e[153]].position,yu(()=>r=!1)),s.$set(p)},i(f){a||(B(s.$$.fragment,f),a=!0)},o(f){q(s.$$.fragment,f),a=!1},d(f){f&&F(i),ae(s,f)}}}function zl(n){let e,i;return{c(){e=ee("path"),m(e,"d",i=`M ${n[47](n[149])} ${n[48](n[149])}
                        C ${n[47](n[149])+60} ${n[48](n[149])},
                          ${n[46](n[150])-60} ${n[48](n[150])},
                          ${n[46](n[150])} ${n[48](n[150])}`),m(e,"class","cable svelte-jiwe3x"),m(e,"marker-end","url(#arrow)")},m(s,r){G(s,e,r)},p(s,r){r[0]&4&&i!==(i=`M ${s[47](s[149])} ${s[48](s[149])}
                        C ${s[47](s[149])+60} ${s[48](s[149])},
                          ${s[46](s[150])-60} ${s[48](s[150])},
                          ${s[46](s[150])} ${s[48](s[150])}`)&&m(e,"d",i)},d(s){s&&F(e)}}}function Nl(n,e){let i,s=e[36](e[146].source)&&e[36](e[146].target),r,a=s&&zl(Qo(e));return{key:n,first:null,c(){i=ze(),a&&a.c(),r=ze(),this.first=i},m(u,c){G(u,i,c),a&&a.m(u,c),G(u,r,c)},p(u,c){e=u,c[0]&4&&(s=e[36](e[146].source)&&e[36](e[146].target)),s?a?a.p(Qo(e),c):(a=zl(Qo(e)),a.c(),a.m(r.parentNode,r)):a&&(a.d(1),a=null)},d(u){u&&(F(i),F(r)),a&&a.d(u)}}}function Il(n){let e,i,s,r=[],a=new oo,u,c=Ae(n[2]);const f=d=>d[146].id;for(let d=0;d<c.length;d+=1){let p=bl(n,c,d),g=f(p);a.set(g,r[d]=Nl(g,p))}return{c(){e=ee("defs"),i=ee("marker"),s=ee("path");for(let d=0;d<r.length;d+=1)r[d].c();u=ze(),m(s,"d","M 0 0 L 10 5 L 0 10 z"),m(i,"id","arrow"),m(i,"viewBox","0 0 10 10"),m(i,"refX","9"),m(i,"refY","5"),m(i,"markerWidth","6"),m(i,"markerHeight","6"),m(i,"orient","auto-start-reverse")},m(d,p){G(d,e,p),y(e,i),y(i,s);for(let g=0;g<r.length;g+=1)r[g]&&r[g].m(d,p);G(d,u,p)},p(d,p){p[0]&4|p[1]&17006624&&(c=Ae(d[2]),r=hi(r,p,f,1,d,c,a,u.parentNode,Mo,Nl,u,bl))},d(d){d&&(F(e),F(u));for(let p=0;p<r.length;p+=1)r[p].d(d)}}}function td(n){let e=[],i=new oo,s,r,a=n[15],u,c,f=Ae(n[1]);const d=g=>g[151].id;for(let g=0;g<f.length;g+=1){let k=kl(n,f,g),b=d(k);i.set(b,e[g]=Al(b,k))}let p=Il(n);return{c(){for(let g=0;g<e.length;g+=1)e[g].c();s=V(),r=ee("svg"),p.c(),m(r,"class","edges-overlay svelte-jiwe3x"),m(r,"viewBox",u=`0 0 ${n[17]} ${n[18]}`),m(r,"preserveAspectRatio","none")},m(g,k){for(let b=0;b<e.length;b+=1)e[b]&&e[b].m(g,k);G(g,s,k),G(g,r,k),p.m(r,null),c=!0},p(g,k){k[0]&122|k[1]&5249408|k[4]&1073741824&&(f=Ae(g[1]),ve(),e=hi(e,k,d,1,g,f,i,s.parentNode,eo,Al,s,kl),ye()),k[0]&32768&&un(a,a=g[15])?(p.d(1),p=Il(g),p.c(),p.m(r,null)):p.p(g,k),(!c||k[0]&393216&&u!==(u=`0 0 ${g[17]} ${g[18]}`))&&m(r,"viewBox",u)},i(g){if(!c){for(let k=0;k<f.length;k+=1)B(e[k]);c=!0}},o(g){for(let k=0;k<e.length;k+=1)q(e[k]);c=!1},d(g){g&&(F(s),F(r));for(let k=0;k<e.length;k+=1)e[k].d(g);p.d(g)}}}function xl(n){let e,i,s,r,a,u,c=n[21].label+"",f,d,p,g,k,b,P,S,z,A,E,O,Z,Y;function j(et,ot){return et[25]?ed:nd}let tt=j(n),J=tt(n);return{c(){e=M("div"),i=V(),s=M("div"),r=M("div"),a=M("h3"),u=re("Edit Args  "),f=re(c),d=V(),p=M("div"),g=M("button"),g.textContent="Form",k=V(),b=M("button"),b.textContent="Advanced JSON",P=V(),J.c(),S=V(),z=M("div"),A=M("button"),A.textContent="Cancel",E=V(),O=M("button"),O.textContent="Save",m(e,"class","modal-backdrop svelte-jiwe3x"),m(a,"class","svelte-jiwe3x"),m(g,"class","svelte-jiwe3x"),$t(g,"seg-active",!n[25]),m(b,"class","svelte-jiwe3x"),$t(b,"seg-active",n[25]),m(p,"class","seg svelte-jiwe3x"),m(r,"class","modal-head svelte-jiwe3x"),m(A,"class","btn svelte-jiwe3x"),m(O,"class","btn primary svelte-jiwe3x"),m(z,"class","modal-actions svelte-jiwe3x"),m(s,"class","modal svelte-jiwe3x")},m(et,ot){G(et,e,ot),G(et,i,ot),G(et,s,ot),y(s,r),y(r,a),y(a,u),y(a,f),y(r,d),y(r,p),y(p,g),y(p,k),y(p,b),y(s,P),J.m(s,null),y(s,S),y(s,z),y(z,A),y(z,E),y(z,O),Z||(Y=[ht(e,"click",n[90]),ht(g,"click",n[91]),ht(b,"click",n[92]),ht(A,"click",n[100]),ht(O,"click",n[54]),ht(s,"click",Wn(n[66]))],Z=!0)},p(et,ot){ot[0]&2097152&&c!==(c=et[21].label+"")&&an(f,c),ot[0]&33554432&&$t(g,"seg-active",!et[25]),ot[0]&33554432&&$t(b,"seg-active",et[25]),tt===(tt=j(et))&&J?J.p(et,ot):(J.d(1),J=tt(et),J&&(J.c(),J.m(s,S)))},d(et){et&&(F(e),F(i),F(s)),J.d(),Z=!1,$e(Y)}}}function ed(n){let e,i,s;return{c(){e=M("textarea"),m(e,"class","json-area svelte-jiwe3x")},m(r,a){G(r,e,a),Le(e,n[22]),i||(s=ht(e,"input",n[99]),i=!0)},p(r,a){a[0]&4194304&&Le(e,r[22])},d(r){r&&F(e),i=!1,s()}}}function nd(n){let e,i=Ae(n[23]),s=[];for(let r=0;r<i.length;r+=1)s[r]=Bl(yl(n,i,r));return{c(){e=M("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","form-grid svelte-jiwe3x")},m(r,a){G(r,e,a);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null)},p(r,a){if(a[0]&25165824){i=Ae(r[23]);let u;for(u=0;u<i.length;u+=1){const c=yl(r,i,u);s[u]?s[u].p(c,a):(s[u]=Bl(c),s[u].c(),s[u].m(e,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=i.length}},d(r){r&&F(e),Li(s,r)}}}function id(n){let e,i,s,r=Ae(Yl(n[140])),a=[];for(let c=0;c<r.length;c+=1)a[c]=Ol(wl(n,r,c));function u(){n[98].call(e,n[140])}return{c(){e=M("select");for(let c=0;c<a.length;c+=1)a[c].c();m(e,"class","svelte-jiwe3x"),n[24][n[140].key]===void 0&&vi(u)},m(c,f){G(c,e,f);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(e,null);gi(e,n[24][n[140].key],!0),i||(s=ht(e,"change",u),i=!0)},p(c,f){if(n=c,f[0]&8388608){r=Ae(Yl(n[140]));let d;for(d=0;d<r.length;d+=1){const p=wl(n,r,d);a[d]?a[d].p(p,f):(a[d]=Ol(p),a[d].c(),a[d].m(e,null))}for(;d<a.length;d+=1)a[d].d(1);a.length=r.length}f[0]&25165824&&gi(e,n[24][n[140].key])},d(c){c&&F(e),Li(a,c),i=!1,s()}}}function od(n){let e,i,s,r,a,u=Xl(n[140])+"",c,f,d;function p(){n[97].call(e,n[140])}return{c(){e=M("input"),s=V(),r=M("small"),a=re("Comma-separated "),c=re(u),m(e,"type","text"),m(e,"placeholder",i=Vl(n[140])),m(e,"class","svelte-jiwe3x"),m(r,"class","muted svelte-jiwe3x")},m(g,k){G(g,e,k),Le(e,n[24][n[140].key]),G(g,s,k),G(g,r,k),y(r,a),y(r,c),f||(d=ht(e,"input",p),f=!0)},p(g,k){n=g,k[0]&8388608&&i!==(i=Vl(n[140]))&&m(e,"placeholder",i),k[0]&25165824&&e.value!==n[24][n[140].key]&&Le(e,n[24][n[140].key]),k[0]&8388608&&u!==(u=Xl(n[140])+"")&&an(c,u)},d(g){g&&(F(e),F(s),F(r)),f=!1,d()}}}function sd(n){let e,i,s,r,a;function u(){n[96].call(e,n[140])}return{c(){e=M("textarea"),m(e,"rows",i=Gl(n[140])),m(e,"placeholder",s=Ul(n[140])),m(e,"class","svelte-jiwe3x")},m(c,f){G(c,e,f),Le(e,n[24][n[140].key]),r||(a=ht(e,"input",u),r=!0)},p(c,f){n=c,f[0]&8388608&&i!==(i=Gl(n[140]))&&m(e,"rows",i),f[0]&8388608&&s!==(s=Ul(n[140]))&&m(e,"placeholder",s),f[0]&25165824&&Le(e,n[24][n[140].key])},d(c){c&&F(e),r=!1,a()}}}function rd(n){let e,i,s,r,a,u;function c(){n[95].call(i,n[140])}return{c(){e=M("label"),i=M("input"),s=V(),r=M("span"),m(i,"type","checkbox"),m(i,"class","svelte-jiwe3x"),m(e,"class","switch svelte-jiwe3x")},m(f,d){G(f,e,d),y(e,i),i.checked=n[24][n[140].key],y(e,s),y(e,r),a||(u=ht(i,"change",c),a=!0)},p(f,d){n=f,d[0]&25165824&&(i.checked=n[24][n[140].key])},d(f){f&&F(e),a=!1,u()}}}function ld(n){let e,i,s,r;function a(){n[94].call(e,n[140])}return{c(){e=M("input"),m(e,"type","number"),m(e,"step",i=n[140].step??1),m(e,"class","svelte-jiwe3x")},m(u,c){G(u,e,c),Le(e,n[24][n[140].key]),s||(r=ht(e,"input",a),s=!0)},p(u,c){n=u,c[0]&8388608&&i!==(i=n[140].step??1)&&m(e,"step",i),c[0]&25165824&&mi(e.value)!==n[24][n[140].key]&&Le(e,n[24][n[140].key])},d(u){u&&F(e),s=!1,r()}}}function ad(n){let e,i,s,r;function a(){n[93].call(e,n[140])}return{c(){e=M("input"),m(e,"type","text"),m(e,"placeholder",i=n[140].placeholder??""),m(e,"class","svelte-jiwe3x")},m(u,c){G(u,e,c),Le(e,n[24][n[140].key]),s||(r=ht(e,"input",a),s=!0)},p(u,c){n=u,c[0]&8388608&&i!==(i=n[140].placeholder??"")&&m(e,"placeholder",i),c[0]&25165824&&e.value!==n[24][n[140].key]&&Le(e,n[24][n[140].key])},d(u){u&&F(e),s=!1,r()}}}function Ol(n){let e,i=n[143]+"",s,r;return{c(){e=M("option"),s=re(i),e.__value=r=n[143],Le(e,e.__value)},m(a,u){G(a,e,u),y(e,s)},p(a,u){u[0]&8388608&&i!==(i=a[143]+"")&&an(s,i),u[0]&8388608&&r!==(r=a[143])&&(e.__value=r,Le(e,e.__value))},d(a){a&&F(e)}}}function Bl(n){let e,i,s=n[140].label+"",r,a,u;function c(p,g){if(p[140].type==="string")return ad;if(p[140].type==="number")return ld;if(p[140].type==="boolean")return rd;if(p[140].type==="textarea")return sd;if(p[140].type==="array")return od;if(p[140].type==="select")return id}let f=c(n),d=f&&f(n);return{c(){e=M("div"),i=M("label"),r=re(s),a=V(),d&&d.c(),u=V(),m(i,"class","svelte-jiwe3x"),m(e,"class","form-row svelte-jiwe3x")},m(p,g){G(p,e,g),y(e,i),y(i,r),y(e,a),d&&d.m(e,null),y(e,u)},p(p,g){g[0]&8388608&&s!==(s=p[140].label+"")&&an(r,s),f===(f=c(p))&&d?d.p(p,g):(d&&d.d(1),d=f&&f(p),d&&(d.c(),d.m(e,u)))},d(p){p&&F(e),d&&d.d()}}}function Zl(n){let e,i,s,r,a,u,c,f,d,p,g,k,b,P,S,z,A,E,O,Z,Y=n[33]?"Scheduling":"Create schedule",j,tt,J;function et(nt,X){return nt[27]==="once"?hd:nt[27]==="interval"?cd:ud}let ot=et(n),lt=ot(n),N=n[34]&&Dl(n);return{c(){e=M("div"),i=V(),s=M("div"),r=M("div"),r.innerHTML='<h3 class="svelte-jiwe3x">Schedule Pipeline (active connected graph)</h3>',a=V(),u=M("div"),c=M("div"),f=M("label"),f.textContent="Mode",d=V(),p=M("select"),g=M("option"),g.textContent="Once",k=M("option"),k.textContent="Interval",b=M("option"),b.textContent="Cron",P=V(),lt.c(),S=V(),N&&N.c(),z=V(),A=M("div"),E=M("button"),E.textContent="Cancel",O=V(),Z=M("button"),j=re(Y),m(e,"class","modal-backdrop svelte-jiwe3x"),m(r,"class","modal-head svelte-jiwe3x"),m(f,"class","svelte-jiwe3x"),g.__value="once",Le(g,g.__value),k.__value="interval",Le(k,k.__value),b.__value="cron",Le(b,b.__value),m(p,"class","svelte-jiwe3x"),n[27]===void 0&&vi(()=>n[102].call(p)),m(c,"class","form-row svelte-jiwe3x"),m(u,"class","form-grid svelte-jiwe3x"),m(E,"class","btn svelte-jiwe3x"),m(Z,"class","btn primary svelte-jiwe3x"),Z.disabled=n[33],m(A,"class","modal-actions svelte-jiwe3x"),m(s,"class","modal svelte-jiwe3x")},m(nt,X){G(nt,e,X),G(nt,i,X),G(nt,s,X),y(s,r),y(s,a),y(s,u),y(u,c),y(c,f),y(c,d),y(c,p),y(p,g),y(p,k),y(p,b),gi(p,n[27],!0),y(u,P),lt.m(u,null),y(u,S),N&&N.m(u,null),y(s,z),y(s,A),y(A,E),y(A,O),y(A,Z),y(Z,j),tt||(J=[ht(e,"click",n[101]),ht(p,"change",n[102]),ht(E,"click",n[108]),ht(Z,"click",n[58]),ht(s,"click",Wn(n[65]))],tt=!0)},p(nt,X){X[0]&134217728&&gi(p,nt[27]),ot===(ot=et(nt))&&lt?lt.p(nt,X):(lt.d(1),lt=ot(nt),lt&&(lt.c(),lt.m(u,S))),nt[34]?N?N.p(nt,X):(N=Dl(nt),N.c(),N.m(u,null)):N&&(N.d(1),N=null),X[1]&4&&Y!==(Y=nt[33]?"Scheduling":"Create schedule")&&an(j,Y),X[1]&4&&(Z.disabled=nt[33])},d(nt){nt&&(F(e),F(i),F(s)),lt.d(),N&&N.d(),tt=!1,$e(J)}}}function ud(n){let e,i,s,r,a,u,c,f;return{c(){e=M("div"),i=M("label"),i.textContent="Cron (UTC)",s=V(),r=M("input"),a=V(),u=M("small"),u.innerHTML="Example: <code>0 5 * * *</code> = 05:00 UTC daily",m(i,"class","svelte-jiwe3x"),m(r,"type","text"),m(r,"placeholder","0 5 * * *"),m(r,"class","svelte-jiwe3x"),m(u,"class","muted svelte-jiwe3x"),m(e,"class","form-row svelte-jiwe3x")},m(d,p){G(d,e,p),y(e,i),y(e,s),y(e,r),Le(r,n[32]),y(e,a),y(e,u),c||(f=ht(r,"input",n[107]),c=!0)},p(d,p){p[1]&2&&r.value!==d[32]&&Le(r,d[32])},d(d){d&&F(e),c=!1,f()}}}function cd(n){let e,i,s,r,a,u,c,f,d,p,g,k,b;return{c(){e=M("div"),i=M("label"),i.textContent="Interval",s=V(),r=M("div"),a=M("input"),u=V(),c=M("input"),f=V(),d=M("input"),p=V(),g=M("small"),g.textContent="At least one of hours/minutes/seconds must be > 0.",m(i,"class","svelte-jiwe3x"),m(a,"type","number"),m(a,"min","0"),m(a,"placeholder","hours"),m(a,"class","svelte-jiwe3x"),m(c,"type","number"),m(c,"min","0"),m(c,"placeholder","minutes"),m(c,"class","svelte-jiwe3x"),m(d,"type","number"),m(d,"min","0"),m(d,"placeholder","seconds"),m(d,"class","svelte-jiwe3x"),at(r,"display","grid"),at(r,"grid-template-columns","repeat(3, 1fr)"),at(r,"gap","8px"),m(g,"class","muted svelte-jiwe3x"),m(e,"class","form-row svelte-jiwe3x")},m(P,S){G(P,e,S),y(e,i),y(e,s),y(e,r),y(r,a),Le(a,n[29]),y(r,u),y(r,c),Le(c,n[30]),y(r,f),y(r,d),Le(d,n[31]),y(e,p),y(e,g),k||(b=[ht(a,"input",n[104]),ht(c,"input",n[105]),ht(d,"input",n[106])],k=!0)},p(P,S){S[0]&536870912&&mi(a.value)!==P[29]&&Le(a,P[29]),S[0]&1073741824&&mi(c.value)!==P[30]&&Le(c,P[30]),S[1]&1&&mi(d.value)!==P[31]&&Le(d,P[31])},d(P){P&&F(e),k=!1,$e(b)}}}function hd(n){let e,i,s,r,a,u,c,f;return{c(){e=M("div"),i=M("label"),i.textContent="Date & time (your local)",s=V(),r=M("input"),a=V(),u=M("small"),u.textContent="Stored & executed in UTC on the server.",m(i,"class","svelte-jiwe3x"),m(r,"type","datetime-local"),m(u,"class","muted svelte-jiwe3x"),m(e,"class","form-row svelte-jiwe3x")},m(d,p){G(d,e,p),y(e,i),y(e,s),y(e,r),Le(r,n[28]),y(e,a),y(e,u),c||(f=ht(r,"input",n[103]),c=!0)},p(d,p){p[0]&268435456&&Le(r,d[28])},d(d){d&&F(e),c=!1,f()}}}function Dl(n){let e,i,s;return{c(){e=M("div"),i=M("div"),s=re(n[34]),m(i,"class","muted svelte-jiwe3x"),at(i,"color","#ffb4b4"),m(e,"class","form-row svelte-jiwe3x")},m(r,a){G(r,e,a),y(e,i),y(i,s)},p(r,a){a[1]&8&&an(s,r[34])},d(r){r&&F(e)}}}function Rl(n){let e,i,s,r,a,u,c,f,d,p,g,k,b,P,S,z,A,E,O,Z,Y,j,tt,J,et,ot,lt,N,nt,X,ct,dt,Q,W,At,st,yt,Lt,_t,R,U,H,K,Nt;function Wt(Ot,zt){return Ot[14].available?dd:fd}let rt=Wt(n),Ct=rt(n);function Mt(Ot,zt){return Ot[12]==="pipeline"?md:_d}let xt=Mt(n),qt=xt(n);function we(Ot,zt){return Ot[13]?gd:pd}let fe=we(n),$=fe(n);return{c(){e=M("div"),i=V(),s=M("div"),r=M("div"),a=M("h3"),a.textContent="AI Assistant",u=V(),c=M("div"),Ct.c(),f=V(),d=M("div"),p=M("div"),g=M("label"),g.textContent="Generation Type",k=V(),b=M("select"),P=M("option"),P.textContent="Full Pipeline",S=M("option"),S.textContent="Single Node",z=V(),A=M("div"),E=M("label"),E.textContent="Describe what you want to create:",O=V(),Z=M("textarea"),Y=V(),j=M("small"),qt.c(),tt=V(),J=M("br"),et=re("Press Ctrl/Cmd+Enter to generate"),ot=V(),lt=M("div"),N=M("div"),nt=M("span"),nt.textContent="Examples:",X=V(),ct=M("div"),dt=M("button"),dt.textContent="NDVI Analysis",Q=V(),W=M("button"),W.textContent="Water Detection",At=V(),st=M("button"),st.textContent="PCA Analysis",yt=V(),Lt=M("div"),_t=M("button"),_t.textContent="Cancel",R=V(),U=M("button"),$.c(),m(e,"class","modal-backdrop svelte-jiwe3x"),m(a,"class","svelte-jiwe3x"),m(c,"class","ai-status svelte-jiwe3x"),m(r,"class","modal-head svelte-jiwe3x"),m(g,"class","svelte-jiwe3x"),P.__value="pipeline",Le(P,P.__value),S.__value="node",Le(S,S.__value),m(b,"class","svelte-jiwe3x"),n[12]===void 0&&vi(()=>n[110].call(b)),m(p,"class","form-row svelte-jiwe3x"),m(E,"class","svelte-jiwe3x"),m(Z,"rows","4"),m(Z,"placeholder","Example: Create a workflow to calculate NDVI from Landsat imagery, or Add a node to filter raster data by threshold"),m(Z,"class","svelte-jiwe3x"),m(j,"class","muted svelte-jiwe3x"),m(A,"class","form-row svelte-jiwe3x"),m(nt,"class","examples-label svelte-jiwe3x"),m(dt,"class","example-chip svelte-jiwe3x"),m(W,"class","example-chip svelte-jiwe3x"),m(st,"class","example-chip svelte-jiwe3x"),m(ct,"class","example-chips svelte-jiwe3x"),m(N,"class","ai-examples svelte-jiwe3x"),m(lt,"class","form-row svelte-jiwe3x"),m(d,"class","form-grid svelte-jiwe3x"),m(_t,"class","btn svelte-jiwe3x"),m(U,"class","btn primary ai-generate-btn svelte-jiwe3x"),U.disabled=H=!n[11].trim()||n[13],m(Lt,"class","modal-actions svelte-jiwe3x"),m(s,"class","modal ai-modal svelte-jiwe3x")},m(Ot,zt){G(Ot,e,zt),G(Ot,i,zt),G(Ot,s,zt),y(s,r),y(r,a),y(r,u),y(r,c),Ct.m(c,null),y(s,f),y(s,d),y(d,p),y(p,g),y(p,k),y(p,b),y(b,P),y(b,S),gi(b,n[12],!0),y(d,z),y(d,A),y(A,E),y(A,O),y(A,Z),Le(Z,n[11]),y(A,Y),y(A,j),qt.m(j,null),y(j,tt),y(j,J),y(j,et),y(d,ot),y(d,lt),y(lt,N),y(N,nt),y(N,X),y(N,ct),y(ct,dt),y(ct,Q),y(ct,W),y(ct,At),y(ct,st),y(s,yt),y(s,Lt),y(Lt,_t),y(Lt,R),y(Lt,U),$.m(U,null),K||(Nt=[ht(e,"click",n[109]),ht(b,"change",n[110]),ht(Z,"input",n[111]),ht(Z,"keydown",n[112]),ht(dt,"click",n[113]),ht(W,"click",n[114]),ht(st,"click",n[115]),ht(_t,"click",n[116]),ht(U,"click",n[45]),ht(s,"click",Wn(n[64]))],K=!0)},p(Ot,zt){rt===(rt=Wt(Ot))&&Ct?Ct.p(Ot,zt):(Ct.d(1),Ct=rt(Ot),Ct&&(Ct.c(),Ct.m(c,null))),zt[0]&4096&&gi(b,Ot[12]),zt[0]&2048&&Le(Z,Ot[11]),xt!==(xt=Mt(Ot))&&(qt.d(1),qt=xt(Ot),qt&&(qt.c(),qt.m(j,tt))),fe===(fe=we(Ot))&&$?$.p(Ot,zt):($.d(1),$=fe(Ot),$&&($.c(),$.m(U,null))),zt[0]&10240&&H!==(H=!Ot[11].trim()||Ot[13])&&(U.disabled=H)},d(Ot){Ot&&(F(e),F(i),F(s)),Ct.d(),qt.d(),$.d(),K=!1,$e(Nt)}}}function fd(n){let e,i,s;return{c(){e=M("span"),i=V(),s=M("span"),s.textContent="Demo Mode (OLLAMA/OpenAI not configured)",m(e,"class","status-indicator demo svelte-jiwe3x"),m(s,"class","status-text svelte-jiwe3x")},m(r,a){G(r,e,a),G(r,i,a),G(r,s,a)},p:Gt,d(r){r&&(F(e),F(i),F(s))}}}function dd(n){let e,i,s,r=n[14].provider+"",a,u,c=n[14].model+"",f,d;return{c(){e=M("span"),i=V(),s=M("span"),a=re(r),u=re(" ("),f=re(c),d=re(")"),m(e,"class","status-indicator success svelte-jiwe3x"),m(s,"class","status-text svelte-jiwe3x")},m(p,g){G(p,e,g),G(p,i,g),G(p,s,g),y(s,a),y(s,u),y(s,f),y(s,d)},p(p,g){g[0]&16384&&r!==(r=p[14].provider+"")&&an(a,r),g[0]&16384&&c!==(c=p[14].model+"")&&an(f,c)},d(p){p&&(F(e),F(i),F(s))}}}function _d(n){let e;return{c(){e=re('Describe a single processing step (e.g., "calculate vegetation index")')},m(i,s){G(i,e,s)},d(i){i&&F(e)}}}function md(n){let e;return{c(){e=re('Describe a complete workflow (e.g., "analyze forest cover change using NDVI")')},m(i,s){G(i,e,s)},d(i){i&&F(e)}}}function pd(n){let e,i=n[12]==="pipeline"?"Pipeline":"Node",s,r,a,u=!n[14].available&&jl();return{c(){e=re(" Generate "),s=re(i),r=V(),u&&u.c(),a=ze()},m(c,f){G(c,e,f),G(c,s,f),G(c,r,f),u&&u.m(c,f),G(c,a,f)},p(c,f){f[0]&4096&&i!==(i=c[12]==="pipeline"?"Pipeline":"Node")&&an(s,i),c[14].available?u&&(u.d(1),u=null):u||(u=jl(),u.c(),u.m(a.parentNode,a))},d(c){c&&(F(e),F(s),F(r),F(a)),u&&u.d(c)}}}function gd(n){let e,i,s,r;return{c(){e=ee("svg"),i=ee("circle"),s=ee("path"),r=re(`
            Generating...`),m(i,"cx","12"),m(i,"cy","12"),m(i,"r","10"),m(i,"stroke","currentColor"),m(i,"stroke-width","2"),m(i,"fill","none"),m(i,"opacity","0.3"),m(s,"d","M2 12a10 10 0 0 1 10-10"),m(s,"stroke","currentColor"),m(s,"stroke-width","2"),m(s,"fill","none"),m(s,"stroke-linecap","round"),m(e,"class","spinner svelte-jiwe3x"),m(e,"viewBox","0 0 24 24"),m(e,"width","16"),m(e,"height","16")},m(a,u){G(a,e,u),y(e,i),y(e,s),G(a,r,u)},p:Gt,d(a){a&&(F(e),F(r))}}}function jl(n){let e;return{c(){e=re("(Demo)")},m(i,s){G(i,e,s)},d(i){i&&F(e)}}}function vd(n){let e,i=[],s=new oo,r=Ae(n[7]);const a=u=>u[139];for(let u=0;u<r.length;u+=1){let c=vl(n,r,u),f=a(c);s.set(f,i[u]=Wl(f,c))}return{c(){e=M("ul");for(let u=0;u<i.length;u+=1)i[u].c();m(e,"class","svelte-jiwe3x")},m(u,c){G(u,e,c);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null)},p(u,c){c[0]&128&&(r=Ae(u[7]),i=hi(i,c,a,1,u,r,s,e,Mo,Wl,null,vl))},d(u){u&&F(e);for(let c=0;c<i.length;c+=1)i[c].d()}}}function yd(n){let e;return{c(){e=M("div"),e.textContent="No logs yet. Run the pipeline to see Python prints/stdout.",m(e,"class","muted small svelte-jiwe3x")},m(i,s){G(i,e,s)},p:Gt,d(i){i&&F(e)}}}function Wl(n,e){let i,s,r=e[137].nodeId+"",a,u,c=e[137].text+"",f,d,p;return{key:n,first:null,c(){i=M("li"),s=M("code"),a=re(r),u=re("  "),f=re(c),d=V(),m(s,"class","svelte-jiwe3x"),m(i,"class",p=Xs(e[137].ok?"ok":"err")+" svelte-jiwe3x"),this.first=i},m(g,k){G(g,i,k),y(i,s),y(s,a),y(i,u),y(i,f),y(i,d)},p(g,k){e=g,k[0]&128&&r!==(r=e[137].nodeId+"")&&an(a,r),k[0]&128&&c!==(c=e[137].text+"")&&an(f,c),k[0]&128&&p!==(p=Xs(e[137].ok?"ok":"err")+" svelte-jiwe3x")&&m(i,"class",p)},d(g){g&&F(i)}}}function wd(n){let e,i,s,r,a,u,c,f,d,p,g,k,b,P,S,z,A,E,O,Z,Y,j,tt,J,et,ot,lt,N,nt,X,ct,dt,Q=n[0]==="dark"?"Dark":"Light",W,At,st,yt,Lt,_t,R,U,H,K,Nt,Wt,rt,Ct,Mt,xt,qt,we,fe,$=n[8]?"Running":"Run",Ot,zt,Tt,Ft,Ut,xe,Ke,De,Yt,Re,ie,tn,be,pe,Ee,je,We,en,ke,He,jt,Ge,Ye,bn,nn,on,Oe,Fe,gn,ue,de,qe,kn,vn,Nn,Mn,Be,bt,yn,wn,cn,Pn,w,mt,Pt,kt,Et,x,Kt,_e,Jt,Pe,sn,Ue,Ln,Cn,Yn,Dn,Tn,Ve,Rn,$n;function gt(Zt,se){return Zt[2].length===0?Kf:qf}let Ht=gt(n),te=Ht(n),Ne=n[5]&&Ml(n);function En(Zt,se){return Zt[35].length===0?Qf:Jf}let Je=En(n),oe=Je(n);bt=new Xf({props:{width:n[17],height:n[18],theme:n[0],$$slots:{default:[td]},$$scope:{ctx:n}}});let It=n[21]&&xl(n),ne=n[26]&&Zl(n),rn=n[10]&&Rl(n);function Fn(Zt,se){return Zt[7].length===0?yd:vd}let ln=Fn(n),An=ln(n);return{c(){e=M("div"),i=M("header"),s=M("div"),r=M("button"),r.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',a=V(),u=M("div"),u.innerHTML='<span class="title svelte-jiwe3x">SATERYS</span>',c=V(),f=M("div"),f.innerHTML='<div class="hint svelte-jiwe3x">Build pipelines  click a nodes  /  to connect</div>',d=V(),p=M("div"),g=M("button"),k=ee("svg"),b=ee("path"),P=V(),S=M("span"),S.textContent="Run",A=V(),E=M("button"),E.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M8 7V4m8 3V4M5 11h14M7 21h10a2 2 0 002-2V8a2 2 0 00-2-2H7a2 2 0 00-2 2v11a2 2 0 002 2zm5-6v-3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span>Schedule</span>',O=V(),Z=M("button"),Z.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2zm2 4l3 3-3 3m5 0h5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Logs</span>',Y=V(),j=M("button"),tt=ee("svg"),J=ee("path"),et=V(),ot=M("span"),ot.textContent="Layers",lt=V(),N=M("button"),nt=ee("svg"),X=ee("path"),ct=V(),dt=M("span"),W=re(Q),At=V(),st=M("button"),st.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span>Add</span>',yt=V(),Lt=M("button"),Lt.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M12 2l3.09 6.26L22 9l-5 4.74L18.18 22 12 18.27 5.82 22 7 13.74 2 9l6.91-.74L12 2z" stroke="currentColor" stroke-width="2" fill="none"></path></svg> <span>AI Prompt</span>',_t=V(),R=M("div"),U=M("aside"),H=M("div"),K=M("div"),K.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M5 12h14M12 5v14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span class="txt svelte-jiwe3x">Tools</span>',Nt=V(),Wt=M("div"),rt=M("button"),rt.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span class="txt svelte-jiwe3x">Add Node</span>',Ct=V(),Mt=M("button"),xt=ee("svg"),qt=ee("path"),we=V(),fe=M("span"),Ot=re($),zt=V(),Tt=M("button"),Ft=ee("svg"),Ut=ee("path"),xe=V(),Ke=M("span"),Ke.textContent="Clear Layers",De=V(),Yt=M("button"),Re=ee("svg"),ie=ee("path"),tn=V(),be=M("span"),pe=re("Theme: "),Ee=re(n[0]),je=V(),We=M("button"),We.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M12 2l3.09 6.26L22 9l-5 4.74L18.18 22 12 18.27 5.82 22 7 13.74 2 9l6.91-.74L12 2z" stroke="currentColor" stroke-width="2" fill="none"></path></svg> <span class="txt svelte-jiwe3x">AI Prompt</span>',en=V(),ke=M("div"),He=M("div"),He.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 12l7-7 4 4 7-7" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span class="txt svelte-jiwe3x">Edges</span>',jt=V(),Ge=M("div"),te.c(),Ye=V(),Ne&&Ne.c(),bn=V(),nn=M("div"),on=M("div"),Oe=ee("svg"),Fe=ee("path"),gn=V(),ue=M("span"),ue.textContent="Schedules",de=V(),qe=M("button"),qe.textContent="",kn=V(),oe.c(),Nn=V(),Mn=M("div"),Be=M("div"),he(bt.$$.fragment),yn=V(),wn=M("div"),cn=M("div"),w=V(),It&&It.c(),mt=V(),ne&&ne.c(),Pt=V(),rn&&rn.c(),kt=V(),Et=M("div"),x=M("div"),Kt=M("div"),Kt.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2zm2 4l3 3-3 3m5 0h5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Pipeline Logs</span>',_e=V(),Jt=M("div"),Pe=M("button"),Pe.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M9 9h11v11H9zM5 5h11v11" stroke="currentColor" stroke-width="2" fill="none"></path></svg>',sn=V(),Ue=M("button"),Ue.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 6h18M9 6v12m6-12v12M5 6l1-3h12l1 3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',Ln=V(),Cn=M("button"),Cn.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M6 6l12 12M6 18L18 6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',Yn=V(),Dn=M("div"),An.c(),m(r,"class","icon-btn ghost svelte-jiwe3x"),m(r,"title","Toggle sidebar"),m(u,"class","brand svelte-jiwe3x"),m(s,"class","left svelte-jiwe3x"),m(f,"class","center svelte-jiwe3x"),m(b,"d","M8 5v14l11-7z"),m(b,"fill","currentColor"),m(k,"viewBox","0 0 24 24"),m(k,"width","18"),m(k,"height","18"),m(g,"class","icon-btn svelte-jiwe3x"),m(g,"title",z=n[8]?"Running":"Run pipeline"),g.disabled=n[8],m(E,"class","icon-btn svelte-jiwe3x"),m(E,"title","Schedule pipeline"),m(Z,"class","icon-btn svelte-jiwe3x"),m(Z,"title","Toggle logs"),m(J,"d","M12 3l9 5-9 5-9-5 9-5zm0 8l9 5-9 5-9-5"),m(J,"stroke","currentColor"),m(J,"stroke-width","2"),m(J,"fill","none"),m(J,"stroke-linejoin","round"),m(tt,"viewBox","0 0 24 24"),m(tt,"width","18"),m(tt,"height","18"),m(j,"class","icon-btn svelte-jiwe3x"),m(j,"title","Clear map layers"),j.disabled=n[49].size===0,m(X,"d","M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"),m(X,"stroke","currentColor"),m(X,"stroke-width","2"),m(X,"fill","none"),m(nt,"viewBox","0 0 24 24"),m(nt,"width","18"),m(nt,"height","18"),m(N,"class","icon-btn svelte-jiwe3x"),m(N,"title","Toggle theme"),m(st,"class","icon-btn primary svelte-jiwe3x"),m(st,"title","Add node"),m(Lt,"class","icon-btn ai svelte-jiwe3x"),m(Lt,"title","AI Prompt"),m(p,"class","right svelte-jiwe3x"),m(i,"class","topbar glass svelte-jiwe3x"),m(K,"class","section-title svelte-jiwe3x"),m(rt,"class","tool svelte-jiwe3x"),m(rt,"title","Add node"),m(qt,"d","M8 5v14l11-7z"),m(qt,"fill","currentColor"),m(xt,"viewBox","0 0 24 24"),m(xt,"width","16"),m(xt,"height","16"),m(fe,"class","txt svelte-jiwe3x"),m(Mt,"class","tool svelte-jiwe3x"),Mt.disabled=n[8],m(Mt,"title","Run pipeline"),m(Ut,"d","M12 3l9 5-9 5-9-5 9-5zm0 8l9 5-9 5-9-5"),m(Ut,"stroke","currentColor"),m(Ut,"stroke-width","2"),m(Ut,"fill","none"),m(Ut,"stroke-linejoin","round"),m(Ft,"viewBox","0 0 24 24"),m(Ft,"width","16"),m(Ft,"height","16"),m(Ke,"class","txt svelte-jiwe3x"),m(Tt,"class","tool svelte-jiwe3x"),Tt.disabled=n[49].size===0,m(Tt,"title","Clear overlay layers"),m(ie,"d","M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"),m(ie,"stroke","currentColor"),m(ie,"stroke-width","2"),m(ie,"fill","none"),m(Re,"viewBox","0 0 24 24"),m(Re,"width","16"),m(Re,"height","16"),m(be,"class","txt svelte-jiwe3x"),m(Yt,"class","tool svelte-jiwe3x"),m(Yt,"title","Toggle theme"),m(We,"class","tool svelte-jiwe3x"),m(We,"title","AI Prompt"),m(Wt,"class","tool-list svelte-jiwe3x"),m(H,"class","section"),m(He,"class","section-title svelte-jiwe3x"),m(Ge,"class","edge-chips svelte-jiwe3x"),m(ke,"class","section"),m(Fe,"d","M6 6h12v12H6zM9 3h6M3 9h6M15 21h6M3 15h6"),m(Fe,"stroke","currentColor"),m(Fe,"stroke-width","2"),m(Fe,"fill","none"),m(Fe,"stroke-linecap","round"),m(Oe,"viewBox","0 0 24 24"),m(Oe,"width","16"),m(Oe,"height","16"),m(ue,"class","txt svelte-jiwe3x"),m(qe,"class","pill-x svelte-jiwe3x"),m(qe,"title","Refresh"),m(on,"class","section-title svelte-jiwe3x"),m(nn,"class","section"),m(U,"class","sidebar svelte-jiwe3x"),m(U,"data-collapsed",vn=n[9]?"true":"false"),m(cn,"class","map svelte-jiwe3x"),m(wn,"class","right svelte-jiwe3x"),m(Be,"class","split svelte-jiwe3x"),m(Mn,"class","work svelte-jiwe3x"),m(R,"class","main svelte-jiwe3x"),m(R,"data-collapsed",Pn=n[9]?"true":"false"),m(Kt,"class","logs-title svelte-jiwe3x"),m(Pe,"class","icon-btn svelte-jiwe3x"),m(Pe,"title","Copy all"),m(Ue,"class","icon-btn svelte-jiwe3x"),m(Ue,"title","Clear"),m(Cn,"class","icon-btn svelte-jiwe3x"),m(Cn,"title","Close"),m(Jt,"class","logs-actions svelte-jiwe3x"),m(x,"class","logs-header svelte-jiwe3x"),m(Dn,"class","logs-body svelte-jiwe3x"),m(Et,"class","logs-drawer svelte-jiwe3x"),m(Et,"data-open",Tn=n[4]?"true":"false"),m(e,"class","app-root svelte-jiwe3x")},m(Zt,se){G(Zt,e,se),y(e,i),y(i,s),y(s,r),y(s,a),y(s,u),y(i,c),y(i,f),y(i,d),y(i,p),y(p,g),y(g,k),y(k,b),y(g,P),y(g,S),y(p,A),y(p,E),y(p,O),y(p,Z),y(p,Y),y(p,j),y(j,tt),y(tt,J),y(j,et),y(j,ot),y(p,lt),y(p,N),y(N,nt),y(nt,X),y(N,ct),y(N,dt),y(dt,W),y(p,At),y(p,st),y(p,yt),y(p,Lt),y(e,_t),y(e,R),y(R,U),y(U,H),y(H,K),y(H,Nt),y(H,Wt),y(Wt,rt),y(Wt,Ct),y(Wt,Mt),y(Mt,xt),y(xt,qt),y(Mt,we),y(Mt,fe),y(fe,Ot),y(Wt,zt),y(Wt,Tt),y(Tt,Ft),y(Ft,Ut),y(Tt,xe),y(Tt,Ke),y(Wt,De),y(Wt,Yt),y(Yt,Re),y(Re,ie),y(Yt,tn),y(Yt,be),y(be,pe),y(be,Ee),y(Wt,je),y(Wt,We),y(U,en),y(U,ke),y(ke,He),y(ke,jt),y(ke,Ge),te.m(Ge,null),y(ke,Ye),Ne&&Ne.m(ke,null),y(U,bn),y(U,nn),y(nn,on),y(on,Oe),y(Oe,Fe),y(on,gn),y(on,ue),y(on,de),y(on,qe),y(nn,kn),oe.m(nn,null),y(R,Nn),y(R,Mn),y(Mn,Be),le(bt,Be,null),y(Be,yn),y(Be,wn),y(wn,cn),n[87](cn),n[88](wn),n[89](Be),y(e,w),It&&It.m(e,null),y(e,mt),ne&&ne.m(e,null),y(e,Pt),rn&&rn.m(e,null),y(e,kt),y(e,Et),y(Et,x),y(x,Kt),y(x,_e),y(x,Jt),y(Jt,Pe),y(Jt,sn),y(Jt,Ue),y(Jt,Ln),y(Jt,Cn),y(Et,Yn),y(Et,Dn),An.m(Dn,null),Ve=!0,Rn||($n=[ht(r,"click",n[50]),ht(g,"click",n[40]),ht(E,"click",n[57]),ht(Z,"click",n[67]),ht(j,"click",n[52]),ht(N,"click",n[68]),ht(st,"click",n[41]),ht(Lt,"click",n[69]),ht(rt,"click",n[41]),ht(Mt,"click",n[40]),ht(Tt,"click",n[52]),ht(Yt,"click",n[70]),ht(We,"click",n[71]),ht(qe,"click",n[59]),ht(Pe,"click",n[117]),ht(Ue,"click",n[118]),ht(Cn,"click",n[119])],Rn=!0)},p(Zt,se){(!Ve||se[0]&256&&z!==(z=Zt[8]?"Running":"Run pipeline"))&&m(g,"title",z),(!Ve||se[0]&256)&&(g.disabled=Zt[8]),(!Ve||se[0]&1)&&Q!==(Q=Zt[0]==="dark"?"Dark":"Light")&&an(W,Q),(!Ve||se[0]&256)&&$!==($=Zt[8]?"Running":"Run")&&an(Ot,$),(!Ve||se[0]&256)&&(Mt.disabled=Zt[8]),(!Ve||se[0]&1)&&an(Ee,Zt[0]),Ht===(Ht=gt(Zt))&&te?te.p(Zt,se):(te.d(1),te=Ht(Zt),te&&(te.c(),te.m(Ge,null))),Zt[5]?Ne?Ne.p(Zt,se):(Ne=Ml(Zt),Ne.c(),Ne.m(ke,null)):Ne&&(Ne.d(1),Ne=null),Je===(Je=En(Zt))&&oe?oe.p(Zt,se):(oe.d(1),oe=Je(Zt),oe&&(oe.c(),oe.m(nn,null))),(!Ve||se[0]&512&&vn!==(vn=Zt[9]?"true":"false"))&&m(U,"data-collapsed",vn);const Ze={};se[0]&131072&&(Ze.width=Zt[17]),se[0]&262144&&(Ze.height=Zt[18]),se[0]&1&&(Ze.theme=Zt[0]),se[0]&426110|se[5]&256&&(Ze.$$scope={dirty:se,ctx:Zt}),bt.$set(Ze),(!Ve||se[0]&512&&Pn!==(Pn=Zt[9]?"true":"false"))&&m(R,"data-collapsed",Pn),Zt[21]?It?It.p(Zt,se):(It=xl(Zt),It.c(),It.m(e,mt)):It&&(It.d(1),It=null),Zt[26]?ne?ne.p(Zt,se):(ne=Zl(Zt),ne.c(),ne.m(e,Pt)):ne&&(ne.d(1),ne=null),Zt[10]?rn?rn.p(Zt,se):(rn=Rl(Zt),rn.c(),rn.m(e,kt)):rn&&(rn.d(1),rn=null),ln===(ln=Fn(Zt))&&An?An.p(Zt,se):(An.d(1),An=ln(Zt),An&&(An.c(),An.m(Dn,null))),(!Ve||se[0]&16&&Tn!==(Tn=Zt[4]?"true":"false"))&&m(Et,"data-open",Tn)},i(Zt){Ve||(B(bt.$$.fragment,Zt),Ve=!0)},o(Zt){q(bt.$$.fragment,Zt),Ve=!1},d(Zt){Zt&&F(e),te.d(),Ne&&Ne.d(),oe.d(),ae(bt),n[87](null),n[88](null),n[89](null),It&&It.d(),ne&&ne.d(),rn&&rn.d(),An.d(),Rn=!1,$e($n)}}}const ma=230,pa=80,bd=200,kd=200,Hl=50;function Pd(n){const e=[];if(!n||typeof n!="object")return e;for(const[i,s]of Object.entries(n))typeof s=="string"?e.push({key:i,label:i,type:"string"}):typeof s=="number"?e.push({key:i,label:i,type:"number"}):typeof s=="boolean"?e.push({key:i,label:i,type:"boolean"}):Array.isArray(s)?e.push({key:i,label:i,type:"array",itemType:typeof s[0]=="number"?"number":"string"}):e.push({key:i,label:i,type:"textarea"});return e}function Ld(n,e){const i=n.map(f=>f.id),s=new Set(i),r=new Map,a=new Map;for(const f of i)r.set(f,[]),a.set(f,0);for(const f of e)!s.has(f.source)||!s.has(f.target)||(r.get(f.source).push(f.target),a.set(f.target,(a.get(f.target)||0)+1));const u=[];for(const f of i)(a.get(f)||0)===0&&u.push(f);const c=[];for(;u.length;){const f=u.shift();c.push(f);for(const d of r.get(f))a.set(d,(a.get(d)||0)-1),(a.get(d)||0)===0&&u.push(d)}return c}async function Fl(n,e={}){return await(await fetch("/run_node",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nodeId:n.id,type:n.type,args:n.args??{},inputs:e})})).json().catch(()=>({ok:!1,error:"Bad JSON"}))}function Cd(n,e,i){const s=[];for(const r of n){const a=e.findIndex(c=>c.id===r.source),u=e.findIndex(c=>c.id===r.target);if(a>=0&&u>=0){const c=`ai_${i+a}`,f=`ai_${i+u}`;s.push({sourceId:c,targetId:f})}}return s}function Gl(n){return n.rows??6}function Ul(n){return n.placeholder??""}function Vl(n){return n.hint??"comma-separated"}function Xl(n){return n.itemType??"values"}function Yl(n){return n.options??[]}function ql(n){return n?new Date(n).toLocaleString():""}async function Sd(n){await fetch(`/pipeline/schedules/${n}/run-now`,{method:"POST"}).catch(()=>{})}function Md(n,e,i){let s="dark",r=[],a=1,u=[],c=1,f=null,d={},p=[{name:"hello",default_args:{name:"world"}},{name:"sum",default_args:{nums:[1,2,3]}},{name:"script",default_args:{code:"print('hello')"}},{name:"raster.input",default_args:{path:""}}];Hn(async()=>{try{const ft=await(await fetch("/node_types")).json();Array.isArray(ft==null?void 0:ft.types)&&i(6,p=ft.types)}catch{}});const g={hello:[{key:"name",label:"Name",type:"string",placeholder:"world"}],sum:[{key:"nums",label:"Numbers",type:"array",itemType:"number",hint:"e.g., 1,2,3"}],script:[{key:"code",label:"Code",type:"textarea",rows:8,placeholder:"print('hello')"}],"raster.input":[{key:"path",label:"Raster path",type:"string",placeholder:"/path/to.tif"}]};function k(T){var Qt;const ft=g[T];if(ft)return ft;const vt=(Qt=p.find(Xt=>Xt.name===T))==null?void 0:Qt.default_args;return Pd(vt??{})}const b=T=>r.find(ft=>ft.id===T);function P(T,ft){!b(T)||!b(ft)||T===ft||u.some(vt=>vt.source===T&&vt.target===ft)||i(2,u=[...u,{id:`e${c++}`,source:T,target:ft}])}function S(T){i(2,u=u.filter(ft=>ft.id!==T))}function z(T){if(Wt.has(T)&&Nt&&rt){const ft=Wt.get(T);Nt.removeLayer(ft),rt.removeLayer(ft),Wt.delete(T)}i(1,r=r.filter(ft=>ft.id!==T)),delete d[T]}function A(){const T=new Set;for(const Xt of u)T.add(Xt.source),T.add(Xt.target);const ft=r.filter(Xt=>T.has(Xt.id)),vt=new Set(ft.map(Xt=>Xt.id)),Qt=u.filter(Xt=>vt.has(Xt.source)&&vt.has(Xt.target));return{activeNodes:ft,activeEdges:Qt}}let E=[],O=!1,Z={},Y=!1,j=!1,tt=!1,J="",et="pipeline",ot=!1,lt={available:!1,provider:null,model:null};Hn(async()=>{try{const ft=await(await fetch("/ai/status")).json();i(14,lt=ft)}catch(T){console.warn("Failed to check AI status:",T),i(14,lt={available:!1,provider:null,model:null,error:"Service check failed"})}});function N(T,ft,vt){i(7,E=[...E,{nodeId:T,ok:ft,text:vt}]),Y&&requestAnimationFrame(()=>{const Qt=document.querySelector(".logs-body");Qt&&(Qt.scrollTop=Qt.scrollHeight)})}async function nt(){var Xt;i(8,O=!0),i(7,E=[]),Z={},i(4,Y=!0);const{activeNodes:T,activeEdges:ft}=A();if(T.length===0){N("system",!1,"No connected nodes to run."),i(8,O=!1);return}const vt=Ld(T,ft);vt.length!==T.length&&N("system",!1,"Warning: cycle detected; running partial order.");const Qt={};for(const dn of ft)(Qt[Xt=dn.target]??(Qt[Xt]=[])).push(dn.source);for(const dn of vt){const Dt=b(dn),hn={};for(const Rt of Qt[dn]??[])hn[Rt]=Z[Rt];N(dn,!0," Running");try{const Rt=await Fl(Dt,hn);if(Array.isArray(Rt==null?void 0:Rt.logs))for(const In of Rt.logs)N(dn,!0,String(In));if(typeof(Rt==null?void 0:Rt.stdout)=="string"&&Rt.stdout.trim())for(const In of Rt.stdout.split(/\r?\n/))In.trim()&&N(dn,!0,In);if(Rt!=null&&Rt.ok){const In=Rt.output??{};Z[dn]=In;const yi=typeof In=="string"?In:In.text??JSON.stringify(In);N(dn,!0,` ${yi}`)}else N(dn,!1,` ${(Rt==null?void 0:Rt.error)||"Unknown error"}`)}catch(Rt){N(dn,!1,` Exception: ${(Rt==null?void 0:Rt.message)||Rt}`)}}i(8,O=!1)}function X(){const T=`n${a++}`,ft=p[0]||{name:"hello",default_args:{name:T}},vt=120+r.length%6*260,Qt=140+Math.floor(r.length/6)*140,Xt=JSON.parse(JSON.stringify(ft.default_args||{})),dn=`${ft.name} (${T})`;i(1,r=[...r,{id:T,position:{x:vt,y:Qt},label:dn,type:ft.name,args:Xt}]),i(3,d[T]=JSON.stringify(Xt,null,2),d)}function ct(T){i(5,f=T)}function dt(T){f&&P(f,T),i(5,f=null)}function Q(){i(5,f=null)}async function W(){if(!(!J.trim()||ot)){i(13,ot=!0);try{const ft=await(await fetch("/ai/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:J.trim(),type:et,position:{x:bd+r.length*Hl,y:kd+r.length*Hl}})})).json();if(ft.success){let vt=a;const Qt=vt;for(const Dt of ft.nodes){const hn=`ai_${vt++}`,Rt={id:hn,position:Dt.position,label:Dt.label||`${Dt.type} (${hn})`,type:Dt.type,args:Dt.args||{}};i(1,r=[...r,Rt]),i(3,d[hn]=JSON.stringify(Rt.args,null,2),d)}a=vt;const Xt=Cd(ft.edges,ft.nodes,Qt);for(const{sourceId:Dt,targetId:hn}of Xt)P(Dt,hn);const dn=lt.available?"":" (Demo)";N("ai",!0,`${dn} Generated ${ft.nodes.length} node(s): ${ft.description}`),i(4,Y=!0),i(11,J=""),i(10,tt=!1)}else N("ai",!1,` AI generation failed: ${ft.error}`),i(4,Y=!0)}catch(T){N("ai",!1,` AI request failed: ${(T==null?void 0:T.message)||T}`),i(4,Y=!0)}finally{i(13,ot=!1)}}}const At=T=>T.position.x,st=T=>T.position.x+ma,yt=T=>T.position.y+pa/2;let Lt="",_t=null,R=1200,U=650,H=null;function K(){_t&&(H&&H.disconnect(),H=new ResizeObserver(()=>{_t&&(i(17,R=Math.max(320,Math.floor(_t.clientWidth-1))),i(18,U=Math.max(240,Math.floor(_t.clientHeight-1))))}),H.observe(_t))}let Nt=null,Wt=new Map,rt=null,Ct=null,Mt=null,xt=null;function qt(){!Nt||!Mt||(xt&&xt.disconnect(),xt=new ResizeObserver(()=>{requestAnimationFrame(()=>Nt&&Nt.invalidateSize())}),xt.observe(Mt))}function we(){i(9,j=!j),requestAnimationFrame(()=>Nt==null?void 0:Nt.invalidateSize())}Hn(()=>{let T=!1;const ft=()=>Nt&&Nt.invalidateSize();return Promise.resolve().then(async()=>{if(await ea(),!T&&(K(),!Nt&&Ct)){Nt=ci.map(Ct,{zoomControl:!0,attributionControl:!1}).setView([0,0],2);const vt={" OpenStreetMap":ci.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{opacity:.9,minZoom:1,maxZoom:22,attribution:" OpenStreetMap contributors"})," OSM (Dark-ish)":ci.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",{opacity:.95,minZoom:1,maxZoom:22,attribution:" OpenStreetMap,  CartoDB"})," Esri World Imagery":ci.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{opacity:1,minZoom:1,maxZoom:19,attribution:"Tiles  Esri"})," Carto Positron":ci.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{opacity:.95,minZoom:1,maxZoom:22,attribution:" OpenStreetMap,  CartoDB"})," OpenTopoMap":ci.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{opacity:.95,minZoom:1,maxZoom:17,attribution:" OpenStreetMap,  OpenTopoMap"})};vt[" Esri World Imagery"].addTo(Nt),rt=ci.control.layers(vt,{},{position:"topright",collapsed:!1}),rt.addTo(Nt),qt(),window.addEventListener("resize",ft)}}),()=>{T=!0,window.removeEventListener("resize",ft),xt==null||xt.disconnect(),H==null||H.disconnect()}});function fe(T,ft){var Qt;const vt=Z[T.id];return vt&&typeof vt=="object"&&vt.type==="raster"&&vt.path?vt.path:T.type==="raster.input"&&typeof((Qt=r[ft].args)==null?void 0:Qt.path)=="string"?r[ft].args.path:null}async function $(T,ft){if(!Nt||!rt){alert("Map not ready yet.");return}const vt=fe(T,ft);if(!vt){alert("No raster path available. Run the pipeline or set args.path for raster.input.");return}const Qt=T.id;await fetch("/preview/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:Qt,path:vt})});const Xt=`/preview/tile/${Qt}/{z}/{x}/{y}.png`,dn=`${T.label} (${T.id})`;if(Wt.has(Qt)){const Gn=Wt.get(Qt);Nt.removeLayer(Gn),rt.removeLayer(Gn),Wt.delete(Qt)}const Dt=ci.tileLayer(Xt,{tms:!1,opacity:.8,maxZoom:22});Wt.set(Qt,Dt),Dt.addTo(Nt),rt.addOverlay(Dt,dn);const hn=await fetch(`/preview/bounds/${Qt}`).then(Gn=>Gn.json()),[Rt,In,yi,ji]=hn.bounds,Wi=ci.latLngBounds([In,Rt],[ji,yi]);Nt.fitBounds(Wi,{padding:[10,10]})}function Ot(){if(!(!Nt||!rt)){for(const[,T]of Wt)Nt.removeLayer(T),rt.removeLayer(T);Wt.clear()}}let zt=null,Tt="",Ft=[],Ut={},xe=!1;function Ke(T){var Qt;i(21,zt=T),i(23,Ft=k(T.type)),i(24,Ut={});const vt={...((Qt=p.find(Xt=>Xt.name===T.type))==null?void 0:Qt.default_args)??{},...T.args??{}};for(const Xt of Ft)i(24,Ut[Xt.key]=vt[Xt.key],Ut);i(22,Tt=JSON.stringify(T.args??{},null,2)),i(25,xe=!1)}function De(){if(!zt)return;const T={};for(const ft of Ft){let vt=Ut[ft.key];if(ft.type==="number"&&(vt=Number(vt)),ft.type==="array"){if(Array.isArray(vt))T[ft.key]=vt;else if(typeof vt=="string"){const Qt=vt.split(",").map(Xt=>Xt.trim()).filter(Boolean);T[ft.key]=ft.itemType==="number"?Qt.map(Number):Qt}else T[ft.key]=[];continue}ft.type==="boolean"&&(vt=!!vt),T[ft.key]=vt}i(21,zt.args=T,zt),i(3,d[zt.id]=JSON.stringify(T,null,2),d)}function Yt(){if(zt)if(xe)try{const T=JSON.parse(Tt||"{}");i(21,zt.args=T,zt),i(3,d[zt.id]=JSON.stringify(T,null,2),d),i(21,zt=null)}catch{alert("Invalid JSON")}else De(),i(21,zt=null)}const Re=T=>{const ft=r.find(vt=>vt.id===T);if(!ft)throw new Error(`Node not found: ${T}`);return ft};let ie=null;async function tn(T){i(4,Y=!0),i(7,E=[]),await be(T),ie&&clearInterval(ie),i(63,ie=setInterval(()=>be(T),1e3))}async function be(T){try{const ft=await fetch(`/pipeline/schedules/${T}/runs`).then(Xt=>Xt.json());if(!Array.isArray(ft)||ft.length===0){i(7,E=[{nodeId:"system",ok:!0,text:"(no runs yet)"}]);return}const vt=ft[0],Qt=await fetch(`/pipeline/schedules/runs/${vt.id}`).then(Xt=>Xt.json());i(7,E=Qt.logs.map(Xt=>({nodeId:Qt.status==="running"?"run":Qt.status==="success"?"ok":"err",ok:!/|exception/i.test(Xt),text:Xt}))),Qt.status!=="running"&&ie&&(clearInterval(ie),i(63,ie=null))}catch{i(7,E=[{nodeId:"system",ok:!1,text:"Failed to fetch run logs"}])}}io(()=>{ie&&clearInterval(ie)});let pe=!1,Ee="once",je="",We=0,en=0,ke=0,He="0 5 * * *",jt=!1,Ge="",Ye=[];function bn(){const{activeNodes:T}=A();if(T.length===0){alert("No connected nodes to schedule. Connect nodes with edges first.");return}i(26,pe=!0),i(27,Ee="once"),i(28,je=""),i(29,We=i(30,en=i(31,ke=0))),i(32,He="0 5 * * *"),i(34,Ge="")}function nn(){const{activeNodes:T,activeEdges:ft}=A(),vt=T.map(Xt=>({id:Xt.id,type:Xt.type,args:Xt.args??{}})),Qt=ft.map(Xt=>({source:Xt.source,target:Xt.target}));return{nodes:vt,edges:Qt}}async function on(){const T=nn();if(T.nodes.length===0){i(34,Ge="Nothing to schedule (empty graph).");return}const ft={mode:Ee,graph:T};if(Ee==="once"){if(!je){i(34,Ge="Please pick a date & time.");return}ft.run_at=new Date(je).toISOString()}else if(Ee==="interval"){if(ft.hours=Number(We)||0,ft.minutes=Number(en)||0,ft.seconds=Number(ke)||0,!(ft.hours||ft.minutes||ft.seconds)){i(34,Ge="Interval must be > 0.");return}}else if(ft.cron=(He||"").trim(),!ft.cron){i(34,Ge="Cron expression is required.");return}i(33,jt=!0),i(34,Ge="");try{const vt=await fetch("/pipeline/schedules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ft)});if(!vt.ok)throw new Error(`HTTP ${vt.status}`);await vt.json(),i(26,pe=!1),await Oe()}catch(vt){i(34,Ge=`Failed to create schedule: ${(vt==null?void 0:vt.message)||vt}`)}finally{i(33,jt=!1)}}async function Oe(){try{const T=await fetch("/pipeline/schedules");if(T.ok){i(35,Ye=await T.json());return}}catch{}try{const T=await fetch("/schedules");T.ok&&i(35,Ye=await T.json())}catch{}}async function Fe(T){await fetch(`/pipeline/schedules/${T}`,{method:"DELETE"}).catch(()=>{}),await Oe()}async function gn(T){await fetch(`/pipeline/schedules/${T}/pause`,{method:"POST"}).catch(()=>{}),await Oe()}async function ue(T){await fetch(`/pipeline/schedules/${T}/resume`,{method:"POST"}).catch(()=>{}),await Oe()}Hn(async()=>{await Oe().catch(()=>{})});function de(T){Xe.call(this,n,T)}function qe(T){Xe.call(this,n,T)}function kn(T){Xe.call(this,n,T)}const vn=()=>i(4,Y=!Y),Nn=()=>i(0,s=s==="dark"?"light":"dark"),Mn=()=>i(10,tt=!tt),Be=()=>i(0,s=s==="dark"?"light":"dark"),bt=()=>i(10,tt=!tt),yn=T=>S(T.id),wn=T=>{Sd(T.id),tn(T.id)},cn=T=>gn(T.id),Pn=T=>ue(T.id),w=T=>tn(T.id),mt=T=>Fe(T.id),Pt=T=>dt(T.id),kt=T=>ct(T.id),Et=T=>z(T.id);function x(T){r[T].type=vo(this),i(1,r),i(6,p)}const Kt=(T,ft)=>{const vt=p.find(Xt=>Xt.name===r[T].type),Qt=(vt==null?void 0:vt.default_args)??{};i(1,r[T].args=JSON.parse(JSON.stringify(Qt)),r),i(1,r[T].label=`${r[T].type} (${ft.id})`,r),i(3,d[ft.id]=JSON.stringify(r[T].args,null,2),d)},_e=T=>Ke(T),Jt=(T,ft)=>$(T,ft),Pe=async T=>{var ft;try{const vt=await Fl(T,{});i(4,Y=!0),N(T.id,!!(vt!=null&&vt.ok),vt!=null&&vt.ok?((ft=vt==null?void 0:vt.output)==null?void 0:ft.message)||"Started":(vt==null?void 0:vt.error)||"Error")}catch(vt){N(T.id,!1,`Exception: ${typeof vt=="object"&&vt!==null&&"message"in vt?vt.message:String(vt)}`),i(4,Y=!0)}};function sn(T,ft){n.$$.not_equal(r[ft].position,T)&&(r[ft].position=T,i(1,r))}function Ue(T){Xn[T?"unshift":"push"](()=>{Ct=T,i(19,Ct)})}function Ln(T){Xn[T?"unshift":"push"](()=>{Mt=T,i(20,Mt)})}function Cn(T){Xn[T?"unshift":"push"](()=>{_t=T,i(16,_t)})}const Yn=()=>i(21,zt=null),Dn=()=>i(25,xe=!1),Tn=()=>i(25,xe=!0);function Ve(T){Ut[T.key]=this.value,i(24,Ut),i(23,Ft)}function Rn(T){Ut[T.key]=mi(this.value),i(24,Ut),i(23,Ft)}function $n(T){Ut[T.key]=this.checked,i(24,Ut),i(23,Ft)}function gt(T){Ut[T.key]=this.value,i(24,Ut),i(23,Ft)}function Ht(T){Ut[T.key]=this.value,i(24,Ut),i(23,Ft)}function te(T){Ut[T.key]=vo(this),i(24,Ut),i(23,Ft)}function Ne(){Tt=this.value,i(22,Tt)}const En=()=>i(21,zt=null),Je=()=>i(26,pe=!1);function oe(){Ee=vo(this),i(27,Ee)}function It(){je=this.value,i(28,je)}function ne(){We=mi(this.value),i(29,We)}function rn(){en=mi(this.value),i(30,en)}function Fn(){ke=mi(this.value),i(31,ke)}function ln(){He=this.value,i(32,He)}const An=()=>i(26,pe=!1),Zt=()=>i(10,tt=!1);function se(){et=vo(this),i(12,et)}function Ze(){J=this.value,i(11,J)}const qn=T=>{T.key==="Enter"&&(T.ctrlKey||T.metaKey)&&W()},oi=()=>i(11,J="Create a workflow to calculate NDVI from satellite imagery"),si=()=>i(11,J="Build a pipeline for water body detection using NDWI"),fi=()=>i(11,J="Add a PCA node for dimensionality reduction"),Kn=()=>i(10,tt=!1),Di=()=>navigator.clipboard.writeText(E.map(T=>`[${T.nodeId}] ${T.ok?"OK":"ERR"} ${T.text}`).join(`
`)),Ri=()=>i(7,E=[]),Si=()=>i(4,Y=!1);return n.$$.update=()=>{if(n.$$.dirty[0]&1&&document!=null&&document.body&&(document.body.dataset.theme=s),n.$$.dirty[0]&10){for(const T of r)if(d[T.id]===void 0)try{i(3,d[T.id]=JSON.stringify(T.args??{},null,2),d)}catch{i(3,d[T.id]="{}",d)}}if(n.$$.dirty[0]&6){const T=new Set(r.map(vt=>vt.id)),ft=u.filter(vt=>T.has(vt.source)&&T.has(vt.target));ft.length!==u.length&&i(2,u=ft)}n.$$.dirty[0]&2&&i(15,Lt=r.map(T=>`${T.id}:${T.position.x},${T.position.y}`).join("|")),n.$$.dirty[0]&16|n.$$.dirty[2]&2&&!Y&&ie&&(clearInterval(ie),i(63,ie=null))},[s,r,u,d,Y,f,p,E,O,j,tt,J,et,ot,lt,Lt,_t,R,U,Ct,Mt,zt,Tt,Ft,Ut,xe,pe,Ee,je,We,en,ke,He,jt,Ge,Ye,b,S,z,N,nt,X,ct,dt,Q,W,At,st,yt,Wt,we,$,Ot,Ke,Yt,Re,tn,bn,on,Oe,Fe,gn,ue,ie,de,qe,kn,vn,Nn,Mn,Be,bt,yn,wn,cn,Pn,w,mt,Pt,kt,Et,x,Kt,_e,Jt,Pe,sn,Ue,Ln,Cn,Yn,Dn,Tn,Ve,Rn,$n,gt,Ht,te,Ne,En,Je,oe,It,ne,rn,Fn,ln,An,Zt,se,Ze,qn,oi,si,fi,Kn,Di,Ri,Si]}class Td extends pn{constructor(e){super(),mn(this,e,Md,wd,un,{},null,[-1,-1,-1,-1,-1,-1])}}new Td({target:document.getElementById("app")});export{io as $,ae as A,ia as B,oa as C,le as D,he as E,wt as F,$e as G,an as H,Wn as I,re as J,Xo as K,Ce as L,Me as M,Te as N,Se as O,Qs as P,Zn as Q,ic as R,pn as S,Le as T,mi as U,gi as V,jn as W,vi as X,vo as Y,it as Z,Xn as _,at as a,Lo as a0,ee as a1,ii as a2,Mo as a3,G as b,m as c,F as d,M as e,pt as f,fn as g,Ae as h,mn as i,q as j,B as k,ht as l,ve as m,Gt as n,Hn as o,eo as p,ye as q,y as r,un as s,$t as t,hi as u,V as v,me as w,To as x,ze as y,ss as z};
