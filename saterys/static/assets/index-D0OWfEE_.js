const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Controls-B4CKevh5.js","assets/Icon-Bva_t8qY.js","assets/DrawerController-C0-7qqz6.js","assets/DrawerController-ZXfKNTdC.css"])))=>i.map(i=>d[i]);
var au=Object.defineProperty;var lu=(n,e,i)=>e in n?au(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i;var Wo=(n,e,i)=>lu(n,typeof e!="symbol"?e+"":e,i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function i(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=i(r);fetch(r.href,l)}})();function Ht(){}function os(n,e){for(const i in e)n[i]=e[i];return n}function Xa(n){return n()}function Vs(){return Object.create(null)}function ln(n){n.forEach(Xa)}function Qi(n){return typeof n=="function"}function dn(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function uu(n){return Object.keys(n).length===0}function mn(n,...e){if(n==null){for(const s of e)s(void 0);return Ht}const i=n.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function yt(n){let e;return mn(n,i=>e=i)(),e}function gt(n,e,i){n.$$.on_destroy.push(mn(e,i))}function ke(n,e,i,s){if(n){const r=Ya(n,e,i,s);return n[0](r)}}function Ya(n,e,i,s){return n[1]&&s?os(i.ctx.slice(),n[1](s(e))):i.ctx}function Pe(n,e,i,s){if(n[2]&&s){const r=n[2](s(i));if(e.dirty===void 0)return r;if(typeof r=="object"){const l=[],u=Math.max(e.dirty.length,r.length);for(let h=0;h<u;h+=1)l[h]=e.dirty[h]|r[h];return l}return e.dirty|r}return e.dirty}function Le(n,e,i,s,r,l){if(r){const u=Ya(e,i,s,l);n.p(u,r)}}function Ce(n){if(n.ctx.length>32){const e=[],i=n.ctx.length/32;for(let s=0;s<i;s++)e[s]=-1;return e}return-1}function ss(n){const e={};for(const i in n)e[i]=!0;return e}function Xs(n){return n??""}function Zt(n,e,i){return n.set(i),e}function pi(n){return n&&Qi(n.destroy)?n.destroy:Ht}const cu=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function k(n,e){n.appendChild(e)}function tt(n,e,i){n.insertBefore(e,i||null)}function q(n){n.parentNode&&n.parentNode.removeChild(n)}function ki(n,e){for(let i=0;i<n.length;i+=1)n[i]&&n[i].d(e)}function z(n){return document.createElement(n)}function ne(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Ge(n){return document.createTextNode(n)}function $(){return Ge(" ")}function De(){return Ge("")}function _t(n,e,i,s){return n.addEventListener(e,i,s),()=>n.removeEventListener(e,i,s)}function Hn(n){return function(e){return e.preventDefault(),n.call(this,e)}}function qn(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function Xi(n){return function(e){e.target===this&&n.call(this,e)}}function m(n,e,i){i==null?n.removeAttribute(e):n.getAttribute(e)!==i&&n.setAttribute(e,i)}function mi(n){return n===""?null:+n}function hu(n){return Array.from(n.childNodes)}function Cn(n,e){e=""+e,n.data!==e&&(n.data=e)}function He(n,e){n.value=e??""}function st(n,e,i,s){i==null?n.style.removeProperty(e):n.style.setProperty(e,i,"")}function Bi(n,e,i){for(let s=0;s<n.options.length;s+=1){const r=n.options[s];if(r.__value===e){r.selected=!0;return}}(!i||e!==void 0)&&(n.selectedIndex=-1)}function Ho(n){const e=n.querySelector(":checked");return e&&e.__value}let _o;function fu(){if(_o===void 0){_o=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{_o=!0}}return _o}function du(n,e){getComputedStyle(n).position==="static"&&(n.style.position="relative");const s=z("iframe");s.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),s.setAttribute("aria-hidden","true"),s.tabIndex=-1;const r=fu();let l;return r?(s.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",l=_t(window,"message",u=>{u.source===s.contentWindow&&e()})):(s.src="about:blank",s.onload=()=>{l=_t(s.contentWindow,"resize",e),e()}),k(n,s),()=>{(r||l&&s.contentWindow)&&l(),q(s)}}function Vt(n,e,i){n.classList.toggle(e,!!i)}function _u(n,e,{bubbles:i=!1,cancelable:s=!1}={}){return new CustomEvent(n,{detail:e,bubbles:i,cancelable:s})}function si(n,e){return new n(e)}let Ki;function Yi(n){Ki=n}function Li(){if(!Ki)throw new Error("Function called outside component initialization");return Ki}function mu(n){Li().$$.before_update.push(n)}function Fn(n){Li().$$.on_mount.push(n)}function qa(n){Li().$$.after_update.push(n)}function $i(n){Li().$$.on_destroy.push(n)}function Zi(){const n=Li();return(e,i,{cancelable:s=!1}={})=>{const r=n.$$.callbacks[e];if(r){const l=_u(e,i,{cancelable:s});return r.slice().forEach(u=>{u.call(n,l)}),!l.defaultPrevented}return!0}}function Ze(n,e){return Li().$$.context.set(n,e),e}function de(n){return Li().$$.context.get(n)}function qe(n,e){const i=n.$$.callbacks[e.type];i&&i.slice().forEach(s=>s.call(this,e))}const Oi=[],Kn=[];let Ii=[];const Qo=[],Ka=Promise.resolve();let $o=!1;function Ja(){$o||($o=!0,Ka.then($a))}function Qa(){return Ja(),Ka}function Pi(n){Ii.push(n)}function pu(n){Qo.push(n)}const Fo=new Set;let Ai=0;function $a(){if(Ai!==0)return;const n=Ki;do{try{for(;Ai<Oi.length;){const e=Oi[Ai];Ai++,Yi(e),gu(e.$$)}}catch(e){throw Oi.length=0,Ai=0,e}for(Yi(null),Oi.length=0,Ai=0;Kn.length;)Kn.pop()();for(let e=0;e<Ii.length;e+=1){const i=Ii[e];Fo.has(i)||(Fo.add(i),i())}Ii.length=0}while(Oi.length);for(;Qo.length;)Qo.pop()();$o=!1,Fo.clear(),Yi(n)}function gu(n){if(n.fragment!==null){n.update(),ln(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Pi)}}function vu(n){const e=[],i=[];Ii.forEach(s=>n.indexOf(s)===-1?e.push(s):i.push(s)),i.forEach(s=>s()),Ii=e}const vo=new Set;let bi;function ye(){bi={r:0,c:[],p:bi}}function be(){bi.r||ln(bi.c),bi=bi.p}function D(n,e){n&&n.i&&(vo.delete(n),n.i(e))}function F(n,e,i,s){if(n&&n.o){if(vo.has(n))return;vo.add(n),bi.c.push(()=>{vo.delete(n),s&&(i&&n.d(1),s())}),n.o(e)}else s&&s()}function Ae(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function ko(n,e){n.d(1),e.delete(n.key)}function Ji(n,e){F(n,1,1,()=>{e.delete(n.key)})}function hi(n,e,i,s,r,l,u,h,f,d,p,g){let b=n.length,w=l.length,P=b;const M={};for(;P--;)M[n[P].key]=P;const E=[],A=new Map,T=new Map,I=[];for(P=w;P--;){const K=g(r,l,P),nt=i(K);let et=u.get(nt);et?I.push(()=>et.p(K,e)):(et=d(nt,K),et.c()),A.set(nt,E[P]=et),nt in M&&T.set(nt,Math.abs(P-M[nt]))}const W=new Set,V=new Set;function U(K){D(K,1),K.m(h,p),u.set(K.key,K),p=K.first,w--}for(;b&&w;){const K=E[w-1],nt=n[b-1],et=K.key,J=nt.key;K===nt?(p=K.first,b--,w--):A.has(J)?!u.has(et)||W.has(et)?U(K):V.has(J)?b--:T.get(et)>T.get(J)?(V.add(et),U(K)):(W.add(J),b--):(f(nt,u),b--)}for(;b--;){const K=n[b];A.has(K.key)||f(K,u)}for(;w;)U(E[w-1]);return ln(I),E}function tl(n,e){const i={},s={},r={$$scope:1};let l=n.length;for(;l--;){const u=n[l],h=e[l];if(h){for(const f in u)f in h||(s[f]=1);for(const f in h)r[f]||(i[f]=h[f],r[f]=1);n[l]=h}else for(const f in u)r[f]=1}for(const u in s)u in i||(i[u]=void 0);return i}function el(n){return typeof n=="object"&&n!==null?n:{}}function yu(n,e,i){const s=n.$$.props[e];s!==void 0&&(n.$$.bound[s]=i,i(n.$$.ctx[s]))}function ue(n){n&&n.c()}function oe(n,e,i){const{fragment:s,after_update:r}=n.$$;s&&s.m(e,i),Pi(()=>{const l=n.$$.on_mount.map(Xa).filter(Qi);n.$$.on_destroy?n.$$.on_destroy.push(...l):ln(l),n.$$.on_mount=[]}),r.forEach(Pi)}function se(n,e){const i=n.$$;i.fragment!==null&&(vu(i.after_update),ln(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function bu(n,e){n.$$.dirty[0]===-1&&(Oi.push(n),Ja(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function bn(n,e,i,s,r,l,u=null,h=[-1]){const f=Ki;Yi(n);const d=n.$$={fragment:null,ctx:[],props:l,update:Ht,not_equal:r,bound:Vs(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:Vs(),dirty:h,skip_bound:!1,root:e.target||f.$$.root};u&&u(d.root);let p=!1;if(d.ctx=i?i(n,e.props||{},(g,b,...w)=>{const P=w.length?w[0]:b;return d.ctx&&r(d.ctx[g],d.ctx[g]=P)&&(!d.skip_bound&&d.bound[g]&&d.bound[g](P),p&&bu(n,g)),b}):[],d.update(),p=!0,ln(d.before_update),d.fragment=s?s(d.ctx):!1,e.target){if(e.hydrate){const g=hu(e.target);d.fragment&&d.fragment.l(g),g.forEach(q)}else d.fragment&&d.fragment.c();e.intro&&D(n.$$.fragment),oe(n,e.target,e.anchor),$a()}Yi(f)}class wn{constructor(){Wo(this,"$$");Wo(this,"$$set")}$destroy(){se(this,1),this.$destroy=Ht}$on(e,i){if(!Qi(i))return Ht;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(i),()=>{const r=s.indexOf(i);r!==-1&&s.splice(r,1)}}$set(e){this.$$set&&!uu(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const wu="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(wu);const Ni=[];function bo(n,e){return{subscribe:Y(n,e).subscribe}}function Y(n,e=Ht){let i;const s=new Set;function r(h){if(dn(n,h)&&(n=h,i)){const f=!Ni.length;for(const d of s)d[1](),Ni.push(d,n);if(f){for(let d=0;d<Ni.length;d+=2)Ni[d][0](Ni[d+1]);Ni.length=0}}}function l(h){r(h(n))}function u(h,f=Ht){const d=[h,f];return s.add(d),s.size===1&&(i=e(r,l)||Ht),h(n),()=>{s.delete(d),s.size===0&&i&&(i(),i=null)}}return{set:r,update:l,subscribe:u}}function qi(n,e,i){const s=!Array.isArray(n),r=s?[n]:n;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const l=e.length<2;return bo(i,(u,h)=>{let f=!1;const d=[];let p=0,g=Ht;const b=()=>{if(p)return;g();const P=e(s?d[0]:d,u,h);l?u(P):g=Qi(P)?P:Ht},w=r.map((P,M)=>mn(P,E=>{d[M]=E,p&=~(1<<M),f&&b()},()=>{p|=1<<M}));return f=!0,b(),function(){ln(w),g(),f=!1}})}function wo(){const n=new Map,{subscribe:e,set:i,update:s}=Y(n);return{subscribe:e,set:i,update:s,add:(l,u)=>(s(h=>(h.set(u,l),h)),n),get:l=>n.get(l)||null,getAll:()=>Array.from(n.values()),delete:l=>{let u=!1;return s(h=>(h.delete(l),u=!0,h)),u},count:()=>n.size}}function ku(n){const{id:e,inputs:i,outputs:s,resizable:r,dimensions:l,editable:u,direction:h,zIndex:f,position:d,selectionColor:p,borderWidth:g,edge:b}=n,{bgColor:w,borderColor:P,rotation:M,borderRadius:E,connections:A,textColor:T,locked:I,group:W}=n,V=wo(),U=(et="self")=>{yt(V).forEach(J=>{(et==="self"||yt(J.direction)===et)&&J.recalculatePosition()})};return{id:typeof e=="string"&&e.slice(0,2)==="N-"?e:`N-${e}`,position:Y({x:(d==null?void 0:d.x)||0,y:(d==null?void 0:d.y)||0}),dimensions:{width:Y((l==null?void 0:l.width)||0),height:Y((l==null?void 0:l.height)||(l==null?void 0:l.width))},group:Y(W||null),locked:Y(I||!1),inputs:Y(i),outputs:Y(s),recalculateAnchors:U,rotation:Y(M||0),moving:Y(!1),resizingWidth:Y(!1),resizingHeight:Y(!1),rotating:Y(!1),editable:Y(u||!1),resizable:Y(r),anchors:V,zIndex:Y(f||2),collapsed:Y(!1),edge:b||null,borderRadius:Y(E),bgColor:Y(w||null),direction:Y(h),label:Y(n.label||""),borderColor:Y(P||null),borderWidth:Y(g),selectionColor:Y(p||null),textColor:Y(T||null),connections:Y(A)}}const Pu=10,Lu=100,Cu=50,Su="#000",Mu="#fff",Tu="12px",Eu=22,zu=1.4,Au=40;function Nu(n,e){const i=[n,e].sort();return`${i[0]}+${i[1]}`}function Ys(n,e,i){var h,f,d,p,g;const{source:s,target:r}=n,u={id:s.id&&r.id?Nu(s.id,r.id):"cursor",target:n.target,source:n.source,component:e,type:Y((i==null?void 0:i.type)||null),color:(i==null?void 0:i.color)||Y(null),width:Y((i==null?void 0:i.width)||0),animated:Y((i==null?void 0:i.animated)||!1),rendered:Y(!1),start:(i==null?void 0:i.start)||null,end:(i==null?void 0:i.end)||null};if(i!=null&&i.disconnect&&(u.disconnect=!0),i!=null&&i.label){const b={text:Y(i==null?void 0:i.label.text),color:Y(((h=i==null?void 0:i.label)==null?void 0:h.color)||Su),textColor:Y(((f=i==null?void 0:i.label)==null?void 0:f.textColor)||Mu),fontSize:Y(((d=i==null?void 0:i.label)==null?void 0:d.fontSize)||Tu),dimensions:{width:Y(((p=i==null?void 0:i.label.dimensions)==null?void 0:p.width)||Lu),height:Y(((g=i==null?void 0:i.label.dimensions)==null?void 0:g.height)||Cu)},borderRadius:Y((i==null?void 0:i.label.borderRadius)||Pu)};u.label=b}return u}function Ou(){const n=new Map,e=new Set,{subscribe:i,set:s,update:r}=Y(n),l={subscribe:i,set:s,update:r,add:(u,h)=>{if(typeof h!="string"){const f=Array.from(h),d=f[0],p=f[1];if(d.connected.update(g=>g.add(p)),p.connected.update(g=>g.add(d)),l.match(...Array.from(h)).length)return;e.forEach(g=>g(u,"connection"))}r(f=>(f.set(h,u),f))},getAll:()=>Array.from(n.values()),get:u=>n.get(u)||null,match:(...u)=>Array.from(n.keys()).filter(h=>h==="cursor"?!1:u.every(f=>f?h.has(f):!0)),fetch:(u,h)=>{const f=Array.from(n.keys()).filter(d=>d==="cursor"?!1:[u,h].every(p=>p?d.has(p):!0))[0];return n.get(f)||null},delete:u=>{if(typeof u!="string"){const f=Array.from(u),d=f[0],p=f[1];d.connected.update(g=>(g.delete(p),g)),p.connected.update(g=>(g.delete(d),g))}let h=!1;return r(f=>{const d=f.get(u);return d&&(f.delete(u),h=!0,typeof u!="string"&&e.forEach(p=>p(d,"disconnection"))),f}),h},onEdgeChange:u=>(e.add(u),()=>e.delete(u)),count:()=>n.size};return l}function Iu(n,e){const i=n.clientX-e.clientX,s=n.clientY-e.clientY;return Math.sqrt(i*i+s*s)}function Bu(){const n=()=>Math.floor(Math.random()*256),e=n(),i=n(),s=n();return`rgb(${e},${i},${s})`}const Zu={"(":"round","[":"square","([":"stadium","[[":"subroutine","[(":"cylindrical","((":"circle","{":"rhombus","{{":"hexagon"},qs={"-":"straight","~":"bezier"},nl={"(":")","[":"]","{":"}"},Du=/[-=~]*>(?:\s*\|(.+?)\|)?/g,xu=n=>{const e=n.split(`
`),i={parentNodes:[],nodeList:{}};for(const s of e){const{parentNodes:r,childNodes:l,edge:u}=Ru(s);for(const h of r){i.nodeList[h.id]||i.parentNodes.push(h);for(const f of l){if(i.nodeList[h.id]){if(i.nodeList[f.id]&&i.nodeList[f.id].children.some(({node:d})=>d.id===h.id))throw new Error("Circular reference detected");i.nodeList[h.id].children.push({node:i.nodeList[f.id]||f,...u})}else h.children.push({node:i.nodeList[f.id]||f,...u}),i.nodeList[h.id]=h;i.nodeList[f.id]?i.nodeList[f.id].parents.push({node:i.nodeList[h.id]||h}):(f.parents.push({node:i.nodeList[h.id]||h}),i.nodeList[f.id]=f),i.parentNodes=i.parentNodes.filter(d=>d.id!==f.id)}}}return i},Ru=n=>{const e=[],i=[],s=n.trim();let r="";const l=s.match(Du);if(l)r=l[0];else throw new Error("Invalid edge");const[u,h]=s.split(r);for(const d of u.split("&"))e.push(Ks(d));for(const d of h.split("&"))i.push(Ks(d));const f=ju(r);return{parentNodes:e,childNodes:i,edge:f}},Ks=n=>{n=n.trim();const e=n[0],i=n.slice(1);let s="",r="";const l="Default",u={shape:""},h=[];for(let f=0;f<i.length;f++)if(Wu(i[f]))h.push(i[f]);else if(nl[h[h.length-1]]===i[f]){r=Zu[h.join("")];break}else s+=i[f];return u.shape=r,u.content=s,{id:e,data:u,type:l,children:[],parents:[],depth:0,nesting:0}},ju=n=>{n=n.trim();let e="";const[i,s]=n.split("|"),r=i[0];if(r in qs)e=qs[r];else throw new Error("Not a valid edge type");return s?{shape:e,content:s.trim(),length:Math.floor((i.trim().length-1)/2)}:{shape:e,length:Math.floor((i.trim().length-1)/2)}};function Wu(n){return n in nl}function Hu(){return Math.random().toString(36).substring(7)}function Fu(n,e){const i=Math.sign(n.x).toString(),s=Math.sign(n.y).toString(),r=Math.sign(e.x).toString(),l=Math.sign(e.y).toString();return`${i}${s}${r}${l}`}function Gu(n,e){return{1001:`a ${n} ${n} 0 0 1 ${n} ${n}`,"0110":`a ${n} ${n} 0 0 0 ${n} ${n}`,"100-1":`a ${n} ${n} 0 0 0 ${n} -${n}`,"0-110":`a ${n} ${n} 0 0 1 ${n} -${n}`,"-1001":`a ${n} ${n} 0 0 0 -${n} ${n}`,"01-10":`a ${n} ${n} 0 0 1 -${n} ${n}`,"-100-1":`a ${n} ${n} 0 0 1 -${n} -${n}`,"0-1-10":`a ${n} ${n} 0 0 0 -${n} -${n}`}[e]||""}function Js(n,e){const i=e*(Math.PI/180),s=n.x*Math.cos(i)-n.y*Math.sin(i),r=n.x*Math.sin(i)+n.y*Math.cos(i);return{x:s,y:r}}const Uu=(n,e,i,s)=>n+` l ${e} ${i} `+s,Dn=Y({x:0,y:0}),ts=Y(0),Wn=Y(!1),es=Y(!1),il=bo({x:0,y:0},n=>{const e=l=>{n({x:l.clientX,y:l.clientY})},i=l=>{if(l.touches.length===2){const u=Iu(l.touches[0],l.touches[1]);ts.set(u);const h={x:l.touches[0].clientX,y:l.touches[0].clientY};n(h)}else if(l.touches.length===1){const u=l.touches[0].clientX,h=l.touches[0].clientY;n({x:u,y:h}),Wn.set(!0)}},s=l=>{i(l),window.addEventListener("touchend",r),window.addEventListener("touchmove",i)},r=()=>{Wn.set(!1),ts.set(0),window.removeEventListener("touchmove",i)};return document.addEventListener("mousemove",e),window.addEventListener("touchstart",s,!0),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchstart",s),window.removeEventListener("touchmove",i),window.removeEventListener("touchend",r)}});function Go(n){const e=n.style.width,i=n.style.height;n.style.width="fit-content",n.style.height="fit-content";const s=n.offsetWidth,r=n.offsetHeight;return n.style.width=e,n.style.height=i,[s,r]}function ol(n,e,i,s,r){const l={x:0,y:0},u=s.x-r.left-r.width/2,h=s.y-r.top-r.height/2,f=(u-i.x)/n,d=(h-i.y)/n;return l.x=u-f*e,l.y=h-d*e,l}const Vu=3,Xu=.1,Vi={north:{x:0,y:-1},south:{x:0,y:1},east:{x:1,y:0},west:{x:-1,y:0},self:{x:0,y:0}};function sl(n,e,i){const s=e*i,r=n-s;return Number(Math.max(Xu,Math.min(Vu,r)).toFixed(9))}const Po=(n,e,i,s,r,l,u)=>{const{clientX:h,clientY:f}=n,d=l,p=h-i,g=f-e,b=u.x,w=u.y,P=s*(1-l)/2,M=r*(1-l)/2,E=p-b-P,A=g-w-M,T=E/d,I=A/d;return{x:T,y:I}};function Yu(n,e,i){const{top:s,left:r,width:l,height:u}=yt(n),h=yt(e.scale),f=yt(e.translation);return{scaled:Po({clientX:i.x,clientY:i.y},s,r,l,u,h,f),scale:h}}function qu(n,e,i){const{scale:s,translation:r}=i,l=yt(s),u=yt(r),h=e.x-n.x,f=e.y-n.y,d=u.x+h*l,p=u.y+f*l;return{x:d,y:p}}function Ku(n,e){return n.x*e.x+n.y*e.y}function Ju(n,e,i){const s=[],r=e.x-n.x,l=e.y-n.y,u=$u(n.direction,e.direction),h=Ku(n.direction,e.direction)===0,f=Qu(n,e),d=en(n.direction,-1,-1),p=en(e.direction,-1,-1),g={x:Math.abs(n.direction.y),y:Math.abs(n.direction.x)},b=en(n.direction,r-i*n.direction.x*(h?1:u?0:2),l-i*n.direction.y*(h?1:u?0:2)),w=en(e.direction,r+i*e.direction.x*(h?1:u?0:2),l+i*e.direction.y*(h?1:u?0:2)),P=Math.sign(b.x)===-1||Math.sign(b.y)===-1,M=Math.sign(w.x)===1||Math.sign(w.y)===1,E=Math.abs(r),A=Math.abs(l),T=en(n.direction,i,i),I=en(p,i,i),W=en(e.direction,i,i),V=en(n.direction,E,A),U=en(p,E,A),K=en(n.direction,E/2,A/2),nt=en(p,E/2,A/2),et=en(g,r,l),J=!f&&!M&&!P,ut=n.x+T.x,B=n.y+T.y,it=e.x+W.x,X=e.y+W.y;if(P&&s.push(T),f&&!M&&!P)s.push(V),s.push(U);else if(u)P||s.push(en(n.direction,i+E,i+A)),s.push(et),M||s.push(en(p,i+E,i+A));else if(J)s.push(K),s.push(et),s.push(nt);else if(P&&M)if(h){const mt=Math.abs(ut-it),ht=Math.abs(B-X);s.push(en(e.direction,E<i*2?e.direction.x*(r+e.direction.x*i):E+i,A<i*2?e.direction.y*(l+e.direction.y*i):A+i)),s.push(en(d,mt,ht))}else{const mt=Math.abs(ut-it),ht=Math.abs(B-X);s.push(en(g,r/2,l/2)),s.push(en(e.direction,mt,ht)),s.push(en(g,r/2,l/2))}else if(P){const mt=Math.abs(ut-e.x),ht=Math.abs(B-e.y);s.push(en(p,E<i*2?E-i:E/2,A<i*2?A-i:A/2)),s.push(en(d,mt,ht)),s.push(en(p,Math.max(i,E/2),Math.max(i,A/2)))}else if(M){const mt=Math.abs(it-n.x),ht=Math.abs(X-n.y);s.push(en(n.direction,Math.max(i,E/2),Math.max(i,A/2))),s.push(en(e.direction,mt,ht)),s.push(en(n.direction,E<i*2?E-i:E/2,A<i*2?A-i:A/2))}return M&&s.push(I),s}function Qu(n,e){const{x:i,y:s}=n.direction,{x:r,y:l}=e.direction,u=e.x-n.x,h=e.y-n.y;return i*l===r*s?!1:Math.sign(h)===Math.sign(s+l)!=(Math.sign(u)===Math.sign(i+r))}function en(n,e,i){return{x:n.x*e,y:n.y*i}}function $u(n,e){return n.x===e.x&&n.y===e.y}function tc(n,e){const{width:i,height:s}=n,{top:r,left:l,right:u,bottom:h}=e,f=u-l,d=h-r;if(!f||!d)return{x:null,y:null,scale:null};const p=l+f/2,g=r+d/2,b=Math.min(i/f,s/d)*.8,w=i/2,P=s/2,M=w-p,E=P-g;return{x:M*b,y:E*b,scale:b}}const mo=(n,e,i)=>Math.min(Math.abs(n||e)/2,i);function Uo(n,e){const s=n.getTotalLength()*e;return n.getPointAtLength(s)}function ec(n,e,i,s){return qi([n,e,i,s],([l,u,h,f])=>{const d={clientX:l.x,clientY:l.y};return Po(d,u.top,u.left,u.width,u.height,f,h)})}function nc(n,e,i,s){const r=Y({top:1/0,left:1/0,right:-1/0,bottom:-1/0}),l=Y({top:1/0,left:1/0,right:-1/0,bottom:-1/0});let u,h=yt(e),f=yt(i),d=yt(s),p=h.width/f,g=h.height/f;function b(){const{x:P,y:M}=Po({clientX:h.left,clientY:h.top},h.top,h.left,h.width,h.height,f,d),E=yt(l);r.set({top:Math.min(E.top,M),left:Math.min(E.left,P),right:Math.max(E.right,P+p),bottom:Math.max(E.bottom,g+M)})}function w(P=!1){let M=1/0,E=1/0,A=-1/0,T=-1/0;for(const I of n.getAll()){console.log("dentro del for, este es e node:",I);const{x:W,y:V}=yt(I.position),U=yt(I.dimensions.width),K=yt(I.dimensions.height);E=Math.min(E,W),M=Math.min(M,V),A=Math.max(A,W+U),T=Math.max(T,V+K)}l.set({top:M,left:E,right:A,bottom:T}),b(),P&&(u=requestAnimationFrame(()=>w(P)))}return n.subscribe(()=>{console.log("dentro del nodes.subscribe...........Aqui no estan llegando los nodes"),w()}),es.subscribe(P=>{P&&w(P),P||cancelAnimationFrame(u)}),Wn.subscribe(P=>{P&&w(P),P||cancelAnimationFrame(u)}),e.subscribe(()=>{h=yt(e),p=h.width/f,g=h.height/f,b()}),i.subscribe(()=>{f=yt(i),p=h.width/f,g=h.height/f,b()}),s.subscribe(()=>{d=yt(s),b()}),{graphBounds:r,nodeBounds:l}}function ic(n,e,i){const{width:s,height:r,top:l,left:u}=n,h={clientX:s/2,clientY:r/2};return Po(h,l,u,s,r,i,e)}function rl(n,e){const{zoom:i,editable:s,translation:r,direction:l,locked:u,edge:h,nodes:f}=e,d=Y({x:(r==null?void 0:r.x)||0,y:(r==null?void 0:r.y)||0}),p=Y({top:0,left:0,width:0,height:0,bottom:0,right:0}),g=Y(i),b=Y(!1),w=wo(),P=nc(w,p,g,d),M=qi([p,d,g],([A,T,I])=>ic(A,T,I));return{id:n,nodes:w,edges:Ou(),transforms:{translation:d,scale:g},maxZIndex:Y(2),dimensions:p,bounds:P,center:M,mounted:b,direction:l||"LR",editable:s||!1,edge:h||null,editing:Y(null),cursor:ec(il,p,d,g),locked:Y(u||!1),groups:Y({selected:{parent:Y(null),nodes:Y(new Set)},hidden:{parent:Y(null),nodes:Y(new Set)}}),groupBoxes:wo(),activeGroup:Y(null),initialNodePositions:Y([])}}const Vo=wo(),po={width:200,height:100};function yo(n,e){return{x:Math.round(n/po.width)*po.width,y:Math.round(e/po.height)*po.height}}const go=10;function al(n){const e=yt(n);return Array.from(e).map(s=>yt(s.position))}function oc(n,e){console.log("moveNodes called");let i;const s=yt(n.groups),r=yt(n.activeGroup);if(console.log("Graph Groups:",s),console.log("Active Group:",r),!r)return;const l=s[r].nodes;if(!l)return;const u=yt(n.initialNodePositions),{x:h,y:f}=yt(Dn),d=Array.from(yt(l)),p=yt(n.groupBoxes);console.log("Group Boxes:",p),d.forEach(b=>b.moving.set(!0)),g();function g(){const b=yt(n.cursor);let w=b.x-h,P=b.y-f;if(e){const E=yo(w,P);w=E.x,P=E.y}const M={x:w,y:P};d.forEach((E,A)=>{const{group:T,position:I}=E,W=u[A];let V;if(r==="selected"){const U=yt(T);U&&(V=p.get(U))}if(!V)sc(W,M,I);else{const U=yt(E.dimensions.width),K=yt(E.dimensions.height),nt=ul(V,U,K);ll(W,M,I,nt)}}),yt(Wn)?i=requestAnimationFrame(g):cancelAnimationFrame(i)}}function sc(n,e,i){i.set({x:n.x+e.x,y:n.y+e.y})}function ll(n,e,i,s){i.set({x:Math.min(Math.max(s.left,n.x+e.x),s.right),y:Math.min(Math.max(s.top,n.y+e.y),s.bottom)})}function ul(n,e,i){const{x:s,y:r}=yt(n.position);return console.log("Group Box Position:",{x:s,y:r}),{left:s+go,right:s+yt(n.dimensions.width)-e-go,top:r+go,bottom:r+yt(n.dimensions.height)-i-go}}function Qs(n=1,e,i,s=.1){const r=yt(e),{width:l,height:u,top:h,left:f}=r,d=i.scale,p=yt(i.translation),g=yt(d),b=sl(g,n,s),w=ol(g,b,p,{x:l/2+f,y:u/2+h},r);d.set(b),i.translation.set(w)}function rc(n,e,i,s,r,l,u,h,f,d,p,g){const{width:b,height:w}=r,{x:P,y:M}=s,E=yt(e.position),A=Y({x:P-E.x+b/2,y:M-E.y+w/2}),T=qi([e.position,A],([et,J])=>({x:et.x+J.x,y:et.y+J.y})),I=n.transforms,W=n.dimensions,V=Y(f||"self"),U=()=>{const et=document.getElementById(i),J=yt(V),ut=Vi[J];if(!et)return;const{x:B,y:it,width:X,height:mt}=et.getBoundingClientRect(),ht=yt(A),H=yt(T),{scaled:R,scale:Tt}=Yu(W,I,{x:B,y:it}),rt=R.x-H.x,bt=R.y-H.y;A.set({x:ht.x+rt+X/Tt/2+ut.x*X/Tt/2,y:ht.y+bt+mt/Tt/2+ut.y*mt/Tt/2})},K=qi([e.moving,e.resizingWidth,e.resizingHeight,e.rotating],([et,J,ut,B])=>et||J||ut||B),nt=qi([e.rotation],([et])=>et);return{id:i,position:T,offset:A,direction:V,dynamic:Y(d||!1),type:h,edge:u,moving:K,mounted:Y(!1),recalculatePosition:U,connected:Y(new Set),store:l||null,inputKey:p||null,edgeColor:g||Y(null),rotation:nt,node:e}}function ac(n){var s,r;const e=JSON.parse(n);return rl(e.id,{...e,editable:e.editable,direction:e.direction,locked:e.locked,zoom:((s=e.transforms)==null?void 0:s.scale)??1,translation:((r=e.transforms)==null?void 0:r.translation)??{x:0,y:0},edge:e.edge})}function lc(n){let e;const i=n[2].default,s=ke(i,n,n[1],null);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,[l]){s&&s.p&&(!e||l&2)&&Le(s,i,r,r[1],e?Pe(i,r[1],l,null):Ce(r[1]),null)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function uc(n,e,i){let{$$slots:s={},$$scope:r}=e,{edge:l}=e;return Ze("edge",l),n.$$set=u=>{"edge"in u&&i(0,l=u.edge),"$$scope"in u&&i(1,r=u.$$scope)},[l,r,s]}class cl extends wn{constructor(e){super(),bn(this,e,uc,lc,dn,{edge:0})}}const cc=n=>({hovering:n[0]&32768}),$s=n=>({destroy:n[9],hovering:n[15]}),hc=n=>({path:n[0]&4096,hovering:n[0]&32768}),tr=n=>({path:n[12],destroy:n[9],hovering:n[15]});function fc(n){let e,i,s,r,l,u=(n[0]||n[1])&&er(n);const h=n[91].default,f=ke(h,n,n[90],tr),d=f||dc(n);let p=n[10]&&nr(n);return{c(){e=ne("svg"),u&&u.c(),i=ne("path"),d&&d.c(),p&&p.c(),m(i,"role","presentation"),m(i,"id",n[38]+"-target"),m(i,"class","target svelte-ppcocz"),m(i,"d",n[12]),Vt(i,"cursor",n[38]==="cursor"||!n[4]&&!n[3]),st(i,"cursor",n[4]||n[15]?"pointer":"move"),st(i,"--prop-target-edge-color",n[4]||n[15]?n[8]||null:"transparent"),m(e,"class","edges-wrapper svelte-ppcocz"),st(e,"z-index",n[17])},m(g,b){tt(g,e,b),u&&u.m(e,null),k(e,i),n[94](i),d&&d.m(e,null),p&&p.m(e,null),n[95](e),s=!0,r||(l=[_t(i,"mousedown",function(){Qi(n[4])&&n[4].apply(this,arguments)}),_t(i,"mouseenter",n[92]),_t(i,"mouseleave",n[93])],r=!0)},p(g,b){n=g,n[0]||n[1]?u?u.p(n,b):(u=er(n),u.c(),u.m(e,i)):u&&(u.d(1),u=null),(!s||b[0]&4096)&&m(i,"d",n[12]),(!s||b[0]&24|b[1]&128)&&Vt(i,"cursor",n[38]==="cursor"||!n[4]&&!n[3]),b[0]&32784&&st(i,"cursor",n[4]||n[15]?"pointer":"move"),b[0]&33040&&st(i,"--prop-target-edge-color",n[4]||n[15]?n[8]||null:"transparent"),f?f.p&&(!s||b[0]&36864|b[2]&268435456)&&Le(f,h,n,n[90],s?Pe(h,n[90],b,hc):Ce(n[90]),tr):d&&d.p&&(!s||b[0]&1052711)&&d.p(n,s?b:[-1,-1,-1,-1]),n[10]?p?(p.p(n,b),b[0]&1024&&D(p,1)):(p=nr(n),p.c(),D(p,1),p.m(e,null)):p&&(ye(),F(p,1,1,()=>{p=null}),be()),b[0]&131072&&st(e,"z-index",n[17])},i(g){s||(D(d,g),D(p),s=!0)},o(g){F(d,g),F(p),s=!1},d(g){g&&q(e),u&&u.d(),n[94](null),d&&d.d(g),p&&p.d(),n[95](null),r=!1,ln(l)}}}function er(n){let e,i,s,r,l;return{c(){e=ne("defs"),i=ne("marker"),s=ne("polygon"),r=ne("marker"),l=ne("polygon"),m(s,"class","arrow svelte-ppcocz"),m(s,"points","0 0, 15 5, 0 10"),st(s,"--prop-edge-color",n[20]),m(i,"id",n[38]+"-end-arrow"),m(i,"viewBox","0 0 15 15"),m(i,"markerWidth","15"),m(i,"markerHeight","10"),m(i,"refX","12.5"),m(i,"refY","5"),m(i,"orient","auto"),m(l,"class","arrow svelte-ppcocz"),m(l,"points","0 5, 15 0, 15 10"),st(l,"--prop-edge-color",n[20]),m(r,"id",n[38]+"-start-arrow"),m(r,"viewBox","0 0 15 15"),m(r,"markerWidth","15"),m(r,"markerHeight","10"),m(r,"refX","0"),m(r,"refY","5"),m(r,"orient","auto")},m(u,h){tt(u,e,h),k(e,i),k(i,s),k(e,r),k(r,l)},p(u,h){h[0]&1048576&&st(s,"--prop-edge-color",u[20]),h[0]&1048576&&st(l,"--prop-edge-color",u[20])},d(u){u&&q(e)}}}function dc(n){let e,i,s;return{c(){e=ne("path"),m(e,"id",n[38]),m(e,"class","edge svelte-ppcocz"),m(e,"d",n[12]),m(e,"marker-end",i=n[1]==="arrow"?`url(#${n[38]+"-end-arrow"})`:""),m(e,"marker-start",s=n[0]==="arrow"?`url(#${n[38]+"-start-arrow"})`:""),Vt(e,"animate",n[2]),st(e,"--prop-edge-color",n[20]),st(e,"--prop-stroke-width",n[5]?n[5]+"px":null)},m(r,l){tt(r,e,l)},p(r,l){l[0]&4096&&m(e,"d",r[12]),l[0]&2&&i!==(i=r[1]==="arrow"?`url(#${r[38]+"-end-arrow"})`:"")&&m(e,"marker-end",i),l[0]&1&&s!==(s=r[0]==="arrow"?`url(#${r[38]+"-start-arrow"})`:"")&&m(e,"marker-start",s),l[0]&4&&Vt(e,"animate",r[2]),l[0]&1048576&&st(e,"--prop-edge-color",r[20]),l[0]&32&&st(e,"--prop-stroke-width",r[5]?r[5]+"px":null)},d(r){r&&q(e)}}}function nr(n){let e,i,s,r,l;const u=n[91].label,h=ke(u,n,n[90],$s),f=h||_c(n);return{c(){e=ne("foreignObject"),i=z("span"),f&&f.c(),m(i,"class","label-wrapper svelte-ppcocz"),m(e,"x",s=n[14].x),m(e,"y",r=n[14].y),m(e,"width","100%"),m(e,"height","100%"),m(e,"class","svelte-ppcocz")},m(d,p){tt(d,e,p),k(e,i),f&&f.m(i,null),l=!0},p(d,p){h?h.p&&(!l||p[0]&32768|p[2]&268435456)&&Le(h,u,d,d[90],l?Pe(u,d[90],p,cc):Ce(d[90]),$s):f&&f.p&&(!l||p[0]&2240)&&f.p(d,l?p:[-1,-1,-1,-1]),(!l||p[0]&16384&&s!==(s=d[14].x))&&m(e,"x",s),(!l||p[0]&16384&&r!==(r=d[14].y))&&m(e,"y",r)},i(d){l||(D(f,d),l=!0)},o(d){F(f,d),l=!1},d(d){d&&q(e),f&&f.d(d)}}}function _c(n){let e,i;return{c(){e=z("div"),i=Ge(n[11]),m(e,"class","default-label svelte-ppcocz"),st(e,"--prop-label-color",n[6]),st(e,"--prop-label-text-color",n[7])},m(s,r){tt(s,e,r),k(e,i)},p(s,r){r[0]&2048&&Cn(i,s[11]),r[0]&64&&st(e,"--prop-label-color",s[6]),r[0]&128&&st(e,"--prop-label-text-color",s[7])},d(s){s&&q(e)}}}function mc(n){let e,i,s=n[23]&&n[24]&&fc(n);return{c(){s&&s.c(),e=De()},m(r,l){s&&s.m(r,l),tt(r,e,l),i=!0},p(r,l){r[23]&&r[24]&&s.p(r,l)},i(r){i||(D(s),i=!0)},o(r){F(s),i=!1},d(r){r&&q(e),s&&s.d(r)}}}let Xo;function pc(n){const e=n.parentNode;if(!e)return;e.removeChild(n);const i=document.querySelector(".svelvet-graph-wrapper");i&&i.appendChild(n)}function gc(n,e,i){var Rn,hn;let s,r,l,u,h,f,d,p,g,b,w,P,M,E,A,T,I,W,V,U,K,nt,et,J,ut,B,it,X,mt,ht,H,R,Tt=Ht,rt=()=>(Tt(),Tt=mn(mt,pt=>i(73,R=pt)),mt),bt,Et=Ht,vt=()=>(Et(),Et=mn(X,pt=>i(74,bt=pt)),X),j,Q,G,Z,It,Xt,dt,Mt,zt,Yt,Kt,ge,Ne,ot,_e=Ht,Jt=()=>(_e(),_e=mn(l,pt=>i(88,ot=pt)),l),Ct,Qt=Ht,qt=()=>(Qt(),Qt=mn(r,pt=>i(89,Ct=pt)),r);n.$$.on_destroy.push(()=>Tt()),n.$$.on_destroy.push(()=>Et()),n.$$.on_destroy.push(()=>_e()),n.$$.on_destroy.push(()=>Qt());let{$$slots:Gt={},$$scope:Oe}=e;const xe=ss(Gt),$t=de("edgeStore"),Ke=de("edgeStyle"),Se=de("endStyles"),he=de("raiseEdgesOnSelect"),me=de("edgesAboveNode");let{edge:Me=de("edge")}=e,{straight:Te=Ke==="straight"}=e,{step:Re=Ke==="step"}=e,{start:Ue=Se[0]}=e,{end:rn=Se[1]}=e,{animate:we=!1}=e,{label:je=""}=e,{enableHover:Dt=!1}=e,{edgeClick:un=null}=e,{labelPosition:Ie=.5}=e,{width:pn=null}=e,{color:an=null}=e,{labelColor:cn=null}=e,{textColor:Je=null}=e,{cornerRadius:Ee=8}=e,{targetColor:kn=null}=e;const re=Me.source,ce=Me.target,Xe=re.direction;gt(n,Xe,pt=>i(76,Q=pt));const Sn=ce.direction;gt(n,Sn,pt=>i(75,j=pt));const Pn=re.rotation;gt(n,Pn,pt=>i(83,zt=pt));const Nn=ce.rotation;gt(n,Nn,pt=>i(82,Mt=pt));const zn=re.position;gt(n,zn,pt=>i(87,Ne=pt));const Be=ce.position;gt(n,Be,pt=>i(86,ge=pt));const wt=re.dynamic;gt(n,wt,pt=>i(79,It=pt));const nn=ce.dynamic;gt(n,nn,pt=>i(78,Z=pt));const On=re.moving;gt(n,On,pt=>i(81,dt=pt));const on=ce.moving;gt(n,on,pt=>i(80,Xt=pt));const In=(Rn=re.node)==null?void 0:Rn.position;gt(n,In,pt=>i(85,Kt=pt));const y=(hn=ce.node)==null?void 0:hn.position;gt(n,y,pt=>i(84,Yt=pt));const ft=Me.type;gt(n,ft,pt=>i(77,G=pt));const kt=Me.id;let Pt,At,O={x:0,y:0},Wt=!1,ee=!1,te=!1,We=!1,Fe=!1,Ve;Me.rendered.set(!0),Fn(()=>{setTimeout(()=>{At&&i(14,O=Uo(At,Ie))},0),pc(Ve)}),qa(()=>{At&&i(14,O=Uo(At,Ie))}),$i(()=>{Ve.remove(),cancelAnimationFrame(Xo)});function Mn(){Wt&&(At&&i(14,O=Uo(At,Ie)),Xo=requestAnimationFrame(Mn))}function Tn(){if(re.id===null||ce.id===null)return;const pt=$t.match(re,ce);$t.delete(pt[0]),re==null||re.connected.update(jt=>(ce&&jt.delete(ce),jt)),ce==null||ce.connected.update(jt=>(re&&jt.delete(re),jt))}const Jn=()=>i(15,Fe=!0),xn=()=>i(15,Fe=!1);function Bn(pt){Kn[pt?"unshift":"push"](()=>{At=pt,i(13,At)})}function Ln(pt){Kn[pt?"unshift":"push"](()=>{Ve=pt,i(16,Ve)})}return n.$$set=pt=>{"edge"in pt&&i(39,Me=pt.edge),"straight"in pt&&i(40,Te=pt.straight),"step"in pt&&i(41,Re=pt.step),"start"in pt&&i(0,Ue=pt.start),"end"in pt&&i(1,rn=pt.end),"animate"in pt&&i(2,we=pt.animate),"label"in pt&&i(42,je=pt.label),"enableHover"in pt&&i(3,Dt=pt.enableHover),"edgeClick"in pt&&i(4,un=pt.edgeClick),"labelPosition"in pt&&i(43,Ie=pt.labelPosition),"width"in pt&&i(5,pn=pt.width),"color"in pt&&i(44,an=pt.color),"labelColor"in pt&&i(6,cn=pt.labelColor),"textColor"in pt&&i(7,Je=pt.textColor),"cornerRadius"in pt&&i(45,Ee=pt.cornerRadius),"targetColor"in pt&&i(8,kn=pt.targetColor),"$$scope"in pt&&i(90,Oe=pt.$$scope)},n.$$.update=()=>{var pt;if(n.$$.dirty[2]&196608&&i(55,s=It||Z),n.$$.dirty[1]&256&&Jt(i(21,l=(pt=Me.label)==null?void 0:pt.text)),n.$$.dirty[1]&8192|n.$$.dirty[2]&134217728&&i(20,u=an||Ct||null),n.$$.dirty[1]&2048|n.$$.dirty[2]&67108864&&i(11,h=je||ot||""),n.$$.dirty[0]&2048&&i(10,f=h||xe.label),n.$$.dirty[2]&33554432&&i(72,d=Ne),n.$$.dirty[2]&16777216&&i(71,p=ge),n.$$.dirty[2]&8388608&&i(56,g=Kt),n.$$.dirty[2]&4194304&&i(57,b=Yt),n.$$.dirty[2]&1024&&i(52,w=d.x),n.$$.dirty[2]&1024&&i(51,P=d.y),n.$$.dirty[2]&512&&i(54,M=p.x),n.$$.dirty[2]&512&&i(53,E=p.y),n.$$.dirty[1]&10485760&&i(70,A=M-w),n.$$.dirty[1]&5242880&&i(69,T=E-P),n.$$.dirty[2]&256&&i(68,I=Math.abs(A)),n.$$.dirty[2]&128&&i(67,W=Math.abs(T)),n.$$.dirty[2]&64&&i(65,V=Math.max(30,Math.min(600,I/2))),n.$$.dirty[2]&32&&i(63,U=Math.max(30,Math.min(600,W/2))),n.$$.dirty[1]&117833728&&s&&re.node&&ce.node){const jt=b.x-g.x,fe=b.y-g.y;i(48,te=fe>0),i(49,We=jt>0);let _n,Qe;if(te){const pe=yt(re.node.dimensions.height),ze=g.y+pe;_n=b.y-ze}else{const pe=yt(ce.node.dimensions.height),ze=b.y+pe;_n=g.y-ze}if(We){const pe=yt(re.node.dimensions.width),ze=g.x+pe;Qe=b.x-ze}else{const pe=yt(ce.node.dimensions.width),ze=b.x+pe;Qe=g.x-ze}i(47,ee=_n>Qe)}if(n.$$.dirty[1]&17235968|n.$$.dirty[2]&196608&&s){let jt,fe;ee?(jt=te?"south":"north",fe=te?"north":"south"):(jt=We?"east":"west",fe=We?"west":"east"),It&&Zt(Xe,Q=jt,Q),Z&&Zt(Sn,j=fe,j)}if(n.$$.dirty[2]&2113536&&i(66,K=Js(Vi[Q],zt||0)),n.$$.dirty[2]&1056768&&i(64,nt=Js(Vi[j],Mt||0)),n.$$.dirty[1]&2097152|n.$$.dirty[2]&24&&i(62,et=w+K.x*V),n.$$.dirty[1]&1048576|n.$$.dirty[2]&18&&i(61,J=P+K.y*U),n.$$.dirty[1]&8388608|n.$$.dirty[2]&12&&i(60,ut=M+nt.x*V),n.$$.dirty[1]&4194304|n.$$.dirty[2]&6&&i(59,B=E+nt.y*U),n.$$.dirty[1]&1879048192|n.$$.dirty[2]&1&&i(58,it=`C ${et}, ${J} ${ut}, ${B}`),n.$$.dirty[1]&149947904|n.$$.dirty[2]&32768&&(!Re||kt==="cursor"||G==="bezier")&&i(12,Pt=`M ${w}, ${P} ${Te?"":it} ${M}, ${E}`),n.$$.dirty[0]&1024|n.$$.dirty[1]&32768|n.$$.dirty[2]&786432&&(f&&!Wt&&(dt||Xt||kt==="cursor")?(i(46,Wt=!0),Mn()):Wt&&!dt&&!Xt&&kt!=="cursor"&&(i(46,Wt=!1),cancelAnimationFrame(Xo))),n.$$.dirty[1]&15746048|n.$$.dirty[2]&57344&&Re&&kt!=="cursor"&&!(G&&G==="bezier")){const jt={x:w,y:P,direction:Vi[Q]},fe={x:M,y:E,direction:Vi[j]},_n=Ju(jt,fe,Au),Qe=(pe,ze,xt)=>{if(ze<_n.length-1){const ae=Fu(pe,_n[ze+1]);return Gu(xt,ae)}return""};i(12,Pt=_n.reduce((pe,ze,xt)=>{const ae=Math.sign(ze.x),fn=Math.sign(ze.y);let sn=ze.x,gn=ze.y,Qn="";if(Ee){const vn=_n[xt+1]||{x:0,y:0},Bt=_n[xt-1]||{x:0,y:0},Rt=mo(ze.x,vn.x,Ee),S=mo(vn.y,ze.y,Ee),at=mo(Bt.x,ze.x,Ee),lt=mo(Bt.y,ze.y,Ee),Nt=Math.min(at,lt),Lt=Math.min(Rt,S);ze.x?sn=ze.x-(Lt+Nt)*ae:gn=ze.y-(Lt+Nt)*fn,Qn=Qe(ze,xt,Lt)}return Uu(pe,sn,gn,Qn)},`M ${w}, ${P}`))}n.$$.dirty[2]&6144&&i(50,ht=Math.max(bt,R)),n.$$.dirty[1]&524288|n.$$.dirty[2]&6144&&i(17,H=me==="all"?1e5:me?ht:he===!0?ht-1:he==="source"?bt-1:he==="target"?R-1:0)},qt(i(22,r=(re==null?void 0:re.edgeColor)||(ce==null?void 0:ce.edgeColor)||null)),vt(i(19,X=re.node.zIndex||0)),rt(i(18,mt=ce.node.zIndex||0)),[Ue,rn,we,Dt,un,pn,cn,Je,kn,Tn,f,h,Pt,At,O,Fe,Ve,H,mt,X,u,l,r,re,ce,Xe,Sn,Pn,Nn,zn,Be,wt,nn,On,on,In,y,ft,kt,Me,Te,Re,je,Ie,an,Ee,Wt,ee,te,We,ht,P,w,E,M,s,g,b,it,B,ut,J,et,U,nt,V,K,W,I,T,A,p,d,R,bt,j,Q,G,Z,It,Xt,dt,Mt,zt,Yt,Kt,ge,Ne,ot,Ct,Oe,Gt,Jn,xn,Bn,Ln]}class hl extends wn{constructor(e){super(),bn(this,e,gc,mc,dn,{edge:39,straight:40,step:41,start:0,end:1,animate:2,label:42,enableHover:3,edgeClick:4,labelPosition:43,width:5,color:44,labelColor:6,textColor:7,cornerRadius:45,targetColor:8,destroy:9},null,[-1,-1,-1,-1])}get destroy(){return this.$$.ctx[9]}}function vc(n){let e;return{c(){e=z("div"),m(e,"class","svelvet-anchor svelte-19t6skv"),Vt(e,"output",n[0]),Vt(e,"input",n[1]),Vt(e,"connected",n[3]),Vt(e,"connecting",n[2]),Vt(e,"hovering",n[4]),st(e,"--prop-anchor-color",n[5])},m(i,s){tt(i,e,s)},p(i,[s]){s&1&&Vt(e,"output",i[0]),s&2&&Vt(e,"input",i[1]),s&8&&Vt(e,"connected",i[3]),s&4&&Vt(e,"connecting",i[2]),s&16&&Vt(e,"hovering",i[4]),s&32&&st(e,"--prop-anchor-color",i[5])},i:Ht,o:Ht,d(i){i&&q(e)}}}function yc(n,e,i){let{output:s}=e,{input:r}=e,{connecting:l}=e,{connected:u}=e,{hovering:h}=e,{bgColor:f}=e;return n.$$set=d=>{"output"in d&&i(0,s=d.output),"input"in d&&i(1,r=d.input),"connecting"in d&&i(2,l=d.connecting),"connected"in d&&i(3,u=d.connected),"hovering"in d&&i(4,h=d.hovering),"bgColor"in d&&i(5,f=d.bgColor)},[s,r,l,u,h,f]}class bc extends wn{constructor(e){super(),bn(this,e,yc,vc,dn,{output:0,input:1,connecting:2,connected:3,hovering:4,bgColor:5})}}const wc=n=>({}),ir=n=>({});function or(n){const e=n.slice(),i=e[7].component;return e[86]=i,e}function Yo(n){const e=n.slice(),i=e[14].get("cursor");return e[7]=i,e}function sr(n,e,i){const s=n.slice();s[87]=e[i];const r=s[14].fetch(s[23],s[87]);return s[7]=r,s}const kc=n=>({}),rr=n=>({});function qo(n){const e=n.slice(),i=e[7].component;return e[86]=i,e}const Pc=n=>({linked:n[0]&512,hovering:n[0]&1024,connecting:n[0]&2048}),ar=n=>{var e;return{linked:((e=n[9])==null?void 0:e.size)>=1,hovering:n[10],connecting:n[11]}};function lr(n){var s;let e,i;return e=new bc({props:{output:n[2],input:n[1],connecting:n[11],hovering:n[10],bgColor:n[0],connected:((s=n[9])==null?void 0:s.size)>=1}}),{c(){ue(e.$$.fragment)},m(r,l){oe(e,r,l),i=!0},p(r,l){var h;const u={};l[0]&4&&(u.output=r[2]),l[0]&2&&(u.input=r[1]),l[0]&2048&&(u.connecting=r[11]),l[0]&1024&&(u.hovering=r[10]),l[0]&1&&(u.bgColor=r[0]),l[0]&512&&(u.connected=((h=r[9])==null?void 0:h.size)>=1),e.$set(u)},i(r){i||(D(e.$$.fragment,r),i=!0)},o(r){F(e.$$.fragment,r),i=!1},d(r){se(e,r)}}}function Lc(n){let e,i,s=!n[5]&&lr(n);return{c(){s&&s.c(),e=De()},m(r,l){s&&s.m(r,l),tt(r,e,l),i=!0},p(r,l){r[5]?s&&(ye(),F(s,1,1,()=>{s=null}),be()):s?(s.p(r,l),l[0]&32&&D(s,1)):(s=lr(r),s.c(),D(s,1),s.m(e.parentNode,e))},i(r){i||(D(s),i=!0)},o(r){F(s),i=!1},d(r){r&&q(e),s&&s.d(r)}}}function ur(n){let e,i;return e=new cl({props:{edge:n[7],$$slots:{default:[Tc]},$$scope:{ctx:n}}}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const l={};r[0]&512&&(l.edge=s[7]),r[0]&512|r[1]&8388608&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Cc(n){let e,i;return e=new hl({}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Sc(n){let e,i;return e=new n[86]({}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Mc(n){let e,i,s,r;const l=[Sc,Cc],u=[];function h(f,d){return f[86]?0:1}return e=h(n),i=u[e]=l[e](n),{c(){i.c(),s=De()},m(f,d){u[e].m(f,d),tt(f,s,d),r=!0},p(f,d){let p=e;e=h(f),e!==p&&(ye(),F(u[p],1,1,()=>{u[p]=null}),be(),i=u[e],i||(i=u[e]=l[e](f),i.c()),D(i,1),i.m(s.parentNode,s))},i(f){r||(D(i),r=!0)},o(f){F(i),r=!1},d(f){f&&q(s),u[e].d(f)}}}function Tc(n){let e;const i=n[50].edge,s=ke(i,n,n[54],rr),r=s||Mc(n);return{c(){r&&r.c()},m(l,u){r&&r.m(l,u),e=!0},p(l,u){s?s.p&&(!e||u[1]&8388608)&&Le(s,i,l,l[54],e?Pe(i,l[54],u,kc):Ce(l[54]),rr):r&&r.p&&(!e||u[0]&512)&&r.p(l,e?u:[-1,-1,-1])},i(l){e||(D(r,l),e=!0)},o(l){F(r,l),e=!1},d(l){r&&r.d(l)}}}function cr(n,e){let i,s,r,l=e[7]&&e[7].source===e[23]&&ur(qo(e));return{key:n,first:null,c(){i=De(),l&&l.c(),s=De(),this.first=i},m(u,h){tt(u,i,h),l&&l.m(u,h),tt(u,s,h),r=!0},p(u,h){e=u,e[7]&&e[7].source===e[23]?l?(l.p(qo(e),h),h[0]&512&&D(l,1)):(l=ur(qo(e)),l.c(),D(l,1),l.m(s.parentNode,s)):l&&(ye(),F(l,1,1,()=>{l=null}),be())},i(u){r||(D(l),r=!0)},o(u){F(l),r=!1},d(u){u&&(q(i),q(s)),l&&l.d(u)}}}function hr(n){let e,i,s=n[7]&&Ec(or(n));return{c(){s&&s.c(),e=De()},m(r,l){s&&s.m(r,l),tt(r,e,l),i=!0},p(r,l){r[7]&&s.p(or(r),l)},i(r){i||(D(s),i=!0)},o(r){F(s),i=!1},d(r){r&&q(e),s&&s.d(r)}}}function Ec(n){let e,i;return e=new cl({props:{edge:n[7],$$slots:{default:[Oc]},$$scope:{ctx:n}}}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const l={};r[1]&8388608&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function zc(n){let e,i;return e=new hl({}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Ac(n){let e,i;return e=new n[86]({}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Nc(n){let e,i,s,r;const l=[Ac,zc],u=[];function h(f,d){return f[86]?0:1}return e=h(n),i=u[e]=l[e](n),{c(){i.c(),s=De()},m(f,d){u[e].m(f,d),tt(f,s,d),r=!0},p:Ht,i(f){r||(D(i),r=!0)},o(f){F(i),r=!1},d(f){f&&q(s),u[e].d(f)}}}function Oc(n){let e;const i=n[50].edge,s=ke(i,n,n[54],ir),r=s||Nc(n);return{c(){r&&r.c()},m(l,u){r&&r.m(l,u),e=!0},p(l,u){s&&s.p&&(!e||u[1]&8388608)&&Le(s,i,l,l[54],e?Pe(i,l[54],u,wc):Ce(l[54]),ir)},i(l){e||(D(r,l),e=!0)},o(l){F(r,l),e=!1},d(l){r&&r.d(l)}}}function Ic(n){let e,i,s,r=[],l=new Map,u,h,f,d,p;const g=n[50].default,b=ke(g,n,n[54],ar),w=b||Lc(n);let P=Ae(Array.from(n[9]));const M=A=>A[87].id;for(let A=0;A<P.length;A+=1){let T=sr(n,P,A),I=M(T);l.set(I,r[A]=cr(I,T))}let E=n[11]&&hr(Yo(n));return{c(){var A;e=z("div"),w&&w.c(),s=$();for(let T=0;T<r.length;T+=1)r[T].c();u=$(),E&&E.c(),h=De(),m(e,"id",(A=n[23])==null?void 0:A.id),m(e,"class","anchor-wrapper svelte-bazd6o"),m(e,"role","button"),m(e,"tabindex","0"),m(e,"title",i=n[6]||""),Vt(e,"locked",n[4])},m(A,T){tt(A,e,T),w&&w.m(e,null),n[53](e),tt(A,s,T);for(let I=0;I<r.length;I+=1)r[I]&&r[I].m(A,T);tt(A,u,T),E&&E.m(A,T),tt(A,h,T),f=!0,d||(p=[_t(e,"mouseenter",n[51]),_t(e,"mouseleave",n[52]),_t(e,"mousedown",qn(Hn(n[25]))),_t(e,"mouseup",qn(n[24])),_t(e,"touchstart",qn(Hn(n[25]))),_t(e,"touchend",qn(n[24]))],d=!0)},p(A,T){b?b.p&&(!f||T[0]&3584|T[1]&8388608)&&Le(b,g,A,A[54],f?Pe(g,A[54],T,Pc):Ce(A[54]),ar):w&&w.p&&(!f||T[0]&3623)&&w.p(A,f?T:[-1,-1,-1]),(!f||T[0]&64&&i!==(i=A[6]||""))&&m(e,"title",i),(!f||T[0]&16)&&Vt(e,"locked",A[4]),T[0]&8405504|T[1]&8388608&&(P=Ae(Array.from(A[9])),ye(),r=hi(r,T,M,1,A,P,l,u.parentNode,Ji,cr,u,sr),be()),A[11]?E?(E.p(Yo(A),T),T[0]&2048&&D(E,1)):(E=hr(Yo(A)),E.c(),D(E,1),E.m(h.parentNode,h)):E&&(ye(),F(E,1,1,()=>{E=null}),be())},i(A){if(!f){D(w,A);for(let T=0;T<P.length;T+=1)D(r[T]);D(E),f=!0}},o(A){F(w,A);for(let T=0;T<r.length;T+=1)F(r[T]);F(E),f=!1},d(A){A&&(q(e),q(s),q(u),q(h)),w&&w.d(A),n[53](null);for(let T=0;T<r.length;T+=1)r[T].d(A);E&&E.d(A),d=!1,ln(p)}}}let Ko;const oi=Y(null);function Bc(n,e,i){if(e==="self")return;const s=n.parentNode;if(!s)return;s.removeChild(n);const r=document.querySelector(`#anchors-${e}-${i.id}`);r&&(r.appendChild(n),n&&i.recalculateAnchors())}function Zc(n,e,i){let s,r,l,u,h=Ht,f=()=>(h(),h=mn(dt,y=>i(55,u=y)),dt),d,p=Ht,g,b,w=Ht,P=()=>(w(),w=mn(r,y=>i(9,b=y)),r),M,E,A,T,I=Ht,W=()=>(I(),I=mn(l,y=>i(47,T=y)),l),V,U,K,nt;gt(n,oi,y=>i(42,d=y)),n.$$.on_destroy.push(()=>h()),n.$$.on_destroy.push(()=>p()),n.$$.on_destroy.push(()=>w()),n.$$.on_destroy.push(()=>I());let{$$slots:et={},$$scope:J}=e;const ut=de("dynamic"),B=de("node"),it=de("edgeStore"),X=de("cursorAnchor"),mt=de("direction"),ht=de("mounted");gt(n,ht,y=>i(49,U=y));const H=de("graph"),R=de("nodeStore"),Tt=de("graphEdge"),rt=de("nodeConnectEvent");gt(n,rt,y=>i(43,g=y));const bt=de("anchorsMounted");gt(n,bt,y=>i(56,K=y));const Et=de("flowchart")||void 0;let{bgColor:vt=null}=e,{id:j=0}=e,{input:Q=!1}=e,{output:G=!1}=e,{multiple:Z=G?!0:!Q}=e,{dynamic:It=ut||!1}=e,{edge:Xt=null}=e,{inputsStore:dt=null}=e;f();let{key:Mt=null}=e,{outputStore:zt=null}=e,{connections:Yt=[]}=e,{edgeColor:Kt=Y(null)}=e,{edgeLabel:ge=""}=e,{locked:Ne=!1}=e,{nodeConnect:ot=!1}=e,{edgeStyle:_e=null}=e,{endStyles:Jt=[null,null]}=e,{invisible:Ct=!1}=e,{direction:Qt=mt==="TD"?Q?"north":"south":Q?"west":"east"}=e,{title:qt=""}=e;const Gt=Zi(),Oe=Zi();let xe,$t=!1,Ke=!1,Se=0,he=Q===G?null:Q?"input":"output",me=[];const Me=B.edge,Te=B.anchors;gt(n,Te,y=>i(48,V=y));const Re=B.resizingWidth;gt(n,Re,y=>i(46,A=y));const Ue=B.resizingHeight;gt(n,Ue,y=>i(45,E=y));const rn=B.rotating;gt(n,rn,y=>i(44,M=y));const we=B.connections;gt(n,we,y=>i(57,nt=y));const je=`A-${j||Te.count()+1}/${B.id}`,Dt=rc(H,B,je,{x:0,y:0},{width:0,height:0},dt||zt||null,Xt||Me||Tt||null,he,Qt,It,Mt,Kt);Te.add(Dt,Dt.id),Fn(()=>{xe&&Dt.recalculatePosition();const y=Array.from(yt(B.anchors)).reduce((ft,[,kt])=>(kt.type==="output"&&ft++,ft),0);if(nt!=null&&nt.length&&!Q){const ft=[];let kt=null;nt.forEach((Pt,At)=>{Pt&&(kt===null&&(kt=At),(At-kt)%y===0?(me.push(Pt),ft.push(null)):ft.push(Pt))}),Zt(we,nt=ft,nt)}Zt(bt,K++,K)}),qa(()=>{xe&&Dt.recalculatePosition()}),$i(()=>{Pn(),cancelAnimationFrame(Ko)});function un(y){var ee;it.delete("cursor");const ft={x:y.changedTouches[0].clientX,y:y.changedTouches[0].clientY},kt=document.elementFromPoint(ft.x,ft.y);if(!kt)return;const Pt=kt.parentElement;if(!Pt)return;const At=Pt.id,O=At.split("/")[1],Wt=(ee=R.get(O))==null?void 0:ee.anchors.get(At);Wt&&(it.delete("cursor"),Ie(Dt,Wt,y))}function Ie(y,ft,kt){const Pt=kn(y,ft);Pt&&re(),kt.shiftKey||Xe(Pt)}function pn(y){if("changedTouches"in y&&s){un(y);return}if(!s){if(b!=null&&b.size&&!Z){it.delete("cursor"),y.shiftKey||Xe(!1);return}d&&Ee(y)}}function an(y){if(!Ne){if(b!=null&&b.size&&!Z&&!d)return Nn();if(!d)return cn();Ee(y)}}function cn(){Q===G?(Zt(oi,d={anchor:Dt,store:null,key:null},d),Je(Dt,X)):Q?(Zt(oi,d={anchor:Dt,store:dt,key:Mt},d),Je(X,Dt)):G&&(Zt(oi,d={anchor:Dt,store:zt,key:null},d),Je(Dt,X))}function Je(y,ft,kt=!1){const Pt={color:Kt,label:{text:ge}};kt&&(Pt.disconnect=!0),_e&&(Pt.type=_e),Jt[0]&&(Pt.start=Jt[0]),Jt[1]&&(Pt.start=Jt[1]);const At=Ys({source:y,target:ft},(y==null?void 0:y.edge)||null,Pt);it.add(At,"cursor")}function Ee(y){if(it.delete("cursor"),!d)return;const ft=d.anchor.type;if(d.anchor===Dt||ft===Dt.type&&ft){Xe(!1);return}Dt.recalculatePosition();let kt,Pt;Q===G?ft==="input"?(kt=Dt,Pt=d.anchor):(kt=d.anchor,Pt=Dt):Q?(kt=d.anchor,Pt=Dt):(kt=Dt,Pt=d.anchor),Ie(kt,Pt,y)}function kn(y,ft){if(y===ft||yt(y.connected).has(Dt))return!1;const kt={color:Kt,label:{text:ge}};if(Et){const At=y.node.id.slice(2),O=Et.nodeList[At];if(O){const Wt=ft.node.id.slice(2),ee=O.children.filter(te=>te.node.id===Wt)[0];if(ee){const te=ee;kt.label={text:te.content}}}}_e&&(kt.type=_e),Jt[0]&&(kt.start=Jt[0]),Jt[1]&&(kt.start=Jt[1]);const Pt=Ys({source:y,target:ft},(y==null?void 0:y.edge)||null,kt);return!y.node||!ft.node?!1:(it.add(Pt,new Set([y,ft,y.node,ft.node])),!0)}function re(){if(Q&&d&&d.store)u&&Mt&&dt&&typeof dt.set=="function"&&typeof dt.update=="function"&&Zt(dt,u[Mt]=d.store,u);else if(G&&d&&d.store){const{store:y,key:ft}=d;y&&ft&&typeof y.update=="function"&&y.update(kt=>(zt&&(kt[ft]=zt),kt))}}function ce(){u&&Mt&&u[Mt]&&Zt(dt,u[Mt]=Y(yt(u[Mt])),u)}function Xe(y){(y||!g)&&(Zt(oi,d=null,d),Zt(rt,g=null,g))}function Sn(){$t&&(xe&&Dt.recalculatePosition(),Ko=requestAnimationFrame(Sn))}function Pn(){it.delete("cursor"),it.match(Dt).forEach(ft=>it.delete(ft)),Xe(!1),ce()}function Nn(){if(yt(Dt.connected).size>1)return;const y=Array.from(yt(Dt.connected))[0];if(y.type!=="input")if(Pn(),y.type==="output"){Je(y,X,!0),ce();const ft=y.store;Zt(oi,d={anchor:y,store:ft,key:null},d)}else Je(y,X,!0),Zt(oi,d={anchor:y,store:null,key:null},d)}function zn(){me.forEach((y,ft)=>{if(!y)return;nn(y)&&i(26,Yt[ft]=null,Yt)}),i(41,me=me.filter(y=>y!==null))}function Be(){Yt.forEach(y=>{y&&nn(y)})}function wt(y){const ft=`N-${y[0]}`,kt=R.get(ft);if(!kt)return;const Pt=kt.anchors.get(`A-${y[1]}/N-${y[0]}`);if(!Pt)return;const At=it.match(Dt,Pt);At&&it.delete(At[0])}const nn=y=>{let ft,kt,Pt=null;Array.isArray(y)?(ft=y[0].toString(),kt=y[1].toString()):(ft=y.toString(),kt=null);const At=`N-${ft}`,O=R.get(At);if(!O)return!1;if(kt){const Wt=`A-${kt}/${At}`;Pt=O.anchors.get(Wt)||null}else{const Wt=yt(O.anchors),ee=Array.from(Wt.values());if(!ee.length)return!1;Pt=ee.reduce((te,We)=>!te&&We.type==="output"?null:We.type==="output"?te:!te||yt(We.connected).size<yt(te.connected).size?We:te,null)}if(!Pt)return!1;if(kn(Dt,Pt),Pt.store&&(dt||zt)){if(Q&&Pt.type==="output")u&&Mt&&dt&&typeof dt.set=="function"&&typeof dt.update=="function"&&Zt(dt,u[Mt]=Pt.store,u);else if(G&&Pt.type==="input"){const{store:Wt,inputKey:ee}=Pt;Wt&&ee&&typeof Wt.update=="function"&&Wt.update(te=>(zt&&(te[ee]=zt),te))}}return!0},On=()=>i(10,Ke=!0),on=()=>i(10,Ke=!1);function In(y){Kn[y?"unshift":"push"](()=>{xe=y,i(8,xe)})}return n.$$set=y=>{"bgColor"in y&&i(0,vt=y.bgColor),"id"in y&&i(27,j=y.id),"input"in y&&i(1,Q=y.input),"output"in y&&i(2,G=y.output),"multiple"in y&&i(28,Z=y.multiple),"dynamic"in y&&i(29,It=y.dynamic),"edge"in y&&i(7,Xt=y.edge),"inputsStore"in y&&f(i(3,dt=y.inputsStore)),"key"in y&&i(30,Mt=y.key),"outputStore"in y&&i(31,zt=y.outputStore),"connections"in y&&i(26,Yt=y.connections),"edgeColor"in y&&i(32,Kt=y.edgeColor),"edgeLabel"in y&&i(33,ge=y.edgeLabel),"locked"in y&&i(4,Ne=y.locked),"nodeConnect"in y&&i(34,ot=y.nodeConnect),"edgeStyle"in y&&i(35,_e=y.edgeStyle),"endStyles"in y&&i(36,Jt=y.endStyles),"invisible"in y&&i(5,Ct=y.invisible),"direction"in y&&i(37,Qt=y.direction),"title"in y&&i(6,qt=y.title),"$$scope"in y&&i(54,J=y.$$scope)},n.$$.update=()=>{if(n.$$.dirty[1]&2048&&i(11,s=(d==null?void 0:d.anchor)===Dt),n.$$.dirty[0]&536871168|n.$$.dirty[1]&65536&&It&&xe&&Bc(xe,T,B),n.$$.dirty[0]&67108864|n.$$.dirty[1]&262144&&U===R.count()&&Yt.length&&Be(),n.$$.dirty[1]&4104&&ot&&g&&pn(g),n.$$.dirty[1]&263168&&U===R.count()&&me.length&&zn(),n.$$.dirty[0]&768|n.$$.dirty[1]&196608&&xe&&Dt.recalculatePosition(),n.$$.dirty[1]&57600&&(!$t&&(A||E||M)?(i(39,$t=!0),Sn()):!A&&!E&&$t&&!M&&(i(39,$t=!1),cancelAnimationFrame(Ko))),n.$$.dirty[0]&512|n.$$.dirty[1]&512&&b){if(b.size<Se)Oe("disconnection",{node:B,anchor:Dt});else if(b.size>Se){const y=Array.from(b),ft=y[y.length-1];Gt("connection",{node:B,anchor:Dt,connectedNode:ft.node,connectedAnchor:ft})}i(40,Se=b.size)}},P(i(13,r=Dt&&Dt.connected)),W(i(12,l=Dt==null?void 0:Dt.direction)),[vt,Q,G,dt,Ne,Ct,qt,Xt,xe,b,Ke,s,l,r,it,ht,rt,bt,Te,Re,Ue,rn,we,Dt,pn,an,Yt,j,Z,It,Mt,zt,Kt,ge,ot,_e,Jt,Qt,wt,$t,Se,me,d,g,M,E,A,T,V,U,et,On,on,In,J]}class Lo extends wn{constructor(e){super(),bn(this,e,Zc,Ic,dn,{bgColor:0,id:27,input:1,output:2,multiple:28,dynamic:29,edge:7,inputsStore:3,key:30,outputStore:31,connections:26,edgeColor:32,edgeLabel:33,locked:4,nodeConnect:34,edgeStyle:35,endStyles:36,invisible:5,direction:37,title:6,disconnect:38},null,[-1,-1,-1])}get disconnect(){return this.$$.ctx[38]}}function fr(n){let e,i,s,r,l;return{c(){e=z("div"),i=$(),s=z("div"),m(e,"class","left svelte-1ryxg7v"),Vt(e,"width",n[0]),m(s,"class","right svelte-1ryxg7v"),Vt(s,"width",n[0])},m(u,h){tt(u,e,h),tt(u,i,h),tt(u,s,h),r||(l=[pi(n[16].call(null,e,{left:n[3]})),pi(n[16].call(null,s,{right:n[4]}))],r=!0)},p(u,h){h[0]&1&&Vt(e,"width",u[0]),h[0]&1&&Vt(s,"width",u[0])},d(u){u&&(q(e),q(i),q(s)),r=!1,ln(l)}}}function dr(n){let e,i,s,r,l;return{c(){e=z("div"),i=$(),s=z("div"),m(e,"class","top svelte-1ryxg7v"),Vt(e,"height",n[1]),m(s,"class","bottom svelte-1ryxg7v"),Vt(s,"height",n[1])},m(u,h){tt(u,e,h),tt(u,i,h),tt(u,s,h),r||(l=[pi(n[16].call(null,e,{top:n[5]})),pi(n[16].call(null,s,{bottom:n[6]}))],r=!0)},p(u,h){h[0]&2&&Vt(e,"height",u[1]),h[0]&2&&Vt(s,"height",u[1])},d(u){u&&(q(e),q(i),q(s)),r=!1,ln(l)}}}function Dc(n){let e,i,s;return{c(){e=z("div"),m(e,"class","svelte-1ryxg7v"),Vt(e,"both",n[7])},m(r,l){tt(r,e,l),i||(s=pi(n[16].call(null,e,{both:n[7]})),i=!0)},p:Ht,d(r){r&&q(e),i=!1,s()}}}function _r(n){let e,i,s;return{c(){e=z("div"),m(e,"class","svelte-1ryxg7v"),Vt(e,"rotation",n[2])},m(r,l){tt(r,e,l),i||(s=pi(n[17].call(null,e)),i=!0)},p(r,l){l[0]&4&&Vt(e,"rotation",r[2])},d(r){r&&q(e),i=!1,s()}}}function xc(n){let e,i,s,r,l=n[0]&&fr(n),u=n[1]&&dr(n),h=n[7]&&Dc(n),f=n[2]&&_r(n);return{c(){l&&l.c(),e=$(),u&&u.c(),i=$(),h&&h.c(),s=$(),f&&f.c(),r=De()},m(d,p){l&&l.m(d,p),tt(d,e,p),u&&u.m(d,p),tt(d,i,p),h&&h.m(d,p),tt(d,s,p),f&&f.m(d,p),tt(d,r,p)},p(d,p){d[0]?l?l.p(d,p):(l=fr(d),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),d[1]?u?u.p(d,p):(u=dr(d),u.c(),u.m(i.parentNode,i)):u&&(u.d(1),u=null),d[7]&&h.p(d,p),d[2]?f?f.p(d,p):(f=_r(d),f.c(),f.m(r.parentNode,r)):f&&(f.d(1),f=null)},i:Ht,o:Ht,d(d){d&&(q(e),q(i),q(s),q(r)),l&&l.d(d),u&&u.d(d),h&&h.d(d),f&&f.d(d)}}}function Rc(n){return n*(180/Math.PI)}function jc(n,e,i){let s,r,l,u,h,f,d,p,g,b,w,P;gt(n,Dn,dt=>i(38,d=dt));const M=de("graph"),E=de("node"),A=de("resized");let{width:T=!1}=e,{height:I=!1}=e,{rotation:W=!1}=e,{minHeight:V=0}=e,{minWidth:U=0}=e,K,nt=T,et=T,J=I,ut=I,B=T&&I,it=0,X=0,mt=yt(E.position);const ht=E.position;gt(n,ht,dt=>i(32,w=dt));const H=E.resizingWidth;gt(n,H,dt=>i(31,b=dt));const R=E.resizingHeight;gt(n,R,dt=>i(30,g=dt));const Tt=E.rotating;gt(n,Tt,dt=>i(28,f=dt));const rt=E.rotation;gt(n,rt,dt=>i(29,p=dt));const bt=E.dimensions.height;gt(n,bt,dt=>i(26,u=dt));const Et=E.dimensions.width;gt(n,Et,dt=>i(27,h=dt));const vt=M.cursor;gt(n,vt,dt=>i(33,P=dt));let j,Q,G=1;Fn(()=>{try{K=document.querySelector(`#${E.id}`),K&&i(19,[U,V]=Go(K),U,i(18,V))}catch(dt){console.error(dt)}});function Z(dt,Mt){const zt=Kt=>{Kt.stopPropagation(),Kt.preventDefault(),Mt.left||Mt.top?i(23,G=-1):i(23,G=1),es.set(!0),Zt(Dn,d=yt(vt),d),i(21,j=h),i(22,Q=u),i(20,mt=w),Mt.both?Zt(H,b=!0,b):Zt(H,b=!1,b),Zt(H,b=Mt.left||Mt.right||Mt.both||!1,b),Zt(R,g=Mt.top||Mt.bottom||Mt.both||!1,g),K&&i(19,[U,V]=Go(K),U,i(18,V)),window.addEventListener("mouseup",Yt)},Yt=()=>{Zt(H,b=!1,b),Zt(R,g=!1,g),es.set(!1),window.removeEventListener("mouseup",Yt)};return dt.addEventListener("mousedown",zt),{destroy(){dt.removeEventListener("mousedown",zt)}}}function It(dt){const Mt=Yt=>{Yt.stopPropagation(),Yt.preventDefault(),it=p,Zt(Dn,d=yt(vt),d);const Kt=d.x-l.x,ge=d.y-l.y;X=Math.atan2(ge,Kt),Zt(Tt,f=!0,f),window.addEventListener("mouseup",zt)},zt=()=>{Zt(Tt,f=!1,f),window.removeEventListener("mouseup",zt)};return dt.addEventListener("mousedown",Mt),{destroy(){dt.removeEventListener("mousedown",Mt)}}}function Xt(){const dt=yt(vt),Mt=dt.x-l.x,zt=dt.y-l.y,Yt=Math.atan2(zt,Mt),Kt=X-Yt;return it-Rc(Kt)}return mu(()=>{K&&i(19,[U,V]=Go(K),U,i(18,V)),h<U&&A.set(!1),u<V&&A.set(!1)}),n.$$set=dt=>{"width"in dt&&i(0,T=dt.width),"height"in dt&&i(1,I=dt.height),"rotation"in dt&&i(2,W=dt.rotation),"minHeight"in dt&&i(18,V=dt.minHeight),"minWidth"in dt&&i(19,U=dt.minWidth)},n.$$.update=()=>{if(n.$$.dirty[0]&268435456|n.$$.dirty[1]&4&&f&&Zt(rt,p=Xt(),p),n.$$.dirty[0]&1624506368|n.$$.dirty[1]&4&&g){const dt=yt(Dn),Mt=P,zt=Math.max(V,Q+(Mt.y-dt.y)*G);zt>V?(A.set(!0),Zt(bt,u=zt,u)):A.set(!1),G===-1&&Zt(ht,w={x:mt.x,y:mt.y+Mt.y-dt.y},w),p!==0&&E.position.update(Yt=>({y:mt.y-(zt-Q)/2,x:Yt.x}))}if(n.$$.dirty[0]&548929536|n.$$.dirty[1]&5&&b){const dt=yt(Dn),Mt=P,zt=Math.max(U,j+(Mt.x-dt.x)*G);zt>U?(A.set(!0),Zt(Et,h=zt,h)):A.set(!1),G===-1&&Zt(ht,w={x:mt.x+Mt.x-dt.x,y:mt.y},w),p!==0&&E.position.update(Yt=>({x:mt.x-(zt-j)/2,y:Yt.y}))}n.$$.dirty[1]&2&&i(25,s=w.x),n.$$.dirty[1]&2&&i(24,r=w.y),n.$$.dirty[0]&251658240&&(l={x:s+h/2,y:r+u/2})},[T,I,W,nt,et,J,ut,B,ht,H,R,Tt,rt,bt,Et,vt,Z,It,V,U,mt,j,Q,G,r,s,u,h,f,p,g,b,w,P]}class Wc extends wn{constructor(e){super(),bn(this,e,jc,xc,dn,{width:0,height:1,rotation:2,minHeight:18,minWidth:19},null,[-1,-1])}}function mr(n,e,i){const s=n.slice();return s[28]=e[i],s[34]=i,s}function pr(n,e,i){const s=n.slice();return s[28]=e[i],s[34]=i,s}function gr(n,e,i){const s=n.slice();return s[28]=e[i],s}function vr(n,e,i){const s=n.slice();return s[28]=e[i],s}function Hc(n){let e,i=[],s=new Map,r,l,u=[],h=new Map,f,d=Ae({length:n[2]});const p=w=>w[34];for(let w=0;w<d.length;w+=1){let P=pr(n,d,w),M=p(P);s.set(M,i[w]=yr(M,P))}let g=Ae({length:n[3]});const b=w=>w[34];for(let w=0;w<g.length;w+=1){let P=mr(n,g,w),M=b(P);h.set(M,u[w]=br(M,P))}return{c(){e=z("div");for(let w=0;w<i.length;w+=1)i[w].c();r=$(),l=z("div");for(let w=0;w<u.length;w+=1)u[w].c();m(e,"class","input-anchors svelte-j5bq7k"),Vt(e,"top",n[14]),Vt(e,"left",n[16]),m(l,"class","output-anchors svelte-j5bq7k"),Vt(l,"bottom",n[15]),Vt(l,"right",n[17])},m(w,P){tt(w,e,P);for(let M=0;M<i.length;M+=1)i[M]&&i[M].m(e,null);tt(w,r,P),tt(w,l,P);for(let M=0;M<u.length;M+=1)u[M]&&u[M].m(l,null);f=!0},p(w,P){P[0]&16388&&(d=Ae({length:w[2]}),ye(),i=hi(i,P,p,1,w,d,s,e,Ji,yr,null,pr),be()),P[0]&16392&&(g=Ae({length:w[3]}),ye(),u=hi(u,P,b,1,w,g,h,l,Ji,br,null,mr),be())},i(w){if(!f){for(let P=0;P<d.length;P+=1)D(i[P]);for(let P=0;P<g.length;P+=1)D(u[P]);f=!0}},o(w){for(let P=0;P<i.length;P+=1)F(i[P]);for(let P=0;P<u.length;P+=1)F(u[P]);f=!1},d(w){w&&(q(e),q(r),q(l));for(let P=0;P<i.length;P+=1)i[P].d();for(let P=0;P<u.length;P+=1)u[P].d()}}}function Fc(n){let e,i,s,r=Ae({length:n[2]}),l=[];for(let p=0;p<r.length;p+=1)l[p]=wr(vr(n,r,p));const u=p=>F(l[p],1,1,()=>{l[p]=null});let h=Ae({length:n[3]}),f=[];for(let p=0;p<h.length;p+=1)f[p]=kr(gr(n,h,p));const d=p=>F(f[p],1,1,()=>{f[p]=null});return{c(){for(let p=0;p<l.length;p+=1)l[p].c();e=$();for(let p=0;p<f.length;p+=1)f[p].c();i=De()},m(p,g){for(let b=0;b<l.length;b+=1)l[b]&&l[b].m(p,g);tt(p,e,g);for(let b=0;b<f.length;b+=1)f[b]&&f[b].m(p,g);tt(p,i,g),s=!0},p(p,g){if(g[0]&4){const b=r.length;r=Ae({length:p[2]});let w;for(w=b;w<r.length;w+=1){const P=vr(p,r,w);l[w]?D(l[w],1):(l[w]=wr(P),l[w].c(),D(l[w],1),l[w].m(e.parentNode,e))}for(ye(),w=r.length;w<l.length;w+=1)u(w);be()}if(g[0]&8){const b=h.length;h=Ae({length:p[3]});let w;for(w=b;w<h.length;w+=1){const P=gr(p,h,w);f[w]?D(f[w],1):(f[w]=kr(P),f[w].c(),D(f[w],1),f[w].m(i.parentNode,i))}for(ye(),w=h.length;w<f.length;w+=1)d(w);be()}},i(p){if(!s){for(let g=0;g<r.length;g+=1)D(l[g]);for(let g=0;g<h.length;g+=1)D(f[g]);s=!0}},o(p){l=l.filter(Boolean);for(let g=0;g<l.length;g+=1)F(l[g]);f=f.filter(Boolean);for(let g=0;g<f.length;g+=1)F(f[g]);s=!1},d(p){p&&(q(e),q(i)),ki(l,p),ki(f,p)}}}function yr(n,e){let i,s,r;return s=new Lo({props:{input:!0,direction:e[14]?"north":"west"}}),s.$on("connection",e[22]),s.$on("disconnection",e[23]),{key:n,first:null,c(){i=De(),ue(s.$$.fragment),this.first=i},m(l,u){tt(l,i,u),oe(s,l,u),r=!0},p(l,u){e=l},i(l){r||(D(s.$$.fragment,l),r=!0)},o(l){F(s.$$.fragment,l),r=!1},d(l){l&&q(i),se(s,l)}}}function br(n,e){let i,s,r;return s=new Lo({props:{output:!0,direction:e[14]?"south":"east"}}),s.$on("connection",e[24]),s.$on("disconnection",e[25]),{key:n,first:null,c(){i=De(),ue(s.$$.fragment),this.first=i},m(l,u){tt(l,i,u),oe(s,l,u),r=!0},p(l,u){e=l},i(l){r||(D(s.$$.fragment,l),r=!0)},o(l){F(s.$$.fragment,l),r=!1},d(l){l&&q(i),se(s,l)}}}function wr(n){let e,i;return e=new Lo({}),e.$on("connection",n[18]),e.$on("disconnection",n[19]),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function kr(n){let e,i;return e=new Lo({}),e.$on("connection",n[20]),e.$on("disconnection",n[21]),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Pr(n){let e,i;return e=new Wc({props:{width:!0,height:!0,rotation:!0}}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Gc(n){let e,i,s,r,l,u,h,f=`${n[1]}px`,d;const p=[Fc,Hc],g=[];function b(P,M){return P[7]?0:1}i=b(n),s=g[i]=p[i](n);let w=n[6]&&Pr();return{c(){e=z("div"),s.c(),r=$(),l=z("p"),u=Ge(n[5]),h=$(),w&&w.c(),m(l,"class","svelte-j5bq7k"),st(l,"color",n[4]),m(e,"class","default-node svelte-j5bq7k"),Vt(e,"selected",n[0]),st(e,"border-radius",f)},m(P,M){tt(P,e,M),g[i].m(e,null),k(e,r),k(e,l),k(l,u),k(e,h),w&&w.m(e,null),d=!0},p(P,M){s.p(P,M),(!d||M[0]&32)&&Cn(u,P[5]),M[0]&16&&st(l,"color",P[4]),P[6]?w?M[0]&64&&D(w,1):(w=Pr(),w.c(),D(w,1),w.m(e,null)):w&&(ye(),F(w,1,1,()=>{w=null}),be()),(!d||M[0]&1)&&Vt(e,"selected",P[0]),M[0]&2&&f!==(f=`${P[1]}px`)&&st(e,"border-radius",f)},i(P){d||(D(s),D(w),d=!0)},o(P){F(s),F(w),d=!1},d(P){P&&q(e),g[i].d(),w&&w.d()}}}function Uc(n,e,i){let s,r,l,u,h,f;const d=de("dynamic"),p=de("node");let{selected:g}=e;const b=p.label;gt(n,b,mt=>i(5,h=mt));const w=p.borderRadius;gt(n,w,mt=>i(1,s=mt));const P=p.textColor;gt(n,P,mt=>i(4,u=mt));const M=p.inputs;gt(n,M,mt=>i(2,r=mt));const E=p.outputs;gt(n,E,mt=>i(3,l=mt));const A=p.resizable;gt(n,A,mt=>i(6,f=mt));const T=yt(p.direction);let I=T==="TD",W=T==="TD",V=T!=="TD",U=T!=="TD";function K(mt){qe.call(this,n,mt)}function nt(mt){qe.call(this,n,mt)}function et(mt){qe.call(this,n,mt)}function J(mt){qe.call(this,n,mt)}function ut(mt){qe.call(this,n,mt)}function B(mt){qe.call(this,n,mt)}function it(mt){qe.call(this,n,mt)}function X(mt){qe.call(this,n,mt)}return n.$$set=mt=>{"selected"in mt&&i(0,g=mt.selected)},[g,s,r,l,u,h,f,d,b,w,P,M,E,A,I,W,V,U,K,nt,et,J,ut,B,it,X]}class Vc extends wn{constructor(e){super(),bn(this,e,Uc,Gc,dn,{selected:0},null,[-1,-1])}}const Xc=n=>({}),Lr=n=>({}),Yc=n=>({}),Cr=n=>({}),qc=n=>({}),Sr=n=>({}),Kc=n=>({}),Mr=n=>({}),Jc=n=>({selected:n[0]&2048}),Tr=n=>({grabHandle:n[50],selected:n[11],destroy:n[48]}),Qc=n=>({selected:n[0]&2048}),Er=n=>({grabHandle:n[50],selected:n[11],destroy:n[48]});function zr(n){let e,i,s,r,l,u,h,f,d,p,g,b,w,P,M,E=`${n[14].y}px`,A=`${n[14].x}px`,T=`rotate(${n[20]}deg)`,I,W,V;const U=[th,$c],K=[];function nt(H,R){return H[12]?1:0}i=nt(n),s=K[i]=U[i](n);const et=n[61].anchorWest,J=ke(et,n,n[60],Mr),ut=n[61].anchorEast,B=ke(ut,n,n[60],Sr),it=n[61].anchorNorth,X=ke(it,n,n[60],Cr),mt=n[61].anchorSouth,ht=ke(mt,n,n[60],Lr);return{c(){e=z("div"),s.c(),r=$(),l=z("div"),J&&J.c(),h=$(),f=z("div"),B&&B.c(),p=$(),g=z("div"),X&&X.c(),w=$(),P=z("div"),ht&&ht.c(),m(l,"id",u=`anchors-west-${n[0].id}`),m(l,"class","anchors left svelte-1iknrz0"),m(f,"id",d=`anchors-east-${n[0].id}`),m(f,"class","anchors right svelte-1iknrz0"),m(g,"id",b=`anchors-north-${n[0].id}`),m(g,"class","anchors top svelte-1iknrz0"),m(P,"id",M=`anchors-south-${n[0].id}`),m(P,"class","anchors bottom svelte-1iknrz0"),m(e,"id",n[30]),m(e,"class","svelvet-node svelte-1iknrz0"),m(e,"role","button"),m(e,"title",n[10]),m(e,"tabindex",0),Vt(e,"selected",n[11]),Vt(e,"locked",n[16]||n[15]),st(e,"top",E),st(e,"left",A),st(e,"z-index",n[17]),st(e,"width",n[12]?n[19]+"px":"fit-content"),st(e,"height",n[12]?n[18]+"px":"fit-content"),st(e,"transform",T),st(e,"--prop-background-color",n[21]||(n[1]||n[2]?null:"transparent")),st(e,"--prop-text-color",n[22]),st(e,"--prop-border-color",n[23]),st(e,"--prop-selection-color",n[24]),st(e,"--prop-border-radius",n[25]?`${n[25]}px`:n[1]||n[2]?null:"0px"),st(e,"--prop-border-width",n[26]||(n[1]||n[2]?null:"0px"))},m(H,R){tt(H,e,R),K[i].m(e,null),k(e,r),k(e,l),J&&J.m(l,null),k(e,h),k(e,f),B&&B.m(f,null),k(e,p),k(e,g),X&&X.m(g,null),k(e,w),k(e,P),ht&&ht.m(P,null),I=!0,W||(V=[_t(e,"contextmenu",qn(Hn(n[62]))),_t(e,"mouseup",n[49]),pi(n[50].call(null,e))],W=!0)},p(H,R){let Tt=i;i=nt(H),i===Tt?K[i].p(H,R):(ye(),F(K[Tt],1,1,()=>{K[Tt]=null}),be(),s=K[i],s?s.p(H,R):(s=K[i]=U[i](H),s.c()),D(s,1),s.m(e,r)),J&&J.p&&(!I||R[1]&536870912)&&Le(J,et,H,H[60],I?Pe(et,H[60],R,Kc):Ce(H[60]),Mr),(!I||R[0]&1&&u!==(u=`anchors-west-${H[0].id}`))&&m(l,"id",u),B&&B.p&&(!I||R[1]&536870912)&&Le(B,ut,H,H[60],I?Pe(ut,H[60],R,qc):Ce(H[60]),Sr),(!I||R[0]&1&&d!==(d=`anchors-east-${H[0].id}`))&&m(f,"id",d),X&&X.p&&(!I||R[1]&536870912)&&Le(X,it,H,H[60],I?Pe(it,H[60],R,Yc):Ce(H[60]),Cr),(!I||R[0]&1&&b!==(b=`anchors-north-${H[0].id}`))&&m(g,"id",b),ht&&ht.p&&(!I||R[1]&536870912)&&Le(ht,mt,H,H[60],I?Pe(mt,H[60],R,Xc):Ce(H[60]),Lr),(!I||R[0]&1&&M!==(M=`anchors-south-${H[0].id}`))&&m(P,"id",M),(!I||R[0]&1024)&&m(e,"title",H[10]),(!I||R[0]&2048)&&Vt(e,"selected",H[11]),(!I||R[0]&98304)&&Vt(e,"locked",H[16]||H[15]),R[0]&16384&&E!==(E=`${H[14].y}px`)&&st(e,"top",E),R[0]&16384&&A!==(A=`${H[14].x}px`)&&st(e,"left",A),R[0]&131072&&st(e,"z-index",H[17]),R[0]&528384&&st(e,"width",H[12]?H[19]+"px":"fit-content"),R[0]&266240&&st(e,"height",H[12]?H[18]+"px":"fit-content"),R[0]&1048576&&T!==(T=`rotate(${H[20]}deg)`)&&st(e,"transform",T),R[0]&2097158&&st(e,"--prop-background-color",H[21]||(H[1]||H[2]?null:"transparent")),R[0]&4194304&&st(e,"--prop-text-color",H[22]),R[0]&8388608&&st(e,"--prop-border-color",H[23]),R[0]&16777216&&st(e,"--prop-selection-color",H[24]),R[0]&33554438&&st(e,"--prop-border-radius",H[25]?`${H[25]}px`:H[1]||H[2]?null:"0px"),R[0]&67108870&&st(e,"--prop-border-width",H[26]||(H[1]||H[2]?null:"0px"))},i(H){I||(D(s),D(J,H),D(B,H),D(X,H),D(ht,H),I=!0)},o(H){F(s),F(J,H),F(B,H),F(X,H),F(ht,H),I=!1},d(H){H&&q(e),K[i].d(),J&&J.d(H),B&&B.d(H),X&&X.d(H),ht&&ht.d(H),W=!1,ln(V)}}}function $c(n){let e;const i=n[61].default,s=ke(i,n,n[60],Tr);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[0]&2048|l[1]&536870912)&&Le(s,i,r,r[60],e?Pe(i,r[60],l,Jc):Ce(r[60]),Tr)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function th(n){let e,i,s;const r=n[61].default,l=ke(r,n,n[60],Er);return{c(){e=z("div"),l&&l.c(),Pi(()=>n[63].call(e)),st(e,"width","fit-content"),st(e,"height","fit-content")},m(u,h){tt(u,e,h),l&&l.m(e,null),i=du(e,n[63].bind(e)),s=!0},p(u,h){l&&l.p&&(!s||h[0]&2048|h[1]&536870912)&&Le(l,r,u,u[60],s?Pe(r,u[60],h,Qc):Ce(u[60]),Er)},i(u){s||(D(l,u),s=!0)},o(u){F(l,u),s=!1},d(u){u&&q(e),l&&l.d(u),i()}}}function eh(n){let e,i,s=!n[13]&&zr(n);return{c(){s&&s.c(),e=De()},m(r,l){s&&s.m(r,l),tt(r,e,l),i=!0},p(r,l){r[13]?s&&(ye(),F(s,1,1,()=>{s=null}),be()):s?(s.p(r,l),l[0]&8192&&D(s,1)):(s=zr(r),s.c(),D(s,1),s.m(e.parentNode,e))},i(r){i||(D(s),i=!0)},o(r){F(s),i=!1},d(r){r&&q(e),s&&s.d(r)}}}const nh=new Set(["INPUT","SELECT","BUTTON","TEXTAREA"]);function ih(n,e,i){let s,r,l,u,h,f,d,p=Ht,g=()=>(p(),p=mn($t,O=>i(66,d=O)),$t),b,w=Ht,P=()=>(w(),w=mn(me,O=>i(67,b=O)),me),M,E,A=Ht,T=()=>(A(),A=mn(Me,O=>i(68,E=O)),Me),I,W,V,U=Ht,K=()=>(U(),U=mn(Te,O=>i(71,V=O)),Te),nt,et,J,ut=Ht,B=()=>(ut(),ut=mn(xe,O=>i(16,J=O)),xe),it,X=Ht,mt=()=>(X(),X=mn(Ke,O=>i(73,it=O)),Ke),ht,H,R,Tt,rt=Ht,bt=()=>(rt(),rt=mn(Se,O=>i(75,Tt=O)),Se),Et,vt,j,Q,G,Z,It,Xt,dt,Mt,zt,Yt;gt(n,Dn,O=>i(65,f=O)),gt(n,Wn,O=>i(70,W=O)),n.$$.on_destroy.push(()=>p()),n.$$.on_destroy.push(()=>w()),n.$$.on_destroy.push(()=>A()),n.$$.on_destroy.push(()=>U()),n.$$.on_destroy.push(()=>ut()),n.$$.on_destroy.push(()=>X()),n.$$.on_destroy.push(()=>rt());let{$$slots:Kt={},$$scope:ge}=e;const Ne=de("mounted"),ot=de("duplicate");gt(n,ot,O=>i(56,vt=O));const _e=de("graphDOMElement");gt(n,_e,O=>i(74,H=O));const Jt=Zi();let{node:Ct}=e,{isDefault:Qt}=e,{useDefaults:qt}=e,{center:Gt}=e,{nodeStore:Oe}=e,{locked:xe}=e;B();let{groups:$t}=e;g();let{maxZIndex:Ke}=e;mt();let{centerPoint:Se}=e;bt();let{cursor:he}=e,{initialNodePositions:me}=e;P();let{activeGroup:Me}=e;T();let{editing:Te}=e;K();let{dimensionsProvided:Re=!1}=e,{title:Ue}=e;const rn=Y(0),we=Y(null);gt(n,we,O=>i(64,h=O));const je=Ct.id,Dt=Ct.position;gt(n,Dt,O=>i(59,G=O));const un=Ct.dimensions.width;gt(n,un,O=>i(19,Et=O));const Ie=Ct.dimensions.height;gt(n,Ie,O=>i(18,R=O));const pn=Ct.selectionColor;gt(n,pn,O=>i(24,Mt=O));const an=Ct.editable;gt(n,an,O=>i(72,nt=O));const cn=Ct.locked;gt(n,cn,O=>i(15,et=O));const Je=Ct.zIndex;gt(n,Je,O=>i(17,ht=O));const Ee=Ct.bgColor;gt(n,Ee,O=>i(21,It=O));const kn=Ct.borderRadius;gt(n,kn,O=>i(25,zt=O));const re=Ct.textColor;gt(n,re,O=>i(22,Xt=O));const ce=Ct.group;gt(n,ce,O=>i(69,I=O));const Xe=Ct.borderColor;gt(n,Xe,O=>i(23,dt=O));const Sn=Ct.borderWidth;gt(n,Sn,O=>i(26,Yt=O));const Pn=Ct.rotation;gt(n,Pn,O=>i(20,Z=O));const{selected:Nn,hidden:zn}=d,Be=zn.nodes;gt(n,Be,O=>i(58,Q=O));const wt=Nn.nodes;gt(n,wt,O=>i(55,M=O));const nn=Y(!1);gt(n,nn,O=>i(57,j=O)),Ze("node",Ct),Ze("anchorsMounted",rn),Ze("resized",nn),Ze("nodeConnectEvent",we),Fn(()=>{if(Gt){const O={x:Tt.x-Et/2,y:Tt.y-R/2};Ct.position.set(O),Wn.set(!0),Wn.set(!1)}Ne.update(O=>O+1)}),$i(()=>{r&&(M.delete(Ct),wt.set(M)),Ne.update(O=>O-1)});function On(){r?(Ct&&M.delete(Ct),wt.set(M)):(Ct&&M.add(Ct),wt.set(M))}function on(O){Zt(Dn,f=yt(he),f),H.focus(),ht!==it&&ht!==1/0&&Zt(Je,ht=Zt(Ke,++it,it),ht);const Wt=O.target;if(!nh.has(Wt.tagName)&&(O.preventDefault(),Jt("nodeClicked",{node:Ct,e:O}),!(J||et))){if("touches"in O){if(O.touches&&O.touches.length>1)return}else O.button===2&&nt&&Zt(Te,V=Ct,V);Zt(Wn,W=!0,W),In(O)}}function In(O){let Wt,ee,te=!1;const We=I;We&&(Wt=d[We],ee=yt(Wt.parent),te=ee===Ct),te?Zt(Me,E=We,E):Zt(Me,E="selected",E),!O.shiftKey&&r?Zt(Me,E="selected",E):(!O.shiftKey&&!r&&!O.shiftKey&&(M.clear(),wt.set(M)),On()),Zt(me,b=al(d.selected.nodes),b)}function y(){Oe.delete(je)}function ft(O){const Wt=yt(he),ee=Wt.x-f.x,te=Wt.y-f.y;Math.abs(ee)+Math.abs(te)<4&&Jt("nodeReleased",{e:O,node:Ct}),Zt(we,h=O,h)}function kt(O){return O.addEventListener("mousedown",on),O.addEventListener("touchstart",on),{destroy(){O.removeEventListener("mousedown",on),O.removeEventListener("touchstart",on)}}}function Pt(O){qe.call(this,n,O)}function At(){R=this.clientHeight,Ie.set(R),Et=this.clientWidth,un.set(Et)}return n.$$set=O=>{"node"in O&&i(0,Ct=O.node),"isDefault"in O&&i(1,Qt=O.isDefault),"useDefaults"in O&&i(2,qt=O.useDefaults),"center"in O&&i(51,Gt=O.center),"nodeStore"in O&&i(52,Oe=O.nodeStore),"locked"in O&&B(i(3,xe=O.locked)),"groups"in O&&g(i(4,$t=O.groups)),"maxZIndex"in O&&mt(i(5,Ke=O.maxZIndex)),"centerPoint"in O&&bt(i(6,Se=O.centerPoint)),"cursor"in O&&i(53,he=O.cursor),"initialNodePositions"in O&&P(i(7,me=O.initialNodePositions)),"activeGroup"in O&&T(i(8,Me=O.activeGroup)),"editing"in O&&K(i(9,Te=O.editing)),"dimensionsProvided"in O&&i(54,Re=O.dimensionsProvided),"title"in O&&i(10,Ue=O.title),"$$scope"in O&&i(60,ge=O.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&268435456&&i(14,s=G),n.$$.dirty[0]&1|n.$$.dirty[1]&16777216&&i(11,r=M.has(Ct)),n.$$.dirty[0]&1|n.$$.dirty[1]&134217728&&i(13,l=Q.has(Ct)),n.$$.dirty[1]&75497472&&i(12,u=Re||j),n.$$.dirty[0]&2049|n.$$.dirty[1]&33554432&&r&&vt&&Jt("duplicate",Ct)},[Ct,Qt,qt,xe,$t,Ke,Se,me,Me,Te,Ue,r,u,l,s,et,J,ht,R,Et,Z,It,Xt,dt,Mt,zt,Yt,ot,_e,we,je,Dt,un,Ie,pn,an,cn,Je,Ee,kn,re,ce,Xe,Sn,Pn,Be,wt,nn,y,ft,kt,Gt,Oe,he,Re,M,vt,j,Q,G,ge,Kt,Pt,At]}class oh extends wn{constructor(e){super(),bn(this,e,ih,eh,dn,{node:0,isDefault:1,useDefaults:2,center:51,nodeStore:52,locked:3,groups:4,maxZIndex:5,centerPoint:6,cursor:53,initialNodePositions:7,activeGroup:8,editing:9,dimensionsProvided:54,title:10},null,[-1,-1,-1])}}const sh=n=>({selected:n[1]&262144,grabHandle:n[1]&524288,node:n[0]&128,destroy:n[1]&131072}),Ar=n=>({selected:n[49],grabHandle:n[50],disconnect:n[14],connect:n[13],node:n[7],destroy:n[48]}),rh=n=>({}),Nr=n=>({slot:"anchorWest"}),ah=n=>({}),Or=n=>({slot:"anchorEast"}),lh=n=>({}),Ir=n=>({slot:"anchorNorth"}),uh=n=>({}),Br=n=>({slot:"anchorSouth"});function Zr(n){let e,i;return e=new oh({props:{node:n[7],center:n[5]||n[0]==="center",isDefault:n[8],useDefaults:n[4],dimensionsProvided:!!n[1]||!!n[2]||!!n[3]||n[8]||!1,nodeStore:n[11].nodes,locked:n[11].locked,groups:n[11].groups,title:n[6],maxZIndex:n[11].maxZIndex,centerPoint:n[11].center,cursor:n[11].cursor,activeGroup:n[11].activeGroup,editing:n[11].editing,initialNodePositions:n[11].initialNodePositions,$$slots:{anchorSouth:[mh],anchorNorth:[_h],anchorEast:[dh],anchorWest:[fh],default:[hh,({destroy:s,selected:r,grabHandle:l})=>({48:s,49:r,50:l}),({destroy:s,selected:r,grabHandle:l})=>[0,(s?131072:0)|(r?262144:0)|(l?524288:0)]]},$$scope:{ctx:n}}}),e.$on("nodeClicked",n[41]),e.$on("nodeMount",n[42]),e.$on("nodeReleased",n[43]),e.$on("duplicate",n[44]),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const l={};r[0]&128&&(l.node=s[7]),r[0]&33&&(l.center=s[5]||s[0]==="center"),r[0]&256&&(l.isDefault=s[8]),r[0]&16&&(l.useDefaults=s[4]),r[0]&270&&(l.dimensionsProvided=!!s[1]||!!s[2]||!!s[3]||s[8]||!1),r[0]&64&&(l.title=s[6]),r[0]&384|r[1]&933888&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Dr(n){let e,i;return e=new Vc({props:{selected:n[49]}}),e.$on("connection",n[39]),e.$on("disconnection",n[40]),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const l={};r[1]&262144&&(l.selected=s[49]),e.$set(l)},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function ch(n){let e,i,s=n[8]&&Dr(n);return{c(){s&&s.c(),e=De()},m(r,l){s&&s.m(r,l),tt(r,e,l),i=!0},p(r,l){r[8]?s?(s.p(r,l),l[0]&256&&D(s,1)):(s=Dr(r),s.c(),D(s,1),s.m(e.parentNode,e)):s&&(ye(),F(s,1,1,()=>{s=null}),be())},i(r){i||(D(s),i=!0)},o(r){F(s),i=!1},d(r){r&&q(e),s&&s.d(r)}}}function hh(n){let e;const i=n[38].default,s=ke(i,n,n[45],Ar),r=s||ch(n);return{c(){r&&r.c()},m(l,u){r&&r.m(l,u),e=!0},p(l,u){s?s.p&&(!e||u[0]&128|u[1]&933888)&&Le(s,i,l,l[45],e?Pe(i,l[45],u,sh):Ce(l[45]),Ar):r&&r.p&&(!e||u[0]&256|u[1]&262144)&&r.p(l,e?u:[-1,-1])},i(l){e||(D(r,l),e=!0)},o(l){F(r,l),e=!1},d(l){r&&r.d(l)}}}function fh(n){let e;const i=n[38].anchorWest,s=ke(i,n,n[45],Nr);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&16384)&&Le(s,i,r,r[45],e?Pe(i,r[45],l,rh):Ce(r[45]),Nr)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function dh(n){let e;const i=n[38].anchorEast,s=ke(i,n,n[45],Or);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&16384)&&Le(s,i,r,r[45],e?Pe(i,r[45],l,ah):Ce(r[45]),Or)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function _h(n){let e;const i=n[38].anchorNorth,s=ke(i,n,n[45],Ir);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&16384)&&Le(s,i,r,r[45],e?Pe(i,r[45],l,lh):Ce(r[45]),Ir)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function mh(n){let e;const i=n[38].anchorSouth,s=ke(i,n,n[45],Br);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&16384)&&Le(s,i,r,r[45],e?Pe(i,r[45],l,uh):Ce(r[45]),Br)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function ph(n){let e=n[7]&&n[10].get(n[7].id),i,s,r=e&&Zr(n);return{c(){r&&r.c(),i=De()},m(l,u){r&&r.m(l,u),tt(l,i,u),s=!0},p(l,u){u[0]&1152&&(e=l[7]&&l[10].get(l[7].id)),e?r?(r.p(l,u),u[0]&1152&&D(r,1)):(r=Zr(l),r.c(),D(r,1),r.m(i.parentNode,i)):r&&(ye(),F(r,1,1,()=>{r=null}),be())},i(l){s||(D(r),s=!0)},o(l){F(r),s=!1},d(l){l&&q(i),r&&r.d(l)}}}function gh(n,e,i){let s,r,l=Ht,u=()=>(l(),l=mn(s,ot=>i(37,r=ot)),s),h;n.$$.on_destroy.push(()=>l());let{$$slots:f={},$$scope:d}=e;const p=ss(f),g=de("graph"),b=de("group");let{position:w={x:0,y:0}}=e,{drop:P=!1}=e,{dimensions:M=null}=e,{id:E=0}=e,{bgColor:A=null}=e,{borderRadius:T=null}=e,{borderColor:I=null}=e,{borderWidth:W=null}=e,{selectionColor:V=null}=e,{textColor:U=null}=e,{resizable:K=!1}=e,{label:nt=""}=e,{inputs:et=1}=e,{outputs:J=1}=e,{width:ut=null}=e,{height:B=null}=e,{TD:it=!1}=e,{LR:X=!1}=e,{zIndex:mt=1}=e,{editable:ht=!0}=e,{locked:H=!1}=e,{rotation:R=0}=e,{edge:Tt=null}=e,{connections:rt=[]}=e,{useDefaults:bt=!1}=e,{center:Et=!1}=e,{dynamic:vt=!1}=e,{title:j=""}=e;const Q=g.nodes;gt(n,Q,ot=>i(10,h=ot)),Ze("dynamic",vt);let G,Z=!0;Fn(()=>{const ot=it?"TD":X?"LR":g.direction,_e=g.groupBoxes.get(b),Jt=g.nodes.count()+1;i(8,Z=!p.default),(p.anchorWest||p.anchorEast||p.anchorNorth||p.anchorSouth)&&i(8,Z=!1);const Ct=M||(ut||B?{width:ut||B||200,height:B||ut||100}:Z?{width:200,height:100}:{width:0,height:0}),Qt={id:E||Jt,position:P==="cursor"?{x:yt(g.cursor).x,y:yt(g.cursor).y}:_e?{x:yt(_e.position).x+w.x,y:yt(_e.position).y+w.y}:w,dimensions:Ct,editable:ht||g.editable,label:nt,group:b,resizable:K,inputs:et,outputs:J,zIndex:mt,direction:ot,locked:H,rotation:R};rt.length&&(Qt.connections=rt),W&&(Qt.borderWidth=W),T&&(Qt.borderRadius=T),I&&(Qt.borderColor=I),V&&(Qt.selectionColor=V),U&&(Qt.textColor=U),A&&(Qt.bgColor=A),Tt&&(Qt.edge=Tt),i(7,G=ku(Qt)),_e&&g.groups.update(qt=>{const Gt=yt(qt[b].nodes);return qt[b].nodes.set(new Set([...Gt,G])),qt}),g.nodes.add(G,G.id)}),$i(()=>{g.nodes.delete(G.id)});function It(ot){G&&G.connections.set([ot])}function Xt(ot){if(!G)return;(Array.isArray(ot)?ot:[ot]).forEach(Jt=>{const[Ct,Qt]=Array.isArray(Jt)?Jt:[Jt,null],qt=`N-${Ct}`,Gt=g.nodes.get(qt);if(!Gt)return;let Oe=null;const xe=Qt?`A-${Qt}/${qt}`:null;xe&&(Oe=Gt.anchors.get(xe));const $t=g.edges.match(G,Gt,Oe);$t.length&&g.edges.delete($t[$t.length-1])})}Ze("connect",It),Ze("disconnect",Xt);let dt=w;function Mt(ot){qe.call(this,n,ot)}function zt(ot){qe.call(this,n,ot)}function Yt(ot){qe.call(this,n,ot)}function Kt(ot){qe.call(this,n,ot)}function ge(ot){qe.call(this,n,ot)}function Ne(ot){qe.call(this,n,ot)}return n.$$set=ot=>{"position"in ot&&i(15,w=ot.position),"drop"in ot&&i(0,P=ot.drop),"dimensions"in ot&&i(1,M=ot.dimensions),"id"in ot&&i(16,E=ot.id),"bgColor"in ot&&i(17,A=ot.bgColor),"borderRadius"in ot&&i(18,T=ot.borderRadius),"borderColor"in ot&&i(19,I=ot.borderColor),"borderWidth"in ot&&i(20,W=ot.borderWidth),"selectionColor"in ot&&i(21,V=ot.selectionColor),"textColor"in ot&&i(22,U=ot.textColor),"resizable"in ot&&i(23,K=ot.resizable),"label"in ot&&i(24,nt=ot.label),"inputs"in ot&&i(25,et=ot.inputs),"outputs"in ot&&i(26,J=ot.outputs),"width"in ot&&i(2,ut=ot.width),"height"in ot&&i(3,B=ot.height),"TD"in ot&&i(27,it=ot.TD),"LR"in ot&&i(28,X=ot.LR),"zIndex"in ot&&i(29,mt=ot.zIndex),"editable"in ot&&i(30,ht=ot.editable),"locked"in ot&&i(31,H=ot.locked),"rotation"in ot&&i(32,R=ot.rotation),"edge"in ot&&i(33,Tt=ot.edge),"connections"in ot&&i(34,rt=ot.connections),"useDefaults"in ot&&i(4,bt=ot.useDefaults),"center"in ot&&i(5,Et=ot.center),"dynamic"in ot&&i(35,vt=ot.dynamic),"title"in ot&&i(6,j=ot.title),"$$scope"in ot&&i(45,d=ot.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&128|n.$$.dirty[1]&8&&G&&G.connections.set(rt),n.$$.dirty[0]&131200&&G&&G.bgColor.set(A),n.$$.dirty[0]&16777344&&G&&G.label.set(nt),n.$$.dirty[0]&4194432&&G&&G.textColor.set(U),n.$$.dirty[0]&524416&&G&&G.borderColor.set(I),n.$$.dirty[0]&2097280&&G&&G.selectionColor.set(V),n.$$.dirty[0]&8388736&&G&&G.resizable.set(K),n.$$.dirty[0]&1073741952&&G&&G.editable.set(ht),n.$$.dirty[0]&128|n.$$.dirty[1]&1&&G&&G.locked.set(H),n.$$.dirty[0]&33554560&&G&&G.inputs.set(et),n.$$.dirty[0]&67108992&&G&&G.outputs.set(J),n.$$.dirty[0]&536871040&&G&&G.zIndex.set(mt),n.$$.dirty[0]&128&&u(i(9,s=G&&(G==null?void 0:G.position))),n.$$.dirty[0]&32896|n.$$.dirty[1]&96&&G){const{x:ot,y:_e}=dt,{x:Jt,y:Ct}=r,{x:Qt,y:qt}=w;(Qt!==Jt||qt!==Ct)&&(Qt!==ot||qt!==_e?(i(36,dt=w),G.position.set(w)):(i(36,dt=r),i(15,w=r)))}n.$$.dirty[0]&33554560&&G&&G.inputs.set(et),n.$$.dirty[0]&67108992&&G&&G.outputs.set(J)},[P,M,ut,B,bt,Et,j,G,Z,s,h,g,Q,It,Xt,w,E,A,T,I,W,V,U,K,nt,et,J,it,X,mt,ht,H,R,Tt,rt,vt,dt,r,f,Mt,zt,Yt,Kt,ge,Ne,d]}class rs extends wn{constructor(e){super(),bn(this,e,gh,ph,dn,{position:15,drop:0,dimensions:1,id:16,bgColor:17,borderRadius:18,borderColor:19,borderWidth:20,selectionColor:21,textColor:22,resizable:23,label:24,inputs:25,outputs:26,width:2,height:3,TD:27,LR:28,zIndex:29,editable:30,locked:31,rotation:32,edge:33,connections:34,useDefaults:4,center:5,dynamic:35,title:6},null,[-1,-1])}}function vh(n){n.parentNodes.forEach(l=>yh(l));const[e,i]=bh(n);wh(e,n),kh(e);for(let l=0;l<10;l++){let u=!1;for(let h=0;h<=i;h++)if(e[h])for(let f=0;f<e[h].length;f++){const d=e[h][f],p=Lh(e,d,f);p&&(wi(e[h],f,p),u=!0)}if(!u)break}const s=Ch(e);for(let l=0;l<10&&Sh(e,s);l++);for(let l=0;l<2;l++){let u=!1;for(let h=0;h<=i;h++)for(let f=0;f<e[h].length;f++){const d=e[h][f],p=Ph(e,d,f);p&&(wi(e[h],f,p),u=!0)}if(!u)break}const r=[];for(let l=0;l<=i;l++)r.push(e[l]);return r}function yh(n,e=0,i=0){const s=[],r=(l,u=0,h=0)=>{l.depth=Math.max(l.depth,u),l.nesting=Math.max(l.nesting,h),s.push(l);for(const f of l.children){const{node:d,length:p}=f;r(d,p+u,h+1)}};r(n,e,i);for(const l of s)if(l.children.length){l.nesting=l.children[0].node.nesting-1,l.depth=l.children[0].node.depth-l.children[0].length;for(const u of l.children)l.nesting=Math.min(l.nesting,u.node.nesting-1),l.depth=Math.min(l.depth,u.node.depth-u.length)}}function bh(n){let e=0;const i={};for(const s in n.nodeList){const{depth:r,parents:l,children:u,type:h,data:f}=n.nodeList[s];e=Math.max(e,r),i[r]||(i[r]=[]);const d={id:s,label:f.content,children:[],parents:[],layer:r,type:h.trim()};f.props&&(d.propsId=f.props.trim());for(const p of l)d.parents.push(p.node.id);for(const p of u)d.children.push(p.node.id);i[r].push(d)}return[i,e]}function wh(n,e){for(const i in e.nodeList)for(const s of e.nodeList[i].children)if(s.node.depth-1>e.nodeList[i].depth){const r=e.nodeList[i].depth+1,l=s.node.depth-1,u=[];let h=0;for(let f=r;f<=l;f++){const d={id:`GHOST_${s.node.id}_${h}`,label:"",children:[],parents:[],layer:f,ignore:!0};u.push(d),h++}for(const f of s.node.parents)u[0].parents.push(f.node.id);u[u.length-1].children.push(s.node.id);for(let f=0;f<u.length-1;f++)u[f].children.push(`GHOST_${s.node.id}_${f+1}`);for(let f=l;f>=r;f--)u.length>0&&n[f].push(u[0]);for(const f of n[e.nodeList[i].depth])f.id===i&&(f.children.push(u[0].id),f.children=f.children.filter(d=>d!==s.node.id))}}function kh(n){let e=0;for(const i in n)e=Math.max(n[i].length,e);for(const i in n)if(n[i].length<e){const s=Array.from({length:e-n[i].length},()=>({id:"NULL_NODE",children:[],parents:[],layer:parseInt(i),ignore:!0}));n[i]=n[i].concat(s)}}function xr(n,e,i){let s=0,r=0;for(const l of e.parents){for(let u=0;u<n[e.layer-1].length;u++)if(l===n[e.layer-1][u].id){s+=Math.abs(i-u);break}r++}for(const l of e.children){for(let u=0;u<n[e.layer+1].length;u++)if(l===n[e.layer+1][u].id){s+=Math.abs(i-u);break}r++}return isNaN(s/r)?0:s/r}function Rr(n,e,i){let s=0,r=0;for(const l of e.parents){for(let u=0;u<n[e.layer-1].length;u++)if(l===n[e.layer-1][u].id){s+=Math.abs(i-u);break}r++}return isNaN(s/r)?0:s/r}function jr(n,e,i){let s=0,r=0;for(const l of e.children){for(let u=0;u<n[e.layer+1].length;u++)if(l===n[e.layer+1][u].id){s+=Math.abs(i-u);break}r++}return isNaN(s/r)?0:s/r}function Ph(n,e,i){const s=ns(n,e.layer);let r=0;e.layer===0?r=jr(n,e,i):r=Rr(n,e,i);let l=r,u=i;for(let h=0;h<n[e.layer].length;h++)if(n[e.layer][h].id==="NULL_NODE"){wi(n[e.layer],i,h);const d=ns(n,e.layer);let p=0;e.layer===0?p=jr(n,e,h):p=Rr(n,e,h),d<=s&&p<l&&(l=p,u=h),wi(n[e.layer],h,i)}return u===i?null:u}function Lh(n,e,i){const s={};let r=1/0,l=0;for(let u=0;u<n[e.layer].length;u++){const h=xr(n,e,u),f=xr(n,n[e.layer][u],i);s[u]=h+f}for(const u in s)s[u]<r&&(r=s[u],l=parseInt(u));return l===i?null:l}function wi(n,e,i){const s=n[e];n[e]=n[i],n[i]=s}function Ch(n){const e=[];for(const i in n)for(const s of n[i])e.push(s);return e.sort((i,s)=>s.parents.length+s.children.length-(i.parents.length+i.children.length))}function ns(n,e){let i=0;for(let s=0;s<n[e].length;s++){const r=n[e][s],l=[],u=[];if(n[e-1])for(let h=s+1;h<n[e-1].length;h++)r.parents.includes(n[e-1][h].id)&&l.push(h);if(n[e+1])for(let h=s+1;h<n[e+1].length;h++)r.children.includes(n[e+1][h].id)&&u.push(h);for(let h=s+1;h<n[e].length;h++){const f=n[e][h];if(l.length)for(let d=0;d<n[e-1].length;d++)f.parents.includes(n[e-1][d].id)&&l.forEach(p=>{d<p&&i++});if(u.length)for(let d=0;d<n[e+1].length;d++)f.children.includes(n[e+1][d].id)&&u.forEach(p=>{d<p&&i++})}}return i}function Sh(n,e){let i=!1;for(const s of e){if(s.children.length+s.parents.length===0)return i;let r=0;for(let h=0;h<n[s.layer].length;h++)if(n[s.layer][h].id===s.id){r=h;break}let l=1/0,u=r;for(let h=0;h<n[s.layer].length;h++){wi(n[s.layer],r,h);const f=ns(n,s.layer);f<l&&(l=f,u=h),wi(n[s.layer],h,r)}u!==r&&(wi(n[s.layer],r,u),i=!0)}return i}function Wr(n,e,i){const s=n.slice();return s[6]=e[i],s}function Hr(n,e,i){const s=n.slice();return s[9]=e[i],s}function Mh(n){let e,i;const s=[{label:n[9].label},{id:n[9].id},{TD:!0},n[0][n[9].id],{connections:n[9].children.map(Ur)}];let r={};for(let l=0;l<s.length;l+=1)r=os(r,s[l]);return e=new rs({props:r}),{c(){ue(e.$$.fragment)},m(l,u){oe(e,l,u),i=!0},p(l,u){const h=u&3?tl(s,[u&2&&{label:l[9].label},u&2&&{id:l[9].id},s[2],el(l[0][l[9].id]),u&2&&{connections:l[9].children.map(Ur)}]):{};e.$set(h)},i(l){i||(D(e.$$.fragment,l),i=!0)},o(l){F(e.$$.fragment,l),i=!1},d(l){se(e,l)}}}function Fr(n){let e,i,s=!n[9].ignore&&Mh(n);return{c(){s&&s.c(),e=De()},m(r,l){s&&s.m(r,l),tt(r,e,l),i=!0},p(r,l){r[9].ignore||s.p(r,l)},i(r){i||(D(s),i=!0)},o(r){F(s),i=!1},d(r){r&&q(e),s&&s.d(r)}}}function Gr(n){let e,i,s=Ae(n[6]),r=[];for(let u=0;u<s.length;u+=1)r[u]=Fr(Hr(n,s,u));const l=u=>F(r[u],1,1,()=>{r[u]=null});return{c(){for(let u=0;u<r.length;u+=1)r[u].c();e=De()},m(u,h){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(u,h);tt(u,e,h),i=!0},p(u,h){if(h&3){s=Ae(u[6]);let f;for(f=0;f<s.length;f+=1){const d=Hr(u,s,f);r[f]?(r[f].p(d,h),D(r[f],1)):(r[f]=Fr(d),r[f].c(),D(r[f],1),r[f].m(e.parentNode,e))}for(ye(),f=s.length;f<r.length;f+=1)l(f);be()}},i(u){if(!i){for(let h=0;h<s.length;h+=1)D(r[h]);i=!0}},o(u){r=r.filter(Boolean);for(let h=0;h<r.length;h+=1)F(r[h]);i=!1},d(u){u&&q(e),ki(r,u)}}}function Th(n){let e,i,s=Ae(n[1]),r=[];for(let u=0;u<s.length;u+=1)r[u]=Gr(Wr(n,s,u));const l=u=>F(r[u],1,1,()=>{r[u]=null});return{c(){for(let u=0;u<r.length;u+=1)r[u].c();e=De()},m(u,h){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(u,h);tt(u,e,h),i=!0},p(u,[h]){if(h&3){s=Ae(u[1]);let f;for(f=0;f<s.length;f+=1){const d=Wr(u,s,f);r[f]?(r[f].p(d,h),D(r[f],1)):(r[f]=Gr(d),r[f].c(),D(r[f],1),r[f].m(e.parentNode,e))}for(ye(),f=s.length;f<r.length;f+=1)l(f);be()}},i(u){if(!i){for(let h=0;h<s.length;h+=1)D(r[h]);i=!0}},o(u){r=r.filter(Boolean);for(let h=0;h<r.length;h+=1)F(r[h]);i=!1},d(u){u&&q(e),ki(r,u)}}}const Eh=100,zh=100,Ur=n=>[n,"1"];function Ah(n,e,i){let{mermaid:s=""}=e,{mermaidConfig:r={}}=e;const l=xu(s);Ze("flowchart",l);const u=vh(l),h=de("graph");let f;return Fn(()=>{h.nodes.subscribe(p=>f=Object.fromEntries(p));let d=0;for(const p of u){let g=0,b=-1/0;for(const w of p)w.ignore||(f[`N-${w.id}`].position.update(()=>({x:g,y:d})),f[`N-${w.id}`].dimensions.width.subscribe(P=>g+=P),f[`N-${w.id}`].dimensions.height.subscribe(P=>b=Math.max(b,P))),g+=Eh;d+=b+zh}}),n.$$set=d=>{"mermaid"in d&&i(2,s=d.mermaid),"mermaidConfig"in d&&i(0,r=d.mermaidConfig)},[r,u,s]}class Nh extends wn{constructor(e){super(),bn(this,e,Ah,Th,dn,{mermaid:2,mermaidConfig:0})}}const Oh="modulepreload",Ih=function(n){return"/"+n},Vr={},Ui=function(e,i,s){let r=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),h=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));r=Promise.allSettled(i.map(f=>{if(f=Ih(f),f in Vr)return;Vr[f]=!0;const d=f.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${p}`))return;const g=document.createElement("link");if(g.rel=d?"stylesheet":Oh,d||(g.as="script"),g.crossOrigin="",g.href=f,h&&g.setAttribute("nonce",h),document.head.appendChild(g),d)return new Promise((b,w)=>{g.addEventListener("load",b),g.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(u){const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=u,window.dispatchEvent(h),!h.defaultPrevented)throw u}return r.then(u=>{for(const h of u||[])h.status==="rejected"&&l(h.reason);return e().catch(l)})},Bh=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"],Zh=new Set(Bh),Xr=n=>Zh.has(n);function Dh(n){let e,i,s;return{c(){e=z("input"),m(e,"placeholder",n[0]),m(e,"type","text")},m(r,l){tt(r,e,l),He(e,n[1]),i||(s=[_t(e,"keydown",qn(n[3])),_t(e,"click",qn(n[4])),_t(e,"mousedown",qn(n[5])),_t(e,"input",n[6])],i=!0)},p(r,[l]){l&1&&m(e,"placeholder",r[0]),l&2&&e.value!==r[1]&&He(e,r[1])},i:Ht,o:Ht,d(r){r&&q(e),i=!1,ln(s)}}}function xh(n,e,i){let s,{placeholder:r}=e;const l=de("textStore");gt(n,l,p=>i(1,s=p));function u(p){qe.call(this,n,p)}function h(p){qe.call(this,n,p)}function f(p){qe.call(this,n,p)}function d(){s=this.value,l.set(s)}return n.$$set=p=>{"placeholder"in p&&i(0,r=p.placeholder)},[r,s,l,u,h,f,d]}class Rh extends wn{constructor(e){super(),bn(this,e,xh,Dh,dn,{placeholder:0})}}function jh(n){let e,i,s,r,l,u,h,f,d,p,g,b,w;return u=new Rh({props:{placeholder:"Node Label"}}),{c(){e=z("div"),i=z("span"),i.textContent="Editor",s=$(),r=z("button"),r.textContent="X",l=$(),ue(u.$$.fragment),h=$(),f=z("button"),f.textContent="Delete Node",d=$(),p=z("button"),p.textContent="Resize Node",st(i,"color","white"),st(i,"font-size","45px"),st(r,"position","absolute"),st(r,"top","10px"),st(r,"right","10px"),m(e,"class","editor svelte-1nv0yho")},m(P,M){tt(P,e,M),k(e,i),k(e,s),k(e,r),k(e,l),oe(u,e,null),k(e,h),k(e,f),k(e,d),k(e,p),g=!0,b||(w=[_t(r,"click",n[6]),_t(f,"click",n[3]),_t(p,"click",n[4]),_t(e,"contextmenu",n[2])],b=!0)},p:Ht,i(P){g||(D(u.$$.fragment,P),g=!0)},o(P){F(u.$$.fragment,P),g=!1},d(P){P&&q(e),se(u),b=!1,ln(w)}}}function Wh(n){let e,i;return e=new rs({props:{zIndex:1/0,position:n[0],bgColor:"white",id:"editor",$$slots:{default:[jh]},$$scope:{ctx:n}}}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,[r]){const l={};r&1&&(l.position=s[0]),r&512&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Hh(n,e,i){let{editing:s}=e;const r=de("graph");Ze("graph",r),Ze("textStore",s.label),Ze("colorStore",s.bgColor);let l={x:150,y:50};function u(p){p.preventDefault(),i(0,l={x:p.clientX,y:p.clientY}),r.editing.set(s)}function h(){r.nodes.delete(s.id),r.editing.set(null)}function f(){const p=s.id,g=r.nodes.get(p);if(g){const b=g.dimensions.width,w=g.dimensions.height,P=prompt("Enter new width (for example:250):",b?b.toString():""),M=prompt("Enter new height (for example:200):",w?w.toString():"");if(P===null||M===null)return;g.dimensions.width.set(parseInt(P,10)||0),g.dimensions.height.set(parseInt(M,10)||0),g.resizingWidth.set(!0),g.resizingHeight.set(!0)}}const d=()=>r.editing.set(null);return n.$$set=p=>{"editing"in p&&i(5,s=p.editing)},r.cursor,[l,r,u,h,f,s,d]}class Fh extends wn{constructor(e){super(),bn(this,e,Hh,Wh,dn,{editing:5})}}function Gh(n){let e,i,s,r;return{c(){e=z("div"),i=z("div"),m(i,"class","bounding-box svelte-1e5jg43"),st(i,"background-color",n[6]),m(e,"role","button"),m(e,"tabindex","0"),m(e,"class","bounding-box-border svelte-1e5jg43"),m(e,"id",n[2]),st(e,"border","solid 4px "+n[6]),st(e,"top",`${n[3].y}px`),st(e,"left",`${n[3].x}px`),st(e,"width",`${n[4]}px`),st(e,"height",`${n[5]}px`)},m(l,u){tt(l,e,u),k(e,i),s||(r=[_t(e,"contextmenu",qn(Hn(n[12]))),_t(e,"mousedown",qn(Hn(n[9])))],s=!0)},p(l,[u]){u&64&&st(i,"background-color",l[6]),u&4&&m(e,"id",l[2]),u&64&&st(e,"border","solid 4px "+l[6]);const h=u&64;(u&72||h)&&st(e,"top",`${l[3].y}px`),(u&72||h)&&st(e,"left",`${l[3].x}px`),(u&80||h)&&st(e,"width",`${l[4]}px`),(u&96||h)&&st(e,"height",`${l[5]}px`)},i:Ht,o:Ht,d(l){l&&q(e),s=!1,ln(r)}}}function Uh(n,e,i){let s,r,l=Ht,u=()=>(l(),l=mn(w,V=>i(3,r=V)),w),h,f,d,p=Ht,g=()=>(p(),p=mn(P,V=>i(6,d=V)),P);n.$$.on_destroy.push(()=>l()),n.$$.on_destroy.push(()=>p());let{dimensions:b}=e,{position:w}=e;u();let{color:P}=e;g();let{groupName:M}=e;const{width:E,height:A}=b;gt(n,E,V=>i(4,h=V)),gt(n,A,V=>i(5,f=V));const T=Zi();function I(){T("groupClick",{groupName:M})}function W(V){qe.call(this,n,V)}return n.$$set=V=>{"dimensions"in V&&i(10,b=V.dimensions),"position"in V&&u(i(0,w=V.position)),"color"in V&&g(i(1,P=V.color)),"groupName"in V&&i(11,M=V.groupName)},n.$$.update=()=>{n.$$.dirty&2048&&i(2,s=`${M}-bounding-box`)},[w,P,s,r,h,f,d,E,A,I,b,M,W]}class Vh extends wn{constructor(e){super(),bn(this,e,Uh,Gh,dn,{dimensions:10,position:0,color:1,groupName:11})}}function Yr(n,e,i){const s=n.slice();return s[4]=e[i][0],s[5]=e[i][1],s}function qr(n,e){let i,s,r;const l=[e[5],{groupName:e[4]}];let u={};for(let h=0;h<l.length;h+=1)u=os(u,l[h]);return s=new Vh({props:u}),s.$on("groupClick",e[2]),{key:n,first:null,c(){i=De(),ue(s.$$.fragment),this.first=i},m(h,f){tt(h,i,f),oe(s,h,f),r=!0},p(h,f){e=h;const d=f&1?tl(l,[el(e[5]),{groupName:e[4]}]):{};s.$set(d)},i(h){r||(D(s.$$.fragment,h),r=!0)},o(h){F(s.$$.fragment,h),r=!1},d(h){h&&q(i),se(s,h)}}}function Xh(n){let e=[],i=new Map,s,r,l=Ae(Array.from(n[0]));const u=h=>h[4];for(let h=0;h<l.length;h+=1){let f=Yr(n,l,h),d=u(f);i.set(d,e[h]=qr(d,f))}return{c(){for(let h=0;h<e.length;h+=1)e[h].c();s=De()},m(h,f){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(h,f);tt(h,s,f),r=!0},p(h,[f]){f&1&&(l=Ae(Array.from(h[0])),ye(),e=hi(e,f,u,1,h,l,i,s.parentNode,Ji,qr,s,Yr),be())},i(h){if(!r){for(let f=0;f<l.length;f+=1)D(e[f]);r=!0}},o(h){for(let f=0;f<e.length;f+=1)F(e[f]);r=!1},d(h){h&&q(s);for(let f=0;f<e.length;f+=1)e[f].d(h)}}}function Yh(n,e,i){let s;const l=de("graph").groupBoxes;gt(n,l,h=>i(0,s=h));function u(h){qe.call(this,n,h)}return[s,l,u]}class qh extends wn{constructor(e){super(),bn(this,e,Yh,Xh,dn,{})}}function Kh(n){let e,i,s,r;const l=n[11].default,u=ke(l,n,n[10],null);return{c(){e=z("div"),u&&u.c(),m(e,"class","svelvet-graph-wrapper svelte-19pa6i0"),m(e,"role","presentation"),st(e,"transform",n[0])},m(h,f){tt(h,e,f),u&&u.m(e,null),i=!0,s||(r=[_t(e,"contextmenu",Xi(Hn(n[12]))),_t(e,"click",Xi(Hn(n[13]))),_t(e,"touchstart",Xi(Hn(n[14])))],s=!0)},p(h,[f]){u&&u.p&&(!i||f&1024)&&Le(u,l,h,h[10],i?Pe(l,h[10],f,null):Ce(h[10]),null),f&1&&st(e,"transform",h[0])},i(h){i||(D(u,h),i=!0)},o(h){F(u,h),i=!1},d(h){h&&q(e),u&&u.d(h),s=!1,ln(r)}}}function Jh(n,e,i){let s,r,l,u,h,{$$slots:f={},$$scope:d}=e;const p=de("graph"),g=p.transforms,b=g.scale;gt(n,b,U=>i(9,h=U));const w=g.translation;gt(n,w,U=>i(8,u=U));const P=p.cursor;gt(n,P,U=>i(15,l=U));let{isMovable:M}=e,E,A=!1;function T(){Zt(w,u=qu(yt(Dn),l,g),u),i(5,E=requestAnimationFrame(T))}function I(U){qe.call(this,n,U)}function W(U){qe.call(this,n,U)}function V(U){qe.call(this,n,U)}return n.$$set=U=>{"isMovable"in U&&i(4,M=U.isMovable),"$$scope"in U&&i(10,d=U.$$scope)},n.$$.update=()=>{n.$$.dirty&256&&i(7,s=u),n.$$.dirty&640&&i(0,r=`translate(${s.x}px, ${s.y}px) scale(${h})`),n.$$.dirty&112&&(M&&!A?(i(6,A=!0),i(5,E=requestAnimationFrame(T))):(!M||!A)&&(i(6,A=!1),cancelAnimationFrame(E)))},[r,b,w,P,M,E,A,s,u,h,d,f,I,W,V]}class Qh extends wn{constructor(e){super(),bn(this,e,Jh,Kh,dn,{isMovable:4})}}function $h(n){let e,i,s;const r=n[8].default,l=ke(r,n,n[9],null);return i=new qh({}),i.$on("groupClick",n[5]),{c(){l&&l.c(),e=$(),ue(i.$$.fragment)},m(u,h){l&&l.m(u,h),tt(u,e,h),oe(i,u,h),s=!0},p(u,h){l&&l.p&&(!s||h&512)&&Le(l,r,u,u[9],s?Pe(r,u[9],h,null):Ce(u[9]),null)},i(u){s||(D(l,u),D(i.$$.fragment,u),s=!0)},o(u){F(l,u),F(i.$$.fragment,u),s=!1},d(u){u&&q(e),l&&l.d(u),se(i,u)}}}function tf(n){let e,i;return e=new Qh({props:{isMovable:n[0],$$slots:{default:[$h]},$$scope:{ctx:n}}}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,[r]){const l={};r&1&&(l.isMovable=s[0]),r&512&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function ef(n,e,i){let s,r,l,u,h,f;gt(n,Dn,I=>i(13,u=I)),gt(n,Wn,I=>i(7,f=I));let{$$slots:d={},$$scope:p}=e;console.log("Componente GraphRenderer.svelte");const g=de("graph"),b=de("snapTo");let{isMovable:w}=e;const P=g.activeGroup;gt(n,P,I=>i(6,h=I));const M=g.groups;gt(n,M,I=>i(10,s=I));const E=g.initialNodePositions;gt(n,E,I=>i(11,r=I));const A=g.cursor;gt(n,A,I=>i(12,l=I));function T(I){Zt(Wn,f=!0,f);const{groupName:W}=I.detail;Zt(P,h=W,h),Zt(Dn,u=l,u),Zt(E,r=al(s[W].nodes),r)}return n.$$set=I=>{"isMovable"in I&&i(0,w=I.isMovable),"$$scope"in I&&i(9,p=I.$$scope)},n.$$.update=()=>{n.$$.dirty&192&&h&&f&&oc(g,b)},[w,P,M,E,A,T,h,f,d,p]}class nf extends wn{constructor(e){super(),bn(this,e,ef,tf,dn,{isMovable:0})}}function of(n){let e,i;return{c(){e=ne("line"),i=ne("line"),m(e,"class","background-line svelte-rryw83"),m(e,"x1",n[11]),m(e,"y1",0),m(e,"x2",n[11]),m(e,"y2",n[6]),m(e,"stroke-width",n[5]),st(e,"--calculated-dot-color",n[2]),m(i,"class","background-line svelte-rryw83"),m(i,"y1",n[11]),m(i,"x1",0),m(i,"y2",n[11]),m(i,"x2",n[6]),m(i,"stroke-width",n[5]),st(i,"--calculated-dot-color",n[2])},m(s,r){tt(s,e,r),tt(s,i,r)},p(s,r){r&2048&&m(e,"x1",s[11]),r&2048&&m(e,"x2",s[11]),r&64&&m(e,"y2",s[6]),r&32&&m(e,"stroke-width",s[5]),r&4&&st(e,"--calculated-dot-color",s[2]),r&2048&&m(i,"y1",s[11]),r&2048&&m(i,"y2",s[11]),r&64&&m(i,"x2",s[6]),r&32&&m(i,"stroke-width",s[5]),r&4&&st(i,"--calculated-dot-color",s[2])},d(s){s&&(q(e),q(i))}}}function sf(n){let e;return{c(){e=ne("circle"),m(e,"class","background-dot svelte-rryw83"),m(e,"r",n[5]),m(e,"cx",n[11]),m(e,"cy",n[11]),st(e,"--calculated-dot-color",n[2])},m(i,s){tt(i,e,s)},p(i,s){s&32&&m(e,"r",i[5]),s&2048&&m(e,"cx",i[11]),s&2048&&m(e,"cy",i[11]),s&4&&st(e,"--calculated-dot-color",i[2])},d(i){i&&q(e)}}}function Kr(n){let e,i,s;function r(h,f){if(h[0]==="dots")return af;if(h[0]==="lines")return rf}let l=r(n),u=l&&l(n);return{c(){e=ne("pattern"),u&&u.c(),m(e,"id","graph-coarse-pattern"),m(e,"x",n[7]),m(e,"y",n[8]),m(e,"width",i=n[6]*n[3]),m(e,"height",s=n[6]*n[3]),m(e,"patternUnits","userSpaceOnUse")},m(h,f){tt(h,e,f),u&&u.m(e,null)},p(h,f){l===(l=r(h))&&u?u.p(h,f):(u&&u.d(1),u=l&&l(h),u&&(u.c(),u.m(e,null))),f&128&&m(e,"x",h[7]),f&256&&m(e,"y",h[8]),f&72&&i!==(i=h[6]*h[3])&&m(e,"width",i),f&72&&s!==(s=h[6]*h[3])&&m(e,"height",s)},d(h){h&&q(e),u&&u.d()}}}function rf(n){let e,i,s,r,l,u;return{c(){e=ne("line"),r=ne("line"),m(e,"class","background-line svelte-rryw83"),m(e,"x1",n[11]),m(e,"y1",0),m(e,"x2",n[11]),m(e,"y2",i=n[6]*n[3]),m(e,"stroke-width",s=n[5]*1.2),st(e,"--calculated-dot-color",n[2]),m(r,"class","background-line svelte-rryw83"),m(r,"y1",n[11]),m(r,"x1",0),m(r,"y2",n[11]),m(r,"x2",l=n[6]*n[3]),m(r,"stroke-width",u=n[5]*1.2),st(r,"--calculated-dot-color",n[2])},m(h,f){tt(h,e,f),tt(h,r,f)},p(h,f){f&2048&&m(e,"x1",h[11]),f&2048&&m(e,"x2",h[11]),f&72&&i!==(i=h[6]*h[3])&&m(e,"y2",i),f&32&&s!==(s=h[5]*1.2)&&m(e,"stroke-width",s),f&4&&st(e,"--calculated-dot-color",h[2]),f&2048&&m(r,"y1",h[11]),f&2048&&m(r,"y2",h[11]),f&72&&l!==(l=h[6]*h[3])&&m(r,"x2",l),f&32&&u!==(u=h[5]*1.2)&&m(r,"stroke-width",u),f&4&&st(r,"--calculated-dot-color",h[2])},d(h){h&&(q(e),q(r))}}}function af(n){let e,i;return{c(){e=ne("circle"),m(e,"class","background-dot svelte-rryw83"),m(e,"r",i=n[5]*2),m(e,"cx",n[11]),m(e,"cy",n[11]),st(e,"--calculated-dot-color",n[2])},m(s,r){tt(s,e,r)},p(s,r){r&32&&i!==(i=s[5]*2)&&m(e,"r",i),r&2048&&m(e,"cx",s[11]),r&2048&&m(e,"cy",s[11]),r&4&&st(e,"--calculated-dot-color",s[2])},d(s){s&&q(e)}}}function Jr(n){let e;return{c(){e=ne("rect"),m(e,"width","100%"),m(e,"height","100%"),m(e,"fill","url(#graph-coarse-pattern)"),m(e,"opacity",n[10])},m(i,s){tt(i,e,s)},p(i,s){s&1024&&m(e,"opacity",i[10])},d(i){i&&q(e)}}}function lf(n){let e,i,s,r,l;function u(g,b){if(g[0]==="dots")return sf;if(g[0]==="lines")return of}let h=u(n),f=h&&h(n),d=n[3]>0&&Kr(n),p=n[3]>0&&Jr(n);return{c(){e=z("div"),i=ne("svg"),s=ne("defs"),r=ne("pattern"),f&&f.c(),d&&d.c(),l=ne("rect"),p&&p.c(),m(r,"id","graph-pattern"),m(r,"x",n[7]),m(r,"y",n[8]),m(r,"width",n[6]),m(r,"height",n[6]),m(r,"patternUnits","userSpaceOnUse"),m(l,"width","100%"),m(l,"height","100%"),m(l,"fill","url(#graph-pattern)"),m(l,"opacity",n[9]),m(i,"class","svelte-rryw83"),m(e,"id","background-wrapper"),m(e,"class","svelte-rryw83"),st(e,"--calculated-background-color",n[1])},m(g,b){tt(g,e,b),k(e,i),k(i,s),k(s,r),f&&f.m(r,null),d&&d.m(s,null),k(i,l),p&&p.m(i,null),n[24](e)},p(g,[b]){h===(h=u(g))&&f?f.p(g,b):(f&&f.d(1),f=h&&h(g),f&&(f.c(),f.m(r,null))),b&128&&m(r,"x",g[7]),b&256&&m(r,"y",g[8]),b&64&&m(r,"width",g[6]),b&64&&m(r,"height",g[6]),g[3]>0?d?d.p(g,b):(d=Kr(g),d.c(),d.m(s,null)):d&&(d.d(1),d=null),b&512&&m(l,"opacity",g[9]),g[3]>0?p?p.p(g,b):(p=Jr(g),p.c(),p.m(i,null)):p&&(p.d(1),p=null),b&2&&st(e,"--calculated-background-color",g[1])},i:Ht,o:Ht,d(g){g&&q(e),f&&f.d(),d&&d.d(),p&&p.d(),n[24](null)}}}function uf(n,e,i){let s,r,l,u,h,f,d;const p=de("graph");let{style:g="dots"}=e,{gridWidth:b=Eu}=e,{dotSize:w=zu}=e,{bgColor:P=null}=e,{dotColor:M=null}=e,{opacityThreshold:E=3}=e,{majorGrid:A=0}=e,{minOpacity:T=.4}=e;const I=p.transforms,W=I.scale;gt(n,W,X=>i(22,f=X));const V=I.translation;gt(n,V,X=>i(23,d=X));let U,K,nt,et,J,ut=1,B=1;function it(X){Kn[X?"unshift":"push"](()=>{U=X,i(4,U)})}return n.$$set=X=>{"style"in X&&i(0,g=X.style),"gridWidth"in X&&i(14,b=X.gridWidth),"dotSize"in X&&i(15,w=X.dotSize),"bgColor"in X&&i(1,P=X.bgColor),"dotColor"in X&&i(2,M=X.dotColor),"opacityThreshold"in X&&i(16,E=X.opacityThreshold),"majorGrid"in X&&i(3,A=X.majorGrid),"minOpacity"in X&&i(17,T=X.minOpacity)},n.$$.update=()=>{n.$$.dirty&8388608&&i(21,s=d),n.$$.dirty&4194304&&i(20,r=f),n.$$.dirty&1064960&&i(6,l=r*b),n.$$.dirty&1081344&&i(5,u=r*w/2),n.$$.dirty&64&&i(11,h=l/2),n.$$.dirty&4128816&&(i(18,K=(U==null?void 0:U.offsetWidth)||0),i(19,nt=(U==null?void 0:U.offsetHeight)||0),i(7,et=(K+u)*(1-r)/2+s.x),i(8,J=(nt+u)*(1-r)/2+s.y),i(9,ut=r>E?1:r/E+T),i(10,B=r>E/3?1:r/(E/3)+T))},[g,P,M,A,U,u,l,et,J,ut,B,h,W,V,b,w,E,T,K,nt,r,s,f,d,it]}class cf extends wn{constructor(e){super(),bn(this,e,uf,lf,dn,{style:0,gridWidth:14,dotSize:15,bgColor:1,dotColor:2,opacityThreshold:16,majorGrid:3,minOpacity:17})}}function hf(n){let e,i;return{c(){e=z("div"),i=z("div"),m(i,"class","selection-box svelte-10ds4jd"),Vt(i,"creating",n[0]),m(e,"class","selection-border svelte-10ds4jd"),Vt(e,"creating",n[0]),st(e,"--prop-selection-box-color",n[1]),st(e,"height",n[4]),st(e,"width",n[3]),st(e,"top",n[6]),st(e,"left",n[5])},m(s,r){tt(s,e,r),k(e,i),n[18](i)},p(s,[r]){r&1&&Vt(i,"creating",s[0]),r&1&&Vt(e,"creating",s[0]),r&2&&st(e,"--prop-selection-box-color",s[1]),r&16&&st(e,"height",s[4]),r&8&&st(e,"width",s[3]),r&64&&st(e,"top",s[6]),r&32&&st(e,"left",s[5])},i:Ht,o:Ht,d(s){s&&q(e),n[18](null)}}}function ff(n,e,i){let s,r,l,u,h,f,d,p,g,b,w=Ht,P=()=>(w(),w=mn(s,B=>i(20,b=B)),s),M,E;gt(n,il,B=>i(16,M=B)),n.$$.on_destroy.push(()=>w());let{graph:A}=e,{anchor:T}=e,{adding:I=!1}=e,{creating:W=!1}=e,{color:V=null}=e;const{groups:U}=A;gt(n,U,B=>i(17,E=B));let K,nt;Fn(et);function et(){K=Array.from(document.querySelectorAll(".svelvet-node")).map(it=>{const{top:X,left:mt,width:ht,height:H}=it.getBoundingClientRect();return{id:it.id,top:X,left:mt,width:ht,height:H}})}function J(){if(!K)return;const B=K.reduce((it,X)=>{if(h+T.left<=X.left&&u+T.top<=X.top&&h+T.left+Math.abs(l)>=X.left+X.width&&u+T.top+Math.abs(r)>=X.top+X.height){const mt=X.id,ht=A.nodes.get(mt);if(!ht)return it;it.push(ht)}return it},[]);I?B.forEach(it=>{b.add(it)}):Zt(s,b=new Set(B),b),s.set(b)}function ut(B){Kn[B?"unshift":"push"](()=>{nt=B,i(2,nt)})}return n.$$set=B=>{"graph"in B&&i(9,A=B.graph),"anchor"in B&&i(10,T=B.anchor),"adding"in B&&i(11,I=B.adding),"creating"in B&&i(0,W=B.creating),"color"in B&&i(1,V=B.color)},n.$$.update=()=>{n.$$.dirty&131072&&P(i(7,s=E.selected.nodes)),n.$$.dirty&66560&&i(12,r=M.y-T.y-T.top),n.$$.dirty&66560&&i(14,l=M.x-T.x-T.left),n.$$.dirty&5120&&i(13,u=Math.min(T.y,T.y+r)),n.$$.dirty&17408&&i(15,h=Math.min(T.x,T.x+l)),n.$$.dirty&8192&&i(6,f=`${u}px`),n.$$.dirty&32768&&i(5,d=`${h}px`),n.$$.dirty&4096&&i(4,p=`${Math.abs(r)}px`),n.$$.dirty&16384&&i(3,g=`${Math.abs(l)}px`),n.$$.dirty&20480&&(l||r)&&J()},[W,V,nt,g,p,d,f,s,U,A,T,I,r,u,l,h,M,E,ut]}class df extends wn{constructor(e){super(),bn(this,e,ff,hf,dn,{graph:9,anchor:10,adding:11,creating:0,color:1})}}const _f=n=>({}),Qr=n=>({}),mf=n=>({}),$r=n=>({}),pf=n=>({}),ta=n=>({}),gf=n=>({}),ea=n=>({}),vf=n=>({}),na=n=>({}),yf=n=>({}),ia=n=>({});function oa(n){let e,i;return e=new Fh({props:{editing:n[24]}}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const l={};r[0]&16777216&&(l.editing=s[24]),e.$set(l)},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function bf(n){let e,i,s=n[24]&&oa(n);const r=n[56].default,l=ke(r,n,n[58],null);return{c(){s&&s.c(),e=$(),l&&l.c()},m(u,h){s&&s.m(u,h),tt(u,e,h),l&&l.m(u,h),i=!0},p(u,h){u[24]?s?(s.p(u,h),h[0]&16777216&&D(s,1)):(s=oa(u),s.c(),D(s,1),s.m(e.parentNode,e)):s&&(ye(),F(s,1,1,()=>{s=null}),be()),l&&l.p&&(!i||h[1]&134217728)&&Le(l,r,u,u[58],i?Pe(r,u[58],h,null):Ce(u[58]),null)},i(u){i||(D(s),D(l,u),i=!0)},o(u){F(s),F(l,u),i=!1},d(u){u&&q(e),s&&s.d(u),l&&l.d(u)}}}function wf(n){let e,i;return e=new cf({}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p:Ht,i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function kf(n){let e;const i=n[56].background,s=ke(i,n,n[58],ia);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&134217728)&&Le(s,i,r,r[58],e?Pe(i,r[58],l,yf):Ce(r[58]),ia)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function sa(n){let e,i,s;var r=n[14];function l(u,h){return{}}return r&&(e=si(r,l())),{c(){e&&ue(e.$$.fragment),i=De()},m(u,h){e&&oe(e,u,h),tt(u,i,h),s=!0},p(u,h){if(h[0]&16384&&r!==(r=u[14])){if(e){ye();const f=e;F(f.$$.fragment,1,0,()=>{se(f,1)}),be()}r?(e=si(r,l()),ue(e.$$.fragment),D(e.$$.fragment,1),oe(e,i.parentNode,i)):e=null}},i(u){s||(e&&D(e.$$.fragment,u),s=!0)},o(u){e&&F(e.$$.fragment,u),s=!1},d(u){u&&q(i),e&&se(e,u)}}}function ra(n){let e,i,s;var r=n[15];function l(u,h){return{}}return r&&(e=si(r,l())),{c(){e&&ue(e.$$.fragment),i=De()},m(u,h){e&&oe(e,u,h),tt(u,i,h),s=!0},p(u,h){if(h[0]&32768&&r!==(r=u[15])){if(e){ye();const f=e;F(f.$$.fragment,1,0,()=>{se(f,1)}),be()}r?(e=si(r,l()),ue(e.$$.fragment),D(e.$$.fragment,1),oe(e,i.parentNode,i)):e=null}},i(u){s||(e&&D(e.$$.fragment,u),s=!0)},o(u){e&&F(e.$$.fragment,u),s=!1},d(u){u&&q(i),e&&se(e,u)}}}function aa(n){let e,i,s;var r=n[13];function l(u,h){return{}}return r&&(e=si(r,l())),{c(){e&&ue(e.$$.fragment),i=De()},m(u,h){e&&oe(e,u,h),tt(u,i,h),s=!0},p(u,h){if(h[0]&8192&&r!==(r=u[13])){if(e){ye();const f=e;F(f.$$.fragment,1,0,()=>{se(f,1)}),be()}r?(e=si(r,l()),ue(e.$$.fragment),D(e.$$.fragment,1),oe(e,i.parentNode,i)):e=null}},i(u){s||(e&&D(e.$$.fragment,u),s=!0)},o(u){e&&F(e.$$.fragment,u),s=!1},d(u){u&&q(i),e&&se(e,u)}}}function la(n){let e,i,s;var r=n[16];function l(u,h){return{}}return r&&(e=si(r,l())),{c(){e&&ue(e.$$.fragment),i=De()},m(u,h){e&&oe(e,u,h),tt(u,i,h),s=!0},p(u,h){if(h[0]&65536&&r!==(r=u[16])){if(e){ye();const f=e;F(f.$$.fragment,1,0,()=>{se(f,1)}),be()}r?(e=si(r,l()),ue(e.$$.fragment),D(e.$$.fragment,1),oe(e,i.parentNode,i)):e=null}},i(u){s||(e&&D(e.$$.fragment,u),s=!0)},o(u){e&&F(e.$$.fragment,u),s=!1},d(u){u&&q(i),e&&se(e,u)}}}function ua(n){let e,i,s;var r=n[17];function l(u,h){return{}}return r&&(e=si(r,l())),{c(){e&&ue(e.$$.fragment),i=De()},m(u,h){e&&oe(e,u,h),tt(u,i,h),s=!0},p(u,h){if(h[0]&131072&&r!==(r=u[17])){if(e){ye();const f=e;F(f.$$.fragment,1,0,()=>{se(f,1)}),be()}r?(e=si(r,l()),ue(e.$$.fragment),D(e.$$.fragment,1),oe(e,i.parentNode,i)):e=null}},i(u){s||(e&&D(e.$$.fragment,u),s=!0)},o(u){e&&F(e.$$.fragment,u),s=!1},d(u){u&&q(i),e&&se(e,u)}}}function ca(n){let e,i;return e=new df({props:{creating:n[20],anchor:n[18],graph:n[3],adding:n[21],color:n[9]}}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const l={};r[0]&1048576&&(l.creating=s[20]),r[0]&262144&&(l.anchor=s[18]),r[0]&8&&(l.graph=s[3]),r[0]&2097152&&(l.adding=s[21]),r[0]&512&&(l.color=s[9]),e.$set(l)},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Pf(n){let e,i,s,r,l,u,h,f,d,p,g,b,w,P,M,E,A,T,I,W;i=new nf({props:{isMovable:n[22],$$slots:{default:[bf]},$$scope:{ctx:n}}});const V=[kf,wf],U=[];function K(j,Q){return j[10]?0:1}r=K(n),l=U[r]=V[r](n);let nt=n[0]&&sa(n),et=n[1]&&ra(n),J=n[6]&&aa(n),ut=n[2]&&la(n),B=n[12]&&ua(n);const it=n[56].minimap,X=ke(it,n,n[58],na),mt=n[56].drawer,ht=ke(mt,n,n[58],ea),H=n[56].controls,R=ke(H,n,n[58],ta),Tt=n[56].toggle,rt=ke(Tt,n,n[58],$r),bt=n[56].contrast,Et=ke(bt,n,n[58],Qr);let vt=n[19]&&!n[8]&&ca(n);return{c(){e=z("section"),ue(i.$$.fragment),s=$(),l.c(),u=$(),nt&&nt.c(),h=$(),et&&et.c(),f=$(),J&&J.c(),d=$(),ut&&ut.c(),p=$(),B&&B.c(),g=$(),X&&X.c(),b=$(),ht&&ht.c(),w=$(),R&&R.c(),P=$(),rt&&rt.c(),M=$(),Et&&Et.c(),E=$(),vt&&vt.c(),m(e,"role","presentation"),m(e,"id",A=n[3].id),m(e,"class","svelvet-wrapper svelte-13nq7cv"),m(e,"title",n[11]),m(e,"tabindex",0),st(e,"width",n[4]?n[4]+"px":"100%"),st(e,"height",n[5]?n[5]+"px":"100%"),st(e,"cursor",n[7]?"move":"default")},m(j,Q){tt(j,e,Q),oe(i,e,null),k(e,s),U[r].m(e,null),k(e,u),nt&&nt.m(e,null),k(e,h),et&&et.m(e,null),k(e,f),J&&J.m(e,null),k(e,d),ut&&ut.m(e,null),k(e,p),B&&B.m(e,null),k(e,g),X&&X.m(e,null),k(e,b),ht&&ht.m(e,null),k(e,w),R&&R.m(e,null),k(e,P),rt&&rt.m(e,null),k(e,M),Et&&Et.m(e,null),k(e,E),vt&&vt.m(e,null),n[57](e),T=!0,I||(W=[_t(window,"touchend",n[36]),_t(window,"mouseup",n[36]),_t(window,"resize",n[35]),_t(window,"scroll",n[35]),_t(e,"wheel",Hn(n[43])),_t(e,"mousedown",Xi(Hn(n[37]))),_t(e,"touchend",Hn(n[39])),_t(e,"touchstart",Xi(Hn(n[38]))),_t(e,"keydown",n[40]),_t(e,"keyup",n[42]),_t(e,"dragover",Hn(Lf)),_t(e,"drop",n[41])],I=!0)},p(j,Q){const G={};Q[0]&4194304&&(G.isMovable=j[22]),Q[0]&16777216|Q[1]&134217728&&(G.$$scope={dirty:Q,ctx:j}),i.$set(G);let Z=r;r=K(j),r===Z?U[r].p(j,Q):(ye(),F(U[Z],1,1,()=>{U[Z]=null}),be(),l=U[r],l?l.p(j,Q):(l=U[r]=V[r](j),l.c()),D(l,1),l.m(e,u)),j[0]?nt?(nt.p(j,Q),Q[0]&1&&D(nt,1)):(nt=sa(j),nt.c(),D(nt,1),nt.m(e,h)):nt&&(ye(),F(nt,1,1,()=>{nt=null}),be()),j[1]?et?(et.p(j,Q),Q[0]&2&&D(et,1)):(et=ra(j),et.c(),D(et,1),et.m(e,f)):et&&(ye(),F(et,1,1,()=>{et=null}),be()),j[6]?J?(J.p(j,Q),Q[0]&64&&D(J,1)):(J=aa(j),J.c(),D(J,1),J.m(e,d)):J&&(ye(),F(J,1,1,()=>{J=null}),be()),j[2]?ut?(ut.p(j,Q),Q[0]&4&&D(ut,1)):(ut=la(j),ut.c(),D(ut,1),ut.m(e,p)):ut&&(ye(),F(ut,1,1,()=>{ut=null}),be()),j[12]?B?(B.p(j,Q),Q[0]&4096&&D(B,1)):(B=ua(j),B.c(),D(B,1),B.m(e,g)):B&&(ye(),F(B,1,1,()=>{B=null}),be()),X&&X.p&&(!T||Q[1]&134217728)&&Le(X,it,j,j[58],T?Pe(it,j[58],Q,vf):Ce(j[58]),na),ht&&ht.p&&(!T||Q[1]&134217728)&&Le(ht,mt,j,j[58],T?Pe(mt,j[58],Q,gf):Ce(j[58]),ea),R&&R.p&&(!T||Q[1]&134217728)&&Le(R,H,j,j[58],T?Pe(H,j[58],Q,pf):Ce(j[58]),ta),rt&&rt.p&&(!T||Q[1]&134217728)&&Le(rt,Tt,j,j[58],T?Pe(Tt,j[58],Q,mf):Ce(j[58]),$r),Et&&Et.p&&(!T||Q[1]&134217728)&&Le(Et,bt,j,j[58],T?Pe(bt,j[58],Q,_f):Ce(j[58]),Qr),j[19]&&!j[8]?vt?(vt.p(j,Q),Q[0]&524544&&D(vt,1)):(vt=ca(j),vt.c(),D(vt,1),vt.m(e,null)):vt&&(ye(),F(vt,1,1,()=>{vt=null}),be()),(!T||Q[0]&8&&A!==(A=j[3].id))&&m(e,"id",A),(!T||Q[0]&2048)&&m(e,"title",j[11]),Q[0]&16&&st(e,"width",j[4]?j[4]+"px":"100%"),Q[0]&32&&st(e,"height",j[5]?j[5]+"px":"100%"),Q[0]&128&&st(e,"cursor",j[7]?"move":"default")},i(j){T||(D(i.$$.fragment,j),D(l),D(nt),D(et),D(J),D(ut),D(B),D(X,j),D(ht,j),D(R,j),D(rt,j),D(Et,j),D(vt),T=!0)},o(j){F(i.$$.fragment,j),F(l),F(nt),F(et),F(J),F(ut),F(B),F(X,j),F(ht,j),F(R,j),F(rt,j),F(Et,j),F(vt),T=!1},d(j){j&&q(e),se(i),U[r].d(),nt&&nt.d(),et&&et.d(),J&&J.d(),ut&&ut.d(),B&&B.d(),X&&X.d(j),ht&&ht.d(j),R&&R.d(j),rt&&rt.d(j),Et&&Et.d(j),vt&&vt.d(),n[57](null),I=!1,ln(W)}}}function Lf(n){n.preventDefault()}function Cf(n,e,i){let s,r,l,u,h,f,d,p,g,b,w,P,M,E,A;gt(n,ts,y=>i(70,d=y)),gt(n,Dn,y=>i(71,p=y)),gt(n,Wn,y=>i(72,g=y)),gt(n,oi,y=>i(75,P=y));let{$$slots:T={},$$scope:I}=e,{graph:W}=e,{width:V}=e,{height:U}=e,{minimap:K=!1}=e,{controls:nt=!1}=e,{toggle:et=!1}=e,{fixedZoom:J=!1}=e,{pannable:ut=!0}=e,{disableSelection:B=!1}=e,{ZOOM_INCREMENT:it=.1}=e,{PAN_INCREMENT:X=50}=e,{PAN_TIME:mt=250}=e,{MAX_SCALE:ht=3}=e,{MIN_SCALE:H=.2}=e,{selectionColor:R}=e,{backgroundExists:Tt}=e,{fitView:rt=!1}=e,{trackpadPan:bt}=e,{modifier:Et}=e,{theme:vt="light"}=e,{title:j}=e,{drawer:Q=!1}=e,{contrast:G=!1}=e;console.log("Initial Graph drawer prop:",Q);let Z;const It=Zi(),Xt={},dt=Y(!1),Mt=Y(0),zt=Y(null);gt(n,zt,y=>i(23,h=y));const Yt=W.cursor,Kt=W.transforms.scale;gt(n,Kt,y=>i(68,u=y));const ge=W.dimensions;gt(n,ge,y=>i(55,E=y));const Ne=W.transforms.translation;gt(n,Ne,y=>i(67,l=y));const ot=W.groups;gt(n,ot,y=>i(69,f=y));const _e=W.groupBoxes,Jt=f.selected.nodes;gt(n,Jt,y=>i(66,r=y));const Ct=W.activeGroup;gt(n,Ct,y=>i(74,w=y));const Qt=W.initialNodePositions;gt(n,Qt,y=>i(73,b=y));const qt=W.editing;gt(n,qt,y=>i(24,A=y));const Gt=W.bounds.nodeBounds;gt(n,Gt,y=>i(76,M=y));let Oe=0,xe=1,$t={x:0,y:0,top:0,left:0},Ke=!1,Se=!1,he=!1,me=!1,Me=!1,Te=!1,Re,Ue=null,rn=null,we=null,je=null,Dt=null;const un={id:null,position:W.cursor,offset:Y({x:0,y:0}),connected:Y(new Set),dynamic:Y(!1),edge:null,edgeColor:Y(null),direction:Y("self"),inputKey:null,type:"output",moving:bo(!1),store:null,mounted:Y(!0),rotation:bo(0),node:{zIndex:Y(1/0),rotating:Y(!1),position:W.cursor,dimensions:{width:Y(0),height:Y(0)}}};Ze("graphDOMElement",zt),Ze("cursorAnchor",un),Ze("duplicate",dt),Ze("graph",W),Ze("transforms",W.transforms),Ze("dimensions",W.dimensions),Ze("locked",W.locked),Ze("groups",W.groups),Ze("bounds",W.bounds),Ze("edgeStore",W.edges),Ze("nodeStore",W.nodes),Ze("mounted",Mt),Fn(()=>{console.log("Graph component mounted with drawer1:",Q),kn()});async function Ie(){await Qa(),Wn.set(!0);const{x:y,y:ft,scale:kt}=tc(Re,M);y!==null&&ft!==null&&kt!==null&&(W.transforms.scale.set(kt),Ne.set({x:y,y:ft})),Wn.set(!1),i(54,Te=!0)}async function pn(){i(14,rn=(await Ui(async()=>{const{default:y}=await import("./Minimap-BQ5WN-Wd.js");return{default:y}},[])).default)}async function an(){i(13,Ue=(await Ui(async()=>{const{default:y}=await import("./ThemeToggle-DZ5Xwgyb.js");return{default:y}},[])).default)}async function cn(){i(15,we=(await Ui(async()=>{const{default:y}=await import("./Controls-B4CKevh5.js");return{default:y}},__vite__mapDeps([0,1]))).default)}async function Je(){i(16,je=(await Ui(async()=>{const{default:y}=await import("./DrawerController-C0-7qqz6.js");return{default:y}},__vite__mapDeps([2,1,3]))).default)}async function Ee(){i(17,Dt=(await Ui(async()=>{const{default:y}=await import("./ContrastTheme-BKASlD28.js");return{default:y}},[])).default)}function kn(){if(!h)return;const y=h.getBoundingClientRect();Re={top:y.top,left:y.left,bottom:y.bottom,right:y.right,width:y.width,height:y.height},W.dimensions.set(Re),rt==="resize"&&Ie()}function re(y){if(Se){const Pt=`${Hu()}/${W.id}`,At=yt(Yt),O=At.x-p.x,Wt=At.y-p.y,ee=Math.min(p.y,p.y+Wt),te=Math.min(p.x,p.x+O),We={width:Y(Math.abs(O)),height:Y(Math.abs(Wt))},Fe=Y({x:te,y:ee}),Ve={group:Y(Pt),dimensions:We,position:Fe,color:Y(Bu()),moving:Y(!1)};_e.add(Ve,Pt),Array.from(r).forEach(Mn=>{Mn.group.set(Pt)}),ot.update(Mn=>{const Tn={parent:Y(Ve),nodes:Y(new Set([...r,Ve]))};return Mn[Pt]=Tn,Mn}),Zt(Jt,r=new Set,r),i(20,Se=!1),i(19,Ke=!1)}w&&Array.from(yt(f[w].nodes)).forEach(Pt=>{const At=yo(yt(Pt.position).x,yt(Pt.position).y);Pt.position.set(At),Pt.moving.set(!1)});const ft=W.edges.get("cursor");ft&&(W.edges.delete("cursor"),ft.disconnect||It("edgeDrop",{cursor:yt(Yt),source:{node:P==null?void 0:P.anchor.node.id.slice(2),anchor:P==null?void 0:P.anchor.id.split("/")[0].slice(2)}})),Zt(Ct,w=null,w),Zt(Dn,p={x:0,y:0},p),Zt(Qt,b=[],b),i(19,Ke=!1),i(22,me=!1),Zt(Wn,g=!1,g),y.shiftKey||oi.set(null),i(18,$t.y=0,$t),i(18,$t.x=0,$t)}function ce(y){if(!ut&&!(y.shiftKey||y.metaKey)||y.button===2)return;h&&h.focus();const{clientX:ft,clientY:kt}=y;if(Zt(Dn,p=yt(Yt),p),y.shiftKey||y.metaKey){y.preventDefault(),i(19,Ke=!0);const{top:Pt,left:At}=s;i(18,$t.y=kt-Pt,$t),i(18,$t.x=ft-At,$t),i(18,$t.top=Pt,$t),i(18,$t.left=At,$t),y.shiftKey&&y.metaKey?i(20,Se=!0):i(20,Se=!1),y.metaKey&&!y.shiftKey?i(21,he=!0):i(21,he=!1)}else i(22,me=!0),Zt(Jt,r=new Set,r),Jt.set(r)}function Xe(y){Zt(Jt,r=new Set,r),Jt.set(r),Zt(Dn,p=yt(Yt),p),i(22,me=!0),y.touches.length===2&&(Pn(),Oe=d,xe=u)}function Sn(){i(22,me=!1),Me=!1}function Pn(){Me||(Me=!0,Z=requestAnimationFrame(Nn))}function Nn(){if(!Me){cancelAnimationFrame(Z);return}const ft=d/Oe;Zt(Kt,u=xe*ft,u),Z=requestAnimationFrame(Nn)}function zn(y){const{key:ft,code:kt}=y,Pt=y.target;if(!(Pt.tagName=="INPUT"||Pt.tagName=="TEXTAREA")){if(kt==="KeyA"&&y[`${Et}Key`]){const At=W.nodes.getAll().filter(O=>!yt(O.locked));Zt(Jt,r=new Set(At),r)}else if(Xr(ft))on(ft,y);else if(ft==="=")Qs(-1,W.dimensions,W.transforms,it);else if(ft==="-")Qs(1,W.dimensions,W.transforms,it);else if(ft==="0")Ie();else if(ft==="Control")f.selected.nodes.set(new Set);else if(kt==="KeyD"&&y[`${Et}Key`])dt.set(!0),setTimeout(()=>{dt.set(!1)},100);else if(ft==="Tab"&&(y.altKey||y.ctrlKey))wt();else if(ft==="l")i(44,vt=vt==="light"?"dark":"light");else if(ft==="d")i(2,Q=!Q);else if(ft==="m")i(0,K=!K);else if(ft==="c")i(1,nt=!nt);else if(ft==="e"){const At=Array.from(r)[0];W.editing.set(At)}else return;y.preventDefault()}}function Be(y){y.preventDefault();const ft=h==null?void 0:h.getBoundingClientRect();if(!ft)return;const kt=y.clientX-ft.left,Pt=y.clientY-ft.top,{x:At,y:O}=yo(kt,Pt);if(console.log(`Dropped Node at Snapped Position: (${At}, ${O})`),!ee)return;const Wt={id:`node-${Date.now()}`,rotation:Y(0),position:Y({x:At,y:O}),moving:Y(!1),label:Y("New Node"),dimensions:{width:Y(200),height:Y(100)},inputs:Y(2),outputs:Y(2),anchors:Y([]),group:Y(null),collapsed:Y(!1),resizingWidth:Y(!1),resizingHeight:Y(!1),rotating:Y(!1),editable:Y(!0),locked:Y(!1),recalculateAnchors:te=>{},resizable:Y(!0),zIndex:Y(1),edge:null,direction:Y("TD"),borderRadius:Y(5),borderWidth:Y(1),connections:Y([]),bgColor:Y("#007bff"),borderColor:Y("#000"),selectionColor:Y("#ff0000"),textColor:Y("#fff")};let ee=null;W.nodes.add(Wt,Wt.id),ee=null}function wt(){const y=W.nodes.getAll(),ft=y.findIndex(Pt=>r.has(Pt)),kt=ft+1;r.delete(y[ft]),r.add(y[kt])}function nn(y){const{key:ft}=y;Xr(ft)?(clearInterval(Xt[ft]),delete Xt[ft]):ft==="Shift"&&oi.set(null)}function On(y){if(J)return;const ft=y.shiftKey?.15:1,{clientX:kt,clientY:Pt,deltaY:At}=y,O=l,Wt={x:kt,y:Pt};if((bt||y.metaKey)&&At%1===0){Zt(Ne,l={x:Zt(Ne,l.x-=y.deltaX,l),y:Zt(Ne,l.y-=y.deltaY,l)},l);return}if(u>=ht&&At<0||u<=H&&At>0)return;const ee=Math.min(.009*ft*Math.abs(At),.08),te=sl(u,Math.sign(At),ee),We=ol(u,te,O,Wt,Re);Kt.set(te),Ne.set(We)}function on(y,ft){const kt=ft.shiftKey?2:1,Pt=y==="ArrowLeft"||y==="ArrowUp"?1:-1,At=y==="ArrowLeft"||y==="ArrowRight",O=At?l.x:l.y,Wt=O+Pt*X*kt;if(!Xt[y]){const ee=performance.now();let te=setInterval(()=>{const We=performance.now()-ee;if(r.size===0){const Fe=O+(Wt-O)*(We/mt);Ne.set({x:At?Fe:l.x,y:At?l.y:Fe})}else{const Fe={x:At?-Pt*2:0,y:At?0:-Pt*2};Array.from(r).forEach(Ve=>{const Mn=yt(Ve.position);let Tn;const Jn=yt(Ve.group),xn=yt(W.groupBoxes);if(Jn&&(Tn=xn.get(Jn)),Tn){const Bn=yt(Ve.dimensions.width),Ln=yt(Ve.dimensions.height),Rn=ul(Tn,Bn,Ln);ll(Mn,Fe,Ve.position,Rn)}else{const Bn={x:Mn.x+Fe.x,y:Mn.y+Fe.y},Ln=yo(Bn.x,Bn.y);Ve.position.set(Ln)}})}},2);Xt[y]=te}}function In(y){Kn[y?"unshift":"push"](()=>{h=y,zt.set(h)})}return n.$$set=y=>{"graph"in y&&i(3,W=y.graph),"width"in y&&i(4,V=y.width),"height"in y&&i(5,U=y.height),"minimap"in y&&i(0,K=y.minimap),"controls"in y&&i(1,nt=y.controls),"toggle"in y&&i(6,et=y.toggle),"fixedZoom"in y&&i(45,J=y.fixedZoom),"pannable"in y&&i(7,ut=y.pannable),"disableSelection"in y&&i(8,B=y.disableSelection),"ZOOM_INCREMENT"in y&&i(46,it=y.ZOOM_INCREMENT),"PAN_INCREMENT"in y&&i(47,X=y.PAN_INCREMENT),"PAN_TIME"in y&&i(48,mt=y.PAN_TIME),"MAX_SCALE"in y&&i(49,ht=y.MAX_SCALE),"MIN_SCALE"in y&&i(50,H=y.MIN_SCALE),"selectionColor"in y&&i(9,R=y.selectionColor),"backgroundExists"in y&&i(10,Tt=y.backgroundExists),"fitView"in y&&i(51,rt=y.fitView),"trackpadPan"in y&&i(52,bt=y.trackpadPan),"modifier"in y&&i(53,Et=y.modifier),"theme"in y&&i(44,vt=y.theme),"title"in y&&i(11,j=y.title),"drawer"in y&&i(2,Q=y.drawer),"contrast"in y&&i(12,G=y.contrast),"$$scope"in y&&i(58,I=y.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&16777216&&(s=E),n.$$.dirty[1]&8192&&vt&&document.documentElement.setAttribute("svelvet-theme",vt),n.$$.dirty[1]&9437184&&!Te&&rt&&Ie(),n.$$.dirty[0]&8256&&et&&!Ue&&an(),n.$$.dirty[0]&16385&&K&&!rn&&pn(),n.$$.dirty[0]&32770&&nt&&!we&&cn(),n.$$.dirty[0]&65540&&Q&&!je&&Je(),n.$$.dirty[0]&135168&&G&&!Dt&&Ee(),n.$$.dirty[0]&4&&console.log("Reactive Graph drawer prop:",Q)},[K,nt,Q,W,V,U,et,ut,B,R,Tt,j,G,Ue,rn,we,je,Dt,$t,Ke,Se,he,me,h,A,zt,Kt,ge,Ne,ot,Jt,Ct,Qt,qt,Gt,kn,re,ce,Xe,Sn,zn,Be,nn,On,vt,J,it,X,mt,ht,H,rt,bt,Et,Te,E,T,In,I]}class Sf extends wn{constructor(e){super(),bn(this,e,Cf,Pf,dn,{graph:3,width:4,height:5,minimap:0,controls:1,toggle:6,fixedZoom:45,pannable:7,disableSelection:8,ZOOM_INCREMENT:46,PAN_INCREMENT:47,PAN_TIME:48,MAX_SCALE:49,MIN_SCALE:50,selectionColor:9,backgroundExists:10,fitView:51,trackpadPan:52,modifier:53,theme:44,title:11,drawer:2,contrast:12},null,[-1,-1,-1])}}const Mf=n=>({}),ha=n=>({slot:"minimap"}),Tf=n=>({}),fa=n=>({slot:"controls"}),Ef=n=>({}),da=n=>({slot:"background"}),zf=n=>({}),_a=n=>({slot:"toggle"}),Af=n=>({}),ma=n=>({slot:"drawer"}),Nf=n=>({}),pa=n=>({slot:"contrast"});function Of(n){let e;return{c(){e=z("div"),m(e,"class","svelvet-temp svelte-lsy29y"),st(e,"width",n[2]?n[2]+"px":"100%"),st(e,"height",n[3]?n[3]+"px":"100%")},m(i,s){tt(i,e,s)},p(i,s){s[0]&4&&st(e,"width",i[2]?i[2]+"px":"100%"),s[0]&8&&st(e,"height",i[3]?i[3]+"px":"100%")},i:Ht,o:Ht,d(i){i&&q(e)}}}function If(n){let e,i;return e=new Sf({props:{width:n[2],height:n[3],toggle:n[6],backgroundExists:n[19],minimap:n[4],graph:n[18],fitView:n[9],fixedZoom:n[16],pannable:n[17],theme:n[1],drawer:n[7],controls:n[5],selectionColor:n[10],disableSelection:n[11],trackpadPan:n[13],modifier:n[14],title:n[15],contrast:n[8],$$slots:{contrast:[Wf],drawer:[jf],toggle:[Rf],background:[xf],controls:[Df],minimap:[Zf],default:[Bf]},$$scope:{ctx:n}}}),e.$on("edgeDrop",n[35]),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const l={};r[0]&4&&(l.width=s[2]),r[0]&8&&(l.height=s[3]),r[0]&64&&(l.toggle=s[6]),r[0]&524288&&(l.backgroundExists=s[19]),r[0]&16&&(l.minimap=s[4]),r[0]&262144&&(l.graph=s[18]),r[0]&512&&(l.fitView=s[9]),r[0]&65536&&(l.fixedZoom=s[16]),r[0]&131072&&(l.pannable=s[17]),r[0]&2&&(l.theme=s[1]),r[0]&128&&(l.drawer=s[7]),r[0]&32&&(l.controls=s[5]),r[0]&1024&&(l.selectionColor=s[10]),r[0]&2048&&(l.disableSelection=s[11]),r[0]&8192&&(l.trackpadPan=s[13]),r[0]&16384&&(l.modifier=s[14]),r[0]&32768&&(l.title=s[15]),r[0]&256&&(l.contrast=s[8]),r[0]&4097|r[1]&32&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function ga(n){let e,i;return e=new Nh({props:{mermaid:n[0],mermaidConfig:n[12]}}),{c(){ue(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const l={};r[0]&1&&(l.mermaid=s[0]),r[0]&4096&&(l.mermaidConfig=s[12]),e.$set(l)},i(s){i||(D(e.$$.fragment,s),i=!0)},o(s){F(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Bf(n){let e,i,s=n[0].length&&ga(n);const r=n[34].default,l=ke(r,n,n[36],null);return{c(){s&&s.c(),e=$(),l&&l.c()},m(u,h){s&&s.m(u,h),tt(u,e,h),l&&l.m(u,h),i=!0},p(u,h){u[0].length?s?(s.p(u,h),h[0]&1&&D(s,1)):(s=ga(u),s.c(),D(s,1),s.m(e.parentNode,e)):s&&(ye(),F(s,1,1,()=>{s=null}),be()),l&&l.p&&(!i||h[1]&32)&&Le(l,r,u,u[36],i?Pe(r,u[36],h,null):Ce(u[36]),null)},i(u){i||(D(s),D(l,u),i=!0)},o(u){F(s),F(l,u),i=!1},d(u){u&&q(e),s&&s.d(u),l&&l.d(u)}}}function Zf(n){let e;const i=n[34].minimap,s=ke(i,n,n[36],ha);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&32)&&Le(s,i,r,r[36],e?Pe(i,r[36],l,Mf):Ce(r[36]),ha)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function Df(n){let e;const i=n[34].controls,s=ke(i,n,n[36],fa);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&32)&&Le(s,i,r,r[36],e?Pe(i,r[36],l,Tf):Ce(r[36]),fa)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function xf(n){let e;const i=n[34].background,s=ke(i,n,n[36],da);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&32)&&Le(s,i,r,r[36],e?Pe(i,r[36],l,Ef):Ce(r[36]),da)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function Rf(n){let e;const i=n[34].toggle,s=ke(i,n,n[36],_a);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&32)&&Le(s,i,r,r[36],e?Pe(i,r[36],l,zf):Ce(r[36]),_a)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function jf(n){let e;const i=n[34].drawer,s=ke(i,n,n[36],ma);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&32)&&Le(s,i,r,r[36],e?Pe(i,r[36],l,Af):Ce(r[36]),ma)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function Wf(n){let e;const i=n[34].contrast,s=ke(i,n,n[36],pa);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&32)&&Le(s,i,r,r[36],e?Pe(i,r[36],l,Nf):Ce(r[36]),pa)},i(r){e||(D(s,r),e=!0)},o(r){F(s,r),e=!1},d(r){s&&s.d(r)}}}function Hf(n){let e,i,s,r;const l=[If,Of],u=[];function h(f,d){return f[18]?0:1}return e=h(n),i=u[e]=l[e](n),{c(){i.c(),s=De()},m(f,d){u[e].m(f,d),tt(f,s,d),r=!0},p(f,d){let p=e;e=h(f),e===p?u[e].p(f,d):(ye(),F(u[p],1,1,()=>{u[p]=null}),be(),i=u[e],i?i.p(f,d):(i=u[e]=l[e](f),i.c()),D(i,1),i.m(s.parentNode,s))},i(f){r||(D(i),r=!0)},o(f){F(i),r=!1},d(f){f&&q(s),u[e].d(f)}}}function Ff(n,e,i){let s,r,{$$slots:l={},$$scope:u}=e;const h=ss(l);let{mermaid:f=""}=e,{theme:d="light"}=e,{id:p=0}=e,{snapTo:g=0}=e,{zoom:b=1}=e,{TD:w=!1}=e,{editable:P=!0}=e,{locked:M=!1}=e,{width:E=0}=e,{height:A=0}=e,{minimap:T=!1}=e,{controls:I=!1}=e,{toggle:W=!1}=e,{drawer:V=!1}=e,{contrast:U=!1}=e,{fitView:K=!1}=e,{selectionColor:nt="lightblue"}=e,{edgeStyle:et="bezier"}=e,{endStyles:J=[null,null]}=e,{edge:ut=null}=e,{disableSelection:B=!1}=e,{mermaidConfig:it={}}=e,{translation:X={x:0,y:0}}=e,{trackpadPan:mt=!1}=e,{modifier:ht="meta"}=e,{raiseEdgesOnSelect:H=!1}=e,{edgesAboveNode:R=!1}=e,{title:Tt=""}=e,{fixedZoom:rt=!1}=e,{pannable:bt=!0}=e;const Et=Zi();let vt=null,j=w?"TD":"LR";Ze("snapTo",g),Ze("edgeStyle",et),Ze("endStyles",J),Ze("graphEdge",ut),Ze("raiseEdgesOnSelect",H),Ze("edgesAboveNode",R),Ze("graph",vt),Fn(()=>{console.log("Graph component mounted with drawer:",V);const Z=localStorage.getItem("state");if(console.log("stateObject during onMount:",Z),Z)i(18,vt=ac(Z)),console.log("This is the graph set using reloadStore",vt),Vo.add(vt,vt.id),console.log("graphStore updated",vt);else{let It=`G-${p||Vo.count()+1}`;i(18,vt=rl(It,{zoom:b,direction:j,editable:P,locked:M,translation:X})),Vo.add(vt,It)}});function Q(Z,It){if(!vt)return;const Xt=`N-${Z[0]}`,dt=vt.nodes.get(Xt);if(!dt)return;const Mt=dt.anchors.get(`A-${Z[1]}/N-${Z[0]}`);if(!Mt)return;const zt=`N-${It[0]}`,Yt=vt.nodes.get(zt);if(!Yt)return;const Kt=Yt.anchors.get(`A-${It[1]}/N-${It[0]}`);if(!Kt)return;const ge=vt.edges.match(Mt,Kt);ge&&vt.edges.delete(ge[0])}function G(Z){qe.call(this,n,Z)}return n.$$set=Z=>{"mermaid"in Z&&i(0,f=Z.mermaid),"theme"in Z&&i(1,d=Z.theme),"id"in Z&&i(20,p=Z.id),"snapTo"in Z&&i(21,g=Z.snapTo),"zoom"in Z&&i(22,b=Z.zoom),"TD"in Z&&i(23,w=Z.TD),"editable"in Z&&i(24,P=Z.editable),"locked"in Z&&i(25,M=Z.locked),"width"in Z&&i(2,E=Z.width),"height"in Z&&i(3,A=Z.height),"minimap"in Z&&i(4,T=Z.minimap),"controls"in Z&&i(5,I=Z.controls),"toggle"in Z&&i(6,W=Z.toggle),"drawer"in Z&&i(7,V=Z.drawer),"contrast"in Z&&i(8,U=Z.contrast),"fitView"in Z&&i(9,K=Z.fitView),"selectionColor"in Z&&i(10,nt=Z.selectionColor),"edgeStyle"in Z&&i(26,et=Z.edgeStyle),"endStyles"in Z&&i(27,J=Z.endStyles),"edge"in Z&&i(28,ut=Z.edge),"disableSelection"in Z&&i(11,B=Z.disableSelection),"mermaidConfig"in Z&&i(12,it=Z.mermaidConfig),"translation"in Z&&i(29,X=Z.translation),"trackpadPan"in Z&&i(13,mt=Z.trackpadPan),"modifier"in Z&&i(14,ht=Z.modifier),"raiseEdgesOnSelect"in Z&&i(30,H=Z.raiseEdgesOnSelect),"edgesAboveNode"in Z&&i(31,R=Z.edgesAboveNode),"title"in Z&&i(15,Tt=Z.title),"fixedZoom"in Z&&i(16,rt=Z.fixedZoom),"pannable"in Z&&i(17,bt=Z.pannable),"$$scope"in Z&&i(36,u=Z.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&262144&&i(33,r=vt&&vt.edges),n.$$.dirty[0]&4456448&&vt&&vt.transforms.scale.set(b),n.$$.dirty[1]&4&&r&&r.onEdgeChange((Z,It)=>{Et(It,{sourceAnchor:Z.source,targetAnchor:Z.target,sourceNode:Z.source.node,targetNode:Z.target.node})})},i(19,s=h.background),[f,d,E,A,T,I,W,V,U,K,nt,B,it,mt,ht,Tt,rt,bt,vt,s,p,g,b,w,P,M,et,J,ut,X,H,R,Q,r,l,G,u]}class Gf extends wn{constructor(e){super(),bn(this,e,Ff,Hf,dn,{mermaid:0,theme:1,id:20,snapTo:21,zoom:22,TD:23,editable:24,locked:25,width:2,height:3,minimap:4,controls:5,toggle:6,drawer:7,contrast:8,fitView:9,selectionColor:10,edgeStyle:26,endStyles:27,edge:28,disableSelection:11,mermaidConfig:12,translation:29,trackpadPan:13,modifier:14,raiseEdgesOnSelect:30,edgesAboveNode:31,title:15,fixedZoom:16,pannable:17,disconnect:32},null,[-1,-1])}get disconnect(){return this.$$.ctx[32]}}var Uf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},is={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(n,e){(function(i,s){s(e)})(Uf,function(i){var s="1.9.4";function r(t){var o,a,c,_;for(a=1,c=arguments.length;a<c;a++){_=arguments[a];for(o in _)t[o]=_[o]}return t}var l=Object.create||function(){function t(){}return function(o){return t.prototype=o,new t}}();function u(t,o){var a=Array.prototype.slice;if(t.bind)return t.bind.apply(t,a.call(arguments,1));var c=a.call(arguments,2);return function(){return t.apply(o,c.length?c.concat(a.call(arguments)):arguments)}}var h=0;function f(t){return"_leaflet_id"in t||(t._leaflet_id=++h),t._leaflet_id}function d(t,o,a){var c,_,v,C;return C=function(){c=!1,_&&(v.apply(a,_),_=!1)},v=function(){c?_=arguments:(t.apply(a,arguments),setTimeout(C,o),c=!0)},v}function p(t,o,a){var c=o[1],_=o[0],v=c-_;return t===c&&a?t:((t-_)%v+v)%v+_}function g(){return!1}function b(t,o){if(o===!1)return t;var a=Math.pow(10,o===void 0?6:o);return Math.round(t*a)/a}function w(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function P(t){return w(t).split(/\s+/)}function M(t,o){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?l(t.options):{});for(var a in o)t.options[a]=o[a];return t.options}function E(t,o,a){var c=[];for(var _ in t)c.push(encodeURIComponent(a?_.toUpperCase():_)+"="+encodeURIComponent(t[_]));return(!o||o.indexOf("?")===-1?"?":"&")+c.join("&")}var A=/\{ *([\w_ -]+) *\}/g;function T(t,o){return t.replace(A,function(a,c){var _=o[c];if(_===void 0)throw new Error("No value provided for variable "+a);return typeof _=="function"&&(_=_(o)),_})}var I=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function W(t,o){for(var a=0;a<t.length;a++)if(t[a]===o)return a;return-1}var V="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function U(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var K=0;function nt(t){var o=+new Date,a=Math.max(0,16-(o-K));return K=o+a,window.setTimeout(t,a)}var et=window.requestAnimationFrame||U("RequestAnimationFrame")||nt,J=window.cancelAnimationFrame||U("CancelAnimationFrame")||U("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function ut(t,o,a){if(a&&et===nt)t.call(o);else return et.call(window,u(t,o))}function B(t){t&&J.call(window,t)}var it={__proto__:null,extend:r,create:l,bind:u,get lastId(){return h},stamp:f,throttle:d,wrapNum:p,falseFn:g,formatNum:b,trim:w,splitWords:P,setOptions:M,getParamString:E,template:T,isArray:I,indexOf:W,emptyImageUrl:V,requestFn:et,cancelFn:J,requestAnimFrame:ut,cancelAnimFrame:B};function X(){}X.extend=function(t){var o=function(){M(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},a=o.__super__=this.prototype,c=l(a);c.constructor=o,o.prototype=c;for(var _ in this)Object.prototype.hasOwnProperty.call(this,_)&&_!=="prototype"&&_!=="__super__"&&(o[_]=this[_]);return t.statics&&r(o,t.statics),t.includes&&(mt(t.includes),r.apply(null,[c].concat(t.includes))),r(c,t),delete c.statics,delete c.includes,c.options&&(c.options=a.options?l(a.options):{},r(c.options,t.options)),c._initHooks=[],c.callInitHooks=function(){if(!this._initHooksCalled){a.callInitHooks&&a.callInitHooks.call(this),this._initHooksCalled=!0;for(var v=0,C=c._initHooks.length;v<C;v++)c._initHooks[v].call(this)}},o},X.include=function(t){var o=this.prototype.options;return r(this.prototype,t),t.options&&(this.prototype.options=o,this.mergeOptions(t.options)),this},X.mergeOptions=function(t){return r(this.prototype.options,t),this},X.addInitHook=function(t){var o=Array.prototype.slice.call(arguments,1),a=typeof t=="function"?t:function(){this[t].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(a),this};function mt(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=I(t)?t:[t];for(var o=0;o<t.length;o++)t[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ht={on:function(t,o,a){if(typeof t=="object")for(var c in t)this._on(c,t[c],o);else{t=P(t);for(var _=0,v=t.length;_<v;_++)this._on(t[_],o,a)}return this},off:function(t,o,a){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var c in t)this._off(c,t[c],o);else{t=P(t);for(var _=arguments.length===1,v=0,C=t.length;v<C;v++)_?this._off(t[v]):this._off(t[v],o,a)}return this},_on:function(t,o,a,c){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(t,o,a)===!1){a===this&&(a=void 0);var _={fn:o,ctx:a};c&&(_.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(_)}},_off:function(t,o,a){var c,_,v;if(this._events&&(c=this._events[t],!!c)){if(arguments.length===1){if(this._firingCount)for(_=0,v=c.length;_<v;_++)c[_].fn=g;delete this._events[t];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var C=this._listens(t,o,a);if(C!==!1){var N=c[C];this._firingCount&&(N.fn=g,this._events[t]=c=c.slice()),c.splice(C,1)}}},fire:function(t,o,a){if(!this.listens(t,a))return this;var c=r({},o,{type:t,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var _=this._events[t];if(_){this._firingCount=this._firingCount+1||1;for(var v=0,C=_.length;v<C;v++){var N=_[v],x=N.fn;N.once&&this.off(t,x,N.ctx),x.call(N.ctx||this,c)}this._firingCount--}}return a&&this._propagateEvent(c),this},listens:function(t,o,a,c){typeof t!="string"&&console.warn('"string" type argument expected');var _=o;typeof o!="function"&&(c=!!o,_=void 0,a=void 0);var v=this._events&&this._events[t];if(v&&v.length&&this._listens(t,_,a)!==!1)return!0;if(c){for(var C in this._eventParents)if(this._eventParents[C].listens(t,o,a,c))return!0}return!1},_listens:function(t,o,a){if(!this._events)return!1;var c=this._events[t]||[];if(!o)return!!c.length;a===this&&(a=void 0);for(var _=0,v=c.length;_<v;_++)if(c[_].fn===o&&c[_].ctx===a)return _;return!1},once:function(t,o,a){if(typeof t=="object")for(var c in t)this._on(c,t[c],o,!0);else{t=P(t);for(var _=0,v=t.length;_<v;_++)this._on(t[_],o,a,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[f(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[f(t)],this},_propagateEvent:function(t){for(var o in this._eventParents)this._eventParents[o].fire(t.type,r({layer:t.target,propagatedFrom:t.target},t),!0)}};ht.addEventListener=ht.on,ht.removeEventListener=ht.clearAllEventListeners=ht.off,ht.addOneTimeEventListener=ht.once,ht.fireEvent=ht.fire,ht.hasEventListeners=ht.listens;var H=X.extend(ht);function R(t,o,a){this.x=a?Math.round(t):t,this.y=a?Math.round(o):o}var Tt=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};R.prototype={clone:function(){return new R(this.x,this.y)},add:function(t){return this.clone()._add(rt(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(rt(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new R(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new R(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Tt(this.x),this.y=Tt(this.y),this},distanceTo:function(t){t=rt(t);var o=t.x-this.x,a=t.y-this.y;return Math.sqrt(o*o+a*a)},equals:function(t){return t=rt(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=rt(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+b(this.x)+", "+b(this.y)+")"}};function rt(t,o,a){return t instanceof R?t:I(t)?new R(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new R(t.x,t.y):new R(t,o,a)}function bt(t,o){if(t)for(var a=o?[t,o]:t,c=0,_=a.length;c<_;c++)this.extend(a[c])}bt.prototype={extend:function(t){var o,a;if(!t)return this;if(t instanceof R||typeof t[0]=="number"||"x"in t)o=a=rt(t);else if(t=Et(t),o=t.min,a=t.max,!o||!a)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=a.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)),this},getCenter:function(t){return rt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return rt(this.min.x,this.max.y)},getTopRight:function(){return rt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var o,a;return typeof t[0]=="number"||t instanceof R?t=rt(t):t=Et(t),t instanceof bt?(o=t.min,a=t.max):o=a=t,o.x>=this.min.x&&a.x<=this.max.x&&o.y>=this.min.y&&a.y<=this.max.y},intersects:function(t){t=Et(t);var o=this.min,a=this.max,c=t.min,_=t.max,v=_.x>=o.x&&c.x<=a.x,C=_.y>=o.y&&c.y<=a.y;return v&&C},overlaps:function(t){t=Et(t);var o=this.min,a=this.max,c=t.min,_=t.max,v=_.x>o.x&&c.x<a.x,C=_.y>o.y&&c.y<a.y;return v&&C},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var o=this.min,a=this.max,c=Math.abs(o.x-a.x)*t,_=Math.abs(o.y-a.y)*t;return Et(rt(o.x-c,o.y-_),rt(a.x+c,a.y+_))},equals:function(t){return t?(t=Et(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function Et(t,o){return!t||t instanceof bt?t:new bt(t,o)}function vt(t,o){if(t)for(var a=o?[t,o]:t,c=0,_=a.length;c<_;c++)this.extend(a[c])}vt.prototype={extend:function(t){var o=this._southWest,a=this._northEast,c,_;if(t instanceof Q)c=t,_=t;else if(t instanceof vt){if(c=t._southWest,_=t._northEast,!c||!_)return this}else return t?this.extend(G(t)||j(t)):this;return!o&&!a?(this._southWest=new Q(c.lat,c.lng),this._northEast=new Q(_.lat,_.lng)):(o.lat=Math.min(c.lat,o.lat),o.lng=Math.min(c.lng,o.lng),a.lat=Math.max(_.lat,a.lat),a.lng=Math.max(_.lng,a.lng)),this},pad:function(t){var o=this._southWest,a=this._northEast,c=Math.abs(o.lat-a.lat)*t,_=Math.abs(o.lng-a.lng)*t;return new vt(new Q(o.lat-c,o.lng-_),new Q(a.lat+c,a.lng+_))},getCenter:function(){return new Q((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new Q(this.getNorth(),this.getWest())},getSouthEast:function(){return new Q(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof Q||"lat"in t?t=G(t):t=j(t);var o=this._southWest,a=this._northEast,c,_;return t instanceof vt?(c=t.getSouthWest(),_=t.getNorthEast()):c=_=t,c.lat>=o.lat&&_.lat<=a.lat&&c.lng>=o.lng&&_.lng<=a.lng},intersects:function(t){t=j(t);var o=this._southWest,a=this._northEast,c=t.getSouthWest(),_=t.getNorthEast(),v=_.lat>=o.lat&&c.lat<=a.lat,C=_.lng>=o.lng&&c.lng<=a.lng;return v&&C},overlaps:function(t){t=j(t);var o=this._southWest,a=this._northEast,c=t.getSouthWest(),_=t.getNorthEast(),v=_.lat>o.lat&&c.lat<a.lat,C=_.lng>o.lng&&c.lng<a.lng;return v&&C},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,o){return t?(t=j(t),this._southWest.equals(t.getSouthWest(),o)&&this._northEast.equals(t.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function j(t,o){return t instanceof vt?t:new vt(t,o)}function Q(t,o,a){if(isNaN(t)||isNaN(o))throw new Error("Invalid LatLng object: ("+t+", "+o+")");this.lat=+t,this.lng=+o,a!==void 0&&(this.alt=+a)}Q.prototype={equals:function(t,o){if(!t)return!1;t=G(t);var a=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return a<=(o===void 0?1e-9:o)},toString:function(t){return"LatLng("+b(this.lat,t)+", "+b(this.lng,t)+")"},distanceTo:function(t){return It.distance(this,G(t))},wrap:function(){return It.wrapLatLng(this)},toBounds:function(t){var o=180*t/40075017,a=o/Math.cos(Math.PI/180*this.lat);return j([this.lat-o,this.lng-a],[this.lat+o,this.lng+a])},clone:function(){return new Q(this.lat,this.lng,this.alt)}};function G(t,o,a){return t instanceof Q?t:I(t)&&typeof t[0]!="object"?t.length===3?new Q(t[0],t[1],t[2]):t.length===2?new Q(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new Q(t.lat,"lng"in t?t.lng:t.lon,t.alt):o===void 0?null:new Q(t,o,a)}var Z={latLngToPoint:function(t,o){var a=this.projection.project(t),c=this.scale(o);return this.transformation._transform(a,c)},pointToLatLng:function(t,o){var a=this.scale(o),c=this.transformation.untransform(t,a);return this.projection.unproject(c)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var o=this.projection.bounds,a=this.scale(t),c=this.transformation.transform(o.min,a),_=this.transformation.transform(o.max,a);return new bt(c,_)},infinite:!1,wrapLatLng:function(t){var o=this.wrapLng?p(t.lng,this.wrapLng,!0):t.lng,a=this.wrapLat?p(t.lat,this.wrapLat,!0):t.lat,c=t.alt;return new Q(a,o,c)},wrapLatLngBounds:function(t){var o=t.getCenter(),a=this.wrapLatLng(o),c=o.lat-a.lat,_=o.lng-a.lng;if(c===0&&_===0)return t;var v=t.getSouthWest(),C=t.getNorthEast(),N=new Q(v.lat-c,v.lng-_),x=new Q(C.lat-c,C.lng-_);return new vt(N,x)}},It=r({},Z,{wrapLng:[-180,180],R:6371e3,distance:function(t,o){var a=Math.PI/180,c=t.lat*a,_=o.lat*a,v=Math.sin((o.lat-t.lat)*a/2),C=Math.sin((o.lng-t.lng)*a/2),N=v*v+Math.cos(c)*Math.cos(_)*C*C,x=2*Math.atan2(Math.sqrt(N),Math.sqrt(1-N));return this.R*x}}),Xt=6378137,dt={R:Xt,MAX_LATITUDE:85.0511287798,project:function(t){var o=Math.PI/180,a=this.MAX_LATITUDE,c=Math.max(Math.min(a,t.lat),-a),_=Math.sin(c*o);return new R(this.R*t.lng*o,this.R*Math.log((1+_)/(1-_))/2)},unproject:function(t){var o=180/Math.PI;return new Q((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*o,t.x*o/this.R)},bounds:function(){var t=Xt*Math.PI;return new bt([-t,-t],[t,t])}()};function Mt(t,o,a,c){if(I(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=o,this._c=a,this._d=c}Mt.prototype={transform:function(t,o){return this._transform(t.clone(),o)},_transform:function(t,o){return o=o||1,t.x=o*(this._a*t.x+this._b),t.y=o*(this._c*t.y+this._d),t},untransform:function(t,o){return o=o||1,new R((t.x/o-this._b)/this._a,(t.y/o-this._d)/this._c)}};function zt(t,o,a,c){return new Mt(t,o,a,c)}var Yt=r({},It,{code:"EPSG:3857",projection:dt,transformation:function(){var t=.5/(Math.PI*dt.R);return zt(t,.5,-t,.5)}()}),Kt=r({},Yt,{code:"EPSG:900913"});function ge(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Ne(t,o){var a="",c,_,v,C,N,x;for(c=0,v=t.length;c<v;c++){for(N=t[c],_=0,C=N.length;_<C;_++)x=N[_],a+=(_?"L":"M")+x.x+" "+x.y;a+=o?wt.svg?"z":"x":""}return a||"M0 0"}var ot=document.documentElement.style,_e="ActiveXObject"in window,Jt=_e&&!document.addEventListener,Ct="msLaunchUri"in navigator&&!("documentMode"in document),Qt=Be("webkit"),qt=Be("android"),Gt=Be("android 2")||Be("android 3"),Oe=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),xe=qt&&Be("Google")&&Oe<537&&!("AudioNode"in window),$t=!!window.opera,Ke=!Ct&&Be("chrome"),Se=Be("gecko")&&!Qt&&!$t&&!_e,he=!Ke&&Be("safari"),me=Be("phantom"),Me="OTransition"in ot,Te=navigator.platform.indexOf("Win")===0,Re=_e&&"transition"in ot,Ue="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Gt,rn="MozPerspective"in ot,we=!window.L_DISABLE_3D&&(Re||Ue||rn)&&!Me&&!me,je=typeof orientation<"u"||Be("mobile"),Dt=je&&Qt,un=je&&Ue,Ie=!window.PointerEvent&&window.MSPointerEvent,pn=!!(window.PointerEvent||Ie),an="ontouchstart"in window||!!window.TouchEvent,cn=!window.L_NO_TOUCH&&(an||pn),Je=je&&$t,Ee=je&&Se,kn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,re=function(){var t=!1;try{var o=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",g,o),window.removeEventListener("testPassiveEventSupport",g,o)}catch{}return t}(),ce=function(){return!!document.createElement("canvas").getContext}(),Xe=!!(document.createElementNS&&ge("svg").createSVGRect),Sn=!!Xe&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Pn=!Xe&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var o=t.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}}(),Nn=navigator.platform.indexOf("Mac")===0,zn=navigator.platform.indexOf("Linux")===0;function Be(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var wt={ie:_e,ielt9:Jt,edge:Ct,webkit:Qt,android:qt,android23:Gt,androidStock:xe,opera:$t,chrome:Ke,gecko:Se,safari:he,phantom:me,opera12:Me,win:Te,ie3d:Re,webkit3d:Ue,gecko3d:rn,any3d:we,mobile:je,mobileWebkit:Dt,mobileWebkit3d:un,msPointer:Ie,pointer:pn,touch:cn,touchNative:an,mobileOpera:Je,mobileGecko:Ee,retina:kn,passiveEvents:re,canvas:ce,svg:Xe,vml:Pn,inlineSvg:Sn,mac:Nn,linux:zn},nn=wt.msPointer?"MSPointerDown":"pointerdown",On=wt.msPointer?"MSPointerMove":"pointermove",on=wt.msPointer?"MSPointerUp":"pointerup",In=wt.msPointer?"MSPointerCancel":"pointercancel",y={touchstart:nn,touchmove:On,touchend:on,touchcancel:In},ft={touchstart:Ve,touchmove:Fe,touchend:Fe,touchcancel:Fe},kt={},Pt=!1;function At(t,o,a){return o==="touchstart"&&We(),ft[o]?(a=ft[o].bind(this,a),t.addEventListener(y[o],a,!1),a):(console.warn("wrong event specified:",o),g)}function O(t,o,a){if(!y[o]){console.warn("wrong event specified:",o);return}t.removeEventListener(y[o],a,!1)}function Wt(t){kt[t.pointerId]=t}function ee(t){kt[t.pointerId]&&(kt[t.pointerId]=t)}function te(t){delete kt[t.pointerId]}function We(){Pt||(document.addEventListener(nn,Wt,!0),document.addEventListener(On,ee,!0),document.addEventListener(on,te,!0),document.addEventListener(In,te,!0),Pt=!0)}function Fe(t,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var a in kt)o.touches.push(kt[a]);o.changedTouches=[o],t(o)}}function Ve(t,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&An(o),Fe(t,o)}function Mn(t){var o={},a,c;for(c in t)a=t[c],o[c]=a&&a.bind?a.bind(t):a;return t=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var Tn=200;function Jn(t,o){t.addEventListener("dblclick",o);var a=0,c;function _(v){if(v.detail!==1){c=v.detail;return}if(!(v.pointerType==="mouse"||v.sourceCapabilities&&!v.sourceCapabilities.firesTouchEvents)){var C=ls(v);if(!(C.some(function(x){return x instanceof HTMLLabelElement&&x.attributes.for})&&!C.some(function(x){return x instanceof HTMLInputElement||x instanceof HTMLSelectElement}))){var N=Date.now();N-a<=Tn?(c++,c===2&&o(Mn(v))):c=1,a=N}}}return t.addEventListener("click",_),{dblclick:o,simDblclick:_}}function xn(t,o){t.removeEventListener("dblclick",o.dblclick),t.removeEventListener("click",o.simDblclick)}var Bn=vn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Ln=vn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Rn=Ln==="webkitTransition"||Ln==="OTransition"?Ln+"End":"transitionend";function hn(t){return typeof t=="string"?document.getElementById(t):t}function pt(t,o){var a=t.style[o]||t.currentStyle&&t.currentStyle[o];if((!a||a==="auto")&&document.defaultView){var c=document.defaultView.getComputedStyle(t,null);a=c?c[o]:null}return a==="auto"?null:a}function jt(t,o,a){var c=document.createElement(t);return c.className=o||"",a&&a.appendChild(c),c}function fe(t){var o=t.parentNode;o&&o.removeChild(t)}function _n(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Qe(t){var o=t.parentNode;o&&o.lastChild!==t&&o.appendChild(t)}function pe(t){var o=t.parentNode;o&&o.firstChild!==t&&o.insertBefore(t,o.firstChild)}function ze(t,o){if(t.classList!==void 0)return t.classList.contains(o);var a=sn(t);return a.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(a)}function xt(t,o){if(t.classList!==void 0)for(var a=P(o),c=0,_=a.length;c<_;c++)t.classList.add(a[c]);else if(!ze(t,o)){var v=sn(t);fn(t,(v?v+" ":"")+o)}}function ae(t,o){t.classList!==void 0?t.classList.remove(o):fn(t,w((" "+sn(t)+" ").replace(" "+o+" "," ")))}function fn(t,o){t.className.baseVal===void 0?t.className=o:t.className.baseVal=o}function sn(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function gn(t,o){"opacity"in t.style?t.style.opacity=o:"filter"in t.style&&Qn(t,o)}function Qn(t,o){var a=!1,c="DXImageTransform.Microsoft.Alpha";try{a=t.filters.item(c)}catch{if(o===1)return}o=Math.round(o*100),a?(a.Enabled=o!==100,a.Opacity=o):t.style.filter+=" progid:"+c+"(opacity="+o+")"}function vn(t){for(var o=document.documentElement.style,a=0;a<t.length;a++)if(t[a]in o)return t[a];return!1}function Bt(t,o,a){var c=o||new R(0,0);t.style[Bn]=(wt.ie3d?"translate("+c.x+"px,"+c.y+"px)":"translate3d("+c.x+"px,"+c.y+"px,0)")+(a?" scale("+a+")":"")}function Rt(t,o){t._leaflet_pos=o,wt.any3d?Bt(t,o):(t.style.left=o.x+"px",t.style.top=o.y+"px")}function S(t){return t._leaflet_pos||new R(0,0)}var at,lt,Nt;if("onselectstart"in document)at=function(){Ut(window,"selectstart",An)},lt=function(){Ye(window,"selectstart",An)};else{var Lt=vn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);at=function(){if(Lt){var t=document.documentElement.style;Nt=t[Lt],t[Lt]="none"}},lt=function(){Lt&&(document.documentElement.style[Lt]=Nt,Nt=void 0)}}function ie(){Ut(window,"dragstart",An)}function Gn(){Ye(window,"dragstart",An)}var $e,Ot;function tn(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(Un(),$e=t,Ot=t.style.outlineStyle,t.style.outlineStyle="none",Ut(window,"keydown",Un))}function Un(){$e&&($e.style.outlineStyle=Ot,$e=void 0,Ot=void 0,Ye(window,"keydown",Un))}function fi(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function ri(t){var o=t.getBoundingClientRect();return{x:o.width/t.offsetWidth||1,y:o.height/t.offsetHeight||1,boundingClientRect:o}}var Di={__proto__:null,TRANSFORM:Bn,TRANSITION:Ln,TRANSITION_END:Rn,get:hn,getStyle:pt,create:jt,remove:fe,empty:_n,toFront:Qe,toBack:pe,hasClass:ze,addClass:xt,removeClass:ae,setClass:fn,getClass:sn,setOpacity:gn,testProp:vn,setTransform:Bt,setPosition:Rt,getPosition:S,get disableTextSelection(){return at},get enableTextSelection(){return lt},disableImageDrag:ie,enableImageDrag:Gn,preventOutline:tn,restoreOutline:Un,getSizedParentNode:fi,getScale:ri};function Ut(t,o,a,c){if(o&&typeof o=="object")for(var _ in o)So(t,_,o[_],a);else{o=P(o);for(var v=0,C=o.length;v<C;v++)So(t,o[v],a,c)}return this}var ei="_leaflet_events";function Ye(t,o,a,c){if(arguments.length===1)as(t),delete t[ei];else if(o&&typeof o=="object")for(var _ in o)Mo(t,_,o[_],a);else if(o=P(o),arguments.length===2)as(t,function(N){return W(o,N)!==-1});else for(var v=0,C=o.length;v<C;v++)Mo(t,o[v],a,c);return this}function as(t,o){for(var a in t[ei]){var c=a.split(/\d/)[0];(!o||o(c))&&Mo(t,c,null,null,a)}}var Co={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function So(t,o,a,c){var _=o+f(a)+(c?"_"+f(c):"");if(t[ei]&&t[ei][_])return this;var v=function(N){return a.call(c||t,N||window.event)},C=v;!wt.touchNative&&wt.pointer&&o.indexOf("touch")===0?v=At(t,o,v):wt.touch&&o==="dblclick"?v=Jn(t,v):"addEventListener"in t?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?t.addEventListener(Co[o]||o,v,wt.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(v=function(N){N=N||window.event,Eo(t,N)&&C(N)},t.addEventListener(Co[o],v,!1)):t.addEventListener(o,C,!1):t.attachEvent("on"+o,v),t[ei]=t[ei]||{},t[ei][_]=v}function Mo(t,o,a,c,_){_=_||o+f(a)+(c?"_"+f(c):"");var v=t[ei]&&t[ei][_];if(!v)return this;!wt.touchNative&&wt.pointer&&o.indexOf("touch")===0?O(t,o,v):wt.touch&&o==="dblclick"?xn(t,v):"removeEventListener"in t?t.removeEventListener(Co[o]||o,v,!1):t.detachEvent("on"+o,v),t[ei][_]=null}function gi(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function To(t){return So(t,"wheel",gi),this}function xi(t){return Ut(t,"mousedown touchstart dblclick contextmenu",gi),t._leaflet_disable_click=!0,this}function An(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function vi(t){return An(t),gi(t),this}function ls(t){if(t.composedPath)return t.composedPath();for(var o=[],a=t.target;a;)o.push(a),a=a.parentNode;return o}function us(t,o){if(!o)return new R(t.clientX,t.clientY);var a=ri(o),c=a.boundingClientRect;return new R((t.clientX-c.left)/a.x-o.clientLeft,(t.clientY-c.top)/a.y-o.clientTop)}var _l=wt.linux&&wt.chrome?window.devicePixelRatio:wt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function cs(t){return wt.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/_l:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function Eo(t,o){var a=o.relatedTarget;if(!a)return!0;try{for(;a&&a!==t;)a=a.parentNode}catch{return!1}return a!==t}var ml={__proto__:null,on:Ut,off:Ye,stopPropagation:gi,disableScrollPropagation:To,disableClickPropagation:xi,preventDefault:An,stop:vi,getPropagationPath:ls,getMousePosition:us,getWheelDelta:cs,isExternalTarget:Eo,addListener:Ut,removeListener:Ye},hs=H.extend({run:function(t,o,a,c){this.stop(),this._el=t,this._inProgress=!0,this._duration=a||.25,this._easeOutPower=1/Math.max(c||.5,.2),this._startPos=S(t),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ut(this._animate,this),this._step()},_step:function(t){var o=+new Date-this._startTime,a=this._duration*1e3;o<a?this._runFrame(this._easeOut(o/a),t):(this._runFrame(1),this._complete())},_runFrame:function(t,o){var a=this._startPos.add(this._offset.multiplyBy(t));o&&a._round(),Rt(this._el,a),this.fire("step")},_complete:function(){B(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),ve=H.extend({options:{crs:Yt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,o){o=M(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=u(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView(G(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Ln&&wt.any3d&&!wt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ut(this._proxy,Rn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,o,a){if(o=o===void 0?this._zoom:this._limitZoom(o),t=this._limitCenter(G(t),o,this.options.maxBounds),a=a||{},this._stop(),this._loaded&&!a.reset&&a!==!0){a.animate!==void 0&&(a.zoom=r({animate:a.animate},a.zoom),a.pan=r({animate:a.animate,duration:a.duration},a.pan));var c=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,o,a.zoom):this._tryAnimatedPan(t,a.pan);if(c)return clearTimeout(this._sizeTimer),this}return this._resetView(t,o,a.pan&&a.pan.noMoveStart),this},setZoom:function(t,o){return this._loaded?this.setView(this.getCenter(),t,{zoom:o}):(this._zoom=t,this)},zoomIn:function(t,o){return t=t||(wt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,o)},zoomOut:function(t,o){return t=t||(wt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,o)},setZoomAround:function(t,o,a){var c=this.getZoomScale(o),_=this.getSize().divideBy(2),v=t instanceof R?t:this.latLngToContainerPoint(t),C=v.subtract(_).multiplyBy(1-1/c),N=this.containerPointToLatLng(_.add(C));return this.setView(N,o,{zoom:a})},_getBoundsCenterZoom:function(t,o){o=o||{},t=t.getBounds?t.getBounds():j(t);var a=rt(o.paddingTopLeft||o.padding||[0,0]),c=rt(o.paddingBottomRight||o.padding||[0,0]),_=this.getBoundsZoom(t,!1,a.add(c));if(_=typeof o.maxZoom=="number"?Math.min(o.maxZoom,_):_,_===1/0)return{center:t.getCenter(),zoom:_};var v=c.subtract(a).divideBy(2),C=this.project(t.getSouthWest(),_),N=this.project(t.getNorthEast(),_),x=this.unproject(C.add(N).divideBy(2).add(v),_);return{center:x,zoom:_}},fitBounds:function(t,o){if(t=j(t),!t.isValid())throw new Error("Bounds are not valid.");var a=this._getBoundsCenterZoom(t,o);return this.setView(a.center,a.zoom,o)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,o){return this.setView(t,this._zoom,{pan:o})},panBy:function(t,o){if(t=rt(t).round(),o=o||{},!t.x&&!t.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new hs,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){xt(this._mapPane,"leaflet-pan-anim");var a=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,a,o.duration||.25,o.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,o,a){if(a=a||{},a.animate===!1||!wt.any3d)return this.setView(t,o,a);this._stop();var c=this.project(this.getCenter()),_=this.project(t),v=this.getSize(),C=this._zoom;t=G(t),o=o===void 0?C:o;var N=Math.max(v.x,v.y),x=N*this.getZoomScale(C,o),ct=_.distanceTo(c)||1,St=1.42,Ft=St*St;function le(yn){var fo=yn?-1:1,iu=yn?x:N,ou=x*x-N*N+fo*Ft*Ft*ct*ct,su=2*iu*Ft*ct,jo=ou/su,Us=Math.sqrt(jo*jo+1)-jo,ru=Us<1e-9?-18:Math.log(Us);return ru}function Zn(yn){return(Math.exp(yn)-Math.exp(-yn))/2}function En(yn){return(Math.exp(yn)+Math.exp(-yn))/2}function Xn(yn){return Zn(yn)/En(yn)}var jn=le(0);function zi(yn){return N*(En(jn)/En(jn+St*yn))}function $l(yn){return N*(En(jn)*Xn(jn+St*yn)-Zn(jn))/Ft}function tu(yn){return 1-Math.pow(1-yn,1.5)}var eu=Date.now(),Fs=(le(1)-jn)/St,nu=a.duration?1e3*a.duration:1e3*Fs*.8;function Gs(){var yn=(Date.now()-eu)/nu,fo=tu(yn)*Fs;yn<=1?(this._flyToFrame=ut(Gs,this),this._move(this.unproject(c.add(_.subtract(c).multiplyBy($l(fo)/ct)),C),this.getScaleZoom(N/zi(fo),C),{flyTo:!0})):this._move(t,o)._moveEnd(!0)}return this._moveStart(!0,a.noMoveStart),Gs.call(this),this},flyToBounds:function(t,o){var a=this._getBoundsCenterZoom(t,o);return this.flyTo(a.center,a.zoom,o)},setMaxBounds:function(t){return t=j(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var o=this.options.minZoom;return this.options.minZoom=t,this._loaded&&o!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var o=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&o!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,o){this._enforcingBounds=!0;var a=this.getCenter(),c=this._limitCenter(a,this._zoom,j(t));return a.equals(c)||this.panTo(c,o),this._enforcingBounds=!1,this},panInside:function(t,o){o=o||{};var a=rt(o.paddingTopLeft||o.padding||[0,0]),c=rt(o.paddingBottomRight||o.padding||[0,0]),_=this.project(this.getCenter()),v=this.project(t),C=this.getPixelBounds(),N=Et([C.min.add(a),C.max.subtract(c)]),x=N.getSize();if(!N.contains(v)){this._enforcingBounds=!0;var ct=v.subtract(N.getCenter()),St=N.extend(v).getSize().subtract(x);_.x+=ct.x<0?-St.x:St.x,_.y+=ct.y<0?-St.y:St.y,this.panTo(this.unproject(_),o),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=r({animate:!1,pan:!0},t===!0?{animate:!0}:t);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var a=this.getSize(),c=o.divideBy(2).round(),_=a.divideBy(2).round(),v=c.subtract(_);return!v.x&&!v.y?this:(t.animate&&t.pan?this.panBy(v):(t.pan&&this._rawPanBy(v),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(u(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:a}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=r({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=u(this._handleGeolocationResponse,this),a=u(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,a,t):navigator.geolocation.getCurrentPosition(o,a,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var o=t.code,a=t.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+a+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var o=t.coords.latitude,a=t.coords.longitude,c=new Q(o,a),_=c.toBounds(t.coords.accuracy*2),v=this._locateOptions;if(v.setView){var C=this.getBoundsZoom(_);this.setView(c,v.maxZoom?Math.min(C,v.maxZoom):C)}var N={latlng:c,bounds:_,timestamp:t.timestamp};for(var x in t.coords)typeof t.coords[x]=="number"&&(N[x]=t.coords[x]);this.fire("locationfound",N)}},addHandler:function(t,o){if(!o)return this;var a=this[t]=new o(this);return this._handlers.push(a),this.options[t]&&a.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),fe(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(B(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)fe(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,o){var a="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),c=jt("div",a,o||this._mapPane);return t&&(this._panes[t]=c),c},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),o=this.unproject(t.getBottomLeft()),a=this.unproject(t.getTopRight());return new vt(o,a)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,o,a){t=j(t),a=rt(a||[0,0]);var c=this.getZoom()||0,_=this.getMinZoom(),v=this.getMaxZoom(),C=t.getNorthWest(),N=t.getSouthEast(),x=this.getSize().subtract(a),ct=Et(this.project(N,c),this.project(C,c)).getSize(),St=wt.any3d?this.options.zoomSnap:1,Ft=x.x/ct.x,le=x.y/ct.y,Zn=o?Math.max(Ft,le):Math.min(Ft,le);return c=this.getScaleZoom(Zn,c),St&&(c=Math.round(c/(St/100))*(St/100),c=o?Math.ceil(c/St)*St:Math.floor(c/St)*St),Math.max(_,Math.min(v,c))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new R(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,o){var a=this._getTopLeftPoint(t,o);return new bt(a,a.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,o){var a=this.options.crs;return o=o===void 0?this._zoom:o,a.scale(t)/a.scale(o)},getScaleZoom:function(t,o){var a=this.options.crs;o=o===void 0?this._zoom:o;var c=a.zoom(t*a.scale(o));return isNaN(c)?1/0:c},project:function(t,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint(G(t),o)},unproject:function(t,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(rt(t),o)},layerPointToLatLng:function(t){var o=rt(t).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(t){var o=this.project(G(t))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(G(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(j(t))},distance:function(t,o){return this.options.crs.distance(G(t),G(o))},containerPointToLayerPoint:function(t){return rt(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return rt(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var o=this.containerPointToLayerPoint(rt(t));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(G(t)))},mouseEventToContainerPoint:function(t){return us(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var o=this._container=hn(t);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ut(o,"scroll",this._onScroll,this),this._containerId=f(o)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&wt.any3d,xt(t,"leaflet-container"+(wt.touch?" leaflet-touch":"")+(wt.retina?" leaflet-retina":"")+(wt.ielt9?" leaflet-oldie":"")+(wt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=pt(t,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Rt(this._mapPane,new R(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(xt(t.markerPane,"leaflet-zoom-hide"),xt(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,o,a){Rt(this._mapPane,new R(0,0));var c=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var _=this._zoom!==o;this._moveStart(_,a)._move(t,o)._moveEnd(_),this.fire("viewreset"),c&&this.fire("load")},_moveStart:function(t,o){return t&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(t,o,a,c){o===void 0&&(o=this._zoom);var _=this._zoom!==o;return this._zoom=o,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),c?a&&a.pinch&&this.fire("zoom",a):((_||a&&a.pinch)&&this.fire("zoom",a),this.fire("move",a)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return B(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){Rt(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[f(this._container)]=this;var o=t?Ye:Ut;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),wt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){B(this._resizeRequest),this._resizeRequest=ut(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,o){for(var a=[],c,_=o==="mouseout"||o==="mouseover",v=t.target||t.srcElement,C=!1;v;){if(c=this._targets[f(v)],c&&(o==="click"||o==="preclick")&&this._draggableMoved(c)){C=!0;break}if(c&&c.listens(o,!0)&&(_&&!Eo(v,t)||(a.push(c),_))||v===this._container)break;v=v.parentNode}return!a.length&&!C&&!_&&this.listens(o,!0)&&(a=[this]),a},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var o=t.target||t.srcElement;if(!(!this._loaded||o._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(o))){var a=t.type;a==="mousedown"&&tn(o),this._fireDOMEvent(t,a)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,o,a){if(t.type==="click"){var c=r({},t);c.type="preclick",this._fireDOMEvent(c,c.type,a)}var _=this._findEventTargets(t,o);if(a){for(var v=[],C=0;C<a.length;C++)a[C].listens(o,!0)&&v.push(a[C]);_=v.concat(_)}if(_.length){o==="contextmenu"&&An(t);var N=_[0],x={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var ct=N.getLatLng&&(!N._radius||N._radius<=10);x.containerPoint=ct?this.latLngToContainerPoint(N.getLatLng()):this.mouseEventToContainerPoint(t),x.layerPoint=this.containerPointToLayerPoint(x.containerPoint),x.latlng=ct?N.getLatLng():this.layerPointToLatLng(x.layerPoint)}for(C=0;C<_.length;C++)if(_[C].fire(o,x,!0),x.originalEvent._stopped||_[C].options.bubblingMouseEvents===!1&&W(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,o=this._handlers.length;t<o;t++)this._handlers[t].disable()},whenReady:function(t,o){return this._loaded?t.call(o||this,{target:this}):this.on("load",t,o),this},_getMapPanePos:function(){return S(this._mapPane)||new R(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,o){var a=t&&o!==void 0?this._getNewPixelOrigin(t,o):this.getPixelOrigin();return a.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,o){var a=this.getSize()._divideBy(2);return this.project(t,o)._subtract(a)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,o,a){var c=this._getNewPixelOrigin(a,o);return this.project(t,o)._subtract(c)},_latLngBoundsToNewLayerBounds:function(t,o,a){var c=this._getNewPixelOrigin(a,o);return Et([this.project(t.getSouthWest(),o)._subtract(c),this.project(t.getNorthWest(),o)._subtract(c),this.project(t.getSouthEast(),o)._subtract(c),this.project(t.getNorthEast(),o)._subtract(c)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,o,a){if(!a)return t;var c=this.project(t,o),_=this.getSize().divideBy(2),v=new bt(c.subtract(_),c.add(_)),C=this._getBoundsOffset(v,a,o);return Math.abs(C.x)<=1&&Math.abs(C.y)<=1?t:this.unproject(c.add(C),o)},_limitOffset:function(t,o){if(!o)return t;var a=this.getPixelBounds(),c=new bt(a.min.add(t),a.max.add(t));return t.add(this._getBoundsOffset(c,o))},_getBoundsOffset:function(t,o,a){var c=Et(this.project(o.getNorthEast(),a),this.project(o.getSouthWest(),a)),_=c.min.subtract(t.min),v=c.max.subtract(t.max),C=this._rebound(_.x,-v.x),N=this._rebound(_.y,-v.y);return new R(C,N)},_rebound:function(t,o){return t+o>0?Math.round(t-o)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(o))},_limitZoom:function(t){var o=this.getMinZoom(),a=this.getMaxZoom(),c=wt.any3d?this.options.zoomSnap:1;return c&&(t=Math.round(t/c)*c),Math.max(o,Math.min(a,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){ae(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,o){var a=this._getCenterOffset(t)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(a)?!1:(this.panBy(a,o),!0)},_createAnimProxy:function(){var t=this._proxy=jt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(o){var a=Bn,c=this._proxy.style[a];Bt(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),c===this._proxy.style[a]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){fe(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),o=this.getZoom();Bt(this._proxy,this.project(t,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,o,a){if(this._animatingZoom)return!0;if(a=a||{},!this._zoomAnimated||a.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var c=this.getZoomScale(o),_=this._getCenterOffset(t)._divideBy(1-1/c);return a.animate!==!0&&!this.getSize().contains(_)?!1:(ut(function(){this._moveStart(!0,a.noMoveStart||!1)._animateZoom(t,o,!0)},this),!0)},_animateZoom:function(t,o,a,c){this._mapPane&&(a&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=o,xt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:o,noUpdate:c}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(u(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&ae(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function pl(t,o){return new ve(t,o)}var $n=X.extend({options:{position:"topright"},initialize:function(t){M(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var o=this._map;return o&&o.removeControl(this),this.options.position=t,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var o=this._container=this.onAdd(t),a=this.getPosition(),c=t._controlCorners[a];return xt(o,"leaflet-control"),a.indexOf("bottom")!==-1?c.insertBefore(o,c.firstChild):c.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(fe(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Ri=function(t){return new $n(t)};ve.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},o="leaflet-",a=this._controlContainer=jt("div",o+"control-container",this._container);function c(_,v){var C=o+_+" "+o+v;t[_+v]=jt("div",C,a)}c("top","left"),c("top","right"),c("bottom","left"),c("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)fe(this._controlCorners[t]);fe(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var fs=$n.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,o,a,c){return a<c?-1:c<a?1:0}},initialize:function(t,o,a){M(this,a),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var c in t)this._addLayer(t[c],c);for(c in o)this._addLayer(o[c],c,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return $n.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,o){return this._addLayer(t,o),this._map?this._update():this},addOverlay:function(t,o){return this._addLayer(t,o,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var o=this._getLayer(f(t));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){xt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(xt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):ae(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return ae(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",o=this._container=jt("div",t),a=this.options.collapsed;o.setAttribute("aria-haspopup",!0),xi(o),To(o);var c=this._section=jt("section",t+"-list");a&&(this._map.on("click",this.collapse,this),Ut(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var _=this._layersLink=jt("a",t+"-toggle",o);_.href="#",_.title="Layers",_.setAttribute("role","button"),Ut(_,{keydown:function(v){v.keyCode===13&&this._expandSafely()},click:function(v){An(v),this._expandSafely()}},this),a||this.expand(),this._baseLayersList=jt("div",t+"-base",c),this._separator=jt("div",t+"-separator",c),this._overlaysList=jt("div",t+"-overlays",c),o.appendChild(c)},_getLayer:function(t){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&f(this._layers[o].layer)===t)return this._layers[o]},_addLayer:function(t,o,a){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:o,overlay:a}),this.options.sortLayers&&this._layers.sort(u(function(c,_){return this.options.sortFunction(c.layer,_.layer,c.name,_.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;_n(this._baseLayersList),_n(this._overlaysList),this._layerControlInputs=[];var t,o,a,c,_=0;for(a=0;a<this._layers.length;a++)c=this._layers[a],this._addItem(c),o=o||c.overlay,t=t||!c.overlay,_+=c.overlay?0:1;return this.options.hideSingleBase&&(t=t&&_>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=o&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var o=this._getLayer(f(t.target)),a=o.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;a&&this._map.fire(a,o)},_createRadioElement:function(t,o){var a='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(o?' checked="checked"':"")+"/>",c=document.createElement("div");return c.innerHTML=a,c.firstChild},_addItem:function(t){var o=document.createElement("label"),a=this._map.hasLayer(t.layer),c;t.overlay?(c=document.createElement("input"),c.type="checkbox",c.className="leaflet-control-layers-selector",c.defaultChecked=a):c=this._createRadioElement("leaflet-base-layers_"+f(this),a),this._layerControlInputs.push(c),c.layerId=f(t.layer),Ut(c,"click",this._onInputClick,this);var _=document.createElement("span");_.innerHTML=" "+t.name;var v=document.createElement("span");o.appendChild(v),v.appendChild(c),v.appendChild(_);var C=t.overlay?this._overlaysList:this._baseLayersList;return C.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,o,a,c=[],_=[];this._handlingClick=!0;for(var v=t.length-1;v>=0;v--)o=t[v],a=this._getLayer(o.layerId).layer,o.checked?c.push(a):o.checked||_.push(a);for(v=0;v<_.length;v++)this._map.hasLayer(_[v])&&this._map.removeLayer(_[v]);for(v=0;v<c.length;v++)this._map.hasLayer(c[v])||this._map.addLayer(c[v]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,o,a,c=this._map.getZoom(),_=t.length-1;_>=0;_--)o=t[_],a=this._getLayer(o.layerId).layer,o.disabled=a.options.minZoom!==void 0&&c<a.options.minZoom||a.options.maxZoom!==void 0&&c>a.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,Ut(t,"click",An),this.expand();var o=this;setTimeout(function(){Ye(t,"click",An),o._preventClick=!1})}}),gl=function(t,o,a){return new fs(t,o,a)},zo=$n.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var o="leaflet-control-zoom",a=jt("div",o+" leaflet-bar"),c=this.options;return this._zoomInButton=this._createButton(c.zoomInText,c.zoomInTitle,o+"-in",a,this._zoomIn),this._zoomOutButton=this._createButton(c.zoomOutText,c.zoomOutTitle,o+"-out",a,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),a},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,o,a,c,_){var v=jt("a",a,c);return v.innerHTML=t,v.href="#",v.title=o,v.setAttribute("role","button"),v.setAttribute("aria-label",o),xi(v),Ut(v,"click",vi),Ut(v,"click",_,this),Ut(v,"click",this._refocusOnMap,this),v},_updateDisabled:function(){var t=this._map,o="leaflet-disabled";ae(this._zoomInButton,o),ae(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(xt(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(xt(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});ve.mergeOptions({zoomControl:!0}),ve.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new zo,this.addControl(this.zoomControl))});var vl=function(t){return new zo(t)},ds=$n.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var o="leaflet-control-scale",a=jt("div",o),c=this.options;return this._addScales(c,o+"-line",a),t.on(c.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),a},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,o,a){t.metric&&(this._mScale=jt("div",o,a)),t.imperial&&(this._iScale=jt("div",o,a))},_update:function(){var t=this._map,o=t.getSize().y/2,a=t.distance(t.containerPointToLatLng([0,o]),t.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(a)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var o=this._getRoundNum(t),a=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,a,o/t)},_updateImperial:function(t){var o=t*3.2808399,a,c,_;o>5280?(a=o/5280,c=this._getRoundNum(a),this._updateScale(this._iScale,c+" mi",c/a)):(_=this._getRoundNum(o),this._updateScale(this._iScale,_+" ft",_/o))},_updateScale:function(t,o,a){t.style.width=Math.round(this.options.maxWidth*a)+"px",t.innerHTML=o},_getRoundNum:function(t){var o=Math.pow(10,(Math.floor(t)+"").length-1),a=t/o;return a=a>=10?10:a>=5?5:a>=3?3:a>=2?2:1,o*a}}),yl=function(t){return new ds(t)},bl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ao=$n.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(wt.inlineSvg?bl+" ":"")+"Leaflet</a>"},initialize:function(t){M(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=jt("div","leaflet-control-attribution"),xi(this._container);for(var o in t._layers)t._layers[o].getAttribution&&this.addAttribution(t._layers[o].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var o in this._attributions)this._attributions[o]&&t.push(o);var a=[];this.options.prefix&&a.push(this.options.prefix),t.length&&a.push(t.join(", ")),this._container.innerHTML=a.join(' <span aria-hidden="true">|</span> ')}}});ve.mergeOptions({attributionControl:!0}),ve.addInitHook(function(){this.options.attributionControl&&new Ao().addTo(this)});var wl=function(t){return new Ao(t)};$n.Layers=fs,$n.Zoom=zo,$n.Scale=ds,$n.Attribution=Ao,Ri.layers=gl,Ri.zoom=vl,Ri.scale=yl,Ri.attribution=wl;var ni=X.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ni.addTo=function(t,o){return t.addHandler(o,this),this};var kl={Events:ht},_s=wt.touch?"touchstart mousedown":"mousedown",di=H.extend({options:{clickTolerance:3},initialize:function(t,o,a,c){M(this,c),this._element=t,this._dragStartTarget=o||t,this._preventOutline=a},enable:function(){this._enabled||(Ut(this._dragStartTarget,_s,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(di._dragging===this&&this.finishDrag(!0),Ye(this._dragStartTarget,_s,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!ze(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){di._dragging===this&&this.finishDrag();return}if(!(di._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(di._dragging=this,this._preventOutline&&tn(this._element),ie(),at(),!this._moving)){this.fire("down");var o=t.touches?t.touches[0]:t,a=fi(this._element);this._startPoint=new R(o.clientX,o.clientY),this._startPos=S(this._element),this._parentScale=ri(a);var c=t.type==="mousedown";Ut(document,c?"mousemove":"touchmove",this._onMove,this),Ut(document,c?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var o=t.touches&&t.touches.length===1?t.touches[0]:t,a=new R(o.clientX,o.clientY)._subtract(this._startPoint);!a.x&&!a.y||Math.abs(a.x)+Math.abs(a.y)<this.options.clickTolerance||(a.x/=this._parentScale.x,a.y/=this._parentScale.y,An(t),this._moved||(this.fire("dragstart"),this._moved=!0,xt(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),xt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(a),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),Rt(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){ae(document.body,"leaflet-dragging"),this._lastTarget&&(ae(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ye(document,"mousemove touchmove",this._onMove,this),Ye(document,"mouseup touchend touchcancel",this._onUp,this),Gn(),lt();var o=this._moved&&this._moving;this._moving=!1,di._dragging=!1,o&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function ms(t,o,a){var c,_=[1,4,2,8],v,C,N,x,ct,St,Ft,le;for(v=0,St=t.length;v<St;v++)t[v]._code=yi(t[v],o);for(N=0;N<4;N++){for(Ft=_[N],c=[],v=0,St=t.length,C=St-1;v<St;C=v++)x=t[v],ct=t[C],x._code&Ft?ct._code&Ft||(le=eo(ct,x,Ft,o,a),le._code=yi(le,o),c.push(le)):(ct._code&Ft&&(le=eo(ct,x,Ft,o,a),le._code=yi(le,o),c.push(le)),c.push(x));t=c}return t}function ps(t,o){var a,c,_,v,C,N,x,ct,St;if(!t||t.length===0)throw new Error("latlngs not passed");Vn(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var Ft=G([0,0]),le=j(t),Zn=le.getNorthWest().distanceTo(le.getSouthWest())*le.getNorthEast().distanceTo(le.getNorthWest());Zn<1700&&(Ft=No(t));var En=t.length,Xn=[];for(a=0;a<En;a++){var jn=G(t[a]);Xn.push(o.project(G([jn.lat-Ft.lat,jn.lng-Ft.lng])))}for(N=x=ct=0,a=0,c=En-1;a<En;c=a++)_=Xn[a],v=Xn[c],C=_.y*v.x-v.y*_.x,x+=(_.x+v.x)*C,ct+=(_.y+v.y)*C,N+=C*3;N===0?St=Xn[0]:St=[x/N,ct/N];var zi=o.unproject(rt(St));return G([zi.lat+Ft.lat,zi.lng+Ft.lng])}function No(t){for(var o=0,a=0,c=0,_=0;_<t.length;_++){var v=G(t[_]);o+=v.lat,a+=v.lng,c++}return G([o/c,a/c])}var Pl={__proto__:null,clipPolygon:ms,polygonCenter:ps,centroid:No};function gs(t,o){if(!o||!t.length)return t.slice();var a=o*o;return t=Sl(t,a),t=Cl(t,a),t}function vs(t,o,a){return Math.sqrt(ji(t,o,a,!0))}function Ll(t,o,a){return ji(t,o,a)}function Cl(t,o){var a=t.length,c=typeof Uint8Array<"u"?Uint8Array:Array,_=new c(a);_[0]=_[a-1]=1,Oo(t,_,o,0,a-1);var v,C=[];for(v=0;v<a;v++)_[v]&&C.push(t[v]);return C}function Oo(t,o,a,c,_){var v=0,C,N,x;for(N=c+1;N<=_-1;N++)x=ji(t[N],t[c],t[_],!0),x>v&&(C=N,v=x);v>a&&(o[C]=1,Oo(t,o,a,c,C),Oo(t,o,a,C,_))}function Sl(t,o){for(var a=[t[0]],c=1,_=0,v=t.length;c<v;c++)Ml(t[c],t[_])>o&&(a.push(t[c]),_=c);return _<v-1&&a.push(t[v-1]),a}var ys;function bs(t,o,a,c,_){var v=c?ys:yi(t,a),C=yi(o,a),N,x,ct;for(ys=C;;){if(!(v|C))return[t,o];if(v&C)return!1;N=v||C,x=eo(t,o,N,a,_),ct=yi(x,a),N===v?(t=x,v=ct):(o=x,C=ct)}}function eo(t,o,a,c,_){var v=o.x-t.x,C=o.y-t.y,N=c.min,x=c.max,ct,St;return a&8?(ct=t.x+v*(x.y-t.y)/C,St=x.y):a&4?(ct=t.x+v*(N.y-t.y)/C,St=N.y):a&2?(ct=x.x,St=t.y+C*(x.x-t.x)/v):a&1&&(ct=N.x,St=t.y+C*(N.x-t.x)/v),new R(ct,St,_)}function yi(t,o){var a=0;return t.x<o.min.x?a|=1:t.x>o.max.x&&(a|=2),t.y<o.min.y?a|=4:t.y>o.max.y&&(a|=8),a}function Ml(t,o){var a=o.x-t.x,c=o.y-t.y;return a*a+c*c}function ji(t,o,a,c){var _=o.x,v=o.y,C=a.x-_,N=a.y-v,x=C*C+N*N,ct;return x>0&&(ct=((t.x-_)*C+(t.y-v)*N)/x,ct>1?(_=a.x,v=a.y):ct>0&&(_+=C*ct,v+=N*ct)),C=t.x-_,N=t.y-v,c?C*C+N*N:new R(_,v)}function Vn(t){return!I(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function ws(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Vn(t)}function ks(t,o){var a,c,_,v,C,N,x,ct;if(!t||t.length===0)throw new Error("latlngs not passed");Vn(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var St=G([0,0]),Ft=j(t),le=Ft.getNorthWest().distanceTo(Ft.getSouthWest())*Ft.getNorthEast().distanceTo(Ft.getNorthWest());le<1700&&(St=No(t));var Zn=t.length,En=[];for(a=0;a<Zn;a++){var Xn=G(t[a]);En.push(o.project(G([Xn.lat-St.lat,Xn.lng-St.lng])))}for(a=0,c=0;a<Zn-1;a++)c+=En[a].distanceTo(En[a+1])/2;if(c===0)ct=En[0];else for(a=0,v=0;a<Zn-1;a++)if(C=En[a],N=En[a+1],_=C.distanceTo(N),v+=_,v>c){x=(v-c)/_,ct=[N.x-x*(N.x-C.x),N.y-x*(N.y-C.y)];break}var jn=o.unproject(rt(ct));return G([jn.lat+St.lat,jn.lng+St.lng])}var Tl={__proto__:null,simplify:gs,pointToSegmentDistance:vs,closestPointOnSegment:Ll,clipSegment:bs,_getEdgeIntersection:eo,_getBitCode:yi,_sqClosestPointOnSegment:ji,isFlat:Vn,_flat:ws,polylineCenter:ks},Io={project:function(t){return new R(t.lng,t.lat)},unproject:function(t){return new Q(t.y,t.x)},bounds:new bt([-180,-90],[180,90])},Bo={R:6378137,R_MINOR:6356752314245179e-9,bounds:new bt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var o=Math.PI/180,a=this.R,c=t.lat*o,_=this.R_MINOR/a,v=Math.sqrt(1-_*_),C=v*Math.sin(c),N=Math.tan(Math.PI/4-c/2)/Math.pow((1-C)/(1+C),v/2);return c=-a*Math.log(Math.max(N,1e-10)),new R(t.lng*o*a,c)},unproject:function(t){for(var o=180/Math.PI,a=this.R,c=this.R_MINOR/a,_=Math.sqrt(1-c*c),v=Math.exp(-t.y/a),C=Math.PI/2-2*Math.atan(v),N=0,x=.1,ct;N<15&&Math.abs(x)>1e-7;N++)ct=_*Math.sin(C),ct=Math.pow((1-ct)/(1+ct),_/2),x=Math.PI/2-2*Math.atan(v*ct)-C,C+=x;return new Q(C*o,t.x*o/a)}},El={__proto__:null,LonLat:Io,Mercator:Bo,SphericalMercator:dt},zl=r({},It,{code:"EPSG:3395",projection:Bo,transformation:function(){var t=.5/(Math.PI*Bo.R);return zt(t,.5,-t,.5)}()}),Ps=r({},It,{code:"EPSG:4326",projection:Io,transformation:zt(1/180,1,-1/180,.5)}),Al=r({},Z,{projection:Io,transformation:zt(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,o){var a=o.lng-t.lng,c=o.lat-t.lat;return Math.sqrt(a*a+c*c)},infinite:!0});Z.Earth=It,Z.EPSG3395=zl,Z.EPSG3857=Yt,Z.EPSG900913=Kt,Z.EPSG4326=Ps,Z.Simple=Al;var ti=H.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[f(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[f(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var o=t.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var a=this.getEvents();o.on(a,this),this.once("remove",function(){o.off(a,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});ve.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var o=f(t);return this._layers[o]?this:(this._layers[o]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var o=f(t);return this._layers[o]?(this._loaded&&t.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return f(t)in this._layers},eachLayer:function(t,o){for(var a in this._layers)t.call(o,this._layers[a]);return this},_addLayers:function(t){t=t?I(t)?t:[t]:[];for(var o=0,a=t.length;o<a;o++)this.addLayer(t[o])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[f(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var o=f(t);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,o=-1/0,a=this._getZoomSpan();for(var c in this._zoomBoundLayers){var _=this._zoomBoundLayers[c].options;t=_.minZoom===void 0?t:Math.min(t,_.minZoom),o=_.maxZoom===void 0?o:Math.max(o,_.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=t===1/0?void 0:t,a!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ci=ti.extend({initialize:function(t,o){M(this,o),this._layers={};var a,c;if(t)for(a=0,c=t.length;a<c;a++)this.addLayer(t[a])},addLayer:function(t){var o=this.getLayerId(t);return this._layers[o]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var o=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(t){var o=typeof t=="number"?t:this.getLayerId(t);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var o=Array.prototype.slice.call(arguments,1),a,c;for(a in this._layers)c=this._layers[a],c[t]&&c[t].apply(c,o);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,o){for(var a in this._layers)t.call(o,this._layers[a]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return f(t)}}),Nl=function(t,o){return new Ci(t,o)},ai=Ci.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Ci.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Ci.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new vt;for(var o in this._layers){var a=this._layers[o];t.extend(a.getBounds?a.getBounds():a.getLatLng())}return t}}),Ol=function(t,o){return new ai(t,o)},Si=X.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){M(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,o){var a=this._getIconUrl(t);if(!a){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var c=this._createImg(a,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(c,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),c},_setIconStyles:function(t,o){var a=this.options,c=a[o+"Size"];typeof c=="number"&&(c=[c,c]);var _=rt(c),v=rt(o==="shadow"&&a.shadowAnchor||a.iconAnchor||_&&_.divideBy(2,!0));t.className="leaflet-marker-"+o+" "+(a.className||""),v&&(t.style.marginLeft=-v.x+"px",t.style.marginTop=-v.y+"px"),_&&(t.style.width=_.x+"px",t.style.height=_.y+"px")},_createImg:function(t,o){return o=o||document.createElement("img"),o.src=t,o},_getIconUrl:function(t){return wt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function Il(t){return new Si(t)}var Wi=Si.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof Wi.imagePath!="string"&&(Wi.imagePath=this._detectIconPath()),(this.options.imagePath||Wi.imagePath)+Si.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var o=function(a,c,_){var v=c.exec(a);return v&&v[_]};return t=o(t,/^url\((['"])?(.+)\1\)$/,2),t&&o(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=jt("div","leaflet-default-icon-path",document.body),o=pt(t,"background-image")||pt(t,"backgroundImage");if(document.body.removeChild(t),o=this._stripUrl(o),o)return o;var a=document.querySelector('link[href$="leaflet.css"]');return a?a.href.substring(0,a.href.length-11-1):""}}),Ls=ni.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new di(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),xt(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&ae(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var o=this._marker,a=o._map,c=this._marker.options.autoPanSpeed,_=this._marker.options.autoPanPadding,v=S(o._icon),C=a.getPixelBounds(),N=a.getPixelOrigin(),x=Et(C.min._subtract(N).add(_),C.max._subtract(N).subtract(_));if(!x.contains(v)){var ct=rt((Math.max(x.max.x,v.x)-x.max.x)/(C.max.x-x.max.x)-(Math.min(x.min.x,v.x)-x.min.x)/(C.min.x-x.min.x),(Math.max(x.max.y,v.y)-x.max.y)/(C.max.y-x.max.y)-(Math.min(x.min.y,v.y)-x.min.y)/(C.min.y-x.min.y)).multiplyBy(c);a.panBy(ct,{animate:!1}),this._draggable._newPos._add(ct),this._draggable._startPos._add(ct),Rt(o._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=ut(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(B(this._panRequest),this._panRequest=ut(this._adjustPan.bind(this,t)))},_onDrag:function(t){var o=this._marker,a=o._shadow,c=S(o._icon),_=o._map.layerPointToLatLng(c);a&&Rt(a,c),o._latlng=_,t.latlng=_,t.oldLatLng=this._oldLatLng,o.fire("move",t).fire("drag",t)},_onDragEnd:function(t){B(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),no=ti.extend({options:{icon:new Wi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,o){M(this,o),this._latlng=G(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var o=this._latlng;return this._latlng=G(t),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),a=t.icon.createIcon(this._icon),c=!1;a!==this._icon&&(this._icon&&this._removeIcon(),c=!0,t.title&&(a.title=t.title),a.tagName==="IMG"&&(a.alt=t.alt||"")),xt(a,o),t.keyboard&&(a.tabIndex="0",a.setAttribute("role","button")),this._icon=a,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ut(a,"focus",this._panOnFocus,this);var _=t.icon.createShadow(this._shadow),v=!1;_!==this._shadow&&(this._removeShadow(),v=!0),_&&(xt(_,o),_.alt=""),this._shadow=_,t.opacity<1&&this._updateOpacity(),c&&this.getPane().appendChild(this._icon),this._initInteraction(),_&&v&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ye(this._icon,"focus",this._panOnFocus,this),fe(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&fe(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&Rt(this._icon,t),this._shadow&&Rt(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(xt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ls)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ls(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&gn(this._icon,t),this._shadow&&gn(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var o=this.options.icon.options,a=o.iconSize?rt(o.iconSize):rt(0,0),c=o.iconAnchor?rt(o.iconAnchor):rt(0,0);t.panInside(this._latlng,{paddingTopLeft:c,paddingBottomRight:a.subtract(c)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Bl(t,o){return new no(t,o)}var _i=ti.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return M(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),io=_i.extend({options:{fill:!0,radius:10},initialize:function(t,o){M(this,o),this._latlng=G(t),this._radius=this.options.radius},setLatLng:function(t){var o=this._latlng;return this._latlng=G(t),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var o=t&&t.radius||this._radius;return _i.prototype.setStyle.call(this,t),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,o=this._radiusY||t,a=this._clickTolerance(),c=[t+a,o+a];this._pxBounds=new bt(this._point.subtract(c),this._point.add(c))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Zl(t,o){return new io(t,o)}var Zo=io.extend({initialize:function(t,o,a){if(typeof o=="number"&&(o=r({},a,{radius:o})),M(this,o),this._latlng=G(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new vt(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:_i.prototype.setStyle,_project:function(){var t=this._latlng.lng,o=this._latlng.lat,a=this._map,c=a.options.crs;if(c.distance===It.distance){var _=Math.PI/180,v=this._mRadius/It.R/_,C=a.project([o+v,t]),N=a.project([o-v,t]),x=C.add(N).divideBy(2),ct=a.unproject(x).lat,St=Math.acos((Math.cos(v*_)-Math.sin(o*_)*Math.sin(ct*_))/(Math.cos(o*_)*Math.cos(ct*_)))/_;(isNaN(St)||St===0)&&(St=v/Math.cos(Math.PI/180*o)),this._point=x.subtract(a.getPixelOrigin()),this._radius=isNaN(St)?0:x.x-a.project([ct,t-St]).x,this._radiusY=x.y-C.y}else{var Ft=c.unproject(c.project(this._latlng).subtract([this._mRadius,0]));this._point=a.latLngToLayerPoint(this._latlng),this._radius=this._point.x-a.latLngToLayerPoint(Ft).x}this._updateBounds()}});function Dl(t,o,a){return new Zo(t,o,a)}var li=_i.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,o){M(this,o),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var o=1/0,a=null,c=ji,_,v,C=0,N=this._parts.length;C<N;C++)for(var x=this._parts[C],ct=1,St=x.length;ct<St;ct++){_=x[ct-1],v=x[ct];var Ft=c(t,_,v,!0);Ft<o&&(o=Ft,a=c(t,_,v))}return a&&(a.distance=Math.sqrt(o)),a},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ks(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,o){return o=o||this._defaultShape(),t=G(t),o.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new vt,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Vn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var o=[],a=Vn(t),c=0,_=t.length;c<_;c++)a?(o[c]=G(t[c]),this._bounds.extend(o[c])):o[c]=this._convertLatLngs(t[c]);return o},_project:function(){var t=new bt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),o=new R(t,t);this._rawPxBounds&&(this._pxBounds=new bt([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(t,o,a){var c=t[0]instanceof Q,_=t.length,v,C;if(c){for(C=[],v=0;v<_;v++)C[v]=this._map.latLngToLayerPoint(t[v]),a.extend(C[v]);o.push(C)}else for(v=0;v<_;v++)this._projectLatlngs(t[v],o,a)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,a,c,_,v,C,N,x;for(a=0,_=0,v=this._rings.length;a<v;a++)for(x=this._rings[a],c=0,C=x.length;c<C-1;c++)N=bs(x[c],x[c+1],t,c,!0),N&&(o[_]=o[_]||[],o[_].push(N[0]),(N[1]!==x[c+1]||c===C-2)&&(o[_].push(N[1]),_++))}},_simplifyPoints:function(){for(var t=this._parts,o=this.options.smoothFactor,a=0,c=t.length;a<c;a++)t[a]=gs(t[a],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,o){var a,c,_,v,C,N,x=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(a=0,v=this._parts.length;a<v;a++)for(N=this._parts[a],c=0,C=N.length,_=C-1;c<C;_=c++)if(!(!o&&c===0)&&vs(t,N[_],N[c])<=x)return!0;return!1}});function xl(t,o){return new li(t,o)}li._flat=ws;var Mi=li.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ps(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var o=li.prototype._convertLatLngs.call(this,t),a=o.length;return a>=2&&o[0]instanceof Q&&o[0].equals(o[a-1])&&o.pop(),o},_setLatLngs:function(t){li.prototype._setLatLngs.call(this,t),Vn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Vn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,o=this.options.weight,a=new R(o,o);if(t=new bt(t.min.subtract(a),t.max.add(a)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var c=0,_=this._rings.length,v;c<_;c++)v=ms(this._rings[c],t,!0),v.length&&this._parts.push(v)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var o=!1,a,c,_,v,C,N,x,ct;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(v=0,x=this._parts.length;v<x;v++)for(a=this._parts[v],C=0,ct=a.length,N=ct-1;C<ct;N=C++)c=a[C],_=a[N],c.y>t.y!=_.y>t.y&&t.x<(_.x-c.x)*(t.y-c.y)/(_.y-c.y)+c.x&&(o=!o);return o||li.prototype._containsPoint.call(this,t,!0)}});function Rl(t,o){return new Mi(t,o)}var ui=ai.extend({initialize:function(t,o){M(this,o),this._layers={},t&&this.addData(t)},addData:function(t){var o=I(t)?t:t.features,a,c,_;if(o){for(a=0,c=o.length;a<c;a++)_=o[a],(_.geometries||_.geometry||_.features||_.coordinates)&&this.addData(_);return this}var v=this.options;if(v.filter&&!v.filter(t))return this;var C=oo(t,v);return C?(C.feature=ao(t),C.defaultOptions=C.options,this.resetStyle(C),v.onEachFeature&&v.onEachFeature(t,C),this.addLayer(C)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=r({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(o){this._setLayerStyle(o,t)},this)},_setLayerStyle:function(t,o){t.setStyle&&(typeof o=="function"&&(o=o(t.feature)),t.setStyle(o))}});function oo(t,o){var a=t.type==="Feature"?t.geometry:t,c=a?a.coordinates:null,_=[],v=o&&o.pointToLayer,C=o&&o.coordsToLatLng||Do,N,x,ct,St;if(!c&&!a)return null;switch(a.type){case"Point":return N=C(c),Cs(v,t,N,o);case"MultiPoint":for(ct=0,St=c.length;ct<St;ct++)N=C(c[ct]),_.push(Cs(v,t,N,o));return new ai(_);case"LineString":case"MultiLineString":return x=so(c,a.type==="LineString"?0:1,C),new li(x,o);case"Polygon":case"MultiPolygon":return x=so(c,a.type==="Polygon"?1:2,C),new Mi(x,o);case"GeometryCollection":for(ct=0,St=a.geometries.length;ct<St;ct++){var Ft=oo({geometry:a.geometries[ct],type:"Feature",properties:t.properties},o);Ft&&_.push(Ft)}return new ai(_);case"FeatureCollection":for(ct=0,St=a.features.length;ct<St;ct++){var le=oo(a.features[ct],o);le&&_.push(le)}return new ai(_);default:throw new Error("Invalid GeoJSON object.")}}function Cs(t,o,a,c){return t?t(o,a):new no(a,c&&c.markersInheritOptions&&c)}function Do(t){return new Q(t[1],t[0],t[2])}function so(t,o,a){for(var c=[],_=0,v=t.length,C;_<v;_++)C=o?so(t[_],o-1,a):(a||Do)(t[_]),c.push(C);return c}function xo(t,o){return t=G(t),t.alt!==void 0?[b(t.lng,o),b(t.lat,o),b(t.alt,o)]:[b(t.lng,o),b(t.lat,o)]}function ro(t,o,a,c){for(var _=[],v=0,C=t.length;v<C;v++)_.push(o?ro(t[v],Vn(t[v])?0:o-1,a,c):xo(t[v],c));return!o&&a&&_.length>0&&_.push(_[0].slice()),_}function Ti(t,o){return t.feature?r({},t.feature,{geometry:o}):ao(o)}function ao(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var Ro={toGeoJSON:function(t){return Ti(this,{type:"Point",coordinates:xo(this.getLatLng(),t)})}};no.include(Ro),Zo.include(Ro),io.include(Ro),li.include({toGeoJSON:function(t){var o=!Vn(this._latlngs),a=ro(this._latlngs,o?1:0,!1,t);return Ti(this,{type:(o?"Multi":"")+"LineString",coordinates:a})}}),Mi.include({toGeoJSON:function(t){var o=!Vn(this._latlngs),a=o&&!Vn(this._latlngs[0]),c=ro(this._latlngs,a?2:o?1:0,!0,t);return o||(c=[c]),Ti(this,{type:(a?"Multi":"")+"Polygon",coordinates:c})}}),Ci.include({toMultiPoint:function(t){var o=[];return this.eachLayer(function(a){o.push(a.toGeoJSON(t).geometry.coordinates)}),Ti(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(t){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(t);var a=o==="GeometryCollection",c=[];return this.eachLayer(function(_){if(_.toGeoJSON){var v=_.toGeoJSON(t);if(a)c.push(v.geometry);else{var C=ao(v);C.type==="FeatureCollection"?c.push.apply(c,C.features):c.push(C)}}}),a?Ti(this,{geometries:c,type:"GeometryCollection"}):{type:"FeatureCollection",features:c}}});function Ss(t,o){return new ui(t,o)}var jl=Ss,lo=ti.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,o,a){this._url=t,this._bounds=j(o),M(this,a)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(xt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){fe(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&Qe(this._image),this},bringToBack:function(){return this._map&&pe(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=j(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",o=this._image=t?this._url:jt("img");if(xt(o,"leaflet-image-layer"),this._zoomAnimated&&xt(o,"leaflet-zoom-animated"),this.options.className&&xt(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onload=u(this.fire,this,"load"),o.onerror=u(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(t){var o=this._map.getZoomScale(t.zoom),a=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;Bt(this._image,a,o)},_reset:function(){var t=this._image,o=new bt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),a=o.getSize();Rt(t,o.min),t.style.width=a.x+"px",t.style.height=a.y+"px"},_updateOpacity:function(){gn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Wl=function(t,o,a){return new lo(t,o,a)},Ms=lo.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",o=this._image=t?this._url:jt("video");if(xt(o,"leaflet-image-layer"),this._zoomAnimated&&xt(o,"leaflet-zoom-animated"),this.options.className&&xt(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onloadeddata=u(this.fire,this,"load"),t){for(var a=o.getElementsByTagName("source"),c=[],_=0;_<a.length;_++)c.push(a[_].src);this._url=a.length>0?c:[o.src];return}I(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var v=0;v<this._url.length;v++){var C=jt("source");C.src=this._url[v],o.appendChild(C)}}});function Hl(t,o,a){return new Ms(t,o,a)}var Ts=lo.extend({_initImage:function(){var t=this._image=this._url;xt(t,"leaflet-image-layer"),this._zoomAnimated&&xt(t,"leaflet-zoom-animated"),this.options.className&&xt(t,this.options.className),t.onselectstart=g,t.onmousemove=g}});function Fl(t,o,a){return new Ts(t,o,a)}var ii=ti.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,o){t&&(t instanceof Q||I(t))?(this._latlng=G(t),M(this,o)):(M(this,t),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&gn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&gn(this._container,1),this.bringToFront(),this.options.interactive&&(xt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(gn(this._container,0),this._removeTimeout=setTimeout(u(fe,void 0,this._container),200)):fe(this._container),this.options.interactive&&(ae(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=G(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Qe(this._container),this},bringToBack:function(){return this._map&&pe(this._container),this},_prepareOpen:function(t){var o=this._source;if(!o._map)return!1;if(o instanceof ai){o=null;var a=this._source._layers;for(var c in a)if(a[c]._map){o=a[c];break}if(!o)return!1;this._source=o}if(!t)if(o.getCenter)t=o.getCenter();else if(o.getLatLng)t=o.getLatLng();else if(o.getBounds)t=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")t.innerHTML=o;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),o=rt(this.options.offset),a=this._getAnchor();this._zoomAnimated?Rt(this._container,t.add(a)):o=o.add(t).add(a);var c=this._containerBottom=-o.y,_=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=c+"px",this._container.style.left=_+"px"}},_getAnchor:function(){return[0,0]}});ve.include({_initOverlay:function(t,o,a,c){var _=o;return _ instanceof t||(_=new t(c).setContent(o)),a&&_.setLatLng(a),_}}),ti.include({_initOverlay:function(t,o,a,c){var _=a;return _ instanceof t?(M(_,c),_._source=this):(_=o&&!c?o:new t(c,this),_.setContent(a)),_}});var uo=ii.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,ii.prototype.openOn.call(this,t)},onAdd:function(t){ii.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof _i||this._source.on("preclick",gi))},onRemove:function(t){ii.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof _i||this._source.off("preclick",gi))},getEvents:function(){var t=ii.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",o=this._container=jt("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),a=this._wrapper=jt("div",t+"-content-wrapper",o);if(this._contentNode=jt("div",t+"-content",a),xi(o),To(this._contentNode),Ut(o,"contextmenu",gi),this._tipContainer=jt("div",t+"-tip-container",o),this._tip=jt("div",t+"-tip",this._tipContainer),this.options.closeButton){var c=this._closeButton=jt("a",t+"-close-button",o);c.setAttribute("role","button"),c.setAttribute("aria-label","Close popup"),c.href="#close",c.innerHTML='<span aria-hidden="true">&#215;</span>',Ut(c,"click",function(_){An(_),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,o=t.style;o.width="",o.whiteSpace="nowrap";var a=t.offsetWidth;a=Math.min(a,this.options.maxWidth),a=Math.max(a,this.options.minWidth),o.width=a+1+"px",o.whiteSpace="",o.height="";var c=t.offsetHeight,_=this.options.maxHeight,v="leaflet-popup-scrolled";_&&c>_?(o.height=_+"px",xt(t,v)):ae(t,v),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),a=this._getAnchor();Rt(this._container,o.add(a))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,o=parseInt(pt(this._container,"marginBottom"),10)||0,a=this._container.offsetHeight+o,c=this._containerWidth,_=new R(this._containerLeft,-a-this._containerBottom);_._add(S(this._container));var v=t.layerPointToContainerPoint(_),C=rt(this.options.autoPanPadding),N=rt(this.options.autoPanPaddingTopLeft||C),x=rt(this.options.autoPanPaddingBottomRight||C),ct=t.getSize(),St=0,Ft=0;v.x+c+x.x>ct.x&&(St=v.x+c-ct.x+x.x),v.x-St-N.x<0&&(St=v.x-N.x),v.y+a+x.y>ct.y&&(Ft=v.y+a-ct.y+x.y),v.y-Ft-N.y<0&&(Ft=v.y-N.y),(St||Ft)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([St,Ft]))}},_getAnchor:function(){return rt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Gl=function(t,o){return new uo(t,o)};ve.mergeOptions({closePopupOnClick:!0}),ve.include({openPopup:function(t,o,a){return this._initOverlay(uo,t,o,a).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),ti.include({bindPopup:function(t,o){return this._popup=this._initOverlay(uo,this._popup,t,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof ai||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){vi(t);var o=t.layer||t.target;if(this._popup._source===o&&!(o instanceof _i)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=o,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var co=ii.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){ii.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){ii.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=ii.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",o=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=jt("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var o,a,c=this._map,_=this._container,v=c.latLngToContainerPoint(c.getCenter()),C=c.layerPointToContainerPoint(t),N=this.options.direction,x=_.offsetWidth,ct=_.offsetHeight,St=rt(this.options.offset),Ft=this._getAnchor();N==="top"?(o=x/2,a=ct):N==="bottom"?(o=x/2,a=0):N==="center"?(o=x/2,a=ct/2):N==="right"?(o=0,a=ct/2):N==="left"?(o=x,a=ct/2):C.x<v.x?(N="right",o=0,a=ct/2):(N="left",o=x+(St.x+Ft.x)*2,a=ct/2),t=t.subtract(rt(o,a,!0)).add(St).add(Ft),ae(_,"leaflet-tooltip-right"),ae(_,"leaflet-tooltip-left"),ae(_,"leaflet-tooltip-top"),ae(_,"leaflet-tooltip-bottom"),xt(_,"leaflet-tooltip-"+N),Rt(_,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&gn(this._container,t)},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(o)},_getAnchor:function(){return rt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ul=function(t,o){return new co(t,o)};ve.include({openTooltip:function(t,o,a){return this._initOverlay(co,t,o,a).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),ti.include({bindTooltip:function(t,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(co,this._tooltip,t,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var o=t?"off":"on",a={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?a.add=this._openTooltip:(a.mouseover=this._openTooltip,a.mouseout=this.closeTooltip,a.click=this._openTooltip,this._map?this._addFocusListeners():a.add=this._addFocusListeners),this._tooltip.options.sticky&&(a.mousemove=this._moveTooltip),this[o](a),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof ai||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var o=typeof t.getElement=="function"&&t.getElement();o&&(Ut(o,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),Ut(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var o=typeof t.getElement=="function"&&t.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var o=t.latlng,a,c;this._tooltip.options.sticky&&t.originalEvent&&(a=this._map.mouseEventToContainerPoint(t.originalEvent),c=this._map.containerPointToLayerPoint(a),o=this._map.layerPointToLatLng(c)),this._tooltip.setLatLng(o)}});var Es=Si.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var o=t&&t.tagName==="DIV"?t:document.createElement("div"),a=this.options;if(a.html instanceof Element?(_n(o),o.appendChild(a.html)):o.innerHTML=a.html!==!1?a.html:"",a.bgPos){var c=rt(a.bgPos);o.style.backgroundPosition=-c.x+"px "+-c.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function Vl(t){return new Es(t)}Si.Default=Wi;var Hi=ti.extend({options:{tileSize:256,opacity:1,updateWhenIdle:wt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){M(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),fe(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Qe(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(pe(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof R?t:new R(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var o=this.getPane().children,a=-t(-1/0,1/0),c=0,_=o.length,v;c<_;c++)v=o[c].style.zIndex,o[c]!==this._container&&v&&(a=t(a,+v));isFinite(a)&&(this.options.zIndex=a+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!wt.ielt9){gn(this._container,this.options.opacity);var t=+new Date,o=!1,a=!1;for(var c in this._tiles){var _=this._tiles[c];if(!(!_.current||!_.loaded)){var v=Math.min(1,(t-_.loaded)/200);gn(_.el,v),v<1?o=!0:(_.active?a=!0:this._onOpaqueTile(_),_.active=!0)}}a&&!this._noPrune&&this._pruneTiles(),o&&(B(this._fadeFrame),this._fadeFrame=ut(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=jt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,o=this.options.maxZoom;if(t!==void 0){for(var a in this._levels)a=Number(a),this._levels[a].el.children.length||a===t?(this._levels[a].el.style.zIndex=o-Math.abs(t-a),this._onUpdateLevel(a)):(fe(this._levels[a].el),this._removeTilesAtZoom(a),this._onRemoveLevel(a),delete this._levels[a]);var c=this._levels[t],_=this._map;return c||(c=this._levels[t]={},c.el=jt("div","leaflet-tile-container leaflet-zoom-animated",this._container),c.el.style.zIndex=o,c.origin=_.project(_.unproject(_.getPixelOrigin()),t).round(),c.zoom=t,this._setZoomTransform(c,_.getCenter(),_.getZoom()),g(c.el.offsetWidth),this._onCreateLevel(c)),this._level=c,c}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var t,o,a=this._map.getZoom();if(a>this.options.maxZoom||a<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)o=this._tiles[t],o.retain=o.current;for(t in this._tiles)if(o=this._tiles[t],o.current&&!o.active){var c=o.coords;this._retainParent(c.x,c.y,c.z,c.z-5)||this._retainChildren(c.x,c.y,c.z,c.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var o in this._tiles)this._tiles[o].coords.z===t&&this._removeTile(o)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)fe(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,o,a,c){var _=Math.floor(t/2),v=Math.floor(o/2),C=a-1,N=new R(+_,+v);N.z=+C;var x=this._tileCoordsToKey(N),ct=this._tiles[x];return ct&&ct.active?(ct.retain=!0,!0):(ct&&ct.loaded&&(ct.retain=!0),C>c?this._retainParent(_,v,C,c):!1)},_retainChildren:function(t,o,a,c){for(var _=2*t;_<2*t+2;_++)for(var v=2*o;v<2*o+2;v++){var C=new R(_,v);C.z=a+1;var N=this._tileCoordsToKey(C),x=this._tiles[N];if(x&&x.active){x.retain=!0;continue}else x&&x.loaded&&(x.retain=!0);a+1<c&&this._retainChildren(_,v,a+1,c)}},_resetView:function(t){var o=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var o=this.options;return o.minNativeZoom!==void 0&&t<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<t?o.maxNativeZoom:t},_setView:function(t,o,a,c){var _=Math.round(o);this.options.maxZoom!==void 0&&_>this.options.maxZoom||this.options.minZoom!==void 0&&_<this.options.minZoom?_=void 0:_=this._clampZoom(_);var v=this.options.updateWhenZooming&&_!==this._tileZoom;(!c||v)&&(this._tileZoom=_,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),_!==void 0&&this._update(t),a||this._pruneTiles(),this._noPrune=!!a),this._setZoomTransforms(t,o)},_setZoomTransforms:function(t,o){for(var a in this._levels)this._setZoomTransform(this._levels[a],t,o)},_setZoomTransform:function(t,o,a){var c=this._map.getZoomScale(a,t.zoom),_=t.origin.multiplyBy(c).subtract(this._map._getNewPixelOrigin(o,a)).round();wt.any3d?Bt(t.el,_,c):Rt(t.el,_)},_resetGrid:function(){var t=this._map,o=t.options.crs,a=this._tileSize=this.getTileSize(),c=this._tileZoom,_=this._map.getPixelWorldBounds(this._tileZoom);_&&(this._globalTileRange=this._pxBoundsToTileRange(_)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,o.wrapLng[0]],c).x/a.x),Math.ceil(t.project([0,o.wrapLng[1]],c).x/a.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([o.wrapLat[0],0],c).y/a.x),Math.ceil(t.project([o.wrapLat[1],0],c).y/a.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var o=this._map,a=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),c=o.getZoomScale(a,this._tileZoom),_=o.project(t,this._tileZoom).floor(),v=o.getSize().divideBy(c*2);return new bt(_.subtract(v),_.add(v))},_update:function(t){var o=this._map;if(o){var a=this._clampZoom(o.getZoom());if(t===void 0&&(t=o.getCenter()),this._tileZoom!==void 0){var c=this._getTiledPixelBounds(t),_=this._pxBoundsToTileRange(c),v=_.getCenter(),C=[],N=this.options.keepBuffer,x=new bt(_.getBottomLeft().subtract([N,-N]),_.getTopRight().add([N,-N]));if(!(isFinite(_.min.x)&&isFinite(_.min.y)&&isFinite(_.max.x)&&isFinite(_.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ct in this._tiles){var St=this._tiles[ct].coords;(St.z!==this._tileZoom||!x.contains(new R(St.x,St.y)))&&(this._tiles[ct].current=!1)}if(Math.abs(a-this._tileZoom)>1){this._setView(t,a);return}for(var Ft=_.min.y;Ft<=_.max.y;Ft++)for(var le=_.min.x;le<=_.max.x;le++){var Zn=new R(le,Ft);if(Zn.z=this._tileZoom,!!this._isValidTile(Zn)){var En=this._tiles[this._tileCoordsToKey(Zn)];En?En.current=!0:C.push(Zn)}}if(C.sort(function(jn,zi){return jn.distanceTo(v)-zi.distanceTo(v)}),C.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var Xn=document.createDocumentFragment();for(le=0;le<C.length;le++)this._addTile(C[le],Xn);this._level.el.appendChild(Xn)}}}},_isValidTile:function(t){var o=this._map.options.crs;if(!o.infinite){var a=this._globalTileRange;if(!o.wrapLng&&(t.x<a.min.x||t.x>a.max.x)||!o.wrapLat&&(t.y<a.min.y||t.y>a.max.y))return!1}if(!this.options.bounds)return!0;var c=this._tileCoordsToBounds(t);return j(this.options.bounds).overlaps(c)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var o=this._map,a=this.getTileSize(),c=t.scaleBy(a),_=c.add(a),v=o.unproject(c,t.z),C=o.unproject(_,t.z);return[v,C]},_tileCoordsToBounds:function(t){var o=this._tileCoordsToNwSe(t),a=new vt(o[0],o[1]);return this.options.noWrap||(a=this._map.wrapLatLngBounds(a)),a},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var o=t.split(":"),a=new R(+o[0],+o[1]);return a.z=+o[2],a},_removeTile:function(t){var o=this._tiles[t];o&&(fe(o.el),delete this._tiles[t],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){xt(t,"leaflet-tile");var o=this.getTileSize();t.style.width=o.x+"px",t.style.height=o.y+"px",t.onselectstart=g,t.onmousemove=g,wt.ielt9&&this.options.opacity<1&&gn(t,this.options.opacity)},_addTile:function(t,o){var a=this._getTilePos(t),c=this._tileCoordsToKey(t),_=this.createTile(this._wrapCoords(t),u(this._tileReady,this,t));this._initTile(_),this.createTile.length<2&&ut(u(this._tileReady,this,t,null,_)),Rt(_,a),this._tiles[c]={el:_,coords:t,current:!0},o.appendChild(_),this.fire("tileloadstart",{tile:_,coords:t})},_tileReady:function(t,o,a){o&&this.fire("tileerror",{error:o,tile:a,coords:t});var c=this._tileCoordsToKey(t);a=this._tiles[c],a&&(a.loaded=+new Date,this._map._fadeAnimated?(gn(a.el,0),B(this._fadeFrame),this._fadeFrame=ut(this._updateOpacity,this)):(a.active=!0,this._pruneTiles()),o||(xt(a.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:a.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),wt.ielt9||!this._map._fadeAnimated?ut(this._pruneTiles,this):setTimeout(u(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var o=new R(this._wrapX?p(t.x,this._wrapX):t.x,this._wrapY?p(t.y,this._wrapY):t.y);return o.z=t.z,o},_pxBoundsToTileRange:function(t){var o=this.getTileSize();return new bt(t.min.unscaleBy(o).floor(),t.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Xl(t){return new Hi(t)}var Ei=Hi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,o){this._url=t,o=M(this,o),o.detectRetina&&wt.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,o){return this._url===t&&o===void 0&&(o=!0),this._url=t,o||this.redraw(),this},createTile:function(t,o){var a=document.createElement("img");return Ut(a,"load",u(this._tileOnLoad,this,o,a)),Ut(a,"error",u(this._tileOnError,this,o,a)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(a.referrerPolicy=this.options.referrerPolicy),a.alt="",a.src=this.getTileUrl(t),a},getTileUrl:function(t){var o={r:wt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var a=this._globalTileRange.max.y-t.y;this.options.tms&&(o.y=a),o["-y"]=a}return T(this._url,r(o,this.options))},_tileOnLoad:function(t,o){wt.ielt9?setTimeout(u(t,this,null,o),0):t(null,o)},_tileOnError:function(t,o,a){var c=this.options.errorTileUrl;c&&o.getAttribute("src")!==c&&(o.src=c),t(a,o)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,o=this.options.maxZoom,a=this.options.zoomReverse,c=this.options.zoomOffset;return a&&(t=o-t),t+c},_getSubdomain:function(t){var o=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var t,o;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(o=this._tiles[t].el,o.onload=g,o.onerror=g,!o.complete)){o.src=V;var a=this._tiles[t].coords;fe(o),delete this._tiles[t],this.fire("tileabort",{tile:o,coords:a})}},_removeTile:function(t){var o=this._tiles[t];if(o)return o.el.setAttribute("src",V),Hi.prototype._removeTile.call(this,t)},_tileReady:function(t,o,a){if(!(!this._map||a&&a.getAttribute("src")===V))return Hi.prototype._tileReady.call(this,t,o,a)}});function zs(t,o){return new Ei(t,o)}var As=Ei.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,o){this._url=t;var a=r({},this.defaultWmsParams);for(var c in o)c in this.options||(a[c]=o[c]);o=M(this,o);var _=o.detectRetina&&wt.retina?2:1,v=this.getTileSize();a.width=v.x*_,a.height=v.y*_,this.wmsParams=a},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,Ei.prototype.onAdd.call(this,t)},getTileUrl:function(t){var o=this._tileCoordsToNwSe(t),a=this._crs,c=Et(a.project(o[0]),a.project(o[1])),_=c.min,v=c.max,C=(this._wmsVersion>=1.3&&this._crs===Ps?[_.y,_.x,v.y,v.x]:[_.x,_.y,v.x,v.y]).join(","),N=Ei.prototype.getTileUrl.call(this,t);return N+E(this.wmsParams,N,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+C},setParams:function(t,o){return r(this.wmsParams,t),o||this.redraw(),this}});function Yl(t,o){return new As(t,o)}Ei.WMS=As,zs.wms=Yl;var ci=ti.extend({options:{padding:.1},initialize:function(t){M(this,t),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),xt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,o){var a=this._map.getZoomScale(o,this._zoom),c=this._map.getSize().multiplyBy(.5+this.options.padding),_=this._map.project(this._center,o),v=c.multiplyBy(-a).add(_).subtract(this._map._getNewPixelOrigin(t,o));wt.any3d?Bt(this._container,v,a):Rt(this._container,v)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,o=this._map.getSize(),a=this._map.containerPointToLayerPoint(o.multiplyBy(-t)).round();this._bounds=new bt(a,a.add(o.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ns=ci.extend({options:{tolerance:0},getEvents:function(){var t=ci.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ci.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");Ut(t,"mousemove",this._onMouseMove,this),Ut(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ut(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){B(this._redrawRequest),delete this._ctx,fe(this._container),Ye(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var o in this._layers)t=this._layers[o],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ci.prototype._update.call(this);var t=this._bounds,o=this._container,a=t.getSize(),c=wt.retina?2:1;Rt(o,t.min),o.width=c*a.x,o.height=c*a.y,o.style.width=a.x+"px",o.style.height=a.y+"px",wt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){ci.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[f(t)]=t;var o=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var o=t._order,a=o.next,c=o.prev;a?a.prev=c:this._drawLast=c,c?c.next=a:this._drawFirst=a,delete t._order,delete this._layers[f(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var o=t.options.dashArray.split(/[, ]+/),a=[],c,_;for(_=0;_<o.length;_++){if(c=Number(o[_]),isNaN(c))return;a.push(c)}t.options._dashArray=a}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||ut(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var o=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new bt,this._redrawBounds.extend(t._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(t._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var o=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,o=this._redrawBounds;if(this._ctx.save(),o){var a=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,a.x,a.y),this._ctx.clip()}this._drawing=!0;for(var c=this._drawFirst;c;c=c.next)t=c.layer,(!o||t._pxBounds&&t._pxBounds.intersects(o))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,o){if(this._drawing){var a,c,_,v,C=t._parts,N=C.length,x=this._ctx;if(N){for(x.beginPath(),a=0;a<N;a++){for(c=0,_=C[a].length;c<_;c++)v=C[a][c],x[c?"lineTo":"moveTo"](v.x,v.y);o&&x.closePath()}this._fillStroke(x,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var o=t._point,a=this._ctx,c=Math.max(Math.round(t._radius),1),_=(Math.max(Math.round(t._radiusY),1)||c)/c;_!==1&&(a.save(),a.scale(1,_)),a.beginPath(),a.arc(o.x,o.y/_,c,0,Math.PI*2,!1),_!==1&&a.restore(),this._fillStroke(a,t)}},_fillStroke:function(t,o){var a=o.options;a.fill&&(t.globalAlpha=a.fillOpacity,t.fillStyle=a.fillColor||a.color,t.fill(a.fillRule||"evenodd")),a.stroke&&a.weight!==0&&(t.setLineDash&&t.setLineDash(o.options&&o.options._dashArray||[]),t.globalAlpha=a.opacity,t.lineWidth=a.weight,t.strokeStyle=a.color,t.lineCap=a.lineCap,t.lineJoin=a.lineJoin,t.stroke())},_onClick:function(t){for(var o=this._map.mouseEventToLayerPoint(t),a,c,_=this._drawFirst;_;_=_.next)a=_.layer,a.options.interactive&&a._containsPoint(o)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(a))&&(c=a);this._fireEvent(c?[c]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,o)}},_handleMouseOut:function(t){var o=this._hoveredLayer;o&&(ae(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,o){if(!this._mouseHoverThrottled){for(var a,c,_=this._drawFirst;_;_=_.next)a=_.layer,a.options.interactive&&a._containsPoint(o)&&(c=a);c!==this._hoveredLayer&&(this._handleMouseOut(t),c&&(xt(this._container,"leaflet-interactive"),this._fireEvent([c],t,"mouseover"),this._hoveredLayer=c)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(u(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,o,a){this._map._fireDOMEvent(o,a||o.type,t)},_bringToFront:function(t){var o=t._order;if(o){var a=o.next,c=o.prev;if(a)a.prev=c;else return;c?c.next=a:a&&(this._drawFirst=a),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(t)}},_bringToBack:function(t){var o=t._order;if(o){var a=o.next,c=o.prev;if(c)c.next=a;else return;a?a.prev=c:c&&(this._drawLast=c),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(t)}}});function Os(t){return wt.canvas?new Ns(t):null}var Fi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),ql={_initContainer:function(){this._container=jt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ci.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var o=t._container=Fi("shape");xt(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",t._path=Fi("path"),o.appendChild(t._path),this._updateStyle(t),this._layers[f(t)]=t},_addPath:function(t){var o=t._container;this._container.appendChild(o),t.options.interactive&&t.addInteractiveTarget(o)},_removePath:function(t){var o=t._container;fe(o),t.removeInteractiveTarget(o),delete this._layers[f(t)]},_updateStyle:function(t){var o=t._stroke,a=t._fill,c=t.options,_=t._container;_.stroked=!!c.stroke,_.filled=!!c.fill,c.stroke?(o||(o=t._stroke=Fi("stroke")),_.appendChild(o),o.weight=c.weight+"px",o.color=c.color,o.opacity=c.opacity,c.dashArray?o.dashStyle=I(c.dashArray)?c.dashArray.join(" "):c.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=c.lineCap.replace("butt","flat"),o.joinstyle=c.lineJoin):o&&(_.removeChild(o),t._stroke=null),c.fill?(a||(a=t._fill=Fi("fill")),_.appendChild(a),a.color=c.fillColor||c.color,a.opacity=c.fillOpacity):a&&(_.removeChild(a),t._fill=null)},_updateCircle:function(t){var o=t._point.round(),a=Math.round(t._radius),c=Math.round(t._radiusY||a);this._setPath(t,t._empty()?"M0 0":"AL "+o.x+","+o.y+" "+a+","+c+" 0,"+65535*360)},_setPath:function(t,o){t._path.v=o},_bringToFront:function(t){Qe(t._container)},_bringToBack:function(t){pe(t._container)}},ho=wt.vml?Fi:ge,Gi=ci.extend({_initContainer:function(){this._container=ho("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=ho("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){fe(this._container),Ye(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ci.prototype._update.call(this);var t=this._bounds,o=t.getSize(),a=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,a.setAttribute("width",o.x),a.setAttribute("height",o.y)),Rt(a,t.min),a.setAttribute("viewBox",[t.min.x,t.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(t){var o=t._path=ho("path");t.options.className&&xt(o,t.options.className),t.options.interactive&&xt(o,"leaflet-interactive"),this._updateStyle(t),this._layers[f(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){fe(t._path),t.removeInteractiveTarget(t._path),delete this._layers[f(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var o=t._path,a=t.options;o&&(a.stroke?(o.setAttribute("stroke",a.color),o.setAttribute("stroke-opacity",a.opacity),o.setAttribute("stroke-width",a.weight),o.setAttribute("stroke-linecap",a.lineCap),o.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?o.setAttribute("stroke-dasharray",a.dashArray):o.removeAttribute("stroke-dasharray"),a.dashOffset?o.setAttribute("stroke-dashoffset",a.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),a.fill?(o.setAttribute("fill",a.fillColor||a.color),o.setAttribute("fill-opacity",a.fillOpacity),o.setAttribute("fill-rule",a.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(t,o){this._setPath(t,Ne(t._parts,o))},_updateCircle:function(t){var o=t._point,a=Math.max(Math.round(t._radius),1),c=Math.max(Math.round(t._radiusY),1)||a,_="a"+a+","+c+" 0 1,0 ",v=t._empty()?"M0 0":"M"+(o.x-a)+","+o.y+_+a*2+",0 "+_+-a*2+",0 ";this._setPath(t,v)},_setPath:function(t,o){t._path.setAttribute("d",o)},_bringToFront:function(t){Qe(t._path)},_bringToBack:function(t){pe(t._path)}});wt.vml&&Gi.include(ql);function Is(t){return wt.svg||wt.vml?new Gi(t):null}ve.include({getRenderer:function(t){var o=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var o=this._paneRenderers[t];return o===void 0&&(o=this._createRenderer({pane:t}),this._paneRenderers[t]=o),o},_createRenderer:function(t){return this.options.preferCanvas&&Os(t)||Is(t)}});var Bs=Mi.extend({initialize:function(t,o){Mi.prototype.initialize.call(this,this._boundsToLatLngs(t),o)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=j(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function Kl(t,o){return new Bs(t,o)}Gi.create=ho,Gi.pointsToPath=Ne,ui.geometryToLayer=oo,ui.coordsToLatLng=Do,ui.coordsToLatLngs=so,ui.latLngToCoords=xo,ui.latLngsToCoords=ro,ui.getFeature=Ti,ui.asFeature=ao,ve.mergeOptions({boxZoom:!0});var Zs=ni.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){Ut(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ye(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){fe(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),at(),ie(),this._startPoint=this._map.mouseEventToContainerPoint(t),Ut(document,{contextmenu:vi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=jt("div","leaflet-zoom-box",this._container),xt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var o=new bt(this._point,this._startPoint),a=o.getSize();Rt(this._box,o.min),this._box.style.width=a.x+"px",this._box.style.height=a.y+"px"},_finish:function(){this._moved&&(fe(this._box),ae(this._container,"leaflet-crosshair")),lt(),Gn(),Ye(document,{contextmenu:vi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(u(this._resetState,this),0);var o=new vt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ve.addInitHook("addHandler","boxZoom",Zs),ve.mergeOptions({doubleClickZoom:!0});var Ds=ni.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var o=this._map,a=o.getZoom(),c=o.options.zoomDelta,_=t.originalEvent.shiftKey?a-c:a+c;o.options.doubleClickZoom==="center"?o.setZoom(_):o.setZoomAround(t.containerPoint,_)}});ve.addInitHook("addHandler","doubleClickZoom",Ds),ve.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var xs=ni.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new di(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}xt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){ae(this._map._container,"leaflet-grab"),ae(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=j(this._map.options.maxBounds);this._offsetLimit=Et(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var o=this._lastTime=+new Date,a=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(a),this._times.push(o),this._prunePositions(o)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,o){return t-(t-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;t.x<o.min.x&&(t.x=this._viscousLimit(t.x,o.min.x)),t.y<o.min.y&&(t.y=this._viscousLimit(t.y,o.min.y)),t.x>o.max.x&&(t.x=this._viscousLimit(t.x,o.max.x)),t.y>o.max.y&&(t.y=this._viscousLimit(t.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,o=Math.round(t/2),a=this._initialWorldOffset,c=this._draggable._newPos.x,_=(c-o+a)%t+o-a,v=(c+o+a)%t-o-a,C=Math.abs(_+a)<Math.abs(v+a)?_:v;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=C},_onDragEnd:function(t){var o=this._map,a=o.options,c=!a.inertia||t.noInertia||this._times.length<2;if(o.fire("dragend",t),c)o.fire("moveend");else{this._prunePositions(+new Date);var _=this._lastPos.subtract(this._positions[0]),v=(this._lastTime-this._times[0])/1e3,C=a.easeLinearity,N=_.multiplyBy(C/v),x=N.distanceTo([0,0]),ct=Math.min(a.inertiaMaxSpeed,x),St=N.multiplyBy(ct/x),Ft=ct/(a.inertiaDeceleration*C),le=St.multiplyBy(-Ft/2).round();!le.x&&!le.y?o.fire("moveend"):(le=o._limitOffset(le,o.options.maxBounds),ut(function(){o.panBy(le,{duration:Ft,easeLinearity:C,noMoveStart:!0,animate:!0})}))}}});ve.addInitHook("addHandler","dragging",xs),ve.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Rs=ni.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),Ut(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ye(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,o=document.documentElement,a=t.scrollTop||o.scrollTop,c=t.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(c,a)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var o=this._panKeys={},a=this.keyCodes,c,_;for(c=0,_=a.left.length;c<_;c++)o[a.left[c]]=[-1*t,0];for(c=0,_=a.right.length;c<_;c++)o[a.right[c]]=[t,0];for(c=0,_=a.down.length;c<_;c++)o[a.down[c]]=[0,t];for(c=0,_=a.up.length;c<_;c++)o[a.up[c]]=[0,-1*t]},_setZoomDelta:function(t){var o=this._zoomKeys={},a=this.keyCodes,c,_;for(c=0,_=a.zoomIn.length;c<_;c++)o[a.zoomIn[c]]=t;for(c=0,_=a.zoomOut.length;c<_;c++)o[a.zoomOut[c]]=-t},_addHooks:function(){Ut(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ye(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var o=t.keyCode,a=this._map,c;if(o in this._panKeys){if(!a._panAnim||!a._panAnim._inProgress)if(c=this._panKeys[o],t.shiftKey&&(c=rt(c).multiplyBy(3)),a.options.maxBounds&&(c=a._limitOffset(rt(c),a.options.maxBounds)),a.options.worldCopyJump){var _=a.wrapLatLng(a.unproject(a.project(a.getCenter()).add(c)));a.panTo(_)}else a.panBy(c)}else if(o in this._zoomKeys)a.setZoom(a.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&a._popup&&a._popup.options.closeOnEscapeKey)a.closePopup();else return;vi(t)}}});ve.addInitHook("addHandler","keyboard",Rs),ve.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var js=ni.extend({addHooks:function(){Ut(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ye(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var o=cs(t),a=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var c=Math.max(a-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(u(this._performZoom,this),c),vi(t)},_performZoom:function(){var t=this._map,o=t.getZoom(),a=this._map.options.zoomSnap||0;t._stop();var c=this._delta/(this._map.options.wheelPxPerZoomLevel*4),_=4*Math.log(2/(1+Math.exp(-Math.abs(c))))/Math.LN2,v=a?Math.ceil(_/a)*a:_,C=t._limitZoom(o+(this._delta>0?v:-v))-o;this._delta=0,this._startTime=null,C&&(t.options.scrollWheelZoom==="center"?t.setZoom(o+C):t.setZoomAround(this._lastMousePos,o+C))}});ve.addInitHook("addHandler","scrollWheelZoom",js);var Jl=600;ve.mergeOptions({tapHold:wt.touchNative&&wt.safari&&wt.mobile,tapTolerance:15});var Ws=ni.extend({addHooks:function(){Ut(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ye(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var o=t.touches[0];this._startPos=this._newPos=new R(o.clientX,o.clientY),this._holdTimeout=setTimeout(u(function(){this._cancel(),this._isTapValid()&&(Ut(document,"touchend",An),Ut(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),Jl),Ut(document,"touchend touchcancel contextmenu",this._cancel,this),Ut(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){Ye(document,"touchend",An),Ye(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),Ye(document,"touchend touchcancel contextmenu",this._cancel,this),Ye(document,"touchmove",this._onMove,this)},_onMove:function(t){var o=t.touches[0];this._newPos=new R(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,o){var a=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});a._simulated=!0,o.target.dispatchEvent(a)}});ve.addInitHook("addHandler","tapHold",Ws),ve.mergeOptions({touchZoom:wt.touch,bounceAtZoomLimits:!0});var Hs=ni.extend({addHooks:function(){xt(this._map._container,"leaflet-touch-zoom"),Ut(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){ae(this._map._container,"leaflet-touch-zoom"),Ye(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var o=this._map;if(!(!t.touches||t.touches.length!==2||o._animatingZoom||this._zooming)){var a=o.mouseEventToContainerPoint(t.touches[0]),c=o.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(a.add(c)._divideBy(2))),this._startDist=a.distanceTo(c),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),Ut(document,"touchmove",this._onTouchMove,this),Ut(document,"touchend touchcancel",this._onTouchEnd,this),An(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var o=this._map,a=o.mouseEventToContainerPoint(t.touches[0]),c=o.mouseEventToContainerPoint(t.touches[1]),_=a.distanceTo(c)/this._startDist;if(this._zoom=o.getScaleZoom(_,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&_<1||this._zoom>o.getMaxZoom()&&_>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,_===1)return}else{var v=a._add(c)._divideBy(2)._subtract(this._centerPoint);if(_===1&&v.x===0&&v.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(v),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),B(this._animRequest);var C=u(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ut(C,this,!0),An(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,B(this._animRequest),Ye(document,"touchmove",this._onTouchMove,this),Ye(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});ve.addInitHook("addHandler","touchZoom",Hs),ve.BoxZoom=Zs,ve.DoubleClickZoom=Ds,ve.Drag=xs,ve.Keyboard=Rs,ve.ScrollWheelZoom=js,ve.TapHold=Ws,ve.TouchZoom=Hs,i.Bounds=bt,i.Browser=wt,i.CRS=Z,i.Canvas=Ns,i.Circle=Zo,i.CircleMarker=io,i.Class=X,i.Control=$n,i.DivIcon=Es,i.DivOverlay=ii,i.DomEvent=ml,i.DomUtil=Di,i.Draggable=di,i.Evented=H,i.FeatureGroup=ai,i.GeoJSON=ui,i.GridLayer=Hi,i.Handler=ni,i.Icon=Si,i.ImageOverlay=lo,i.LatLng=Q,i.LatLngBounds=vt,i.Layer=ti,i.LayerGroup=Ci,i.LineUtil=Tl,i.Map=ve,i.Marker=no,i.Mixin=kl,i.Path=_i,i.Point=R,i.PolyUtil=Pl,i.Polygon=Mi,i.Polyline=li,i.Popup=uo,i.PosAnimation=hs,i.Projection=El,i.Rectangle=Bs,i.Renderer=ci,i.SVG=Gi,i.SVGOverlay=Ts,i.TileLayer=Ei,i.Tooltip=co,i.Transformation=Mt,i.Util=it,i.VideoOverlay=Ms,i.bind=u,i.bounds=Et,i.canvas=Os,i.circle=Dl,i.circleMarker=Zl,i.control=Ri,i.divIcon=Vl,i.extend=r,i.featureGroup=Ol,i.geoJSON=Ss,i.geoJson=jl,i.gridLayer=Xl,i.icon=Il,i.imageOverlay=Wl,i.latLng=G,i.latLngBounds=j,i.layerGroup=Nl,i.map=pl,i.marker=Bl,i.point=rt,i.polygon=Rl,i.polyline=xl,i.popup=Gl,i.rectangle=Kl,i.setOptions=M,i.stamp=f,i.svg=Is,i.svgOverlay=Fl,i.tileLayer=zs,i.tooltip=Ul,i.transformation=zt,i.version=s,i.videoOverlay=Hl;var Ql=window.L;i.noConflict=function(){return window.L=Ql,this},window.L=i})})(is,is.exports);var Yn=is.exports;const{Map:to}=cu;function va(n,e,i){const s=n.slice();return s[129]=e[i],s[131]=i,s}function ya(n,e,i){const s=n.slice();return s[132]=e[i],s[133]=e,s[134]=i,s}function ba(n,e,i){const s=n.slice();return s[135]=e[i],s}function wa(n,e,i){const s=n.slice();return s[138]=e[i],s}function Jo(n){const e=n.slice(),i=e[51](e[138].source);e[141]=i;const s=e[51](e[138].target);return e[142]=s,e}function ka(n,e,i){const s=n.slice();return s[143]=e[i],s[144]=e,s[145]=i,s}function Pa(n,e,i){const s=n.slice();return s[142]=e[i],s}function La(n,e,i){const s=n.slice();return s[150]=e[i],s}function Ca(n,e,i){const s=n.slice();return s[138]=e[i],s}function Vf(n){let e=[],i=new to,s,r=Ae(n[2]);const l=u=>u[138].id;for(let u=0;u<r.length;u+=1){let h=Ca(n,r,u),f=l(h);i.set(f,e[u]=Sa(f,h))}return{c(){for(let u=0;u<e.length;u+=1)e[u].c();s=De()},m(u,h){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(u,h);tt(u,s,h)},p(u,h){h[0]&4|h[1]&4&&(r=Ae(u[2]),e=hi(e,h,l,1,u,r,i,s.parentNode,ko,Sa,s,Ca))},d(u){u&&q(s);for(let h=0;h<e.length;h+=1)e[h].d(u)}}}function Xf(n){let e;return{c(){e=z("div"),e.textContent="(none)",m(e,"class","muted small txt svelte-1sj21o9")},m(i,s){tt(i,e,s)},p:Ht,d(i){i&&q(e)}}}function Sa(n,e){let i,s=e[138].source+"",r,l,u=e[138].target+"",h,f,d,p,g,b;function w(){return e[67](e[138])}return{key:n,first:null,c(){i=z("span"),r=Ge(s),l=Ge(""),h=Ge(u),f=$(),d=z("button"),d.textContent="",p=$(),m(d,"class","pill-x svelte-1sj21o9"),m(d,"aria-label","Remove edge"),m(i,"class","edge-pill svelte-1sj21o9"),m(i,"title","Click  to remove"),this.first=i},m(P,M){tt(P,i,M),k(i,r),k(i,l),k(i,h),k(i,f),k(i,d),k(i,p),g||(b=_t(d,"click",w),g=!0)},p(P,M){e=P,M[0]&4&&s!==(s=e[138].source+"")&&Cn(r,s),M[0]&4&&u!==(u=e[138].target+"")&&Cn(h,u)},d(P){P&&q(i),g=!1,b()}}}function Ma(n){let e,i,s,r,l,u,h,f,d,p;return{c(){e=z("div"),i=z("span"),s=Ge("connecting from "),r=z("code"),l=Ge(n[5]),u=Ge("  click a nodes  to finish"),h=$(),f=z("button"),f.textContent="cancel",m(i,"class","txt svelte-1sj21o9"),m(f,"class","pill-x svelte-1sj21o9"),m(e,"class","pending small svelte-1sj21o9")},m(g,b){tt(g,e,b),k(e,i),k(i,s),k(i,r),k(r,l),k(i,u),k(e,h),k(e,f),d||(p=_t(f,"click",n[40]),d=!0)},p(g,b){b[0]&32&&Cn(l,g[5])},d(g){g&&q(e),d=!1,p()}}}function Yf(n){let e,i=[],s=new to,r=Ae(n[31]);const l=u=>u[150].id;for(let u=0;u<r.length;u+=1){let h=La(n,r,u),f=l(h);s.set(f,i[u]=Ta(f,h))}return{c(){e=z("div");for(let u=0;u<i.length;u+=1)i[u].c();m(e,"class","tool-list svelte-1sj21o9")},m(u,h){tt(u,e,h);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null)},p(u,h){h[1]&236978177&&(r=Ae(u[31]),i=hi(i,h,l,1,u,r,s,e,ko,Ta,null,La))},d(u){u&&q(e);for(let h=0;h<i.length;h+=1)i[h].d()}}}function qf(n){let e;return{c(){e=z("div"),e.textContent="(no scheduled jobs)",m(e,"class","muted small txt svelte-1sj21o9")},m(i,s){tt(i,e,s)},p:Ht,d(i){i&&q(e)}}}function Ta(n,e){let i,s,r,l,u=Va(e[150].next_run_time)+"",h,f,d,p,g,b,w,P,M,E,A,T,I,W,V,U;function K(){return e[68](e[150])}function nt(){return e[69](e[150])}function et(){return e[70](e[150])}function J(){return e[71](e[150])}function ut(){return e[72](e[150])}return{key:n,first:null,c(){i=z("div"),s=z("div"),r=z("div"),l=z("time"),h=Ge(u),d=$(),p=z("div"),g=z("button"),g.textContent="Run now",b=$(),w=z("button"),w.textContent="Pause",P=$(),M=z("button"),M.textContent="Resume",E=$(),A=z("button"),A.textContent="Logs",T=$(),I=z("button"),I.textContent="Delete",W=$(),m(l,"datetime",f=e[150].next_run_time),m(r,"class","schedule-date svelte-1sj21o9"),m(s,"class","schedule-head svelte-1sj21o9"),m(g,"class","pill-x svelte-1sj21o9"),m(g,"title","Run now"),m(w,"class","pill-x svelte-1sj21o9"),m(w,"title","Pause"),m(M,"class","pill-x svelte-1sj21o9"),m(M,"title","Resume"),m(A,"class","pill-x svelte-1sj21o9"),m(A,"title","Logs"),m(I,"class","pill-x svelte-1sj21o9"),m(I,"title","Delete"),m(p,"class","schedule-actions svelte-1sj21o9"),m(i,"class","tool schedule-card svelte-1sj21o9"),this.first=i},m(B,it){tt(B,i,it),k(i,s),k(s,r),k(r,l),k(l,h),k(i,d),k(i,p),k(p,g),k(p,b),k(p,w),k(p,P),k(p,M),k(p,E),k(p,A),k(p,T),k(p,I),k(i,W),V||(U=[_t(g,"click",K),_t(w,"click",nt),_t(M,"click",et),_t(A,"click",J),_t(I,"click",ut)],V=!0)},p(B,it){e=B,it[1]&1&&u!==(u=Va(e[150].next_run_time)+"")&&Cn(h,u),it[1]&1&&f!==(f=e[150].next_run_time)&&m(l,"datetime",f)},d(B){B&&q(i),V=!1,ln(U)}}}function Ea(n){let e,i=n[142].name+"",s,r;return{c(){e=z("option"),s=Ge(i),e.__value=r=n[142].name,He(e,e.__value)},m(l,u){tt(l,e,u),k(e,s)},p(l,u){u[0]&64&&i!==(i=l[142].name+"")&&Cn(s,i),u[0]&64&&r!==(r=l[142].name)&&(e.__value=r,He(e,e.__value))},d(l){l&&q(e)}}}function Kf(n){let e,i,s=n[143].label+"",r,l,u,h,f,d,p,g,b,w,P,M,E,A,T,I,W,V,U,K,nt;function et(){return n[73](n[143])}function J(){return n[74](n[143])}function ut(){return n[75](n[143])}let B=Ae(n[6]),it=[];for(let Tt=0;Tt<B.length;Tt+=1)it[Tt]=Ea(Pa(n,B,Tt));function X(){n[76].call(P,n[145])}function mt(){return n[77](n[145],n[143])}function ht(){return n[78](n[143])}function H(){return n[79](n[143],n[145])}function R(){return n[80](n[143])}return{c(){e=z("div"),i=z("div"),r=Ge(s),l=$(),u=z("button"),h=$(),f=z("button"),p=$(),g=z("button"),g.textContent="",b=$(),w=z("div"),P=z("select");for(let Tt=0;Tt<it.length;Tt+=1)it[Tt].c();M=$(),E=z("button"),E.textContent="",A=$(),T=z("button"),T.textContent="",I=$(),W=z("button"),W.textContent="",U=$(),m(i,"class","node-title svelte-1sj21o9"),m(u,"class","dot in svelte-1sj21o9"),m(u,"title","input"),m(f,"class","dot out svelte-1sj21o9"),m(f,"title","output"),m(f,"aria-pressed",d=n[5]===n[143].id),m(g,"class","node-del svelte-1sj21o9"),m(g,"title","delete node"),m(P,"class","svelte-1sj21o9"),n[1][n[145]].type===void 0&&Pi(X),m(E,"class","edit-btn svelte-1sj21o9"),m(T,"class","preview-btn svelte-1sj21o9"),m(T,"title","Preview on map"),m(W,"class","runone-btn svelte-1sj21o9"),m(W,"title","Run this node only"),m(w,"class","node-config svelte-1sj21o9"),m(e,"class","node svelte-1sj21o9"),m(e,"aria-selected",V=n[146]?"true":"false")},m(Tt,rt){tt(Tt,e,rt),k(e,i),k(i,r),k(e,l),k(e,u),k(e,h),k(e,f),k(e,p),k(e,g),k(e,b),k(e,w),k(w,P);for(let bt=0;bt<it.length;bt+=1)it[bt]&&it[bt].m(P,null);Bi(P,n[1][n[145]].type,!0),k(w,M),k(w,E),k(w,A),k(w,T),k(w,I),k(w,W),tt(Tt,U,rt),K||(nt=[_t(u,"click",et),_t(f,"click",J),_t(g,"click",ut),_t(P,"change",X),_t(P,"change",mt),_t(E,"click",ht),_t(T,"click",H),_t(W,"click",R),pi(n[147].call(null,e))],K=!0)},p(Tt,rt){if(n=Tt,rt[0]&2&&s!==(s=n[143].label+"")&&Cn(r,s),rt[0]&98&&d!==(d=n[5]===n[143].id)&&m(f,"aria-pressed",d),rt[0]&64){B=Ae(n[6]);let bt;for(bt=0;bt<B.length;bt+=1){const Et=Pa(n,B,bt);it[bt]?it[bt].p(Et,rt):(it[bt]=Ea(Et),it[bt].c(),it[bt].m(P,null))}for(;bt<it.length;bt+=1)it[bt].d(1);it.length=B.length}rt[0]&66&&Bi(P,n[1][n[145]].type),rt[4]&4194304&&V!==(V=n[146]?"true":"false")&&m(e,"aria-selected",V)},d(Tt){Tt&&(q(e),q(U)),ki(it,Tt),K=!1,ln(nt)}}}function za(n,e){let i,s,r,l;function u(f){e[81](f,e[145])}let h={id:e[143].id,width:fl,height:dl,$$slots:{default:[Kf,({selected:f,grabHandle:d})=>({146:f,147:d}),({selected:f,grabHandle:d})=>[0,0,0,0,(f?4194304:0)|(d?8388608:0)]]},$$scope:{ctx:e}};return e[1][e[145]].position!==void 0&&(h.position=e[1][e[145]].position),s=new rs({props:h}),Kn.push(()=>yu(s,"position",u)),{key:n,first:null,c(){i=De(),ue(s.$$.fragment),this.first=i},m(f,d){tt(f,i,d),oe(s,f,d),l=!0},p(f,d){e=f;const p={};d[0]&2&&(p.id=e[143].id),d[0]&122|d[4]&4194304|d[5]&1&&(p.$$scope={dirty:d,ctx:e}),!r&&d[0]&2&&(r=!0,p.position=e[1][e[145]].position,pu(()=>r=!1)),s.$set(p)},i(f){l||(D(s.$$.fragment,f),l=!0)},o(f){F(s.$$.fragment,f),l=!1},d(f){f&&q(i),se(s,f)}}}function Aa(n){let e,i;return{c(){e=ne("path"),m(e,"d",i=`M ${n[42](n[141])} ${n[43](n[141])}
                          C ${n[42](n[141])+60} ${n[43](n[141])},
                            ${n[41](n[142])-60} ${n[43](n[142])},
                            ${n[41](n[142])} ${n[43](n[142])}`),m(e,"class","cable svelte-1sj21o9"),m(e,"marker-end","url(#arrow)")},m(s,r){tt(s,e,r)},p(s,r){r[0]&4&&i!==(i=`M ${s[42](s[141])} ${s[43](s[141])}
                          C ${s[42](s[141])+60} ${s[43](s[141])},
                            ${s[41](s[142])-60} ${s[43](s[142])},
                            ${s[41](s[142])} ${s[43](s[142])}`)&&m(e,"d",i)},d(s){s&&q(e)}}}function Na(n,e){let i,s=e[32](e[138].source)&&e[32](e[138].target),r,l=s&&Aa(Jo(e));return{key:n,first:null,c(){i=De(),l&&l.c(),r=De(),this.first=i},m(u,h){tt(u,i,h),l&&l.m(u,h),tt(u,r,h)},p(u,h){e=u,h[0]&4&&(s=e[32](e[138].source)&&e[32](e[138].target)),s?l?l.p(Jo(e),h):(l=Aa(Jo(e)),l.c(),l.m(r.parentNode,r)):l&&(l.d(1),l=null)},d(u){u&&(q(i),q(r)),l&&l.d(u)}}}function Oa(n){let e,i,s,r=[],l=new to,u,h=Ae(n[2]);const f=d=>d[138].id;for(let d=0;d<h.length;d+=1){let p=wa(n,h,d),g=f(p);l.set(g,r[d]=Na(g,p))}return{c(){e=ne("defs"),i=ne("marker"),s=ne("path");for(let d=0;d<r.length;d+=1)r[d].c();u=De(),m(s,"d","M 0 0 L 10 5 L 0 10 z"),m(i,"id","arrow"),m(i,"viewBox","0 0 10 10"),m(i,"refX","9"),m(i,"refY","5"),m(i,"markerWidth","6"),m(i,"markerHeight","6"),m(i,"orient","auto-start-reverse")},m(d,p){tt(d,e,p),k(e,i),k(i,s);for(let g=0;g<r.length;g+=1)r[g]&&r[g].m(d,p);tt(d,u,p)},p(d,p){p[0]&4|p[1]&1055746&&(h=Ae(d[2]),r=hi(r,p,f,1,d,h,l,u.parentNode,ko,Na,u,wa))},d(d){d&&(q(e),q(u));for(let p=0;p<r.length;p+=1)r[p].d(d)}}}function Jf(n){let e=[],i=new to,s,r,l=n[10],u,h,f=Ae(n[1]);const d=g=>g[143].id;for(let g=0;g<f.length;g+=1){let b=ka(n,f,g),w=d(b);i.set(w,e[g]=za(w,b))}let p=Oa(n);return{c(){for(let g=0;g<e.length;g+=1)e[g].c();s=$(),r=ne("svg"),p.c(),m(r,"class","edges-overlay svelte-1sj21o9"),m(r,"viewBox",u=`0 0 ${n[12]} ${n[13]}`),m(r,"preserveAspectRatio","none")},m(g,b){for(let w=0;w<e.length;w+=1)e[w]&&e[w].m(g,b);tt(g,s,b),tt(g,r,b),p.m(r,null),h=!0},p(g,b){b[0]&122|b[1]&328088|b[4]&4194304&&(f=Ae(g[1]),ye(),e=hi(e,b,d,1,g,f,i,s.parentNode,Ji,za,s,ka),be()),b[0]&1024&&dn(l,l=g[10])?(p.d(1),p=Oa(g),p.c(),p.m(r,null)):p.p(g,b),(!h||b[0]&12288&&u!==(u=`0 0 ${g[12]} ${g[13]}`))&&m(r,"viewBox",u)},i(g){if(!h){for(let b=0;b<f.length;b+=1)D(e[b]);h=!0}},o(g){for(let b=0;b<e.length;b+=1)F(e[b]);h=!1},d(g){g&&(q(s),q(r));for(let b=0;b<e.length;b+=1)e[b].d(g);p.d(g)}}}function Ia(n){let e,i,s,r,l,u,h=n[17].label+"",f,d,p,g,b,w,P,M,E,A,T,I,W,V;function U(et,J){return et[21]?Qf:$f}let K=U(n),nt=K(n);return{c(){e=z("div"),i=$(),s=z("div"),r=z("div"),l=z("h3"),u=Ge("Edit Args  "),f=Ge(h),d=$(),p=z("div"),g=z("button"),g.textContent="Form",b=$(),w=z("button"),w.textContent="Advanced JSON",P=$(),nt.c(),M=$(),E=z("div"),A=z("button"),A.textContent="Cancel",T=$(),I=z("button"),I.textContent="Save",m(e,"class","modal-backdrop svelte-1sj21o9"),m(l,"class","svelte-1sj21o9"),m(g,"class","svelte-1sj21o9"),Vt(g,"seg-active",!n[21]),m(w,"class","svelte-1sj21o9"),Vt(w,"seg-active",n[21]),m(p,"class","seg svelte-1sj21o9"),m(r,"class","modal-head svelte-1sj21o9"),m(A,"class","btn svelte-1sj21o9"),m(I,"class","btn primary svelte-1sj21o9"),m(E,"class","modal-actions svelte-1sj21o9"),m(s,"class","modal svelte-1sj21o9")},m(et,J){tt(et,e,J),tt(et,i,J),tt(et,s,J),k(s,r),k(r,l),k(l,u),k(l,f),k(r,d),k(r,p),k(p,g),k(p,b),k(p,w),k(s,P),nt.m(s,null),k(s,M),k(s,E),k(E,A),k(E,T),k(E,I),W||(V=[_t(e,"click",n[85]),_t(g,"click",n[86]),_t(w,"click",n[87]),_t(A,"click",n[95]),_t(I,"click",n[50]),_t(s,"click",qn(n[63]))],W=!0)},p(et,J){J[0]&131072&&h!==(h=et[17].label+"")&&Cn(f,h),J[0]&2097152&&Vt(g,"seg-active",!et[21]),J[0]&2097152&&Vt(w,"seg-active",et[21]),K===(K=U(et))&&nt?nt.p(et,J):(nt.d(1),nt=K(et),nt&&(nt.c(),nt.m(s,M)))},d(et){et&&(q(e),q(i),q(s)),nt.d(),W=!1,ln(V)}}}function Qf(n){let e,i,s;return{c(){e=z("textarea"),m(e,"class","json-area svelte-1sj21o9")},m(r,l){tt(r,e,l),He(e,n[18]),i||(s=_t(e,"input",n[94]),i=!0)},p(r,l){l[0]&262144&&He(e,r[18])},d(r){r&&q(e),i=!1,s()}}}function $f(n){let e,i=Ae(n[19]),s=[];for(let r=0;r<i.length;r+=1)s[r]=Za(ya(n,i,r));return{c(){e=z("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","form-grid svelte-1sj21o9")},m(r,l){tt(r,e,l);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null)},p(r,l){if(l[0]&1572864){i=Ae(r[19]);let u;for(u=0;u<i.length;u+=1){const h=ya(r,i,u);s[u]?s[u].p(h,l):(s[u]=Za(h),s[u].c(),s[u].m(e,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=i.length}},d(r){r&&q(e),ki(s,r)}}}function td(n){let e,i,s,r=Ae(Ua(n[132])),l=[];for(let h=0;h<r.length;h+=1)l[h]=Ba(ba(n,r,h));function u(){n[93].call(e,n[132])}return{c(){e=z("select");for(let h=0;h<l.length;h+=1)l[h].c();m(e,"class","svelte-1sj21o9"),n[20][n[132].key]===void 0&&Pi(u)},m(h,f){tt(h,e,f);for(let d=0;d<l.length;d+=1)l[d]&&l[d].m(e,null);Bi(e,n[20][n[132].key],!0),i||(s=_t(e,"change",u),i=!0)},p(h,f){if(n=h,f[0]&524288){r=Ae(Ua(n[132]));let d;for(d=0;d<r.length;d+=1){const p=ba(n,r,d);l[d]?l[d].p(p,f):(l[d]=Ba(p),l[d].c(),l[d].m(e,null))}for(;d<l.length;d+=1)l[d].d(1);l.length=r.length}f[0]&1572864&&Bi(e,n[20][n[132].key])},d(h){h&&q(e),ki(l,h),i=!1,s()}}}function ed(n){let e,i,s,r,l,u=Ga(n[132])+"",h,f,d;function p(){n[92].call(e,n[132])}return{c(){e=z("input"),s=$(),r=z("small"),l=Ge("Comma-separated "),h=Ge(u),m(e,"type","text"),m(e,"placeholder",i=Fa(n[132])),m(e,"class","svelte-1sj21o9"),m(r,"class","muted svelte-1sj21o9")},m(g,b){tt(g,e,b),He(e,n[20][n[132].key]),tt(g,s,b),tt(g,r,b),k(r,l),k(r,h),f||(d=_t(e,"input",p),f=!0)},p(g,b){n=g,b[0]&524288&&i!==(i=Fa(n[132]))&&m(e,"placeholder",i),b[0]&1572864&&e.value!==n[20][n[132].key]&&He(e,n[20][n[132].key]),b[0]&524288&&u!==(u=Ga(n[132])+"")&&Cn(h,u)},d(g){g&&(q(e),q(s),q(r)),f=!1,d()}}}function nd(n){let e,i,s,r,l;function u(){n[91].call(e,n[132])}return{c(){e=z("textarea"),m(e,"rows",i=Wa(n[132])),m(e,"placeholder",s=Ha(n[132])),m(e,"class","svelte-1sj21o9")},m(h,f){tt(h,e,f),He(e,n[20][n[132].key]),r||(l=_t(e,"input",u),r=!0)},p(h,f){n=h,f[0]&524288&&i!==(i=Wa(n[132]))&&m(e,"rows",i),f[0]&524288&&s!==(s=Ha(n[132]))&&m(e,"placeholder",s),f[0]&1572864&&He(e,n[20][n[132].key])},d(h){h&&q(e),r=!1,l()}}}function id(n){let e,i,s,r,l,u;function h(){n[90].call(i,n[132])}return{c(){e=z("label"),i=z("input"),s=$(),r=z("span"),m(i,"type","checkbox"),m(i,"class","svelte-1sj21o9"),m(e,"class","switch svelte-1sj21o9")},m(f,d){tt(f,e,d),k(e,i),i.checked=n[20][n[132].key],k(e,s),k(e,r),l||(u=_t(i,"change",h),l=!0)},p(f,d){n=f,d[0]&1572864&&(i.checked=n[20][n[132].key])},d(f){f&&q(e),l=!1,u()}}}function od(n){let e,i,s,r;function l(){n[89].call(e,n[132])}return{c(){e=z("input"),m(e,"type","number"),m(e,"step",i=n[132].step??1),m(e,"class","svelte-1sj21o9")},m(u,h){tt(u,e,h),He(e,n[20][n[132].key]),s||(r=_t(e,"input",l),s=!0)},p(u,h){n=u,h[0]&524288&&i!==(i=n[132].step??1)&&m(e,"step",i),h[0]&1572864&&mi(e.value)!==n[20][n[132].key]&&He(e,n[20][n[132].key])},d(u){u&&q(e),s=!1,r()}}}function sd(n){let e,i,s,r;function l(){n[88].call(e,n[132])}return{c(){e=z("input"),m(e,"type","text"),m(e,"placeholder",i=n[132].placeholder??""),m(e,"class","svelte-1sj21o9")},m(u,h){tt(u,e,h),He(e,n[20][n[132].key]),s||(r=_t(e,"input",l),s=!0)},p(u,h){n=u,h[0]&524288&&i!==(i=n[132].placeholder??"")&&m(e,"placeholder",i),h[0]&1572864&&e.value!==n[20][n[132].key]&&He(e,n[20][n[132].key])},d(u){u&&q(e),s=!1,r()}}}function Ba(n){let e,i=n[135]+"",s,r;return{c(){e=z("option"),s=Ge(i),e.__value=r=n[135],He(e,e.__value)},m(l,u){tt(l,e,u),k(e,s)},p(l,u){u[0]&524288&&i!==(i=l[135]+"")&&Cn(s,i),u[0]&524288&&r!==(r=l[135])&&(e.__value=r,He(e,e.__value))},d(l){l&&q(e)}}}function Za(n){let e,i,s=n[132].label+"",r,l,u;function h(p,g){if(p[132].type==="string")return sd;if(p[132].type==="number")return od;if(p[132].type==="boolean")return id;if(p[132].type==="textarea")return nd;if(p[132].type==="array")return ed;if(p[132].type==="select")return td}let f=h(n),d=f&&f(n);return{c(){e=z("div"),i=z("label"),r=Ge(s),l=$(),d&&d.c(),u=$(),m(i,"class","svelte-1sj21o9"),m(e,"class","form-row svelte-1sj21o9")},m(p,g){tt(p,e,g),k(e,i),k(i,r),k(e,l),d&&d.m(e,null),k(e,u)},p(p,g){g[0]&524288&&s!==(s=p[132].label+"")&&Cn(r,s),f===(f=h(p))&&d?d.p(p,g):(d&&d.d(1),d=f&&f(p),d&&(d.c(),d.m(e,u)))},d(p){p&&q(e),d&&d.d()}}}function Da(n){let e,i,s,r,l,u,h,f,d,p,g,b,w,P,M,E,A,T,I,W,V=n[29]?"Scheduling":"Create schedule",U,K,nt;function et(it,X){return it[23]==="once"?ld:it[23]==="interval"?ad:rd}let J=et(n),ut=J(n),B=n[30]&&xa(n);return{c(){e=z("div"),i=$(),s=z("div"),r=z("div"),r.innerHTML='<h3 class="svelte-1sj21o9">Schedule Pipeline (active connected graph)</h3>',l=$(),u=z("div"),h=z("div"),f=z("label"),f.textContent="Mode",d=$(),p=z("select"),g=z("option"),g.textContent="Once",b=z("option"),b.textContent="Interval",w=z("option"),w.textContent="Cron",P=$(),ut.c(),M=$(),B&&B.c(),E=$(),A=z("div"),T=z("button"),T.textContent="Cancel",I=$(),W=z("button"),U=Ge(V),m(e,"class","modal-backdrop svelte-1sj21o9"),m(r,"class","modal-head svelte-1sj21o9"),m(f,"class","svelte-1sj21o9"),g.__value="once",He(g,g.__value),b.__value="interval",He(b,b.__value),w.__value="cron",He(w,w.__value),m(p,"class","svelte-1sj21o9"),n[23]===void 0&&Pi(()=>n[97].call(p)),m(h,"class","form-row svelte-1sj21o9"),m(u,"class","form-grid svelte-1sj21o9"),m(T,"class","btn svelte-1sj21o9"),m(W,"class","btn primary svelte-1sj21o9"),W.disabled=n[29],m(A,"class","modal-actions svelte-1sj21o9"),m(s,"class","modal svelte-1sj21o9")},m(it,X){tt(it,e,X),tt(it,i,X),tt(it,s,X),k(s,r),k(s,l),k(s,u),k(u,h),k(h,f),k(h,d),k(h,p),k(p,g),k(p,b),k(p,w),Bi(p,n[23],!0),k(u,P),ut.m(u,null),k(u,M),B&&B.m(u,null),k(s,E),k(s,A),k(A,T),k(A,I),k(A,W),k(W,U),K||(nt=[_t(e,"click",n[96]),_t(p,"change",n[97]),_t(T,"click",n[103]),_t(W,"click",n[54]),_t(s,"click",qn(n[62]))],K=!0)},p(it,X){X[0]&8388608&&Bi(p,it[23]),J===(J=et(it))&&ut?ut.p(it,X):(ut.d(1),ut=J(it),ut&&(ut.c(),ut.m(u,M))),it[30]?B?B.p(it,X):(B=xa(it),B.c(),B.m(u,null)):B&&(B.d(1),B=null),X[0]&536870912&&V!==(V=it[29]?"Scheduling":"Create schedule")&&Cn(U,V),X[0]&536870912&&(W.disabled=it[29])},d(it){it&&(q(e),q(i),q(s)),ut.d(),B&&B.d(),K=!1,ln(nt)}}}function rd(n){let e,i,s,r,l,u,h,f;return{c(){e=z("div"),i=z("label"),i.textContent="Cron (UTC)",s=$(),r=z("input"),l=$(),u=z("small"),u.innerHTML="Example: <code>0 5 * * *</code> = 05:00 UTC daily",m(i,"class","svelte-1sj21o9"),m(r,"type","text"),m(r,"placeholder","0 5 * * *"),m(r,"class","svelte-1sj21o9"),m(u,"class","muted svelte-1sj21o9"),m(e,"class","form-row svelte-1sj21o9")},m(d,p){tt(d,e,p),k(e,i),k(e,s),k(e,r),He(r,n[28]),k(e,l),k(e,u),h||(f=_t(r,"input",n[102]),h=!0)},p(d,p){p[0]&268435456&&r.value!==d[28]&&He(r,d[28])},d(d){d&&q(e),h=!1,f()}}}function ad(n){let e,i,s,r,l,u,h,f,d,p,g,b,w;return{c(){e=z("div"),i=z("label"),i.textContent="Interval",s=$(),r=z("div"),l=z("input"),u=$(),h=z("input"),f=$(),d=z("input"),p=$(),g=z("small"),g.textContent="At least one of hours/minutes/seconds must be > 0.",m(i,"class","svelte-1sj21o9"),m(l,"type","number"),m(l,"min","0"),m(l,"placeholder","hours"),m(l,"class","svelte-1sj21o9"),m(h,"type","number"),m(h,"min","0"),m(h,"placeholder","minutes"),m(h,"class","svelte-1sj21o9"),m(d,"type","number"),m(d,"min","0"),m(d,"placeholder","seconds"),m(d,"class","svelte-1sj21o9"),st(r,"display","grid"),st(r,"grid-template-columns","repeat(3, 1fr)"),st(r,"gap","8px"),m(g,"class","muted svelte-1sj21o9"),m(e,"class","form-row svelte-1sj21o9")},m(P,M){tt(P,e,M),k(e,i),k(e,s),k(e,r),k(r,l),He(l,n[25]),k(r,u),k(r,h),He(h,n[26]),k(r,f),k(r,d),He(d,n[27]),k(e,p),k(e,g),b||(w=[_t(l,"input",n[99]),_t(h,"input",n[100]),_t(d,"input",n[101])],b=!0)},p(P,M){M[0]&33554432&&mi(l.value)!==P[25]&&He(l,P[25]),M[0]&67108864&&mi(h.value)!==P[26]&&He(h,P[26]),M[0]&134217728&&mi(d.value)!==P[27]&&He(d,P[27])},d(P){P&&q(e),b=!1,ln(w)}}}function ld(n){let e,i,s,r,l,u,h,f;return{c(){e=z("div"),i=z("label"),i.textContent="Date & time (your local)",s=$(),r=z("input"),l=$(),u=z("small"),u.textContent="Stored & executed in UTC on the server.",m(i,"class","svelte-1sj21o9"),m(r,"type","datetime-local"),m(u,"class","muted svelte-1sj21o9"),m(e,"class","form-row svelte-1sj21o9")},m(d,p){tt(d,e,p),k(e,i),k(e,s),k(e,r),He(r,n[24]),k(e,l),k(e,u),h||(f=_t(r,"input",n[98]),h=!0)},p(d,p){p[0]&16777216&&He(r,d[24])},d(d){d&&q(e),h=!1,f()}}}function xa(n){let e,i,s;return{c(){e=z("div"),i=z("div"),s=Ge(n[30]),m(i,"class","muted svelte-1sj21o9"),st(i,"color","#ffb4b4"),m(e,"class","form-row svelte-1sj21o9")},m(r,l){tt(r,e,l),k(e,i),k(i,s)},p(r,l){l[0]&1073741824&&Cn(s,r[30])},d(r){r&&q(e)}}}function ud(n){let e,i=[],s=new to,r=Ae(n[7]);const l=u=>u[131];for(let u=0;u<r.length;u+=1){let h=va(n,r,u),f=l(h);s.set(f,i[u]=Ra(f,h))}return{c(){e=z("ul");for(let u=0;u<i.length;u+=1)i[u].c();m(e,"class","svelte-1sj21o9")},m(u,h){tt(u,e,h);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null)},p(u,h){h[0]&128&&(r=Ae(u[7]),i=hi(i,h,l,1,u,r,s,e,ko,Ra,null,va))},d(u){u&&q(e);for(let h=0;h<i.length;h+=1)i[h].d()}}}function cd(n){let e;return{c(){e=z("div"),e.textContent="No logs yet. Run the pipeline to see Python prints/stdout.",m(e,"class","muted small svelte-1sj21o9")},m(i,s){tt(i,e,s)},p:Ht,d(i){i&&q(e)}}}function Ra(n,e){let i,s,r=e[129].nodeId+"",l,u,h=e[129].text+"",f,d,p;return{key:n,first:null,c(){i=z("li"),s=z("code"),l=Ge(r),u=Ge("  "),f=Ge(h),d=$(),m(s,"class","svelte-1sj21o9"),m(i,"class",p=Xs(e[129].ok?"ok":"err")+" svelte-1sj21o9"),this.first=i},m(g,b){tt(g,i,b),k(i,s),k(s,l),k(i,u),k(i,f),k(i,d)},p(g,b){e=g,b[0]&128&&r!==(r=e[129].nodeId+"")&&Cn(l,r),b[0]&128&&h!==(h=e[129].text+"")&&Cn(f,h),b[0]&128&&p!==(p=Xs(e[129].ok?"ok":"err")+" svelte-1sj21o9")&&m(i,"class",p)},d(g){g&&q(i)}}}function hd(n){let e,i,s,r,l,u,h,f,d,p,g,b,w,P,M,E,A,T,I,W,V,U,K,nt,et,J,ut,B,it,X,mt,ht,H,R,Tt,rt,bt=n[0]==="dark"?"Dark":"Light",Et,vt,j,Q,G,Z,It,Xt,dt,Mt,zt,Yt,Kt,ge,Ne,ot,_e,Jt=n[8]?"Running":"Run",Ct,Qt,qt,Gt,Oe,xe,$t,Ke,Se,he,me,Me,Te,Re,Ue,rn,we,je,Dt,un,Ie,pn,an,cn,Je,Ee,kn,re,ce,Xe,Sn,Pn,Nn,zn,Be,wt,nn,On,on,In,y,ft,kt,Pt,At,O,Wt,ee,te,We,Fe,Ve,Mn,Tn,Jn,xn,Bn,Ln,Rn,hn,pt,jt;function fe(Bt,Rt){return Bt[2].length===0?Xf:Vf}let _n=fe(n),Qe=_n(n),pe=n[5]&&Ma(n);function ze(Bt,Rt){return Bt[31].length===0?qf:Yf}let xt=ze(n),ae=xt(n);nn=new Gf({props:{width:n[12],height:n[13],theme:n[0],$$slots:{default:[Jf]},$$scope:{ctx:n}}});let fn=n[17]&&Ia(n),sn=n[22]&&Da(n);function gn(Bt,Rt){return Bt[7].length===0?cd:ud}let Qn=gn(n),vn=Qn(n);return{c(){e=z("div"),i=z("header"),s=z("div"),r=z("button"),r.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',l=$(),u=z("div"),u.innerHTML='<span class="title svelte-1sj21o9">SATERYS</span>',h=$(),f=z("div"),f.innerHTML='<div class="hint svelte-1sj21o9">Build pipelines  click a nodes  /  to connect</div>',d=$(),p=z("div"),g=z("button"),b=ne("svg"),w=ne("path"),P=$(),M=z("span"),M.textContent="Run",A=$(),T=z("button"),T.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z" stroke="currentColor" stroke-width="2" fill="none"></path><path d="M7 3v6h10" stroke="currentColor" stroke-width="2" fill="none"></path><path d="M17 21v-8H7v8" stroke="currentColor" stroke-width="2" fill="none"></path></svg> <span>Save</span>',I=$(),W=z("button"),W.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M3 15v4a2 2 0 002 2h14a2 2 0 002-2v-4M17 9l-5 5-5-5M12 4v10" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Load</span>',V=$(),U=z("button"),U.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M8 7V4m8 3V4M5 11h14M7 21h10a2 2 0 002-2V8a2 2 0 00-2-2H7a2 2 0 00-2 2v11a2 2 0 002 2zm5-6v-3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span>Schedule</span>',K=$(),nt=z("button"),nt.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2zm2 4l3 3-3 3m5 0h5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Logs</span>',et=$(),J=z("button"),ut=ne("svg"),B=ne("path"),it=$(),X=z("span"),X.textContent="Layers",mt=$(),ht=z("button"),H=ne("svg"),R=ne("path"),Tt=$(),rt=z("span"),Et=Ge(bt),vt=$(),j=z("button"),j.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span>Add</span>',Q=$(),G=z("div"),Z=z("aside"),It=z("div"),Xt=z("div"),Xt.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M5 12h14M12 5v14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span class="txt svelte-1sj21o9">Tools</span>',dt=$(),Mt=z("div"),zt=z("button"),zt.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span class="txt svelte-1sj21o9">Add Node</span>',Yt=$(),Kt=z("button"),ge=ne("svg"),Ne=ne("path"),ot=$(),_e=z("span"),Ct=Ge(Jt),Qt=$(),qt=z("button"),Gt=ne("svg"),Oe=ne("path"),xe=$(),$t=z("span"),$t.textContent="Clear Layers",Ke=$(),Se=z("button"),he=ne("svg"),me=ne("path"),Me=$(),Te=z("span"),Re=Ge("Theme: "),Ue=Ge(n[0]),rn=$(),we=z("div"),je=z("div"),je.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 12l7-7 4 4 7-7" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span class="txt svelte-1sj21o9">Edges</span>',Dt=$(),un=z("div"),Qe.c(),Ie=$(),pe&&pe.c(),pn=$(),an=z("div"),cn=z("div"),Je=ne("svg"),Ee=ne("path"),kn=$(),re=z("span"),re.textContent="Schedules",ce=$(),Xe=z("button"),Xe.textContent="",Sn=$(),ae.c(),Nn=$(),zn=z("div"),Be=z("div"),wt=z("div"),ue(nn.$$.fragment),On=$(),on=z("div"),In=$(),y=z("div"),ft=z("div"),Pt=$(),fn&&fn.c(),At=$(),sn&&sn.c(),O=$(),Wt=z("div"),ee=z("div"),te=z("div"),te.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2zm2 4l3 3-3 3m5 0h5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Pipeline Logs</span>',We=$(),Fe=z("div"),Ve=z("button"),Ve.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M9 9h11v11H9zM5 5h11v11" stroke="currentColor" stroke-width="2" fill="none"></path></svg>',Mn=$(),Tn=z("button"),Tn.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 6h18M9 6v12m6-12v12M5 6l1-3h12l1 3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',Jn=$(),xn=z("button"),xn.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M6 6l12 12M6 18L18 6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',Bn=$(),Ln=z("div"),vn.c(),m(r,"class","icon-btn ghost svelte-1sj21o9"),m(r,"title","Toggle sidebar"),m(u,"class","brand svelte-1sj21o9"),m(s,"class","left svelte-1sj21o9"),m(f,"class","center svelte-1sj21o9"),m(w,"d","M8 5v14l11-7z"),m(w,"fill","currentColor"),m(b,"viewBox","0 0 24 24"),m(b,"width","18"),m(b,"height","18"),m(g,"class","icon-btn svelte-1sj21o9"),m(g,"title",E=n[8]?"Running":"Run pipeline"),g.disabled=n[8],m(T,"class","icon-btn svelte-1sj21o9"),m(T,"title","Save workflow"),m(W,"class","icon-btn svelte-1sj21o9"),m(W,"title","Load workflow"),m(U,"class","icon-btn svelte-1sj21o9"),m(U,"title","Schedule pipeline"),m(nt,"class","icon-btn svelte-1sj21o9"),m(nt,"title","Toggle logs"),m(B,"d","M12 3l9 5-9 5-9-5 9-5zm0 8l9 5-9 5-9-5"),m(B,"stroke","currentColor"),m(B,"stroke-width","2"),m(B,"fill","none"),m(B,"stroke-linejoin","round"),m(ut,"viewBox","0 0 24 24"),m(ut,"width","18"),m(ut,"height","18"),m(J,"class","icon-btn svelte-1sj21o9"),m(J,"title","Clear map layers"),J.disabled=n[45].size===0,m(R,"d","M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"),m(R,"stroke","currentColor"),m(R,"stroke-width","2"),m(R,"fill","none"),m(H,"viewBox","0 0 24 24"),m(H,"width","18"),m(H,"height","18"),m(ht,"class","icon-btn svelte-1sj21o9"),m(ht,"title","Toggle theme"),m(j,"class","icon-btn primary svelte-1sj21o9"),m(j,"title","Add node"),m(p,"class","right svelte-1sj21o9"),m(i,"class","topbar glass svelte-1sj21o9"),m(Xt,"class","section-title svelte-1sj21o9"),m(zt,"class","tool svelte-1sj21o9"),m(zt,"title","Add node"),m(Ne,"d","M8 5v14l11-7z"),m(Ne,"fill","currentColor"),m(ge,"viewBox","0 0 24 24"),m(ge,"width","16"),m(ge,"height","16"),m(_e,"class","txt svelte-1sj21o9"),m(Kt,"class","tool svelte-1sj21o9"),Kt.disabled=n[8],m(Kt,"title","Run pipeline"),m(Oe,"d","M12 3l9 5-9 5-9-5 9-5zm0 8l9 5-9 5-9-5"),m(Oe,"stroke","currentColor"),m(Oe,"stroke-width","2"),m(Oe,"fill","none"),m(Oe,"stroke-linejoin","round"),m(Gt,"viewBox","0 0 24 24"),m(Gt,"width","16"),m(Gt,"height","16"),m($t,"class","txt svelte-1sj21o9"),m(qt,"class","tool svelte-1sj21o9"),qt.disabled=n[45].size===0,m(qt,"title","Clear overlay layers"),m(me,"d","M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"),m(me,"stroke","currentColor"),m(me,"stroke-width","2"),m(me,"fill","none"),m(he,"viewBox","0 0 24 24"),m(he,"width","16"),m(he,"height","16"),m(Te,"class","txt svelte-1sj21o9"),m(Se,"class","tool svelte-1sj21o9"),m(Se,"title","Toggle theme"),m(Mt,"class","tool-list svelte-1sj21o9"),m(It,"class","section"),m(je,"class","section-title svelte-1sj21o9"),m(un,"class","edge-chips svelte-1sj21o9"),m(we,"class","section"),m(Ee,"d","M6 6h12v12H6zM9 3h6M3 9h6M15 21h6M3 15h6"),m(Ee,"stroke","currentColor"),m(Ee,"stroke-width","2"),m(Ee,"fill","none"),m(Ee,"stroke-linecap","round"),m(Je,"viewBox","0 0 24 24"),m(Je,"width","16"),m(Je,"height","16"),m(re,"class","txt svelte-1sj21o9"),m(Xe,"class","pill-x svelte-1sj21o9"),m(Xe,"title","Refresh"),m(cn,"class","section-title svelte-1sj21o9"),m(an,"class","section"),m(Z,"class","sidebar svelte-1sj21o9"),m(Z,"data-collapsed",Pn=n[9]?"true":"false"),m(wt,"class","split-left svelte-1sj21o9"),st(wt,"width",n[14]+"%"),m(on,"class","split-handle svelte-1sj21o9"),m(on,"role","separator"),m(on,"aria-orientation","vertical"),m(on,"aria-label","Resize split"),m(ft,"class","map svelte-1sj21o9"),m(y,"class","split-right svelte-1sj21o9"),m(Be,"class","split-container svelte-1sj21o9"),m(zn,"class","work svelte-1sj21o9"),m(G,"class","main svelte-1sj21o9"),m(G,"data-collapsed",kt=n[9]?"true":"false"),m(te,"class","logs-title svelte-1sj21o9"),m(Ve,"class","icon-btn svelte-1sj21o9"),m(Ve,"title","Copy all"),m(Tn,"class","icon-btn svelte-1sj21o9"),m(Tn,"title","Clear"),m(xn,"class","icon-btn svelte-1sj21o9"),m(xn,"title","Close"),m(Fe,"class","logs-actions svelte-1sj21o9"),m(ee,"class","logs-header svelte-1sj21o9"),m(Ln,"class","logs-body svelte-1sj21o9"),m(Wt,"class","logs-drawer svelte-1sj21o9"),m(Wt,"data-open",Rn=n[4]?"true":"false"),m(e,"class","app-root svelte-1sj21o9")},m(Bt,Rt){tt(Bt,e,Rt),k(e,i),k(i,s),k(s,r),k(s,l),k(s,u),k(i,h),k(i,f),k(i,d),k(i,p),k(p,g),k(g,b),k(b,w),k(g,P),k(g,M),k(p,A),k(p,T),k(p,I),k(p,W),k(p,V),k(p,U),k(p,K),k(p,nt),k(p,et),k(p,J),k(J,ut),k(ut,B),k(J,it),k(J,X),k(p,mt),k(p,ht),k(ht,H),k(H,R),k(ht,Tt),k(ht,rt),k(rt,Et),k(p,vt),k(p,j),k(e,Q),k(e,G),k(G,Z),k(Z,It),k(It,Xt),k(It,dt),k(It,Mt),k(Mt,zt),k(Mt,Yt),k(Mt,Kt),k(Kt,ge),k(ge,Ne),k(Kt,ot),k(Kt,_e),k(_e,Ct),k(Mt,Qt),k(Mt,qt),k(qt,Gt),k(Gt,Oe),k(qt,xe),k(qt,$t),k(Mt,Ke),k(Mt,Se),k(Se,he),k(he,me),k(Se,Me),k(Se,Te),k(Te,Re),k(Te,Ue),k(Z,rn),k(Z,we),k(we,je),k(we,Dt),k(we,un),Qe.m(un,null),k(we,Ie),pe&&pe.m(we,null),k(Z,pn),k(Z,an),k(an,cn),k(cn,Je),k(Je,Ee),k(cn,kn),k(cn,re),k(cn,ce),k(cn,Xe),k(an,Sn),ae.m(an,null),k(G,Nn),k(G,zn),k(zn,Be),k(Be,wt),oe(nn,wt,null),n[82](wt),k(Be,On),k(Be,on),k(Be,In),k(Be,y),k(y,ft),n[83](ft),n[84](y),k(e,Pt),fn&&fn.m(e,null),k(e,At),sn&&sn.m(e,null),k(e,O),k(e,Wt),k(Wt,ee),k(ee,te),k(ee,We),k(ee,Fe),k(Fe,Ve),k(Fe,Mn),k(Fe,Tn),k(Fe,Jn),k(Fe,xn),k(Wt,Bn),k(Wt,Ln),vn.m(Ln,null),hn=!0,pt||(jt=[_t(r,"click",n[46]),_t(g,"click",n[36]),_t(T,"click",n[59]),_t(W,"click",n[60]),_t(U,"click",n[53]),_t(nt,"click",n[64]),_t(J,"click",n[48]),_t(ht,"click",n[65]),_t(j,"click",n[37]),_t(zt,"click",n[37]),_t(Kt,"click",n[36]),_t(qt,"click",n[48]),_t(Se,"click",n[66]),_t(Xe,"click",n[55]),_t(on,"mousedown",n[44]),_t(Ve,"click",n[104]),_t(Tn,"click",n[105]),_t(xn,"click",n[106])],pt=!0)},p(Bt,Rt){(!hn||Rt[0]&256&&E!==(E=Bt[8]?"Running":"Run pipeline"))&&m(g,"title",E),(!hn||Rt[0]&256)&&(g.disabled=Bt[8]),(!hn||Rt[0]&1)&&bt!==(bt=Bt[0]==="dark"?"Dark":"Light")&&Cn(Et,bt),(!hn||Rt[0]&256)&&Jt!==(Jt=Bt[8]?"Running":"Run")&&Cn(Ct,Jt),(!hn||Rt[0]&256)&&(Kt.disabled=Bt[8]),(!hn||Rt[0]&1)&&Cn(Ue,Bt[0]),_n===(_n=fe(Bt))&&Qe?Qe.p(Bt,Rt):(Qe.d(1),Qe=_n(Bt),Qe&&(Qe.c(),Qe.m(un,null))),Bt[5]?pe?pe.p(Bt,Rt):(pe=Ma(Bt),pe.c(),pe.m(we,null)):pe&&(pe.d(1),pe=null),xt===(xt=ze(Bt))&&ae?ae.p(Bt,Rt):(ae.d(1),ae=xt(Bt),ae&&(ae.c(),ae.m(an,null))),(!hn||Rt[0]&512&&Pn!==(Pn=Bt[9]?"true":"false"))&&m(Z,"data-collapsed",Pn);const S={};Rt[0]&4096&&(S.width=Bt[12]),Rt[0]&8192&&(S.height=Bt[13]),Rt[0]&1&&(S.theme=Bt[0]),Rt[0]&13438|Rt[5]&1&&(S.$$scope={dirty:Rt,ctx:Bt}),nn.$set(S),(!hn||Rt[0]&16384)&&st(wt,"width",Bt[14]+"%"),(!hn||Rt[0]&512&&kt!==(kt=Bt[9]?"true":"false"))&&m(G,"data-collapsed",kt),Bt[17]?fn?fn.p(Bt,Rt):(fn=Ia(Bt),fn.c(),fn.m(e,At)):fn&&(fn.d(1),fn=null),Bt[22]?sn?sn.p(Bt,Rt):(sn=Da(Bt),sn.c(),sn.m(e,O)):sn&&(sn.d(1),sn=null),Qn===(Qn=gn(Bt))&&vn?vn.p(Bt,Rt):(vn.d(1),vn=Qn(Bt),vn&&(vn.c(),vn.m(Ln,null))),(!hn||Rt[0]&16&&Rn!==(Rn=Bt[4]?"true":"false"))&&m(Wt,"data-open",Rn)},i(Bt){hn||(D(nn.$$.fragment,Bt),hn=!0)},o(Bt){F(nn.$$.fragment,Bt),hn=!1},d(Bt){Bt&&q(e),Qe.d(),pe&&pe.d(),ae.d(),se(nn),n[82](null),n[83](null),n[84](null),fn&&fn.d(),sn&&sn.d(),vn.d(),pt=!1,ln(jt)}}}const fl=230,dl=80;function fd(n){const e=[];if(!n||typeof n!="object")return e;for(const[i,s]of Object.entries(n))typeof s=="string"?e.push({key:i,label:i,type:"string"}):typeof s=="number"?e.push({key:i,label:i,type:"number"}):typeof s=="boolean"?e.push({key:i,label:i,type:"boolean"}):Array.isArray(s)?e.push({key:i,label:i,type:"array",itemType:typeof s[0]=="number"?"number":"string"}):e.push({key:i,label:i,type:"textarea"});return e}function dd(n,e){const i=n.map(f=>f.id),s=new Set(i),r=new Map,l=new Map;for(const f of i)r.set(f,[]),l.set(f,0);for(const f of e)!s.has(f.source)||!s.has(f.target)||(r.get(f.source).push(f.target),l.set(f.target,(l.get(f.target)||0)+1));const u=[];for(const f of i)(l.get(f)||0)===0&&u.push(f);const h=[];for(;u.length;){const f=u.shift();h.push(f);for(const d of r.get(f))l.set(d,(l.get(d)||0)-1),(l.get(d)||0)===0&&u.push(d)}return h}async function ja(n,e={}){return await(await fetch("/run_node",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nodeId:n.id,type:n.type,args:n.args??{},inputs:e})})).json().catch(()=>({ok:!1,error:"Bad JSON"}))}function Wa(n){return n.rows??6}function Ha(n){return n.placeholder??""}function Fa(n){return n.hint??"comma-separated"}function Ga(n){return n.itemType??"values"}function Ua(n){return n.options??[]}function Va(n){return n?new Date(n).toLocaleString():""}async function _d(n){await fetch(`/pipeline/schedules/${n}/run-now`,{method:"POST"}).catch(()=>{})}function md(n,e,i){let s="dark",r=[],l=1,u=[],h=1,f=null,d={},p=[{name:"hello",default_args:{name:"world"}},{name:"sum",default_args:{nums:[1,2,3]}},{name:"script",default_args:{code:"print('hello')"}},{name:"raster.input",default_args:{path:""}}];Fn(async()=>{try{const at=await(await fetch("/node_types")).json();Array.isArray(at==null?void 0:at.types)&&i(6,p=at.types)}catch{}});const g={hello:[{key:"name",label:"Name",type:"string",placeholder:"world"}],sum:[{key:"nums",label:"Numbers",type:"array",itemType:"number",hint:"e.g., 1,2,3"}],script:[{key:"code",label:"Code",type:"textarea",rows:8,placeholder:"print('hello')"}],"raster.input":[{key:"path",label:"Raster path",type:"string",placeholder:"/path/to.tif"}],"vector.input":[{key:"path",label:"Vector path",type:"string",placeholder:"/path/to.shp"}],"vector.create":[{key:"geometry_type",label:"Geometry type",type:"select",options:["Polygon","LineString","Point"]},{key:"output_format",label:"Output format",type:"select",options:["GeoJSON","ESRI Shapefile"]},{key:"output_path",label:"Output path (optional)",type:"string",placeholder:"auto-generated"}]};function b(S){var Nt;const at=g[S];if(at)return at;const lt=(Nt=p.find(Lt=>Lt.name===S))==null?void 0:Nt.default_args;return fd(lt??{})}const w=S=>r.find(at=>at.id===S);function P(S,at){!w(S)||!w(at)||S===at||u.some(lt=>lt.source===S&&lt.target===at)||i(2,u=[...u,{id:`e${h++}`,source:S,target:at}])}function M(S){i(2,u=u.filter(at=>at.id!==S))}function E(S){if(It.has(S)&&Z&&Xt){const at=It.get(S);Z.removeLayer(at),Xt.removeLayer(at),It.delete(S)}i(1,r=r.filter(at=>at.id!==S)),delete d[S]}function A(){const S=new Set;for(const Lt of u)S.add(Lt.source),S.add(Lt.target);const at=r.filter(Lt=>S.has(Lt.id)),lt=new Set(at.map(Lt=>Lt.id)),Nt=u.filter(Lt=>lt.has(Lt.source)&&lt.has(Lt.target));return{activeNodes:at,activeEdges:Nt}}let T=[],I=!1,W={},V=!1,U=!1;function K(S,at,lt){i(7,T=[...T,{nodeId:S,ok:at,text:lt}]),V&&requestAnimationFrame(()=>{const Nt=document.querySelector(".logs-body");Nt&&(Nt.scrollTop=Nt.scrollHeight)})}async function nt(){var Lt;i(8,I=!0),i(7,T=[]),W={},i(4,V=!0);const{activeNodes:S,activeEdges:at}=A();if(S.length===0){K("system",!1,"No connected nodes to run."),i(8,I=!1);return}const lt=dd(S,at);lt.length!==S.length&&K("system",!1,"Warning: cycle detected; running partial order.");const Nt={};for(const ie of at)(Nt[Lt=ie.target]??(Nt[Lt]=[])).push(ie.source);for(const ie of lt){const Gn=w(ie),$e={};for(const Ot of Nt[ie]??[])$e[Ot]=W[Ot];K(ie,!0," Running");try{const Ot=await ja(Gn,$e);if(Array.isArray(Ot==null?void 0:Ot.logs))for(const tn of Ot.logs)K(ie,!0,String(tn));if(typeof(Ot==null?void 0:Ot.stdout)=="string"&&Ot.stdout.trim())for(const tn of Ot.stdout.split(/\r?\n/))tn.trim()&&K(ie,!0,tn);if(Ot!=null&&Ot.ok){const tn=Ot.output??{};W[ie]=tn;const Un=typeof tn=="string"?tn:tn.text??JSON.stringify(tn);K(ie,!0,` ${Un}`)}else K(ie,!1,` ${(Ot==null?void 0:Ot.error)||"Unknown error"}`)}catch(Ot){K(ie,!1,` Exception: ${(Ot==null?void 0:Ot.message)||Ot}`)}}i(8,I=!1)}function et(){const S=`n${l++}`,at=p[0]||{name:"hello",default_args:{name:S}},lt=120+r.length%6*260,Nt=140+Math.floor(r.length/6)*140,Lt=JSON.parse(JSON.stringify(at.default_args||{})),ie=`${at.name} (${S})`;i(1,r=[...r,{id:S,position:{x:lt,y:Nt},label:ie,type:at.name,args:Lt}]),i(3,d[S]=JSON.stringify(Lt,null,2),d)}function J(S){i(5,f=S)}function ut(S){f&&P(f,S),i(5,f=null)}function B(){i(5,f=null)}const it=S=>S.position.x,X=S=>S.position.x+fl,mt=S=>S.position.y+dl/2;let ht="",H=null,R=1200,Tt=650,rt=null;function bt(){H&&(rt&&rt.disconnect(),rt=new ResizeObserver(()=>{H&&(i(12,R=Math.max(320,Math.floor(H.clientWidth-1))),i(13,Tt=Math.max(240,Math.floor(H.clientHeight-1))))}),rt.observe(H))}let Et=60,vt=!1;function j(S){vt=!0,S.preventDefault()}function Q(S){if(!vt||!H||!H.parentElement)return;const lt=H.parentElement.getBoundingClientRect(),Nt=S.clientX-lt.left,Lt=Math.max(20,Math.min(80,Nt/lt.width*100));i(14,Et=Lt)}function G(){vt=!1}Fn(()=>(window.addEventListener("mousemove",Q),window.addEventListener("mouseup",G),()=>{window.removeEventListener("mousemove",Q),window.removeEventListener("mouseup",G)}));let Z=null,It=new Map,Xt=null,dt=null,Mt=null,zt=null;function Yt(){!Z||!Mt||(zt&&zt.disconnect(),zt=new ResizeObserver(()=>{requestAnimationFrame(()=>Z&&Z.invalidateSize())}),zt.observe(Mt))}function Kt(){i(9,U=!U),requestAnimationFrame(()=>Z==null?void 0:Z.invalidateSize())}Fn(()=>{let S=!1;const at=()=>Z&&Z.invalidateSize();return Promise.resolve().then(async()=>{if(await Qa(),!S&&(bt(),!Z&&dt)){Z=Yn.map(dt,{zoomControl:!0,attributionControl:!1}).setView([0,0],2);const lt={" OpenStreetMap":Yn.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{opacity:.9,minZoom:1,maxZoom:22,attribution:" OpenStreetMap contributors"})," OSM (Dark-ish)":Yn.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",{opacity:.95,minZoom:1,maxZoom:22,attribution:" OpenStreetMap,  CartoDB"})," Esri World Imagery":Yn.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{opacity:1,minZoom:1,maxZoom:19,attribution:"Tiles  Esri"})," Carto Positron":Yn.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{opacity:.95,minZoom:1,maxZoom:22,attribution:" OpenStreetMap,  CartoDB"})," OpenTopoMap":Yn.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{opacity:.95,minZoom:1,maxZoom:17,attribution:" OpenStreetMap,  OpenTopoMap"})};lt[" Esri World Imagery"].addTo(Z),Xt=Yn.control.layers(lt,{},{position:"topright",collapsed:!1}),Xt.addTo(Z),Yt(),window.addEventListener("resize",at)}}),()=>{S=!0,window.removeEventListener("resize",at),zt==null||zt.disconnect(),rt==null||rt.disconnect()}});function ge(S,at){var Nt;const lt=W[S.id];return lt&&typeof lt=="object"&&lt.type==="raster"&&lt.path?lt.path:S.type==="raster.input"&&typeof((Nt=r[at].args)==null?void 0:Nt.path)=="string"?r[at].args.path:null}function Ne(S,at){var Nt;const lt=W[S.id];return lt&&typeof lt=="object"&&lt.type==="vector"&&lt.path?lt.path:S.type==="vector.input"&&typeof((Nt=r[at].args)==null?void 0:Nt.path)=="string"?r[at].args.path:null}async function ot(S,at){if(!Z||!Xt){alert("Map not ready yet.");return}const lt=Ne(S,at);if(lt){await _e(S,at,lt);return}const Nt=ge(S,at);if(!Nt){alert("No raster/vector path available. Run the pipeline or set args.path.");return}const Lt=S.id;await fetch("/preview/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:Lt,path:Nt})});const ie=`/preview/tile/${Lt}/{z}/{x}/{y}.png`,Gn=`${S.label} (${S.id})`;if(It.has(Lt)){const Ot=It.get(Lt);Z.removeLayer(Ot),Xt.removeLayer(Ot),It.delete(Lt)}const $e=Yn.tileLayer(ie,{tms:!1,opacity:.8,maxZoom:22});It.set(Lt,$e),$e.addTo(Z),Xt.addOverlay($e,Gn);try{const Ot=await fetch(`/preview/bounds/${Lt}`).then(Ut=>Ut.json()),[tn,Un,fi,ri]=Ot.bounds,Di=Yn.latLngBounds([Un,tn],[ri,fi]);Z.fitBounds(Di,{padding:[10,10],animate:!0})}catch(Ot){console.warn("Failed to get bounds for zoom:",Ot)}}async function _e(S,at,lt){if(!Z||!Xt){alert("Map not ready yet.");return}const Nt=S.id;try{const Lt=await fetch("/preview/vector/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:Nt,path:lt})});if(!Lt.ok){const Ot=await Lt.text();alert(`Failed to register vector: ${Ot}`);return}const ie=await fetch(`/preview/vector/${Nt}/geojson`).then(Ot=>Ot.json());if(It.has(Nt)){const Ot=It.get(Nt);Z.removeLayer(Ot),Xt.removeLayer(Ot),It.delete(Nt)}const Gn=Yn.geoJSON(ie,{style:Ot=>({color:"#3388ff",weight:2,opacity:.8,fillOpacity:.3}),pointToLayer:(Ot,tn)=>Yn.circleMarker(tn,{radius:6,fillColor:"#3388ff",color:"#fff",weight:1,opacity:1,fillOpacity:.7}),onEachFeature:(Ot,tn)=>{if(Ot.properties){const Un=Object.entries(Ot.properties).map(([fi,ri])=>`<b>${fi}:</b> ${ri}`).join("<br/>");tn.bindPopup(Un)}}}),$e=` ${S.label} (${S.id})`;It.set(Nt,Gn),Gn.addTo(Z),Xt.addOverlay(Gn,$e);try{const Ot=await fetch(`/preview/vector/${Nt}/bounds`).then(Ut=>Ut.json()),[tn,Un,fi,ri]=Ot.bounds,Di=Yn.latLngBounds([Un,tn],[ri,fi]);Z.fitBounds(Di,{padding:[20,20],animate:!0})}catch(Ot){console.warn("Failed to get vector bounds:",Ot)}}catch(Lt){console.error("Error previewing vector:",Lt),alert(`Error previewing vector: ${Lt}`)}}function Jt(){if(!(!Z||!Xt)){for(const[,S]of It)Z.removeLayer(S),Xt.removeLayer(S);It.clear()}}let Ct=null,Qt="",qt=[],Gt={},Oe=!1;function xe(S){var Nt;i(17,Ct=S),i(19,qt=b(S.type)),i(20,Gt={});const lt={...((Nt=p.find(Lt=>Lt.name===S.type))==null?void 0:Nt.default_args)??{},...S.args??{}};for(const Lt of qt)i(20,Gt[Lt.key]=lt[Lt.key],Gt);i(18,Qt=JSON.stringify(S.args??{},null,2)),i(21,Oe=!1)}function $t(){if(!Ct)return;const S={};for(const at of qt){let lt=Gt[at.key];if(at.type==="number"&&(lt=Number(lt)),at.type==="array"){if(Array.isArray(lt))S[at.key]=lt;else if(typeof lt=="string"){const Nt=lt.split(",").map(Lt=>Lt.trim()).filter(Boolean);S[at.key]=at.itemType==="number"?Nt.map(Number):Nt}else S[at.key]=[];continue}at.type==="boolean"&&(lt=!!lt),S[at.key]=lt}i(17,Ct.args=S,Ct),i(3,d[Ct.id]=JSON.stringify(S,null,2),d)}function Ke(){if(Ct)if(Oe)try{const S=JSON.parse(Qt||"{}");i(17,Ct.args=S,Ct),i(3,d[Ct.id]=JSON.stringify(S,null,2),d),i(17,Ct=null)}catch{alert("Invalid JSON")}else $t(),i(17,Ct=null)}const Se=S=>{const at=r.find(lt=>lt.id===S);if(!at)throw new Error(`Node not found: ${S}`);return at};let he=null;async function me(S){i(4,V=!0),i(7,T=[]),await Me(S),he&&clearInterval(he),i(61,he=setInterval(()=>Me(S),1e3))}async function Me(S){try{const at=await fetch(`/pipeline/schedules/${S}/runs`).then(Lt=>Lt.json());if(!Array.isArray(at)||at.length===0){i(7,T=[{nodeId:"system",ok:!0,text:"(no runs yet)"}]);return}const lt=at[0],Nt=await fetch(`/pipeline/schedules/runs/${lt.id}`).then(Lt=>Lt.json());i(7,T=Nt.logs.map(Lt=>({nodeId:Nt.status==="running"?"run":Nt.status==="success"?"ok":"err",ok:!/|exception/i.test(Lt),text:Lt}))),Nt.status!=="running"&&he&&(clearInterval(he),i(61,he=null))}catch{i(7,T=[{nodeId:"system",ok:!1,text:"Failed to fetch run logs"}])}}$i(()=>{he&&clearInterval(he)});let Te=!1,Re="once",Ue="",rn=0,we=0,je=0,Dt="0 5 * * *",un=!1,Ie="",pn=[];function an(){const{activeNodes:S}=A();if(S.length===0){alert("No connected nodes to schedule. Connect nodes with edges first.");return}i(22,Te=!0),i(23,Re="once"),i(24,Ue=""),i(25,rn=i(26,we=i(27,je=0))),i(28,Dt="0 5 * * *"),i(30,Ie="")}function cn(){const{activeNodes:S,activeEdges:at}=A(),lt=S.map(Lt=>({id:Lt.id,type:Lt.type,args:Lt.args??{}})),Nt=at.map(Lt=>({source:Lt.source,target:Lt.target}));return{nodes:lt,edges:Nt}}async function Je(){const S=cn();if(S.nodes.length===0){i(30,Ie="Nothing to schedule (empty graph).");return}const at={mode:Re,graph:S};if(Re==="once"){if(!Ue){i(30,Ie="Please pick a date & time.");return}at.run_at=new Date(Ue).toISOString()}else if(Re==="interval"){if(at.hours=Number(rn)||0,at.minutes=Number(we)||0,at.seconds=Number(je)||0,!(at.hours||at.minutes||at.seconds)){i(30,Ie="Interval must be > 0.");return}}else if(at.cron=(Dt||"").trim(),!at.cron){i(30,Ie="Cron expression is required.");return}i(29,un=!0),i(30,Ie="");try{const lt=await fetch("/pipeline/schedules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(at)});if(!lt.ok)throw new Error(`HTTP ${lt.status}`);await lt.json(),i(22,Te=!1),await Ee()}catch(lt){i(30,Ie=`Failed to create schedule: ${(lt==null?void 0:lt.message)||lt}`)}finally{i(29,un=!1)}}async function Ee(){try{const S=await fetch("/pipeline/schedules");if(S.ok){i(31,pn=await S.json());return}}catch{}try{const S=await fetch("/schedules");S.ok&&i(31,pn=await S.json())}catch{}}async function kn(S){await fetch(`/pipeline/schedules/${S}`,{method:"DELETE"}).catch(()=>{}),await Ee()}async function re(S){await fetch(`/pipeline/schedules/${S}/pause`,{method:"POST"}).catch(()=>{}),await Ee()}async function ce(S){await fetch(`/pipeline/schedules/${S}/resume`,{method:"POST"}).catch(()=>{}),await Ee()}Fn(async()=>{await Ee().catch(()=>{})});function Xe(){const S={nodes:r.map(ie=>({id:ie.id,position:ie.position,label:ie.label,type:ie.type,args:ie.args})),edges:u.map(ie=>({id:ie.id,source:ie.source,target:ie.target}))},at=JSON.stringify(S,null,2),lt=new Blob([at],{type:"application/json"}),Nt=URL.createObjectURL(lt),Lt=document.createElement("a");Lt.href=Nt,Lt.download=`saterys-workflow-${new Date().toISOString().replace(/:/g,"-").split(".")[0]}.json`,Lt.click(),URL.revokeObjectURL(Nt)}function Sn(){const S=document.createElement("input");S.type="file",S.accept=".json",S.onchange=async at=>{var Nt;const lt=(Nt=at.target.files)==null?void 0:Nt[0];if(lt)try{const Lt=await lt.text(),ie=JSON.parse(Lt);if(!ie.nodes||!Array.isArray(ie.nodes)){alert("Invalid workflow file: missing nodes array");return}i(1,r=[]),i(2,u=[]),i(3,d={}),Jt(),i(1,r=ie.nodes.map($e=>({id:$e.id||`n${l++}`,position:$e.position||{x:100,y:100},label:$e.label||"unknown",type:$e.type||"hello",args:$e.args||{}}))),l=Math.max(...r.map($e=>{const Ot=$e.id.match(/^n(\d+)$/);return Ot?parseInt(Ot[1]):0}),0)+1,ie.edges&&Array.isArray(ie.edges)&&(i(2,u=ie.edges.map(Ot=>({id:Ot.id||`e${h++}`,source:Ot.source,target:Ot.target}))),h=Math.max(...u.map(Ot=>{const tn=Ot.id.match(/^e(\d+)$/);return tn?parseInt(tn[1]):0}),0)+1);for(const $e of r)i(3,d[$e.id]=JSON.stringify($e.args||{},null,2),d);K("system",!0,`Loaded workflow with ${r.length} nodes and ${u.length} edges`),i(4,V=!0)}catch(Lt){alert(`Failed to load workflow: ${Lt instanceof Error?Lt.message:String(Lt)}`)}},S.click()}function Pn(S){qe.call(this,n,S)}function Nn(S){qe.call(this,n,S)}const zn=()=>i(4,V=!V),Be=()=>i(0,s=s==="dark"?"light":"dark"),wt=()=>i(0,s=s==="dark"?"light":"dark"),nn=S=>M(S.id),On=S=>{_d(S.id),me(S.id)},on=S=>re(S.id),In=S=>ce(S.id),y=S=>me(S.id),ft=S=>kn(S.id),kt=S=>ut(S.id),Pt=S=>J(S.id),At=S=>E(S.id);function O(S){r[S].type=Ho(this),i(1,r),i(6,p)}const Wt=(S,at)=>{const lt=p.find(Lt=>Lt.name===r[S].type),Nt=(lt==null?void 0:lt.default_args)??{};i(1,r[S].args=JSON.parse(JSON.stringify(Nt)),r),i(1,r[S].label=`${r[S].type} (${at.id})`,r),i(3,d[at.id]=JSON.stringify(r[S].args,null,2),d)},ee=S=>xe(S),te=(S,at)=>ot(S,at),We=async S=>{var at;try{const lt=await ja(S,{});i(4,V=!0),K(S.id,!!(lt!=null&&lt.ok),lt!=null&&lt.ok?((at=lt==null?void 0:lt.output)==null?void 0:at.message)||"Started":(lt==null?void 0:lt.error)||"Error")}catch(lt){K(S.id,!1,`Exception: ${typeof lt=="object"&&lt!==null&&"message"in lt?lt.message:String(lt)}`),i(4,V=!0)}};function Fe(S,at){n.$$.not_equal(r[at].position,S)&&(r[at].position=S,i(1,r))}function Ve(S){Kn[S?"unshift":"push"](()=>{H=S,i(11,H)})}function Mn(S){Kn[S?"unshift":"push"](()=>{dt=S,i(15,dt)})}function Tn(S){Kn[S?"unshift":"push"](()=>{Mt=S,i(16,Mt)})}const Jn=()=>i(17,Ct=null),xn=()=>i(21,Oe=!1),Bn=()=>i(21,Oe=!0);function Ln(S){Gt[S.key]=this.value,i(20,Gt),i(19,qt)}function Rn(S){Gt[S.key]=mi(this.value),i(20,Gt),i(19,qt)}function hn(S){Gt[S.key]=this.checked,i(20,Gt),i(19,qt)}function pt(S){Gt[S.key]=this.value,i(20,Gt),i(19,qt)}function jt(S){Gt[S.key]=this.value,i(20,Gt),i(19,qt)}function fe(S){Gt[S.key]=Ho(this),i(20,Gt),i(19,qt)}function _n(){Qt=this.value,i(18,Qt)}const Qe=()=>i(17,Ct=null),pe=()=>i(22,Te=!1);function ze(){Re=Ho(this),i(23,Re)}function xt(){Ue=this.value,i(24,Ue)}function ae(){rn=mi(this.value),i(25,rn)}function fn(){we=mi(this.value),i(26,we)}function sn(){je=mi(this.value),i(27,je)}function gn(){Dt=this.value,i(28,Dt)}const Qn=()=>i(22,Te=!1),vn=()=>navigator.clipboard.writeText(T.map(S=>`[${S.nodeId}] ${S.ok?"OK":"ERR"} ${S.text}`).join(`
`)),Bt=()=>i(7,T=[]),Rt=()=>i(4,V=!1);return n.$$.update=()=>{if(n.$$.dirty[0]&1&&document!=null&&document.body&&(document.body.dataset.theme=s),n.$$.dirty[0]&10){for(const S of r)if(d[S.id]===void 0)try{i(3,d[S.id]=JSON.stringify(S.args??{},null,2),d)}catch{i(3,d[S.id]="{}",d)}}if(n.$$.dirty[0]&6){const S=new Set(r.map(lt=>lt.id)),at=u.filter(lt=>S.has(lt.source)&&S.has(lt.target));at.length!==u.length&&i(2,u=at)}n.$$.dirty[0]&2&&i(10,ht=r.map(S=>`${S.id}:${S.position.x},${S.position.y}`).join("|")),n.$$.dirty[0]&16|n.$$.dirty[1]&1073741824&&!V&&he&&(clearInterval(he),i(61,he=null))},[s,r,u,d,V,f,p,T,I,U,ht,H,R,Tt,Et,dt,Mt,Ct,Qt,qt,Gt,Oe,Te,Re,Ue,rn,we,je,Dt,un,Ie,pn,w,M,E,K,nt,et,J,ut,B,it,X,mt,j,It,Kt,ot,Jt,xe,Ke,Se,me,an,Je,Ee,kn,re,ce,Xe,Sn,he,Pn,Nn,zn,Be,wt,nn,On,on,In,y,ft,kt,Pt,At,O,Wt,ee,te,We,Fe,Ve,Mn,Tn,Jn,xn,Bn,Ln,Rn,hn,pt,jt,fe,_n,Qe,pe,ze,xt,ae,fn,sn,gn,Qn,vn,Bt,Rt]}class pd extends wn{constructor(e){super(),bn(this,e,md,hd,dn,{},null,[-1,-1,-1,-1,-1,-1])}}new pd({target:document.getElementById("app")});export{$i as $,se as A,tl as B,el as C,oe as D,ue as E,yt as F,ln as G,Cn as H,qn as I,Ge as J,Vo as K,ke as L,Le as M,Ce as N,Pe as O,Qs as P,Wn as Q,tc as R,wn as S,He as T,mi as U,Bi as V,Hn as W,Pi as X,Ho as Y,Y as Z,Kn as _,st as a,yo as a0,ne as a1,si as a2,ko as a3,tt as b,m as c,q as d,z as e,gt as f,mn as g,Ae as h,bn as i,F as j,D as k,_t as l,ye as m,Ht as n,Fn as o,Ji as p,be as q,k as r,dn as s,Vt as t,hi as u,$ as v,de as w,Po as x,De as y,os as z};
