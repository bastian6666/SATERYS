const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Controls-BT5uPmwW.js","assets/Icon-CWpUKpRU.js","assets/DrawerController-59ToZxo1.js","assets/DrawerController-ZXfKNTdC.css"])))=>i.map(i=>d[i]);
var lh=Object.defineProperty;var hh=(n,e,o)=>e in n?lh(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o;var Fo=(n,e,o)=>hh(n,typeof e!="symbol"?e+"":e,o);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))a(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function o(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(i){if(i.ep)return;i.ep=!0;const r=o(i);fetch(i.href,r)}})();function Gt(){}function ss(n,e){for(const o in e)n[o]=e[o];return n}function Xa(n){return n()}function Vs(){return Object.create(null)}function hi(n){n.forEach(Xa)}function no(n){return typeof n=="function"}function di(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function ch(n){return Object.keys(n).length===0}function gi(n,...e){if(n==null){for(const a of e)a(void 0);return Gt}const o=n.subscribe(...e);return o.unsubscribe?()=>o.unsubscribe():o}function Lt(n){let e;return gi(n,o=>e=o)(),e}function bt(n,e,o){n.$$.on_destroy.push(gi(e,o))}function ke(n,e,o,a){if(n){const i=qa(n,e,o,a);return n[0](i)}}function qa(n,e,o,a){return n[1]&&a?ss(o.ctx.slice(),n[1](a(e))):o.ctx}function Me(n,e,o,a){if(n[2]&&a){const i=n[2](a(o));if(e.dirty===void 0)return i;if(typeof i=="object"){const r=[],l=Math.max(e.dirty.length,i.length);for(let c=0;c<l;c+=1)r[c]=e.dirty[c]|i[c];return r}return e.dirty|i}return e.dirty}function Pe(n,e,o,a,i,r){if(i){const l=qa(e,o,a,r);n.p(l,i)}}function Ee(n){if(n.ctx.length>32){const e=[],o=n.ctx.length/32;for(let a=0;a<o;a++)e[a]=-1;return e}return-1}function rs(n){const e={};for(const o in n)e[o]=!0;return e}function Ys(n){return n??""}function Nt(n,e,o){return n.set(o),e}function kn(n){return n&&no(n.destroy)?n.destroy:Gt}const uh=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function w(n,e){n.appendChild(e)}function et(n,e,o){n.insertBefore(e,o||null)}function Q(n){n.parentNode&&n.parentNode.removeChild(n)}function Tn(n,e){for(let o=0;o<n.length;o+=1)n[o]&&n[o].d(e)}function S(n){return document.createElement(n)}function qt(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Ze(n){return document.createTextNode(n)}function K(){return Ze(" ")}function Ie(){return Ze("")}function ft(n,e,o,a){return n.addEventListener(e,o,a),()=>n.removeEventListener(e,o,a)}function Xi(n){return function(e){return e.preventDefault(),n.call(this,e)}}function en(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function Qn(n){return function(e){e.target===this&&n.call(this,e)}}function m(n,e,o){o==null?n.removeAttribute(e):n.getAttribute(e)!==o&&n.setAttribute(e,o)}function Ln(n){return n===""?null:+n}function dh(n){return Array.from(n.childNodes)}function Ei(n,e){e=""+e,n.data!==e&&(n.data=e)}function Be(n,e){n.value=e??""}function ht(n,e,o,a){o==null?n.style.removeProperty(e):n.style.setProperty(e,o,"")}function jn(n,e,o){for(let a=0;a<n.options.length;a+=1){const i=n.options[a];if(i.__value===e){i.selected=!0;return}}(!o||e!==void 0)&&(n.selectedIndex=-1)}function Go(n){const e=n.querySelector(":checked");return e&&e.__value}let yo;function fh(){if(yo===void 0){yo=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{yo=!0}}return yo}function _h(n,e){getComputedStyle(n).position==="static"&&(n.style.position="relative");const a=S("iframe");a.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),a.setAttribute("aria-hidden","true"),a.tabIndex=-1;const i=fh();let r;return i?(a.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",r=ft(window,"message",l=>{l.source===a.contentWindow&&e()})):(a.src="about:blank",a.onload=()=>{r=ft(a.contentWindow,"resize",e),e()}),w(n,a),()=>{(i||r&&a.contentWindow)&&r(),Q(a)}}function Vt(n,e,o){n.classList.toggle(e,!!o)}function ph(n,e,{bubbles:o=!1,cancelable:a=!1}={}){return new CustomEvent(n,{detail:e,bubbles:o,cancelable:a})}function fn(n,e){return new n(e)}let eo;function $n(n){eo=n}function Dn(){if(!eo)throw new Error("Function called outside component initialization");return eo}function mh(n){Dn().$$.before_update.push(n)}function qi(n){Dn().$$.on_mount.push(n)}function Ka(n){Dn().$$.after_update.push(n)}function oo(n){Dn().$$.on_destroy.push(n)}function Fn(){const n=Dn();return(e,o,{cancelable:a=!1}={})=>{const i=n.$$.callbacks[e];if(i){const r=ph(e,o,{cancelable:a});return i.slice().forEach(l=>{l.call(n,r)}),!r.defaultPrevented}return!0}}function Oe(n,e){return Dn().$$.context.set(n,e),e}function de(n){return Dn().$$.context.get(n)}function Ke(n,e){const o=n.$$.callbacks[e.type];o&&o.slice().forEach(a=>a.call(this,e))}const Zn=[],nn=[];let Hn=[];const $o=[],Ja=Promise.resolve();let ts=!1;function Qa(){ts||(ts=!0,Ja.then(tl))}function $a(){return Qa(),Ja}function Sn(n){Hn.push(n)}function gh(n){$o.push(n)}const Uo=new Set;let Bn=0;function tl(){if(Bn!==0)return;const n=eo;do{try{for(;Bn<Zn.length;){const e=Zn[Bn];Bn++,$n(e),vh(e.$$)}}catch(e){throw Zn.length=0,Bn=0,e}for($n(null),Zn.length=0,Bn=0;nn.length;)nn.pop()();for(let e=0;e<Hn.length;e+=1){const o=Hn[e];Uo.has(o)||(Uo.add(o),o())}Hn.length=0}while(Zn.length);for(;$o.length;)$o.pop()();ts=!1,Uo.clear(),$n(n)}function vh(n){if(n.fragment!==null){n.update(),hi(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Sn)}}function yh(n){const e=[],o=[];Hn.forEach(a=>n.indexOf(a)===-1?e.push(a):o.push(a)),o.forEach(a=>a()),Hn=e}const ko=new Set;let En;function ve(){En={r:0,c:[],p:En}}function ye(){En.r||hi(En.c),En=En.p}function B(n,e){n&&n.i&&(ko.delete(n),n.i(e))}function G(n,e,o,a){if(n&&n.o){if(ko.has(n))return;ko.add(n),En.c.push(()=>{ko.delete(n),a&&(o&&n.d(1),a())}),n.o(e)}else a&&a()}function Se(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Co(n,e){n.d(1),e.delete(n.key)}function io(n,e){G(n,1,1,()=>{e.delete(n.key)})}function vn(n,e,o,a,i,r,l,c,u,f,p,g){let y=n.length,k=r.length,M=y;const C={};for(;M--;)C[n[M].key]=M;const D=[],z=new Map,T=new Map,x=[];for(M=k;M--;){const Y=g(i,r,M),st=o(Y);let ot=l.get(st);ot?x.push(()=>ot.p(Y,e)):(ot=f(st,Y),ot.c()),z.set(st,D[M]=ot),st in C&&T.set(st,Math.abs(M-C[st]))}const j=new Set,F=new Set;function W(Y){B(Y,1),Y.m(c,p),l.set(Y.key,Y),p=Y.first,k--}for(;y&&k;){const Y=D[k-1],st=n[y-1],ot=Y.key,$=st.key;Y===st?(p=Y.first,y--,k--):z.has($)?!l.has(ot)||j.has(ot)?W(Y):F.has($)?y--:T.get(ot)>T.get($)?(F.add(ot),W(Y)):(j.add($),y--):(u(st,l),y--)}for(;y--;){const Y=n[y];z.has(Y.key)||u(Y,l)}for(;k;)W(D[k-1]);return hi(x),D}function el(n,e){const o={},a={},i={$$scope:1};let r=n.length;for(;r--;){const l=n[r],c=e[r];if(c){for(const u in l)u in c||(a[u]=1);for(const u in c)i[u]||(o[u]=c[u],i[u]=1);n[r]=c}else for(const u in l)i[u]=1}for(const l in a)l in o||(o[l]=void 0);return o}function il(n){return typeof n=="object"&&n!==null?n:{}}function bh(n,e,o){const a=n.$$.props[e];a!==void 0&&(n.$$.bound[a]=o,o(n.$$.ctx[a]))}function ae(n){n&&n.c()}function ee(n,e,o){const{fragment:a,after_update:i}=n.$$;a&&a.m(e,o),Sn(()=>{const r=n.$$.on_mount.map(Xa).filter(no);n.$$.on_destroy?n.$$.on_destroy.push(...r):hi(r),n.$$.on_mount=[]}),i.forEach(Sn)}function ie(n,e){const o=n.$$;o.fragment!==null&&(yh(o.after_update),hi(o.on_destroy),o.fragment&&o.fragment.d(e),o.on_destroy=o.fragment=null,o.ctx=[])}function wh(n,e){n.$$.dirty[0]===-1&&(Zn.push(n),Qa(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function ki(n,e,o,a,i,r,l=null,c=[-1]){const u=eo;$n(n);const f=n.$$={fragment:null,ctx:[],props:r,update:Gt,not_equal:i,bound:Vs(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(u?u.$$.context:[])),callbacks:Vs(),dirty:c,skip_bound:!1,root:e.target||u.$$.root};l&&l(f.root);let p=!1;if(f.ctx=o?o(n,e.props||{},(g,y,...k)=>{const M=k.length?k[0]:y;return f.ctx&&i(f.ctx[g],f.ctx[g]=M)&&(!f.skip_bound&&f.bound[g]&&f.bound[g](M),p&&wh(n,g)),y}):[],f.update(),p=!0,hi(f.before_update),f.fragment=a?a(f.ctx):!1,e.target){if(e.hydrate){const g=dh(e.target);f.fragment&&f.fragment.l(g),g.forEach(Q)}else f.fragment&&f.fragment.c();e.intro&&B(n.$$.fragment),ee(n,e.target,e.anchor),tl()}$n(u)}class Mi{constructor(){Fo(this,"$$");Fo(this,"$$set")}$destroy(){ie(this,1),this.$destroy=Gt}$on(e,o){if(!no(o))return Gt;const a=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return a.push(o),()=>{const i=a.indexOf(o);i!==-1&&a.splice(i,1)}}$set(e){this.$$set&&!ch(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Lh="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Lh);const Rn=[];function Po(n,e){return{subscribe:J(n,e).subscribe}}function J(n,e=Gt){let o;const a=new Set;function i(c){if(di(n,c)&&(n=c,o)){const u=!Rn.length;for(const f of a)f[1](),Rn.push(f,n);if(u){for(let f=0;f<Rn.length;f+=2)Rn[f][0](Rn[f+1]);Rn.length=0}}}function r(c){i(c(n))}function l(c,u=Gt){const f=[c,u];return a.add(f),a.size===1&&(o=e(i,r)||Gt),c(n),()=>{a.delete(f),a.size===0&&o&&(o(),o=null)}}return{set:i,update:r,subscribe:l}}function to(n,e,o){const a=!Array.isArray(n),i=a?[n]:n;if(!i.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const r=e.length<2;return Po(o,(l,c)=>{let u=!1;const f=[];let p=0,g=Gt;const y=()=>{if(p)return;g();const M=e(a?f[0]:f,l,c);r?l(M):g=no(M)?M:Gt},k=i.map((M,C)=>gi(M,D=>{f[C]=D,p&=~(1<<C),u&&y()},()=>{p|=1<<C}));return u=!0,y(),function(){hi(k),g(),u=!1}})}function Eo(){const n=new Map,{subscribe:e,set:o,update:a}=J(n);return{subscribe:e,set:o,update:a,add:(r,l)=>(a(c=>(c.set(l,r),c)),n),get:r=>n.get(r)||null,getAll:()=>Array.from(n.values()),delete:r=>{let l=!1;return a(c=>(c.delete(r),l=!0,c)),l},count:()=>n.size}}function kh(n){const{id:e,inputs:o,outputs:a,resizable:i,dimensions:r,editable:l,direction:c,zIndex:u,position:f,selectionColor:p,borderWidth:g,edge:y}=n,{bgColor:k,borderColor:M,rotation:C,borderRadius:D,connections:z,textColor:T,locked:x,group:j}=n,F=Eo(),W=(ot="self")=>{Lt(F).forEach($=>{(ot==="self"||Lt($.direction)===ot)&&$.recalculatePosition()})};return{id:typeof e=="string"&&e.slice(0,2)==="N-"?e:`N-${e}`,position:J({x:(f==null?void 0:f.x)||0,y:(f==null?void 0:f.y)||0}),dimensions:{width:J((r==null?void 0:r.width)||0),height:J((r==null?void 0:r.height)||(r==null?void 0:r.width))},group:J(j||null),locked:J(x||!1),inputs:J(o),outputs:J(a),recalculateAnchors:W,rotation:J(C||0),moving:J(!1),resizingWidth:J(!1),resizingHeight:J(!1),rotating:J(!1),editable:J(l||!1),resizable:J(i),anchors:F,zIndex:J(u||2),collapsed:J(!1),edge:y||null,borderRadius:J(D),bgColor:J(k||null),direction:J(c),label:J(n.label||""),borderColor:J(M||null),borderWidth:J(g),selectionColor:J(p||null),textColor:J(T||null),connections:J(z)}}const Mh=10,Ph=100,Eh=50,Ch="#000",Th="#fff",Sh="12px",Dh=22,zh=1.4,Oh=40;function Ih(n,e){const o=[n,e].sort();return`${o[0]}+${o[1]}`}function Xs(n,e,o){var c,u,f,p,g;const{source:a,target:i}=n,l={id:a.id&&i.id?Ih(a.id,i.id):"cursor",target:n.target,source:n.source,component:e,type:J((o==null?void 0:o.type)||null),color:(o==null?void 0:o.color)||J(null),width:J((o==null?void 0:o.width)||0),animated:J((o==null?void 0:o.animated)||!1),rendered:J(!1),start:(o==null?void 0:o.start)||null,end:(o==null?void 0:o.end)||null};if(o!=null&&o.disconnect&&(l.disconnect=!0),o!=null&&o.label){const y={text:J(o==null?void 0:o.label.text),color:J(((c=o==null?void 0:o.label)==null?void 0:c.color)||Ch),textColor:J(((u=o==null?void 0:o.label)==null?void 0:u.textColor)||Th),fontSize:J(((f=o==null?void 0:o.label)==null?void 0:f.fontSize)||Sh),dimensions:{width:J(((p=o==null?void 0:o.label.dimensions)==null?void 0:p.width)||Ph),height:J(((g=o==null?void 0:o.label.dimensions)==null?void 0:g.height)||Eh)},borderRadius:J((o==null?void 0:o.label.borderRadius)||Mh)};l.label=y}return l}function Ah(){const n=new Map,e=new Set,{subscribe:o,set:a,update:i}=J(n),r={subscribe:o,set:a,update:i,add:(l,c)=>{if(typeof c!="string"){const u=Array.from(c),f=u[0],p=u[1];if(f.connected.update(g=>g.add(p)),p.connected.update(g=>g.add(f)),r.match(...Array.from(c)).length)return;e.forEach(g=>g(l,"connection"))}i(u=>(u.set(c,l),u))},getAll:()=>Array.from(n.values()),get:l=>n.get(l)||null,match:(...l)=>Array.from(n.keys()).filter(c=>c==="cursor"?!1:l.every(u=>u?c.has(u):!0)),fetch:(l,c)=>{const u=Array.from(n.keys()).filter(f=>f==="cursor"?!1:[l,c].every(p=>p?f.has(p):!0))[0];return n.get(u)||null},delete:l=>{if(typeof l!="string"){const u=Array.from(l),f=u[0],p=u[1];f.connected.update(g=>(g.delete(p),g)),p.connected.update(g=>(g.delete(f),g))}let c=!1;return i(u=>{const f=u.get(l);return f&&(u.delete(l),c=!0,typeof l!="string"&&e.forEach(p=>p(f,"disconnection"))),u}),c},onEdgeChange:l=>(e.add(l),()=>e.delete(l)),count:()=>n.size};return r}function xh(n,e){const o=n.clientX-e.clientX,a=n.clientY-e.clientY;return Math.sqrt(o*o+a*a)}function Nh(){const n=()=>Math.floor(Math.random()*256),e=n(),o=n(),a=n();return`rgb(${e},${o},${a})`}const Bh={"(":"round","[":"square","([":"stadium","[[":"subroutine","[(":"cylindrical","((":"circle","{":"rhombus","{{":"hexagon"},qs={"-":"straight","~":"bezier"},nl={"(":")","[":"]","{":"}"},Rh=/[-=~]*>(?:\s*\|(.+?)\|)?/g,Zh=n=>{const e=n.split(`
`),o={parentNodes:[],nodeList:{}};for(const a of e){const{parentNodes:i,childNodes:r,edge:l}=Hh(a);for(const c of i){o.nodeList[c.id]||o.parentNodes.push(c);for(const u of r){if(o.nodeList[c.id]){if(o.nodeList[u.id]&&o.nodeList[u.id].children.some(({node:f})=>f.id===c.id))throw new Error("Circular reference detected");o.nodeList[c.id].children.push({node:o.nodeList[u.id]||u,...l})}else c.children.push({node:o.nodeList[u.id]||u,...l}),o.nodeList[c.id]=c;o.nodeList[u.id]?o.nodeList[u.id].parents.push({node:o.nodeList[c.id]||c}):(u.parents.push({node:o.nodeList[c.id]||c}),o.nodeList[u.id]=u),o.parentNodes=o.parentNodes.filter(f=>f.id!==u.id)}}}return o},Hh=n=>{const e=[],o=[],a=n.trim();let i="";const r=a.match(Rh);if(r)i=r[0];else throw new Error("Invalid edge");const[l,c]=a.split(i);for(const f of l.split("&"))e.push(Ks(f));for(const f of c.split("&"))o.push(Ks(f));const u=jh(i);return{parentNodes:e,childNodes:o,edge:u}},Ks=n=>{n=n.trim();const e=n[0],o=n.slice(1);let a="",i="";const r="Default",l={shape:""},c=[];for(let u=0;u<o.length;u++)if(Fh(o[u]))c.push(o[u]);else if(nl[c[c.length-1]]===o[u]){i=Bh[c.join("")];break}else a+=o[u];return l.shape=i,l.content=a,{id:e,data:l,type:r,children:[],parents:[],depth:0,nesting:0}},jh=n=>{n=n.trim();let e="";const[o,a]=n.split("|"),i=o[0];if(i in qs)e=qs[i];else throw new Error("Not a valid edge type");return a?{shape:e,content:a.trim(),length:Math.floor((o.trim().length-1)/2)}:{shape:e,length:Math.floor((o.trim().length-1)/2)}};function Fh(n){return n in nl}function Gh(){return Math.random().toString(36).substring(7)}function Uh(n,e){const o=Math.sign(n.x).toString(),a=Math.sign(n.y).toString(),i=Math.sign(e.x).toString(),r=Math.sign(e.y).toString();return`${o}${a}${i}${r}`}function Wh(n,e){return{1001:`a ${n} ${n} 0 0 1 ${n} ${n}`,"0110":`a ${n} ${n} 0 0 0 ${n} ${n}`,"100-1":`a ${n} ${n} 0 0 0 ${n} -${n}`,"0-110":`a ${n} ${n} 0 0 1 ${n} -${n}`,"-1001":`a ${n} ${n} 0 0 0 -${n} ${n}`,"01-10":`a ${n} ${n} 0 0 1 -${n} ${n}`,"-100-1":`a ${n} ${n} 0 0 1 -${n} -${n}`,"0-1-10":`a ${n} ${n} 0 0 0 -${n} -${n}`}[e]||""}function Js(n,e){const o=e*(Math.PI/180),a=n.x*Math.cos(o)-n.y*Math.sin(o),i=n.x*Math.sin(o)+n.y*Math.cos(o);return{x:a,y:i}}const Vh=(n,e,o,a)=>n+` l ${e} ${o} `+a,Ri=J({x:0,y:0}),es=J(0),Vi=J(!1),is=J(!1),ol=Po({x:0,y:0},n=>{const e=r=>{n({x:r.clientX,y:r.clientY})},o=r=>{if(r.touches.length===2){const l=xh(r.touches[0],r.touches[1]);es.set(l);const c={x:r.touches[0].clientX,y:r.touches[0].clientY};n(c)}else if(r.touches.length===1){const l=r.touches[0].clientX,c=r.touches[0].clientY;n({x:l,y:c}),Vi.set(!0)}},a=r=>{o(r),window.addEventListener("touchend",i),window.addEventListener("touchmove",o)},i=()=>{Vi.set(!1),es.set(0),window.removeEventListener("touchmove",o)};return document.addEventListener("mousemove",e),window.addEventListener("touchstart",a,!0),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchstart",a),window.removeEventListener("touchmove",o),window.removeEventListener("touchend",i)}});function Wo(n){const e=n.style.width,o=n.style.height;n.style.width="fit-content",n.style.height="fit-content";const a=n.offsetWidth,i=n.offsetHeight;return n.style.width=e,n.style.height=o,[a,i]}function sl(n,e,o,a,i){const r={x:0,y:0},l=a.x-i.left-i.width/2,c=a.y-i.top-i.height/2,u=(l-o.x)/n,f=(c-o.y)/n;return r.x=l-u*e,r.y=c-f*e,r}const Yh=3,Xh=.1,Jn={north:{x:0,y:-1},south:{x:0,y:1},east:{x:1,y:0},west:{x:-1,y:0},self:{x:0,y:0}};function rl(n,e,o){const a=e*o,i=n-a;return Number(Math.max(Xh,Math.min(Yh,i)).toFixed(9))}const To=(n,e,o,a,i,r,l)=>{const{clientX:c,clientY:u}=n,f=r,p=c-o,g=u-e,y=l.x,k=l.y,M=a*(1-r)/2,C=i*(1-r)/2,D=p-y-M,z=g-k-C,T=D/f,x=z/f;return{x:T,y:x}};function qh(n,e,o){const{top:a,left:i,width:r,height:l}=Lt(n),c=Lt(e.scale),u=Lt(e.translation);return{scaled:To({clientX:o.x,clientY:o.y},a,i,r,l,c,u),scale:c}}function Kh(n,e,o){const{scale:a,translation:i}=o,r=Lt(a),l=Lt(i),c=e.x-n.x,u=e.y-n.y,f=l.x+c*r,p=l.y+u*r;return{x:f,y:p}}function Jh(n,e){return n.x*e.x+n.y*e.y}function Qh(n,e,o){const a=[],i=e.x-n.x,r=e.y-n.y,l=tc(n.direction,e.direction),c=Jh(n.direction,e.direction)===0,u=$h(n,e),f=Qe(n.direction,-1,-1),p=Qe(e.direction,-1,-1),g={x:Math.abs(n.direction.y),y:Math.abs(n.direction.x)},y=Qe(n.direction,i-o*n.direction.x*(c?1:l?0:2),r-o*n.direction.y*(c?1:l?0:2)),k=Qe(e.direction,i+o*e.direction.x*(c?1:l?0:2),r+o*e.direction.y*(c?1:l?0:2)),M=Math.sign(y.x)===-1||Math.sign(y.y)===-1,C=Math.sign(k.x)===1||Math.sign(k.y)===1,D=Math.abs(i),z=Math.abs(r),T=Qe(n.direction,o,o),x=Qe(p,o,o),j=Qe(e.direction,o,o),F=Qe(n.direction,D,z),W=Qe(p,D,z),Y=Qe(n.direction,D/2,z/2),st=Qe(p,D/2,z/2),ot=Qe(g,i,r),$=!u&&!C&&!M,ct=n.x+T.x,N=n.y+T.y,lt=e.x+j.x,V=e.y+j.y;if(M&&a.push(T),u&&!C&&!M)a.push(F),a.push(W);else if(l)M||a.push(Qe(n.direction,o+D,o+z)),a.push(ot),C||a.push(Qe(p,o+D,o+z));else if($)a.push(Y),a.push(ot),a.push(st);else if(M&&C)if(c){const yt=Math.abs(ct-lt),_t=Math.abs(N-V);a.push(Qe(e.direction,D<o*2?e.direction.x*(i+e.direction.x*o):D+o,z<o*2?e.direction.y*(r+e.direction.y*o):z+o)),a.push(Qe(f,yt,_t))}else{const yt=Math.abs(ct-lt),_t=Math.abs(N-V);a.push(Qe(g,i/2,r/2)),a.push(Qe(e.direction,yt,_t)),a.push(Qe(g,i/2,r/2))}else if(M){const yt=Math.abs(ct-e.x),_t=Math.abs(N-e.y);a.push(Qe(p,D<o*2?D-o:D/2,z<o*2?z-o:z/2)),a.push(Qe(f,yt,_t)),a.push(Qe(p,Math.max(o,D/2),Math.max(o,z/2)))}else if(C){const yt=Math.abs(lt-n.x),_t=Math.abs(V-n.y);a.push(Qe(n.direction,Math.max(o,D/2),Math.max(o,z/2))),a.push(Qe(e.direction,yt,_t)),a.push(Qe(n.direction,D<o*2?D-o:D/2,z<o*2?z-o:z/2))}return C&&a.push(x),a}function $h(n,e){const{x:o,y:a}=n.direction,{x:i,y:r}=e.direction,l=e.x-n.x,c=e.y-n.y;return o*r===i*a?!1:Math.sign(c)===Math.sign(a+r)!=(Math.sign(l)===Math.sign(o+i))}function Qe(n,e,o){return{x:n.x*e,y:n.y*o}}function tc(n,e){return n.x===e.x&&n.y===e.y}function ec(n,e){const{width:o,height:a}=n,{top:i,left:r,right:l,bottom:c}=e,u=l-r,f=c-i;if(!u||!f)return{x:null,y:null,scale:null};const p=r+u/2,g=i+f/2,y=Math.min(o/u,a/f)*.8,k=o/2,M=a/2,C=k-p,D=M-g;return{x:C*y,y:D*y,scale:y}}const bo=(n,e,o)=>Math.min(Math.abs(n||e)/2,o);function Vo(n,e){const a=n.getTotalLength()*e;return n.getPointAtLength(a)}function ic(n,e,o,a){return to([n,e,o,a],([r,l,c,u])=>{const f={clientX:r.x,clientY:r.y};return To(f,l.top,l.left,l.width,l.height,u,c)})}function nc(n,e,o,a){const i=J({top:1/0,left:1/0,right:-1/0,bottom:-1/0}),r=J({top:1/0,left:1/0,right:-1/0,bottom:-1/0});let l,c=Lt(e),u=Lt(o),f=Lt(a),p=c.width/u,g=c.height/u;function y(){const{x:M,y:C}=To({clientX:c.left,clientY:c.top},c.top,c.left,c.width,c.height,u,f),D=Lt(r);i.set({top:Math.min(D.top,C),left:Math.min(D.left,M),right:Math.max(D.right,M+p),bottom:Math.max(D.bottom,g+C)})}function k(M=!1){let C=1/0,D=1/0,z=-1/0,T=-1/0;for(const x of n.getAll()){console.log("dentro del for, este es e node:",x);const{x:j,y:F}=Lt(x.position),W=Lt(x.dimensions.width),Y=Lt(x.dimensions.height);D=Math.min(D,j),C=Math.min(C,F),z=Math.max(z,j+W),T=Math.max(T,F+Y)}r.set({top:C,left:D,right:z,bottom:T}),y(),M&&(l=requestAnimationFrame(()=>k(M)))}return n.subscribe(()=>{console.log("dentro del nodes.subscribe...........Aqui no estan llegando los nodes"),k()}),is.subscribe(M=>{M&&k(M),M||cancelAnimationFrame(l)}),Vi.subscribe(M=>{M&&k(M),M||cancelAnimationFrame(l)}),e.subscribe(()=>{c=Lt(e),p=c.width/u,g=c.height/u,y()}),o.subscribe(()=>{u=Lt(o),p=c.width/u,g=c.height/u,y()}),a.subscribe(()=>{f=Lt(a),y()}),{graphBounds:i,nodeBounds:r}}function oc(n,e,o){const{width:a,height:i,top:r,left:l}=n,c={clientX:a/2,clientY:i/2};return To(c,r,l,a,i,o,e)}function al(n,e){const{zoom:o,editable:a,translation:i,direction:r,locked:l,edge:c,nodes:u}=e,f=J({x:(i==null?void 0:i.x)||0,y:(i==null?void 0:i.y)||0}),p=J({top:0,left:0,width:0,height:0,bottom:0,right:0}),g=J(o),y=J(!1),k=Eo(),M=nc(k,p,g,f),C=to([p,f,g],([z,T,x])=>oc(z,T,x));return{id:n,nodes:k,edges:Ah(),transforms:{translation:f,scale:g},maxZIndex:J(2),dimensions:p,bounds:M,center:C,mounted:y,direction:r||"LR",editable:a||!1,edge:c||null,editing:J(null),cursor:ic(ol,p,f,g),locked:J(l||!1),groups:J({selected:{parent:J(null),nodes:J(new Set)},hidden:{parent:J(null),nodes:J(new Set)}}),groupBoxes:Eo(),activeGroup:J(null),initialNodePositions:J([])}}const Yo=Eo(),wo={width:200,height:100};function Mo(n,e){return{x:Math.round(n/wo.width)*wo.width,y:Math.round(e/wo.height)*wo.height}}const Lo=10;function ll(n){const e=Lt(n);return Array.from(e).map(a=>Lt(a.position))}function sc(n,e){console.log("moveNodes called");let o;const a=Lt(n.groups),i=Lt(n.activeGroup);if(console.log("Graph Groups:",a),console.log("Active Group:",i),!i)return;const r=a[i].nodes;if(!r)return;const l=Lt(n.initialNodePositions),{x:c,y:u}=Lt(Ri),f=Array.from(Lt(r)),p=Lt(n.groupBoxes);console.log("Group Boxes:",p),f.forEach(y=>y.moving.set(!0)),g();function g(){const y=Lt(n.cursor);let k=y.x-c,M=y.y-u;if(e){const D=Mo(k,M);k=D.x,M=D.y}const C={x:k,y:M};f.forEach((D,z)=>{const{group:T,position:x}=D,j=l[z];let F;if(i==="selected"){const W=Lt(T);W&&(F=p.get(W))}if(!F)rc(j,C,x);else{const W=Lt(D.dimensions.width),Y=Lt(D.dimensions.height),st=cl(F,W,Y);hl(j,C,x,st)}}),Lt(Vi)?o=requestAnimationFrame(g):cancelAnimationFrame(o)}}function rc(n,e,o){o.set({x:n.x+e.x,y:n.y+e.y})}function hl(n,e,o,a){o.set({x:Math.min(Math.max(a.left,n.x+e.x),a.right),y:Math.min(Math.max(a.top,n.y+e.y),a.bottom)})}function cl(n,e,o){const{x:a,y:i}=Lt(n.position);return console.log("Group Box Position:",{x:a,y:i}),{left:a+Lo,right:a+Lt(n.dimensions.width)-e-Lo,top:i+Lo,bottom:i+Lt(n.dimensions.height)-o-Lo}}function Qs(n=1,e,o,a=.1){const i=Lt(e),{width:r,height:l,top:c,left:u}=i,f=o.scale,p=Lt(o.translation),g=Lt(f),y=rl(g,n,a),k=sl(g,y,p,{x:r/2+u,y:l/2+c},i);f.set(y),o.translation.set(k)}function ac(n,e,o,a,i,r,l,c,u,f,p,g){const{width:y,height:k}=i,{x:M,y:C}=a,D=Lt(e.position),z=J({x:M-D.x+y/2,y:C-D.y+k/2}),T=to([e.position,z],([ot,$])=>({x:ot.x+$.x,y:ot.y+$.y})),x=n.transforms,j=n.dimensions,F=J(u||"self"),W=()=>{const ot=document.getElementById(o),$=Lt(F),ct=Jn[$];if(!ot)return;const{x:N,y:lt,width:V,height:yt}=ot.getBoundingClientRect(),_t=Lt(z),U=Lt(T),{scaled:Z,scale:St}=qh(j,x,{x:N,y:lt}),at=Z.x-U.x,Mt=Z.y-U.y;z.set({x:_t.x+at+V/St/2+ct.x*V/St/2,y:_t.y+Mt+yt/St/2+ct.y*yt/St/2})},Y=to([e.moving,e.resizingWidth,e.resizingHeight,e.rotating],([ot,$,ct,N])=>ot||$||ct||N),st=to([e.rotation],([ot])=>ot);return{id:o,position:T,offset:z,direction:F,dynamic:J(f||!1),type:c,edge:l,moving:Y,mounted:J(!1),recalculatePosition:W,connected:J(new Set),store:r||null,inputKey:p||null,edgeColor:g||J(null),rotation:st,node:e}}function lc(n){var a,i;const e=JSON.parse(n);return al(e.id,{...e,editable:e.editable,direction:e.direction,locked:e.locked,zoom:((a=e.transforms)==null?void 0:a.scale)??1,translation:((i=e.transforms)==null?void 0:i.translation)??{x:0,y:0},edge:e.edge})}function hc(n){let e;const o=n[2].default,a=ke(o,n,n[1],null);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,[r]){a&&a.p&&(!e||r&2)&&Pe(a,o,i,i[1],e?Me(o,i[1],r,null):Ee(i[1]),null)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function cc(n,e,o){let{$$slots:a={},$$scope:i}=e,{edge:r}=e;return Oe("edge",r),n.$$set=l=>{"edge"in l&&o(0,r=l.edge),"$$scope"in l&&o(1,i=l.$$scope)},[r,i,a]}class ul extends Mi{constructor(e){super(),ki(this,e,cc,hc,di,{edge:0})}}const uc=n=>({hovering:n[0]&32768}),$s=n=>({destroy:n[9],hovering:n[15]}),dc=n=>({path:n[0]&4096,hovering:n[0]&32768}),tr=n=>({path:n[12],destroy:n[9],hovering:n[15]});function fc(n){let e,o,a,i,r,l=(n[0]||n[1])&&er(n);const c=n[91].default,u=ke(c,n,n[90],tr),f=u||_c(n);let p=n[10]&&ir(n);return{c(){e=qt("svg"),l&&l.c(),o=qt("path"),f&&f.c(),p&&p.c(),m(o,"role","presentation"),m(o,"id",n[38]+"-target"),m(o,"class","target svelte-ppcocz"),m(o,"d",n[12]),Vt(o,"cursor",n[38]==="cursor"||!n[4]&&!n[3]),ht(o,"cursor",n[4]||n[15]?"pointer":"move"),ht(o,"--prop-target-edge-color",n[4]||n[15]?n[8]||null:"transparent"),m(e,"class","edges-wrapper svelte-ppcocz"),ht(e,"z-index",n[17])},m(g,y){et(g,e,y),l&&l.m(e,null),w(e,o),n[94](o),f&&f.m(e,null),p&&p.m(e,null),n[95](e),a=!0,i||(r=[ft(o,"mousedown",function(){no(n[4])&&n[4].apply(this,arguments)}),ft(o,"mouseenter",n[92]),ft(o,"mouseleave",n[93])],i=!0)},p(g,y){n=g,n[0]||n[1]?l?l.p(n,y):(l=er(n),l.c(),l.m(e,o)):l&&(l.d(1),l=null),(!a||y[0]&4096)&&m(o,"d",n[12]),(!a||y[0]&24|y[1]&128)&&Vt(o,"cursor",n[38]==="cursor"||!n[4]&&!n[3]),y[0]&32784&&ht(o,"cursor",n[4]||n[15]?"pointer":"move"),y[0]&33040&&ht(o,"--prop-target-edge-color",n[4]||n[15]?n[8]||null:"transparent"),u?u.p&&(!a||y[0]&36864|y[2]&268435456)&&Pe(u,c,n,n[90],a?Me(c,n[90],y,dc):Ee(n[90]),tr):f&&f.p&&(!a||y[0]&1052711)&&f.p(n,a?y:[-1,-1,-1,-1]),n[10]?p?(p.p(n,y),y[0]&1024&&B(p,1)):(p=ir(n),p.c(),B(p,1),p.m(e,null)):p&&(ve(),G(p,1,1,()=>{p=null}),ye()),y[0]&131072&&ht(e,"z-index",n[17])},i(g){a||(B(f,g),B(p),a=!0)},o(g){G(f,g),G(p),a=!1},d(g){g&&Q(e),l&&l.d(),n[94](null),f&&f.d(g),p&&p.d(),n[95](null),i=!1,hi(r)}}}function er(n){let e,o,a,i,r;return{c(){e=qt("defs"),o=qt("marker"),a=qt("polygon"),i=qt("marker"),r=qt("polygon"),m(a,"class","arrow svelte-ppcocz"),m(a,"points","0 0, 15 5, 0 10"),ht(a,"--prop-edge-color",n[20]),m(o,"id",n[38]+"-end-arrow"),m(o,"viewBox","0 0 15 15"),m(o,"markerWidth","15"),m(o,"markerHeight","10"),m(o,"refX","12.5"),m(o,"refY","5"),m(o,"orient","auto"),m(r,"class","arrow svelte-ppcocz"),m(r,"points","0 5, 15 0, 15 10"),ht(r,"--prop-edge-color",n[20]),m(i,"id",n[38]+"-start-arrow"),m(i,"viewBox","0 0 15 15"),m(i,"markerWidth","15"),m(i,"markerHeight","10"),m(i,"refX","0"),m(i,"refY","5"),m(i,"orient","auto")},m(l,c){et(l,e,c),w(e,o),w(o,a),w(e,i),w(i,r)},p(l,c){c[0]&1048576&&ht(a,"--prop-edge-color",l[20]),c[0]&1048576&&ht(r,"--prop-edge-color",l[20])},d(l){l&&Q(e)}}}function _c(n){let e,o,a;return{c(){e=qt("path"),m(e,"id",n[38]),m(e,"class","edge svelte-ppcocz"),m(e,"d",n[12]),m(e,"marker-end",o=n[1]==="arrow"?`url(#${n[38]+"-end-arrow"})`:""),m(e,"marker-start",a=n[0]==="arrow"?`url(#${n[38]+"-start-arrow"})`:""),Vt(e,"animate",n[2]),ht(e,"--prop-edge-color",n[20]),ht(e,"--prop-stroke-width",n[5]?n[5]+"px":null)},m(i,r){et(i,e,r)},p(i,r){r[0]&4096&&m(e,"d",i[12]),r[0]&2&&o!==(o=i[1]==="arrow"?`url(#${i[38]+"-end-arrow"})`:"")&&m(e,"marker-end",o),r[0]&1&&a!==(a=i[0]==="arrow"?`url(#${i[38]+"-start-arrow"})`:"")&&m(e,"marker-start",a),r[0]&4&&Vt(e,"animate",i[2]),r[0]&1048576&&ht(e,"--prop-edge-color",i[20]),r[0]&32&&ht(e,"--prop-stroke-width",i[5]?i[5]+"px":null)},d(i){i&&Q(e)}}}function ir(n){let e,o,a,i,r;const l=n[91].label,c=ke(l,n,n[90],$s),u=c||pc(n);return{c(){e=qt("foreignObject"),o=S("span"),u&&u.c(),m(o,"class","label-wrapper svelte-ppcocz"),m(e,"x",a=n[14].x),m(e,"y",i=n[14].y),m(e,"width","100%"),m(e,"height","100%"),m(e,"class","svelte-ppcocz")},m(f,p){et(f,e,p),w(e,o),u&&u.m(o,null),r=!0},p(f,p){c?c.p&&(!r||p[0]&32768|p[2]&268435456)&&Pe(c,l,f,f[90],r?Me(l,f[90],p,uc):Ee(f[90]),$s):u&&u.p&&(!r||p[0]&2240)&&u.p(f,r?p:[-1,-1,-1,-1]),(!r||p[0]&16384&&a!==(a=f[14].x))&&m(e,"x",a),(!r||p[0]&16384&&i!==(i=f[14].y))&&m(e,"y",i)},i(f){r||(B(u,f),r=!0)},o(f){G(u,f),r=!1},d(f){f&&Q(e),u&&u.d(f)}}}function pc(n){let e,o;return{c(){e=S("div"),o=Ze(n[11]),m(e,"class","default-label svelte-ppcocz"),ht(e,"--prop-label-color",n[6]),ht(e,"--prop-label-text-color",n[7])},m(a,i){et(a,e,i),w(e,o)},p(a,i){i[0]&2048&&Ei(o,a[11]),i[0]&64&&ht(e,"--prop-label-color",a[6]),i[0]&128&&ht(e,"--prop-label-text-color",a[7])},d(a){a&&Q(e)}}}function mc(n){let e,o,a=n[23]&&n[24]&&fc(n);return{c(){a&&a.c(),e=Ie()},m(i,r){a&&a.m(i,r),et(i,e,r),o=!0},p(i,r){i[23]&&i[24]&&a.p(i,r)},i(i){o||(B(a),o=!0)},o(i){G(a),o=!1},d(i){i&&Q(e),a&&a.d(i)}}}let Xo;function gc(n){const e=n.parentNode;if(!e)return;e.removeChild(n);const o=document.querySelector(".svelvet-graph-wrapper");o&&o.appendChild(n)}function vc(n,e,o){var Yi,on;let a,i,r,l,c,u,f,p,g,y,k,M,C,D,z,T,x,j,F,W,Y,st,ot,$,ct,N,lt,V,yt,_t,U,Z,St=Gt,at=()=>(St(),St=gi(yt,mt=>o(73,Z=mt)),yt),Mt,Ct=Gt,wt=()=>(Ct(),Ct=gi(V,mt=>o(74,Mt=mt)),V),H,q,X,I,Ft,$t,dt,Dt,zt,xt,le,ue,pe,it,te=Gt,Qt=()=>(te(),te=gi(r,mt=>o(88,it=mt)),r),Ot,Wt=Gt,be=()=>(Wt(),Wt=gi(i,mt=>o(89,Ot=mt)),i);n.$$.on_destroy.push(()=>St()),n.$$.on_destroy.push(()=>Ct()),n.$$.on_destroy.push(()=>te()),n.$$.on_destroy.push(()=>Wt());let{$$slots:Ne={},$$scope:fe}=e;const Kt=rs(Ne),Ht=de("edgeStore"),Jt=de("edgeStyle"),ne=de("endStyles"),We=de("raiseEdgesOnSelect"),De=de("edgesAboveNode");let{edge:ze=de("edge")}=e,{straight:He=Jt==="straight"}=e,{step:he=Jt==="step"}=e,{start:$e=ne[0]}=e,{end:vi=ne[1]}=e,{animate:we=!1}=e,{label:Le=""}=e,{enableHover:It=!1}=e,{edgeClick:fi=null}=e,{labelPosition:Ae=.5}=e,{width:ci=null}=e,{color:Re=null}=e,{labelColor:ui=null}=e,{textColor:Ce=null}=e,{cornerRadius:ti=8}=e,{targetColor:_i=null}=e;const _e=ze.source,ce=ze.target,je=_e.direction;bt(n,je,mt=>o(76,q=mt));const Ve=ce.direction;bt(n,Ve,mt=>o(75,H=mt));const yi=_e.rotation;bt(n,yi,mt=>o(83,zt=mt));const Si=ce.rotation;bt(n,Si,mt=>o(82,Dt=mt));const Ci=_e.position;bt(n,Ci,mt=>o(87,pe=mt));const Je=ce.position;bt(n,Je,mt=>o(86,ue=mt));const Pt=_e.dynamic;bt(n,Pt,mt=>o(79,Ft=mt));const ei=ce.dynamic;bt(n,ei,mt=>o(78,I=mt));const ii=_e.moving;bt(n,ii,mt=>o(81,dt=mt));const ni=ce.moving;bt(n,ni,mt=>o(80,$t=mt));const pi=(Yi=_e.node)==null?void 0:Yi.position;bt(n,pi,mt=>o(85,le=mt));const b=(on=ce.node)==null?void 0:on.position;bt(n,b,mt=>o(84,xt=mt));const pt=ze.type;bt(n,pt,mt=>o(77,X=mt));const Et=ze.id;let kt,At,A={x:0,y:0},Xt=!1,oe=!1,Yt=!1,me=!1,Fe=!1,oi;ze.rendered.set(!0),qi(()=>{setTimeout(()=>{At&&o(14,A=Vo(At,Ae))},0),gc(oi)}),Ka(()=>{At&&o(14,A=Vo(At,Ae))}),oo(()=>{oi.remove(),cancelAnimationFrame(Xo)});function si(){Xt&&(At&&o(14,A=Vo(At,Ae)),Xo=requestAnimationFrame(si))}function Zi(){if(_e.id===null||ce.id===null)return;const mt=Ht.match(_e,ce);Ht.delete(mt[0]),_e==null||_e.connected.update(Bt=>(ce&&Bt.delete(ce),Bt)),ce==null||ce.connected.update(Bt=>(_e&&Bt.delete(_e),Bt))}const Hi=()=>o(15,Fe=!0),Ki=()=>o(15,Fe=!1);function Di(mt){nn[mt?"unshift":"push"](()=>{At=mt,o(13,At)})}function Oi(mt){nn[mt?"unshift":"push"](()=>{oi=mt,o(16,oi)})}return n.$$set=mt=>{"edge"in mt&&o(39,ze=mt.edge),"straight"in mt&&o(40,He=mt.straight),"step"in mt&&o(41,he=mt.step),"start"in mt&&o(0,$e=mt.start),"end"in mt&&o(1,vi=mt.end),"animate"in mt&&o(2,we=mt.animate),"label"in mt&&o(42,Le=mt.label),"enableHover"in mt&&o(3,It=mt.enableHover),"edgeClick"in mt&&o(4,fi=mt.edgeClick),"labelPosition"in mt&&o(43,Ae=mt.labelPosition),"width"in mt&&o(5,ci=mt.width),"color"in mt&&o(44,Re=mt.color),"labelColor"in mt&&o(6,ui=mt.labelColor),"textColor"in mt&&o(7,Ce=mt.textColor),"cornerRadius"in mt&&o(45,ti=mt.cornerRadius),"targetColor"in mt&&o(8,_i=mt.targetColor),"$$scope"in mt&&o(90,fe=mt.$$scope)},n.$$.update=()=>{var mt;if(n.$$.dirty[2]&196608&&o(55,a=Ft||I),n.$$.dirty[1]&256&&Qt(o(21,r=(mt=ze.label)==null?void 0:mt.text)),n.$$.dirty[1]&8192|n.$$.dirty[2]&134217728&&o(20,l=Re||Ot||null),n.$$.dirty[1]&2048|n.$$.dirty[2]&67108864&&o(11,c=Le||it||""),n.$$.dirty[0]&2048&&o(10,u=c||Kt.label),n.$$.dirty[2]&33554432&&o(72,f=pe),n.$$.dirty[2]&16777216&&o(71,p=ue),n.$$.dirty[2]&8388608&&o(56,g=le),n.$$.dirty[2]&4194304&&o(57,y=xt),n.$$.dirty[2]&1024&&o(52,k=f.x),n.$$.dirty[2]&1024&&o(51,M=f.y),n.$$.dirty[2]&512&&o(54,C=p.x),n.$$.dirty[2]&512&&o(53,D=p.y),n.$$.dirty[1]&10485760&&o(70,z=C-k),n.$$.dirty[1]&5242880&&o(69,T=D-M),n.$$.dirty[2]&256&&o(68,x=Math.abs(z)),n.$$.dirty[2]&128&&o(67,j=Math.abs(T)),n.$$.dirty[2]&64&&o(65,F=Math.max(30,Math.min(600,x/2))),n.$$.dirty[2]&32&&o(63,W=Math.max(30,Math.min(600,j/2))),n.$$.dirty[1]&117833728&&a&&_e.node&&ce.node){const Bt=y.x-g.x,se=y.y-g.y;o(48,Yt=se>0),o(49,me=Bt>0);let Pi,ri;if(Yt){const Ge=Lt(_e.node.dimensions.height),Te=g.y+Ge;Pi=y.y-Te}else{const Ge=Lt(ce.node.dimensions.height),Te=y.y+Ge;Pi=g.y-Te}if(me){const Ge=Lt(_e.node.dimensions.width),Te=g.x+Ge;ri=y.x-Te}else{const Ge=Lt(ce.node.dimensions.width),Te=y.x+Ge;ri=g.x-Te}o(47,oe=Pi>ri)}if(n.$$.dirty[1]&17235968|n.$$.dirty[2]&196608&&a){let Bt,se;oe?(Bt=Yt?"south":"north",se=Yt?"north":"south"):(Bt=me?"east":"west",se=me?"west":"east"),Ft&&Nt(je,q=Bt,q),I&&Nt(Ve,H=se,H)}if(n.$$.dirty[2]&2113536&&o(66,Y=Js(Jn[q],zt||0)),n.$$.dirty[2]&1056768&&o(64,st=Js(Jn[H],Dt||0)),n.$$.dirty[1]&2097152|n.$$.dirty[2]&24&&o(62,ot=k+Y.x*F),n.$$.dirty[1]&1048576|n.$$.dirty[2]&18&&o(61,$=M+Y.y*W),n.$$.dirty[1]&8388608|n.$$.dirty[2]&12&&o(60,ct=C+st.x*F),n.$$.dirty[1]&4194304|n.$$.dirty[2]&6&&o(59,N=D+st.y*W),n.$$.dirty[1]&1879048192|n.$$.dirty[2]&1&&o(58,lt=`C ${ot}, ${$} ${ct}, ${N}`),n.$$.dirty[1]&149947904|n.$$.dirty[2]&32768&&(!he||Et==="cursor"||X==="bezier")&&o(12,kt=`M ${k}, ${M} ${He?"":lt} ${C}, ${D}`),n.$$.dirty[0]&1024|n.$$.dirty[1]&32768|n.$$.dirty[2]&786432&&(u&&!Xt&&(dt||$t||Et==="cursor")?(o(46,Xt=!0),si()):Xt&&!dt&&!$t&&Et!=="cursor"&&(o(46,Xt=!1),cancelAnimationFrame(Xo))),n.$$.dirty[1]&15746048|n.$$.dirty[2]&57344&&he&&Et!=="cursor"&&!(X&&X==="bezier")){const Bt={x:k,y:M,direction:Jn[q]},se={x:C,y:D,direction:Jn[H]},Pi=Qh(Bt,se,Oh),ri=(Ge,Te,Rt)=>{if(Te<Pi.length-1){const xe=Uh(Ge,Pi[Te+1]);return Wh(Rt,xe)}return""};o(12,kt=Pi.reduce((Ge,Te,Rt)=>{const xe=Math.sign(Te.x),ji=Math.sign(Te.y);let Ji=Te.x,ai=Te.y,sn="";if(ti){const Ye=Pi[Rt+1]||{x:0,y:0},Ii=Pi[Rt-1]||{x:0,y:0},Ue=bo(Te.x,Ye.x,ti),Fi=bo(Ye.y,Te.y,ti),Gi=bo(Ii.x,Te.x,ti),bi=bo(Ii.y,Te.y,ti),li=Math.min(Gi,bi),Ui=Math.min(Ue,Fi);Te.x?Ji=Te.x-(Ui+li)*xe:ai=Te.y-(Ui+li)*ji,sn=ri(Te,Rt,Ui)}return Vh(Ge,Ji,ai,sn)},`M ${k}, ${M}`))}n.$$.dirty[2]&6144&&o(50,_t=Math.max(Mt,Z)),n.$$.dirty[1]&524288|n.$$.dirty[2]&6144&&o(17,U=De==="all"?1e5:De?_t:We===!0?_t-1:We==="source"?Mt-1:We==="target"?Z-1:0)},be(o(22,i=(_e==null?void 0:_e.edgeColor)||(ce==null?void 0:ce.edgeColor)||null)),wt(o(19,V=_e.node.zIndex||0)),at(o(18,yt=ce.node.zIndex||0)),[$e,vi,we,It,fi,ci,ui,Ce,_i,Zi,u,c,kt,At,A,Fe,oi,U,yt,V,l,r,i,_e,ce,je,Ve,yi,Si,Ci,Je,Pt,ei,ii,ni,pi,b,pt,Et,ze,He,he,Le,Ae,Re,ti,Xt,oe,Yt,me,_t,M,k,D,C,a,g,y,lt,N,ct,$,ot,W,st,F,Y,j,x,T,z,p,f,Z,Mt,H,q,X,I,Ft,$t,dt,Dt,zt,xt,le,ue,pe,it,Ot,fe,Ne,Hi,Ki,Di,Oi]}class dl extends Mi{constructor(e){super(),ki(this,e,vc,mc,di,{edge:39,straight:40,step:41,start:0,end:1,animate:2,label:42,enableHover:3,edgeClick:4,labelPosition:43,width:5,color:44,labelColor:6,textColor:7,cornerRadius:45,targetColor:8,destroy:9},null,[-1,-1,-1,-1])}get destroy(){return this.$$.ctx[9]}}function yc(n){let e;return{c(){e=S("div"),m(e,"class","svelvet-anchor svelte-19t6skv"),Vt(e,"output",n[0]),Vt(e,"input",n[1]),Vt(e,"connected",n[3]),Vt(e,"connecting",n[2]),Vt(e,"hovering",n[4]),ht(e,"--prop-anchor-color",n[5])},m(o,a){et(o,e,a)},p(o,[a]){a&1&&Vt(e,"output",o[0]),a&2&&Vt(e,"input",o[1]),a&8&&Vt(e,"connected",o[3]),a&4&&Vt(e,"connecting",o[2]),a&16&&Vt(e,"hovering",o[4]),a&32&&ht(e,"--prop-anchor-color",o[5])},i:Gt,o:Gt,d(o){o&&Q(e)}}}function bc(n,e,o){let{output:a}=e,{input:i}=e,{connecting:r}=e,{connected:l}=e,{hovering:c}=e,{bgColor:u}=e;return n.$$set=f=>{"output"in f&&o(0,a=f.output),"input"in f&&o(1,i=f.input),"connecting"in f&&o(2,r=f.connecting),"connected"in f&&o(3,l=f.connected),"hovering"in f&&o(4,c=f.hovering),"bgColor"in f&&o(5,u=f.bgColor)},[a,i,r,l,c,u]}class wc extends Mi{constructor(e){super(),ki(this,e,bc,yc,di,{output:0,input:1,connecting:2,connected:3,hovering:4,bgColor:5})}}const Lc=n=>({}),nr=n=>({});function or(n){const e=n.slice(),o=e[7].component;return e[86]=o,e}function qo(n){const e=n.slice(),o=e[14].get("cursor");return e[7]=o,e}function sr(n,e,o){const a=n.slice();a[87]=e[o];const i=a[14].fetch(a[23],a[87]);return a[7]=i,a}const kc=n=>({}),rr=n=>({});function Ko(n){const e=n.slice(),o=e[7].component;return e[86]=o,e}const Mc=n=>({linked:n[0]&512,hovering:n[0]&1024,connecting:n[0]&2048}),ar=n=>{var e;return{linked:((e=n[9])==null?void 0:e.size)>=1,hovering:n[10],connecting:n[11]}};function lr(n){var a;let e,o;return e=new wc({props:{output:n[2],input:n[1],connecting:n[11],hovering:n[10],bgColor:n[0],connected:((a=n[9])==null?void 0:a.size)>=1}}),{c(){ae(e.$$.fragment)},m(i,r){ee(e,i,r),o=!0},p(i,r){var c;const l={};r[0]&4&&(l.output=i[2]),r[0]&2&&(l.input=i[1]),r[0]&2048&&(l.connecting=i[11]),r[0]&1024&&(l.hovering=i[10]),r[0]&1&&(l.bgColor=i[0]),r[0]&512&&(l.connected=((c=i[9])==null?void 0:c.size)>=1),e.$set(l)},i(i){o||(B(e.$$.fragment,i),o=!0)},o(i){G(e.$$.fragment,i),o=!1},d(i){ie(e,i)}}}function Pc(n){let e,o,a=!n[5]&&lr(n);return{c(){a&&a.c(),e=Ie()},m(i,r){a&&a.m(i,r),et(i,e,r),o=!0},p(i,r){i[5]?a&&(ve(),G(a,1,1,()=>{a=null}),ye()):a?(a.p(i,r),r[0]&32&&B(a,1)):(a=lr(i),a.c(),B(a,1),a.m(e.parentNode,e))},i(i){o||(B(a),o=!0)},o(i){G(a),o=!1},d(i){i&&Q(e),a&&a.d(i)}}}function hr(n){let e,o;return e=new ul({props:{edge:n[7],$$slots:{default:[Sc]},$$scope:{ctx:n}}}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},p(a,i){const r={};i[0]&512&&(r.edge=a[7]),i[0]&512|i[1]&8388608&&(r.$$scope={dirty:i,ctx:a}),e.$set(r)},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function Ec(n){let e,o;return e=new dl({}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function Cc(n){let e,o;return e=new n[86]({}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function Tc(n){let e,o,a,i;const r=[Cc,Ec],l=[];function c(u,f){return u[86]?0:1}return e=c(n),o=l[e]=r[e](n),{c(){o.c(),a=Ie()},m(u,f){l[e].m(u,f),et(u,a,f),i=!0},p(u,f){let p=e;e=c(u),e!==p&&(ve(),G(l[p],1,1,()=>{l[p]=null}),ye(),o=l[e],o||(o=l[e]=r[e](u),o.c()),B(o,1),o.m(a.parentNode,a))},i(u){i||(B(o),i=!0)},o(u){G(o),i=!1},d(u){u&&Q(a),l[e].d(u)}}}function Sc(n){let e;const o=n[50].edge,a=ke(o,n,n[54],rr),i=a||Tc(n);return{c(){i&&i.c()},m(r,l){i&&i.m(r,l),e=!0},p(r,l){a?a.p&&(!e||l[1]&8388608)&&Pe(a,o,r,r[54],e?Me(o,r[54],l,kc):Ee(r[54]),rr):i&&i.p&&(!e||l[0]&512)&&i.p(r,e?l:[-1,-1,-1])},i(r){e||(B(i,r),e=!0)},o(r){G(i,r),e=!1},d(r){i&&i.d(r)}}}function cr(n,e){let o,a,i,r=e[7]&&e[7].source===e[23]&&hr(Ko(e));return{key:n,first:null,c(){o=Ie(),r&&r.c(),a=Ie(),this.first=o},m(l,c){et(l,o,c),r&&r.m(l,c),et(l,a,c),i=!0},p(l,c){e=l,e[7]&&e[7].source===e[23]?r?(r.p(Ko(e),c),c[0]&512&&B(r,1)):(r=hr(Ko(e)),r.c(),B(r,1),r.m(a.parentNode,a)):r&&(ve(),G(r,1,1,()=>{r=null}),ye())},i(l){i||(B(r),i=!0)},o(l){G(r),i=!1},d(l){l&&(Q(o),Q(a)),r&&r.d(l)}}}function ur(n){let e,o,a=n[7]&&Dc(or(n));return{c(){a&&a.c(),e=Ie()},m(i,r){a&&a.m(i,r),et(i,e,r),o=!0},p(i,r){i[7]&&a.p(or(i),r)},i(i){o||(B(a),o=!0)},o(i){G(a),o=!1},d(i){i&&Q(e),a&&a.d(i)}}}function Dc(n){let e,o;return e=new ul({props:{edge:n[7],$$slots:{default:[Ac]},$$scope:{ctx:n}}}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},p(a,i){const r={};i[1]&8388608&&(r.$$scope={dirty:i,ctx:a}),e.$set(r)},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function zc(n){let e,o;return e=new dl({}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function Oc(n){let e,o;return e=new n[86]({}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function Ic(n){let e,o,a,i;const r=[Oc,zc],l=[];function c(u,f){return u[86]?0:1}return e=c(n),o=l[e]=r[e](n),{c(){o.c(),a=Ie()},m(u,f){l[e].m(u,f),et(u,a,f),i=!0},p:Gt,i(u){i||(B(o),i=!0)},o(u){G(o),i=!1},d(u){u&&Q(a),l[e].d(u)}}}function Ac(n){let e;const o=n[50].edge,a=ke(o,n,n[54],nr),i=a||Ic(n);return{c(){i&&i.c()},m(r,l){i&&i.m(r,l),e=!0},p(r,l){a&&a.p&&(!e||l[1]&8388608)&&Pe(a,o,r,r[54],e?Me(o,r[54],l,Lc):Ee(r[54]),nr)},i(r){e||(B(i,r),e=!0)},o(r){G(i,r),e=!1},d(r){i&&i.d(r)}}}function xc(n){let e,o,a,i=[],r=new Map,l,c,u,f,p;const g=n[50].default,y=ke(g,n,n[54],ar),k=y||Pc(n);let M=Se(Array.from(n[9]));const C=z=>z[87].id;for(let z=0;z<M.length;z+=1){let T=sr(n,M,z),x=C(T);r.set(x,i[z]=cr(x,T))}let D=n[11]&&ur(qo(n));return{c(){var z;e=S("div"),k&&k.c(),a=K();for(let T=0;T<i.length;T+=1)i[T].c();l=K(),D&&D.c(),c=Ie(),m(e,"id",(z=n[23])==null?void 0:z.id),m(e,"class","anchor-wrapper svelte-bazd6o"),m(e,"role","button"),m(e,"tabindex","0"),m(e,"title",o=n[6]||""),Vt(e,"locked",n[4])},m(z,T){et(z,e,T),k&&k.m(e,null),n[53](e),et(z,a,T);for(let x=0;x<i.length;x+=1)i[x]&&i[x].m(z,T);et(z,l,T),D&&D.m(z,T),et(z,c,T),u=!0,f||(p=[ft(e,"mouseenter",n[51]),ft(e,"mouseleave",n[52]),ft(e,"mousedown",en(Xi(n[25]))),ft(e,"mouseup",en(n[24])),ft(e,"touchstart",en(Xi(n[25]))),ft(e,"touchend",en(n[24]))],f=!0)},p(z,T){y?y.p&&(!u||T[0]&3584|T[1]&8388608)&&Pe(y,g,z,z[54],u?Me(g,z[54],T,Mc):Ee(z[54]),ar):k&&k.p&&(!u||T[0]&3623)&&k.p(z,u?T:[-1,-1,-1]),(!u||T[0]&64&&o!==(o=z[6]||""))&&m(e,"title",o),(!u||T[0]&16)&&Vt(e,"locked",z[4]),T[0]&8405504|T[1]&8388608&&(M=Se(Array.from(z[9])),ve(),i=vn(i,T,C,1,z,M,r,l.parentNode,io,cr,l,sr),ye()),z[11]?D?(D.p(qo(z),T),T[0]&2048&&B(D,1)):(D=ur(qo(z)),D.c(),B(D,1),D.m(c.parentNode,c)):D&&(ve(),G(D,1,1,()=>{D=null}),ye())},i(z){if(!u){B(k,z);for(let T=0;T<M.length;T+=1)B(i[T]);B(D),u=!0}},o(z){G(k,z);for(let T=0;T<i.length;T+=1)G(i[T]);G(D),u=!1},d(z){z&&(Q(e),Q(a),Q(l),Q(c)),k&&k.d(z),n[53](null);for(let T=0;T<i.length;T+=1)i[T].d(z);D&&D.d(z),f=!1,hi(p)}}}let Jo;const dn=J(null);function Nc(n,e,o){if(e==="self")return;const a=n.parentNode;if(!a)return;a.removeChild(n);const i=document.querySelector(`#anchors-${e}-${o.id}`);i&&(i.appendChild(n),n&&o.recalculateAnchors())}function Bc(n,e,o){let a,i,r,l,c=Gt,u=()=>(c(),c=gi(dt,b=>o(55,l=b)),dt),f,p=Gt,g,y,k=Gt,M=()=>(k(),k=gi(i,b=>o(9,y=b)),i),C,D,z,T,x=Gt,j=()=>(x(),x=gi(r,b=>o(47,T=b)),r),F,W,Y,st;bt(n,dn,b=>o(42,f=b)),n.$$.on_destroy.push(()=>c()),n.$$.on_destroy.push(()=>p()),n.$$.on_destroy.push(()=>k()),n.$$.on_destroy.push(()=>x());let{$$slots:ot={},$$scope:$}=e;const ct=de("dynamic"),N=de("node"),lt=de("edgeStore"),V=de("cursorAnchor"),yt=de("direction"),_t=de("mounted");bt(n,_t,b=>o(49,W=b));const U=de("graph"),Z=de("nodeStore"),St=de("graphEdge"),at=de("nodeConnectEvent");bt(n,at,b=>o(43,g=b));const Mt=de("anchorsMounted");bt(n,Mt,b=>o(56,Y=b));const Ct=de("flowchart")||void 0;let{bgColor:wt=null}=e,{id:H=0}=e,{input:q=!1}=e,{output:X=!1}=e,{multiple:I=X?!0:!q}=e,{dynamic:Ft=ct||!1}=e,{edge:$t=null}=e,{inputsStore:dt=null}=e;u();let{key:Dt=null}=e,{outputStore:zt=null}=e,{connections:xt=[]}=e,{edgeColor:le=J(null)}=e,{edgeLabel:ue=""}=e,{locked:pe=!1}=e,{nodeConnect:it=!1}=e,{edgeStyle:te=null}=e,{endStyles:Qt=[null,null]}=e,{invisible:Ot=!1}=e,{direction:Wt=yt==="TD"?q?"north":"south":q?"west":"east"}=e,{title:be=""}=e;const Ne=Fn(),fe=Fn();let Kt,Ht=!1,Jt=!1,ne=0,We=q===X?null:q?"input":"output",De=[];const ze=N.edge,He=N.anchors;bt(n,He,b=>o(48,F=b));const he=N.resizingWidth;bt(n,he,b=>o(46,z=b));const $e=N.resizingHeight;bt(n,$e,b=>o(45,D=b));const vi=N.rotating;bt(n,vi,b=>o(44,C=b));const we=N.connections;bt(n,we,b=>o(57,st=b));const Le=`A-${H||He.count()+1}/${N.id}`,It=ac(U,N,Le,{x:0,y:0},{width:0,height:0},dt||zt||null,$t||ze||St||null,We,Wt,Ft,Dt,le);He.add(It,It.id),qi(()=>{Kt&&It.recalculatePosition();const b=Array.from(Lt(N.anchors)).reduce((pt,[,Et])=>(Et.type==="output"&&pt++,pt),0);if(st!=null&&st.length&&!q){const pt=[];let Et=null;st.forEach((kt,At)=>{kt&&(Et===null&&(Et=At),(At-Et)%b===0?(De.push(kt),pt.push(null)):pt.push(kt))}),Nt(we,st=pt,st)}Nt(Mt,Y++,Y)}),Ka(()=>{Kt&&It.recalculatePosition()}),oo(()=>{yi(),cancelAnimationFrame(Jo)});function fi(b){var oe;lt.delete("cursor");const pt={x:b.changedTouches[0].clientX,y:b.changedTouches[0].clientY},Et=document.elementFromPoint(pt.x,pt.y);if(!Et)return;const kt=Et.parentElement;if(!kt)return;const At=kt.id,A=At.split("/")[1],Xt=(oe=Z.get(A))==null?void 0:oe.anchors.get(At);Xt&&(lt.delete("cursor"),Ae(It,Xt,b))}function Ae(b,pt,Et){const kt=_i(b,pt);kt&&_e(),Et.shiftKey||je(kt)}function ci(b){if("changedTouches"in b&&a){fi(b);return}if(!a){if(y!=null&&y.size&&!I){lt.delete("cursor"),b.shiftKey||je(!1);return}f&&ti(b)}}function Re(b){if(!pe){if(y!=null&&y.size&&!I&&!f)return Si();if(!f)return ui();ti(b)}}function ui(){q===X?(Nt(dn,f={anchor:It,store:null,key:null},f),Ce(It,V)):q?(Nt(dn,f={anchor:It,store:dt,key:Dt},f),Ce(V,It)):X&&(Nt(dn,f={anchor:It,store:zt,key:null},f),Ce(It,V))}function Ce(b,pt,Et=!1){const kt={color:le,label:{text:ue}};Et&&(kt.disconnect=!0),te&&(kt.type=te),Qt[0]&&(kt.start=Qt[0]),Qt[1]&&(kt.start=Qt[1]);const At=Xs({source:b,target:pt},(b==null?void 0:b.edge)||null,kt);lt.add(At,"cursor")}function ti(b){if(lt.delete("cursor"),!f)return;const pt=f.anchor.type;if(f.anchor===It||pt===It.type&&pt){je(!1);return}It.recalculatePosition();let Et,kt;q===X?pt==="input"?(Et=It,kt=f.anchor):(Et=f.anchor,kt=It):q?(Et=f.anchor,kt=It):(Et=It,kt=f.anchor),Ae(Et,kt,b)}function _i(b,pt){if(b===pt||Lt(b.connected).has(It))return!1;const Et={color:le,label:{text:ue}};if(Ct){const At=b.node.id.slice(2),A=Ct.nodeList[At];if(A){const Xt=pt.node.id.slice(2),oe=A.children.filter(Yt=>Yt.node.id===Xt)[0];if(oe){const Yt=oe;Et.label={text:Yt.content}}}}te&&(Et.type=te),Qt[0]&&(Et.start=Qt[0]),Qt[1]&&(Et.start=Qt[1]);const kt=Xs({source:b,target:pt},(b==null?void 0:b.edge)||null,Et);return!b.node||!pt.node?!1:(lt.add(kt,new Set([b,pt,b.node,pt.node])),!0)}function _e(){if(q&&f&&f.store)l&&Dt&&dt&&typeof dt.set=="function"&&typeof dt.update=="function"&&Nt(dt,l[Dt]=f.store,l);else if(X&&f&&f.store){const{store:b,key:pt}=f;b&&pt&&typeof b.update=="function"&&b.update(Et=>(zt&&(Et[pt]=zt),Et))}}function ce(){l&&Dt&&l[Dt]&&Nt(dt,l[Dt]=J(Lt(l[Dt])),l)}function je(b){(b||!g)&&(Nt(dn,f=null,f),Nt(at,g=null,g))}function Ve(){Ht&&(Kt&&It.recalculatePosition(),Jo=requestAnimationFrame(Ve))}function yi(){lt.delete("cursor"),lt.match(It).forEach(pt=>lt.delete(pt)),je(!1),ce()}function Si(){if(Lt(It.connected).size>1)return;const b=Array.from(Lt(It.connected))[0];if(b.type!=="input")if(yi(),b.type==="output"){Ce(b,V,!0),ce();const pt=b.store;Nt(dn,f={anchor:b,store:pt,key:null},f)}else Ce(b,V,!0),Nt(dn,f={anchor:b,store:null,key:null},f)}function Ci(){De.forEach((b,pt)=>{if(!b)return;ei(b)&&o(26,xt[pt]=null,xt)}),o(41,De=De.filter(b=>b!==null))}function Je(){xt.forEach(b=>{b&&ei(b)})}function Pt(b){const pt=`N-${b[0]}`,Et=Z.get(pt);if(!Et)return;const kt=Et.anchors.get(`A-${b[1]}/N-${b[0]}`);if(!kt)return;const At=lt.match(It,kt);At&&lt.delete(At[0])}const ei=b=>{let pt,Et,kt=null;Array.isArray(b)?(pt=b[0].toString(),Et=b[1].toString()):(pt=b.toString(),Et=null);const At=`N-${pt}`,A=Z.get(At);if(!A)return!1;if(Et){const Xt=`A-${Et}/${At}`;kt=A.anchors.get(Xt)||null}else{const Xt=Lt(A.anchors),oe=Array.from(Xt.values());if(!oe.length)return!1;kt=oe.reduce((Yt,me)=>!Yt&&me.type==="output"?null:me.type==="output"?Yt:!Yt||Lt(me.connected).size<Lt(Yt.connected).size?me:Yt,null)}if(!kt)return!1;if(_i(It,kt),kt.store&&(dt||zt)){if(q&&kt.type==="output")l&&Dt&&dt&&typeof dt.set=="function"&&typeof dt.update=="function"&&Nt(dt,l[Dt]=kt.store,l);else if(X&&kt.type==="input"){const{store:Xt,inputKey:oe}=kt;Xt&&oe&&typeof Xt.update=="function"&&Xt.update(Yt=>(zt&&(Yt[oe]=zt),Yt))}}return!0},ii=()=>o(10,Jt=!0),ni=()=>o(10,Jt=!1);function pi(b){nn[b?"unshift":"push"](()=>{Kt=b,o(8,Kt)})}return n.$$set=b=>{"bgColor"in b&&o(0,wt=b.bgColor),"id"in b&&o(27,H=b.id),"input"in b&&o(1,q=b.input),"output"in b&&o(2,X=b.output),"multiple"in b&&o(28,I=b.multiple),"dynamic"in b&&o(29,Ft=b.dynamic),"edge"in b&&o(7,$t=b.edge),"inputsStore"in b&&u(o(3,dt=b.inputsStore)),"key"in b&&o(30,Dt=b.key),"outputStore"in b&&o(31,zt=b.outputStore),"connections"in b&&o(26,xt=b.connections),"edgeColor"in b&&o(32,le=b.edgeColor),"edgeLabel"in b&&o(33,ue=b.edgeLabel),"locked"in b&&o(4,pe=b.locked),"nodeConnect"in b&&o(34,it=b.nodeConnect),"edgeStyle"in b&&o(35,te=b.edgeStyle),"endStyles"in b&&o(36,Qt=b.endStyles),"invisible"in b&&o(5,Ot=b.invisible),"direction"in b&&o(37,Wt=b.direction),"title"in b&&o(6,be=b.title),"$$scope"in b&&o(54,$=b.$$scope)},n.$$.update=()=>{if(n.$$.dirty[1]&2048&&o(11,a=(f==null?void 0:f.anchor)===It),n.$$.dirty[0]&536871168|n.$$.dirty[1]&65536&&Ft&&Kt&&Nc(Kt,T,N),n.$$.dirty[0]&67108864|n.$$.dirty[1]&262144&&W===Z.count()&&xt.length&&Je(),n.$$.dirty[1]&4104&&it&&g&&ci(g),n.$$.dirty[1]&263168&&W===Z.count()&&De.length&&Ci(),n.$$.dirty[0]&768|n.$$.dirty[1]&196608&&Kt&&It.recalculatePosition(),n.$$.dirty[1]&57600&&(!Ht&&(z||D||C)?(o(39,Ht=!0),Ve()):!z&&!D&&Ht&&!C&&(o(39,Ht=!1),cancelAnimationFrame(Jo))),n.$$.dirty[0]&512|n.$$.dirty[1]&512&&y){if(y.size<ne)fe("disconnection",{node:N,anchor:It});else if(y.size>ne){const b=Array.from(y),pt=b[b.length-1];Ne("connection",{node:N,anchor:It,connectedNode:pt.node,connectedAnchor:pt})}o(40,ne=y.size)}},M(o(13,i=It&&It.connected)),j(o(12,r=It==null?void 0:It.direction)),[wt,q,X,dt,pe,Ot,be,$t,Kt,y,Jt,a,r,i,lt,_t,at,Mt,He,he,$e,vi,we,It,ci,Re,xt,H,I,Ft,Dt,zt,le,ue,it,te,Qt,Wt,Pt,Ht,ne,De,f,g,C,D,z,T,F,W,ot,ii,ni,pi,$]}class So extends Mi{constructor(e){super(),ki(this,e,Bc,xc,di,{bgColor:0,id:27,input:1,output:2,multiple:28,dynamic:29,edge:7,inputsStore:3,key:30,outputStore:31,connections:26,edgeColor:32,edgeLabel:33,locked:4,nodeConnect:34,edgeStyle:35,endStyles:36,invisible:5,direction:37,title:6,disconnect:38},null,[-1,-1,-1])}get disconnect(){return this.$$.ctx[38]}}function dr(n){let e,o,a,i,r;return{c(){e=S("div"),o=K(),a=S("div"),m(e,"class","left svelte-1ryxg7v"),Vt(e,"width",n[0]),m(a,"class","right svelte-1ryxg7v"),Vt(a,"width",n[0])},m(l,c){et(l,e,c),et(l,o,c),et(l,a,c),i||(r=[kn(n[16].call(null,e,{left:n[3]})),kn(n[16].call(null,a,{right:n[4]}))],i=!0)},p(l,c){c[0]&1&&Vt(e,"width",l[0]),c[0]&1&&Vt(a,"width",l[0])},d(l){l&&(Q(e),Q(o),Q(a)),i=!1,hi(r)}}}function fr(n){let e,o,a,i,r;return{c(){e=S("div"),o=K(),a=S("div"),m(e,"class","top svelte-1ryxg7v"),Vt(e,"height",n[1]),m(a,"class","bottom svelte-1ryxg7v"),Vt(a,"height",n[1])},m(l,c){et(l,e,c),et(l,o,c),et(l,a,c),i||(r=[kn(n[16].call(null,e,{top:n[5]})),kn(n[16].call(null,a,{bottom:n[6]}))],i=!0)},p(l,c){c[0]&2&&Vt(e,"height",l[1]),c[0]&2&&Vt(a,"height",l[1])},d(l){l&&(Q(e),Q(o),Q(a)),i=!1,hi(r)}}}function Rc(n){let e,o,a;return{c(){e=S("div"),m(e,"class","svelte-1ryxg7v"),Vt(e,"both",n[7])},m(i,r){et(i,e,r),o||(a=kn(n[16].call(null,e,{both:n[7]})),o=!0)},p:Gt,d(i){i&&Q(e),o=!1,a()}}}function _r(n){let e,o,a;return{c(){e=S("div"),m(e,"class","svelte-1ryxg7v"),Vt(e,"rotation",n[2])},m(i,r){et(i,e,r),o||(a=kn(n[17].call(null,e)),o=!0)},p(i,r){r[0]&4&&Vt(e,"rotation",i[2])},d(i){i&&Q(e),o=!1,a()}}}function Zc(n){let e,o,a,i,r=n[0]&&dr(n),l=n[1]&&fr(n),c=n[7]&&Rc(n),u=n[2]&&_r(n);return{c(){r&&r.c(),e=K(),l&&l.c(),o=K(),c&&c.c(),a=K(),u&&u.c(),i=Ie()},m(f,p){r&&r.m(f,p),et(f,e,p),l&&l.m(f,p),et(f,o,p),c&&c.m(f,p),et(f,a,p),u&&u.m(f,p),et(f,i,p)},p(f,p){f[0]?r?r.p(f,p):(r=dr(f),r.c(),r.m(e.parentNode,e)):r&&(r.d(1),r=null),f[1]?l?l.p(f,p):(l=fr(f),l.c(),l.m(o.parentNode,o)):l&&(l.d(1),l=null),f[7]&&c.p(f,p),f[2]?u?u.p(f,p):(u=_r(f),u.c(),u.m(i.parentNode,i)):u&&(u.d(1),u=null)},i:Gt,o:Gt,d(f){f&&(Q(e),Q(o),Q(a),Q(i)),r&&r.d(f),l&&l.d(f),c&&c.d(f),u&&u.d(f)}}}function Hc(n){return n*(180/Math.PI)}function jc(n,e,o){let a,i,r,l,c,u,f,p,g,y,k,M;bt(n,Ri,dt=>o(38,f=dt));const C=de("graph"),D=de("node"),z=de("resized");let{width:T=!1}=e,{height:x=!1}=e,{rotation:j=!1}=e,{minHeight:F=0}=e,{minWidth:W=0}=e,Y,st=T,ot=T,$=x,ct=x,N=T&&x,lt=0,V=0,yt=Lt(D.position);const _t=D.position;bt(n,_t,dt=>o(32,k=dt));const U=D.resizingWidth;bt(n,U,dt=>o(31,y=dt));const Z=D.resizingHeight;bt(n,Z,dt=>o(30,g=dt));const St=D.rotating;bt(n,St,dt=>o(28,u=dt));const at=D.rotation;bt(n,at,dt=>o(29,p=dt));const Mt=D.dimensions.height;bt(n,Mt,dt=>o(26,l=dt));const Ct=D.dimensions.width;bt(n,Ct,dt=>o(27,c=dt));const wt=C.cursor;bt(n,wt,dt=>o(33,M=dt));let H,q,X=1;qi(()=>{try{Y=document.querySelector(`#${D.id}`),Y&&o(19,[W,F]=Wo(Y),W,o(18,F))}catch(dt){console.error(dt)}});function I(dt,Dt){const zt=le=>{le.stopPropagation(),le.preventDefault(),Dt.left||Dt.top?o(23,X=-1):o(23,X=1),is.set(!0),Nt(Ri,f=Lt(wt),f),o(21,H=c),o(22,q=l),o(20,yt=k),Dt.both?Nt(U,y=!0,y):Nt(U,y=!1,y),Nt(U,y=Dt.left||Dt.right||Dt.both||!1,y),Nt(Z,g=Dt.top||Dt.bottom||Dt.both||!1,g),Y&&o(19,[W,F]=Wo(Y),W,o(18,F)),window.addEventListener("mouseup",xt)},xt=()=>{Nt(U,y=!1,y),Nt(Z,g=!1,g),is.set(!1),window.removeEventListener("mouseup",xt)};return dt.addEventListener("mousedown",zt),{destroy(){dt.removeEventListener("mousedown",zt)}}}function Ft(dt){const Dt=xt=>{xt.stopPropagation(),xt.preventDefault(),lt=p,Nt(Ri,f=Lt(wt),f);const le=f.x-r.x,ue=f.y-r.y;V=Math.atan2(ue,le),Nt(St,u=!0,u),window.addEventListener("mouseup",zt)},zt=()=>{Nt(St,u=!1,u),window.removeEventListener("mouseup",zt)};return dt.addEventListener("mousedown",Dt),{destroy(){dt.removeEventListener("mousedown",Dt)}}}function $t(){const dt=Lt(wt),Dt=dt.x-r.x,zt=dt.y-r.y,xt=Math.atan2(zt,Dt),le=V-xt;return lt-Hc(le)}return mh(()=>{Y&&o(19,[W,F]=Wo(Y),W,o(18,F)),c<W&&z.set(!1),l<F&&z.set(!1)}),n.$$set=dt=>{"width"in dt&&o(0,T=dt.width),"height"in dt&&o(1,x=dt.height),"rotation"in dt&&o(2,j=dt.rotation),"minHeight"in dt&&o(18,F=dt.minHeight),"minWidth"in dt&&o(19,W=dt.minWidth)},n.$$.update=()=>{if(n.$$.dirty[0]&268435456|n.$$.dirty[1]&4&&u&&Nt(at,p=$t(),p),n.$$.dirty[0]&1624506368|n.$$.dirty[1]&4&&g){const dt=Lt(Ri),Dt=M,zt=Math.max(F,q+(Dt.y-dt.y)*X);zt>F?(z.set(!0),Nt(Mt,l=zt,l)):z.set(!1),X===-1&&Nt(_t,k={x:yt.x,y:yt.y+Dt.y-dt.y},k),p!==0&&D.position.update(xt=>({y:yt.y-(zt-q)/2,x:xt.x}))}if(n.$$.dirty[0]&548929536|n.$$.dirty[1]&5&&y){const dt=Lt(Ri),Dt=M,zt=Math.max(W,H+(Dt.x-dt.x)*X);zt>W?(z.set(!0),Nt(Ct,c=zt,c)):z.set(!1),X===-1&&Nt(_t,k={x:yt.x+Dt.x-dt.x,y:yt.y},k),p!==0&&D.position.update(xt=>({x:yt.x-(zt-H)/2,y:xt.y}))}n.$$.dirty[1]&2&&o(25,a=k.x),n.$$.dirty[1]&2&&o(24,i=k.y),n.$$.dirty[0]&251658240&&(r={x:a+c/2,y:i+l/2})},[T,x,j,st,ot,$,ct,N,_t,U,Z,St,at,Mt,Ct,wt,I,Ft,F,W,yt,H,q,X,i,a,l,c,u,p,g,y,k,M]}class Fc extends Mi{constructor(e){super(),ki(this,e,jc,Zc,di,{width:0,height:1,rotation:2,minHeight:18,minWidth:19},null,[-1,-1])}}function pr(n,e,o){const a=n.slice();return a[28]=e[o],a[34]=o,a}function mr(n,e,o){const a=n.slice();return a[28]=e[o],a[34]=o,a}function gr(n,e,o){const a=n.slice();return a[28]=e[o],a}function vr(n,e,o){const a=n.slice();return a[28]=e[o],a}function Gc(n){let e,o=[],a=new Map,i,r,l=[],c=new Map,u,f=Se({length:n[2]});const p=k=>k[34];for(let k=0;k<f.length;k+=1){let M=mr(n,f,k),C=p(M);a.set(C,o[k]=yr(C,M))}let g=Se({length:n[3]});const y=k=>k[34];for(let k=0;k<g.length;k+=1){let M=pr(n,g,k),C=y(M);c.set(C,l[k]=br(C,M))}return{c(){e=S("div");for(let k=0;k<o.length;k+=1)o[k].c();i=K(),r=S("div");for(let k=0;k<l.length;k+=1)l[k].c();m(e,"class","input-anchors svelte-j5bq7k"),Vt(e,"top",n[14]),Vt(e,"left",n[16]),m(r,"class","output-anchors svelte-j5bq7k"),Vt(r,"bottom",n[15]),Vt(r,"right",n[17])},m(k,M){et(k,e,M);for(let C=0;C<o.length;C+=1)o[C]&&o[C].m(e,null);et(k,i,M),et(k,r,M);for(let C=0;C<l.length;C+=1)l[C]&&l[C].m(r,null);u=!0},p(k,M){M[0]&16388&&(f=Se({length:k[2]}),ve(),o=vn(o,M,p,1,k,f,a,e,io,yr,null,mr),ye()),M[0]&16392&&(g=Se({length:k[3]}),ve(),l=vn(l,M,y,1,k,g,c,r,io,br,null,pr),ye())},i(k){if(!u){for(let M=0;M<f.length;M+=1)B(o[M]);for(let M=0;M<g.length;M+=1)B(l[M]);u=!0}},o(k){for(let M=0;M<o.length;M+=1)G(o[M]);for(let M=0;M<l.length;M+=1)G(l[M]);u=!1},d(k){k&&(Q(e),Q(i),Q(r));for(let M=0;M<o.length;M+=1)o[M].d();for(let M=0;M<l.length;M+=1)l[M].d()}}}function Uc(n){let e,o,a,i=Se({length:n[2]}),r=[];for(let p=0;p<i.length;p+=1)r[p]=wr(vr(n,i,p));const l=p=>G(r[p],1,1,()=>{r[p]=null});let c=Se({length:n[3]}),u=[];for(let p=0;p<c.length;p+=1)u[p]=Lr(gr(n,c,p));const f=p=>G(u[p],1,1,()=>{u[p]=null});return{c(){for(let p=0;p<r.length;p+=1)r[p].c();e=K();for(let p=0;p<u.length;p+=1)u[p].c();o=Ie()},m(p,g){for(let y=0;y<r.length;y+=1)r[y]&&r[y].m(p,g);et(p,e,g);for(let y=0;y<u.length;y+=1)u[y]&&u[y].m(p,g);et(p,o,g),a=!0},p(p,g){if(g[0]&4){const y=i.length;i=Se({length:p[2]});let k;for(k=y;k<i.length;k+=1){const M=vr(p,i,k);r[k]?B(r[k],1):(r[k]=wr(M),r[k].c(),B(r[k],1),r[k].m(e.parentNode,e))}for(ve(),k=i.length;k<r.length;k+=1)l(k);ye()}if(g[0]&8){const y=c.length;c=Se({length:p[3]});let k;for(k=y;k<c.length;k+=1){const M=gr(p,c,k);u[k]?B(u[k],1):(u[k]=Lr(M),u[k].c(),B(u[k],1),u[k].m(o.parentNode,o))}for(ve(),k=c.length;k<u.length;k+=1)f(k);ye()}},i(p){if(!a){for(let g=0;g<i.length;g+=1)B(r[g]);for(let g=0;g<c.length;g+=1)B(u[g]);a=!0}},o(p){r=r.filter(Boolean);for(let g=0;g<r.length;g+=1)G(r[g]);u=u.filter(Boolean);for(let g=0;g<u.length;g+=1)G(u[g]);a=!1},d(p){p&&(Q(e),Q(o)),Tn(r,p),Tn(u,p)}}}function yr(n,e){let o,a,i;return a=new So({props:{input:!0,direction:e[14]?"north":"west"}}),a.$on("connection",e[22]),a.$on("disconnection",e[23]),{key:n,first:null,c(){o=Ie(),ae(a.$$.fragment),this.first=o},m(r,l){et(r,o,l),ee(a,r,l),i=!0},p(r,l){e=r},i(r){i||(B(a.$$.fragment,r),i=!0)},o(r){G(a.$$.fragment,r),i=!1},d(r){r&&Q(o),ie(a,r)}}}function br(n,e){let o,a,i;return a=new So({props:{output:!0,direction:e[14]?"south":"east"}}),a.$on("connection",e[24]),a.$on("disconnection",e[25]),{key:n,first:null,c(){o=Ie(),ae(a.$$.fragment),this.first=o},m(r,l){et(r,o,l),ee(a,r,l),i=!0},p(r,l){e=r},i(r){i||(B(a.$$.fragment,r),i=!0)},o(r){G(a.$$.fragment,r),i=!1},d(r){r&&Q(o),ie(a,r)}}}function wr(n){let e,o;return e=new So({}),e.$on("connection",n[18]),e.$on("disconnection",n[19]),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function Lr(n){let e,o;return e=new So({}),e.$on("connection",n[20]),e.$on("disconnection",n[21]),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function kr(n){let e,o;return e=new Fc({props:{width:!0,height:!0,rotation:!0}}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function Wc(n){let e,o,a,i,r,l,c,u=`${n[1]}px`,f;const p=[Uc,Gc],g=[];function y(M,C){return M[7]?0:1}o=y(n),a=g[o]=p[o](n);let k=n[6]&&kr();return{c(){e=S("div"),a.c(),i=K(),r=S("p"),l=Ze(n[5]),c=K(),k&&k.c(),m(r,"class","svelte-j5bq7k"),ht(r,"color",n[4]),m(e,"class","default-node svelte-j5bq7k"),Vt(e,"selected",n[0]),ht(e,"border-radius",u)},m(M,C){et(M,e,C),g[o].m(e,null),w(e,i),w(e,r),w(r,l),w(e,c),k&&k.m(e,null),f=!0},p(M,C){a.p(M,C),(!f||C[0]&32)&&Ei(l,M[5]),C[0]&16&&ht(r,"color",M[4]),M[6]?k?C[0]&64&&B(k,1):(k=kr(),k.c(),B(k,1),k.m(e,null)):k&&(ve(),G(k,1,1,()=>{k=null}),ye()),(!f||C[0]&1)&&Vt(e,"selected",M[0]),C[0]&2&&u!==(u=`${M[1]}px`)&&ht(e,"border-radius",u)},i(M){f||(B(a),B(k),f=!0)},o(M){G(a),G(k),f=!1},d(M){M&&Q(e),g[o].d(),k&&k.d()}}}function Vc(n,e,o){let a,i,r,l,c,u;const f=de("dynamic"),p=de("node");let{selected:g}=e;const y=p.label;bt(n,y,yt=>o(5,c=yt));const k=p.borderRadius;bt(n,k,yt=>o(1,a=yt));const M=p.textColor;bt(n,M,yt=>o(4,l=yt));const C=p.inputs;bt(n,C,yt=>o(2,i=yt));const D=p.outputs;bt(n,D,yt=>o(3,r=yt));const z=p.resizable;bt(n,z,yt=>o(6,u=yt));const T=Lt(p.direction);let x=T==="TD",j=T==="TD",F=T!=="TD",W=T!=="TD";function Y(yt){Ke.call(this,n,yt)}function st(yt){Ke.call(this,n,yt)}function ot(yt){Ke.call(this,n,yt)}function $(yt){Ke.call(this,n,yt)}function ct(yt){Ke.call(this,n,yt)}function N(yt){Ke.call(this,n,yt)}function lt(yt){Ke.call(this,n,yt)}function V(yt){Ke.call(this,n,yt)}return n.$$set=yt=>{"selected"in yt&&o(0,g=yt.selected)},[g,a,i,r,l,c,u,f,y,k,M,C,D,z,x,j,F,W,Y,st,ot,$,ct,N,lt,V]}class Yc extends Mi{constructor(e){super(),ki(this,e,Vc,Wc,di,{selected:0},null,[-1,-1])}}const Xc=n=>({}),Mr=n=>({}),qc=n=>({}),Pr=n=>({}),Kc=n=>({}),Er=n=>({}),Jc=n=>({}),Cr=n=>({}),Qc=n=>({selected:n[0]&2048}),Tr=n=>({grabHandle:n[50],selected:n[11],destroy:n[48]}),$c=n=>({selected:n[0]&2048}),Sr=n=>({grabHandle:n[50],selected:n[11],destroy:n[48]});function Dr(n){let e,o,a,i,r,l,c,u,f,p,g,y,k,M,C,D=`${n[14].y}px`,z=`${n[14].x}px`,T=`rotate(${n[20]}deg)`,x,j,F;const W=[eu,tu],Y=[];function st(U,Z){return U[12]?1:0}o=st(n),a=Y[o]=W[o](n);const ot=n[61].anchorWest,$=ke(ot,n,n[60],Cr),ct=n[61].anchorEast,N=ke(ct,n,n[60],Er),lt=n[61].anchorNorth,V=ke(lt,n,n[60],Pr),yt=n[61].anchorSouth,_t=ke(yt,n,n[60],Mr);return{c(){e=S("div"),a.c(),i=K(),r=S("div"),$&&$.c(),c=K(),u=S("div"),N&&N.c(),p=K(),g=S("div"),V&&V.c(),k=K(),M=S("div"),_t&&_t.c(),m(r,"id",l=`anchors-west-${n[0].id}`),m(r,"class","anchors left svelte-1iknrz0"),m(u,"id",f=`anchors-east-${n[0].id}`),m(u,"class","anchors right svelte-1iknrz0"),m(g,"id",y=`anchors-north-${n[0].id}`),m(g,"class","anchors top svelte-1iknrz0"),m(M,"id",C=`anchors-south-${n[0].id}`),m(M,"class","anchors bottom svelte-1iknrz0"),m(e,"id",n[30]),m(e,"class","svelvet-node svelte-1iknrz0"),m(e,"role","button"),m(e,"title",n[10]),m(e,"tabindex",0),Vt(e,"selected",n[11]),Vt(e,"locked",n[16]||n[15]),ht(e,"top",D),ht(e,"left",z),ht(e,"z-index",n[17]),ht(e,"width",n[12]?n[19]+"px":"fit-content"),ht(e,"height",n[12]?n[18]+"px":"fit-content"),ht(e,"transform",T),ht(e,"--prop-background-color",n[21]||(n[1]||n[2]?null:"transparent")),ht(e,"--prop-text-color",n[22]),ht(e,"--prop-border-color",n[23]),ht(e,"--prop-selection-color",n[24]),ht(e,"--prop-border-radius",n[25]?`${n[25]}px`:n[1]||n[2]?null:"0px"),ht(e,"--prop-border-width",n[26]||(n[1]||n[2]?null:"0px"))},m(U,Z){et(U,e,Z),Y[o].m(e,null),w(e,i),w(e,r),$&&$.m(r,null),w(e,c),w(e,u),N&&N.m(u,null),w(e,p),w(e,g),V&&V.m(g,null),w(e,k),w(e,M),_t&&_t.m(M,null),x=!0,j||(F=[ft(e,"contextmenu",en(Xi(n[62]))),ft(e,"mouseup",n[49]),kn(n[50].call(null,e))],j=!0)},p(U,Z){let St=o;o=st(U),o===St?Y[o].p(U,Z):(ve(),G(Y[St],1,1,()=>{Y[St]=null}),ye(),a=Y[o],a?a.p(U,Z):(a=Y[o]=W[o](U),a.c()),B(a,1),a.m(e,i)),$&&$.p&&(!x||Z[1]&536870912)&&Pe($,ot,U,U[60],x?Me(ot,U[60],Z,Jc):Ee(U[60]),Cr),(!x||Z[0]&1&&l!==(l=`anchors-west-${U[0].id}`))&&m(r,"id",l),N&&N.p&&(!x||Z[1]&536870912)&&Pe(N,ct,U,U[60],x?Me(ct,U[60],Z,Kc):Ee(U[60]),Er),(!x||Z[0]&1&&f!==(f=`anchors-east-${U[0].id}`))&&m(u,"id",f),V&&V.p&&(!x||Z[1]&536870912)&&Pe(V,lt,U,U[60],x?Me(lt,U[60],Z,qc):Ee(U[60]),Pr),(!x||Z[0]&1&&y!==(y=`anchors-north-${U[0].id}`))&&m(g,"id",y),_t&&_t.p&&(!x||Z[1]&536870912)&&Pe(_t,yt,U,U[60],x?Me(yt,U[60],Z,Xc):Ee(U[60]),Mr),(!x||Z[0]&1&&C!==(C=`anchors-south-${U[0].id}`))&&m(M,"id",C),(!x||Z[0]&1024)&&m(e,"title",U[10]),(!x||Z[0]&2048)&&Vt(e,"selected",U[11]),(!x||Z[0]&98304)&&Vt(e,"locked",U[16]||U[15]),Z[0]&16384&&D!==(D=`${U[14].y}px`)&&ht(e,"top",D),Z[0]&16384&&z!==(z=`${U[14].x}px`)&&ht(e,"left",z),Z[0]&131072&&ht(e,"z-index",U[17]),Z[0]&528384&&ht(e,"width",U[12]?U[19]+"px":"fit-content"),Z[0]&266240&&ht(e,"height",U[12]?U[18]+"px":"fit-content"),Z[0]&1048576&&T!==(T=`rotate(${U[20]}deg)`)&&ht(e,"transform",T),Z[0]&2097158&&ht(e,"--prop-background-color",U[21]||(U[1]||U[2]?null:"transparent")),Z[0]&4194304&&ht(e,"--prop-text-color",U[22]),Z[0]&8388608&&ht(e,"--prop-border-color",U[23]),Z[0]&16777216&&ht(e,"--prop-selection-color",U[24]),Z[0]&33554438&&ht(e,"--prop-border-radius",U[25]?`${U[25]}px`:U[1]||U[2]?null:"0px"),Z[0]&67108870&&ht(e,"--prop-border-width",U[26]||(U[1]||U[2]?null:"0px"))},i(U){x||(B(a),B($,U),B(N,U),B(V,U),B(_t,U),x=!0)},o(U){G(a),G($,U),G(N,U),G(V,U),G(_t,U),x=!1},d(U){U&&Q(e),Y[o].d(),$&&$.d(U),N&&N.d(U),V&&V.d(U),_t&&_t.d(U),j=!1,hi(F)}}}function tu(n){let e;const o=n[61].default,a=ke(o,n,n[60],Tr);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,r){a&&a.p&&(!e||r[0]&2048|r[1]&536870912)&&Pe(a,o,i,i[60],e?Me(o,i[60],r,Qc):Ee(i[60]),Tr)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function eu(n){let e,o,a;const i=n[61].default,r=ke(i,n,n[60],Sr);return{c(){e=S("div"),r&&r.c(),Sn(()=>n[63].call(e)),ht(e,"width","fit-content"),ht(e,"height","fit-content")},m(l,c){et(l,e,c),r&&r.m(e,null),o=_h(e,n[63].bind(e)),a=!0},p(l,c){r&&r.p&&(!a||c[0]&2048|c[1]&536870912)&&Pe(r,i,l,l[60],a?Me(i,l[60],c,$c):Ee(l[60]),Sr)},i(l){a||(B(r,l),a=!0)},o(l){G(r,l),a=!1},d(l){l&&Q(e),r&&r.d(l),o()}}}function iu(n){let e,o,a=!n[13]&&Dr(n);return{c(){a&&a.c(),e=Ie()},m(i,r){a&&a.m(i,r),et(i,e,r),o=!0},p(i,r){i[13]?a&&(ve(),G(a,1,1,()=>{a=null}),ye()):a?(a.p(i,r),r[0]&8192&&B(a,1)):(a=Dr(i),a.c(),B(a,1),a.m(e.parentNode,e))},i(i){o||(B(a),o=!0)},o(i){G(a),o=!1},d(i){i&&Q(e),a&&a.d(i)}}}const nu=new Set(["INPUT","SELECT","BUTTON","TEXTAREA"]);function ou(n,e,o){let a,i,r,l,c,u,f,p=Gt,g=()=>(p(),p=gi(Ht,A=>o(66,f=A)),Ht),y,k=Gt,M=()=>(k(),k=gi(De,A=>o(67,y=A)),De),C,D,z=Gt,T=()=>(z(),z=gi(ze,A=>o(68,D=A)),ze),x,j,F,W=Gt,Y=()=>(W(),W=gi(He,A=>o(71,F=A)),He),st,ot,$,ct=Gt,N=()=>(ct(),ct=gi(Kt,A=>o(16,$=A)),Kt),lt,V=Gt,yt=()=>(V(),V=gi(Jt,A=>o(73,lt=A)),Jt),_t,U,Z,St,at=Gt,Mt=()=>(at(),at=gi(ne,A=>o(75,St=A)),ne),Ct,wt,H,q,X,I,Ft,$t,dt,Dt,zt,xt;bt(n,Ri,A=>o(65,u=A)),bt(n,Vi,A=>o(70,j=A)),n.$$.on_destroy.push(()=>p()),n.$$.on_destroy.push(()=>k()),n.$$.on_destroy.push(()=>z()),n.$$.on_destroy.push(()=>W()),n.$$.on_destroy.push(()=>ct()),n.$$.on_destroy.push(()=>V()),n.$$.on_destroy.push(()=>at());let{$$slots:le={},$$scope:ue}=e;const pe=de("mounted"),it=de("duplicate");bt(n,it,A=>o(56,wt=A));const te=de("graphDOMElement");bt(n,te,A=>o(74,U=A));const Qt=Fn();let{node:Ot}=e,{isDefault:Wt}=e,{useDefaults:be}=e,{center:Ne}=e,{nodeStore:fe}=e,{locked:Kt}=e;N();let{groups:Ht}=e;g();let{maxZIndex:Jt}=e;yt();let{centerPoint:ne}=e;Mt();let{cursor:We}=e,{initialNodePositions:De}=e;M();let{activeGroup:ze}=e;T();let{editing:He}=e;Y();let{dimensionsProvided:he=!1}=e,{title:$e}=e;const vi=J(0),we=J(null);bt(n,we,A=>o(64,c=A));const Le=Ot.id,It=Ot.position;bt(n,It,A=>o(59,X=A));const fi=Ot.dimensions.width;bt(n,fi,A=>o(19,Ct=A));const Ae=Ot.dimensions.height;bt(n,Ae,A=>o(18,Z=A));const ci=Ot.selectionColor;bt(n,ci,A=>o(24,Dt=A));const Re=Ot.editable;bt(n,Re,A=>o(72,st=A));const ui=Ot.locked;bt(n,ui,A=>o(15,ot=A));const Ce=Ot.zIndex;bt(n,Ce,A=>o(17,_t=A));const ti=Ot.bgColor;bt(n,ti,A=>o(21,Ft=A));const _i=Ot.borderRadius;bt(n,_i,A=>o(25,zt=A));const _e=Ot.textColor;bt(n,_e,A=>o(22,$t=A));const ce=Ot.group;bt(n,ce,A=>o(69,x=A));const je=Ot.borderColor;bt(n,je,A=>o(23,dt=A));const Ve=Ot.borderWidth;bt(n,Ve,A=>o(26,xt=A));const yi=Ot.rotation;bt(n,yi,A=>o(20,I=A));const{selected:Si,hidden:Ci}=f,Je=Ci.nodes;bt(n,Je,A=>o(58,q=A));const Pt=Si.nodes;bt(n,Pt,A=>o(55,C=A));const ei=J(!1);bt(n,ei,A=>o(57,H=A)),Oe("node",Ot),Oe("anchorsMounted",vi),Oe("resized",ei),Oe("nodeConnectEvent",we),qi(()=>{if(Ne){const A={x:St.x-Ct/2,y:St.y-Z/2};Ot.position.set(A),Vi.set(!0),Vi.set(!1)}pe.update(A=>A+1)}),oo(()=>{i&&(C.delete(Ot),Pt.set(C)),pe.update(A=>A-1)});function ii(){i?(Ot&&C.delete(Ot),Pt.set(C)):(Ot&&C.add(Ot),Pt.set(C))}function ni(A){Nt(Ri,u=Lt(We),u),U.focus(),_t!==lt&&_t!==1/0&&Nt(Ce,_t=Nt(Jt,++lt,lt),_t);const Xt=A.target;if(!nu.has(Xt.tagName)&&(A.preventDefault(),Qt("nodeClicked",{node:Ot,e:A}),!($||ot))){if("touches"in A){if(A.touches&&A.touches.length>1)return}else A.button===2&&st&&Nt(He,F=Ot,F);Nt(Vi,j=!0,j),pi(A)}}function pi(A){let Xt,oe,Yt=!1;const me=x;me&&(Xt=f[me],oe=Lt(Xt.parent),Yt=oe===Ot),Yt?Nt(ze,D=me,D):Nt(ze,D="selected",D),!A.shiftKey&&i?Nt(ze,D="selected",D):(!A.shiftKey&&!i&&!A.shiftKey&&(C.clear(),Pt.set(C)),ii()),Nt(De,y=ll(f.selected.nodes),y)}function b(){fe.delete(Le)}function pt(A){const Xt=Lt(We),oe=Xt.x-u.x,Yt=Xt.y-u.y;Math.abs(oe)+Math.abs(Yt)<4&&Qt("nodeReleased",{e:A,node:Ot}),Nt(we,c=A,c)}function Et(A){return A.addEventListener("mousedown",ni),A.addEventListener("touchstart",ni),{destroy(){A.removeEventListener("mousedown",ni),A.removeEventListener("touchstart",ni)}}}function kt(A){Ke.call(this,n,A)}function At(){Z=this.clientHeight,Ae.set(Z),Ct=this.clientWidth,fi.set(Ct)}return n.$$set=A=>{"node"in A&&o(0,Ot=A.node),"isDefault"in A&&o(1,Wt=A.isDefault),"useDefaults"in A&&o(2,be=A.useDefaults),"center"in A&&o(51,Ne=A.center),"nodeStore"in A&&o(52,fe=A.nodeStore),"locked"in A&&N(o(3,Kt=A.locked)),"groups"in A&&g(o(4,Ht=A.groups)),"maxZIndex"in A&&yt(o(5,Jt=A.maxZIndex)),"centerPoint"in A&&Mt(o(6,ne=A.centerPoint)),"cursor"in A&&o(53,We=A.cursor),"initialNodePositions"in A&&M(o(7,De=A.initialNodePositions)),"activeGroup"in A&&T(o(8,ze=A.activeGroup)),"editing"in A&&Y(o(9,He=A.editing)),"dimensionsProvided"in A&&o(54,he=A.dimensionsProvided),"title"in A&&o(10,$e=A.title),"$$scope"in A&&o(60,ue=A.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&268435456&&o(14,a=X),n.$$.dirty[0]&1|n.$$.dirty[1]&16777216&&o(11,i=C.has(Ot)),n.$$.dirty[0]&1|n.$$.dirty[1]&134217728&&o(13,r=q.has(Ot)),n.$$.dirty[1]&75497472&&o(12,l=he||H),n.$$.dirty[0]&2049|n.$$.dirty[1]&33554432&&i&&wt&&Qt("duplicate",Ot)},[Ot,Wt,be,Kt,Ht,Jt,ne,De,ze,He,$e,i,l,r,a,ot,$,_t,Z,Ct,I,Ft,$t,dt,Dt,zt,xt,it,te,we,Le,It,fi,Ae,ci,Re,ui,Ce,ti,_i,_e,ce,je,Ve,yi,Je,Pt,ei,b,pt,Et,Ne,fe,We,he,C,wt,H,q,X,ue,le,kt,At]}class su extends Mi{constructor(e){super(),ki(this,e,ou,iu,di,{node:0,isDefault:1,useDefaults:2,center:51,nodeStore:52,locked:3,groups:4,maxZIndex:5,centerPoint:6,cursor:53,initialNodePositions:7,activeGroup:8,editing:9,dimensionsProvided:54,title:10},null,[-1,-1,-1])}}const ru=n=>({selected:n[1]&262144,grabHandle:n[1]&524288,node:n[0]&128,destroy:n[1]&131072}),zr=n=>({selected:n[49],grabHandle:n[50],disconnect:n[14],connect:n[13],node:n[7],destroy:n[48]}),au=n=>({}),Or=n=>({slot:"anchorWest"}),lu=n=>({}),Ir=n=>({slot:"anchorEast"}),hu=n=>({}),Ar=n=>({slot:"anchorNorth"}),cu=n=>({}),xr=n=>({slot:"anchorSouth"});function Nr(n){let e,o;return e=new su({props:{node:n[7],center:n[5]||n[0]==="center",isDefault:n[8],useDefaults:n[4],dimensionsProvided:!!n[1]||!!n[2]||!!n[3]||n[8]||!1,nodeStore:n[11].nodes,locked:n[11].locked,groups:n[11].groups,title:n[6],maxZIndex:n[11].maxZIndex,centerPoint:n[11].center,cursor:n[11].cursor,activeGroup:n[11].activeGroup,editing:n[11].editing,initialNodePositions:n[11].initialNodePositions,$$slots:{anchorSouth:[mu],anchorNorth:[pu],anchorEast:[_u],anchorWest:[fu],default:[du,({destroy:a,selected:i,grabHandle:r})=>({48:a,49:i,50:r}),({destroy:a,selected:i,grabHandle:r})=>[0,(a?131072:0)|(i?262144:0)|(r?524288:0)]]},$$scope:{ctx:n}}}),e.$on("nodeClicked",n[41]),e.$on("nodeMount",n[42]),e.$on("nodeReleased",n[43]),e.$on("duplicate",n[44]),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},p(a,i){const r={};i[0]&128&&(r.node=a[7]),i[0]&33&&(r.center=a[5]||a[0]==="center"),i[0]&256&&(r.isDefault=a[8]),i[0]&16&&(r.useDefaults=a[4]),i[0]&270&&(r.dimensionsProvided=!!a[1]||!!a[2]||!!a[3]||a[8]||!1),i[0]&64&&(r.title=a[6]),i[0]&384|i[1]&933888&&(r.$$scope={dirty:i,ctx:a}),e.$set(r)},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function Br(n){let e,o;return e=new Yc({props:{selected:n[49]}}),e.$on("connection",n[39]),e.$on("disconnection",n[40]),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},p(a,i){const r={};i[1]&262144&&(r.selected=a[49]),e.$set(r)},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function uu(n){let e,o,a=n[8]&&Br(n);return{c(){a&&a.c(),e=Ie()},m(i,r){a&&a.m(i,r),et(i,e,r),o=!0},p(i,r){i[8]?a?(a.p(i,r),r[0]&256&&B(a,1)):(a=Br(i),a.c(),B(a,1),a.m(e.parentNode,e)):a&&(ve(),G(a,1,1,()=>{a=null}),ye())},i(i){o||(B(a),o=!0)},o(i){G(a),o=!1},d(i){i&&Q(e),a&&a.d(i)}}}function du(n){let e;const o=n[38].default,a=ke(o,n,n[45],zr),i=a||uu(n);return{c(){i&&i.c()},m(r,l){i&&i.m(r,l),e=!0},p(r,l){a?a.p&&(!e||l[0]&128|l[1]&933888)&&Pe(a,o,r,r[45],e?Me(o,r[45],l,ru):Ee(r[45]),zr):i&&i.p&&(!e||l[0]&256|l[1]&262144)&&i.p(r,e?l:[-1,-1])},i(r){e||(B(i,r),e=!0)},o(r){G(i,r),e=!1},d(r){i&&i.d(r)}}}function fu(n){let e;const o=n[38].anchorWest,a=ke(o,n,n[45],Or);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,r){a&&a.p&&(!e||r[1]&16384)&&Pe(a,o,i,i[45],e?Me(o,i[45],r,au):Ee(i[45]),Or)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function _u(n){let e;const o=n[38].anchorEast,a=ke(o,n,n[45],Ir);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,r){a&&a.p&&(!e||r[1]&16384)&&Pe(a,o,i,i[45],e?Me(o,i[45],r,lu):Ee(i[45]),Ir)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function pu(n){let e;const o=n[38].anchorNorth,a=ke(o,n,n[45],Ar);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,r){a&&a.p&&(!e||r[1]&16384)&&Pe(a,o,i,i[45],e?Me(o,i[45],r,hu):Ee(i[45]),Ar)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function mu(n){let e;const o=n[38].anchorSouth,a=ke(o,n,n[45],xr);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,r){a&&a.p&&(!e||r[1]&16384)&&Pe(a,o,i,i[45],e?Me(o,i[45],r,cu):Ee(i[45]),xr)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function gu(n){let e=n[7]&&n[10].get(n[7].id),o,a,i=e&&Nr(n);return{c(){i&&i.c(),o=Ie()},m(r,l){i&&i.m(r,l),et(r,o,l),a=!0},p(r,l){l[0]&1152&&(e=r[7]&&r[10].get(r[7].id)),e?i?(i.p(r,l),l[0]&1152&&B(i,1)):(i=Nr(r),i.c(),B(i,1),i.m(o.parentNode,o)):i&&(ve(),G(i,1,1,()=>{i=null}),ye())},i(r){a||(B(i),a=!0)},o(r){G(i),a=!1},d(r){r&&Q(o),i&&i.d(r)}}}function vu(n,e,o){let a,i,r=Gt,l=()=>(r(),r=gi(a,it=>o(37,i=it)),a),c;n.$$.on_destroy.push(()=>r());let{$$slots:u={},$$scope:f}=e;const p=rs(u),g=de("graph"),y=de("group");let{position:k={x:0,y:0}}=e,{drop:M=!1}=e,{dimensions:C=null}=e,{id:D=0}=e,{bgColor:z=null}=e,{borderRadius:T=null}=e,{borderColor:x=null}=e,{borderWidth:j=null}=e,{selectionColor:F=null}=e,{textColor:W=null}=e,{resizable:Y=!1}=e,{label:st=""}=e,{inputs:ot=1}=e,{outputs:$=1}=e,{width:ct=null}=e,{height:N=null}=e,{TD:lt=!1}=e,{LR:V=!1}=e,{zIndex:yt=1}=e,{editable:_t=!0}=e,{locked:U=!1}=e,{rotation:Z=0}=e,{edge:St=null}=e,{connections:at=[]}=e,{useDefaults:Mt=!1}=e,{center:Ct=!1}=e,{dynamic:wt=!1}=e,{title:H=""}=e;const q=g.nodes;bt(n,q,it=>o(10,c=it)),Oe("dynamic",wt);let X,I=!0;qi(()=>{const it=lt?"TD":V?"LR":g.direction,te=g.groupBoxes.get(y),Qt=g.nodes.count()+1;o(8,I=!p.default),(p.anchorWest||p.anchorEast||p.anchorNorth||p.anchorSouth)&&o(8,I=!1);const Ot=C||(ct||N?{width:ct||N||200,height:N||ct||100}:I?{width:200,height:100}:{width:0,height:0}),Wt={id:D||Qt,position:M==="cursor"?{x:Lt(g.cursor).x,y:Lt(g.cursor).y}:te?{x:Lt(te.position).x+k.x,y:Lt(te.position).y+k.y}:k,dimensions:Ot,editable:_t||g.editable,label:st,group:y,resizable:Y,inputs:ot,outputs:$,zIndex:yt,direction:it,locked:U,rotation:Z};at.length&&(Wt.connections=at),j&&(Wt.borderWidth=j),T&&(Wt.borderRadius=T),x&&(Wt.borderColor=x),F&&(Wt.selectionColor=F),W&&(Wt.textColor=W),z&&(Wt.bgColor=z),St&&(Wt.edge=St),o(7,X=kh(Wt)),te&&g.groups.update(be=>{const Ne=Lt(be[y].nodes);return be[y].nodes.set(new Set([...Ne,X])),be}),g.nodes.add(X,X.id)}),oo(()=>{g.nodes.delete(X.id)});function Ft(it){X&&X.connections.set([it])}function $t(it){if(!X)return;(Array.isArray(it)?it:[it]).forEach(Qt=>{const[Ot,Wt]=Array.isArray(Qt)?Qt:[Qt,null],be=`N-${Ot}`,Ne=g.nodes.get(be);if(!Ne)return;let fe=null;const Kt=Wt?`A-${Wt}/${be}`:null;Kt&&(fe=Ne.anchors.get(Kt));const Ht=g.edges.match(X,Ne,fe);Ht.length&&g.edges.delete(Ht[Ht.length-1])})}Oe("connect",Ft),Oe("disconnect",$t);let dt=k;function Dt(it){Ke.call(this,n,it)}function zt(it){Ke.call(this,n,it)}function xt(it){Ke.call(this,n,it)}function le(it){Ke.call(this,n,it)}function ue(it){Ke.call(this,n,it)}function pe(it){Ke.call(this,n,it)}return n.$$set=it=>{"position"in it&&o(15,k=it.position),"drop"in it&&o(0,M=it.drop),"dimensions"in it&&o(1,C=it.dimensions),"id"in it&&o(16,D=it.id),"bgColor"in it&&o(17,z=it.bgColor),"borderRadius"in it&&o(18,T=it.borderRadius),"borderColor"in it&&o(19,x=it.borderColor),"borderWidth"in it&&o(20,j=it.borderWidth),"selectionColor"in it&&o(21,F=it.selectionColor),"textColor"in it&&o(22,W=it.textColor),"resizable"in it&&o(23,Y=it.resizable),"label"in it&&o(24,st=it.label),"inputs"in it&&o(25,ot=it.inputs),"outputs"in it&&o(26,$=it.outputs),"width"in it&&o(2,ct=it.width),"height"in it&&o(3,N=it.height),"TD"in it&&o(27,lt=it.TD),"LR"in it&&o(28,V=it.LR),"zIndex"in it&&o(29,yt=it.zIndex),"editable"in it&&o(30,_t=it.editable),"locked"in it&&o(31,U=it.locked),"rotation"in it&&o(32,Z=it.rotation),"edge"in it&&o(33,St=it.edge),"connections"in it&&o(34,at=it.connections),"useDefaults"in it&&o(4,Mt=it.useDefaults),"center"in it&&o(5,Ct=it.center),"dynamic"in it&&o(35,wt=it.dynamic),"title"in it&&o(6,H=it.title),"$$scope"in it&&o(45,f=it.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&128|n.$$.dirty[1]&8&&X&&X.connections.set(at),n.$$.dirty[0]&131200&&X&&X.bgColor.set(z),n.$$.dirty[0]&16777344&&X&&X.label.set(st),n.$$.dirty[0]&4194432&&X&&X.textColor.set(W),n.$$.dirty[0]&524416&&X&&X.borderColor.set(x),n.$$.dirty[0]&2097280&&X&&X.selectionColor.set(F),n.$$.dirty[0]&8388736&&X&&X.resizable.set(Y),n.$$.dirty[0]&1073741952&&X&&X.editable.set(_t),n.$$.dirty[0]&128|n.$$.dirty[1]&1&&X&&X.locked.set(U),n.$$.dirty[0]&33554560&&X&&X.inputs.set(ot),n.$$.dirty[0]&67108992&&X&&X.outputs.set($),n.$$.dirty[0]&536871040&&X&&X.zIndex.set(yt),n.$$.dirty[0]&128&&l(o(9,a=X&&(X==null?void 0:X.position))),n.$$.dirty[0]&32896|n.$$.dirty[1]&96&&X){const{x:it,y:te}=dt,{x:Qt,y:Ot}=i,{x:Wt,y:be}=k;(Wt!==Qt||be!==Ot)&&(Wt!==it||be!==te?(o(36,dt=k),X.position.set(k)):(o(36,dt=i),o(15,k=i)))}n.$$.dirty[0]&33554560&&X&&X.inputs.set(ot),n.$$.dirty[0]&67108992&&X&&X.outputs.set($)},[M,C,ct,N,Mt,Ct,H,X,I,a,c,g,q,Ft,$t,k,D,z,T,x,j,F,W,Y,st,ot,$,lt,V,yt,_t,U,Z,St,at,wt,dt,i,u,Dt,zt,xt,le,ue,pe,f]}class as extends Mi{constructor(e){super(),ki(this,e,vu,gu,di,{position:15,drop:0,dimensions:1,id:16,bgColor:17,borderRadius:18,borderColor:19,borderWidth:20,selectionColor:21,textColor:22,resizable:23,label:24,inputs:25,outputs:26,width:2,height:3,TD:27,LR:28,zIndex:29,editable:30,locked:31,rotation:32,edge:33,connections:34,useDefaults:4,center:5,dynamic:35,title:6},null,[-1,-1])}}function yu(n){n.parentNodes.forEach(r=>bu(r));const[e,o]=wu(n);Lu(e,n),ku(e);for(let r=0;r<10;r++){let l=!1;for(let c=0;c<=o;c++)if(e[c])for(let u=0;u<e[c].length;u++){const f=e[c][u],p=Pu(e,f,u);p&&(Cn(e[c],u,p),l=!0)}if(!l)break}const a=Eu(e);for(let r=0;r<10&&Cu(e,a);r++);for(let r=0;r<2;r++){let l=!1;for(let c=0;c<=o;c++)for(let u=0;u<e[c].length;u++){const f=e[c][u],p=Mu(e,f,u);p&&(Cn(e[c],u,p),l=!0)}if(!l)break}const i=[];for(let r=0;r<=o;r++)i.push(e[r]);return i}function bu(n,e=0,o=0){const a=[],i=(r,l=0,c=0)=>{r.depth=Math.max(r.depth,l),r.nesting=Math.max(r.nesting,c),a.push(r);for(const u of r.children){const{node:f,length:p}=u;i(f,p+l,c+1)}};i(n,e,o);for(const r of a)if(r.children.length){r.nesting=r.children[0].node.nesting-1,r.depth=r.children[0].node.depth-r.children[0].length;for(const l of r.children)r.nesting=Math.min(r.nesting,l.node.nesting-1),r.depth=Math.min(r.depth,l.node.depth-l.length)}}function wu(n){let e=0;const o={};for(const a in n.nodeList){const{depth:i,parents:r,children:l,type:c,data:u}=n.nodeList[a];e=Math.max(e,i),o[i]||(o[i]=[]);const f={id:a,label:u.content,children:[],parents:[],layer:i,type:c.trim()};u.props&&(f.propsId=u.props.trim());for(const p of r)f.parents.push(p.node.id);for(const p of l)f.children.push(p.node.id);o[i].push(f)}return[o,e]}function Lu(n,e){for(const o in e.nodeList)for(const a of e.nodeList[o].children)if(a.node.depth-1>e.nodeList[o].depth){const i=e.nodeList[o].depth+1,r=a.node.depth-1,l=[];let c=0;for(let u=i;u<=r;u++){const f={id:`GHOST_${a.node.id}_${c}`,label:"",children:[],parents:[],layer:u,ignore:!0};l.push(f),c++}for(const u of a.node.parents)l[0].parents.push(u.node.id);l[l.length-1].children.push(a.node.id);for(let u=0;u<l.length-1;u++)l[u].children.push(`GHOST_${a.node.id}_${u+1}`);for(let u=r;u>=i;u--)l.length>0&&n[u].push(l[0]);for(const u of n[e.nodeList[o].depth])u.id===o&&(u.children.push(l[0].id),u.children=u.children.filter(f=>f!==a.node.id))}}function ku(n){let e=0;for(const o in n)e=Math.max(n[o].length,e);for(const o in n)if(n[o].length<e){const a=Array.from({length:e-n[o].length},()=>({id:"NULL_NODE",children:[],parents:[],layer:parseInt(o),ignore:!0}));n[o]=n[o].concat(a)}}function Rr(n,e,o){let a=0,i=0;for(const r of e.parents){for(let l=0;l<n[e.layer-1].length;l++)if(r===n[e.layer-1][l].id){a+=Math.abs(o-l);break}i++}for(const r of e.children){for(let l=0;l<n[e.layer+1].length;l++)if(r===n[e.layer+1][l].id){a+=Math.abs(o-l);break}i++}return isNaN(a/i)?0:a/i}function Zr(n,e,o){let a=0,i=0;for(const r of e.parents){for(let l=0;l<n[e.layer-1].length;l++)if(r===n[e.layer-1][l].id){a+=Math.abs(o-l);break}i++}return isNaN(a/i)?0:a/i}function Hr(n,e,o){let a=0,i=0;for(const r of e.children){for(let l=0;l<n[e.layer+1].length;l++)if(r===n[e.layer+1][l].id){a+=Math.abs(o-l);break}i++}return isNaN(a/i)?0:a/i}function Mu(n,e,o){const a=ns(n,e.layer);let i=0;e.layer===0?i=Hr(n,e,o):i=Zr(n,e,o);let r=i,l=o;for(let c=0;c<n[e.layer].length;c++)if(n[e.layer][c].id==="NULL_NODE"){Cn(n[e.layer],o,c);const f=ns(n,e.layer);let p=0;e.layer===0?p=Hr(n,e,c):p=Zr(n,e,c),f<=a&&p<r&&(r=p,l=c),Cn(n[e.layer],c,o)}return l===o?null:l}function Pu(n,e,o){const a={};let i=1/0,r=0;for(let l=0;l<n[e.layer].length;l++){const c=Rr(n,e,l),u=Rr(n,n[e.layer][l],o);a[l]=c+u}for(const l in a)a[l]<i&&(i=a[l],r=parseInt(l));return r===o?null:r}function Cn(n,e,o){const a=n[e];n[e]=n[o],n[o]=a}function Eu(n){const e=[];for(const o in n)for(const a of n[o])e.push(a);return e.sort((o,a)=>a.parents.length+a.children.length-(o.parents.length+o.children.length))}function ns(n,e){let o=0;for(let a=0;a<n[e].length;a++){const i=n[e][a],r=[],l=[];if(n[e-1])for(let c=a+1;c<n[e-1].length;c++)i.parents.includes(n[e-1][c].id)&&r.push(c);if(n[e+1])for(let c=a+1;c<n[e+1].length;c++)i.children.includes(n[e+1][c].id)&&l.push(c);for(let c=a+1;c<n[e].length;c++){const u=n[e][c];if(r.length)for(let f=0;f<n[e-1].length;f++)u.parents.includes(n[e-1][f].id)&&r.forEach(p=>{f<p&&o++});if(l.length)for(let f=0;f<n[e+1].length;f++)u.children.includes(n[e+1][f].id)&&l.forEach(p=>{f<p&&o++})}}return o}function Cu(n,e){let o=!1;for(const a of e){if(a.children.length+a.parents.length===0)return o;let i=0;for(let c=0;c<n[a.layer].length;c++)if(n[a.layer][c].id===a.id){i=c;break}let r=1/0,l=i;for(let c=0;c<n[a.layer].length;c++){Cn(n[a.layer],i,c);const u=ns(n,a.layer);u<r&&(r=u,l=c),Cn(n[a.layer],c,i)}l!==i&&(Cn(n[a.layer],i,l),o=!0)}return o}function jr(n,e,o){const a=n.slice();return a[6]=e[o],a}function Fr(n,e,o){const a=n.slice();return a[9]=e[o],a}function Tu(n){let e,o;const a=[{label:n[9].label},{id:n[9].id},{TD:!0},n[0][n[9].id],{connections:n[9].children.map(Wr)}];let i={};for(let r=0;r<a.length;r+=1)i=ss(i,a[r]);return e=new as({props:i}),{c(){ae(e.$$.fragment)},m(r,l){ee(e,r,l),o=!0},p(r,l){const c=l&3?el(a,[l&2&&{label:r[9].label},l&2&&{id:r[9].id},a[2],il(r[0][r[9].id]),l&2&&{connections:r[9].children.map(Wr)}]):{};e.$set(c)},i(r){o||(B(e.$$.fragment,r),o=!0)},o(r){G(e.$$.fragment,r),o=!1},d(r){ie(e,r)}}}function Gr(n){let e,o,a=!n[9].ignore&&Tu(n);return{c(){a&&a.c(),e=Ie()},m(i,r){a&&a.m(i,r),et(i,e,r),o=!0},p(i,r){i[9].ignore||a.p(i,r)},i(i){o||(B(a),o=!0)},o(i){G(a),o=!1},d(i){i&&Q(e),a&&a.d(i)}}}function Ur(n){let e,o,a=Se(n[6]),i=[];for(let l=0;l<a.length;l+=1)i[l]=Gr(Fr(n,a,l));const r=l=>G(i[l],1,1,()=>{i[l]=null});return{c(){for(let l=0;l<i.length;l+=1)i[l].c();e=Ie()},m(l,c){for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(l,c);et(l,e,c),o=!0},p(l,c){if(c&3){a=Se(l[6]);let u;for(u=0;u<a.length;u+=1){const f=Fr(l,a,u);i[u]?(i[u].p(f,c),B(i[u],1)):(i[u]=Gr(f),i[u].c(),B(i[u],1),i[u].m(e.parentNode,e))}for(ve(),u=a.length;u<i.length;u+=1)r(u);ye()}},i(l){if(!o){for(let c=0;c<a.length;c+=1)B(i[c]);o=!0}},o(l){i=i.filter(Boolean);for(let c=0;c<i.length;c+=1)G(i[c]);o=!1},d(l){l&&Q(e),Tn(i,l)}}}function Su(n){let e,o,a=Se(n[1]),i=[];for(let l=0;l<a.length;l+=1)i[l]=Ur(jr(n,a,l));const r=l=>G(i[l],1,1,()=>{i[l]=null});return{c(){for(let l=0;l<i.length;l+=1)i[l].c();e=Ie()},m(l,c){for(let u=0;u<i.length;u+=1)i[u]&&i[u].m(l,c);et(l,e,c),o=!0},p(l,[c]){if(c&3){a=Se(l[1]);let u;for(u=0;u<a.length;u+=1){const f=jr(l,a,u);i[u]?(i[u].p(f,c),B(i[u],1)):(i[u]=Ur(f),i[u].c(),B(i[u],1),i[u].m(e.parentNode,e))}for(ve(),u=a.length;u<i.length;u+=1)r(u);ye()}},i(l){if(!o){for(let c=0;c<a.length;c+=1)B(i[c]);o=!0}},o(l){i=i.filter(Boolean);for(let c=0;c<i.length;c+=1)G(i[c]);o=!1},d(l){l&&Q(e),Tn(i,l)}}}const Du=100,zu=100,Wr=n=>[n,"1"];function Ou(n,e,o){let{mermaid:a=""}=e,{mermaidConfig:i={}}=e;const r=Zh(a);Oe("flowchart",r);const l=yu(r),c=de("graph");let u;return qi(()=>{c.nodes.subscribe(p=>u=Object.fromEntries(p));let f=0;for(const p of l){let g=0,y=-1/0;for(const k of p)k.ignore||(u[`N-${k.id}`].position.update(()=>({x:g,y:f})),u[`N-${k.id}`].dimensions.width.subscribe(M=>g+=M),u[`N-${k.id}`].dimensions.height.subscribe(M=>y=Math.max(y,M))),g+=Du;f+=y+zu}}),n.$$set=f=>{"mermaid"in f&&o(2,a=f.mermaid),"mermaidConfig"in f&&o(0,i=f.mermaidConfig)},[i,l,a]}class Iu extends Mi{constructor(e){super(),ki(this,e,Ou,Su,di,{mermaid:2,mermaidConfig:0})}}const Au="modulepreload",xu=function(n){return"/"+n},Vr={},Kn=function(e,o,a){let i=Promise.resolve();if(o&&o.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=Promise.allSettled(o.map(u=>{if(u=xu(u),u in Vr)return;Vr[u]=!0;const f=u.endsWith(".css"),p=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${p}`))return;const g=document.createElement("link");if(g.rel=f?"stylesheet":Au,f||(g.as="script"),g.crossOrigin="",g.href=u,c&&g.setAttribute("nonce",c),document.head.appendChild(g),f)return new Promise((y,k)=>{g.addEventListener("load",y),g.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${u}`)))})}))}function r(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return i.then(l=>{for(const c of l||[])c.status==="rejected"&&r(c.reason);return e().catch(r)})},Nu=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"],Bu=new Set(Nu),Yr=n=>Bu.has(n);function Ru(n){let e,o,a;return{c(){e=S("input"),m(e,"placeholder",n[0]),m(e,"type","text")},m(i,r){et(i,e,r),Be(e,n[1]),o||(a=[ft(e,"keydown",en(n[3])),ft(e,"click",en(n[4])),ft(e,"mousedown",en(n[5])),ft(e,"input",n[6])],o=!0)},p(i,[r]){r&1&&m(e,"placeholder",i[0]),r&2&&e.value!==i[1]&&Be(e,i[1])},i:Gt,o:Gt,d(i){i&&Q(e),o=!1,hi(a)}}}function Zu(n,e,o){let a,{placeholder:i}=e;const r=de("textStore");bt(n,r,p=>o(1,a=p));function l(p){Ke.call(this,n,p)}function c(p){Ke.call(this,n,p)}function u(p){Ke.call(this,n,p)}function f(){a=this.value,r.set(a)}return n.$$set=p=>{"placeholder"in p&&o(0,i=p.placeholder)},[i,a,r,l,c,u,f]}class Hu extends Mi{constructor(e){super(),ki(this,e,Zu,Ru,di,{placeholder:0})}}function ju(n){let e,o,a,i,r,l,c,u,f,p,g,y,k;return l=new Hu({props:{placeholder:"Node Label"}}),{c(){e=S("div"),o=S("span"),o.textContent="Editor",a=K(),i=S("button"),i.textContent="X",r=K(),ae(l.$$.fragment),c=K(),u=S("button"),u.textContent="Delete Node",f=K(),p=S("button"),p.textContent="Resize Node",ht(o,"color","white"),ht(o,"font-size","45px"),ht(i,"position","absolute"),ht(i,"top","10px"),ht(i,"right","10px"),m(e,"class","editor svelte-1nv0yho")},m(M,C){et(M,e,C),w(e,o),w(e,a),w(e,i),w(e,r),ee(l,e,null),w(e,c),w(e,u),w(e,f),w(e,p),g=!0,y||(k=[ft(i,"click",n[6]),ft(u,"click",n[3]),ft(p,"click",n[4]),ft(e,"contextmenu",n[2])],y=!0)},p:Gt,i(M){g||(B(l.$$.fragment,M),g=!0)},o(M){G(l.$$.fragment,M),g=!1},d(M){M&&Q(e),ie(l),y=!1,hi(k)}}}function Fu(n){let e,o;return e=new as({props:{zIndex:1/0,position:n[0],bgColor:"white",id:"editor",$$slots:{default:[ju]},$$scope:{ctx:n}}}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},p(a,[i]){const r={};i&1&&(r.position=a[0]),i&512&&(r.$$scope={dirty:i,ctx:a}),e.$set(r)},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function Gu(n,e,o){let{editing:a}=e;const i=de("graph");Oe("graph",i),Oe("textStore",a.label),Oe("colorStore",a.bgColor);let r={x:150,y:50};function l(p){p.preventDefault(),o(0,r={x:p.clientX,y:p.clientY}),i.editing.set(a)}function c(){i.nodes.delete(a.id),i.editing.set(null)}function u(){const p=a.id,g=i.nodes.get(p);if(g){const y=g.dimensions.width,k=g.dimensions.height,M=prompt("Enter new width (for example:250):",y?y.toString():""),C=prompt("Enter new height (for example:200):",k?k.toString():"");if(M===null||C===null)return;g.dimensions.width.set(parseInt(M,10)||0),g.dimensions.height.set(parseInt(C,10)||0),g.resizingWidth.set(!0),g.resizingHeight.set(!0)}}const f=()=>i.editing.set(null);return n.$$set=p=>{"editing"in p&&o(5,a=p.editing)},i.cursor,[r,i,l,c,u,a,f]}class Uu extends Mi{constructor(e){super(),ki(this,e,Gu,Fu,di,{editing:5})}}function Wu(n){let e,o,a,i;return{c(){e=S("div"),o=S("div"),m(o,"class","bounding-box svelte-1e5jg43"),ht(o,"background-color",n[6]),m(e,"role","button"),m(e,"tabindex","0"),m(e,"class","bounding-box-border svelte-1e5jg43"),m(e,"id",n[2]),ht(e,"border","solid 4px "+n[6]),ht(e,"top",`${n[3].y}px`),ht(e,"left",`${n[3].x}px`),ht(e,"width",`${n[4]}px`),ht(e,"height",`${n[5]}px`)},m(r,l){et(r,e,l),w(e,o),a||(i=[ft(e,"contextmenu",en(Xi(n[12]))),ft(e,"mousedown",en(Xi(n[9])))],a=!0)},p(r,[l]){l&64&&ht(o,"background-color",r[6]),l&4&&m(e,"id",r[2]),l&64&&ht(e,"border","solid 4px "+r[6]);const c=l&64;(l&72||c)&&ht(e,"top",`${r[3].y}px`),(l&72||c)&&ht(e,"left",`${r[3].x}px`),(l&80||c)&&ht(e,"width",`${r[4]}px`),(l&96||c)&&ht(e,"height",`${r[5]}px`)},i:Gt,o:Gt,d(r){r&&Q(e),a=!1,hi(i)}}}function Vu(n,e,o){let a,i,r=Gt,l=()=>(r(),r=gi(k,F=>o(3,i=F)),k),c,u,f,p=Gt,g=()=>(p(),p=gi(M,F=>o(6,f=F)),M);n.$$.on_destroy.push(()=>r()),n.$$.on_destroy.push(()=>p());let{dimensions:y}=e,{position:k}=e;l();let{color:M}=e;g();let{groupName:C}=e;const{width:D,height:z}=y;bt(n,D,F=>o(4,c=F)),bt(n,z,F=>o(5,u=F));const T=Fn();function x(){T("groupClick",{groupName:C})}function j(F){Ke.call(this,n,F)}return n.$$set=F=>{"dimensions"in F&&o(10,y=F.dimensions),"position"in F&&l(o(0,k=F.position)),"color"in F&&g(o(1,M=F.color)),"groupName"in F&&o(11,C=F.groupName)},n.$$.update=()=>{n.$$.dirty&2048&&o(2,a=`${C}-bounding-box`)},[k,M,a,i,c,u,f,D,z,x,y,C,j]}class Yu extends Mi{constructor(e){super(),ki(this,e,Vu,Wu,di,{dimensions:10,position:0,color:1,groupName:11})}}function Xr(n,e,o){const a=n.slice();return a[4]=e[o][0],a[5]=e[o][1],a}function qr(n,e){let o,a,i;const r=[e[5],{groupName:e[4]}];let l={};for(let c=0;c<r.length;c+=1)l=ss(l,r[c]);return a=new Yu({props:l}),a.$on("groupClick",e[2]),{key:n,first:null,c(){o=Ie(),ae(a.$$.fragment),this.first=o},m(c,u){et(c,o,u),ee(a,c,u),i=!0},p(c,u){e=c;const f=u&1?el(r,[il(e[5]),{groupName:e[4]}]):{};a.$set(f)},i(c){i||(B(a.$$.fragment,c),i=!0)},o(c){G(a.$$.fragment,c),i=!1},d(c){c&&Q(o),ie(a,c)}}}function Xu(n){let e=[],o=new Map,a,i,r=Se(Array.from(n[0]));const l=c=>c[4];for(let c=0;c<r.length;c+=1){let u=Xr(n,r,c),f=l(u);o.set(f,e[c]=qr(f,u))}return{c(){for(let c=0;c<e.length;c+=1)e[c].c();a=Ie()},m(c,u){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(c,u);et(c,a,u),i=!0},p(c,[u]){u&1&&(r=Se(Array.from(c[0])),ve(),e=vn(e,u,l,1,c,r,o,a.parentNode,io,qr,a,Xr),ye())},i(c){if(!i){for(let u=0;u<r.length;u+=1)B(e[u]);i=!0}},o(c){for(let u=0;u<e.length;u+=1)G(e[u]);i=!1},d(c){c&&Q(a);for(let u=0;u<e.length;u+=1)e[u].d(c)}}}function qu(n,e,o){let a;const r=de("graph").groupBoxes;bt(n,r,c=>o(0,a=c));function l(c){Ke.call(this,n,c)}return[a,r,l]}class Ku extends Mi{constructor(e){super(),ki(this,e,qu,Xu,di,{})}}function Ju(n){let e,o,a,i;const r=n[11].default,l=ke(r,n,n[10],null);return{c(){e=S("div"),l&&l.c(),m(e,"class","svelvet-graph-wrapper svelte-19pa6i0"),m(e,"role","presentation"),ht(e,"transform",n[0])},m(c,u){et(c,e,u),l&&l.m(e,null),o=!0,a||(i=[ft(e,"contextmenu",Qn(Xi(n[12]))),ft(e,"click",Qn(Xi(n[13]))),ft(e,"touchstart",Qn(Xi(n[14])))],a=!0)},p(c,[u]){l&&l.p&&(!o||u&1024)&&Pe(l,r,c,c[10],o?Me(r,c[10],u,null):Ee(c[10]),null),u&1&&ht(e,"transform",c[0])},i(c){o||(B(l,c),o=!0)},o(c){G(l,c),o=!1},d(c){c&&Q(e),l&&l.d(c),a=!1,hi(i)}}}function Qu(n,e,o){let a,i,r,l,c,{$$slots:u={},$$scope:f}=e;const p=de("graph"),g=p.transforms,y=g.scale;bt(n,y,W=>o(9,c=W));const k=g.translation;bt(n,k,W=>o(8,l=W));const M=p.cursor;bt(n,M,W=>o(15,r=W));let{isMovable:C}=e,D,z=!1;function T(){Nt(k,l=Kh(Lt(Ri),r,g),l),o(5,D=requestAnimationFrame(T))}function x(W){Ke.call(this,n,W)}function j(W){Ke.call(this,n,W)}function F(W){Ke.call(this,n,W)}return n.$$set=W=>{"isMovable"in W&&o(4,C=W.isMovable),"$$scope"in W&&o(10,f=W.$$scope)},n.$$.update=()=>{n.$$.dirty&256&&o(7,a=l),n.$$.dirty&640&&o(0,i=`translate(${a.x}px, ${a.y}px) scale(${c})`),n.$$.dirty&112&&(C&&!z?(o(6,z=!0),o(5,D=requestAnimationFrame(T))):(!C||!z)&&(o(6,z=!1),cancelAnimationFrame(D)))},[i,y,k,M,C,D,z,a,l,c,f,u,x,j,F]}class $u extends Mi{constructor(e){super(),ki(this,e,Qu,Ju,di,{isMovable:4})}}function td(n){let e,o,a;const i=n[8].default,r=ke(i,n,n[9],null);return o=new Ku({}),o.$on("groupClick",n[5]),{c(){r&&r.c(),e=K(),ae(o.$$.fragment)},m(l,c){r&&r.m(l,c),et(l,e,c),ee(o,l,c),a=!0},p(l,c){r&&r.p&&(!a||c&512)&&Pe(r,i,l,l[9],a?Me(i,l[9],c,null):Ee(l[9]),null)},i(l){a||(B(r,l),B(o.$$.fragment,l),a=!0)},o(l){G(r,l),G(o.$$.fragment,l),a=!1},d(l){l&&Q(e),r&&r.d(l),ie(o,l)}}}function ed(n){let e,o;return e=new $u({props:{isMovable:n[0],$$slots:{default:[td]},$$scope:{ctx:n}}}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},p(a,[i]){const r={};i&1&&(r.isMovable=a[0]),i&512&&(r.$$scope={dirty:i,ctx:a}),e.$set(r)},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function id(n,e,o){let a,i,r,l,c,u;bt(n,Ri,x=>o(13,l=x)),bt(n,Vi,x=>o(7,u=x));let{$$slots:f={},$$scope:p}=e;console.log("Componente GraphRenderer.svelte");const g=de("graph"),y=de("snapTo");let{isMovable:k}=e;const M=g.activeGroup;bt(n,M,x=>o(6,c=x));const C=g.groups;bt(n,C,x=>o(10,a=x));const D=g.initialNodePositions;bt(n,D,x=>o(11,i=x));const z=g.cursor;bt(n,z,x=>o(12,r=x));function T(x){Nt(Vi,u=!0,u);const{groupName:j}=x.detail;Nt(M,c=j,c),Nt(Ri,l=r,l),Nt(D,i=ll(a[j].nodes),i)}return n.$$set=x=>{"isMovable"in x&&o(0,k=x.isMovable),"$$scope"in x&&o(9,p=x.$$scope)},n.$$.update=()=>{n.$$.dirty&192&&c&&u&&sc(g,y)},[k,M,C,D,z,T,c,u,f,p]}class nd extends Mi{constructor(e){super(),ki(this,e,id,ed,di,{isMovable:0})}}function od(n){let e,o;return{c(){e=qt("line"),o=qt("line"),m(e,"class","background-line svelte-rryw83"),m(e,"x1",n[11]),m(e,"y1",0),m(e,"x2",n[11]),m(e,"y2",n[6]),m(e,"stroke-width",n[5]),ht(e,"--calculated-dot-color",n[2]),m(o,"class","background-line svelte-rryw83"),m(o,"y1",n[11]),m(o,"x1",0),m(o,"y2",n[11]),m(o,"x2",n[6]),m(o,"stroke-width",n[5]),ht(o,"--calculated-dot-color",n[2])},m(a,i){et(a,e,i),et(a,o,i)},p(a,i){i&2048&&m(e,"x1",a[11]),i&2048&&m(e,"x2",a[11]),i&64&&m(e,"y2",a[6]),i&32&&m(e,"stroke-width",a[5]),i&4&&ht(e,"--calculated-dot-color",a[2]),i&2048&&m(o,"y1",a[11]),i&2048&&m(o,"y2",a[11]),i&64&&m(o,"x2",a[6]),i&32&&m(o,"stroke-width",a[5]),i&4&&ht(o,"--calculated-dot-color",a[2])},d(a){a&&(Q(e),Q(o))}}}function sd(n){let e;return{c(){e=qt("circle"),m(e,"class","background-dot svelte-rryw83"),m(e,"r",n[5]),m(e,"cx",n[11]),m(e,"cy",n[11]),ht(e,"--calculated-dot-color",n[2])},m(o,a){et(o,e,a)},p(o,a){a&32&&m(e,"r",o[5]),a&2048&&m(e,"cx",o[11]),a&2048&&m(e,"cy",o[11]),a&4&&ht(e,"--calculated-dot-color",o[2])},d(o){o&&Q(e)}}}function Kr(n){let e,o,a;function i(c,u){if(c[0]==="dots")return ad;if(c[0]==="lines")return rd}let r=i(n),l=r&&r(n);return{c(){e=qt("pattern"),l&&l.c(),m(e,"id","graph-coarse-pattern"),m(e,"x",n[7]),m(e,"y",n[8]),m(e,"width",o=n[6]*n[3]),m(e,"height",a=n[6]*n[3]),m(e,"patternUnits","userSpaceOnUse")},m(c,u){et(c,e,u),l&&l.m(e,null)},p(c,u){r===(r=i(c))&&l?l.p(c,u):(l&&l.d(1),l=r&&r(c),l&&(l.c(),l.m(e,null))),u&128&&m(e,"x",c[7]),u&256&&m(e,"y",c[8]),u&72&&o!==(o=c[6]*c[3])&&m(e,"width",o),u&72&&a!==(a=c[6]*c[3])&&m(e,"height",a)},d(c){c&&Q(e),l&&l.d()}}}function rd(n){let e,o,a,i,r,l;return{c(){e=qt("line"),i=qt("line"),m(e,"class","background-line svelte-rryw83"),m(e,"x1",n[11]),m(e,"y1",0),m(e,"x2",n[11]),m(e,"y2",o=n[6]*n[3]),m(e,"stroke-width",a=n[5]*1.2),ht(e,"--calculated-dot-color",n[2]),m(i,"class","background-line svelte-rryw83"),m(i,"y1",n[11]),m(i,"x1",0),m(i,"y2",n[11]),m(i,"x2",r=n[6]*n[3]),m(i,"stroke-width",l=n[5]*1.2),ht(i,"--calculated-dot-color",n[2])},m(c,u){et(c,e,u),et(c,i,u)},p(c,u){u&2048&&m(e,"x1",c[11]),u&2048&&m(e,"x2",c[11]),u&72&&o!==(o=c[6]*c[3])&&m(e,"y2",o),u&32&&a!==(a=c[5]*1.2)&&m(e,"stroke-width",a),u&4&&ht(e,"--calculated-dot-color",c[2]),u&2048&&m(i,"y1",c[11]),u&2048&&m(i,"y2",c[11]),u&72&&r!==(r=c[6]*c[3])&&m(i,"x2",r),u&32&&l!==(l=c[5]*1.2)&&m(i,"stroke-width",l),u&4&&ht(i,"--calculated-dot-color",c[2])},d(c){c&&(Q(e),Q(i))}}}function ad(n){let e,o;return{c(){e=qt("circle"),m(e,"class","background-dot svelte-rryw83"),m(e,"r",o=n[5]*2),m(e,"cx",n[11]),m(e,"cy",n[11]),ht(e,"--calculated-dot-color",n[2])},m(a,i){et(a,e,i)},p(a,i){i&32&&o!==(o=a[5]*2)&&m(e,"r",o),i&2048&&m(e,"cx",a[11]),i&2048&&m(e,"cy",a[11]),i&4&&ht(e,"--calculated-dot-color",a[2])},d(a){a&&Q(e)}}}function Jr(n){let e;return{c(){e=qt("rect"),m(e,"width","100%"),m(e,"height","100%"),m(e,"fill","url(#graph-coarse-pattern)"),m(e,"opacity",n[10])},m(o,a){et(o,e,a)},p(o,a){a&1024&&m(e,"opacity",o[10])},d(o){o&&Q(e)}}}function ld(n){let e,o,a,i,r;function l(g,y){if(g[0]==="dots")return sd;if(g[0]==="lines")return od}let c=l(n),u=c&&c(n),f=n[3]>0&&Kr(n),p=n[3]>0&&Jr(n);return{c(){e=S("div"),o=qt("svg"),a=qt("defs"),i=qt("pattern"),u&&u.c(),f&&f.c(),r=qt("rect"),p&&p.c(),m(i,"id","graph-pattern"),m(i,"x",n[7]),m(i,"y",n[8]),m(i,"width",n[6]),m(i,"height",n[6]),m(i,"patternUnits","userSpaceOnUse"),m(r,"width","100%"),m(r,"height","100%"),m(r,"fill","url(#graph-pattern)"),m(r,"opacity",n[9]),m(o,"class","svelte-rryw83"),m(e,"id","background-wrapper"),m(e,"class","svelte-rryw83"),ht(e,"--calculated-background-color",n[1])},m(g,y){et(g,e,y),w(e,o),w(o,a),w(a,i),u&&u.m(i,null),f&&f.m(a,null),w(o,r),p&&p.m(o,null),n[24](e)},p(g,[y]){c===(c=l(g))&&u?u.p(g,y):(u&&u.d(1),u=c&&c(g),u&&(u.c(),u.m(i,null))),y&128&&m(i,"x",g[7]),y&256&&m(i,"y",g[8]),y&64&&m(i,"width",g[6]),y&64&&m(i,"height",g[6]),g[3]>0?f?f.p(g,y):(f=Kr(g),f.c(),f.m(a,null)):f&&(f.d(1),f=null),y&512&&m(r,"opacity",g[9]),g[3]>0?p?p.p(g,y):(p=Jr(g),p.c(),p.m(o,null)):p&&(p.d(1),p=null),y&2&&ht(e,"--calculated-background-color",g[1])},i:Gt,o:Gt,d(g){g&&Q(e),u&&u.d(),f&&f.d(),p&&p.d(),n[24](null)}}}function hd(n,e,o){let a,i,r,l,c,u,f;const p=de("graph");let{style:g="dots"}=e,{gridWidth:y=Dh}=e,{dotSize:k=zh}=e,{bgColor:M=null}=e,{dotColor:C=null}=e,{opacityThreshold:D=3}=e,{majorGrid:z=0}=e,{minOpacity:T=.4}=e;const x=p.transforms,j=x.scale;bt(n,j,V=>o(22,u=V));const F=x.translation;bt(n,F,V=>o(23,f=V));let W,Y,st,ot,$,ct=1,N=1;function lt(V){nn[V?"unshift":"push"](()=>{W=V,o(4,W)})}return n.$$set=V=>{"style"in V&&o(0,g=V.style),"gridWidth"in V&&o(14,y=V.gridWidth),"dotSize"in V&&o(15,k=V.dotSize),"bgColor"in V&&o(1,M=V.bgColor),"dotColor"in V&&o(2,C=V.dotColor),"opacityThreshold"in V&&o(16,D=V.opacityThreshold),"majorGrid"in V&&o(3,z=V.majorGrid),"minOpacity"in V&&o(17,T=V.minOpacity)},n.$$.update=()=>{n.$$.dirty&8388608&&o(21,a=f),n.$$.dirty&4194304&&o(20,i=u),n.$$.dirty&1064960&&o(6,r=i*y),n.$$.dirty&1081344&&o(5,l=i*k/2),n.$$.dirty&64&&o(11,c=r/2),n.$$.dirty&4128816&&(o(18,Y=(W==null?void 0:W.offsetWidth)||0),o(19,st=(W==null?void 0:W.offsetHeight)||0),o(7,ot=(Y+l)*(1-i)/2+a.x),o(8,$=(st+l)*(1-i)/2+a.y),o(9,ct=i>D?1:i/D+T),o(10,N=i>D/3?1:i/(D/3)+T))},[g,M,C,z,W,l,r,ot,$,ct,N,c,j,F,y,k,D,T,Y,st,i,a,u,f,lt]}class cd extends Mi{constructor(e){super(),ki(this,e,hd,ld,di,{style:0,gridWidth:14,dotSize:15,bgColor:1,dotColor:2,opacityThreshold:16,majorGrid:3,minOpacity:17})}}function ud(n){let e,o;return{c(){e=S("div"),o=S("div"),m(o,"class","selection-box svelte-10ds4jd"),Vt(o,"creating",n[0]),m(e,"class","selection-border svelte-10ds4jd"),Vt(e,"creating",n[0]),ht(e,"--prop-selection-box-color",n[1]),ht(e,"height",n[4]),ht(e,"width",n[3]),ht(e,"top",n[6]),ht(e,"left",n[5])},m(a,i){et(a,e,i),w(e,o),n[18](o)},p(a,[i]){i&1&&Vt(o,"creating",a[0]),i&1&&Vt(e,"creating",a[0]),i&2&&ht(e,"--prop-selection-box-color",a[1]),i&16&&ht(e,"height",a[4]),i&8&&ht(e,"width",a[3]),i&64&&ht(e,"top",a[6]),i&32&&ht(e,"left",a[5])},i:Gt,o:Gt,d(a){a&&Q(e),n[18](null)}}}function dd(n,e,o){let a,i,r,l,c,u,f,p,g,y,k=Gt,M=()=>(k(),k=gi(a,N=>o(20,y=N)),a),C,D;bt(n,ol,N=>o(16,C=N)),n.$$.on_destroy.push(()=>k());let{graph:z}=e,{anchor:T}=e,{adding:x=!1}=e,{creating:j=!1}=e,{color:F=null}=e;const{groups:W}=z;bt(n,W,N=>o(17,D=N));let Y,st;qi(ot);function ot(){Y=Array.from(document.querySelectorAll(".svelvet-node")).map(lt=>{const{top:V,left:yt,width:_t,height:U}=lt.getBoundingClientRect();return{id:lt.id,top:V,left:yt,width:_t,height:U}})}function $(){if(!Y)return;const N=Y.reduce((lt,V)=>{if(c+T.left<=V.left&&l+T.top<=V.top&&c+T.left+Math.abs(r)>=V.left+V.width&&l+T.top+Math.abs(i)>=V.top+V.height){const yt=V.id,_t=z.nodes.get(yt);if(!_t)return lt;lt.push(_t)}return lt},[]);x?N.forEach(lt=>{y.add(lt)}):Nt(a,y=new Set(N),y),a.set(y)}function ct(N){nn[N?"unshift":"push"](()=>{st=N,o(2,st)})}return n.$$set=N=>{"graph"in N&&o(9,z=N.graph),"anchor"in N&&o(10,T=N.anchor),"adding"in N&&o(11,x=N.adding),"creating"in N&&o(0,j=N.creating),"color"in N&&o(1,F=N.color)},n.$$.update=()=>{n.$$.dirty&131072&&M(o(7,a=D.selected.nodes)),n.$$.dirty&66560&&o(12,i=C.y-T.y-T.top),n.$$.dirty&66560&&o(14,r=C.x-T.x-T.left),n.$$.dirty&5120&&o(13,l=Math.min(T.y,T.y+i)),n.$$.dirty&17408&&o(15,c=Math.min(T.x,T.x+r)),n.$$.dirty&8192&&o(6,u=`${l}px`),n.$$.dirty&32768&&o(5,f=`${c}px`),n.$$.dirty&4096&&o(4,p=`${Math.abs(i)}px`),n.$$.dirty&16384&&o(3,g=`${Math.abs(r)}px`),n.$$.dirty&20480&&(r||i)&&$()},[j,F,st,g,p,f,u,a,W,z,T,x,i,l,r,c,C,D,ct]}class fd extends Mi{constructor(e){super(),ki(this,e,dd,ud,di,{graph:9,anchor:10,adding:11,creating:0,color:1})}}const _d=n=>({}),Qr=n=>({}),pd=n=>({}),$r=n=>({}),md=n=>({}),ta=n=>({}),gd=n=>({}),ea=n=>({}),vd=n=>({}),ia=n=>({}),yd=n=>({}),na=n=>({});function oa(n){let e,o;return e=new Uu({props:{editing:n[24]}}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},p(a,i){const r={};i[0]&16777216&&(r.editing=a[24]),e.$set(r)},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function bd(n){let e,o,a=n[24]&&oa(n);const i=n[56].default,r=ke(i,n,n[58],null);return{c(){a&&a.c(),e=K(),r&&r.c()},m(l,c){a&&a.m(l,c),et(l,e,c),r&&r.m(l,c),o=!0},p(l,c){l[24]?a?(a.p(l,c),c[0]&16777216&&B(a,1)):(a=oa(l),a.c(),B(a,1),a.m(e.parentNode,e)):a&&(ve(),G(a,1,1,()=>{a=null}),ye()),r&&r.p&&(!o||c[1]&134217728)&&Pe(r,i,l,l[58],o?Me(i,l[58],c,null):Ee(l[58]),null)},i(l){o||(B(a),B(r,l),o=!0)},o(l){G(a),G(r,l),o=!1},d(l){l&&Q(e),a&&a.d(l),r&&r.d(l)}}}function wd(n){let e,o;return e=new cd({}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},p:Gt,i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function Ld(n){let e;const o=n[56].background,a=ke(o,n,n[58],na);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,r){a&&a.p&&(!e||r[1]&134217728)&&Pe(a,o,i,i[58],e?Me(o,i[58],r,yd):Ee(i[58]),na)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function sa(n){let e,o,a;var i=n[14];function r(l,c){return{}}return i&&(e=fn(i,r())),{c(){e&&ae(e.$$.fragment),o=Ie()},m(l,c){e&&ee(e,l,c),et(l,o,c),a=!0},p(l,c){if(c[0]&16384&&i!==(i=l[14])){if(e){ve();const u=e;G(u.$$.fragment,1,0,()=>{ie(u,1)}),ye()}i?(e=fn(i,r()),ae(e.$$.fragment),B(e.$$.fragment,1),ee(e,o.parentNode,o)):e=null}},i(l){a||(e&&B(e.$$.fragment,l),a=!0)},o(l){e&&G(e.$$.fragment,l),a=!1},d(l){l&&Q(o),e&&ie(e,l)}}}function ra(n){let e,o,a;var i=n[15];function r(l,c){return{}}return i&&(e=fn(i,r())),{c(){e&&ae(e.$$.fragment),o=Ie()},m(l,c){e&&ee(e,l,c),et(l,o,c),a=!0},p(l,c){if(c[0]&32768&&i!==(i=l[15])){if(e){ve();const u=e;G(u.$$.fragment,1,0,()=>{ie(u,1)}),ye()}i?(e=fn(i,r()),ae(e.$$.fragment),B(e.$$.fragment,1),ee(e,o.parentNode,o)):e=null}},i(l){a||(e&&B(e.$$.fragment,l),a=!0)},o(l){e&&G(e.$$.fragment,l),a=!1},d(l){l&&Q(o),e&&ie(e,l)}}}function aa(n){let e,o,a;var i=n[13];function r(l,c){return{}}return i&&(e=fn(i,r())),{c(){e&&ae(e.$$.fragment),o=Ie()},m(l,c){e&&ee(e,l,c),et(l,o,c),a=!0},p(l,c){if(c[0]&8192&&i!==(i=l[13])){if(e){ve();const u=e;G(u.$$.fragment,1,0,()=>{ie(u,1)}),ye()}i?(e=fn(i,r()),ae(e.$$.fragment),B(e.$$.fragment,1),ee(e,o.parentNode,o)):e=null}},i(l){a||(e&&B(e.$$.fragment,l),a=!0)},o(l){e&&G(e.$$.fragment,l),a=!1},d(l){l&&Q(o),e&&ie(e,l)}}}function la(n){let e,o,a;var i=n[16];function r(l,c){return{}}return i&&(e=fn(i,r())),{c(){e&&ae(e.$$.fragment),o=Ie()},m(l,c){e&&ee(e,l,c),et(l,o,c),a=!0},p(l,c){if(c[0]&65536&&i!==(i=l[16])){if(e){ve();const u=e;G(u.$$.fragment,1,0,()=>{ie(u,1)}),ye()}i?(e=fn(i,r()),ae(e.$$.fragment),B(e.$$.fragment,1),ee(e,o.parentNode,o)):e=null}},i(l){a||(e&&B(e.$$.fragment,l),a=!0)},o(l){e&&G(e.$$.fragment,l),a=!1},d(l){l&&Q(o),e&&ie(e,l)}}}function ha(n){let e,o,a;var i=n[17];function r(l,c){return{}}return i&&(e=fn(i,r())),{c(){e&&ae(e.$$.fragment),o=Ie()},m(l,c){e&&ee(e,l,c),et(l,o,c),a=!0},p(l,c){if(c[0]&131072&&i!==(i=l[17])){if(e){ve();const u=e;G(u.$$.fragment,1,0,()=>{ie(u,1)}),ye()}i?(e=fn(i,r()),ae(e.$$.fragment),B(e.$$.fragment,1),ee(e,o.parentNode,o)):e=null}},i(l){a||(e&&B(e.$$.fragment,l),a=!0)},o(l){e&&G(e.$$.fragment,l),a=!1},d(l){l&&Q(o),e&&ie(e,l)}}}function ca(n){let e,o;return e=new fd({props:{creating:n[20],anchor:n[18],graph:n[3],adding:n[21],color:n[9]}}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},p(a,i){const r={};i[0]&1048576&&(r.creating=a[20]),i[0]&262144&&(r.anchor=a[18]),i[0]&8&&(r.graph=a[3]),i[0]&2097152&&(r.adding=a[21]),i[0]&512&&(r.color=a[9]),e.$set(r)},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function kd(n){let e,o,a,i,r,l,c,u,f,p,g,y,k,M,C,D,z,T,x,j;o=new nd({props:{isMovable:n[22],$$slots:{default:[bd]},$$scope:{ctx:n}}});const F=[Ld,wd],W=[];function Y(H,q){return H[10]?0:1}i=Y(n),r=W[i]=F[i](n);let st=n[0]&&sa(n),ot=n[1]&&ra(n),$=n[6]&&aa(n),ct=n[2]&&la(n),N=n[12]&&ha(n);const lt=n[56].minimap,V=ke(lt,n,n[58],ia),yt=n[56].drawer,_t=ke(yt,n,n[58],ea),U=n[56].controls,Z=ke(U,n,n[58],ta),St=n[56].toggle,at=ke(St,n,n[58],$r),Mt=n[56].contrast,Ct=ke(Mt,n,n[58],Qr);let wt=n[19]&&!n[8]&&ca(n);return{c(){e=S("section"),ae(o.$$.fragment),a=K(),r.c(),l=K(),st&&st.c(),c=K(),ot&&ot.c(),u=K(),$&&$.c(),f=K(),ct&&ct.c(),p=K(),N&&N.c(),g=K(),V&&V.c(),y=K(),_t&&_t.c(),k=K(),Z&&Z.c(),M=K(),at&&at.c(),C=K(),Ct&&Ct.c(),D=K(),wt&&wt.c(),m(e,"role","presentation"),m(e,"id",z=n[3].id),m(e,"class","svelvet-wrapper svelte-13nq7cv"),m(e,"title",n[11]),m(e,"tabindex",0),ht(e,"width",n[4]?n[4]+"px":"100%"),ht(e,"height",n[5]?n[5]+"px":"100%"),ht(e,"cursor",n[7]?"move":"default")},m(H,q){et(H,e,q),ee(o,e,null),w(e,a),W[i].m(e,null),w(e,l),st&&st.m(e,null),w(e,c),ot&&ot.m(e,null),w(e,u),$&&$.m(e,null),w(e,f),ct&&ct.m(e,null),w(e,p),N&&N.m(e,null),w(e,g),V&&V.m(e,null),w(e,y),_t&&_t.m(e,null),w(e,k),Z&&Z.m(e,null),w(e,M),at&&at.m(e,null),w(e,C),Ct&&Ct.m(e,null),w(e,D),wt&&wt.m(e,null),n[57](e),T=!0,x||(j=[ft(window,"touchend",n[36]),ft(window,"mouseup",n[36]),ft(window,"resize",n[35]),ft(window,"scroll",n[35]),ft(e,"wheel",Xi(n[43])),ft(e,"mousedown",Qn(Xi(n[37]))),ft(e,"touchend",Xi(n[39])),ft(e,"touchstart",Qn(Xi(n[38]))),ft(e,"keydown",n[40]),ft(e,"keyup",n[42]),ft(e,"dragover",Xi(Md)),ft(e,"drop",n[41])],x=!0)},p(H,q){const X={};q[0]&4194304&&(X.isMovable=H[22]),q[0]&16777216|q[1]&134217728&&(X.$$scope={dirty:q,ctx:H}),o.$set(X);let I=i;i=Y(H),i===I?W[i].p(H,q):(ve(),G(W[I],1,1,()=>{W[I]=null}),ye(),r=W[i],r?r.p(H,q):(r=W[i]=F[i](H),r.c()),B(r,1),r.m(e,l)),H[0]?st?(st.p(H,q),q[0]&1&&B(st,1)):(st=sa(H),st.c(),B(st,1),st.m(e,c)):st&&(ve(),G(st,1,1,()=>{st=null}),ye()),H[1]?ot?(ot.p(H,q),q[0]&2&&B(ot,1)):(ot=ra(H),ot.c(),B(ot,1),ot.m(e,u)):ot&&(ve(),G(ot,1,1,()=>{ot=null}),ye()),H[6]?$?($.p(H,q),q[0]&64&&B($,1)):($=aa(H),$.c(),B($,1),$.m(e,f)):$&&(ve(),G($,1,1,()=>{$=null}),ye()),H[2]?ct?(ct.p(H,q),q[0]&4&&B(ct,1)):(ct=la(H),ct.c(),B(ct,1),ct.m(e,p)):ct&&(ve(),G(ct,1,1,()=>{ct=null}),ye()),H[12]?N?(N.p(H,q),q[0]&4096&&B(N,1)):(N=ha(H),N.c(),B(N,1),N.m(e,g)):N&&(ve(),G(N,1,1,()=>{N=null}),ye()),V&&V.p&&(!T||q[1]&134217728)&&Pe(V,lt,H,H[58],T?Me(lt,H[58],q,vd):Ee(H[58]),ia),_t&&_t.p&&(!T||q[1]&134217728)&&Pe(_t,yt,H,H[58],T?Me(yt,H[58],q,gd):Ee(H[58]),ea),Z&&Z.p&&(!T||q[1]&134217728)&&Pe(Z,U,H,H[58],T?Me(U,H[58],q,md):Ee(H[58]),ta),at&&at.p&&(!T||q[1]&134217728)&&Pe(at,St,H,H[58],T?Me(St,H[58],q,pd):Ee(H[58]),$r),Ct&&Ct.p&&(!T||q[1]&134217728)&&Pe(Ct,Mt,H,H[58],T?Me(Mt,H[58],q,_d):Ee(H[58]),Qr),H[19]&&!H[8]?wt?(wt.p(H,q),q[0]&524544&&B(wt,1)):(wt=ca(H),wt.c(),B(wt,1),wt.m(e,null)):wt&&(ve(),G(wt,1,1,()=>{wt=null}),ye()),(!T||q[0]&8&&z!==(z=H[3].id))&&m(e,"id",z),(!T||q[0]&2048)&&m(e,"title",H[11]),q[0]&16&&ht(e,"width",H[4]?H[4]+"px":"100%"),q[0]&32&&ht(e,"height",H[5]?H[5]+"px":"100%"),q[0]&128&&ht(e,"cursor",H[7]?"move":"default")},i(H){T||(B(o.$$.fragment,H),B(r),B(st),B(ot),B($),B(ct),B(N),B(V,H),B(_t,H),B(Z,H),B(at,H),B(Ct,H),B(wt),T=!0)},o(H){G(o.$$.fragment,H),G(r),G(st),G(ot),G($),G(ct),G(N),G(V,H),G(_t,H),G(Z,H),G(at,H),G(Ct,H),G(wt),T=!1},d(H){H&&Q(e),ie(o),W[i].d(),st&&st.d(),ot&&ot.d(),$&&$.d(),ct&&ct.d(),N&&N.d(),V&&V.d(H),_t&&_t.d(H),Z&&Z.d(H),at&&at.d(H),Ct&&Ct.d(H),wt&&wt.d(),n[57](null),x=!1,hi(j)}}}function Md(n){n.preventDefault()}function Pd(n,e,o){let a,i,r,l,c,u,f,p,g,y,k,M,C,D,z;bt(n,es,b=>o(70,f=b)),bt(n,Ri,b=>o(71,p=b)),bt(n,Vi,b=>o(72,g=b)),bt(n,dn,b=>o(75,M=b));let{$$slots:T={},$$scope:x}=e,{graph:j}=e,{width:F}=e,{height:W}=e,{minimap:Y=!1}=e,{controls:st=!1}=e,{toggle:ot=!1}=e,{fixedZoom:$=!1}=e,{pannable:ct=!0}=e,{disableSelection:N=!1}=e,{ZOOM_INCREMENT:lt=.1}=e,{PAN_INCREMENT:V=50}=e,{PAN_TIME:yt=250}=e,{MAX_SCALE:_t=3}=e,{MIN_SCALE:U=.2}=e,{selectionColor:Z}=e,{backgroundExists:St}=e,{fitView:at=!1}=e,{trackpadPan:Mt}=e,{modifier:Ct}=e,{theme:wt="light"}=e,{title:H}=e,{drawer:q=!1}=e,{contrast:X=!1}=e;console.log("Initial Graph drawer prop:",q);let I;const Ft=Fn(),$t={},dt=J(!1),Dt=J(0),zt=J(null);bt(n,zt,b=>o(23,c=b));const xt=j.cursor,le=j.transforms.scale;bt(n,le,b=>o(68,l=b));const ue=j.dimensions;bt(n,ue,b=>o(55,D=b));const pe=j.transforms.translation;bt(n,pe,b=>o(67,r=b));const it=j.groups;bt(n,it,b=>o(69,u=b));const te=j.groupBoxes,Qt=u.selected.nodes;bt(n,Qt,b=>o(66,i=b));const Ot=j.activeGroup;bt(n,Ot,b=>o(74,k=b));const Wt=j.initialNodePositions;bt(n,Wt,b=>o(73,y=b));const be=j.editing;bt(n,be,b=>o(24,z=b));const Ne=j.bounds.nodeBounds;bt(n,Ne,b=>o(76,C=b));let fe=0,Kt=1,Ht={x:0,y:0,top:0,left:0},Jt=!1,ne=!1,We=!1,De=!1,ze=!1,He=!1,he,$e=null,vi=null,we=null,Le=null,It=null;const fi={id:null,position:j.cursor,offset:J({x:0,y:0}),connected:J(new Set),dynamic:J(!1),edge:null,edgeColor:J(null),direction:J("self"),inputKey:null,type:"output",moving:Po(!1),store:null,mounted:J(!0),rotation:Po(0),node:{zIndex:J(1/0),rotating:J(!1),position:j.cursor,dimensions:{width:J(0),height:J(0)}}};Oe("graphDOMElement",zt),Oe("cursorAnchor",fi),Oe("duplicate",dt),Oe("graph",j),Oe("transforms",j.transforms),Oe("dimensions",j.dimensions),Oe("locked",j.locked),Oe("groups",j.groups),Oe("bounds",j.bounds),Oe("edgeStore",j.edges),Oe("nodeStore",j.nodes),Oe("mounted",Dt),qi(()=>{console.log("Graph component mounted with drawer1:",q),_i()});async function Ae(){await $a(),Vi.set(!0);const{x:b,y:pt,scale:Et}=ec(he,C);b!==null&&pt!==null&&Et!==null&&(j.transforms.scale.set(Et),pe.set({x:b,y:pt})),Vi.set(!1),o(54,He=!0)}async function ci(){o(14,vi=(await Kn(async()=>{const{default:b}=await import("./Minimap-YyBUOrLN.js");return{default:b}},[])).default)}async function Re(){o(13,$e=(await Kn(async()=>{const{default:b}=await import("./ThemeToggle-Beh1gMXZ.js");return{default:b}},[])).default)}async function ui(){o(15,we=(await Kn(async()=>{const{default:b}=await import("./Controls-BT5uPmwW.js");return{default:b}},__vite__mapDeps([0,1]))).default)}async function Ce(){o(16,Le=(await Kn(async()=>{const{default:b}=await import("./DrawerController-59ToZxo1.js");return{default:b}},__vite__mapDeps([2,1,3]))).default)}async function ti(){o(17,It=(await Kn(async()=>{const{default:b}=await import("./ContrastTheme-CbmcPWvP.js");return{default:b}},[])).default)}function _i(){if(!c)return;const b=c.getBoundingClientRect();he={top:b.top,left:b.left,bottom:b.bottom,right:b.right,width:b.width,height:b.height},j.dimensions.set(he),at==="resize"&&Ae()}function _e(b){if(ne){const kt=`${Gh()}/${j.id}`,At=Lt(xt),A=At.x-p.x,Xt=At.y-p.y,oe=Math.min(p.y,p.y+Xt),Yt=Math.min(p.x,p.x+A),me={width:J(Math.abs(A)),height:J(Math.abs(Xt))},Fe=J({x:Yt,y:oe}),oi={group:J(kt),dimensions:me,position:Fe,color:J(Nh()),moving:J(!1)};te.add(oi,kt),Array.from(i).forEach(si=>{si.group.set(kt)}),it.update(si=>{const Zi={parent:J(oi),nodes:J(new Set([...i,oi]))};return si[kt]=Zi,si}),Nt(Qt,i=new Set,i),o(20,ne=!1),o(19,Jt=!1)}k&&Array.from(Lt(u[k].nodes)).forEach(kt=>{const At=Mo(Lt(kt.position).x,Lt(kt.position).y);kt.position.set(At),kt.moving.set(!1)});const pt=j.edges.get("cursor");pt&&(j.edges.delete("cursor"),pt.disconnect||Ft("edgeDrop",{cursor:Lt(xt),source:{node:M==null?void 0:M.anchor.node.id.slice(2),anchor:M==null?void 0:M.anchor.id.split("/")[0].slice(2)}})),Nt(Ot,k=null,k),Nt(Ri,p={x:0,y:0},p),Nt(Wt,y=[],y),o(19,Jt=!1),o(22,De=!1),Nt(Vi,g=!1,g),b.shiftKey||dn.set(null),o(18,Ht.y=0,Ht),o(18,Ht.x=0,Ht)}function ce(b){if(!ct&&!(b.shiftKey||b.metaKey)||b.button===2)return;c&&c.focus();const{clientX:pt,clientY:Et}=b;if(Nt(Ri,p=Lt(xt),p),b.shiftKey||b.metaKey){b.preventDefault(),o(19,Jt=!0);const{top:kt,left:At}=a;o(18,Ht.y=Et-kt,Ht),o(18,Ht.x=pt-At,Ht),o(18,Ht.top=kt,Ht),o(18,Ht.left=At,Ht),b.shiftKey&&b.metaKey?o(20,ne=!0):o(20,ne=!1),b.metaKey&&!b.shiftKey?o(21,We=!0):o(21,We=!1)}else o(22,De=!0),Nt(Qt,i=new Set,i),Qt.set(i)}function je(b){Nt(Qt,i=new Set,i),Qt.set(i),Nt(Ri,p=Lt(xt),p),o(22,De=!0),b.touches.length===2&&(yi(),fe=f,Kt=l)}function Ve(){o(22,De=!1),ze=!1}function yi(){ze||(ze=!0,I=requestAnimationFrame(Si))}function Si(){if(!ze){cancelAnimationFrame(I);return}const pt=f/fe;Nt(le,l=Kt*pt,l),I=requestAnimationFrame(Si)}function Ci(b){const{key:pt,code:Et}=b,kt=b.target;if(!(kt.tagName=="INPUT"||kt.tagName=="TEXTAREA")){if(Et==="KeyA"&&b[`${Ct}Key`]){const At=j.nodes.getAll().filter(A=>!Lt(A.locked));Nt(Qt,i=new Set(At),i)}else if(Yr(pt))ni(pt,b);else if(pt==="=")Qs(-1,j.dimensions,j.transforms,lt);else if(pt==="-")Qs(1,j.dimensions,j.transforms,lt);else if(pt==="0")Ae();else if(pt==="Control")u.selected.nodes.set(new Set);else if(Et==="KeyD"&&b[`${Ct}Key`])dt.set(!0),setTimeout(()=>{dt.set(!1)},100);else if(pt==="Tab"&&(b.altKey||b.ctrlKey))Pt();else if(pt==="l")o(44,wt=wt==="light"?"dark":"light");else if(pt==="d")o(2,q=!q);else if(pt==="m")o(0,Y=!Y);else if(pt==="c")o(1,st=!st);else if(pt==="e"){const At=Array.from(i)[0];j.editing.set(At)}else return;b.preventDefault()}}function Je(b){b.preventDefault();const pt=c==null?void 0:c.getBoundingClientRect();if(!pt)return;const Et=b.clientX-pt.left,kt=b.clientY-pt.top,{x:At,y:A}=Mo(Et,kt);if(console.log(`Dropped Node at Snapped Position: (${At}, ${A})`),!oe)return;const Xt={id:`node-${Date.now()}`,rotation:J(0),position:J({x:At,y:A}),moving:J(!1),label:J("New Node"),dimensions:{width:J(200),height:J(100)},inputs:J(2),outputs:J(2),anchors:J([]),group:J(null),collapsed:J(!1),resizingWidth:J(!1),resizingHeight:J(!1),rotating:J(!1),editable:J(!0),locked:J(!1),recalculateAnchors:Yt=>{},resizable:J(!0),zIndex:J(1),edge:null,direction:J("TD"),borderRadius:J(5),borderWidth:J(1),connections:J([]),bgColor:J("#007bff"),borderColor:J("#000"),selectionColor:J("#ff0000"),textColor:J("#fff")};let oe=null;j.nodes.add(Xt,Xt.id),oe=null}function Pt(){const b=j.nodes.getAll(),pt=b.findIndex(kt=>i.has(kt)),Et=pt+1;i.delete(b[pt]),i.add(b[Et])}function ei(b){const{key:pt}=b;Yr(pt)?(clearInterval($t[pt]),delete $t[pt]):pt==="Shift"&&dn.set(null)}function ii(b){if($)return;const pt=b.shiftKey?.15:1,{clientX:Et,clientY:kt,deltaY:At}=b,A=r,Xt={x:Et,y:kt};if((Mt||b.metaKey)&&At%1===0){Nt(pe,r={x:Nt(pe,r.x-=b.deltaX,r),y:Nt(pe,r.y-=b.deltaY,r)},r);return}if(l>=_t&&At<0||l<=U&&At>0)return;const oe=Math.min(.009*pt*Math.abs(At),.08),Yt=rl(l,Math.sign(At),oe),me=sl(l,Yt,A,Xt,he);le.set(Yt),pe.set(me)}function ni(b,pt){const Et=pt.shiftKey?2:1,kt=b==="ArrowLeft"||b==="ArrowUp"?1:-1,At=b==="ArrowLeft"||b==="ArrowRight",A=At?r.x:r.y,Xt=A+kt*V*Et;if(!$t[b]){const oe=performance.now();let Yt=setInterval(()=>{const me=performance.now()-oe;if(i.size===0){const Fe=A+(Xt-A)*(me/yt);pe.set({x:At?Fe:r.x,y:At?r.y:Fe})}else{const Fe={x:At?-kt*2:0,y:At?0:-kt*2};Array.from(i).forEach(oi=>{const si=Lt(oi.position);let Zi;const Hi=Lt(oi.group),Ki=Lt(j.groupBoxes);if(Hi&&(Zi=Ki.get(Hi)),Zi){const Di=Lt(oi.dimensions.width),Oi=Lt(oi.dimensions.height),Yi=cl(Zi,Di,Oi);hl(si,Fe,oi.position,Yi)}else{const Di={x:si.x+Fe.x,y:si.y+Fe.y},Oi=Mo(Di.x,Di.y);oi.position.set(Oi)}})}},2);$t[b]=Yt}}function pi(b){nn[b?"unshift":"push"](()=>{c=b,zt.set(c)})}return n.$$set=b=>{"graph"in b&&o(3,j=b.graph),"width"in b&&o(4,F=b.width),"height"in b&&o(5,W=b.height),"minimap"in b&&o(0,Y=b.minimap),"controls"in b&&o(1,st=b.controls),"toggle"in b&&o(6,ot=b.toggle),"fixedZoom"in b&&o(45,$=b.fixedZoom),"pannable"in b&&o(7,ct=b.pannable),"disableSelection"in b&&o(8,N=b.disableSelection),"ZOOM_INCREMENT"in b&&o(46,lt=b.ZOOM_INCREMENT),"PAN_INCREMENT"in b&&o(47,V=b.PAN_INCREMENT),"PAN_TIME"in b&&o(48,yt=b.PAN_TIME),"MAX_SCALE"in b&&o(49,_t=b.MAX_SCALE),"MIN_SCALE"in b&&o(50,U=b.MIN_SCALE),"selectionColor"in b&&o(9,Z=b.selectionColor),"backgroundExists"in b&&o(10,St=b.backgroundExists),"fitView"in b&&o(51,at=b.fitView),"trackpadPan"in b&&o(52,Mt=b.trackpadPan),"modifier"in b&&o(53,Ct=b.modifier),"theme"in b&&o(44,wt=b.theme),"title"in b&&o(11,H=b.title),"drawer"in b&&o(2,q=b.drawer),"contrast"in b&&o(12,X=b.contrast),"$$scope"in b&&o(58,x=b.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&16777216&&(a=D),n.$$.dirty[1]&8192&&wt&&document.documentElement.setAttribute("svelvet-theme",wt),n.$$.dirty[1]&9437184&&!He&&at&&Ae(),n.$$.dirty[0]&8256&&ot&&!$e&&Re(),n.$$.dirty[0]&16385&&Y&&!vi&&ci(),n.$$.dirty[0]&32770&&st&&!we&&ui(),n.$$.dirty[0]&65540&&q&&!Le&&Ce(),n.$$.dirty[0]&135168&&X&&!It&&ti(),n.$$.dirty[0]&4&&console.log("Reactive Graph drawer prop:",q)},[Y,st,q,j,F,W,ot,ct,N,Z,St,H,X,$e,vi,we,Le,It,Ht,Jt,ne,We,De,c,z,zt,le,ue,pe,it,Qt,Ot,Wt,be,Ne,_i,_e,ce,je,Ve,Ci,Je,ei,ii,wt,$,lt,V,yt,_t,U,at,Mt,Ct,He,D,T,pi,x]}class Ed extends Mi{constructor(e){super(),ki(this,e,Pd,kd,di,{graph:3,width:4,height:5,minimap:0,controls:1,toggle:6,fixedZoom:45,pannable:7,disableSelection:8,ZOOM_INCREMENT:46,PAN_INCREMENT:47,PAN_TIME:48,MAX_SCALE:49,MIN_SCALE:50,selectionColor:9,backgroundExists:10,fitView:51,trackpadPan:52,modifier:53,theme:44,title:11,drawer:2,contrast:12},null,[-1,-1,-1])}}const Cd=n=>({}),ua=n=>({slot:"minimap"}),Td=n=>({}),da=n=>({slot:"controls"}),Sd=n=>({}),fa=n=>({slot:"background"}),Dd=n=>({}),_a=n=>({slot:"toggle"}),zd=n=>({}),pa=n=>({slot:"drawer"}),Od=n=>({}),ma=n=>({slot:"contrast"});function Id(n){let e;return{c(){e=S("div"),m(e,"class","svelvet-temp svelte-lsy29y"),ht(e,"width",n[2]?n[2]+"px":"100%"),ht(e,"height",n[3]?n[3]+"px":"100%")},m(o,a){et(o,e,a)},p(o,a){a[0]&4&&ht(e,"width",o[2]?o[2]+"px":"100%"),a[0]&8&&ht(e,"height",o[3]?o[3]+"px":"100%")},i:Gt,o:Gt,d(o){o&&Q(e)}}}function Ad(n){let e,o;return e=new Ed({props:{width:n[2],height:n[3],toggle:n[6],backgroundExists:n[19],minimap:n[4],graph:n[18],fitView:n[9],fixedZoom:n[16],pannable:n[17],theme:n[1],drawer:n[7],controls:n[5],selectionColor:n[10],disableSelection:n[11],trackpadPan:n[13],modifier:n[14],title:n[15],contrast:n[8],$$slots:{contrast:[jd],drawer:[Hd],toggle:[Zd],background:[Rd],controls:[Bd],minimap:[Nd],default:[xd]},$$scope:{ctx:n}}}),e.$on("edgeDrop",n[35]),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},p(a,i){const r={};i[0]&4&&(r.width=a[2]),i[0]&8&&(r.height=a[3]),i[0]&64&&(r.toggle=a[6]),i[0]&524288&&(r.backgroundExists=a[19]),i[0]&16&&(r.minimap=a[4]),i[0]&262144&&(r.graph=a[18]),i[0]&512&&(r.fitView=a[9]),i[0]&65536&&(r.fixedZoom=a[16]),i[0]&131072&&(r.pannable=a[17]),i[0]&2&&(r.theme=a[1]),i[0]&128&&(r.drawer=a[7]),i[0]&32&&(r.controls=a[5]),i[0]&1024&&(r.selectionColor=a[10]),i[0]&2048&&(r.disableSelection=a[11]),i[0]&8192&&(r.trackpadPan=a[13]),i[0]&16384&&(r.modifier=a[14]),i[0]&32768&&(r.title=a[15]),i[0]&256&&(r.contrast=a[8]),i[0]&4097|i[1]&32&&(r.$$scope={dirty:i,ctx:a}),e.$set(r)},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function ga(n){let e,o;return e=new Iu({props:{mermaid:n[0],mermaidConfig:n[12]}}),{c(){ae(e.$$.fragment)},m(a,i){ee(e,a,i),o=!0},p(a,i){const r={};i[0]&1&&(r.mermaid=a[0]),i[0]&4096&&(r.mermaidConfig=a[12]),e.$set(r)},i(a){o||(B(e.$$.fragment,a),o=!0)},o(a){G(e.$$.fragment,a),o=!1},d(a){ie(e,a)}}}function xd(n){let e,o,a=n[0].length&&ga(n);const i=n[34].default,r=ke(i,n,n[36],null);return{c(){a&&a.c(),e=K(),r&&r.c()},m(l,c){a&&a.m(l,c),et(l,e,c),r&&r.m(l,c),o=!0},p(l,c){l[0].length?a?(a.p(l,c),c[0]&1&&B(a,1)):(a=ga(l),a.c(),B(a,1),a.m(e.parentNode,e)):a&&(ve(),G(a,1,1,()=>{a=null}),ye()),r&&r.p&&(!o||c[1]&32)&&Pe(r,i,l,l[36],o?Me(i,l[36],c,null):Ee(l[36]),null)},i(l){o||(B(a),B(r,l),o=!0)},o(l){G(a),G(r,l),o=!1},d(l){l&&Q(e),a&&a.d(l),r&&r.d(l)}}}function Nd(n){let e;const o=n[34].minimap,a=ke(o,n,n[36],ua);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,r){a&&a.p&&(!e||r[1]&32)&&Pe(a,o,i,i[36],e?Me(o,i[36],r,Cd):Ee(i[36]),ua)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function Bd(n){let e;const o=n[34].controls,a=ke(o,n,n[36],da);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,r){a&&a.p&&(!e||r[1]&32)&&Pe(a,o,i,i[36],e?Me(o,i[36],r,Td):Ee(i[36]),da)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function Rd(n){let e;const o=n[34].background,a=ke(o,n,n[36],fa);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,r){a&&a.p&&(!e||r[1]&32)&&Pe(a,o,i,i[36],e?Me(o,i[36],r,Sd):Ee(i[36]),fa)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function Zd(n){let e;const o=n[34].toggle,a=ke(o,n,n[36],_a);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,r){a&&a.p&&(!e||r[1]&32)&&Pe(a,o,i,i[36],e?Me(o,i[36],r,Dd):Ee(i[36]),_a)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function Hd(n){let e;const o=n[34].drawer,a=ke(o,n,n[36],pa);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,r){a&&a.p&&(!e||r[1]&32)&&Pe(a,o,i,i[36],e?Me(o,i[36],r,zd):Ee(i[36]),pa)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function jd(n){let e;const o=n[34].contrast,a=ke(o,n,n[36],ma);return{c(){a&&a.c()},m(i,r){a&&a.m(i,r),e=!0},p(i,r){a&&a.p&&(!e||r[1]&32)&&Pe(a,o,i,i[36],e?Me(o,i[36],r,Od):Ee(i[36]),ma)},i(i){e||(B(a,i),e=!0)},o(i){G(a,i),e=!1},d(i){a&&a.d(i)}}}function Fd(n){let e,o,a,i;const r=[Ad,Id],l=[];function c(u,f){return u[18]?0:1}return e=c(n),o=l[e]=r[e](n),{c(){o.c(),a=Ie()},m(u,f){l[e].m(u,f),et(u,a,f),i=!0},p(u,f){let p=e;e=c(u),e===p?l[e].p(u,f):(ve(),G(l[p],1,1,()=>{l[p]=null}),ye(),o=l[e],o?o.p(u,f):(o=l[e]=r[e](u),o.c()),B(o,1),o.m(a.parentNode,a))},i(u){i||(B(o),i=!0)},o(u){G(o),i=!1},d(u){u&&Q(a),l[e].d(u)}}}function Gd(n,e,o){let a,i,{$$slots:r={},$$scope:l}=e;const c=rs(r);let{mermaid:u=""}=e,{theme:f="light"}=e,{id:p=0}=e,{snapTo:g=0}=e,{zoom:y=1}=e,{TD:k=!1}=e,{editable:M=!0}=e,{locked:C=!1}=e,{width:D=0}=e,{height:z=0}=e,{minimap:T=!1}=e,{controls:x=!1}=e,{toggle:j=!1}=e,{drawer:F=!1}=e,{contrast:W=!1}=e,{fitView:Y=!1}=e,{selectionColor:st="lightblue"}=e,{edgeStyle:ot="bezier"}=e,{endStyles:$=[null,null]}=e,{edge:ct=null}=e,{disableSelection:N=!1}=e,{mermaidConfig:lt={}}=e,{translation:V={x:0,y:0}}=e,{trackpadPan:yt=!1}=e,{modifier:_t="meta"}=e,{raiseEdgesOnSelect:U=!1}=e,{edgesAboveNode:Z=!1}=e,{title:St=""}=e,{fixedZoom:at=!1}=e,{pannable:Mt=!0}=e;const Ct=Fn();let wt=null,H=k?"TD":"LR";Oe("snapTo",g),Oe("edgeStyle",ot),Oe("endStyles",$),Oe("graphEdge",ct),Oe("raiseEdgesOnSelect",U),Oe("edgesAboveNode",Z),Oe("graph",wt),qi(()=>{console.log("Graph component mounted with drawer:",F);const I=localStorage.getItem("state");if(console.log("stateObject during onMount:",I),I)o(18,wt=lc(I)),console.log("This is the graph set using reloadStore",wt),Yo.add(wt,wt.id),console.log("graphStore updated",wt);else{let Ft=`G-${p||Yo.count()+1}`;o(18,wt=al(Ft,{zoom:y,direction:H,editable:M,locked:C,translation:V})),Yo.add(wt,Ft)}});function q(I,Ft){if(!wt)return;const $t=`N-${I[0]}`,dt=wt.nodes.get($t);if(!dt)return;const Dt=dt.anchors.get(`A-${I[1]}/N-${I[0]}`);if(!Dt)return;const zt=`N-${Ft[0]}`,xt=wt.nodes.get(zt);if(!xt)return;const le=xt.anchors.get(`A-${Ft[1]}/N-${Ft[0]}`);if(!le)return;const ue=wt.edges.match(Dt,le);ue&&wt.edges.delete(ue[0])}function X(I){Ke.call(this,n,I)}return n.$$set=I=>{"mermaid"in I&&o(0,u=I.mermaid),"theme"in I&&o(1,f=I.theme),"id"in I&&o(20,p=I.id),"snapTo"in I&&o(21,g=I.snapTo),"zoom"in I&&o(22,y=I.zoom),"TD"in I&&o(23,k=I.TD),"editable"in I&&o(24,M=I.editable),"locked"in I&&o(25,C=I.locked),"width"in I&&o(2,D=I.width),"height"in I&&o(3,z=I.height),"minimap"in I&&o(4,T=I.minimap),"controls"in I&&o(5,x=I.controls),"toggle"in I&&o(6,j=I.toggle),"drawer"in I&&o(7,F=I.drawer),"contrast"in I&&o(8,W=I.contrast),"fitView"in I&&o(9,Y=I.fitView),"selectionColor"in I&&o(10,st=I.selectionColor),"edgeStyle"in I&&o(26,ot=I.edgeStyle),"endStyles"in I&&o(27,$=I.endStyles),"edge"in I&&o(28,ct=I.edge),"disableSelection"in I&&o(11,N=I.disableSelection),"mermaidConfig"in I&&o(12,lt=I.mermaidConfig),"translation"in I&&o(29,V=I.translation),"trackpadPan"in I&&o(13,yt=I.trackpadPan),"modifier"in I&&o(14,_t=I.modifier),"raiseEdgesOnSelect"in I&&o(30,U=I.raiseEdgesOnSelect),"edgesAboveNode"in I&&o(31,Z=I.edgesAboveNode),"title"in I&&o(15,St=I.title),"fixedZoom"in I&&o(16,at=I.fixedZoom),"pannable"in I&&o(17,Mt=I.pannable),"$$scope"in I&&o(36,l=I.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&262144&&o(33,i=wt&&wt.edges),n.$$.dirty[0]&4456448&&wt&&wt.transforms.scale.set(y),n.$$.dirty[1]&4&&i&&i.onEdgeChange((I,Ft)=>{Ct(Ft,{sourceAnchor:I.source,targetAnchor:I.target,sourceNode:I.source.node,targetNode:I.target.node})})},o(19,a=c.background),[u,f,D,z,T,x,j,F,W,Y,st,N,lt,yt,_t,St,at,Mt,wt,a,p,g,y,k,M,C,ot,$,ct,V,U,Z,q,i,r,X,l]}class Ud extends Mi{constructor(e){super(),ki(this,e,Gd,Fd,di,{mermaid:0,theme:1,id:20,snapTo:21,zoom:22,TD:23,editable:24,locked:25,width:2,height:3,minimap:4,controls:5,toggle:6,drawer:7,contrast:8,fitView:9,selectionColor:10,edgeStyle:26,endStyles:27,edge:28,disableSelection:11,mermaidConfig:12,translation:29,trackpadPan:13,modifier:14,raiseEdgesOnSelect:30,edgesAboveNode:31,title:15,fixedZoom:16,pannable:17,disconnect:32},null,[-1,-1])}get disconnect(){return this.$$.ctx[32]}}var Wd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},os={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(n,e){(function(o,a){a(e)})(Wd,function(o){var a="1.9.4";function i(t){var s,h,d,_;for(h=1,d=arguments.length;h<d;h++){_=arguments[h];for(s in _)t[s]=_[s]}return t}var r=Object.create||function(){function t(){}return function(s){return t.prototype=s,new t}}();function l(t,s){var h=Array.prototype.slice;if(t.bind)return t.bind.apply(t,h.call(arguments,1));var d=h.call(arguments,2);return function(){return t.apply(s,d.length?d.concat(h.call(arguments)):arguments)}}var c=0;function u(t){return"_leaflet_id"in t||(t._leaflet_id=++c),t._leaflet_id}function f(t,s,h){var d,_,v,P;return P=function(){d=!1,_&&(v.apply(h,_),_=!1)},v=function(){d?_=arguments:(t.apply(h,arguments),setTimeout(P,s),d=!0)},v}function p(t,s,h){var d=s[1],_=s[0],v=d-_;return t===d&&h?t:((t-_)%v+v)%v+_}function g(){return!1}function y(t,s){if(s===!1)return t;var h=Math.pow(10,s===void 0?6:s);return Math.round(t*h)/h}function k(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function M(t){return k(t).split(/\s+/)}function C(t,s){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?r(t.options):{});for(var h in s)t.options[h]=s[h];return t.options}function D(t,s,h){var d=[];for(var _ in t)d.push(encodeURIComponent(h?_.toUpperCase():_)+"="+encodeURIComponent(t[_]));return(!s||s.indexOf("?")===-1?"?":"&")+d.join("&")}var z=/\{ *([\w_ -]+) *\}/g;function T(t,s){return t.replace(z,function(h,d){var _=s[d];if(_===void 0)throw new Error("No value provided for variable "+h);return typeof _=="function"&&(_=_(s)),_})}var x=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function j(t,s){for(var h=0;h<t.length;h++)if(t[h]===s)return h;return-1}var F="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function W(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var Y=0;function st(t){var s=+new Date,h=Math.max(0,16-(s-Y));return Y=s+h,window.setTimeout(t,h)}var ot=window.requestAnimationFrame||W("RequestAnimationFrame")||st,$=window.cancelAnimationFrame||W("CancelAnimationFrame")||W("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function ct(t,s,h){if(h&&ot===st)t.call(s);else return ot.call(window,l(t,s))}function N(t){t&&$.call(window,t)}var lt={__proto__:null,extend:i,create:r,bind:l,get lastId(){return c},stamp:u,throttle:f,wrapNum:p,falseFn:g,formatNum:y,trim:k,splitWords:M,setOptions:C,getParamString:D,template:T,isArray:x,indexOf:j,emptyImageUrl:F,requestFn:ot,cancelFn:$,requestAnimFrame:ct,cancelAnimFrame:N};function V(){}V.extend=function(t){var s=function(){C(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},h=s.__super__=this.prototype,d=r(h);d.constructor=s,s.prototype=d;for(var _ in this)Object.prototype.hasOwnProperty.call(this,_)&&_!=="prototype"&&_!=="__super__"&&(s[_]=this[_]);return t.statics&&i(s,t.statics),t.includes&&(yt(t.includes),i.apply(null,[d].concat(t.includes))),i(d,t),delete d.statics,delete d.includes,d.options&&(d.options=h.options?r(h.options):{},i(d.options,t.options)),d._initHooks=[],d.callInitHooks=function(){if(!this._initHooksCalled){h.callInitHooks&&h.callInitHooks.call(this),this._initHooksCalled=!0;for(var v=0,P=d._initHooks.length;v<P;v++)d._initHooks[v].call(this)}},s},V.include=function(t){var s=this.prototype.options;return i(this.prototype,t),t.options&&(this.prototype.options=s,this.mergeOptions(t.options)),this},V.mergeOptions=function(t){return i(this.prototype.options,t),this},V.addInitHook=function(t){var s=Array.prototype.slice.call(arguments,1),h=typeof t=="function"?t:function(){this[t].apply(this,s)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(h),this};function yt(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=x(t)?t:[t];for(var s=0;s<t.length;s++)t[s]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var _t={on:function(t,s,h){if(typeof t=="object")for(var d in t)this._on(d,t[d],s);else{t=M(t);for(var _=0,v=t.length;_<v;_++)this._on(t[_],s,h)}return this},off:function(t,s,h){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var d in t)this._off(d,t[d],s);else{t=M(t);for(var _=arguments.length===1,v=0,P=t.length;v<P;v++)_?this._off(t[v]):this._off(t[v],s,h)}return this},_on:function(t,s,h,d){if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}if(this._listens(t,s,h)===!1){h===this&&(h=void 0);var _={fn:s,ctx:h};d&&(_.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(_)}},_off:function(t,s,h){var d,_,v;if(this._events&&(d=this._events[t],!!d)){if(arguments.length===1){if(this._firingCount)for(_=0,v=d.length;_<v;_++)d[_].fn=g;delete this._events[t];return}if(typeof s!="function"){console.warn("wrong listener type: "+typeof s);return}var P=this._listens(t,s,h);if(P!==!1){var O=d[P];this._firingCount&&(O.fn=g,this._events[t]=d=d.slice()),d.splice(P,1)}}},fire:function(t,s,h){if(!this.listens(t,h))return this;var d=i({},s,{type:t,target:this,sourceTarget:s&&s.sourceTarget||this});if(this._events){var _=this._events[t];if(_){this._firingCount=this._firingCount+1||1;for(var v=0,P=_.length;v<P;v++){var O=_[v],R=O.fn;O.once&&this.off(t,R,O.ctx),R.call(O.ctx||this,d)}this._firingCount--}}return h&&this._propagateEvent(d),this},listens:function(t,s,h,d){typeof t!="string"&&console.warn('"string" type argument expected');var _=s;typeof s!="function"&&(d=!!s,_=void 0,h=void 0);var v=this._events&&this._events[t];if(v&&v.length&&this._listens(t,_,h)!==!1)return!0;if(d){for(var P in this._eventParents)if(this._eventParents[P].listens(t,s,h,d))return!0}return!1},_listens:function(t,s,h){if(!this._events)return!1;var d=this._events[t]||[];if(!s)return!!d.length;h===this&&(h=void 0);for(var _=0,v=d.length;_<v;_++)if(d[_].fn===s&&d[_].ctx===h)return _;return!1},once:function(t,s,h){if(typeof t=="object")for(var d in t)this._on(d,t[d],s,!0);else{t=M(t);for(var _=0,v=t.length;_<v;_++)this._on(t[_],s,h,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[u(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[u(t)],this},_propagateEvent:function(t){for(var s in this._eventParents)this._eventParents[s].fire(t.type,i({layer:t.target,propagatedFrom:t.target},t),!0)}};_t.addEventListener=_t.on,_t.removeEventListener=_t.clearAllEventListeners=_t.off,_t.addOneTimeEventListener=_t.once,_t.fireEvent=_t.fire,_t.hasEventListeners=_t.listens;var U=V.extend(_t);function Z(t,s,h){this.x=h?Math.round(t):t,this.y=h?Math.round(s):s}var St=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};Z.prototype={clone:function(){return new Z(this.x,this.y)},add:function(t){return this.clone()._add(at(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(at(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new Z(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new Z(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=St(this.x),this.y=St(this.y),this},distanceTo:function(t){t=at(t);var s=t.x-this.x,h=t.y-this.y;return Math.sqrt(s*s+h*h)},equals:function(t){return t=at(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=at(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+y(this.x)+", "+y(this.y)+")"}};function at(t,s,h){return t instanceof Z?t:x(t)?new Z(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new Z(t.x,t.y):new Z(t,s,h)}function Mt(t,s){if(t)for(var h=s?[t,s]:t,d=0,_=h.length;d<_;d++)this.extend(h[d])}Mt.prototype={extend:function(t){var s,h;if(!t)return this;if(t instanceof Z||typeof t[0]=="number"||"x"in t)s=h=at(t);else if(t=Ct(t),s=t.min,h=t.max,!s||!h)return this;return!this.min&&!this.max?(this.min=s.clone(),this.max=h.clone()):(this.min.x=Math.min(s.x,this.min.x),this.max.x=Math.max(h.x,this.max.x),this.min.y=Math.min(s.y,this.min.y),this.max.y=Math.max(h.y,this.max.y)),this},getCenter:function(t){return at((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return at(this.min.x,this.max.y)},getTopRight:function(){return at(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var s,h;return typeof t[0]=="number"||t instanceof Z?t=at(t):t=Ct(t),t instanceof Mt?(s=t.min,h=t.max):s=h=t,s.x>=this.min.x&&h.x<=this.max.x&&s.y>=this.min.y&&h.y<=this.max.y},intersects:function(t){t=Ct(t);var s=this.min,h=this.max,d=t.min,_=t.max,v=_.x>=s.x&&d.x<=h.x,P=_.y>=s.y&&d.y<=h.y;return v&&P},overlaps:function(t){t=Ct(t);var s=this.min,h=this.max,d=t.min,_=t.max,v=_.x>s.x&&d.x<h.x,P=_.y>s.y&&d.y<h.y;return v&&P},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var s=this.min,h=this.max,d=Math.abs(s.x-h.x)*t,_=Math.abs(s.y-h.y)*t;return Ct(at(s.x-d,s.y-_),at(h.x+d,h.y+_))},equals:function(t){return t?(t=Ct(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function Ct(t,s){return!t||t instanceof Mt?t:new Mt(t,s)}function wt(t,s){if(t)for(var h=s?[t,s]:t,d=0,_=h.length;d<_;d++)this.extend(h[d])}wt.prototype={extend:function(t){var s=this._southWest,h=this._northEast,d,_;if(t instanceof q)d=t,_=t;else if(t instanceof wt){if(d=t._southWest,_=t._northEast,!d||!_)return this}else return t?this.extend(X(t)||H(t)):this;return!s&&!h?(this._southWest=new q(d.lat,d.lng),this._northEast=new q(_.lat,_.lng)):(s.lat=Math.min(d.lat,s.lat),s.lng=Math.min(d.lng,s.lng),h.lat=Math.max(_.lat,h.lat),h.lng=Math.max(_.lng,h.lng)),this},pad:function(t){var s=this._southWest,h=this._northEast,d=Math.abs(s.lat-h.lat)*t,_=Math.abs(s.lng-h.lng)*t;return new wt(new q(s.lat-d,s.lng-_),new q(h.lat+d,h.lng+_))},getCenter:function(){return new q((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new q(this.getNorth(),this.getWest())},getSouthEast:function(){return new q(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof q||"lat"in t?t=X(t):t=H(t);var s=this._southWest,h=this._northEast,d,_;return t instanceof wt?(d=t.getSouthWest(),_=t.getNorthEast()):d=_=t,d.lat>=s.lat&&_.lat<=h.lat&&d.lng>=s.lng&&_.lng<=h.lng},intersects:function(t){t=H(t);var s=this._southWest,h=this._northEast,d=t.getSouthWest(),_=t.getNorthEast(),v=_.lat>=s.lat&&d.lat<=h.lat,P=_.lng>=s.lng&&d.lng<=h.lng;return v&&P},overlaps:function(t){t=H(t);var s=this._southWest,h=this._northEast,d=t.getSouthWest(),_=t.getNorthEast(),v=_.lat>s.lat&&d.lat<h.lat,P=_.lng>s.lng&&d.lng<h.lng;return v&&P},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,s){return t?(t=H(t),this._southWest.equals(t.getSouthWest(),s)&&this._northEast.equals(t.getNorthEast(),s)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function H(t,s){return t instanceof wt?t:new wt(t,s)}function q(t,s,h){if(isNaN(t)||isNaN(s))throw new Error("Invalid LatLng object: ("+t+", "+s+")");this.lat=+t,this.lng=+s,h!==void 0&&(this.alt=+h)}q.prototype={equals:function(t,s){if(!t)return!1;t=X(t);var h=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return h<=(s===void 0?1e-9:s)},toString:function(t){return"LatLng("+y(this.lat,t)+", "+y(this.lng,t)+")"},distanceTo:function(t){return Ft.distance(this,X(t))},wrap:function(){return Ft.wrapLatLng(this)},toBounds:function(t){var s=180*t/40075017,h=s/Math.cos(Math.PI/180*this.lat);return H([this.lat-s,this.lng-h],[this.lat+s,this.lng+h])},clone:function(){return new q(this.lat,this.lng,this.alt)}};function X(t,s,h){return t instanceof q?t:x(t)&&typeof t[0]!="object"?t.length===3?new q(t[0],t[1],t[2]):t.length===2?new q(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new q(t.lat,"lng"in t?t.lng:t.lon,t.alt):s===void 0?null:new q(t,s,h)}var I={latLngToPoint:function(t,s){var h=this.projection.project(t),d=this.scale(s);return this.transformation._transform(h,d)},pointToLatLng:function(t,s){var h=this.scale(s),d=this.transformation.untransform(t,h);return this.projection.unproject(d)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var s=this.projection.bounds,h=this.scale(t),d=this.transformation.transform(s.min,h),_=this.transformation.transform(s.max,h);return new Mt(d,_)},infinite:!1,wrapLatLng:function(t){var s=this.wrapLng?p(t.lng,this.wrapLng,!0):t.lng,h=this.wrapLat?p(t.lat,this.wrapLat,!0):t.lat,d=t.alt;return new q(h,s,d)},wrapLatLngBounds:function(t){var s=t.getCenter(),h=this.wrapLatLng(s),d=s.lat-h.lat,_=s.lng-h.lng;if(d===0&&_===0)return t;var v=t.getSouthWest(),P=t.getNorthEast(),O=new q(v.lat-d,v.lng-_),R=new q(P.lat-d,P.lng-_);return new wt(O,R)}},Ft=i({},I,{wrapLng:[-180,180],R:6371e3,distance:function(t,s){var h=Math.PI/180,d=t.lat*h,_=s.lat*h,v=Math.sin((s.lat-t.lat)*h/2),P=Math.sin((s.lng-t.lng)*h/2),O=v*v+Math.cos(d)*Math.cos(_)*P*P,R=2*Math.atan2(Math.sqrt(O),Math.sqrt(1-O));return this.R*R}}),$t=6378137,dt={R:$t,MAX_LATITUDE:85.0511287798,project:function(t){var s=Math.PI/180,h=this.MAX_LATITUDE,d=Math.max(Math.min(h,t.lat),-h),_=Math.sin(d*s);return new Z(this.R*t.lng*s,this.R*Math.log((1+_)/(1-_))/2)},unproject:function(t){var s=180/Math.PI;return new q((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*s,t.x*s/this.R)},bounds:function(){var t=$t*Math.PI;return new Mt([-t,-t],[t,t])}()};function Dt(t,s,h,d){if(x(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=s,this._c=h,this._d=d}Dt.prototype={transform:function(t,s){return this._transform(t.clone(),s)},_transform:function(t,s){return s=s||1,t.x=s*(this._a*t.x+this._b),t.y=s*(this._c*t.y+this._d),t},untransform:function(t,s){return s=s||1,new Z((t.x/s-this._b)/this._a,(t.y/s-this._d)/this._c)}};function zt(t,s,h,d){return new Dt(t,s,h,d)}var xt=i({},Ft,{code:"EPSG:3857",projection:dt,transformation:function(){var t=.5/(Math.PI*dt.R);return zt(t,.5,-t,.5)}()}),le=i({},xt,{code:"EPSG:900913"});function ue(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function pe(t,s){var h="",d,_,v,P,O,R;for(d=0,v=t.length;d<v;d++){for(O=t[d],_=0,P=O.length;_<P;_++)R=O[_],h+=(_?"L":"M")+R.x+" "+R.y;h+=s?Pt.svg?"z":"x":""}return h||"M0 0"}var it=document.documentElement.style,te="ActiveXObject"in window,Qt=te&&!document.addEventListener,Ot="msLaunchUri"in navigator&&!("documentMode"in document),Wt=Je("webkit"),be=Je("android"),Ne=Je("android 2")||Je("android 3"),fe=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Kt=be&&Je("Google")&&fe<537&&!("AudioNode"in window),Ht=!!window.opera,Jt=!Ot&&Je("chrome"),ne=Je("gecko")&&!Wt&&!Ht&&!te,We=!Jt&&Je("safari"),De=Je("phantom"),ze="OTransition"in it,He=navigator.platform.indexOf("Win")===0,he=te&&"transition"in it,$e="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ne,vi="MozPerspective"in it,we=!window.L_DISABLE_3D&&(he||$e||vi)&&!ze&&!De,Le=typeof orientation<"u"||Je("mobile"),It=Le&&Wt,fi=Le&&$e,Ae=!window.PointerEvent&&window.MSPointerEvent,ci=!!(window.PointerEvent||Ae),Re="ontouchstart"in window||!!window.TouchEvent,ui=!window.L_NO_TOUCH&&(Re||ci),Ce=Le&&Ht,ti=Le&&ne,_i=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,_e=function(){var t=!1;try{var s=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",g,s),window.removeEventListener("testPassiveEventSupport",g,s)}catch{}return t}(),ce=function(){return!!document.createElement("canvas").getContext}(),je=!!(document.createElementNS&&ue("svg").createSVGRect),Ve=!!je&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),yi=!je&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var s=t.firstChild;return s.style.behavior="url(#default#VML)",s&&typeof s.adj=="object"}catch{return!1}}(),Si=navigator.platform.indexOf("Mac")===0,Ci=navigator.platform.indexOf("Linux")===0;function Je(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Pt={ie:te,ielt9:Qt,edge:Ot,webkit:Wt,android:be,android23:Ne,androidStock:Kt,opera:Ht,chrome:Jt,gecko:ne,safari:We,phantom:De,opera12:ze,win:He,ie3d:he,webkit3d:$e,gecko3d:vi,any3d:we,mobile:Le,mobileWebkit:It,mobileWebkit3d:fi,msPointer:Ae,pointer:ci,touch:ui,touchNative:Re,mobileOpera:Ce,mobileGecko:ti,retina:_i,passiveEvents:_e,canvas:ce,svg:je,vml:yi,inlineSvg:Ve,mac:Si,linux:Ci},ei=Pt.msPointer?"MSPointerDown":"pointerdown",ii=Pt.msPointer?"MSPointerMove":"pointermove",ni=Pt.msPointer?"MSPointerUp":"pointerup",pi=Pt.msPointer?"MSPointerCancel":"pointercancel",b={touchstart:ei,touchmove:ii,touchend:ni,touchcancel:pi},pt={touchstart:oi,touchmove:Fe,touchend:Fe,touchcancel:Fe},Et={},kt=!1;function At(t,s,h){return s==="touchstart"&&me(),pt[s]?(h=pt[s].bind(this,h),t.addEventListener(b[s],h,!1),h):(console.warn("wrong event specified:",s),g)}function A(t,s,h){if(!b[s]){console.warn("wrong event specified:",s);return}t.removeEventListener(b[s],h,!1)}function Xt(t){Et[t.pointerId]=t}function oe(t){Et[t.pointerId]&&(Et[t.pointerId]=t)}function Yt(t){delete Et[t.pointerId]}function me(){kt||(document.addEventListener(ei,Xt,!0),document.addEventListener(ii,oe,!0),document.addEventListener(ni,Yt,!0),document.addEventListener(pi,Yt,!0),kt=!0)}function Fe(t,s){if(s.pointerType!==(s.MSPOINTER_TYPE_MOUSE||"mouse")){s.touches=[];for(var h in Et)s.touches.push(Et[h]);s.changedTouches=[s],t(s)}}function oi(t,s){s.MSPOINTER_TYPE_TOUCH&&s.pointerType===s.MSPOINTER_TYPE_TOUCH&&zi(s),Fe(t,s)}function si(t){var s={},h,d;for(d in t)h=t[d],s[d]=h&&h.bind?h.bind(t):h;return t=s,s.type="dblclick",s.detail=2,s.isTrusted=!1,s._simulated=!0,s}var Zi=200;function Hi(t,s){t.addEventListener("dblclick",s);var h=0,d;function _(v){if(v.detail!==1){d=v.detail;return}if(!(v.pointerType==="mouse"||v.sourceCapabilities&&!v.sourceCapabilities.firesTouchEvents)){var P=ls(v);if(!(P.some(function(R){return R instanceof HTMLLabelElement&&R.attributes.for})&&!P.some(function(R){return R instanceof HTMLInputElement||R instanceof HTMLSelectElement}))){var O=Date.now();O-h<=Zi?(d++,d===2&&s(si(v))):d=1,h=O}}}return t.addEventListener("click",_),{dblclick:s,simDblclick:_}}function Ki(t,s){t.removeEventListener("dblclick",s.dblclick),t.removeEventListener("click",s.simDblclick)}var Di=Ye(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Oi=Ye(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Yi=Oi==="webkitTransition"||Oi==="OTransition"?Oi+"End":"transitionend";function on(t){return typeof t=="string"?document.getElementById(t):t}function mt(t,s){var h=t.style[s]||t.currentStyle&&t.currentStyle[s];if((!h||h==="auto")&&document.defaultView){var d=document.defaultView.getComputedStyle(t,null);h=d?d[s]:null}return h==="auto"?null:h}function Bt(t,s,h){var d=document.createElement(t);return d.className=s||"",h&&h.appendChild(d),d}function se(t){var s=t.parentNode;s&&s.removeChild(t)}function Pi(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function ri(t){var s=t.parentNode;s&&s.lastChild!==t&&s.appendChild(t)}function Ge(t){var s=t.parentNode;s&&s.firstChild!==t&&s.insertBefore(t,s.firstChild)}function Te(t,s){if(t.classList!==void 0)return t.classList.contains(s);var h=Ji(t);return h.length>0&&new RegExp("(^|\\s)"+s+"(\\s|$)").test(h)}function Rt(t,s){if(t.classList!==void 0)for(var h=M(s),d=0,_=h.length;d<_;d++)t.classList.add(h[d]);else if(!Te(t,s)){var v=Ji(t);ji(t,(v?v+" ":"")+s)}}function xe(t,s){t.classList!==void 0?t.classList.remove(s):ji(t,k((" "+Ji(t)+" ").replace(" "+s+" "," ")))}function ji(t,s){t.className.baseVal===void 0?t.className=s:t.className.baseVal=s}function Ji(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function ai(t,s){"opacity"in t.style?t.style.opacity=s:"filter"in t.style&&sn(t,s)}function sn(t,s){var h=!1,d="DXImageTransform.Microsoft.Alpha";try{h=t.filters.item(d)}catch{if(s===1)return}s=Math.round(s*100),h?(h.Enabled=s!==100,h.Opacity=s):t.style.filter+=" progid:"+d+"(opacity="+s+")"}function Ye(t){for(var s=document.documentElement.style,h=0;h<t.length;h++)if(t[h]in s)return t[h];return!1}function Ii(t,s,h){var d=s||new Z(0,0);t.style[Di]=(Pt.ie3d?"translate("+d.x+"px,"+d.y+"px)":"translate3d("+d.x+"px,"+d.y+"px,0)")+(h?" scale("+h+")":"")}function Ue(t,s){t._leaflet_pos=s,Pt.any3d?Ii(t,s):(t.style.left=s.x+"px",t.style.top=s.y+"px")}function Fi(t){return t._leaflet_pos||new Z(0,0)}var Gi,bi,li;if("onselectstart"in document)Gi=function(){vt(window,"selectstart",zi)},bi=function(){jt(window,"selectstart",zi)};else{var Ui=Ye(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Gi=function(){if(Ui){var t=document.documentElement.style;li=t[Ui],t[Ui]="none"}},bi=function(){Ui&&(document.documentElement.style[Ui]=li,li=void 0)}}function hn(){vt(window,"dragstart",zi)}function Ai(){jt(window,"dragstart",zi)}var mi,wi;function E(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(tt(),mi=t,wi=t.style.outlineStyle,t.style.outlineStyle="none",vt(window,"keydown",tt))}function tt(){mi&&(mi.style.outlineStyle=wi,mi=void 0,wi=void 0,jt(window,"keydown",tt))}function rt(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function nt(t){var s=t.getBoundingClientRect();return{x:s.width/t.offsetWidth||1,y:s.height/t.offsetHeight||1,boundingClientRect:s}}var gt={__proto__:null,TRANSFORM:Di,TRANSITION:Oi,TRANSITION_END:Yi,get:on,getStyle:mt,create:Bt,remove:se,empty:Pi,toFront:ri,toBack:Ge,hasClass:Te,addClass:Rt,removeClass:xe,setClass:ji,getClass:Ji,setOpacity:ai,testProp:Ye,setTransform:Ii,setPosition:Ue,getPosition:Fi,get disableTextSelection(){return Gi},get enableTextSelection(){return bi},disableImageDrag:hn,enableImageDrag:Ai,preventOutline:E,restoreOutline:tt,getSizedParentNode:rt,getScale:nt};function vt(t,s,h,d){if(s&&typeof s=="object")for(var _ in s)xi(t,_,s[_],h);else{s=M(s);for(var v=0,P=s.length;v<P;v++)xi(t,s[v],h,d)}return this}var Xe="_leaflet_events";function jt(t,s,h,d){if(arguments.length===1)Zt(t),delete t[Xe];else if(s&&typeof s=="object")for(var _ in s)rn(t,_,s[_],h);else if(s=M(s),arguments.length===2)Zt(t,function(O){return j(s,O)!==-1});else for(var v=0,P=s.length;v<P;v++)rn(t,s[v],h,d);return this}function Zt(t,s){for(var h in t[Xe]){var d=h.split(/\d/)[0];(!s||s(d))&&rn(t,d,null,null,h)}}var qe={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function xi(t,s,h,d){var _=s+u(h)+(d?"_"+u(d):"");if(t[Xe]&&t[Xe][_])return this;var v=function(O){return h.call(d||t,O||window.event)},P=v;!Pt.touchNative&&Pt.pointer&&s.indexOf("touch")===0?v=At(t,s,v):Pt.touch&&s==="dblclick"?v=Hi(t,v):"addEventListener"in t?s==="touchstart"||s==="touchmove"||s==="wheel"||s==="mousewheel"?t.addEventListener(qe[s]||s,v,Pt.passiveEvents?{passive:!1}:!1):s==="mouseenter"||s==="mouseleave"?(v=function(O){O=O||window.event,Do(t,O)&&P(O)},t.addEventListener(qe[s],v,!1)):t.addEventListener(s,P,!1):t.attachEvent("on"+s,v),t[Xe]=t[Xe]||{},t[Xe][_]=v}function rn(t,s,h,d,_){_=_||s+u(h)+(d?"_"+u(d):"");var v=t[Xe]&&t[Xe][_];if(!v)return this;!Pt.touchNative&&Pt.pointer&&s.indexOf("touch")===0?A(t,s,v):Pt.touch&&s==="dblclick"?Ki(t,v):"removeEventListener"in t?t.removeEventListener(qe[s]||s,v,!1):t.detachEvent("on"+s,v),t[Xe][_]=null}function Qi(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function yn(t){return xi(t,"wheel",Qi),this}function Gn(t){return vt(t,"mousedown touchstart dblclick contextmenu",Qi),t._leaflet_disable_click=!0,this}function zi(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function Mn(t){return zi(t),Qi(t),this}function ls(t){if(t.composedPath)return t.composedPath();for(var s=[],h=t.target;h;)s.push(h),h=h.parentNode;return s}function hs(t,s){if(!s)return new Z(t.clientX,t.clientY);var h=nt(s),d=h.boundingClientRect;return new Z((t.clientX-d.left)/h.x-s.clientLeft,(t.clientY-d.top)/h.y-s.clientTop)}var pl=Pt.linux&&Pt.chrome?window.devicePixelRatio:Pt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function cs(t){return Pt.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/pl:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function Do(t,s){var h=s.relatedTarget;if(!h)return!0;try{for(;h&&h!==t;)h=h.parentNode}catch{return!1}return h!==t}var ml={__proto__:null,on:vt,off:jt,stopPropagation:Qi,disableScrollPropagation:yn,disableClickPropagation:Gn,preventDefault:zi,stop:Mn,getPropagationPath:ls,getMousePosition:hs,getWheelDelta:cs,isExternalTarget:Do,addListener:vt,removeListener:jt},us=U.extend({run:function(t,s,h,d){this.stop(),this._el=t,this._inProgress=!0,this._duration=h||.25,this._easeOutPower=1/Math.max(d||.5,.2),this._startPos=Fi(t),this._offset=s.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ct(this._animate,this),this._step()},_step:function(t){var s=+new Date-this._startTime,h=this._duration*1e3;s<h?this._runFrame(this._easeOut(s/h),t):(this._runFrame(1),this._complete())},_runFrame:function(t,s){var h=this._startPos.add(this._offset.multiplyBy(t));s&&h._round(),Ue(this._el,h),this.fire("step")},_complete:function(){N(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),ge=U.extend({options:{crs:xt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,s){s=C(this,s),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=l(this._onResize,this),this._initEvents(),s.maxBounds&&this.setMaxBounds(s.maxBounds),s.zoom!==void 0&&(this._zoom=this._limitZoom(s.zoom)),s.center&&s.zoom!==void 0&&this.setView(X(s.center),s.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Oi&&Pt.any3d&&!Pt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),vt(this._proxy,Yi,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,s,h){if(s=s===void 0?this._zoom:this._limitZoom(s),t=this._limitCenter(X(t),s,this.options.maxBounds),h=h||{},this._stop(),this._loaded&&!h.reset&&h!==!0){h.animate!==void 0&&(h.zoom=i({animate:h.animate},h.zoom),h.pan=i({animate:h.animate,duration:h.duration},h.pan));var d=this._zoom!==s?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,s,h.zoom):this._tryAnimatedPan(t,h.pan);if(d)return clearTimeout(this._sizeTimer),this}return this._resetView(t,s,h.pan&&h.pan.noMoveStart),this},setZoom:function(t,s){return this._loaded?this.setView(this.getCenter(),t,{zoom:s}):(this._zoom=t,this)},zoomIn:function(t,s){return t=t||(Pt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,s)},zoomOut:function(t,s){return t=t||(Pt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,s)},setZoomAround:function(t,s,h){var d=this.getZoomScale(s),_=this.getSize().divideBy(2),v=t instanceof Z?t:this.latLngToContainerPoint(t),P=v.subtract(_).multiplyBy(1-1/d),O=this.containerPointToLatLng(_.add(P));return this.setView(O,s,{zoom:h})},_getBoundsCenterZoom:function(t,s){s=s||{},t=t.getBounds?t.getBounds():H(t);var h=at(s.paddingTopLeft||s.padding||[0,0]),d=at(s.paddingBottomRight||s.padding||[0,0]),_=this.getBoundsZoom(t,!1,h.add(d));if(_=typeof s.maxZoom=="number"?Math.min(s.maxZoom,_):_,_===1/0)return{center:t.getCenter(),zoom:_};var v=d.subtract(h).divideBy(2),P=this.project(t.getSouthWest(),_),O=this.project(t.getNorthEast(),_),R=this.unproject(P.add(O).divideBy(2).add(v),_);return{center:R,zoom:_}},fitBounds:function(t,s){if(t=H(t),!t.isValid())throw new Error("Bounds are not valid.");var h=this._getBoundsCenterZoom(t,s);return this.setView(h.center,h.zoom,s)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,s){return this.setView(t,this._zoom,{pan:s})},panBy:function(t,s){if(t=at(t).round(),s=s||{},!t.x&&!t.y)return this.fire("moveend");if(s.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new us,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),s.noMoveStart||this.fire("movestart"),s.animate!==!1){Rt(this._mapPane,"leaflet-pan-anim");var h=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,h,s.duration||.25,s.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,s,h){if(h=h||{},h.animate===!1||!Pt.any3d)return this.setView(t,s,h);this._stop();var d=this.project(this.getCenter()),_=this.project(t),v=this.getSize(),P=this._zoom;t=X(t),s=s===void 0?P:s;var O=Math.max(v.x,v.y),R=O*this.getZoomScale(P,s),ut=_.distanceTo(d)||1,Tt=1.42,Ut=Tt*Tt;function re(Li){var vo=Li?-1:1,oh=Li?R:O,sh=R*R-O*O+vo*Ut*Ut*ut*ut,rh=2*oh*Ut*ut,jo=sh/rh,Ws=Math.sqrt(jo*jo+1)-jo,ah=Ws<1e-9?-18:Math.log(Ws);return ah}function Ni(Li){return(Math.exp(Li)-Math.exp(-Li))/2}function Ti(Li){return(Math.exp(Li)+Math.exp(-Li))/2}function tn(Li){return Ni(Li)/Ti(Li)}var Wi=re(0);function Nn(Li){return O*(Ti(Wi)/Ti(Wi+Tt*Li))}function th(Li){return O*(Ti(Wi)*tn(Wi+Tt*Li)-Ni(Wi))/Ut}function eh(Li){return 1-Math.pow(1-Li,1.5)}var ih=Date.now(),Gs=(re(1)-Wi)/Tt,nh=h.duration?1e3*h.duration:1e3*Gs*.8;function Us(){var Li=(Date.now()-ih)/nh,vo=eh(Li)*Gs;Li<=1?(this._flyToFrame=ct(Us,this),this._move(this.unproject(d.add(_.subtract(d).multiplyBy(th(vo)/ut)),P),this.getScaleZoom(O/Nn(vo),P),{flyTo:!0})):this._move(t,s)._moveEnd(!0)}return this._moveStart(!0,h.noMoveStart),Us.call(this),this},flyToBounds:function(t,s){var h=this._getBoundsCenterZoom(t,s);return this.flyTo(h.center,h.zoom,s)},setMaxBounds:function(t){return t=H(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var s=this.options.minZoom;return this.options.minZoom=t,this._loaded&&s!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var s=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&s!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,s){this._enforcingBounds=!0;var h=this.getCenter(),d=this._limitCenter(h,this._zoom,H(t));return h.equals(d)||this.panTo(d,s),this._enforcingBounds=!1,this},panInside:function(t,s){s=s||{};var h=at(s.paddingTopLeft||s.padding||[0,0]),d=at(s.paddingBottomRight||s.padding||[0,0]),_=this.project(this.getCenter()),v=this.project(t),P=this.getPixelBounds(),O=Ct([P.min.add(h),P.max.subtract(d)]),R=O.getSize();if(!O.contains(v)){this._enforcingBounds=!0;var ut=v.subtract(O.getCenter()),Tt=O.extend(v).getSize().subtract(R);_.x+=ut.x<0?-Tt.x:Tt.x,_.y+=ut.y<0?-Tt.y:Tt.y,this.panTo(this.unproject(_),s),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=i({animate:!1,pan:!0},t===!0?{animate:!0}:t);var s=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var h=this.getSize(),d=s.divideBy(2).round(),_=h.divideBy(2).round(),v=d.subtract(_);return!v.x&&!v.y?this:(t.animate&&t.pan?this.panBy(v):(t.pan&&this._rawPanBy(v),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(l(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:s,newSize:h}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=i({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var s=l(this._handleGeolocationResponse,this),h=l(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(s,h,t):navigator.geolocation.getCurrentPosition(s,h,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var s=t.code,h=t.message||(s===1?"permission denied":s===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:s,message:"Geolocation error: "+h+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var s=t.coords.latitude,h=t.coords.longitude,d=new q(s,h),_=d.toBounds(t.coords.accuracy*2),v=this._locateOptions;if(v.setView){var P=this.getBoundsZoom(_);this.setView(d,v.maxZoom?Math.min(P,v.maxZoom):P)}var O={latlng:d,bounds:_,timestamp:t.timestamp};for(var R in t.coords)typeof t.coords[R]=="number"&&(O[R]=t.coords[R]);this.fire("locationfound",O)}},addHandler:function(t,s){if(!s)return this;var h=this[t]=new s(this);return this._handlers.push(h),this.options[t]&&h.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),se(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(N(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)se(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,s){var h="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),d=Bt("div",h,s||this._mapPane);return t&&(this._panes[t]=d),d},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),s=this.unproject(t.getBottomLeft()),h=this.unproject(t.getTopRight());return new wt(s,h)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,s,h){t=H(t),h=at(h||[0,0]);var d=this.getZoom()||0,_=this.getMinZoom(),v=this.getMaxZoom(),P=t.getNorthWest(),O=t.getSouthEast(),R=this.getSize().subtract(h),ut=Ct(this.project(O,d),this.project(P,d)).getSize(),Tt=Pt.any3d?this.options.zoomSnap:1,Ut=R.x/ut.x,re=R.y/ut.y,Ni=s?Math.max(Ut,re):Math.min(Ut,re);return d=this.getScaleZoom(Ni,d),Tt&&(d=Math.round(d/(Tt/100))*(Tt/100),d=s?Math.ceil(d/Tt)*Tt:Math.floor(d/Tt)*Tt),Math.max(_,Math.min(v,d))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Z(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,s){var h=this._getTopLeftPoint(t,s);return new Mt(h,h.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,s){var h=this.options.crs;return s=s===void 0?this._zoom:s,h.scale(t)/h.scale(s)},getScaleZoom:function(t,s){var h=this.options.crs;s=s===void 0?this._zoom:s;var d=h.zoom(t*h.scale(s));return isNaN(d)?1/0:d},project:function(t,s){return s=s===void 0?this._zoom:s,this.options.crs.latLngToPoint(X(t),s)},unproject:function(t,s){return s=s===void 0?this._zoom:s,this.options.crs.pointToLatLng(at(t),s)},layerPointToLatLng:function(t){var s=at(t).add(this.getPixelOrigin());return this.unproject(s)},latLngToLayerPoint:function(t){var s=this.project(X(t))._round();return s._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(X(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(H(t))},distance:function(t,s){return this.options.crs.distance(X(t),X(s))},containerPointToLayerPoint:function(t){return at(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return at(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var s=this.containerPointToLayerPoint(at(t));return this.layerPointToLatLng(s)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(X(t)))},mouseEventToContainerPoint:function(t){return hs(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var s=this._container=on(t);if(s){if(s._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");vt(s,"scroll",this._onScroll,this),this._containerId=u(s)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Pt.any3d,Rt(t,"leaflet-container"+(Pt.touch?" leaflet-touch":"")+(Pt.retina?" leaflet-retina":"")+(Pt.ielt9?" leaflet-oldie":"")+(Pt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var s=mt(t,"position");s!=="absolute"&&s!=="relative"&&s!=="fixed"&&s!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Ue(this._mapPane,new Z(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Rt(t.markerPane,"leaflet-zoom-hide"),Rt(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,s,h){Ue(this._mapPane,new Z(0,0));var d=!this._loaded;this._loaded=!0,s=this._limitZoom(s),this.fire("viewprereset");var _=this._zoom!==s;this._moveStart(_,h)._move(t,s)._moveEnd(_),this.fire("viewreset"),d&&this.fire("load")},_moveStart:function(t,s){return t&&this.fire("zoomstart"),s||this.fire("movestart"),this},_move:function(t,s,h,d){s===void 0&&(s=this._zoom);var _=this._zoom!==s;return this._zoom=s,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),d?h&&h.pinch&&this.fire("zoom",h):((_||h&&h.pinch)&&this.fire("zoom",h),this.fire("move",h)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return N(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){Ue(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[u(this._container)]=this;var s=t?jt:vt;s(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&s(window,"resize",this._onResize,this),Pt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){N(this._resizeRequest),this._resizeRequest=ct(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,s){for(var h=[],d,_=s==="mouseout"||s==="mouseover",v=t.target||t.srcElement,P=!1;v;){if(d=this._targets[u(v)],d&&(s==="click"||s==="preclick")&&this._draggableMoved(d)){P=!0;break}if(d&&d.listens(s,!0)&&(_&&!Do(v,t)||(h.push(d),_))||v===this._container)break;v=v.parentNode}return!h.length&&!P&&!_&&this.listens(s,!0)&&(h=[this]),h},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var s=t.target||t.srcElement;if(!(!this._loaded||s._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(s))){var h=t.type;h==="mousedown"&&E(s),this._fireDOMEvent(t,h)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,s,h){if(t.type==="click"){var d=i({},t);d.type="preclick",this._fireDOMEvent(d,d.type,h)}var _=this._findEventTargets(t,s);if(h){for(var v=[],P=0;P<h.length;P++)h[P].listens(s,!0)&&v.push(h[P]);_=v.concat(_)}if(_.length){s==="contextmenu"&&zi(t);var O=_[0],R={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var ut=O.getLatLng&&(!O._radius||O._radius<=10);R.containerPoint=ut?this.latLngToContainerPoint(O.getLatLng()):this.mouseEventToContainerPoint(t),R.layerPoint=this.containerPointToLayerPoint(R.containerPoint),R.latlng=ut?O.getLatLng():this.layerPointToLatLng(R.layerPoint)}for(P=0;P<_.length;P++)if(_[P].fire(s,R,!0),R.originalEvent._stopped||_[P].options.bubblingMouseEvents===!1&&j(this._mouseEvents,s)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,s=this._handlers.length;t<s;t++)this._handlers[t].disable()},whenReady:function(t,s){return this._loaded?t.call(s||this,{target:this}):this.on("load",t,s),this},_getMapPanePos:function(){return Fi(this._mapPane)||new Z(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,s){var h=t&&s!==void 0?this._getNewPixelOrigin(t,s):this.getPixelOrigin();return h.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,s){var h=this.getSize()._divideBy(2);return this.project(t,s)._subtract(h)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,s,h){var d=this._getNewPixelOrigin(h,s);return this.project(t,s)._subtract(d)},_latLngBoundsToNewLayerBounds:function(t,s,h){var d=this._getNewPixelOrigin(h,s);return Ct([this.project(t.getSouthWest(),s)._subtract(d),this.project(t.getNorthWest(),s)._subtract(d),this.project(t.getSouthEast(),s)._subtract(d),this.project(t.getNorthEast(),s)._subtract(d)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,s,h){if(!h)return t;var d=this.project(t,s),_=this.getSize().divideBy(2),v=new Mt(d.subtract(_),d.add(_)),P=this._getBoundsOffset(v,h,s);return Math.abs(P.x)<=1&&Math.abs(P.y)<=1?t:this.unproject(d.add(P),s)},_limitOffset:function(t,s){if(!s)return t;var h=this.getPixelBounds(),d=new Mt(h.min.add(t),h.max.add(t));return t.add(this._getBoundsOffset(d,s))},_getBoundsOffset:function(t,s,h){var d=Ct(this.project(s.getNorthEast(),h),this.project(s.getSouthWest(),h)),_=d.min.subtract(t.min),v=d.max.subtract(t.max),P=this._rebound(_.x,-v.x),O=this._rebound(_.y,-v.y);return new Z(P,O)},_rebound:function(t,s){return t+s>0?Math.round(t-s)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(s))},_limitZoom:function(t){var s=this.getMinZoom(),h=this.getMaxZoom(),d=Pt.any3d?this.options.zoomSnap:1;return d&&(t=Math.round(t/d)*d),Math.max(s,Math.min(h,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){xe(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,s){var h=this._getCenterOffset(t)._trunc();return(s&&s.animate)!==!0&&!this.getSize().contains(h)?!1:(this.panBy(h,s),!0)},_createAnimProxy:function(){var t=this._proxy=Bt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(s){var h=Di,d=this._proxy.style[h];Ii(this._proxy,this.project(s.center,s.zoom),this.getZoomScale(s.zoom,1)),d===this._proxy.style[h]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){se(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),s=this.getZoom();Ii(this._proxy,this.project(t,s),this.getZoomScale(s,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,s,h){if(this._animatingZoom)return!0;if(h=h||{},!this._zoomAnimated||h.animate===!1||this._nothingToAnimate()||Math.abs(s-this._zoom)>this.options.zoomAnimationThreshold)return!1;var d=this.getZoomScale(s),_=this._getCenterOffset(t)._divideBy(1-1/d);return h.animate!==!0&&!this.getSize().contains(_)?!1:(ct(function(){this._moveStart(!0,h.noMoveStart||!1)._animateZoom(t,s,!0)},this),!0)},_animateZoom:function(t,s,h,d){this._mapPane&&(h&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=s,Rt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:s,noUpdate:d}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(l(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&xe(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function gl(t,s){return new ge(t,s)}var an=V.extend({options:{position:"topright"},initialize:function(t){C(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var s=this._map;return s&&s.removeControl(this),this.options.position=t,s&&s.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var s=this._container=this.onAdd(t),h=this.getPosition(),d=t._controlCorners[h];return Rt(s,"leaflet-control"),h.indexOf("bottom")!==-1?d.insertBefore(s,d.firstChild):d.appendChild(s),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(se(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Un=function(t){return new an(t)};ge.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},s="leaflet-",h=this._controlContainer=Bt("div",s+"control-container",this._container);function d(_,v){var P=s+_+" "+s+v;t[_+v]=Bt("div",P,h)}d("top","left"),d("top","right"),d("bottom","left"),d("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)se(this._controlCorners[t]);se(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var ds=an.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,s,h,d){return h<d?-1:d<h?1:0}},initialize:function(t,s,h){C(this,h),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var d in t)this._addLayer(t[d],d);for(d in s)this._addLayer(s[d],d,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var s=0;s<this._layers.length;s++)this._layers[s].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return an.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,s){return this._addLayer(t,s),this._map?this._update():this},addOverlay:function(t,s){return this._addLayer(t,s,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var s=this._getLayer(u(t));return s&&this._layers.splice(this._layers.indexOf(s),1),this._map?this._update():this},expand:function(){Rt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(Rt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):xe(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return xe(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",s=this._container=Bt("div",t),h=this.options.collapsed;s.setAttribute("aria-haspopup",!0),Gn(s),yn(s);var d=this._section=Bt("section",t+"-list");h&&(this._map.on("click",this.collapse,this),vt(s,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var _=this._layersLink=Bt("a",t+"-toggle",s);_.href="#",_.title="Layers",_.setAttribute("role","button"),vt(_,{keydown:function(v){v.keyCode===13&&this._expandSafely()},click:function(v){zi(v),this._expandSafely()}},this),h||this.expand(),this._baseLayersList=Bt("div",t+"-base",d),this._separator=Bt("div",t+"-separator",d),this._overlaysList=Bt("div",t+"-overlays",d),s.appendChild(d)},_getLayer:function(t){for(var s=0;s<this._layers.length;s++)if(this._layers[s]&&u(this._layers[s].layer)===t)return this._layers[s]},_addLayer:function(t,s,h){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:s,overlay:h}),this.options.sortLayers&&this._layers.sort(l(function(d,_){return this.options.sortFunction(d.layer,_.layer,d.name,_.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Pi(this._baseLayersList),Pi(this._overlaysList),this._layerControlInputs=[];var t,s,h,d,_=0;for(h=0;h<this._layers.length;h++)d=this._layers[h],this._addItem(d),s=s||d.overlay,t=t||!d.overlay,_+=d.overlay?0:1;return this.options.hideSingleBase&&(t=t&&_>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=s&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var s=this._getLayer(u(t.target)),h=s.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;h&&this._map.fire(h,s)},_createRadioElement:function(t,s){var h='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(s?' checked="checked"':"")+"/>",d=document.createElement("div");return d.innerHTML=h,d.firstChild},_addItem:function(t){var s=document.createElement("label"),h=this._map.hasLayer(t.layer),d;t.overlay?(d=document.createElement("input"),d.type="checkbox",d.className="leaflet-control-layers-selector",d.defaultChecked=h):d=this._createRadioElement("leaflet-base-layers_"+u(this),h),this._layerControlInputs.push(d),d.layerId=u(t.layer),vt(d,"click",this._onInputClick,this);var _=document.createElement("span");_.innerHTML=" "+t.name;var v=document.createElement("span");s.appendChild(v),v.appendChild(d),v.appendChild(_);var P=t.overlay?this._overlaysList:this._baseLayersList;return P.appendChild(s),this._checkDisabledLayers(),s},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,s,h,d=[],_=[];this._handlingClick=!0;for(var v=t.length-1;v>=0;v--)s=t[v],h=this._getLayer(s.layerId).layer,s.checked?d.push(h):s.checked||_.push(h);for(v=0;v<_.length;v++)this._map.hasLayer(_[v])&&this._map.removeLayer(_[v]);for(v=0;v<d.length;v++)this._map.hasLayer(d[v])||this._map.addLayer(d[v]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,s,h,d=this._map.getZoom(),_=t.length-1;_>=0;_--)s=t[_],h=this._getLayer(s.layerId).layer,s.disabled=h.options.minZoom!==void 0&&d<h.options.minZoom||h.options.maxZoom!==void 0&&d>h.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,vt(t,"click",zi),this.expand();var s=this;setTimeout(function(){jt(t,"click",zi),s._preventClick=!1})}}),vl=function(t,s,h){return new ds(t,s,h)},zo=an.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var s="leaflet-control-zoom",h=Bt("div",s+" leaflet-bar"),d=this.options;return this._zoomInButton=this._createButton(d.zoomInText,d.zoomInTitle,s+"-in",h,this._zoomIn),this._zoomOutButton=this._createButton(d.zoomOutText,d.zoomOutTitle,s+"-out",h,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),h},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,s,h,d,_){var v=Bt("a",h,d);return v.innerHTML=t,v.href="#",v.title=s,v.setAttribute("role","button"),v.setAttribute("aria-label",s),Gn(v),vt(v,"click",Mn),vt(v,"click",_,this),vt(v,"click",this._refocusOnMap,this),v},_updateDisabled:function(){var t=this._map,s="leaflet-disabled";xe(this._zoomInButton,s),xe(this._zoomOutButton,s),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(Rt(this._zoomOutButton,s),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(Rt(this._zoomInButton,s),this._zoomInButton.setAttribute("aria-disabled","true"))}});ge.mergeOptions({zoomControl:!0}),ge.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new zo,this.addControl(this.zoomControl))});var yl=function(t){return new zo(t)},fs=an.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var s="leaflet-control-scale",h=Bt("div",s),d=this.options;return this._addScales(d,s+"-line",h),t.on(d.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),h},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,s,h){t.metric&&(this._mScale=Bt("div",s,h)),t.imperial&&(this._iScale=Bt("div",s,h))},_update:function(){var t=this._map,s=t.getSize().y/2,h=t.distance(t.containerPointToLatLng([0,s]),t.containerPointToLatLng([this.options.maxWidth,s]));this._updateScales(h)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var s=this._getRoundNum(t),h=s<1e3?s+" m":s/1e3+" km";this._updateScale(this._mScale,h,s/t)},_updateImperial:function(t){var s=t*3.2808399,h,d,_;s>5280?(h=s/5280,d=this._getRoundNum(h),this._updateScale(this._iScale,d+" mi",d/h)):(_=this._getRoundNum(s),this._updateScale(this._iScale,_+" ft",_/s))},_updateScale:function(t,s,h){t.style.width=Math.round(this.options.maxWidth*h)+"px",t.innerHTML=s},_getRoundNum:function(t){var s=Math.pow(10,(Math.floor(t)+"").length-1),h=t/s;return h=h>=10?10:h>=5?5:h>=3?3:h>=2?2:1,s*h}}),bl=function(t){return new fs(t)},wl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Oo=an.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Pt.inlineSvg?wl+" ":"")+"Leaflet</a>"},initialize:function(t){C(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=Bt("div","leaflet-control-attribution"),Gn(this._container);for(var s in t._layers)t._layers[s].getAttribution&&this.addAttribution(t._layers[s].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var s in this._attributions)this._attributions[s]&&t.push(s);var h=[];this.options.prefix&&h.push(this.options.prefix),t.length&&h.push(t.join(", ")),this._container.innerHTML=h.join(' <span aria-hidden="true">|</span> ')}}});ge.mergeOptions({attributionControl:!0}),ge.addInitHook(function(){this.options.attributionControl&&new Oo().addTo(this)});var Ll=function(t){return new Oo(t)};an.Layers=ds,an.Zoom=zo,an.Scale=fs,an.Attribution=Oo,Un.layers=vl,Un.zoom=yl,Un.scale=bl,Un.attribution=Ll;var cn=V.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});cn.addTo=function(t,s){return t.addHandler(s,this),this};var kl={Events:_t},_s=Pt.touch?"touchstart mousedown":"mousedown",bn=U.extend({options:{clickTolerance:3},initialize:function(t,s,h,d){C(this,d),this._element=t,this._dragStartTarget=s||t,this._preventOutline=h},enable:function(){this._enabled||(vt(this._dragStartTarget,_s,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(bn._dragging===this&&this.finishDrag(!0),jt(this._dragStartTarget,_s,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!Te(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){bn._dragging===this&&this.finishDrag();return}if(!(bn._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(bn._dragging=this,this._preventOutline&&E(this._element),hn(),Gi(),!this._moving)){this.fire("down");var s=t.touches?t.touches[0]:t,h=rt(this._element);this._startPoint=new Z(s.clientX,s.clientY),this._startPos=Fi(this._element),this._parentScale=nt(h);var d=t.type==="mousedown";vt(document,d?"mousemove":"touchmove",this._onMove,this),vt(document,d?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var s=t.touches&&t.touches.length===1?t.touches[0]:t,h=new Z(s.clientX,s.clientY)._subtract(this._startPoint);!h.x&&!h.y||Math.abs(h.x)+Math.abs(h.y)<this.options.clickTolerance||(h.x/=this._parentScale.x,h.y/=this._parentScale.y,zi(t),this._moved||(this.fire("dragstart"),this._moved=!0,Rt(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Rt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(h),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),Ue(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){xe(document.body,"leaflet-dragging"),this._lastTarget&&(xe(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),jt(document,"mousemove touchmove",this._onMove,this),jt(document,"mouseup touchend touchcancel",this._onUp,this),Ai(),bi();var s=this._moved&&this._moving;this._moving=!1,bn._dragging=!1,s&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function ps(t,s,h){var d,_=[1,4,2,8],v,P,O,R,ut,Tt,Ut,re;for(v=0,Tt=t.length;v<Tt;v++)t[v]._code=Pn(t[v],s);for(O=0;O<4;O++){for(Ut=_[O],d=[],v=0,Tt=t.length,P=Tt-1;v<Tt;P=v++)R=t[v],ut=t[P],R._code&Ut?ut._code&Ut||(re=ro(ut,R,Ut,s,h),re._code=Pn(re,s),d.push(re)):(ut._code&Ut&&(re=ro(ut,R,Ut,s,h),re._code=Pn(re,s),d.push(re)),d.push(R));t=d}return t}function ms(t,s){var h,d,_,v,P,O,R,ut,Tt;if(!t||t.length===0)throw new Error("latlngs not passed");$i(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var Ut=X([0,0]),re=H(t),Ni=re.getNorthWest().distanceTo(re.getSouthWest())*re.getNorthEast().distanceTo(re.getNorthWest());Ni<1700&&(Ut=Io(t));var Ti=t.length,tn=[];for(h=0;h<Ti;h++){var Wi=X(t[h]);tn.push(s.project(X([Wi.lat-Ut.lat,Wi.lng-Ut.lng])))}for(O=R=ut=0,h=0,d=Ti-1;h<Ti;d=h++)_=tn[h],v=tn[d],P=_.y*v.x-v.y*_.x,R+=(_.x+v.x)*P,ut+=(_.y+v.y)*P,O+=P*3;O===0?Tt=tn[0]:Tt=[R/O,ut/O];var Nn=s.unproject(at(Tt));return X([Nn.lat+Ut.lat,Nn.lng+Ut.lng])}function Io(t){for(var s=0,h=0,d=0,_=0;_<t.length;_++){var v=X(t[_]);s+=v.lat,h+=v.lng,d++}return X([s/d,h/d])}var Ml={__proto__:null,clipPolygon:ps,polygonCenter:ms,centroid:Io};function gs(t,s){if(!s||!t.length)return t.slice();var h=s*s;return t=Cl(t,h),t=El(t,h),t}function vs(t,s,h){return Math.sqrt(Wn(t,s,h,!0))}function Pl(t,s,h){return Wn(t,s,h)}function El(t,s){var h=t.length,d=typeof Uint8Array<"u"?Uint8Array:Array,_=new d(h);_[0]=_[h-1]=1,Ao(t,_,s,0,h-1);var v,P=[];for(v=0;v<h;v++)_[v]&&P.push(t[v]);return P}function Ao(t,s,h,d,_){var v=0,P,O,R;for(O=d+1;O<=_-1;O++)R=Wn(t[O],t[d],t[_],!0),R>v&&(P=O,v=R);v>h&&(s[P]=1,Ao(t,s,h,d,P),Ao(t,s,h,P,_))}function Cl(t,s){for(var h=[t[0]],d=1,_=0,v=t.length;d<v;d++)Tl(t[d],t[_])>s&&(h.push(t[d]),_=d);return _<v-1&&h.push(t[v-1]),h}var ys;function bs(t,s,h,d,_){var v=d?ys:Pn(t,h),P=Pn(s,h),O,R,ut;for(ys=P;;){if(!(v|P))return[t,s];if(v&P)return!1;O=v||P,R=ro(t,s,O,h,_),ut=Pn(R,h),O===v?(t=R,v=ut):(s=R,P=ut)}}function ro(t,s,h,d,_){var v=s.x-t.x,P=s.y-t.y,O=d.min,R=d.max,ut,Tt;return h&8?(ut=t.x+v*(R.y-t.y)/P,Tt=R.y):h&4?(ut=t.x+v*(O.y-t.y)/P,Tt=O.y):h&2?(ut=R.x,Tt=t.y+P*(R.x-t.x)/v):h&1&&(ut=O.x,Tt=t.y+P*(O.x-t.x)/v),new Z(ut,Tt,_)}function Pn(t,s){var h=0;return t.x<s.min.x?h|=1:t.x>s.max.x&&(h|=2),t.y<s.min.y?h|=4:t.y>s.max.y&&(h|=8),h}function Tl(t,s){var h=s.x-t.x,d=s.y-t.y;return h*h+d*d}function Wn(t,s,h,d){var _=s.x,v=s.y,P=h.x-_,O=h.y-v,R=P*P+O*O,ut;return R>0&&(ut=((t.x-_)*P+(t.y-v)*O)/R,ut>1?(_=h.x,v=h.y):ut>0&&(_+=P*ut,v+=O*ut)),P=t.x-_,O=t.y-v,d?P*P+O*O:new Z(_,v)}function $i(t){return!x(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function ws(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),$i(t)}function Ls(t,s){var h,d,_,v,P,O,R,ut;if(!t||t.length===0)throw new Error("latlngs not passed");$i(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var Tt=X([0,0]),Ut=H(t),re=Ut.getNorthWest().distanceTo(Ut.getSouthWest())*Ut.getNorthEast().distanceTo(Ut.getNorthWest());re<1700&&(Tt=Io(t));var Ni=t.length,Ti=[];for(h=0;h<Ni;h++){var tn=X(t[h]);Ti.push(s.project(X([tn.lat-Tt.lat,tn.lng-Tt.lng])))}for(h=0,d=0;h<Ni-1;h++)d+=Ti[h].distanceTo(Ti[h+1])/2;if(d===0)ut=Ti[0];else for(h=0,v=0;h<Ni-1;h++)if(P=Ti[h],O=Ti[h+1],_=P.distanceTo(O),v+=_,v>d){R=(v-d)/_,ut=[O.x-R*(O.x-P.x),O.y-R*(O.y-P.y)];break}var Wi=s.unproject(at(ut));return X([Wi.lat+Tt.lat,Wi.lng+Tt.lng])}var Sl={__proto__:null,simplify:gs,pointToSegmentDistance:vs,closestPointOnSegment:Pl,clipSegment:bs,_getEdgeIntersection:ro,_getBitCode:Pn,_sqClosestPointOnSegment:Wn,isFlat:$i,_flat:ws,polylineCenter:Ls},xo={project:function(t){return new Z(t.lng,t.lat)},unproject:function(t){return new q(t.y,t.x)},bounds:new Mt([-180,-90],[180,90])},No={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Mt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var s=Math.PI/180,h=this.R,d=t.lat*s,_=this.R_MINOR/h,v=Math.sqrt(1-_*_),P=v*Math.sin(d),O=Math.tan(Math.PI/4-d/2)/Math.pow((1-P)/(1+P),v/2);return d=-h*Math.log(Math.max(O,1e-10)),new Z(t.lng*s*h,d)},unproject:function(t){for(var s=180/Math.PI,h=this.R,d=this.R_MINOR/h,_=Math.sqrt(1-d*d),v=Math.exp(-t.y/h),P=Math.PI/2-2*Math.atan(v),O=0,R=.1,ut;O<15&&Math.abs(R)>1e-7;O++)ut=_*Math.sin(P),ut=Math.pow((1-ut)/(1+ut),_/2),R=Math.PI/2-2*Math.atan(v*ut)-P,P+=R;return new q(P*s,t.x*s/h)}},Dl={__proto__:null,LonLat:xo,Mercator:No,SphericalMercator:dt},zl=i({},Ft,{code:"EPSG:3395",projection:No,transformation:function(){var t=.5/(Math.PI*No.R);return zt(t,.5,-t,.5)}()}),ks=i({},Ft,{code:"EPSG:4326",projection:xo,transformation:zt(1/180,1,-1/180,.5)}),Ol=i({},I,{projection:xo,transformation:zt(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,s){var h=s.lng-t.lng,d=s.lat-t.lat;return Math.sqrt(h*h+d*d)},infinite:!0});I.Earth=Ft,I.EPSG3395=zl,I.EPSG3857=xt,I.EPSG900913=le,I.EPSG4326=ks,I.Simple=Ol;var ln=U.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[u(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[u(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var s=t.target;if(s.hasLayer(this)){if(this._map=s,this._zoomAnimated=s._zoomAnimated,this.getEvents){var h=this.getEvents();s.on(h,this),this.once("remove",function(){s.off(h,this)},this)}this.onAdd(s),this.fire("add"),s.fire("layeradd",{layer:this})}}});ge.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var s=u(t);return this._layers[s]?this:(this._layers[s]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var s=u(t);return this._layers[s]?(this._loaded&&t.onRemove(this),delete this._layers[s],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return u(t)in this._layers},eachLayer:function(t,s){for(var h in this._layers)t.call(s,this._layers[h]);return this},_addLayers:function(t){t=t?x(t)?t:[t]:[];for(var s=0,h=t.length;s<h;s++)this.addLayer(t[s])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[u(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var s=u(t);this._zoomBoundLayers[s]&&(delete this._zoomBoundLayers[s],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,s=-1/0,h=this._getZoomSpan();for(var d in this._zoomBoundLayers){var _=this._zoomBoundLayers[d].options;t=_.minZoom===void 0?t:Math.min(t,_.minZoom),s=_.maxZoom===void 0?s:Math.max(s,_.maxZoom)}this._layersMaxZoom=s===-1/0?void 0:s,this._layersMinZoom=t===1/0?void 0:t,h!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var zn=ln.extend({initialize:function(t,s){C(this,s),this._layers={};var h,d;if(t)for(h=0,d=t.length;h<d;h++)this.addLayer(t[h])},addLayer:function(t){var s=this.getLayerId(t);return this._layers[s]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var s=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[s]&&this._map.removeLayer(this._layers[s]),delete this._layers[s],this},hasLayer:function(t){var s=typeof t=="number"?t:this.getLayerId(t);return s in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var s=Array.prototype.slice.call(arguments,1),h,d;for(h in this._layers)d=this._layers[h],d[t]&&d[t].apply(d,s);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,s){for(var h in this._layers)t.call(s,this._layers[h]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return u(t)}}),Il=function(t,s){return new zn(t,s)},_n=zn.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),zn.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),zn.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new wt;for(var s in this._layers){var h=this._layers[s];t.extend(h.getBounds?h.getBounds():h.getLatLng())}return t}}),Al=function(t,s){return new _n(t,s)},On=V.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){C(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,s){var h=this._getIconUrl(t);if(!h){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var d=this._createImg(h,s&&s.tagName==="IMG"?s:null);return this._setIconStyles(d,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(d.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),d},_setIconStyles:function(t,s){var h=this.options,d=h[s+"Size"];typeof d=="number"&&(d=[d,d]);var _=at(d),v=at(s==="shadow"&&h.shadowAnchor||h.iconAnchor||_&&_.divideBy(2,!0));t.className="leaflet-marker-"+s+" "+(h.className||""),v&&(t.style.marginLeft=-v.x+"px",t.style.marginTop=-v.y+"px"),_&&(t.style.width=_.x+"px",t.style.height=_.y+"px")},_createImg:function(t,s){return s=s||document.createElement("img"),s.src=t,s},_getIconUrl:function(t){return Pt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function xl(t){return new On(t)}var Vn=On.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof Vn.imagePath!="string"&&(Vn.imagePath=this._detectIconPath()),(this.options.imagePath||Vn.imagePath)+On.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var s=function(h,d,_){var v=d.exec(h);return v&&v[_]};return t=s(t,/^url\((['"])?(.+)\1\)$/,2),t&&s(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=Bt("div","leaflet-default-icon-path",document.body),s=mt(t,"background-image")||mt(t,"backgroundImage");if(document.body.removeChild(t),s=this._stripUrl(s),s)return s;var h=document.querySelector('link[href$="leaflet.css"]');return h?h.href.substring(0,h.href.length-11-1):""}}),Ms=cn.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new bn(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Rt(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&xe(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var s=this._marker,h=s._map,d=this._marker.options.autoPanSpeed,_=this._marker.options.autoPanPadding,v=Fi(s._icon),P=h.getPixelBounds(),O=h.getPixelOrigin(),R=Ct(P.min._subtract(O).add(_),P.max._subtract(O).subtract(_));if(!R.contains(v)){var ut=at((Math.max(R.max.x,v.x)-R.max.x)/(P.max.x-R.max.x)-(Math.min(R.min.x,v.x)-R.min.x)/(P.min.x-R.min.x),(Math.max(R.max.y,v.y)-R.max.y)/(P.max.y-R.max.y)-(Math.min(R.min.y,v.y)-R.min.y)/(P.min.y-R.min.y)).multiplyBy(d);h.panBy(ut,{animate:!1}),this._draggable._newPos._add(ut),this._draggable._startPos._add(ut),Ue(s._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=ct(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(N(this._panRequest),this._panRequest=ct(this._adjustPan.bind(this,t)))},_onDrag:function(t){var s=this._marker,h=s._shadow,d=Fi(s._icon),_=s._map.layerPointToLatLng(d);h&&Ue(h,d),s._latlng=_,t.latlng=_,t.oldLatLng=this._oldLatLng,s.fire("move",t).fire("drag",t)},_onDragEnd:function(t){N(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),ao=ln.extend({options:{icon:new Vn,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,s){C(this,s),this._latlng=X(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var s=this._latlng;return this._latlng=X(t),this.update(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,s="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),h=t.icon.createIcon(this._icon),d=!1;h!==this._icon&&(this._icon&&this._removeIcon(),d=!0,t.title&&(h.title=t.title),h.tagName==="IMG"&&(h.alt=t.alt||"")),Rt(h,s),t.keyboard&&(h.tabIndex="0",h.setAttribute("role","button")),this._icon=h,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&vt(h,"focus",this._panOnFocus,this);var _=t.icon.createShadow(this._shadow),v=!1;_!==this._shadow&&(this._removeShadow(),v=!0),_&&(Rt(_,s),_.alt=""),this._shadow=_,t.opacity<1&&this._updateOpacity(),d&&this.getPane().appendChild(this._icon),this._initInteraction(),_&&v&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&jt(this._icon,"focus",this._panOnFocus,this),se(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&se(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&Ue(this._icon,t),this._shadow&&Ue(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var s=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(s)},_initInteraction:function(){if(this.options.interactive&&(Rt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ms)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ms(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&ai(this._icon,t),this._shadow&&ai(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var s=this.options.icon.options,h=s.iconSize?at(s.iconSize):at(0,0),d=s.iconAnchor?at(s.iconAnchor):at(0,0);t.panInside(this._latlng,{paddingTopLeft:d,paddingBottomRight:h.subtract(d)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Nl(t,s){return new ao(t,s)}var wn=ln.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return C(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),lo=wn.extend({options:{fill:!0,radius:10},initialize:function(t,s){C(this,s),this._latlng=X(t),this._radius=this.options.radius},setLatLng:function(t){var s=this._latlng;return this._latlng=X(t),this.redraw(),this.fire("move",{oldLatLng:s,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var s=t&&t.radius||this._radius;return wn.prototype.setStyle.call(this,t),this.setRadius(s),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,s=this._radiusY||t,h=this._clickTolerance(),d=[t+h,s+h];this._pxBounds=new Mt(this._point.subtract(d),this._point.add(d))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Bl(t,s){return new lo(t,s)}var Bo=lo.extend({initialize:function(t,s,h){if(typeof s=="number"&&(s=i({},h,{radius:s})),C(this,s),this._latlng=X(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new wt(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:wn.prototype.setStyle,_project:function(){var t=this._latlng.lng,s=this._latlng.lat,h=this._map,d=h.options.crs;if(d.distance===Ft.distance){var _=Math.PI/180,v=this._mRadius/Ft.R/_,P=h.project([s+v,t]),O=h.project([s-v,t]),R=P.add(O).divideBy(2),ut=h.unproject(R).lat,Tt=Math.acos((Math.cos(v*_)-Math.sin(s*_)*Math.sin(ut*_))/(Math.cos(s*_)*Math.cos(ut*_)))/_;(isNaN(Tt)||Tt===0)&&(Tt=v/Math.cos(Math.PI/180*s)),this._point=R.subtract(h.getPixelOrigin()),this._radius=isNaN(Tt)?0:R.x-h.project([ut,t-Tt]).x,this._radiusY=R.y-P.y}else{var Ut=d.unproject(d.project(this._latlng).subtract([this._mRadius,0]));this._point=h.latLngToLayerPoint(this._latlng),this._radius=this._point.x-h.latLngToLayerPoint(Ut).x}this._updateBounds()}});function Rl(t,s,h){return new Bo(t,s,h)}var pn=wn.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,s){C(this,s),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var s=1/0,h=null,d=Wn,_,v,P=0,O=this._parts.length;P<O;P++)for(var R=this._parts[P],ut=1,Tt=R.length;ut<Tt;ut++){_=R[ut-1],v=R[ut];var Ut=d(t,_,v,!0);Ut<s&&(s=Ut,h=d(t,_,v))}return h&&(h.distance=Math.sqrt(s)),h},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ls(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,s){return s=s||this._defaultShape(),t=X(t),s.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new wt,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return $i(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var s=[],h=$i(t),d=0,_=t.length;d<_;d++)h?(s[d]=X(t[d]),this._bounds.extend(s[d])):s[d]=this._convertLatLngs(t[d]);return s},_project:function(){var t=new Mt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),s=new Z(t,t);this._rawPxBounds&&(this._pxBounds=new Mt([this._rawPxBounds.min.subtract(s),this._rawPxBounds.max.add(s)]))},_projectLatlngs:function(t,s,h){var d=t[0]instanceof q,_=t.length,v,P;if(d){for(P=[],v=0;v<_;v++)P[v]=this._map.latLngToLayerPoint(t[v]),h.extend(P[v]);s.push(P)}else for(v=0;v<_;v++)this._projectLatlngs(t[v],s,h)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var s=this._parts,h,d,_,v,P,O,R;for(h=0,_=0,v=this._rings.length;h<v;h++)for(R=this._rings[h],d=0,P=R.length;d<P-1;d++)O=bs(R[d],R[d+1],t,d,!0),O&&(s[_]=s[_]||[],s[_].push(O[0]),(O[1]!==R[d+1]||d===P-2)&&(s[_].push(O[1]),_++))}},_simplifyPoints:function(){for(var t=this._parts,s=this.options.smoothFactor,h=0,d=t.length;h<d;h++)t[h]=gs(t[h],s)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,s){var h,d,_,v,P,O,R=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(h=0,v=this._parts.length;h<v;h++)for(O=this._parts[h],d=0,P=O.length,_=P-1;d<P;_=d++)if(!(!s&&d===0)&&vs(t,O[_],O[d])<=R)return!0;return!1}});function Zl(t,s){return new pn(t,s)}pn._flat=ws;var In=pn.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ms(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var s=pn.prototype._convertLatLngs.call(this,t),h=s.length;return h>=2&&s[0]instanceof q&&s[0].equals(s[h-1])&&s.pop(),s},_setLatLngs:function(t){pn.prototype._setLatLngs.call(this,t),$i(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return $i(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,s=this.options.weight,h=new Z(s,s);if(t=new Mt(t.min.subtract(h),t.max.add(h)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var d=0,_=this._rings.length,v;d<_;d++)v=ps(this._rings[d],t,!0),v.length&&this._parts.push(v)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var s=!1,h,d,_,v,P,O,R,ut;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(v=0,R=this._parts.length;v<R;v++)for(h=this._parts[v],P=0,ut=h.length,O=ut-1;P<ut;O=P++)d=h[P],_=h[O],d.y>t.y!=_.y>t.y&&t.x<(_.x-d.x)*(t.y-d.y)/(_.y-d.y)+d.x&&(s=!s);return s||pn.prototype._containsPoint.call(this,t,!0)}});function Hl(t,s){return new In(t,s)}var mn=_n.extend({initialize:function(t,s){C(this,s),this._layers={},t&&this.addData(t)},addData:function(t){var s=x(t)?t:t.features,h,d,_;if(s){for(h=0,d=s.length;h<d;h++)_=s[h],(_.geometries||_.geometry||_.features||_.coordinates)&&this.addData(_);return this}var v=this.options;if(v.filter&&!v.filter(t))return this;var P=ho(t,v);return P?(P.feature=fo(t),P.defaultOptions=P.options,this.resetStyle(P),v.onEachFeature&&v.onEachFeature(t,P),this.addLayer(P)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=i({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(s){this._setLayerStyle(s,t)},this)},_setLayerStyle:function(t,s){t.setStyle&&(typeof s=="function"&&(s=s(t.feature)),t.setStyle(s))}});function ho(t,s){var h=t.type==="Feature"?t.geometry:t,d=h?h.coordinates:null,_=[],v=s&&s.pointToLayer,P=s&&s.coordsToLatLng||Ro,O,R,ut,Tt;if(!d&&!h)return null;switch(h.type){case"Point":return O=P(d),Ps(v,t,O,s);case"MultiPoint":for(ut=0,Tt=d.length;ut<Tt;ut++)O=P(d[ut]),_.push(Ps(v,t,O,s));return new _n(_);case"LineString":case"MultiLineString":return R=co(d,h.type==="LineString"?0:1,P),new pn(R,s);case"Polygon":case"MultiPolygon":return R=co(d,h.type==="Polygon"?1:2,P),new In(R,s);case"GeometryCollection":for(ut=0,Tt=h.geometries.length;ut<Tt;ut++){var Ut=ho({geometry:h.geometries[ut],type:"Feature",properties:t.properties},s);Ut&&_.push(Ut)}return new _n(_);case"FeatureCollection":for(ut=0,Tt=h.features.length;ut<Tt;ut++){var re=ho(h.features[ut],s);re&&_.push(re)}return new _n(_);default:throw new Error("Invalid GeoJSON object.")}}function Ps(t,s,h,d){return t?t(s,h):new ao(h,d&&d.markersInheritOptions&&d)}function Ro(t){return new q(t[1],t[0],t[2])}function co(t,s,h){for(var d=[],_=0,v=t.length,P;_<v;_++)P=s?co(t[_],s-1,h):(h||Ro)(t[_]),d.push(P);return d}function Zo(t,s){return t=X(t),t.alt!==void 0?[y(t.lng,s),y(t.lat,s),y(t.alt,s)]:[y(t.lng,s),y(t.lat,s)]}function uo(t,s,h,d){for(var _=[],v=0,P=t.length;v<P;v++)_.push(s?uo(t[v],$i(t[v])?0:s-1,h,d):Zo(t[v],d));return!s&&h&&_.length>0&&_.push(_[0].slice()),_}function An(t,s){return t.feature?i({},t.feature,{geometry:s}):fo(s)}function fo(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var Ho={toGeoJSON:function(t){return An(this,{type:"Point",coordinates:Zo(this.getLatLng(),t)})}};ao.include(Ho),Bo.include(Ho),lo.include(Ho),pn.include({toGeoJSON:function(t){var s=!$i(this._latlngs),h=uo(this._latlngs,s?1:0,!1,t);return An(this,{type:(s?"Multi":"")+"LineString",coordinates:h})}}),In.include({toGeoJSON:function(t){var s=!$i(this._latlngs),h=s&&!$i(this._latlngs[0]),d=uo(this._latlngs,h?2:s?1:0,!0,t);return s||(d=[d]),An(this,{type:(h?"Multi":"")+"Polygon",coordinates:d})}}),zn.include({toMultiPoint:function(t){var s=[];return this.eachLayer(function(h){s.push(h.toGeoJSON(t).geometry.coordinates)}),An(this,{type:"MultiPoint",coordinates:s})},toGeoJSON:function(t){var s=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(s==="MultiPoint")return this.toMultiPoint(t);var h=s==="GeometryCollection",d=[];return this.eachLayer(function(_){if(_.toGeoJSON){var v=_.toGeoJSON(t);if(h)d.push(v.geometry);else{var P=fo(v);P.type==="FeatureCollection"?d.push.apply(d,P.features):d.push(P)}}}),h?An(this,{geometries:d,type:"GeometryCollection"}):{type:"FeatureCollection",features:d}}});function Es(t,s){return new mn(t,s)}var jl=Es,_o=ln.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,s,h){this._url=t,this._bounds=H(s),C(this,h)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Rt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){se(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&ri(this._image),this},bringToBack:function(){return this._map&&Ge(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=H(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",s=this._image=t?this._url:Bt("img");if(Rt(s,"leaflet-image-layer"),this._zoomAnimated&&Rt(s,"leaflet-zoom-animated"),this.options.className&&Rt(s,this.options.className),s.onselectstart=g,s.onmousemove=g,s.onload=l(this.fire,this,"load"),s.onerror=l(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(s.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=s.src;return}s.src=this._url,s.alt=this.options.alt},_animateZoom:function(t){var s=this._map.getZoomScale(t.zoom),h=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;Ii(this._image,h,s)},_reset:function(){var t=this._image,s=new Mt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),h=s.getSize();Ue(t,s.min),t.style.width=h.x+"px",t.style.height=h.y+"px"},_updateOpacity:function(){ai(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Fl=function(t,s,h){return new _o(t,s,h)},Cs=_o.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",s=this._image=t?this._url:Bt("video");if(Rt(s,"leaflet-image-layer"),this._zoomAnimated&&Rt(s,"leaflet-zoom-animated"),this.options.className&&Rt(s,this.options.className),s.onselectstart=g,s.onmousemove=g,s.onloadeddata=l(this.fire,this,"load"),t){for(var h=s.getElementsByTagName("source"),d=[],_=0;_<h.length;_++)d.push(h[_].src);this._url=h.length>0?d:[s.src];return}x(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(s.style,"objectFit")&&(s.style.objectFit="fill"),s.autoplay=!!this.options.autoplay,s.loop=!!this.options.loop,s.muted=!!this.options.muted,s.playsInline=!!this.options.playsInline;for(var v=0;v<this._url.length;v++){var P=Bt("source");P.src=this._url[v],s.appendChild(P)}}});function Gl(t,s,h){return new Cs(t,s,h)}var Ts=_o.extend({_initImage:function(){var t=this._image=this._url;Rt(t,"leaflet-image-layer"),this._zoomAnimated&&Rt(t,"leaflet-zoom-animated"),this.options.className&&Rt(t,this.options.className),t.onselectstart=g,t.onmousemove=g}});function Ul(t,s,h){return new Ts(t,s,h)}var un=ln.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,s){t&&(t instanceof q||x(t))?(this._latlng=X(t),C(this,s)):(C(this,t),this._source=s),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&ai(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&ai(this._container,1),this.bringToFront(),this.options.interactive&&(Rt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(ai(this._container,0),this._removeTimeout=setTimeout(l(se,void 0,this._container),200)):se(this._container),this.options.interactive&&(xe(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=X(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&ri(this._container),this},bringToBack:function(){return this._map&&Ge(this._container),this},_prepareOpen:function(t){var s=this._source;if(!s._map)return!1;if(s instanceof _n){s=null;var h=this._source._layers;for(var d in h)if(h[d]._map){s=h[d];break}if(!s)return!1;this._source=s}if(!t)if(s.getCenter)t=s.getCenter();else if(s.getLatLng)t=s.getLatLng();else if(s.getBounds)t=s.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,s=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof s=="string")t.innerHTML=s;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(s)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),s=at(this.options.offset),h=this._getAnchor();this._zoomAnimated?Ue(this._container,t.add(h)):s=s.add(t).add(h);var d=this._containerBottom=-s.y,_=this._containerLeft=-Math.round(this._containerWidth/2)+s.x;this._container.style.bottom=d+"px",this._container.style.left=_+"px"}},_getAnchor:function(){return[0,0]}});ge.include({_initOverlay:function(t,s,h,d){var _=s;return _ instanceof t||(_=new t(d).setContent(s)),h&&_.setLatLng(h),_}}),ln.include({_initOverlay:function(t,s,h,d){var _=h;return _ instanceof t?(C(_,d),_._source=this):(_=s&&!d?s:new t(d,this),_.setContent(h)),_}});var po=un.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,un.prototype.openOn.call(this,t)},onAdd:function(t){un.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof wn||this._source.on("preclick",Qi))},onRemove:function(t){un.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof wn||this._source.off("preclick",Qi))},getEvents:function(){var t=un.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",s=this._container=Bt("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),h=this._wrapper=Bt("div",t+"-content-wrapper",s);if(this._contentNode=Bt("div",t+"-content",h),Gn(s),yn(this._contentNode),vt(s,"contextmenu",Qi),this._tipContainer=Bt("div",t+"-tip-container",s),this._tip=Bt("div",t+"-tip",this._tipContainer),this.options.closeButton){var d=this._closeButton=Bt("a",t+"-close-button",s);d.setAttribute("role","button"),d.setAttribute("aria-label","Close popup"),d.href="#close",d.innerHTML='<span aria-hidden="true">&#215;</span>',vt(d,"click",function(_){zi(_),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,s=t.style;s.width="",s.whiteSpace="nowrap";var h=t.offsetWidth;h=Math.min(h,this.options.maxWidth),h=Math.max(h,this.options.minWidth),s.width=h+1+"px",s.whiteSpace="",s.height="";var d=t.offsetHeight,_=this.options.maxHeight,v="leaflet-popup-scrolled";_&&d>_?(s.height=_+"px",Rt(t,v)):xe(t,v),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var s=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),h=this._getAnchor();Ue(this._container,s.add(h))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,s=parseInt(mt(this._container,"marginBottom"),10)||0,h=this._container.offsetHeight+s,d=this._containerWidth,_=new Z(this._containerLeft,-h-this._containerBottom);_._add(Fi(this._container));var v=t.layerPointToContainerPoint(_),P=at(this.options.autoPanPadding),O=at(this.options.autoPanPaddingTopLeft||P),R=at(this.options.autoPanPaddingBottomRight||P),ut=t.getSize(),Tt=0,Ut=0;v.x+d+R.x>ut.x&&(Tt=v.x+d-ut.x+R.x),v.x-Tt-O.x<0&&(Tt=v.x-O.x),v.y+h+R.y>ut.y&&(Ut=v.y+h-ut.y+R.y),v.y-Ut-O.y<0&&(Ut=v.y-O.y),(Tt||Ut)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([Tt,Ut]))}},_getAnchor:function(){return at(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Wl=function(t,s){return new po(t,s)};ge.mergeOptions({closePopupOnClick:!0}),ge.include({openPopup:function(t,s,h){return this._initOverlay(po,t,s,h).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),ln.include({bindPopup:function(t,s){return this._popup=this._initOverlay(po,this._popup,t,s),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof _n||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){Mn(t);var s=t.layer||t.target;if(this._popup._source===s&&!(s instanceof wn)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=s,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var mo=un.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){un.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){un.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=un.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",s=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Bt("div",s),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var s,h,d=this._map,_=this._container,v=d.latLngToContainerPoint(d.getCenter()),P=d.layerPointToContainerPoint(t),O=this.options.direction,R=_.offsetWidth,ut=_.offsetHeight,Tt=at(this.options.offset),Ut=this._getAnchor();O==="top"?(s=R/2,h=ut):O==="bottom"?(s=R/2,h=0):O==="center"?(s=R/2,h=ut/2):O==="right"?(s=0,h=ut/2):O==="left"?(s=R,h=ut/2):P.x<v.x?(O="right",s=0,h=ut/2):(O="left",s=R+(Tt.x+Ut.x)*2,h=ut/2),t=t.subtract(at(s,h,!0)).add(Tt).add(Ut),xe(_,"leaflet-tooltip-right"),xe(_,"leaflet-tooltip-left"),xe(_,"leaflet-tooltip-top"),xe(_,"leaflet-tooltip-bottom"),Rt(_,"leaflet-tooltip-"+O),Ue(_,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&ai(this._container,t)},_animateZoom:function(t){var s=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(s)},_getAnchor:function(){return at(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Vl=function(t,s){return new mo(t,s)};ge.include({openTooltip:function(t,s,h){return this._initOverlay(mo,t,s,h).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),ln.include({bindTooltip:function(t,s){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(mo,this._tooltip,t,s),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var s=t?"off":"on",h={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?h.add=this._openTooltip:(h.mouseover=this._openTooltip,h.mouseout=this.closeTooltip,h.click=this._openTooltip,this._map?this._addFocusListeners():h.add=this._addFocusListeners),this._tooltip.options.sticky&&(h.mousemove=this._moveTooltip),this[s](h),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof _n||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var s=typeof t.getElement=="function"&&t.getElement();s&&(vt(s,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),vt(s,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var s=typeof t.getElement=="function"&&t.getElement();s&&s.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var s=this;this._map.once("moveend",function(){s._openOnceFlag=!1,s._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var s=t.latlng,h,d;this._tooltip.options.sticky&&t.originalEvent&&(h=this._map.mouseEventToContainerPoint(t.originalEvent),d=this._map.containerPointToLayerPoint(h),s=this._map.layerPointToLatLng(d)),this._tooltip.setLatLng(s)}});var Ss=On.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var s=t&&t.tagName==="DIV"?t:document.createElement("div"),h=this.options;if(h.html instanceof Element?(Pi(s),s.appendChild(h.html)):s.innerHTML=h.html!==!1?h.html:"",h.bgPos){var d=at(h.bgPos);s.style.backgroundPosition=-d.x+"px "+-d.y+"px"}return this._setIconStyles(s,"icon"),s},createShadow:function(){return null}});function Yl(t){return new Ss(t)}On.Default=Vn;var Yn=ln.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Pt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){C(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),se(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(ri(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Ge(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof Z?t:new Z(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var s=this.getPane().children,h=-t(-1/0,1/0),d=0,_=s.length,v;d<_;d++)v=s[d].style.zIndex,s[d]!==this._container&&v&&(h=t(h,+v));isFinite(h)&&(this.options.zIndex=h+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Pt.ielt9){ai(this._container,this.options.opacity);var t=+new Date,s=!1,h=!1;for(var d in this._tiles){var _=this._tiles[d];if(!(!_.current||!_.loaded)){var v=Math.min(1,(t-_.loaded)/200);ai(_.el,v),v<1?s=!0:(_.active?h=!0:this._onOpaqueTile(_),_.active=!0)}}h&&!this._noPrune&&this._pruneTiles(),s&&(N(this._fadeFrame),this._fadeFrame=ct(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=Bt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,s=this.options.maxZoom;if(t!==void 0){for(var h in this._levels)h=Number(h),this._levels[h].el.children.length||h===t?(this._levels[h].el.style.zIndex=s-Math.abs(t-h),this._onUpdateLevel(h)):(se(this._levels[h].el),this._removeTilesAtZoom(h),this._onRemoveLevel(h),delete this._levels[h]);var d=this._levels[t],_=this._map;return d||(d=this._levels[t]={},d.el=Bt("div","leaflet-tile-container leaflet-zoom-animated",this._container),d.el.style.zIndex=s,d.origin=_.project(_.unproject(_.getPixelOrigin()),t).round(),d.zoom=t,this._setZoomTransform(d,_.getCenter(),_.getZoom()),g(d.el.offsetWidth),this._onCreateLevel(d)),this._level=d,d}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var t,s,h=this._map.getZoom();if(h>this.options.maxZoom||h<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)s=this._tiles[t],s.retain=s.current;for(t in this._tiles)if(s=this._tiles[t],s.current&&!s.active){var d=s.coords;this._retainParent(d.x,d.y,d.z,d.z-5)||this._retainChildren(d.x,d.y,d.z,d.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var s in this._tiles)this._tiles[s].coords.z===t&&this._removeTile(s)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)se(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,s,h,d){var _=Math.floor(t/2),v=Math.floor(s/2),P=h-1,O=new Z(+_,+v);O.z=+P;var R=this._tileCoordsToKey(O),ut=this._tiles[R];return ut&&ut.active?(ut.retain=!0,!0):(ut&&ut.loaded&&(ut.retain=!0),P>d?this._retainParent(_,v,P,d):!1)},_retainChildren:function(t,s,h,d){for(var _=2*t;_<2*t+2;_++)for(var v=2*s;v<2*s+2;v++){var P=new Z(_,v);P.z=h+1;var O=this._tileCoordsToKey(P),R=this._tiles[O];if(R&&R.active){R.retain=!0;continue}else R&&R.loaded&&(R.retain=!0);h+1<d&&this._retainChildren(_,v,h+1,d)}},_resetView:function(t){var s=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),s,s)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var s=this.options;return s.minNativeZoom!==void 0&&t<s.minNativeZoom?s.minNativeZoom:s.maxNativeZoom!==void 0&&s.maxNativeZoom<t?s.maxNativeZoom:t},_setView:function(t,s,h,d){var _=Math.round(s);this.options.maxZoom!==void 0&&_>this.options.maxZoom||this.options.minZoom!==void 0&&_<this.options.minZoom?_=void 0:_=this._clampZoom(_);var v=this.options.updateWhenZooming&&_!==this._tileZoom;(!d||v)&&(this._tileZoom=_,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),_!==void 0&&this._update(t),h||this._pruneTiles(),this._noPrune=!!h),this._setZoomTransforms(t,s)},_setZoomTransforms:function(t,s){for(var h in this._levels)this._setZoomTransform(this._levels[h],t,s)},_setZoomTransform:function(t,s,h){var d=this._map.getZoomScale(h,t.zoom),_=t.origin.multiplyBy(d).subtract(this._map._getNewPixelOrigin(s,h)).round();Pt.any3d?Ii(t.el,_,d):Ue(t.el,_)},_resetGrid:function(){var t=this._map,s=t.options.crs,h=this._tileSize=this.getTileSize(),d=this._tileZoom,_=this._map.getPixelWorldBounds(this._tileZoom);_&&(this._globalTileRange=this._pxBoundsToTileRange(_)),this._wrapX=s.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,s.wrapLng[0]],d).x/h.x),Math.ceil(t.project([0,s.wrapLng[1]],d).x/h.y)],this._wrapY=s.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([s.wrapLat[0],0],d).y/h.x),Math.ceil(t.project([s.wrapLat[1],0],d).y/h.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var s=this._map,h=s._animatingZoom?Math.max(s._animateToZoom,s.getZoom()):s.getZoom(),d=s.getZoomScale(h,this._tileZoom),_=s.project(t,this._tileZoom).floor(),v=s.getSize().divideBy(d*2);return new Mt(_.subtract(v),_.add(v))},_update:function(t){var s=this._map;if(s){var h=this._clampZoom(s.getZoom());if(t===void 0&&(t=s.getCenter()),this._tileZoom!==void 0){var d=this._getTiledPixelBounds(t),_=this._pxBoundsToTileRange(d),v=_.getCenter(),P=[],O=this.options.keepBuffer,R=new Mt(_.getBottomLeft().subtract([O,-O]),_.getTopRight().add([O,-O]));if(!(isFinite(_.min.x)&&isFinite(_.min.y)&&isFinite(_.max.x)&&isFinite(_.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ut in this._tiles){var Tt=this._tiles[ut].coords;(Tt.z!==this._tileZoom||!R.contains(new Z(Tt.x,Tt.y)))&&(this._tiles[ut].current=!1)}if(Math.abs(h-this._tileZoom)>1){this._setView(t,h);return}for(var Ut=_.min.y;Ut<=_.max.y;Ut++)for(var re=_.min.x;re<=_.max.x;re++){var Ni=new Z(re,Ut);if(Ni.z=this._tileZoom,!!this._isValidTile(Ni)){var Ti=this._tiles[this._tileCoordsToKey(Ni)];Ti?Ti.current=!0:P.push(Ni)}}if(P.sort(function(Wi,Nn){return Wi.distanceTo(v)-Nn.distanceTo(v)}),P.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var tn=document.createDocumentFragment();for(re=0;re<P.length;re++)this._addTile(P[re],tn);this._level.el.appendChild(tn)}}}},_isValidTile:function(t){var s=this._map.options.crs;if(!s.infinite){var h=this._globalTileRange;if(!s.wrapLng&&(t.x<h.min.x||t.x>h.max.x)||!s.wrapLat&&(t.y<h.min.y||t.y>h.max.y))return!1}if(!this.options.bounds)return!0;var d=this._tileCoordsToBounds(t);return H(this.options.bounds).overlaps(d)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var s=this._map,h=this.getTileSize(),d=t.scaleBy(h),_=d.add(h),v=s.unproject(d,t.z),P=s.unproject(_,t.z);return[v,P]},_tileCoordsToBounds:function(t){var s=this._tileCoordsToNwSe(t),h=new wt(s[0],s[1]);return this.options.noWrap||(h=this._map.wrapLatLngBounds(h)),h},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var s=t.split(":"),h=new Z(+s[0],+s[1]);return h.z=+s[2],h},_removeTile:function(t){var s=this._tiles[t];s&&(se(s.el),delete this._tiles[t],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){Rt(t,"leaflet-tile");var s=this.getTileSize();t.style.width=s.x+"px",t.style.height=s.y+"px",t.onselectstart=g,t.onmousemove=g,Pt.ielt9&&this.options.opacity<1&&ai(t,this.options.opacity)},_addTile:function(t,s){var h=this._getTilePos(t),d=this._tileCoordsToKey(t),_=this.createTile(this._wrapCoords(t),l(this._tileReady,this,t));this._initTile(_),this.createTile.length<2&&ct(l(this._tileReady,this,t,null,_)),Ue(_,h),this._tiles[d]={el:_,coords:t,current:!0},s.appendChild(_),this.fire("tileloadstart",{tile:_,coords:t})},_tileReady:function(t,s,h){s&&this.fire("tileerror",{error:s,tile:h,coords:t});var d=this._tileCoordsToKey(t);h=this._tiles[d],h&&(h.loaded=+new Date,this._map._fadeAnimated?(ai(h.el,0),N(this._fadeFrame),this._fadeFrame=ct(this._updateOpacity,this)):(h.active=!0,this._pruneTiles()),s||(Rt(h.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:h.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Pt.ielt9||!this._map._fadeAnimated?ct(this._pruneTiles,this):setTimeout(l(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var s=new Z(this._wrapX?p(t.x,this._wrapX):t.x,this._wrapY?p(t.y,this._wrapY):t.y);return s.z=t.z,s},_pxBoundsToTileRange:function(t){var s=this.getTileSize();return new Mt(t.min.unscaleBy(s).floor(),t.max.unscaleBy(s).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Xl(t){return new Yn(t)}var xn=Yn.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,s){this._url=t,s=C(this,s),s.detectRetina&&Pt.retina&&s.maxZoom>0?(s.tileSize=Math.floor(s.tileSize/2),s.zoomReverse?(s.zoomOffset--,s.minZoom=Math.min(s.maxZoom,s.minZoom+1)):(s.zoomOffset++,s.maxZoom=Math.max(s.minZoom,s.maxZoom-1)),s.minZoom=Math.max(0,s.minZoom)):s.zoomReverse?s.minZoom=Math.min(s.maxZoom,s.minZoom):s.maxZoom=Math.max(s.minZoom,s.maxZoom),typeof s.subdomains=="string"&&(s.subdomains=s.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,s){return this._url===t&&s===void 0&&(s=!0),this._url=t,s||this.redraw(),this},createTile:function(t,s){var h=document.createElement("img");return vt(h,"load",l(this._tileOnLoad,this,s,h)),vt(h,"error",l(this._tileOnError,this,s,h)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(h.referrerPolicy=this.options.referrerPolicy),h.alt="",h.src=this.getTileUrl(t),h},getTileUrl:function(t){var s={r:Pt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var h=this._globalTileRange.max.y-t.y;this.options.tms&&(s.y=h),s["-y"]=h}return T(this._url,i(s,this.options))},_tileOnLoad:function(t,s){Pt.ielt9?setTimeout(l(t,this,null,s),0):t(null,s)},_tileOnError:function(t,s,h){var d=this.options.errorTileUrl;d&&s.getAttribute("src")!==d&&(s.src=d),t(h,s)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,s=this.options.maxZoom,h=this.options.zoomReverse,d=this.options.zoomOffset;return h&&(t=s-t),t+d},_getSubdomain:function(t){var s=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[s]},_abortLoading:function(){var t,s;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(s=this._tiles[t].el,s.onload=g,s.onerror=g,!s.complete)){s.src=F;var h=this._tiles[t].coords;se(s),delete this._tiles[t],this.fire("tileabort",{tile:s,coords:h})}},_removeTile:function(t){var s=this._tiles[t];if(s)return s.el.setAttribute("src",F),Yn.prototype._removeTile.call(this,t)},_tileReady:function(t,s,h){if(!(!this._map||h&&h.getAttribute("src")===F))return Yn.prototype._tileReady.call(this,t,s,h)}});function Ds(t,s){return new xn(t,s)}var zs=xn.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,s){this._url=t;var h=i({},this.defaultWmsParams);for(var d in s)d in this.options||(h[d]=s[d]);s=C(this,s);var _=s.detectRetina&&Pt.retina?2:1,v=this.getTileSize();h.width=v.x*_,h.height=v.y*_,this.wmsParams=h},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var s=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[s]=this._crs.code,xn.prototype.onAdd.call(this,t)},getTileUrl:function(t){var s=this._tileCoordsToNwSe(t),h=this._crs,d=Ct(h.project(s[0]),h.project(s[1])),_=d.min,v=d.max,P=(this._wmsVersion>=1.3&&this._crs===ks?[_.y,_.x,v.y,v.x]:[_.x,_.y,v.x,v.y]).join(","),O=xn.prototype.getTileUrl.call(this,t);return O+D(this.wmsParams,O,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+P},setParams:function(t,s){return i(this.wmsParams,t),s||this.redraw(),this}});function ql(t,s){return new zs(t,s)}xn.WMS=zs,Ds.wms=ql;var gn=ln.extend({options:{padding:.1},initialize:function(t){C(this,t),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Rt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,s){var h=this._map.getZoomScale(s,this._zoom),d=this._map.getSize().multiplyBy(.5+this.options.padding),_=this._map.project(this._center,s),v=d.multiplyBy(-h).add(_).subtract(this._map._getNewPixelOrigin(t,s));Pt.any3d?Ii(this._container,v,h):Ue(this._container,v)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,s=this._map.getSize(),h=this._map.containerPointToLayerPoint(s.multiplyBy(-t)).round();this._bounds=new Mt(h,h.add(s.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Os=gn.extend({options:{tolerance:0},getEvents:function(){var t=gn.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){gn.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");vt(t,"mousemove",this._onMouseMove,this),vt(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),vt(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){N(this._redrawRequest),delete this._ctx,se(this._container),jt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var s in this._layers)t=this._layers[s],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){gn.prototype._update.call(this);var t=this._bounds,s=this._container,h=t.getSize(),d=Pt.retina?2:1;Ue(s,t.min),s.width=d*h.x,s.height=d*h.y,s.style.width=h.x+"px",s.style.height=h.y+"px",Pt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){gn.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[u(t)]=t;var s=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=s),this._drawLast=s,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var s=t._order,h=s.next,d=s.prev;h?h.prev=d:this._drawLast=d,d?d.next=h:this._drawFirst=h,delete t._order,delete this._layers[u(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var s=t.options.dashArray.split(/[, ]+/),h=[],d,_;for(_=0;_<s.length;_++){if(d=Number(s[_]),isNaN(d))return;h.push(d)}t.options._dashArray=h}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||ct(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var s=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Mt,this._redrawBounds.extend(t._pxBounds.min.subtract([s,s])),this._redrawBounds.extend(t._pxBounds.max.add([s,s]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var s=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,s.x,s.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,s=this._redrawBounds;if(this._ctx.save(),s){var h=s.getSize();this._ctx.beginPath(),this._ctx.rect(s.min.x,s.min.y,h.x,h.y),this._ctx.clip()}this._drawing=!0;for(var d=this._drawFirst;d;d=d.next)t=d.layer,(!s||t._pxBounds&&t._pxBounds.intersects(s))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,s){if(this._drawing){var h,d,_,v,P=t._parts,O=P.length,R=this._ctx;if(O){for(R.beginPath(),h=0;h<O;h++){for(d=0,_=P[h].length;d<_;d++)v=P[h][d],R[d?"lineTo":"moveTo"](v.x,v.y);s&&R.closePath()}this._fillStroke(R,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var s=t._point,h=this._ctx,d=Math.max(Math.round(t._radius),1),_=(Math.max(Math.round(t._radiusY),1)||d)/d;_!==1&&(h.save(),h.scale(1,_)),h.beginPath(),h.arc(s.x,s.y/_,d,0,Math.PI*2,!1),_!==1&&h.restore(),this._fillStroke(h,t)}},_fillStroke:function(t,s){var h=s.options;h.fill&&(t.globalAlpha=h.fillOpacity,t.fillStyle=h.fillColor||h.color,t.fill(h.fillRule||"evenodd")),h.stroke&&h.weight!==0&&(t.setLineDash&&t.setLineDash(s.options&&s.options._dashArray||[]),t.globalAlpha=h.opacity,t.lineWidth=h.weight,t.strokeStyle=h.color,t.lineCap=h.lineCap,t.lineJoin=h.lineJoin,t.stroke())},_onClick:function(t){for(var s=this._map.mouseEventToLayerPoint(t),h,d,_=this._drawFirst;_;_=_.next)h=_.layer,h.options.interactive&&h._containsPoint(s)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(h))&&(d=h);this._fireEvent(d?[d]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var s=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,s)}},_handleMouseOut:function(t){var s=this._hoveredLayer;s&&(xe(this._container,"leaflet-interactive"),this._fireEvent([s],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,s){if(!this._mouseHoverThrottled){for(var h,d,_=this._drawFirst;_;_=_.next)h=_.layer,h.options.interactive&&h._containsPoint(s)&&(d=h);d!==this._hoveredLayer&&(this._handleMouseOut(t),d&&(Rt(this._container,"leaflet-interactive"),this._fireEvent([d],t,"mouseover"),this._hoveredLayer=d)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(l(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,s,h){this._map._fireDOMEvent(s,h||s.type,t)},_bringToFront:function(t){var s=t._order;if(s){var h=s.next,d=s.prev;if(h)h.prev=d;else return;d?d.next=h:h&&(this._drawFirst=h),s.prev=this._drawLast,this._drawLast.next=s,s.next=null,this._drawLast=s,this._requestRedraw(t)}},_bringToBack:function(t){var s=t._order;if(s){var h=s.next,d=s.prev;if(d)d.next=h;else return;h?h.prev=d:d&&(this._drawLast=d),s.prev=null,s.next=this._drawFirst,this._drawFirst.prev=s,this._drawFirst=s,this._requestRedraw(t)}}});function Is(t){return Pt.canvas?new Os(t):null}var Xn=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Kl={_initContainer:function(){this._container=Bt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(gn.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var s=t._container=Xn("shape");Rt(s,"leaflet-vml-shape "+(this.options.className||"")),s.coordsize="1 1",t._path=Xn("path"),s.appendChild(t._path),this._updateStyle(t),this._layers[u(t)]=t},_addPath:function(t){var s=t._container;this._container.appendChild(s),t.options.interactive&&t.addInteractiveTarget(s)},_removePath:function(t){var s=t._container;se(s),t.removeInteractiveTarget(s),delete this._layers[u(t)]},_updateStyle:function(t){var s=t._stroke,h=t._fill,d=t.options,_=t._container;_.stroked=!!d.stroke,_.filled=!!d.fill,d.stroke?(s||(s=t._stroke=Xn("stroke")),_.appendChild(s),s.weight=d.weight+"px",s.color=d.color,s.opacity=d.opacity,d.dashArray?s.dashStyle=x(d.dashArray)?d.dashArray.join(" "):d.dashArray.replace(/( *, *)/g," "):s.dashStyle="",s.endcap=d.lineCap.replace("butt","flat"),s.joinstyle=d.lineJoin):s&&(_.removeChild(s),t._stroke=null),d.fill?(h||(h=t._fill=Xn("fill")),_.appendChild(h),h.color=d.fillColor||d.color,h.opacity=d.fillOpacity):h&&(_.removeChild(h),t._fill=null)},_updateCircle:function(t){var s=t._point.round(),h=Math.round(t._radius),d=Math.round(t._radiusY||h);this._setPath(t,t._empty()?"M0 0":"AL "+s.x+","+s.y+" "+h+","+d+" 0,"+65535*360)},_setPath:function(t,s){t._path.v=s},_bringToFront:function(t){ri(t._container)},_bringToBack:function(t){Ge(t._container)}},go=Pt.vml?Xn:ue,qn=gn.extend({_initContainer:function(){this._container=go("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=go("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){se(this._container),jt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){gn.prototype._update.call(this);var t=this._bounds,s=t.getSize(),h=this._container;(!this._svgSize||!this._svgSize.equals(s))&&(this._svgSize=s,h.setAttribute("width",s.x),h.setAttribute("height",s.y)),Ue(h,t.min),h.setAttribute("viewBox",[t.min.x,t.min.y,s.x,s.y].join(" ")),this.fire("update")}},_initPath:function(t){var s=t._path=go("path");t.options.className&&Rt(s,t.options.className),t.options.interactive&&Rt(s,"leaflet-interactive"),this._updateStyle(t),this._layers[u(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){se(t._path),t.removeInteractiveTarget(t._path),delete this._layers[u(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var s=t._path,h=t.options;s&&(h.stroke?(s.setAttribute("stroke",h.color),s.setAttribute("stroke-opacity",h.opacity),s.setAttribute("stroke-width",h.weight),s.setAttribute("stroke-linecap",h.lineCap),s.setAttribute("stroke-linejoin",h.lineJoin),h.dashArray?s.setAttribute("stroke-dasharray",h.dashArray):s.removeAttribute("stroke-dasharray"),h.dashOffset?s.setAttribute("stroke-dashoffset",h.dashOffset):s.removeAttribute("stroke-dashoffset")):s.setAttribute("stroke","none"),h.fill?(s.setAttribute("fill",h.fillColor||h.color),s.setAttribute("fill-opacity",h.fillOpacity),s.setAttribute("fill-rule",h.fillRule||"evenodd")):s.setAttribute("fill","none"))},_updatePoly:function(t,s){this._setPath(t,pe(t._parts,s))},_updateCircle:function(t){var s=t._point,h=Math.max(Math.round(t._radius),1),d=Math.max(Math.round(t._radiusY),1)||h,_="a"+h+","+d+" 0 1,0 ",v=t._empty()?"M0 0":"M"+(s.x-h)+","+s.y+_+h*2+",0 "+_+-h*2+",0 ";this._setPath(t,v)},_setPath:function(t,s){t._path.setAttribute("d",s)},_bringToFront:function(t){ri(t._path)},_bringToBack:function(t){Ge(t._path)}});Pt.vml&&qn.include(Kl);function As(t){return Pt.svg||Pt.vml?new qn(t):null}ge.include({getRenderer:function(t){var s=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return s||(s=this._renderer=this._createRenderer()),this.hasLayer(s)||this.addLayer(s),s},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var s=this._paneRenderers[t];return s===void 0&&(s=this._createRenderer({pane:t}),this._paneRenderers[t]=s),s},_createRenderer:function(t){return this.options.preferCanvas&&Is(t)||As(t)}});var xs=In.extend({initialize:function(t,s){In.prototype.initialize.call(this,this._boundsToLatLngs(t),s)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=H(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function Jl(t,s){return new xs(t,s)}qn.create=go,qn.pointsToPath=pe,mn.geometryToLayer=ho,mn.coordsToLatLng=Ro,mn.coordsToLatLngs=co,mn.latLngToCoords=Zo,mn.latLngsToCoords=uo,mn.getFeature=An,mn.asFeature=fo,ge.mergeOptions({boxZoom:!0});var Ns=cn.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){vt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){jt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){se(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Gi(),hn(),this._startPoint=this._map.mouseEventToContainerPoint(t),vt(document,{contextmenu:Mn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=Bt("div","leaflet-zoom-box",this._container),Rt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var s=new Mt(this._point,this._startPoint),h=s.getSize();Ue(this._box,s.min),this._box.style.width=h.x+"px",this._box.style.height=h.y+"px"},_finish:function(){this._moved&&(se(this._box),xe(this._container,"leaflet-crosshair")),bi(),Ai(),jt(document,{contextmenu:Mn,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(l(this._resetState,this),0);var s=new wt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(s).fire("boxzoomend",{boxZoomBounds:s})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});ge.addInitHook("addHandler","boxZoom",Ns),ge.mergeOptions({doubleClickZoom:!0});var Bs=cn.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var s=this._map,h=s.getZoom(),d=s.options.zoomDelta,_=t.originalEvent.shiftKey?h-d:h+d;s.options.doubleClickZoom==="center"?s.setZoom(_):s.setZoomAround(t.containerPoint,_)}});ge.addInitHook("addHandler","doubleClickZoom",Bs),ge.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Rs=cn.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new bn(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}Rt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){xe(this._map._container,"leaflet-grab"),xe(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var s=H(this._map.options.maxBounds);this._offsetLimit=Ct(this._map.latLngToContainerPoint(s.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(s.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var s=this._lastTime=+new Date,h=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(h),this._times.push(s),this._prunePositions(s)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),s=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=s.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,s){return t-(t-s)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),s=this._offsetLimit;t.x<s.min.x&&(t.x=this._viscousLimit(t.x,s.min.x)),t.y<s.min.y&&(t.y=this._viscousLimit(t.y,s.min.y)),t.x>s.max.x&&(t.x=this._viscousLimit(t.x,s.max.x)),t.y>s.max.y&&(t.y=this._viscousLimit(t.y,s.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,s=Math.round(t/2),h=this._initialWorldOffset,d=this._draggable._newPos.x,_=(d-s+h)%t+s-h,v=(d+s+h)%t-s-h,P=Math.abs(_+h)<Math.abs(v+h)?_:v;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=P},_onDragEnd:function(t){var s=this._map,h=s.options,d=!h.inertia||t.noInertia||this._times.length<2;if(s.fire("dragend",t),d)s.fire("moveend");else{this._prunePositions(+new Date);var _=this._lastPos.subtract(this._positions[0]),v=(this._lastTime-this._times[0])/1e3,P=h.easeLinearity,O=_.multiplyBy(P/v),R=O.distanceTo([0,0]),ut=Math.min(h.inertiaMaxSpeed,R),Tt=O.multiplyBy(ut/R),Ut=ut/(h.inertiaDeceleration*P),re=Tt.multiplyBy(-Ut/2).round();!re.x&&!re.y?s.fire("moveend"):(re=s._limitOffset(re,s.options.maxBounds),ct(function(){s.panBy(re,{duration:Ut,easeLinearity:P,noMoveStart:!0,animate:!0})}))}}});ge.addInitHook("addHandler","dragging",Rs),ge.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Zs=cn.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),vt(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),jt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,s=document.documentElement,h=t.scrollTop||s.scrollTop,d=t.scrollLeft||s.scrollLeft;this._map._container.focus(),window.scrollTo(d,h)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var s=this._panKeys={},h=this.keyCodes,d,_;for(d=0,_=h.left.length;d<_;d++)s[h.left[d]]=[-1*t,0];for(d=0,_=h.right.length;d<_;d++)s[h.right[d]]=[t,0];for(d=0,_=h.down.length;d<_;d++)s[h.down[d]]=[0,t];for(d=0,_=h.up.length;d<_;d++)s[h.up[d]]=[0,-1*t]},_setZoomDelta:function(t){var s=this._zoomKeys={},h=this.keyCodes,d,_;for(d=0,_=h.zoomIn.length;d<_;d++)s[h.zoomIn[d]]=t;for(d=0,_=h.zoomOut.length;d<_;d++)s[h.zoomOut[d]]=-t},_addHooks:function(){vt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){jt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var s=t.keyCode,h=this._map,d;if(s in this._panKeys){if(!h._panAnim||!h._panAnim._inProgress)if(d=this._panKeys[s],t.shiftKey&&(d=at(d).multiplyBy(3)),h.options.maxBounds&&(d=h._limitOffset(at(d),h.options.maxBounds)),h.options.worldCopyJump){var _=h.wrapLatLng(h.unproject(h.project(h.getCenter()).add(d)));h.panTo(_)}else h.panBy(d)}else if(s in this._zoomKeys)h.setZoom(h.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[s]);else if(s===27&&h._popup&&h._popup.options.closeOnEscapeKey)h.closePopup();else return;Mn(t)}}});ge.addInitHook("addHandler","keyboard",Zs),ge.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Hs=cn.extend({addHooks:function(){vt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){jt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var s=cs(t),h=this._map.options.wheelDebounceTime;this._delta+=s,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var d=Math.max(h-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(l(this._performZoom,this),d),Mn(t)},_performZoom:function(){var t=this._map,s=t.getZoom(),h=this._map.options.zoomSnap||0;t._stop();var d=this._delta/(this._map.options.wheelPxPerZoomLevel*4),_=4*Math.log(2/(1+Math.exp(-Math.abs(d))))/Math.LN2,v=h?Math.ceil(_/h)*h:_,P=t._limitZoom(s+(this._delta>0?v:-v))-s;this._delta=0,this._startTime=null,P&&(t.options.scrollWheelZoom==="center"?t.setZoom(s+P):t.setZoomAround(this._lastMousePos,s+P))}});ge.addInitHook("addHandler","scrollWheelZoom",Hs);var Ql=600;ge.mergeOptions({tapHold:Pt.touchNative&&Pt.safari&&Pt.mobile,tapTolerance:15});var js=cn.extend({addHooks:function(){vt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){jt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var s=t.touches[0];this._startPos=this._newPos=new Z(s.clientX,s.clientY),this._holdTimeout=setTimeout(l(function(){this._cancel(),this._isTapValid()&&(vt(document,"touchend",zi),vt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",s))},this),Ql),vt(document,"touchend touchcancel contextmenu",this._cancel,this),vt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){jt(document,"touchend",zi),jt(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),jt(document,"touchend touchcancel contextmenu",this._cancel,this),jt(document,"touchmove",this._onMove,this)},_onMove:function(t){var s=t.touches[0];this._newPos=new Z(s.clientX,s.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,s){var h=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:s.screenX,screenY:s.screenY,clientX:s.clientX,clientY:s.clientY});h._simulated=!0,s.target.dispatchEvent(h)}});ge.addInitHook("addHandler","tapHold",js),ge.mergeOptions({touchZoom:Pt.touch,bounceAtZoomLimits:!0});var Fs=cn.extend({addHooks:function(){Rt(this._map._container,"leaflet-touch-zoom"),vt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){xe(this._map._container,"leaflet-touch-zoom"),jt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var s=this._map;if(!(!t.touches||t.touches.length!==2||s._animatingZoom||this._zooming)){var h=s.mouseEventToContainerPoint(t.touches[0]),d=s.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=s.getSize()._divideBy(2),this._startLatLng=s.containerPointToLatLng(this._centerPoint),s.options.touchZoom!=="center"&&(this._pinchStartLatLng=s.containerPointToLatLng(h.add(d)._divideBy(2))),this._startDist=h.distanceTo(d),this._startZoom=s.getZoom(),this._moved=!1,this._zooming=!0,s._stop(),vt(document,"touchmove",this._onTouchMove,this),vt(document,"touchend touchcancel",this._onTouchEnd,this),zi(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var s=this._map,h=s.mouseEventToContainerPoint(t.touches[0]),d=s.mouseEventToContainerPoint(t.touches[1]),_=h.distanceTo(d)/this._startDist;if(this._zoom=s.getScaleZoom(_,this._startZoom),!s.options.bounceAtZoomLimits&&(this._zoom<s.getMinZoom()&&_<1||this._zoom>s.getMaxZoom()&&_>1)&&(this._zoom=s._limitZoom(this._zoom)),s.options.touchZoom==="center"){if(this._center=this._startLatLng,_===1)return}else{var v=h._add(d)._divideBy(2)._subtract(this._centerPoint);if(_===1&&v.x===0&&v.y===0)return;this._center=s.unproject(s.project(this._pinchStartLatLng,this._zoom).subtract(v),this._zoom)}this._moved||(s._moveStart(!0,!1),this._moved=!0),N(this._animRequest);var P=l(s._move,s,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ct(P,this,!0),zi(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,N(this._animRequest),jt(document,"touchmove",this._onTouchMove,this),jt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});ge.addInitHook("addHandler","touchZoom",Fs),ge.BoxZoom=Ns,ge.DoubleClickZoom=Bs,ge.Drag=Rs,ge.Keyboard=Zs,ge.ScrollWheelZoom=Hs,ge.TapHold=js,ge.TouchZoom=Fs,o.Bounds=Mt,o.Browser=Pt,o.CRS=I,o.Canvas=Os,o.Circle=Bo,o.CircleMarker=lo,o.Class=V,o.Control=an,o.DivIcon=Ss,o.DivOverlay=un,o.DomEvent=ml,o.DomUtil=gt,o.Draggable=bn,o.Evented=U,o.FeatureGroup=_n,o.GeoJSON=mn,o.GridLayer=Yn,o.Handler=cn,o.Icon=On,o.ImageOverlay=_o,o.LatLng=q,o.LatLngBounds=wt,o.Layer=ln,o.LayerGroup=zn,o.LineUtil=Sl,o.Map=ge,o.Marker=ao,o.Mixin=kl,o.Path=wn,o.Point=Z,o.PolyUtil=Ml,o.Polygon=In,o.Polyline=pn,o.Popup=po,o.PosAnimation=us,o.Projection=Dl,o.Rectangle=xs,o.Renderer=gn,o.SVG=qn,o.SVGOverlay=Ts,o.TileLayer=xn,o.Tooltip=mo,o.Transformation=Dt,o.Util=lt,o.VideoOverlay=Cs,o.bind=l,o.bounds=Ct,o.canvas=Is,o.circle=Rl,o.circleMarker=Bl,o.control=Un,o.divIcon=Yl,o.extend=i,o.featureGroup=Al,o.geoJSON=Es,o.geoJson=jl,o.gridLayer=Xl,o.icon=xl,o.imageOverlay=Fl,o.latLng=X,o.latLngBounds=H,o.layerGroup=Il,o.map=gl,o.marker=Nl,o.point=at,o.polygon=Hl,o.polyline=Zl,o.popup=Wl,o.rectangle=Jl,o.setOptions=C,o.stamp=u,o.svg=As,o.svgOverlay=Ul,o.tileLayer=Ds,o.tooltip=Vl,o.transformation=zt,o.version=a,o.videoOverlay=Gl;var $l=window.L;o.noConflict=function(){return window.L=$l,this},window.L=o})})(os,os.exports);var Bi=os.exports;(function(n,e,o){function a(i,r){for(;(i=i.parentElement)&&!i.classList.contains(r););return i}L.drawVersion="1.0.4",L.Draw={},L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},finish:{title:"Finish drawing",text:"Finish"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker",circlemarker:"Draw a circlemarker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."},radius:"Radius"},circlemarker:{tooltip:{start:"Click map to place circle marker."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes",text:"Save"},cancel:{title:"Cancel editing, discards all changes",text:"Cancel"},clearAll:{title:"Clear all layers",text:"Clear All"}},buttons:{edit:"Edit layers",editDisabled:"No layers to edit",remove:"Delete layers",removeDisabled:"No layers to delete"}},handlers:{edit:{tooltip:{text:"Drag handles or markers to edit features.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove."}}}}},L.Draw.Event={},L.Draw.Event.CREATED="draw:created",L.Draw.Event.EDITED="draw:edited",L.Draw.Event.DELETED="draw:deleted",L.Draw.Event.DRAWSTART="draw:drawstart",L.Draw.Event.DRAWSTOP="draw:drawstop",L.Draw.Event.DRAWVERTEX="draw:drawvertex",L.Draw.Event.EDITSTART="draw:editstart",L.Draw.Event.EDITMOVE="draw:editmove",L.Draw.Event.EDITRESIZE="draw:editresize",L.Draw.Event.EDITVERTEX="draw:editvertex",L.Draw.Event.EDITSTOP="draw:editstop",L.Draw.Event.DELETESTART="draw:deletestart",L.Draw.Event.DELETESTOP="draw:deletestop",L.Draw.Event.TOOLBAROPENED="draw:toolbaropened",L.Draw.Event.TOOLBARCLOSED="draw:toolbarclosed",L.Draw.Event.MARKERCONTEXT="draw:markercontext",L.Draw=L.Draw||{},L.Draw.Feature=L.Handler.extend({initialize:function(i,r){this._map=i,this._container=i._container,this._overlayPane=i._panes.overlayPane,this._popupPane=i._panes.popupPane,r&&r.shapeOptions&&(r.shapeOptions=L.Util.extend({},this.options.shapeOptions,r.shapeOptions)),L.setOptions(this,r);var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.Draw.Feature.include(L.Evented.prototype):L.Draw.Feature.include(L.Mixin.Events)},enable:function(){this._enabled||(L.Handler.prototype.enable.call(this),this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DRAWSTART,{layerType:this.type}))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DRAWSTOP,{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(L.DomUtil.disableTextSelection(),i.getContainer().focus(),this._tooltip=new L.Draw.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(i){L.setOptions(this,i)},_fireCreatedEvent:function(i){this._map.fire(L.Draw.Event.CREATED,{layer:i,layerType:this.type})},_cancelDrawing:function(i){i.keyCode===27&&(this._map.fire("draw:canceled",{layerType:this.type}),this.disable())}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,feet:!0,nautic:!1,showLength:!0,zIndexOffset:2e3,factor:1,maxPoints:0},initialize:function(i,r){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,r&&r.drawError&&(r.drawError=L.Util.extend({},this.options.drawError,r.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,i,r)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mouseout",this._onMouseOut,this).on("mousemove",this._onMouseMove,this).on("mousedown",this._onMouseDown,this).on("mouseup",this._onMouseUp,this).addTo(this._map),this._map.on("mouseup",this._onMouseUp,this).on("mousemove",this._onMouseMove,this).on("zoomlevelschange",this._onZoomEnd,this).on("touchstart",this._onTouch,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseout",this._onMouseOut,this).off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mouseup",this._onMouseUp,this).off("mousemove",this._onMouseMove,this).off("zoomlevelschange",this._onZoomEnd,this).off("zoomend",this._onZoomEnd,this).off("touchstart",this._onTouch,this).off("click",this._onTouch,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var i=this._markers.pop(),r=this._poly,l=r.getLatLngs(),c=l.splice(-1,1)[0];this._poly.setLatLngs(l),this._markerGroup.removeLayer(i),r.getLatLngs().length<2&&this._map.removeLayer(r),this._vertexChanged(c,!1)}},addVertex:function(i){if(this._markers.length>=2&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(i))return void this._showErrorTooltip();this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(i)),this._poly.addLatLng(i),this._poly.getLatLngs().length===2&&this._map.addLayer(this._poly),this._vertexChanged(i,!0)},completeShape:function(){this._markers.length<=1||!this._shapeIsValid()||(this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable())},_finishShape:function(){var i=this._poly._defaultShape?this._poly._defaultShape():this._poly.getLatLngs(),r=this._poly.newLatLngIntersects(i[i.length-1]);if(!this.options.allowIntersection&&r||!this._shapeIsValid())return void this._showErrorTooltip();this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._markers!==null&&this._updateGuide()},_onMouseMove:function(i){var r=this._map.mouseEventToLayerPoint(i.originalEvent),l=this._map.layerPointToLatLng(r);this._currentLatLng=l,this._updateTooltip(l),this._updateGuide(r),this._mouseMarker.setLatLng(l),L.DomEvent.preventDefault(i.originalEvent)},_vertexChanged:function(i,r){this._map.fire(L.Draw.Event.DRAWVERTEX,{layers:this._markerGroup}),this._updateFinishHandler(),this._updateRunningMeasure(i,r),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(i){if(!this._clickHandled&&!this._touchHandled&&!this._disableMarkers){this._onMouseMove(i),this._clickHandled=!0,this._disableNewMarkers();var r=i.originalEvent,l=r.clientX,c=r.clientY;this._startPoint.call(this,l,c)}},_startPoint:function(i,r){this._mouseDownOrigin=L.point(i,r)},_onMouseUp:function(i){var r=i.originalEvent,l=r.clientX,c=r.clientY;this._endPoint.call(this,l,c,i),this._clickHandled=null},_endPoint:function(i,r,l){if(this._mouseDownOrigin){var c=L.point(i,r).distanceTo(this._mouseDownOrigin),u=this._calculateFinishDistance(l.latlng);this.options.maxPoints>1&&this.options.maxPoints==this._markers.length+1?(this.addVertex(l.latlng),this._finishShape()):u<10&&L.Browser.touch?this._finishShape():Math.abs(c)<9*(n.devicePixelRatio||1)&&this.addVertex(l.latlng),this._enableNewMarkers()}this._mouseDownOrigin=null},_onTouch:function(i){var r,l,c=i.originalEvent;!c.touches||!c.touches[0]||this._clickHandled||this._touchHandled||this._disableMarkers||(r=c.touches[0].clientX,l=c.touches[0].clientY,this._disableNewMarkers(),this._touchHandled=!0,this._startPoint.call(this,r,l),this._endPoint.call(this,r,l,i),this._touchHandled=null),this._clickHandled=null},_onMouseOut:function(){this._tooltip&&this._tooltip._onMouseOut.call(this._tooltip)},_calculateFinishDistance:function(i){var r;if(this._markers.length>0){var l;if(this.type===L.Draw.Polyline.TYPE)l=this._markers[this._markers.length-1];else{if(this.type!==L.Draw.Polygon.TYPE)return 1/0;l=this._markers[0]}var c=this._map.latLngToContainerPoint(l.getLatLng()),u=new L.Marker(i,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset}),f=this._map.latLngToContainerPoint(u.getLatLng());r=c.distanceTo(f)}else r=1/0;return r},_updateFinishHandler:function(){var i=this._markers.length;i>1&&this._markers[i-1].on("click",this._finishShape,this),i>2&&this._markers[i-2].off("click",this._finishShape,this)},_createMarker:function(i){var r=new L.Marker(i,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(r),r},_updateGuide:function(i){var r=this._markers?this._markers.length:0;r>0&&(i=i||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[r-1].getLatLng()),i))},_updateTooltip:function(i){var r=this._getTooltipText();i&&this._tooltip.updatePosition(i),this._errorShown||this._tooltip.updateContent(r)},_drawGuide:function(i,r){var l,c,u,f=Math.floor(Math.sqrt(Math.pow(r.x-i.x,2)+Math.pow(r.y-i.y,2))),p=this.options.guidelineDistance,g=this.options.maxGuideLineLength,y=f>g?f-g:p;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));y<f;y+=this.options.guidelineDistance)l=y/f,c={x:Math.floor(i.x*(1-l)+l*r.x),y:Math.floor(i.y*(1-l)+l*r.y)},u=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),u.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(u,c)},_updateGuideColor:function(i){if(this._guidesContainer)for(var r=0,l=this._guidesContainer.childNodes.length;r<l;r++)this._guidesContainer.childNodes[r].style.backgroundColor=i},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var i,r,l=this.options.showLength;return this._markers.length===0?i={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(r=l?this._getMeasurementString():"",i=this._markers.length===1?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:r}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:r}),i},_updateRunningMeasure:function(i,r){var l,c,u=this._markers.length;this._markers.length===1?this._measurementRunningTotal=0:(l=u-(r?2:1),c=L.GeometryUtil.isVersion07x()?i.distanceTo(this._markers[l].getLatLng())*(this.options.factor||1):this._map.distance(i,this._markers[l].getLatLng())*(this.options.factor||1),this._measurementRunningTotal+=c*(r?1:-1))},_getMeasurementString:function(){var i,r=this._currentLatLng,l=this._markers[this._markers.length-1].getLatLng();return i=L.GeometryUtil.isVersion07x()?l&&r&&r.distanceTo?this._measurementRunningTotal+r.distanceTo(l)*(this.options.factor||1):this._measurementRunningTotal||0:l&&r?this._measurementRunningTotal+this._map.distance(r,l)*(this.options.factor||1):this._measurementRunningTotal||0,L.GeometryUtil.readableDistance(i,this.options.metric,this.options.feet,this.options.nautic,this.options.precision)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_disableNewMarkers:function(){this._disableMarkers=!0},_enableNewMarkers:function(){setTimeout((function(){this._disableMarkers=!1}).bind(this),50)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var i=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,showLength:!1,shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},metric:!0,feet:!0,nautic:!1,precision:{}},initialize:function(i,r){L.Draw.Polyline.prototype.initialize.call(this,i,r),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var i=this._markers.length;i===1&&this._markers[0].on("click",this._finishShape,this),i>2&&(this._markers[i-1].on("dblclick",this._finishShape,this),i>3&&this._markers[i-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var i,r;return this._markers.length===0?i=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?(i=L.drawLocal.draw.handlers.polygon.tooltip.cont,r=this._getMeasurementString()):(i=L.drawLocal.draw.handlers.polygon.tooltip.end,r=this._getMeasurementString()),{text:i,subtext:r}},_getMeasurementString:function(){var i=this._area,r="";return i||this.options.showLength?(this.options.showLength&&(r=L.Draw.Polyline.prototype._getMeasurementString.call(this)),i&&(r+="<br>"+L.GeometryUtil.readableArea(i,this.options.metric,this.options.precision)),r):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexChanged:function(i,r){var l;!this.options.allowIntersection&&this.options.showArea&&(l=this._poly.getLatLngs(),this._area=L.GeometryUtil.geodesicArea(l)),L.Draw.Polyline.prototype._vertexChanged.call(this,i,r)},_cleanUpShape:function(){var i=this._markers.length;i>0&&(this._markers[0].off("click",this._finishShape,this),i>2&&this._markers[i-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(i,r){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,i,r)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this).on("touchstart",this._onMouseDown,this).on("touchmove",this._onMouseMove,this),e.addEventListener("touchstart",L.DomEvent.preventDefault,{passive:!1}))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this).off("touchstart",this._onMouseDown,this).off("touchmove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),L.DomEvent.off(e,"touchend",this._onMouseUp,this),e.removeEventListener("touchstart",L.DomEvent.preventDefault),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1},_getTooltipText:function(){return{text:this._endLabelText}},_onMouseDown:function(i){this._isDrawing=!0,this._startLatLng=i.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).on(e,"touchend",this._onMouseUp,this).preventDefault(i.originalEvent)},_onMouseMove:function(i){var r=i.latlng;this._tooltip.updatePosition(r),this._isDrawing&&(this._tooltip.updateContent(this._getTooltipText()),this._drawShape(r))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showArea:!0,metric:!0},initialize:function(i,r){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,i,r)},disable:function(){this._enabled&&(this._isCurrentlyTwoClickDrawing=!1,L.Draw.SimpleShape.prototype.disable.call(this))},_onMouseUp:function(i){if(!this._shape&&!this._isCurrentlyTwoClickDrawing)return void(this._isCurrentlyTwoClickDrawing=!0);this._isCurrentlyTwoClickDrawing&&!a(i.target,"leaflet-pane")||L.Draw.SimpleShape.prototype._onMouseUp.call(this)},_drawShape:function(i){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,i)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,i),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var i=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,i)},_getTooltipText:function(){var i,r,l,c=L.Draw.SimpleShape.prototype._getTooltipText.call(this),u=this._shape,f=this.options.showArea;return u&&(i=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),r=L.GeometryUtil.geodesicArea(i),l=f?L.GeometryUtil.readableArea(r,this.options.metric):""),{text:c.text,subtext:l}}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(i,r){this.type=L.Draw.Marker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.marker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,i,r)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:this._initialLabelText}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onTouch,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._map.off("click",this._onClick,this).off("click",this._onTouch,this),this._marker&&(this._marker.off("click",this._onClick,this),this._map.removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(i){var r=i.latlng;this._tooltip.updatePosition(r),this._mouseMarker.setLatLng(r),this._marker?(r=this._mouseMarker.getLatLng(),this._marker.setLatLng(r)):(this._marker=this._createMarker(r),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_createMarker:function(i){return new L.Marker(i,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset})},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_onTouch:function(i){this._onMouseMove(i),this._onClick()},_fireCreatedEvent:function(){var i=new L.Marker.Touch(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)}}),L.Draw.CircleMarker=L.Draw.Marker.extend({statics:{TYPE:"circlemarker"},options:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0,zIndexOffset:2e3},initialize:function(i,r){this.type=L.Draw.CircleMarker.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circlemarker.tooltip.start,L.Draw.Feature.prototype.initialize.call(this,i,r)},_fireCreatedEvent:function(){var i=new L.CircleMarker(this._marker.getLatLng(),this.options);L.Draw.Feature.prototype._fireCreatedEvent.call(this,i)},_createMarker:function(i){return new L.CircleMarker(i,this.options)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#3388ff",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0,feet:!0,nautic:!1},initialize:function(i,r){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,i,r)},_drawShape:function(i){if(L.GeometryUtil.isVersion07x())var r=this._startLatLng.distanceTo(i);else var r=this._map.distance(this._startLatLng,i);this._shape?this._shape.setRadius(r):(this._shape=new L.Circle(this._startLatLng,r,this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var i=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,i)},_onMouseMove:function(i){var r,l=i.latlng,c=this.options.showRadius,u=this.options.metric;if(this._tooltip.updatePosition(l),this._isDrawing){this._drawShape(l),r=this._shape.getRadius().toFixed(1);var f="";c&&(f=L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(r,u,this.options.feet,this.options.nautic)),this._tooltip.updateContent({text:this._endLabelText,subtext:f})}}}),L.Edit=L.Edit||{},L.Edit.Marker=L.Handler.extend({initialize:function(i,r){this._marker=i,L.setOptions(this,r)},addHooks:function(){var i=this._marker;i.dragging.enable(),i.on("dragend",this._onDragEnd,i),this._toggleMarkerHighlight()},removeHooks:function(){var i=this._marker;i.dragging.disable(),i.off("dragend",this._onDragEnd,i),this._toggleMarkerHighlight()},_onDragEnd:function(i){var r=i.target;r.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:r})},_toggleMarkerHighlight:function(){var i=this._marker._icon;i&&(i.style.display="none",L.DomUtil.hasClass(i,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(i,"leaflet-edit-marker-selected"),this._offsetMarker(i,-4)):(L.DomUtil.addClass(i,"leaflet-edit-marker-selected"),this._offsetMarker(i,4)),i.style.display="")},_offsetMarker:function(i,r){var l=parseInt(i.style.marginTop,10)-r,c=parseInt(i.style.marginLeft,10)-r;i.style.marginTop=l+"px",i.style.marginLeft=c+"px"}}),L.Marker.addInitHook(function(){L.Edit.Marker&&(this.editing=new L.Edit.Marker(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({initialize:function(i){this.latlngs=[i._latlngs],i._holes&&(this.latlngs=this.latlngs.concat(i._holes)),this._poly=i,this._poly.on("revert-edited",this._updateLatLngs,this)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._poly._latlngs)?this._poly._latlngs:this._poly._latlngs[0]:this._poly._latlngs},_eachVertexHandler:function(i){for(var r=0;r<this._verticesHandlers.length;r++)i(this._verticesHandlers[r])},addHooks:function(){this._initHandlers(),this._eachVertexHandler(function(i){i.addHooks()})},removeHooks:function(){this._eachVertexHandler(function(i){i.removeHooks()})},updateMarkers:function(){this._eachVertexHandler(function(i){i.updateMarkers()})},_initHandlers:function(){this._verticesHandlers=[];for(var i=0;i<this.latlngs.length;i++)this._verticesHandlers.push(new L.Edit.PolyVerticesEdit(this._poly,this.latlngs[i],this._poly.options.poly))},_updateLatLngs:function(i){this.latlngs=[i.layer._latlngs],i.layer._holes&&(this.latlngs=this.latlngs.concat(i.layer._holes))}}),L.Edit.PolyVerticesEdit=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),touchIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-touch-icon"}),drawError:{color:"#b00b00",timeout:1e3}},initialize:function(i,r,l){L.Browser.touch&&(this.options.icon=this.options.touchIcon),this._poly=i,l&&l.drawError&&(l.drawError=L.Util.extend({},this.options.drawError,l.drawError)),this._latlngs=r,L.setOptions(this,l)},_defaultShape:function(){return L.Polyline._flat?L.Polyline._flat(this._latlngs)?this._latlngs:this._latlngs[0]:this._latlngs},addHooks:function(){var i=this._poly,r=i._path;i instanceof L.Polygon||(i.options.fill=!1,i.options.editing&&(i.options.editing.fill=!1)),r&&i.options.editing&&i.options.editing.className&&(i.options.original.className&&i.options.original.className.split(" ").forEach(function(l){L.DomUtil.removeClass(r,l)}),i.options.editing.className.split(" ").forEach(function(l){L.DomUtil.addClass(r,l)})),i.setStyle(i.options.editing),this._poly._map&&(this._map=this._poly._map,this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){var i=this._poly,r=i._path;r&&i.options.editing&&i.options.editing.className&&(i.options.editing.className.split(" ").forEach(function(l){L.DomUtil.removeClass(r,l)}),i.options.original.className&&i.options.original.className.split(" ").forEach(function(l){L.DomUtil.addClass(r,l)})),i.setStyle(i.options.original),i._map&&(i._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var i,r,l,c,u=this._defaultShape();for(i=0,l=u.length;i<l;i++)c=this._createMarker(u[i],i),c.on("click",this._onMarkerClick,this),c.on("contextmenu",this._onContextMenu,this),this._markers.push(c);var f,p;for(i=0,r=l-1;i<l;r=i++)(i!==0||L.Polygon&&this._poly instanceof L.Polygon)&&(f=this._markers[r],p=this._markers[i],this._createMiddleMarker(f,p),this._updatePrevNext(f,p))},_createMarker:function(i,r){var l=new L.Marker.Touch(i,{draggable:!0,icon:this.options.icon});return l._origLatLng=i,l._index=r,l.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._fireEdit,this).on("touchmove",this._onTouchMove,this).on("touchend",this._fireEdit,this).on("MSPointerMove",this._onTouchMove,this).on("MSPointerUp",this._fireEdit,this),this._markerGroup.addLayer(l),l},_onMarkerDragStart:function(){this._poly.fire("editstart")},_spliceLatLngs:function(){var i=this._defaultShape(),r=[].splice.apply(i,arguments);return this._poly._convertLatLngs(i,!0),this._poly.redraw(),r},_removeMarker:function(i){var r=i._index;this._markerGroup.removeLayer(i),this._markers.splice(r,1),this._spliceLatLngs(r,1),this._updateIndexes(r,-1),i.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("touchmove",this._onMarkerDrag,this).off("touchend",this._fireEdit,this).off("click",this._onMarkerClick,this).off("MSPointerMove",this._onTouchMove,this).off("MSPointerUp",this._fireEdit,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit"),this._poly._map.fire(L.Draw.Event.EDITVERTEX,{layers:this._markerGroup,poly:this._poly})},_onMarkerDrag:function(i){var r=i.target,l=this._poly,c=L.LatLngUtil.cloneLatLng(r._origLatLng);if(L.extend(r._origLatLng,r._latlng),l.options.poly){var u=l._map._editTooltip;if(!l.options.poly.allowIntersection&&l.intersects()){L.extend(r._origLatLng,c),r.setLatLng(c);var f=l.options.color;l.setStyle({color:this.options.drawError.color}),u&&u.updateContent({text:L.drawLocal.draw.handlers.polyline.error}),setTimeout(function(){l.setStyle({color:f}),u&&u.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext})},1e3)}}r._middleLeft&&r._middleLeft.setLatLng(this._getMiddleLatLng(r._prev,r)),r._middleRight&&r._middleRight.setLatLng(this._getMiddleLatLng(r,r._next)),this._poly._bounds._southWest=L.latLng(1/0,1/0),this._poly._bounds._northEast=L.latLng(-1/0,-1/0);var p=this._poly.getLatLngs();this._poly._convertLatLngs(p,!0),this._poly.redraw(),this._poly.fire("editdrag")},_onMarkerClick:function(i){var r=L.Polygon&&this._poly instanceof L.Polygon?4:3,l=i.target;this._defaultShape().length<r||(this._removeMarker(l),this._updatePrevNext(l._prev,l._next),l._middleLeft&&this._markerGroup.removeLayer(l._middleLeft),l._middleRight&&this._markerGroup.removeLayer(l._middleRight),l._prev&&l._next?this._createMiddleMarker(l._prev,l._next):l._prev?l._next||(l._prev._middleRight=null):l._next._middleLeft=null,this._fireEdit())},_onContextMenu:function(i){var r=i.target;this._poly,this._poly._map.fire(L.Draw.Event.MARKERCONTEXT,{marker:r,layers:this._markerGroup,poly:this._poly}),L.DomEvent.stopPropagation},_onTouchMove:function(i){var r=this._map.mouseEventToLayerPoint(i.originalEvent.touches[0]),l=this._map.layerPointToLatLng(r),c=i.target;L.extend(c._origLatLng,l),c._middleLeft&&c._middleLeft.setLatLng(this._getMiddleLatLng(c._prev,c)),c._middleRight&&c._middleRight.setLatLng(this._getMiddleLatLng(c,c._next)),this._poly.redraw(),this.updateMarkers()},_updateIndexes:function(i,r){this._markerGroup.eachLayer(function(l){l._index>i&&(l._index+=r)})},_createMiddleMarker:function(i,r){var l,c,u,f=this._getMiddleLatLng(i,r),p=this._createMarker(f);p.setOpacity(.6),i._middleRight=r._middleLeft=p,c=function(){p.off("touchmove",c,this);var g=r._index;p._index=g,p.off("click",l,this).on("click",this._onMarkerClick,this),f.lat=p.getLatLng().lat,f.lng=p.getLatLng().lng,this._spliceLatLngs(g,0,f),this._markers.splice(g,0,p),p.setOpacity(1),this._updateIndexes(g,1),r._index++,this._updatePrevNext(i,p),this._updatePrevNext(p,r),this._poly.fire("editstart")},u=function(){p.off("dragstart",c,this),p.off("dragend",u,this),p.off("touchmove",c,this),this._createMiddleMarker(i,p),this._createMiddleMarker(p,r)},l=function(){c.call(this),u.call(this),this._fireEdit()},p.on("click",l,this).on("dragstart",c,this).on("dragend",u,this).on("touchmove",c,this),this._markerGroup.addLayer(p)},_updatePrevNext:function(i,r){i&&(i._next=r),r&&(r._prev=i)},_getMiddleLatLng:function(i,r){var l=this._poly._map,c=l.project(i.getLatLng()),u=l.project(r.getLatLng());return l.unproject(c._add(u)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"}),touchMoveIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move leaflet-touch-icon"}),touchResizeIcon:new L.DivIcon({iconSize:new L.Point(20,20),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize leaflet-touch-icon"})},initialize:function(i,r){L.Browser.touch&&(this.options.moveIcon=this.options.touchMoveIcon,this.options.resizeIcon=this.options.touchResizeIcon),this._shape=i,L.Util.setOptions(this,r)},addHooks:function(){var i=this._shape;this._shape._map&&(this._map=this._shape._map,i.setStyle(i.options.editing),i._map&&(this._map=i._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup)))},removeHooks:function(){var i=this._shape;if(i.setStyle(i.options.original),i._map){this._unbindMarker(this._moveMarker);for(var r=0,l=this._resizeMarkers.length;r<l;r++)this._unbindMarker(this._resizeMarkers[r]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(i,r){var l=new L.Marker.Touch(i,{draggable:!0,icon:r,zIndexOffset:10});return this._bindMarker(l),this._markerGroup.addLayer(l),l},_bindMarker:function(i){i.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this).on("touchstart",this._onTouchStart,this).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onTouchEnd,this).on("MSPointerUp",this._onTouchEnd,this)},_unbindMarker:function(i){i.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this).off("touchstart",this._onTouchStart,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onTouchEnd,this).off("MSPointerUp",this._onTouchEnd,this)},_onMarkerDragStart:function(i){i.target.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(i){var r=i.target,l=r.getLatLng();r===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),this._shape.fire("editdrag")},_onMarkerDragEnd:function(i){i.target.setOpacity(1),this._fireEdit()},_onTouchStart:function(i){if(L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,i),typeof this._getCorners=="function"){var r=this._getCorners(),l=i.target,c=l._cornerIndex;l.setOpacity(0),this._oppositeCorner=r[(c+2)%4],this._toggleCornerMarkers(0,c)}this._shape.fire("editstart")},_onTouchMove:function(i){var r=this._map.mouseEventToLayerPoint(i.originalEvent.touches[0]),l=this._map.layerPointToLatLng(r);return i.target===this._moveMarker?this._move(l):this._resize(l),this._shape.redraw(),!1},_onTouchEnd:function(i){i.target.setOpacity(1),this.updateMarkers(),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var i=this._shape.getBounds(),r=i.getCenter();this._moveMarker=this._createMarker(r,this.options.moveIcon)},_createResizeMarker:function(){var i=this._getCorners();this._resizeMarkers=[];for(var r=0,l=i.length;r<l;r++)this._resizeMarkers.push(this._createMarker(i[r],this.options.resizeIcon)),this._resizeMarkers[r]._cornerIndex=r},_onMarkerDragStart:function(i){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,i);var r=this._getCorners(),l=i.target,c=l._cornerIndex;this._oppositeCorner=r[(c+2)%4],this._toggleCornerMarkers(0,c)},_onMarkerDragEnd:function(i){var r,l,c=i.target;c===this._moveMarker&&(r=this._shape.getBounds(),l=r.getCenter(),c.setLatLng(l)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,i)},_move:function(i){for(var r,l=this._shape._defaultShape?this._shape._defaultShape():this._shape.getLatLngs(),c=this._shape.getBounds(),u=c.getCenter(),f=[],p=0,g=l.length;p<g;p++)r=[l[p].lat-u.lat,l[p].lng-u.lng],f.push([i.lat+r[0],i.lng+r[1]]);this._shape.setLatLngs(f),this._repositionCornerMarkers(),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})},_resize:function(i){var r;this._shape.setBounds(L.latLngBounds(i,this._oppositeCorner)),r=this._shape.getBounds(),this._moveMarker.setLatLng(r.getCenter()),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})},_getCorners:function(){var i=this._shape.getBounds();return[i.getNorthWest(),i.getNorthEast(),i.getSouthEast(),i.getSouthWest()]},_toggleCornerMarkers:function(i){for(var r=0,l=this._resizeMarkers.length;r<l;r++)this._resizeMarkers[r].setOpacity(i)},_repositionCornerMarkers:function(){for(var i=this._getCorners(),r=0,l=this._resizeMarkers.length;r<l;r++)this._resizeMarkers[r].setLatLng(i[r])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.CircleMarker=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var i=this._shape.getLatLng();this._moveMarker=this._createMarker(i,this.options.moveIcon)},_createResizeMarker:function(){this._resizeMarkers=[]},_move:function(i){if(this._resizeMarkers.length){var r=this._getResizeMarkerPoint(i);this._resizeMarkers[0].setLatLng(r)}this._shape.setLatLng(i),this._map.fire(L.Draw.Event.EDITMOVE,{layer:this._shape})}}),L.CircleMarker.addInitHook(function(){L.Edit.CircleMarker&&(this.editing=new L.Edit.CircleMarker(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.CircleMarker.extend({_createResizeMarker:function(){var i=this._shape.getLatLng(),r=this._getResizeMarkerPoint(i);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(r,this.options.resizeIcon))},_getResizeMarkerPoint:function(i){var r=this._shape._radius*Math.cos(Math.PI/4),l=this._map.project(i);return this._map.unproject([l.x+r,l.y-r])},_resize:function(i){var r=this._moveMarker.getLatLng();L.GeometryUtil.isVersion07x()?radius=r.distanceTo(i):radius=this._map.distance(r,i),this._shape.setRadius(radius),this._map.editTooltip&&this._map._editTooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.subtext+"<br />"+L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.draw.handlers.circle.radius+": "+L.GeometryUtil.readableDistance(radius,!0,this.options.feet,this.options.nautic)}),this._shape.setRadius(radius),this._map.fire(L.Draw.Event.EDITRESIZE,{layer:this._shape})}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable())}),L.Map.mergeOptions({touchExtend:!0}),L.Map.TouchExtend=L.Handler.extend({initialize:function(i){this._map=i,this._container=i._container,this._pane=i._panes.overlayPane},addHooks:function(){L.DomEvent.on(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.on(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.on(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.on(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.on(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.on(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.on(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.on(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.on(this._container,"touchleave",this._onTouchLeave,this))},removeHooks:function(){L.DomEvent.off(this._container,"touchstart",this._onTouchStart,this),L.DomEvent.off(this._container,"touchend",this._onTouchEnd,this),L.DomEvent.off(this._container,"touchmove",this._onTouchMove,this),this._detectIE()?(L.DomEvent.off(this._container,"MSPointerDown",this._onTouchStart,this),L.DomEvent.off(this._container,"MSPointerUp",this._onTouchEnd,this),L.DomEvent.off(this._container,"MSPointerMove",this._onTouchMove,this),L.DomEvent.off(this._container,"MSPointerCancel",this._onTouchCancel,this)):(L.DomEvent.off(this._container,"touchcancel",this._onTouchCancel,this),L.DomEvent.off(this._container,"touchleave",this._onTouchLeave,this))},_touchEvent:function(i,r){var l={};if(i.touches!==void 0){if(!i.touches.length)return;l=i.touches[0]}else if(i.pointerType!=="touch"||(l=i,!this._filterClick(i)))return;var c=this._map.mouseEventToContainerPoint(l),u=this._map.mouseEventToLayerPoint(l),f=this._map.layerPointToLatLng(u);this._map.fire(r,{latlng:f,layerPoint:u,containerPoint:c,pageX:l.pageX,pageY:l.pageY,originalEvent:i})},_filterClick:function(i){var r=i.timeStamp||i.originalEvent.timeStamp,l=L.DomEvent._lastClick&&r-L.DomEvent._lastClick;return l&&l>100&&l<500||i.target._simulatedClick&&!i._simulated?(L.DomEvent.stop(i),!1):(L.DomEvent._lastClick=r,!0)},_onTouchStart:function(i){this._map._loaded&&this._touchEvent(i,"touchstart")},_onTouchEnd:function(i){this._map._loaded&&this._touchEvent(i,"touchend")},_onTouchCancel:function(i){if(this._map._loaded){var r="touchcancel";this._detectIE()&&(r="pointercancel"),this._touchEvent(i,r)}},_onTouchLeave:function(i){this._map._loaded&&this._touchEvent(i,"touchleave")},_onTouchMove:function(i){this._map._loaded&&this._touchEvent(i,"touchmove")},_detectIE:function(){var i=n.navigator.userAgent,r=i.indexOf("MSIE ");if(r>0)return parseInt(i.substring(r+5,i.indexOf(".",r)),10);if(i.indexOf("Trident/")>0){var l=i.indexOf("rv:");return parseInt(i.substring(l+3,i.indexOf(".",l)),10)}var c=i.indexOf("Edge/");return c>0&&parseInt(i.substring(c+5,i.indexOf(".",c)),10)}}),L.Map.addInitHook("addHandler","touchExtend",L.Map.TouchExtend),L.Marker.Touch=L.Marker.extend({_initInteraction:function(){return this.addInteractiveTarget?L.Marker.prototype._initInteraction.apply(this):this._initInteractionLegacy()},_initInteractionLegacy:function(){if(this.options.clickable){var i=this._icon,r=["dblclick","mousedown","mouseover","mouseout","contextmenu","touchstart","touchend","touchmove"];this._detectIE?r.concat(["MSPointerDown","MSPointerUp","MSPointerMove","MSPointerCancel"]):r.concat(["touchcancel"]),L.DomUtil.addClass(i,"leaflet-clickable"),L.DomEvent.on(i,"click",this._onMouseClick,this),L.DomEvent.on(i,"keypress",this._onKeyPress,this);for(var l=0;l<r.length;l++)L.DomEvent.on(i,r[l],this._fireMouseEvent,this);L.Handler.MarkerDrag&&(this.dragging=new L.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_detectIE:function(){var i=n.navigator.userAgent,r=i.indexOf("MSIE ");if(r>0)return parseInt(i.substring(r+5,i.indexOf(".",r)),10);if(i.indexOf("Trident/")>0){var l=i.indexOf("rv:");return parseInt(i.substring(l+3,i.indexOf(".",l)),10)}var c=i.indexOf("Edge/");return c>0&&parseInt(i.substring(c+5,i.indexOf(".",c)),10)}}),L.LatLngUtil={cloneLatLngs:function(i){for(var r=[],l=0,c=i.length;l<c;l++)Array.isArray(i[l])?r.push(L.LatLngUtil.cloneLatLngs(i[l])):r.push(this.cloneLatLng(i[l]));return r},cloneLatLng:function(i){return L.latLng(i.lat,i.lng)}},function(){var i={km:2,ha:2,m:0,mi:2,ac:2,yd:0,ft:0,nm:2};L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(r){var l,c,u=r.length,f=0,p=Math.PI/180;if(u>2){for(var g=0;g<u;g++)l=r[g],c=r[(g+1)%u],f+=(c.lng-l.lng)*p*(2+Math.sin(l.lat*p)+Math.sin(c.lat*p));f=6378137*f*6378137/2}return Math.abs(f)},formattedNumber:function(r,l){var c=parseFloat(r).toFixed(l),u=L.drawLocal.format&&L.drawLocal.format.numeric,f=u&&u.delimiters,p=f&&f.thousands,g=f&&f.decimal;if(p||g){var y=c.split(".");c=p?y[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p):y[0],g=g||".",y.length>1&&(c=c+g+y[1])}return c},readableArea:function(r,l,p){var u,f,p=L.Util.extend({},i,p);return l?(f=["ha","m"],type=typeof l,type==="string"?f=[l]:type!=="boolean"&&(f=l),u=r>=1e6&&f.indexOf("km")!==-1?L.GeometryUtil.formattedNumber(1e-6*r,p.km)+" km":r>=1e4&&f.indexOf("ha")!==-1?L.GeometryUtil.formattedNumber(1e-4*r,p.ha)+" ha":L.GeometryUtil.formattedNumber(r,p.m)+" m"):(r/=.836127,u=r>=3097600?L.GeometryUtil.formattedNumber(r/3097600,p.mi)+" mi":r>=4840?L.GeometryUtil.formattedNumber(r/4840,p.ac)+" acres":L.GeometryUtil.formattedNumber(r,p.yd)+" yd"),u},readableDistance:function(r,l,c,u,g){var p,g=L.Util.extend({},i,g);switch(l?typeof l=="string"?l:"metric":c?"feet":u?"nauticalMile":"yards"){case"metric":p=r>1e3?L.GeometryUtil.formattedNumber(r/1e3,g.km)+" km":L.GeometryUtil.formattedNumber(r,g.m)+" m";break;case"feet":r*=3.28083,p=L.GeometryUtil.formattedNumber(r,g.ft)+" ft";break;case"nauticalMile":r*=.53996,p=L.GeometryUtil.formattedNumber(r/1e3,g.nm)+" nm";break;case"yards":default:r*=1.09361,p=r>1760?L.GeometryUtil.formattedNumber(r/1760,g.mi)+" miles":L.GeometryUtil.formattedNumber(r,g.yd)+" yd"}return p},isVersion07x:function(){var r=L.version.split(".");return parseInt(r[0],10)===0&&parseInt(r[1],10)===7}})}(),L.Util.extend(L.LineUtil,{segmentsIntersect:function(i,r,l,c){return this._checkCounterclockwise(i,l,c)!==this._checkCounterclockwise(r,l,c)&&this._checkCounterclockwise(i,r,l)!==this._checkCounterclockwise(i,r,c)},_checkCounterclockwise:function(i,r,l){return(l.y-i.y)*(r.x-i.x)>(r.y-i.y)*(l.x-i.x)}}),L.Polyline.include({intersects:function(){var i,r,l,c=this._getProjectedPoints(),u=c?c.length:0;if(this._tooFewPointsForIntersection())return!1;for(i=u-1;i>=3;i--)if(r=c[i-1],l=c[i],this._lineSegmentsIntersectsRange(r,l,i-2))return!0;return!1},newLatLngIntersects:function(i,r){return!!this._map&&this.newPointIntersects(this._map.latLngToLayerPoint(i),r)},newPointIntersects:function(i,r){var l=this._getProjectedPoints(),c=l?l.length:0,u=l?l[c-1]:null,f=c-2;return!this._tooFewPointsForIntersection(1)&&this._lineSegmentsIntersectsRange(u,i,f,r?1:0)},_tooFewPointsForIntersection:function(i){var r=this._getProjectedPoints(),l=r?r.length:0;return l+=i||0,!r||l<=3},_lineSegmentsIntersectsRange:function(i,r,l,c){var u,f,p=this._getProjectedPoints();c=c||0;for(var g=l;g>c;g--)if(u=p[g-1],f=p[g],L.LineUtil.segmentsIntersect(i,r,u,f))return!0;return!1},_getProjectedPoints:function(){if(!this._defaultShape)return this._originalPoints;for(var i=[],r=this._defaultShape(),l=0;l<r.length;l++)i.push(this._map.latLngToLayerPoint(r[l]));return i}}),L.Polygon.include({intersects:function(){var i,r,l,c,u=this._getProjectedPoints();return!this._tooFewPointsForIntersection()&&(!!L.Polyline.prototype.intersects.call(this)||(i=u.length,r=u[0],l=u[i-1],c=i-2,this._lineSegmentsIntersectsRange(l,r,c,1)))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(i){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,i);var r;this._toolbars={},L.DrawToolbar&&this.options.draw&&(r=new L.DrawToolbar(this.options.draw),this._toolbars[L.DrawToolbar.TYPE]=r,this._toolbars[L.DrawToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(r=new L.EditToolbar(this.options.edit),this._toolbars[L.EditToolbar.TYPE]=r,this._toolbars[L.EditToolbar.TYPE].on("enable",this._toolbarEnabled,this)),L.toolbar=this},onAdd:function(i){var r,l=L.DomUtil.create("div","leaflet-draw"),c=!1;for(var u in this._toolbars)this._toolbars.hasOwnProperty(u)&&(r=this._toolbars[u].addToolbar(i))&&(c||(L.DomUtil.hasClass(r,"leaflet-draw-toolbar-top")||L.DomUtil.addClass(r.childNodes[0],"leaflet-draw-toolbar-top"),c=!0),l.appendChild(r));return l},onRemove:function(){for(var i in this._toolbars)this._toolbars.hasOwnProperty(i)&&this._toolbars[i].removeToolbar()},setDrawingOptions:function(i){for(var r in this._toolbars)this._toolbars[r]instanceof L.DrawToolbar&&this._toolbars[r].setOptions(i)},_toolbarEnabled:function(i){var r=i.target;for(var l in this._toolbars)this._toolbars[l]!==r&&this._toolbars[l].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({initialize:function(i){L.setOptions(this,i),this._modes={},this._actionButtons=[],this._activeMode=null;var r=L.version.split(".");parseInt(r[0],10)===1&&parseInt(r[1],10)>=2?L.Toolbar.include(L.Evented.prototype):L.Toolbar.include(L.Mixin.Events)},enabled:function(){return this._activeMode!==null},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(i){var r,l=L.DomUtil.create("div","leaflet-draw-section"),c=0,u=this._toolbarClass||"",f=this.getModeHandlers(i);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=i,r=0;r<f.length;r++)f[r].enabled&&this._initModeHandler(f[r].handler,this._toolbarContainer,c++,u,f[r].title);if(c)return this._lastButtonIndex=--c,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),l.appendChild(this._toolbarContainer),l.appendChild(this._actionsContainer),l},removeToolbar:function(){for(var i in this._modes)this._modes.hasOwnProperty(i)&&(this._disposeButton(this._modes[i].button,this._modes[i].handler.enable,this._modes[i].handler),this._modes[i].handler.disable(),this._modes[i].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var r=0,l=this._actionButtons.length;r<l;r++)this._disposeButton(this._actionButtons[r].button,this._actionButtons[r].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(i,r,l,c,u){var f=i.type;this._modes[f]={},this._modes[f].handler=i,this._modes[f].button=this._createButton({type:f,title:u,className:c+"-"+f,container:r,callback:this._modes[f].handler.enable,context:this._modes[f].handler}),this._modes[f].buttonIndex=l,this._modes[f].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_detectIOS:function(){return/iPad|iPhone|iPod/.test(navigator.userAgent)&&!n.MSStream},_createButton:function(i){var r=L.DomUtil.create("a",i.className||"",i.container),l=L.DomUtil.create("span","sr-only",i.container);r.href="#",r.appendChild(l),i.title&&(r.title=i.title,l.innerHTML=i.title),i.text&&(r.innerHTML=i.text,l.innerHTML=i.text);var c=this._detectIOS()?"touchstart":"click";return L.DomEvent.on(r,"click",L.DomEvent.stopPropagation).on(r,"mousedown",L.DomEvent.stopPropagation).on(r,"dblclick",L.DomEvent.stopPropagation).on(r,"touchstart",L.DomEvent.stopPropagation).on(r,"click",L.DomEvent.preventDefault).on(r,c,i.callback,i.context),r},_disposeButton:function(i,r){var l=this._detectIOS()?"touchstart":"click";L.DomEvent.off(i,"click",L.DomEvent.stopPropagation).off(i,"mousedown",L.DomEvent.stopPropagation).off(i,"dblclick",L.DomEvent.stopPropagation).off(i,"touchstart",L.DomEvent.stopPropagation).off(i,"click",L.DomEvent.preventDefault).off(i,l,r)},_handlerActivated:function(i){this.disable(),this._activeMode=this._modes[i.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(i){var r,l,c,u,f=this._actionsContainer,p=this.getActions(i),g=p.length;for(l=0,c=this._actionButtons.length;l<c;l++)this._disposeButton(this._actionButtons[l].button,this._actionButtons[l].callback);for(this._actionButtons=[];f.firstChild;)f.removeChild(f.firstChild);for(var y=0;y<g;y++)"enabled"in p[y]&&!p[y].enabled||(r=L.DomUtil.create("li","",f),u=this._createButton({title:p[y].title,text:p[y].text,container:r,callback:p[y].callback,context:p[y].context}),this._actionButtons.push({button:u,callback:p[y].callback}))},_showActionsToolbar:function(){var i=this._activeMode.buttonIndex,r=this._lastButtonIndex,l=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=l+"px",i===0&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),i===r&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block",this._map.fire(L.Draw.Event.TOOLBAROPENED)},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom"),this._map.fire(L.Draw.Event.TOOLBARCLOSED)}}),L.Draw=L.Draw||{},L.Draw.Tooltip=L.Class.extend({initialize:function(i){this._map=i,this._popupPane=i._panes.popupPane,this._visible=!1,this._container=i.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1,this._map.on("mouseout",this._onMouseOut,this)},dispose:function(){this._map.off("mouseout",this._onMouseOut,this),this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(i){return this._container?(i.subtext=i.subtext||"",i.subtext.length!==0||this._singleLineLabel?i.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(i.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+i.subtext+"</span><br />":"")+"<span>"+i.text+"</span>",i.text||i.subtext?(this._visible=!0,this._container.style.visibility="inherit"):(this._visible=!1,this._container.style.visibility="hidden"),this):this},updatePosition:function(i){var r=this._map.latLngToLayerPoint(i),l=this._container;return this._container&&(this._visible&&(l.style.visibility="inherit"),L.DomUtil.setPosition(l,r)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this},_onMouseOut:function(){this._container&&(this._container.style.visibility="hidden")}}),L.DrawToolbar=L.Toolbar.extend({statics:{TYPE:"draw"},options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{},circlemarker:{}},initialize:function(i){for(var r in this.options)this.options.hasOwnProperty(r)&&i[r]&&(i[r]=L.extend({},this.options[r],i[r]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,i)},getModeHandlers:function(i){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(i,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(i,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(i,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(i,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(i,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker},{enabled:this.options.circlemarker,handler:new L.Draw.CircleMarker(i,this.options.circlemarker),title:L.drawLocal.draw.toolbar.buttons.circlemarker}]},getActions:function(i){return[{enabled:i.completeShape,title:L.drawLocal.draw.toolbar.finish.title,text:L.drawLocal.draw.toolbar.finish.text,callback:i.completeShape,context:i},{enabled:i.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:i.deleteLastVertex,context:i},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(i){L.setOptions(this,i);for(var r in this._modes)this._modes.hasOwnProperty(r)&&i.hasOwnProperty(r)&&this._modes[r].handler.setOptions(i[r])}}),L.EditToolbar=L.Toolbar.extend({statics:{TYPE:"edit"},options:{edit:{selectedPathOptions:{dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1,maintainColor:!1}},remove:{},poly:null,featureGroup:null},initialize:function(i){i.edit&&(i.edit.selectedPathOptions===void 0&&(i.edit.selectedPathOptions=this.options.edit.selectedPathOptions),i.edit.selectedPathOptions=L.extend({},this.options.edit.selectedPathOptions,i.edit.selectedPathOptions)),i.remove&&(i.remove=L.extend({},this.options.remove,i.remove)),i.poly&&(i.poly=L.extend({},this.options.poly,i.poly)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,i),this._selectedFeatureCount=0},getModeHandlers:function(i){var r=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(i,{featureGroup:r,selectedPathOptions:this.options.edit.selectedPathOptions,poly:this.options.poly}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(i,{featureGroup:r}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(i){var r=[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}];return i.removeAllLayers&&r.push({title:L.drawLocal.edit.toolbar.actions.clearAll.title,text:L.drawLocal.edit.toolbar.actions.clearAll.text,callback:this._clearAllLayers,context:this}),r},addToolbar:function(i){var r=L.Toolbar.prototype.addToolbar.call(this,i);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),r},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode&&this._activeMode.handler.disable()},_clearAllLayers:function(){this._activeMode.handler.removeAllLayers(),this._activeMode&&this._activeMode.handler.disable()},_checkDisabled:function(){var i,r=this.options.featureGroup,l=r.getLayers().length!==0;this.options.edit&&(i=this._modes[L.EditToolbar.Edit.TYPE].button,l?L.DomUtil.removeClass(i,"leaflet-disabled"):L.DomUtil.addClass(i,"leaflet-disabled"),i.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(i=this._modes[L.EditToolbar.Delete.TYPE].button,l?L.DomUtil.removeClass(i,"leaflet-disabled"):L.DomUtil.addClass(i,"leaflet-disabled"),i.setAttribute("title",l?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},initialize:function(i,r){if(L.Handler.prototype.initialize.call(this,i),L.setOptions(this,r),this._featureGroup=r.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Edit.include(L.Evented.prototype):L.EditToolbar.Edit.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.EDITSTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.EDITSTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(i.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),i._editTooltip=this._tooltip,this._updateTooltip(),this._map.on("mousemove",this._onMouseMove,this).on("touchmove",this._onMouseMove,this).on("MSPointerMove",this._onMouseMove,this).on(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this).off("touchmove",this._onMouseMove,this).off("MSPointerMove",this._onMouseMove,this).off(L.Draw.Event.EDITVERTEX,this._updateTooltip,this))},revertLayers:function(){this._featureGroup.eachLayer(function(i){this._revertLayer(i)},this)},save:function(){var i=new L.LayerGroup;this._featureGroup.eachLayer(function(r){r.edited&&(i.addLayer(r),r.edited=!1)}),this._map.fire(L.Draw.Event.EDITED,{layers:i})},_backupLayer:function(i){var r=L.Util.stamp(i);this._uneditedLayerProps[r]||(i instanceof L.Polyline||i instanceof L.Polygon||i instanceof L.Rectangle?this._uneditedLayerProps[r]={latlngs:L.LatLngUtil.cloneLatLngs(i.getLatLngs())}:i instanceof L.Circle?this._uneditedLayerProps[r]={latlng:L.LatLngUtil.cloneLatLng(i.getLatLng()),radius:i.getRadius()}:(i instanceof L.Marker||i instanceof L.CircleMarker)&&(this._uneditedLayerProps[r]={latlng:L.LatLngUtil.cloneLatLng(i.getLatLng())}))},_getTooltipText:function(){return{text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}},_updateTooltip:function(){this._tooltip.updateContent(this._getTooltipText())},_revertLayer:function(i){var r=L.Util.stamp(i);i.edited=!1,this._uneditedLayerProps.hasOwnProperty(r)&&(i instanceof L.Polyline||i instanceof L.Polygon||i instanceof L.Rectangle?i.setLatLngs(this._uneditedLayerProps[r].latlngs):i instanceof L.Circle?(i.setLatLng(this._uneditedLayerProps[r].latlng),i.setRadius(this._uneditedLayerProps[r].radius)):(i instanceof L.Marker||i instanceof L.CircleMarker)&&i.setLatLng(this._uneditedLayerProps[r].latlng),i.fire("revert-edited",{layer:i}))},_enableLayerEdit:function(i){var r,l,c=i.layer||i.target||i;this._backupLayer(c),this.options.poly&&(l=L.Util.extend({},this.options.poly),c.options.poly=l),this.options.selectedPathOptions&&(r=L.Util.extend({},this.options.selectedPathOptions),r.maintainColor&&(r.color=c.options.color,r.fillColor=c.options.fillColor),c.options.original=L.extend({},c.options),c.options.editing=r),c instanceof L.Marker?(c.editing&&c.editing.enable(),c.dragging.enable(),c.on("dragend",this._onMarkerDragEnd).on("touchmove",this._onTouchMove,this).on("MSPointerMove",this._onTouchMove,this).on("touchend",this._onMarkerDragEnd,this).on("MSPointerUp",this._onMarkerDragEnd,this)):c.editing.enable()},_disableLayerEdit:function(i){var r=i.layer||i.target||i;r.edited=!1,r.editing&&r.editing.disable(),delete r.options.editing,delete r.options.original,this._selectedPathOptions&&(r instanceof L.Marker?this._toggleMarkerHighlight(r):(r.setStyle(r.options.previousOptions),delete r.options.previousOptions)),r instanceof L.Marker?(r.dragging.disable(),r.off("dragend",this._onMarkerDragEnd,this).off("touchmove",this._onTouchMove,this).off("MSPointerMove",this._onTouchMove,this).off("touchend",this._onMarkerDragEnd,this).off("MSPointerUp",this._onMarkerDragEnd,this)):r.editing.disable()},_onMouseMove:function(i){this._tooltip.updatePosition(i.latlng)},_onMarkerDragEnd:function(i){var r=i.target;r.edited=!0,this._map.fire(L.Draw.Event.EDITMOVE,{layer:r})},_onTouchMove:function(i){var r=i.originalEvent.changedTouches[0],l=this._map.mouseEventToLayerPoint(r),c=this._map.layerPointToLatLng(l);i.target.setLatLng(c)},_hasAvailableLayers:function(){return this._featureGroup.getLayers().length!==0}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},initialize:function(i,r){if(L.Handler.prototype.initialize.call(this,i),L.Util.setOptions(this,r),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE;var l=L.version.split(".");parseInt(l[0],10)===1&&parseInt(l[1],10)>=2?L.EditToolbar.Delete.include(L.Evented.prototype):L.EditToolbar.Delete.include(L.Mixin.Events)},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire(L.Draw.Event.DELETESTART,{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire(L.Draw.Event.DELETESTOP,{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var i=this._map;i&&(i.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.LayerGroup,this._tooltip=new L.Draw.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(i){this._deletableLayers.addLayer(i),i.fire("revert-deleted",{layer:i})},this)},save:function(){this._map.fire(L.Draw.Event.DELETED,{layers:this._deletedLayers})},removeAllLayers:function(){this._deletableLayers.eachLayer(function(i){this._removeLayer({layer:i})},this),this.save()},_enableLayerDelete:function(i){(i.layer||i.target||i).on("click",this._removeLayer,this)},_disableLayerDelete:function(i){var r=i.layer||i.target||i;r.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(r)},_removeLayer:function(i){var r=i.layer||i.target||i;this._deletableLayers.removeLayer(r),this._deletedLayers.addLayer(r),r.fire("deleted")},_onMouseMove:function(i){this._tooltip.updatePosition(i.latlng)},_hasAvailableLayers:function(){return this._deletableLayers.getLayers().length!==0}})})(window,document);const{Map:so}=uh;function va(n,e,o){const a=n.slice();return a[138]=e[o],a[140]=o,a}function ya(n,e,o){const a=n.slice();return a[141]=e[o],a[142]=e,a[143]=o,a}function ba(n,e,o){const a=n.slice();return a[144]=e[o],a}function wa(n,e,o){const a=n.slice();return a[147]=e[o],a}function Qo(n){const e=n.slice(),o=e[52](e[147].source);e[150]=o;const a=e[52](e[147].target);return e[151]=a,e}function La(n,e,o){const a=n.slice();return a[152]=e[o],a[153]=e,a[154]=o,a}function ka(n,e,o){const a=n.slice();return a[151]=e[o],a}function Ma(n,e,o){const a=n.slice();return a[159]=e[o],a}function Pa(n,e,o){const a=n.slice();return a[147]=e[o],a}function Vd(n){let e=[],o=new so,a,i=Se(n[2]);const r=l=>l[147].id;for(let l=0;l<i.length;l+=1){let c=Pa(n,i,l),u=r(c);o.set(u,e[l]=Ea(u,c))}return{c(){for(let l=0;l<e.length;l+=1)e[l].c();a=Ie()},m(l,c){for(let u=0;u<e.length;u+=1)e[u]&&e[u].m(l,c);et(l,a,c)},p(l,c){c[0]&4|c[1]&8&&(i=Se(l[2]),e=vn(e,c,r,1,l,i,o,a.parentNode,Co,Ea,a,Pa))},d(l){l&&Q(a);for(let c=0;c<e.length;c+=1)e[c].d(l)}}}function Yd(n){let e;return{c(){e=S("div"),e.textContent="(none)",m(e,"class","muted small txt svelte-1sj21o9")},m(o,a){et(o,e,a)},p:Gt,d(o){o&&Q(e)}}}function Ea(n,e){let o,a=e[147].source+"",i,r,l=e[147].target+"",c,u,f,p,g,y;function k(){return e[72](e[147])}return{key:n,first:null,c(){o=S("span"),i=Ze(a),r=Ze(""),c=Ze(l),u=K(),f=S("button"),f.textContent="",p=K(),m(f,"class","pill-x svelte-1sj21o9"),m(f,"aria-label","Remove edge"),m(o,"class","edge-pill svelte-1sj21o9"),m(o,"title","Click  to remove"),this.first=o},m(M,C){et(M,o,C),w(o,i),w(o,r),w(o,c),w(o,u),w(o,f),w(o,p),g||(y=ft(f,"click",k),g=!0)},p(M,C){e=M,C[0]&4&&a!==(a=e[147].source+"")&&Ei(i,a),C[0]&4&&l!==(l=e[147].target+"")&&Ei(c,l)},d(M){M&&Q(o),g=!1,y()}}}function Ca(n){let e,o,a,i,r,l,c,u,f,p;return{c(){e=S("div"),o=S("span"),a=Ze("connecting from "),i=S("code"),r=Ze(n[5]),l=Ze("  click a nodes  to finish"),c=K(),u=S("button"),u.textContent="cancel",m(o,"class","txt svelte-1sj21o9"),m(u,"class","pill-x svelte-1sj21o9"),m(e,"class","pending small svelte-1sj21o9")},m(g,y){et(g,e,y),w(e,o),w(o,a),w(o,i),w(i,r),w(o,l),w(e,c),w(e,u),f||(p=ft(u,"click",n[41]),f=!0)},p(g,y){y[0]&32&&Ei(r,g[5])},d(g){g&&Q(e),f=!1,p()}}}function Xd(n){let e,o=[],a=new so,i=Se(n[32]);const r=l=>l[159].id;for(let l=0;l<i.length;l+=1){let c=Ma(n,i,l),u=r(c);a.set(u,o[l]=Ta(u,c))}return{c(){e=S("div");for(let l=0;l<o.length;l+=1)o[l].c();m(e,"class","tool-list svelte-1sj21o9")},m(l,c){et(l,e,c);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(e,null)},p(l,c){c[1]&473956354&&(i=Se(l[32]),o=vn(o,c,r,1,l,i,a,e,Co,Ta,null,Ma))},d(l){l&&Q(e);for(let c=0;c<o.length;c+=1)o[c].d()}}}function qd(n){let e;return{c(){e=S("div"),e.textContent="(no scheduled jobs)",m(e,"class","muted small txt svelte-1sj21o9")},m(o,a){et(o,e,a)},p:Gt,d(o){o&&Q(e)}}}function Ta(n,e){let o,a,i,r,l=Ya(e[159].next_run_time)+"",c,u,f,p,g,y,k,M,C,D,z,T,x,j,F,W;function Y(){return e[73](e[159])}function st(){return e[74](e[159])}function ot(){return e[75](e[159])}function $(){return e[76](e[159])}function ct(){return e[77](e[159])}return{key:n,first:null,c(){o=S("div"),a=S("div"),i=S("div"),r=S("time"),c=Ze(l),f=K(),p=S("div"),g=S("button"),g.textContent="Run now",y=K(),k=S("button"),k.textContent="Pause",M=K(),C=S("button"),C.textContent="Resume",D=K(),z=S("button"),z.textContent="Logs",T=K(),x=S("button"),x.textContent="Delete",j=K(),m(r,"datetime",u=e[159].next_run_time),m(i,"class","schedule-date svelte-1sj21o9"),m(a,"class","schedule-head svelte-1sj21o9"),m(g,"class","pill-x svelte-1sj21o9"),m(g,"title","Run now"),m(k,"class","pill-x svelte-1sj21o9"),m(k,"title","Pause"),m(C,"class","pill-x svelte-1sj21o9"),m(C,"title","Resume"),m(z,"class","pill-x svelte-1sj21o9"),m(z,"title","Logs"),m(x,"class","pill-x svelte-1sj21o9"),m(x,"title","Delete"),m(p,"class","schedule-actions svelte-1sj21o9"),m(o,"class","tool schedule-card svelte-1sj21o9"),this.first=o},m(N,lt){et(N,o,lt),w(o,a),w(a,i),w(i,r),w(r,c),w(o,f),w(o,p),w(p,g),w(p,y),w(p,k),w(p,M),w(p,C),w(p,D),w(p,z),w(p,T),w(p,x),w(o,j),F||(W=[ft(g,"click",Y),ft(k,"click",st),ft(C,"click",ot),ft(z,"click",$),ft(x,"click",ct)],F=!0)},p(N,lt){e=N,lt[1]&2&&l!==(l=Ya(e[159].next_run_time)+"")&&Ei(c,l),lt[1]&2&&u!==(u=e[159].next_run_time)&&m(r,"datetime",u)},d(N){N&&Q(o),F=!1,hi(W)}}}function Sa(n){let e,o=n[151].name+"",a,i;return{c(){e=S("option"),a=Ze(o),e.__value=i=n[151].name,Be(e,e.__value)},m(r,l){et(r,e,l),w(e,a)},p(r,l){l[0]&64&&o!==(o=r[151].name+"")&&Ei(a,o),l[0]&64&&i!==(i=r[151].name)&&(e.__value=i,Be(e,e.__value))},d(r){r&&Q(e)}}}function Kd(n){let e,o,a=n[152].label+"",i,r,l,c,u,f,p,g,y,k,M,C,D,z,T,x,j,F,W,Y,st;function ot(){return n[78](n[152])}function $(){return n[79](n[152])}function ct(){return n[80](n[152])}let N=Se(n[6]),lt=[];for(let St=0;St<N.length;St+=1)lt[St]=Sa(ka(n,N,St));function V(){n[81].call(M,n[154])}function yt(){return n[82](n[154],n[152])}function _t(){return n[83](n[152])}function U(){return n[84](n[152],n[154])}function Z(){return n[85](n[152])}return{c(){e=S("div"),o=S("div"),i=Ze(a),r=K(),l=S("button"),c=K(),u=S("button"),p=K(),g=S("button"),g.textContent="",y=K(),k=S("div"),M=S("select");for(let St=0;St<lt.length;St+=1)lt[St].c();C=K(),D=S("button"),D.textContent="",z=K(),T=S("button"),T.textContent="",x=K(),j=S("button"),j.textContent="",W=K(),m(o,"class","node-title svelte-1sj21o9"),m(l,"class","dot in svelte-1sj21o9"),m(l,"title","input"),m(u,"class","dot out svelte-1sj21o9"),m(u,"title","output"),m(u,"aria-pressed",f=n[5]===n[152].id),m(g,"class","node-del svelte-1sj21o9"),m(g,"title","delete node"),m(M,"class","svelte-1sj21o9"),n[1][n[154]].type===void 0&&Sn(V),m(D,"class","edit-btn svelte-1sj21o9"),m(T,"class","preview-btn svelte-1sj21o9"),m(T,"title","Preview on map"),m(j,"class","runone-btn svelte-1sj21o9"),m(j,"title","Run this node only"),m(k,"class","node-config svelte-1sj21o9"),m(e,"class","node svelte-1sj21o9"),m(e,"aria-selected",F=n[155]?"true":"false")},m(St,at){et(St,e,at),w(e,o),w(o,i),w(e,r),w(e,l),w(e,c),w(e,u),w(e,p),w(e,g),w(e,y),w(e,k),w(k,M);for(let Mt=0;Mt<lt.length;Mt+=1)lt[Mt]&&lt[Mt].m(M,null);jn(M,n[1][n[154]].type,!0),w(k,C),w(k,D),w(k,z),w(k,T),w(k,x),w(k,j),et(St,W,at),Y||(st=[ft(l,"click",ot),ft(u,"click",$),ft(g,"click",ct),ft(M,"change",V),ft(M,"change",yt),ft(D,"click",_t),ft(T,"click",U),ft(j,"click",Z),kn(n[156].call(null,e))],Y=!0)},p(St,at){if(n=St,at[0]&2&&a!==(a=n[152].label+"")&&Ei(i,a),at[0]&98&&f!==(f=n[5]===n[152].id)&&m(u,"aria-pressed",f),at[0]&64){N=Se(n[6]);let Mt;for(Mt=0;Mt<N.length;Mt+=1){const Ct=ka(n,N,Mt);lt[Mt]?lt[Mt].p(Ct,at):(lt[Mt]=Sa(Ct),lt[Mt].c(),lt[Mt].m(M,null))}for(;Mt<lt.length;Mt+=1)lt[Mt].d(1);lt.length=N.length}at[0]&66&&jn(M,n[1][n[154]].type),at[5]&1&&F!==(F=n[155]?"true":"false")&&m(e,"aria-selected",F)},d(St){St&&(Q(e),Q(W)),Tn(lt,St),Y=!1,hi(st)}}}function Da(n,e){let o,a,i,r;function l(u){e[86](u,e[154])}let c={id:e[152].id,width:fl,height:_l,$$slots:{default:[Kd,({selected:u,grabHandle:f})=>({155:u,156:f}),({selected:u,grabHandle:f})=>[0,0,0,0,0,(u?1:0)|(f?2:0)]]},$$scope:{ctx:e}};return e[1][e[154]].position!==void 0&&(c.position=e[1][e[154]].position),a=new as({props:c}),nn.push(()=>bh(a,"position",l)),{key:n,first:null,c(){o=Ie(),ae(a.$$.fragment),this.first=o},m(u,f){et(u,o,f),ee(a,u,f),r=!0},p(u,f){e=u;const p={};f[0]&2&&(p.id=e[152].id),f[0]&122|f[5]&513&&(p.$$scope={dirty:f,ctx:e}),!i&&f[0]&2&&(i=!0,p.position=e[1][e[154]].position,gh(()=>i=!1)),a.$set(p)},i(u){r||(B(a.$$.fragment,u),r=!0)},o(u){G(a.$$.fragment,u),r=!1},d(u){u&&Q(o),ie(a,u)}}}function za(n){let e,o;return{c(){e=qt("path"),m(e,"d",o=`M ${n[43](n[150])} ${n[44](n[150])}
                          C ${n[43](n[150])+60} ${n[44](n[150])},
                            ${n[42](n[151])-60} ${n[44](n[151])},
                            ${n[42](n[151])} ${n[44](n[151])}`),m(e,"class","cable svelte-1sj21o9"),m(e,"marker-end","url(#arrow)")},m(a,i){et(a,e,i)},p(a,i){i[0]&4&&o!==(o=`M ${a[43](a[150])} ${a[44](a[150])}
                          C ${a[43](a[150])+60} ${a[44](a[150])},
                            ${a[42](a[151])-60} ${a[44](a[151])},
                            ${a[42](a[151])} ${a[44](a[151])}`)&&m(e,"d",o)},d(a){a&&Q(e)}}}function Oa(n,e){let o,a=e[33](e[147].source)&&e[33](e[147].target),i,r=a&&za(Qo(e));return{key:n,first:null,c(){o=Ie(),r&&r.c(),i=Ie(),this.first=o},m(l,c){et(l,o,c),r&&r.m(l,c),et(l,i,c)},p(l,c){e=l,c[0]&4&&(a=e[33](e[147].source)&&e[33](e[147].target)),a?r?r.p(Qo(e),c):(r=za(Qo(e)),r.c(),r.m(i.parentNode,i)):r&&(r.d(1),r=null)},d(l){l&&(Q(o),Q(i)),r&&r.d(l)}}}function Ia(n){let e,o,a,i=[],r=new so,l,c=Se(n[2]);const u=f=>f[147].id;for(let f=0;f<c.length;f+=1){let p=wa(n,c,f),g=u(p);r.set(g,i[f]=Oa(g,p))}return{c(){e=qt("defs"),o=qt("marker"),a=qt("path");for(let f=0;f<i.length;f+=1)i[f].c();l=Ie(),m(a,"d","M 0 0 L 10 5 L 0 10 z"),m(o,"id","arrow"),m(o,"viewBox","0 0 10 10"),m(o,"refX","9"),m(o,"refY","5"),m(o,"markerWidth","6"),m(o,"markerHeight","6"),m(o,"orient","auto-start-reverse")},m(f,p){et(f,e,p),w(e,o),w(o,a);for(let g=0;g<i.length;g+=1)i[g]&&i[g].m(f,p);et(f,l,p)},p(f,p){p[0]&4|p[1]&2111492&&(c=Se(f[2]),i=vn(i,p,u,1,f,c,r,l.parentNode,Co,Oa,l,wa))},d(f){f&&(Q(e),Q(l));for(let p=0;p<i.length;p+=1)i[p].d(f)}}}function Jd(n){let e=[],o=new so,a,i,r=n[10],l,c,u=Se(n[1]);const f=g=>g[152].id;for(let g=0;g<u.length;g+=1){let y=La(n,u,g),k=f(y);o.set(k,e[g]=Da(k,y))}let p=Ia(n);return{c(){for(let g=0;g<e.length;g+=1)e[g].c();a=K(),i=qt("svg"),p.c(),m(i,"class","edges-overlay svelte-1sj21o9"),m(i,"viewBox",l=`0 0 ${n[12]} ${n[13]}`),m(i,"preserveAspectRatio","none")},m(g,y){for(let k=0;k<e.length;k+=1)e[k]&&e[k].m(g,y);et(g,a,y),et(g,i,y),p.m(i,null),c=!0},p(g,y){y[0]&122|y[1]&656176|y[5]&1&&(u=Se(g[1]),ve(),e=vn(e,y,f,1,g,u,o,a.parentNode,io,Da,a,La),ye()),y[0]&1024&&di(r,r=g[10])?(p.d(1),p=Ia(g),p.c(),p.m(i,null)):p.p(g,y),(!c||y[0]&12288&&l!==(l=`0 0 ${g[12]} ${g[13]}`))&&m(i,"viewBox",l)},i(g){if(!c){for(let y=0;y<u.length;y+=1)B(e[y]);c=!0}},o(g){for(let y=0;y<e.length;y+=1)G(e[y]);c=!1},d(g){g&&(Q(a),Q(i));for(let y=0;y<e.length;y+=1)e[y].d(g);p.d(g)}}}function Aa(n){let e,o,a,i,r,l,c=n[18].label+"",u,f,p,g,y,k,M,C,D,z,T,x,j,F;function W(ot,$){return ot[22]?Qd:$d}let Y=W(n),st=Y(n);return{c(){e=S("div"),o=K(),a=S("div"),i=S("div"),r=S("h3"),l=Ze("Edit Args  "),u=Ze(c),f=K(),p=S("div"),g=S("button"),g.textContent="Form",y=K(),k=S("button"),k.textContent="Advanced JSON",M=K(),st.c(),C=K(),D=S("div"),z=S("button"),z.textContent="Cancel",T=K(),x=S("button"),x.textContent="Save",m(e,"class","modal-backdrop svelte-1sj21o9"),m(r,"class","svelte-1sj21o9"),m(g,"class","svelte-1sj21o9"),Vt(g,"seg-active",!n[22]),m(k,"class","svelte-1sj21o9"),Vt(k,"seg-active",n[22]),m(p,"class","seg svelte-1sj21o9"),m(i,"class","modal-head svelte-1sj21o9"),m(z,"class","btn svelte-1sj21o9"),m(x,"class","btn primary svelte-1sj21o9"),m(D,"class","modal-actions svelte-1sj21o9"),m(a,"class","modal svelte-1sj21o9")},m(ot,$){et(ot,e,$),et(ot,o,$),et(ot,a,$),w(a,i),w(i,r),w(r,l),w(r,u),w(i,f),w(i,p),w(p,g),w(p,y),w(p,k),w(a,M),st.m(a,null),w(a,C),w(a,D),w(D,z),w(D,T),w(D,x),j||(F=[ft(e,"click",n[90]),ft(g,"click",n[91]),ft(k,"click",n[92]),ft(z,"click",n[100]),ft(x,"click",n[51]),ft(a,"click",en(n[68]))],j=!0)},p(ot,$){$[0]&262144&&c!==(c=ot[18].label+"")&&Ei(u,c),$[0]&4194304&&Vt(g,"seg-active",!ot[22]),$[0]&4194304&&Vt(k,"seg-active",ot[22]),Y===(Y=W(ot))&&st?st.p(ot,$):(st.d(1),st=Y(ot),st&&(st.c(),st.m(a,C)))},d(ot){ot&&(Q(e),Q(o),Q(a)),st.d(),j=!1,hi(F)}}}function Qd(n){let e,o,a;return{c(){e=S("textarea"),m(e,"class","json-area svelte-1sj21o9")},m(i,r){et(i,e,r),Be(e,n[19]),o||(a=ft(e,"input",n[99]),o=!0)},p(i,r){r[0]&524288&&Be(e,i[19])},d(i){i&&Q(e),o=!1,a()}}}function $d(n){let e,o=Se(n[20]),a=[];for(let i=0;i<o.length;i+=1)a[i]=Na(ya(n,o,i));return{c(){e=S("div");for(let i=0;i<a.length;i+=1)a[i].c();m(e,"class","form-grid svelte-1sj21o9")},m(i,r){et(i,e,r);for(let l=0;l<a.length;l+=1)a[l]&&a[l].m(e,null)},p(i,r){if(r[0]&3145728){o=Se(i[20]);let l;for(l=0;l<o.length;l+=1){const c=ya(i,o,l);a[l]?a[l].p(c,r):(a[l]=Na(c),a[l].c(),a[l].m(e,null))}for(;l<a.length;l+=1)a[l].d(1);a.length=o.length}},d(i){i&&Q(e),Tn(a,i)}}}function tf(n){let e,o,a,i=Se(Va(n[141])),r=[];for(let c=0;c<i.length;c+=1)r[c]=xa(ba(n,i,c));function l(){n[98].call(e,n[141])}return{c(){e=S("select");for(let c=0;c<r.length;c+=1)r[c].c();m(e,"class","svelte-1sj21o9"),n[21][n[141].key]===void 0&&Sn(l)},m(c,u){et(c,e,u);for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(e,null);jn(e,n[21][n[141].key],!0),o||(a=ft(e,"change",l),o=!0)},p(c,u){if(n=c,u[0]&1048576){i=Se(Va(n[141]));let f;for(f=0;f<i.length;f+=1){const p=ba(n,i,f);r[f]?r[f].p(p,u):(r[f]=xa(p),r[f].c(),r[f].m(e,null))}for(;f<r.length;f+=1)r[f].d(1);r.length=i.length}u[0]&3145728&&jn(e,n[21][n[141].key])},d(c){c&&Q(e),Tn(r,c),o=!1,a()}}}function ef(n){let e,o,a,i,r,l=Wa(n[141])+"",c,u,f;function p(){n[97].call(e,n[141])}return{c(){e=S("input"),a=K(),i=S("small"),r=Ze("Comma-separated "),c=Ze(l),m(e,"type","text"),m(e,"placeholder",o=Ua(n[141])),m(e,"class","svelte-1sj21o9"),m(i,"class","muted svelte-1sj21o9")},m(g,y){et(g,e,y),Be(e,n[21][n[141].key]),et(g,a,y),et(g,i,y),w(i,r),w(i,c),u||(f=ft(e,"input",p),u=!0)},p(g,y){n=g,y[0]&1048576&&o!==(o=Ua(n[141]))&&m(e,"placeholder",o),y[0]&3145728&&e.value!==n[21][n[141].key]&&Be(e,n[21][n[141].key]),y[0]&1048576&&l!==(l=Wa(n[141])+"")&&Ei(c,l)},d(g){g&&(Q(e),Q(a),Q(i)),u=!1,f()}}}function nf(n){let e,o,a,i,r;function l(){n[96].call(e,n[141])}return{c(){e=S("textarea"),m(e,"rows",o=Fa(n[141])),m(e,"placeholder",a=Ga(n[141])),m(e,"class","svelte-1sj21o9")},m(c,u){et(c,e,u),Be(e,n[21][n[141].key]),i||(r=ft(e,"input",l),i=!0)},p(c,u){n=c,u[0]&1048576&&o!==(o=Fa(n[141]))&&m(e,"rows",o),u[0]&1048576&&a!==(a=Ga(n[141]))&&m(e,"placeholder",a),u[0]&3145728&&Be(e,n[21][n[141].key])},d(c){c&&Q(e),i=!1,r()}}}function of(n){let e,o,a,i,r,l;function c(){n[95].call(o,n[141])}return{c(){e=S("label"),o=S("input"),a=K(),i=S("span"),m(o,"type","checkbox"),m(o,"class","svelte-1sj21o9"),m(e,"class","switch svelte-1sj21o9")},m(u,f){et(u,e,f),w(e,o),o.checked=n[21][n[141].key],w(e,a),w(e,i),r||(l=ft(o,"change",c),r=!0)},p(u,f){n=u,f[0]&3145728&&(o.checked=n[21][n[141].key])},d(u){u&&Q(e),r=!1,l()}}}function sf(n){let e,o,a,i;function r(){n[94].call(e,n[141])}return{c(){e=S("input"),m(e,"type","number"),m(e,"step",o=n[141].step??1),m(e,"class","svelte-1sj21o9")},m(l,c){et(l,e,c),Be(e,n[21][n[141].key]),a||(i=ft(e,"input",r),a=!0)},p(l,c){n=l,c[0]&1048576&&o!==(o=n[141].step??1)&&m(e,"step",o),c[0]&3145728&&Ln(e.value)!==n[21][n[141].key]&&Be(e,n[21][n[141].key])},d(l){l&&Q(e),a=!1,i()}}}function rf(n){let e,o,a,i;function r(){n[93].call(e,n[141])}return{c(){e=S("input"),m(e,"type","text"),m(e,"placeholder",o=n[141].placeholder??""),m(e,"class","svelte-1sj21o9")},m(l,c){et(l,e,c),Be(e,n[21][n[141].key]),a||(i=ft(e,"input",r),a=!0)},p(l,c){n=l,c[0]&1048576&&o!==(o=n[141].placeholder??"")&&m(e,"placeholder",o),c[0]&3145728&&e.value!==n[21][n[141].key]&&Be(e,n[21][n[141].key])},d(l){l&&Q(e),a=!1,i()}}}function xa(n){let e,o=n[144]+"",a,i;return{c(){e=S("option"),a=Ze(o),e.__value=i=n[144],Be(e,e.__value)},m(r,l){et(r,e,l),w(e,a)},p(r,l){l[0]&1048576&&o!==(o=r[144]+"")&&Ei(a,o),l[0]&1048576&&i!==(i=r[144])&&(e.__value=i,Be(e,e.__value))},d(r){r&&Q(e)}}}function Na(n){let e,o,a=n[141].label+"",i,r,l;function c(p,g){if(p[141].type==="string")return rf;if(p[141].type==="number")return sf;if(p[141].type==="boolean")return of;if(p[141].type==="textarea")return nf;if(p[141].type==="array")return ef;if(p[141].type==="select")return tf}let u=c(n),f=u&&u(n);return{c(){e=S("div"),o=S("label"),i=Ze(a),r=K(),f&&f.c(),l=K(),m(o,"class","svelte-1sj21o9"),m(e,"class","form-row svelte-1sj21o9")},m(p,g){et(p,e,g),w(e,o),w(o,i),w(e,r),f&&f.m(e,null),w(e,l)},p(p,g){g[0]&1048576&&a!==(a=p[141].label+"")&&Ei(i,a),u===(u=c(p))&&f?f.p(p,g):(f&&f.d(1),f=u&&u(p),f&&(f.c(),f.m(e,l)))},d(p){p&&Q(e),f&&f.d()}}}function Ba(n){let e,o,a,i,r,l,c,u,f,p,g,y,k,M,C,D,z,T,x,j,F=n[30]?"Scheduling":"Create schedule",W,Y,st;function ot(lt,V){return lt[24]==="once"?hf:lt[24]==="interval"?lf:af}let $=ot(n),ct=$(n),N=n[31]&&Ra(n);return{c(){e=S("div"),o=K(),a=S("div"),i=S("div"),i.innerHTML='<h3 class="svelte-1sj21o9">Schedule Pipeline (active connected graph)</h3>',r=K(),l=S("div"),c=S("div"),u=S("label"),u.textContent="Mode",f=K(),p=S("select"),g=S("option"),g.textContent="Once",y=S("option"),y.textContent="Interval",k=S("option"),k.textContent="Cron",M=K(),ct.c(),C=K(),N&&N.c(),D=K(),z=S("div"),T=S("button"),T.textContent="Cancel",x=K(),j=S("button"),W=Ze(F),m(e,"class","modal-backdrop svelte-1sj21o9"),m(i,"class","modal-head svelte-1sj21o9"),m(u,"class","svelte-1sj21o9"),g.__value="once",Be(g,g.__value),y.__value="interval",Be(y,y.__value),k.__value="cron",Be(k,k.__value),m(p,"class","svelte-1sj21o9"),n[24]===void 0&&Sn(()=>n[102].call(p)),m(c,"class","form-row svelte-1sj21o9"),m(l,"class","form-grid svelte-1sj21o9"),m(T,"class","btn svelte-1sj21o9"),m(j,"class","btn primary svelte-1sj21o9"),j.disabled=n[30],m(z,"class","modal-actions svelte-1sj21o9"),m(a,"class","modal svelte-1sj21o9")},m(lt,V){et(lt,e,V),et(lt,o,V),et(lt,a,V),w(a,i),w(a,r),w(a,l),w(l,c),w(c,u),w(c,f),w(c,p),w(p,g),w(p,y),w(p,k),jn(p,n[24],!0),w(l,M),ct.m(l,null),w(l,C),N&&N.m(l,null),w(a,D),w(a,z),w(z,T),w(z,x),w(z,j),w(j,W),Y||(st=[ft(e,"click",n[101]),ft(p,"change",n[102]),ft(T,"click",n[108]),ft(j,"click",n[55]),ft(a,"click",en(n[67]))],Y=!0)},p(lt,V){V[0]&16777216&&jn(p,lt[24]),$===($=ot(lt))&&ct?ct.p(lt,V):(ct.d(1),ct=$(lt),ct&&(ct.c(),ct.m(l,C))),lt[31]?N?N.p(lt,V):(N=Ra(lt),N.c(),N.m(l,null)):N&&(N.d(1),N=null),V[0]&1073741824&&F!==(F=lt[30]?"Scheduling":"Create schedule")&&Ei(W,F),V[0]&1073741824&&(j.disabled=lt[30])},d(lt){lt&&(Q(e),Q(o),Q(a)),ct.d(),N&&N.d(),Y=!1,hi(st)}}}function af(n){let e,o,a,i,r,l,c,u;return{c(){e=S("div"),o=S("label"),o.textContent="Cron (UTC)",a=K(),i=S("input"),r=K(),l=S("small"),l.innerHTML="Example: <code>0 5 * * *</code> = 05:00 UTC daily",m(o,"class","svelte-1sj21o9"),m(i,"type","text"),m(i,"placeholder","0 5 * * *"),m(i,"class","svelte-1sj21o9"),m(l,"class","muted svelte-1sj21o9"),m(e,"class","form-row svelte-1sj21o9")},m(f,p){et(f,e,p),w(e,o),w(e,a),w(e,i),Be(i,n[29]),w(e,r),w(e,l),c||(u=ft(i,"input",n[107]),c=!0)},p(f,p){p[0]&536870912&&i.value!==f[29]&&Be(i,f[29])},d(f){f&&Q(e),c=!1,u()}}}function lf(n){let e,o,a,i,r,l,c,u,f,p,g,y,k;return{c(){e=S("div"),o=S("label"),o.textContent="Interval",a=K(),i=S("div"),r=S("input"),l=K(),c=S("input"),u=K(),f=S("input"),p=K(),g=S("small"),g.textContent="At least one of hours/minutes/seconds must be > 0.",m(o,"class","svelte-1sj21o9"),m(r,"type","number"),m(r,"min","0"),m(r,"placeholder","hours"),m(r,"class","svelte-1sj21o9"),m(c,"type","number"),m(c,"min","0"),m(c,"placeholder","minutes"),m(c,"class","svelte-1sj21o9"),m(f,"type","number"),m(f,"min","0"),m(f,"placeholder","seconds"),m(f,"class","svelte-1sj21o9"),ht(i,"display","grid"),ht(i,"grid-template-columns","repeat(3, 1fr)"),ht(i,"gap","8px"),m(g,"class","muted svelte-1sj21o9"),m(e,"class","form-row svelte-1sj21o9")},m(M,C){et(M,e,C),w(e,o),w(e,a),w(e,i),w(i,r),Be(r,n[26]),w(i,l),w(i,c),Be(c,n[27]),w(i,u),w(i,f),Be(f,n[28]),w(e,p),w(e,g),y||(k=[ft(r,"input",n[104]),ft(c,"input",n[105]),ft(f,"input",n[106])],y=!0)},p(M,C){C[0]&67108864&&Ln(r.value)!==M[26]&&Be(r,M[26]),C[0]&134217728&&Ln(c.value)!==M[27]&&Be(c,M[27]),C[0]&268435456&&Ln(f.value)!==M[28]&&Be(f,M[28])},d(M){M&&Q(e),y=!1,hi(k)}}}function hf(n){let e,o,a,i,r,l,c,u;return{c(){e=S("div"),o=S("label"),o.textContent="Date & time (your local)",a=K(),i=S("input"),r=K(),l=S("small"),l.textContent="Stored & executed in UTC on the server.",m(o,"class","svelte-1sj21o9"),m(i,"type","datetime-local"),m(l,"class","muted svelte-1sj21o9"),m(e,"class","form-row svelte-1sj21o9")},m(f,p){et(f,e,p),w(e,o),w(e,a),w(e,i),Be(i,n[25]),w(e,r),w(e,l),c||(u=ft(i,"input",n[103]),c=!0)},p(f,p){p[0]&33554432&&Be(i,f[25])},d(f){f&&Q(e),c=!1,u()}}}function Ra(n){let e,o,a;return{c(){e=S("div"),o=S("div"),a=Ze(n[31]),m(o,"class","muted svelte-1sj21o9"),ht(o,"color","#ffb4b4"),m(e,"class","form-row svelte-1sj21o9")},m(i,r){et(i,e,r),w(e,o),w(o,a)},p(i,r){r[1]&1&&Ei(a,i[31])},d(i){i&&Q(e)}}}function cf(n){let e,o=[],a=new so,i=Se(n[7]);const r=l=>l[140];for(let l=0;l<i.length;l+=1){let c=va(n,i,l),u=r(c);a.set(u,o[l]=Za(u,c))}return{c(){e=S("ul");for(let l=0;l<o.length;l+=1)o[l].c();m(e,"class","svelte-1sj21o9")},m(l,c){et(l,e,c);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(e,null)},p(l,c){c[0]&128&&(i=Se(l[7]),o=vn(o,c,r,1,l,i,a,e,Co,Za,null,va))},d(l){l&&Q(e);for(let c=0;c<o.length;c+=1)o[c].d()}}}function uf(n){let e;return{c(){e=S("div"),e.textContent="No logs yet. Run the pipeline to see Python prints/stdout.",m(e,"class","muted small svelte-1sj21o9")},m(o,a){et(o,e,a)},p:Gt,d(o){o&&Q(e)}}}function Za(n,e){let o,a,i=e[138].nodeId+"",r,l,c=e[138].text+"",u,f,p;return{key:n,first:null,c(){o=S("li"),a=S("code"),r=Ze(i),l=Ze("  "),u=Ze(c),f=K(),m(a,"class","svelte-1sj21o9"),m(o,"class",p=Ys(e[138].ok?"ok":"err")+" svelte-1sj21o9"),this.first=o},m(g,y){et(g,o,y),w(o,a),w(a,r),w(o,l),w(o,u),w(o,f)},p(g,y){e=g,y[0]&128&&i!==(i=e[138].nodeId+"")&&Ei(r,i),y[0]&128&&c!==(c=e[138].text+"")&&Ei(u,c),y[0]&128&&p!==(p=Ys(e[138].ok?"ok":"err")+" svelte-1sj21o9")&&m(o,"class",p)},d(g){g&&Q(o)}}}function df(n){let e,o,a,i,r,l,c,u,f,p,g,y,k,M,C,D,z,T,x,j,F,W,Y,st,ot,$,ct,N,lt,V,yt,_t,U,Z,St,at,Mt,Ct,wt,H,q,X,I,Ft,$t,dt,Dt,zt,xt,le,ue=n[0]==="dark"?"Dark":"Light",pe,it,te,Qt,Ot,Wt,be,Ne,fe,Kt,Ht,Jt,ne,We,De,ze,He,he=n[8]?"Running":"Run",$e,vi,we,Le,It,fi,Ae,ci,Re,ui,Ce,ti,_i,_e,ce,je,Ve,yi,Si,Ci,Je,Pt,ei,ii,ni,pi,b,pt,Et,kt,At,A,Xt,oe,Yt,me,Fe,oi,si,Zi,Hi,Ki,Di,Oi,Yi,on,mt,Bt,se,Pi,ri,Ge,Te,Rt,xe,ji,Ji,ai,sn,Ye,Ii,Ue;function Fi(nt,gt){return nt[2].length===0?Yd:Vd}let Gi=Fi(n),bi=Gi(n),li=n[5]&&Ca(n);function Ui(nt,gt){return nt[32].length===0?qd:Xd}let hn=Ui(n),Ai=hn(n);Fe=new Ud({props:{width:n[12],height:n[13],theme:n[0],$$slots:{default:[Jd]},$$scope:{ctx:n}}});let mi=n[18]&&Aa(n),wi=n[23]&&Ba(n);function E(nt,gt){return nt[7].length===0?uf:cf}let tt=E(n),rt=tt(n);return{c(){e=S("div"),o=S("header"),a=S("div"),i=S("button"),i.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',r=K(),l=S("div"),l.innerHTML='<span class="title svelte-1sj21o9">SATERYS</span>',c=K(),u=S("div"),u.innerHTML='<div class="hint svelte-1sj21o9">Build pipelines  click a nodes  /  to connect</div>',f=K(),p=S("div"),g=S("button"),y=qt("svg"),k=qt("path"),M=K(),C=S("span"),C.textContent="Run",z=K(),T=S("button"),T.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z" stroke="currentColor" stroke-width="2" fill="none"></path><path d="M7 3v6h10" stroke="currentColor" stroke-width="2" fill="none"></path><path d="M17 21v-8H7v8" stroke="currentColor" stroke-width="2" fill="none"></path></svg> <span>Save</span>',x=K(),j=S("button"),j.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M3 15v4a2 2 0 002 2h14a2 2 0 002-2v-4M17 9l-5 5-5-5M12 4v10" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Load</span>',F=K(),W=S("button"),W.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M8 7V4m8 3V4M5 11h14M7 21h10a2 2 0 002-2V8a2 2 0 00-2-2H7a2 2 0 00-2 2v11a2 2 0 002 2zm5-6v-3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span>Schedule</span>',Y=K(),st=S("button"),st.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2zm2 4l3 3-3 3m5 0h5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Logs</span>',ot=K(),$=S("button"),ct=qt("svg"),N=qt("path"),lt=K(),V=S("span"),V.textContent="Layers",yt=K(),_t=S("button"),_t.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M12 2L2 7l10 5 10-5-10-5zM2 17l10 5 10-5M2 12l10 5 10-5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Load SHP</span>',U=K(),Z=S("button"),Z.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z" stroke="currentColor" stroke-width="2" fill="none"></path><circle cx="12" cy="15" r="2" fill="currentColor"></circle></svg> <span>Save SHP</span>',St=K(),at=S("button"),at.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M3 6h18M9 6V4a1 1 0 011-1h4a1 1 0 011 1v2m2 0v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6h12z" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Clear Vec</span>',Mt=K(),Ct=S("button"),wt=qt("svg"),H=qt("path"),q=qt("path"),X=K(),I=S("span"),I.textContent="3D",$t=K(),dt=S("button"),Dt=qt("svg"),zt=qt("path"),xt=K(),le=S("span"),pe=Ze(ue),it=K(),te=S("button"),te.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span>Add</span>',Qt=K(),Ot=S("div"),Wt=S("aside"),be=S("div"),Ne=S("div"),Ne.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M5 12h14M12 5v14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span class="txt svelte-1sj21o9">Tools</span>',fe=K(),Kt=S("div"),Ht=S("button"),Ht.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span class="txt svelte-1sj21o9">Add Node</span>',Jt=K(),ne=S("button"),We=qt("svg"),De=qt("path"),ze=K(),He=S("span"),$e=Ze(he),vi=K(),we=S("button"),Le=qt("svg"),It=qt("path"),fi=K(),Ae=S("span"),Ae.textContent="Clear Layers",ci=K(),Re=S("button"),ui=qt("svg"),Ce=qt("path"),ti=K(),_i=S("span"),_e=Ze("Theme: "),ce=Ze(n[0]),je=K(),Ve=S("div"),yi=S("div"),yi.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 12l7-7 4 4 7-7" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span class="txt svelte-1sj21o9">Edges</span>',Si=K(),Ci=S("div"),bi.c(),Je=K(),li&&li.c(),Pt=K(),ei=S("div"),ii=S("div"),ni=qt("svg"),pi=qt("path"),b=K(),pt=S("span"),pt.textContent="Schedules",Et=K(),kt=S("button"),kt.textContent="",At=K(),Ai.c(),Xt=K(),oe=S("div"),Yt=S("div"),me=S("div"),ae(Fe.$$.fragment),oi=K(),si=S("div"),Zi=K(),Hi=S("div"),Ki=S("div"),Oi=K(),mi&&mi.c(),Yi=K(),wi&&wi.c(),on=K(),mt=S("div"),Bt=S("div"),se=S("div"),se.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2zm2 4l3 3-3 3m5 0h5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Pipeline Logs</span>',Pi=K(),ri=S("div"),Ge=S("button"),Ge.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M9 9h11v11H9zM5 5h11v11" stroke="currentColor" stroke-width="2" fill="none"></path></svg>',Te=K(),Rt=S("button"),Rt.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 6h18M9 6v12m6-12v12M5 6l1-3h12l1 3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',xe=K(),ji=S("button"),ji.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M6 6l12 12M6 18L18 6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',Ji=K(),ai=S("div"),rt.c(),m(i,"class","icon-btn ghost svelte-1sj21o9"),m(i,"title","Toggle sidebar"),m(l,"class","brand svelte-1sj21o9"),m(a,"class","left svelte-1sj21o9"),m(u,"class","center svelte-1sj21o9"),m(k,"d","M8 5v14l11-7z"),m(k,"fill","currentColor"),m(y,"viewBox","0 0 24 24"),m(y,"width","18"),m(y,"height","18"),m(g,"class","icon-btn svelte-1sj21o9"),m(g,"title",D=n[8]?"Running":"Run pipeline"),g.disabled=n[8],m(T,"class","icon-btn svelte-1sj21o9"),m(T,"title","Save workflow"),m(j,"class","icon-btn svelte-1sj21o9"),m(j,"title","Load workflow"),m(W,"class","icon-btn svelte-1sj21o9"),m(W,"title","Schedule pipeline"),m(st,"class","icon-btn svelte-1sj21o9"),m(st,"title","Toggle logs"),m(N,"d","M12 3l9 5-9 5-9-5 9-5zm0 8l9 5-9 5-9-5"),m(N,"stroke","currentColor"),m(N,"stroke-width","2"),m(N,"fill","none"),m(N,"stroke-linejoin","round"),m(ct,"viewBox","0 0 24 24"),m(ct,"width","18"),m(ct,"height","18"),m($,"class","icon-btn svelte-1sj21o9"),m($,"title","Clear map layers"),$.disabled=n[46].size===0,m(_t,"class","icon-btn svelte-1sj21o9"),m(_t,"title","Load shapefile"),m(Z,"class","icon-btn svelte-1sj21o9"),m(Z,"title","Save shapefile"),m(at,"class","icon-btn svelte-1sj21o9"),m(at,"title","Clear vector data"),m(H,"d","M21 16V8a2 2 0 00-1-1.73l-7-4a2 2 0 00-2 0l-7 4A2 2 0 003 8v8a2 2 0 001 1.73l7 4a2 2 0 002 0l7-4A2 2 0 0021 16z"),m(H,"stroke","currentColor"),m(H,"stroke-width","2"),m(H,"fill","none"),m(q,"d","M3.27 6.96L12 12.01l8.73-5.05M12 22.08V12"),m(q,"stroke","currentColor"),m(q,"stroke-width","2"),m(q,"fill","none"),m(q,"stroke-linecap","round"),m(q,"stroke-linejoin","round"),m(wt,"viewBox","0 0 24 24"),m(wt,"width","18"),m(wt,"height","18"),m(Ct,"class","icon-btn svelte-1sj21o9"),m(Ct,"title",Ft=n[17]?"3D mode ON":"3D mode OFF"),Vt(Ct,"primary",n[17]),m(zt,"d","M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"),m(zt,"stroke","currentColor"),m(zt,"stroke-width","2"),m(zt,"fill","none"),m(Dt,"viewBox","0 0 24 24"),m(Dt,"width","18"),m(Dt,"height","18"),m(dt,"class","icon-btn svelte-1sj21o9"),m(dt,"title","Toggle theme"),m(te,"class","icon-btn primary svelte-1sj21o9"),m(te,"title","Add node"),m(p,"class","right svelte-1sj21o9"),m(o,"class","topbar glass svelte-1sj21o9"),m(Ne,"class","section-title svelte-1sj21o9"),m(Ht,"class","tool svelte-1sj21o9"),m(Ht,"title","Add node"),m(De,"d","M8 5v14l11-7z"),m(De,"fill","currentColor"),m(We,"viewBox","0 0 24 24"),m(We,"width","16"),m(We,"height","16"),m(He,"class","txt svelte-1sj21o9"),m(ne,"class","tool svelte-1sj21o9"),ne.disabled=n[8],m(ne,"title","Run pipeline"),m(It,"d","M12 3l9 5-9 5-9-5 9-5zm0 8l9 5-9 5-9-5"),m(It,"stroke","currentColor"),m(It,"stroke-width","2"),m(It,"fill","none"),m(It,"stroke-linejoin","round"),m(Le,"viewBox","0 0 24 24"),m(Le,"width","16"),m(Le,"height","16"),m(Ae,"class","txt svelte-1sj21o9"),m(we,"class","tool svelte-1sj21o9"),we.disabled=n[46].size===0,m(we,"title","Clear overlay layers"),m(Ce,"d","M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"),m(Ce,"stroke","currentColor"),m(Ce,"stroke-width","2"),m(Ce,"fill","none"),m(ui,"viewBox","0 0 24 24"),m(ui,"width","16"),m(ui,"height","16"),m(_i,"class","txt svelte-1sj21o9"),m(Re,"class","tool svelte-1sj21o9"),m(Re,"title","Toggle theme"),m(Kt,"class","tool-list svelte-1sj21o9"),m(be,"class","section"),m(yi,"class","section-title svelte-1sj21o9"),m(Ci,"class","edge-chips svelte-1sj21o9"),m(Ve,"class","section"),m(pi,"d","M6 6h12v12H6zM9 3h6M3 9h6M15 21h6M3 15h6"),m(pi,"stroke","currentColor"),m(pi,"stroke-width","2"),m(pi,"fill","none"),m(pi,"stroke-linecap","round"),m(ni,"viewBox","0 0 24 24"),m(ni,"width","16"),m(ni,"height","16"),m(pt,"class","txt svelte-1sj21o9"),m(kt,"class","pill-x svelte-1sj21o9"),m(kt,"title","Refresh"),m(ii,"class","section-title svelte-1sj21o9"),m(ei,"class","section"),m(Wt,"class","sidebar svelte-1sj21o9"),m(Wt,"data-collapsed",A=n[9]?"true":"false"),m(me,"class","split-left svelte-1sj21o9"),ht(me,"width",n[14]+"%"),m(si,"class","split-handle svelte-1sj21o9"),m(si,"role","separator"),m(si,"aria-orientation","vertical"),m(si,"aria-label","Resize split"),m(Ki,"class","map svelte-1sj21o9"),m(Hi,"class","split-right svelte-1sj21o9"),m(Yt,"class","split-container svelte-1sj21o9"),m(oe,"class","work svelte-1sj21o9"),m(Ot,"class","main svelte-1sj21o9"),m(Ot,"data-collapsed",Di=n[9]?"true":"false"),m(se,"class","logs-title svelte-1sj21o9"),m(Ge,"class","icon-btn svelte-1sj21o9"),m(Ge,"title","Copy all"),m(Rt,"class","icon-btn svelte-1sj21o9"),m(Rt,"title","Clear"),m(ji,"class","icon-btn svelte-1sj21o9"),m(ji,"title","Close"),m(ri,"class","logs-actions svelte-1sj21o9"),m(Bt,"class","logs-header svelte-1sj21o9"),m(ai,"class","logs-body svelte-1sj21o9"),m(mt,"class","logs-drawer svelte-1sj21o9"),m(mt,"data-open",sn=n[4]?"true":"false"),m(e,"class","app-root svelte-1sj21o9")},m(nt,gt){et(nt,e,gt),w(e,o),w(o,a),w(a,i),w(a,r),w(a,l),w(o,c),w(o,u),w(o,f),w(o,p),w(p,g),w(g,y),w(y,k),w(g,M),w(g,C),w(p,z),w(p,T),w(p,x),w(p,j),w(p,F),w(p,W),w(p,Y),w(p,st),w(p,ot),w(p,$),w($,ct),w(ct,N),w($,lt),w($,V),w(p,yt),w(p,_t),w(p,U),w(p,Z),w(p,St),w(p,at),w(p,Mt),w(p,Ct),w(Ct,wt),w(wt,H),w(wt,q),w(Ct,X),w(Ct,I),w(p,$t),w(p,dt),w(dt,Dt),w(Dt,zt),w(dt,xt),w(dt,le),w(le,pe),w(p,it),w(p,te),w(e,Qt),w(e,Ot),w(Ot,Wt),w(Wt,be),w(be,Ne),w(be,fe),w(be,Kt),w(Kt,Ht),w(Kt,Jt),w(Kt,ne),w(ne,We),w(We,De),w(ne,ze),w(ne,He),w(He,$e),w(Kt,vi),w(Kt,we),w(we,Le),w(Le,It),w(we,fi),w(we,Ae),w(Kt,ci),w(Kt,Re),w(Re,ui),w(ui,Ce),w(Re,ti),w(Re,_i),w(_i,_e),w(_i,ce),w(Wt,je),w(Wt,Ve),w(Ve,yi),w(Ve,Si),w(Ve,Ci),bi.m(Ci,null),w(Ve,Je),li&&li.m(Ve,null),w(Wt,Pt),w(Wt,ei),w(ei,ii),w(ii,ni),w(ni,pi),w(ii,b),w(ii,pt),w(ii,Et),w(ii,kt),w(ei,At),Ai.m(ei,null),w(Ot,Xt),w(Ot,oe),w(oe,Yt),w(Yt,me),ee(Fe,me,null),n[87](me),w(Yt,oi),w(Yt,si),w(Yt,Zi),w(Yt,Hi),w(Hi,Ki),n[88](Ki),n[89](Hi),w(e,Oi),mi&&mi.m(e,null),w(e,Yi),wi&&wi.m(e,null),w(e,on),w(e,mt),w(mt,Bt),w(Bt,se),w(Bt,Pi),w(Bt,ri),w(ri,Ge),w(ri,Te),w(ri,Rt),w(ri,xe),w(ri,ji),w(mt,Ji),w(mt,ai),rt.m(ai,null),Ye=!0,Ii||(Ue=[ft(i,"click",n[47]),ft(g,"click",n[37]),ft(T,"click",n[64]),ft(j,"click",n[65]),ft(W,"click",n[54]),ft(st,"click",n[69]),ft($,"click",n[49]),ft(_t,"click",n[60]),ft(Z,"click",n[61]),ft(at,"click",n[62]),ft(Ct,"click",n[63]),ft(dt,"click",n[70]),ft(te,"click",n[38]),ft(Ht,"click",n[38]),ft(ne,"click",n[37]),ft(we,"click",n[49]),ft(Re,"click",n[71]),ft(kt,"click",n[56]),ft(si,"mousedown",n[45]),ft(Ge,"click",n[109]),ft(Rt,"click",n[110]),ft(ji,"click",n[111])],Ii=!0)},p(nt,gt){(!Ye||gt[0]&256&&D!==(D=nt[8]?"Running":"Run pipeline"))&&m(g,"title",D),(!Ye||gt[0]&256)&&(g.disabled=nt[8]),(!Ye||gt[0]&131072&&Ft!==(Ft=nt[17]?"3D mode ON":"3D mode OFF"))&&m(Ct,"title",Ft),(!Ye||gt[0]&131072)&&Vt(Ct,"primary",nt[17]),(!Ye||gt[0]&1)&&ue!==(ue=nt[0]==="dark"?"Dark":"Light")&&Ei(pe,ue),(!Ye||gt[0]&256)&&he!==(he=nt[8]?"Running":"Run")&&Ei($e,he),(!Ye||gt[0]&256)&&(ne.disabled=nt[8]),(!Ye||gt[0]&1)&&Ei(ce,nt[0]),Gi===(Gi=Fi(nt))&&bi?bi.p(nt,gt):(bi.d(1),bi=Gi(nt),bi&&(bi.c(),bi.m(Ci,null))),nt[5]?li?li.p(nt,gt):(li=Ca(nt),li.c(),li.m(Ve,null)):li&&(li.d(1),li=null),hn===(hn=Ui(nt))&&Ai?Ai.p(nt,gt):(Ai.d(1),Ai=hn(nt),Ai&&(Ai.c(),Ai.m(ei,null))),(!Ye||gt[0]&512&&A!==(A=nt[9]?"true":"false"))&&m(Wt,"data-collapsed",A);const vt={};gt[0]&4096&&(vt.width=nt[12]),gt[0]&8192&&(vt.height=nt[13]),gt[0]&1&&(vt.theme=nt[0]),gt[0]&13438|gt[5]&512&&(vt.$$scope={dirty:gt,ctx:nt}),Fe.$set(vt),(!Ye||gt[0]&16384)&&ht(me,"width",nt[14]+"%"),(!Ye||gt[0]&512&&Di!==(Di=nt[9]?"true":"false"))&&m(Ot,"data-collapsed",Di),nt[18]?mi?mi.p(nt,gt):(mi=Aa(nt),mi.c(),mi.m(e,Yi)):mi&&(mi.d(1),mi=null),nt[23]?wi?wi.p(nt,gt):(wi=Ba(nt),wi.c(),wi.m(e,on)):wi&&(wi.d(1),wi=null),tt===(tt=E(nt))&&rt?rt.p(nt,gt):(rt.d(1),rt=tt(nt),rt&&(rt.c(),rt.m(ai,null))),(!Ye||gt[0]&16&&sn!==(sn=nt[4]?"true":"false"))&&m(mt,"data-open",sn)},i(nt){Ye||(B(Fe.$$.fragment,nt),Ye=!0)},o(nt){G(Fe.$$.fragment,nt),Ye=!1},d(nt){nt&&Q(e),bi.d(),li&&li.d(),Ai.d(),ie(Fe),n[87](null),n[88](null),n[89](null),mi&&mi.d(),wi&&wi.d(),rt.d(),Ii=!1,hi(Ue)}}}const fl=230,_l=80,ff=10,Ha=10,_f=3.5;function pf(n){const e=[];if(!n||typeof n!="object")return e;for(const[o,a]of Object.entries(n))typeof a=="string"?e.push({key:o,label:o,type:"string"}):typeof a=="number"?e.push({key:o,label:o,type:"number"}):typeof a=="boolean"?e.push({key:o,label:o,type:"boolean"}):Array.isArray(a)?e.push({key:o,label:o,type:"array",itemType:typeof a[0]=="number"?"number":"string"}):e.push({key:o,label:o,type:"textarea"});return e}function mf(n,e){const o=n.map(u=>u.id),a=new Set(o),i=new Map,r=new Map;for(const u of o)i.set(u,[]),r.set(u,0);for(const u of e)!a.has(u.source)||!a.has(u.target)||(i.get(u.source).push(u.target),r.set(u.target,(r.get(u.target)||0)+1));const l=[];for(const u of o)(r.get(u)||0)===0&&l.push(u);const c=[];for(;l.length;){const u=l.shift();c.push(u);for(const f of i.get(u))r.set(f,(r.get(f)||0)-1),(r.get(f)||0)===0&&l.push(f)}return c}async function ja(n,e={}){return await(await fetch("/run_node",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nodeId:n.id,type:n.type,args:n.args??{},inputs:e})})).json().catch(()=>({ok:!1,error:"Bad JSON"}))}function Fa(n){return n.rows??6}function Ga(n){return n.placeholder??""}function Ua(n){return n.hint??"comma-separated"}function Wa(n){return n.itemType??"values"}function Va(n){return n.options??[]}function Ya(n){return n?new Date(n).toLocaleString():""}async function gf(n){await fetch(`/pipeline/schedules/${n}/run-now`,{method:"POST"}).catch(()=>{})}function vf(n,e,o){let a="dark",i=[],r=1,l=[],c=1,u=null,f={},p=[{name:"hello",default_args:{name:"world"}},{name:"sum",default_args:{nums:[1,2,3]}},{name:"script",default_args:{code:"print('hello')"}},{name:"raster.input",default_args:{path:""}}];qi(async()=>{try{const tt=await(await fetch("/node_types")).json();Array.isArray(tt==null?void 0:tt.types)&&o(6,p=tt.types)}catch{}});const g={hello:[{key:"name",label:"Name",type:"string",placeholder:"world"}],sum:[{key:"nums",label:"Numbers",type:"array",itemType:"number",hint:"e.g., 1,2,3"}],script:[{key:"code",label:"Code",type:"textarea",rows:8,placeholder:"print('hello')"}],"raster.input":[{key:"path",label:"Raster path",type:"string",placeholder:"/path/to.tif"}]};function y(E){var nt;const tt=g[E];if(tt)return tt;const rt=(nt=p.find(gt=>gt.name===E))==null?void 0:nt.default_args;return pf(rt??{})}const k=E=>i.find(tt=>tt.id===E);function M(E,tt){!k(E)||!k(tt)||E===tt||l.some(rt=>rt.source===E&&rt.target===tt)||o(2,l=[...l,{id:`e${c++}`,source:E,target:tt}])}function C(E){o(2,l=l.filter(tt=>tt.id!==E))}function D(E){if(Ft.has(E)&&I&&$t){const tt=Ft.get(E);I.removeLayer(tt),$t.removeLayer(tt),Ft.delete(E)}o(1,i=i.filter(tt=>tt.id!==E)),delete f[E]}function z(){const E=new Set;for(const gt of l)E.add(gt.source),E.add(gt.target);const tt=i.filter(gt=>E.has(gt.id)),rt=new Set(tt.map(gt=>gt.id)),nt=l.filter(gt=>rt.has(gt.source)&&rt.has(gt.target));return{activeNodes:tt,activeEdges:nt}}let T=[],x=!1,j={},F=!1,W=!1;function Y(E,tt,rt){o(7,T=[...T,{nodeId:E,ok:tt,text:rt}]),F&&requestAnimationFrame(()=>{const nt=document.querySelector(".logs-body");nt&&(nt.scrollTop=nt.scrollHeight)})}async function st(){var gt;o(8,x=!0),o(7,T=[]),j={},o(4,F=!0);const{activeNodes:E,activeEdges:tt}=z();if(E.length===0){Y("system",!1,"No connected nodes to run."),o(8,x=!1);return}const rt=mf(E,tt);rt.length!==E.length&&Y("system",!1,"Warning: cycle detected; running partial order.");const nt={};for(const vt of tt)(nt[gt=vt.target]??(nt[gt]=[])).push(vt.source);for(const vt of rt){const Xe=k(vt),jt={};for(const Zt of nt[vt]??[])jt[Zt]=j[Zt];Y(vt,!0," Running");try{const Zt=await ja(Xe,jt);if(Array.isArray(Zt==null?void 0:Zt.logs))for(const qe of Zt.logs)Y(vt,!0,String(qe));if(typeof(Zt==null?void 0:Zt.stdout)=="string"&&Zt.stdout.trim())for(const qe of Zt.stdout.split(/\r?\n/))qe.trim()&&Y(vt,!0,qe);if(Zt!=null&&Zt.ok){const qe=Zt.output??{};j[vt]=qe;const xi=typeof qe=="string"?qe:qe.text??JSON.stringify(qe);Y(vt,!0,` ${xi}`)}else Y(vt,!1,` ${(Zt==null?void 0:Zt.error)||"Unknown error"}`)}catch(Zt){Y(vt,!1,` Exception: ${(Zt==null?void 0:Zt.message)||Zt}`)}}o(8,x=!1)}function ot(){const E=`n${r++}`,tt=p[0]||{name:"hello",default_args:{name:E}},rt=120+i.length%6*260,nt=140+Math.floor(i.length/6)*140,gt=JSON.parse(JSON.stringify(tt.default_args||{})),vt=`${tt.name} (${E})`;o(1,i=[...i,{id:E,position:{x:rt,y:nt},label:vt,type:tt.name,args:gt}]),o(3,f[E]=JSON.stringify(gt,null,2),f)}function $(E){o(5,u=E)}function ct(E){u&&M(u,E),o(5,u=null)}function N(){o(5,u=null)}const lt=E=>E.position.x,V=E=>E.position.x+fl,yt=E=>E.position.y+_l/2;let _t="",U=null,Z=1200,St=650,at=null;function Mt(){U&&(at&&at.disconnect(),at=new ResizeObserver(()=>{U&&(o(12,Z=Math.max(320,Math.floor(U.clientWidth-1))),o(13,St=Math.max(240,Math.floor(U.clientHeight-1))))}),at.observe(U))}let Ct=60,wt=!1;function H(E){wt=!0,E.preventDefault()}function q(E){if(!wt||!U||!U.parentElement)return;const rt=U.parentElement.getBoundingClientRect(),nt=E.clientX-rt.left,gt=Math.max(20,Math.min(80,nt/rt.width*100));o(14,Ct=gt)}function X(){wt=!1}qi(()=>(window.addEventListener("mousemove",q),window.addEventListener("mouseup",X),()=>{window.removeEventListener("mousemove",q),window.removeEventListener("mouseup",X)}));let I=null,Ft=new Map,$t=null,dt=null,Dt=null,zt=null,xt=null,le=null,ue=!1,pe=null,it=null;const te={r:100,g:100,b:120};function Qt(){!I||!Dt||(zt&&zt.disconnect(),zt=new ResizeObserver(()=>{requestAnimationFrame(()=>I&&I.invalidateSize())}),zt.observe(Dt))}function Ot(){o(9,W=!W),requestAnimationFrame(()=>I==null?void 0:I.invalidateSize())}qi(()=>{let E=!1;const tt=()=>I&&I.invalidateSize();return Promise.resolve().then(async()=>{if(await $a(),!E&&(Mt(),!I&&dt)){I=Bi.map(dt,{zoomControl:!0,attributionControl:!1}).setView([0,0],2);const rt={" OpenStreetMap":Bi.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{opacity:.9,minZoom:1,maxZoom:22,attribution:" OpenStreetMap contributors"})," OSM (Dark-ish)":Bi.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",{opacity:.95,minZoom:1,maxZoom:22,attribution:" OpenStreetMap,  CartoDB"})," Esri World Imagery":Bi.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{opacity:1,minZoom:1,maxZoom:19,attribution:"Tiles  Esri"})," Carto Positron":Bi.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{opacity:.95,minZoom:1,maxZoom:22,attribution:" OpenStreetMap,  CartoDB"})," OpenTopoMap":Bi.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{opacity:.95,minZoom:1,maxZoom:17,attribution:" OpenStreetMap,  OpenTopoMap"})};rt[" Esri World Imagery"].addTo(I),$t=Bi.control.layers(rt,{},{position:"topright",collapsed:!1}),$t.addTo(I),xt=new Bi.FeatureGroup,I.addLayer(xt),le=new Bi.Control.Draw({edit:{featureGroup:xt},draw:{polygon:!0,polyline:!0,rectangle:!0,circle:!0,marker:!0,circlemarker:!1}}),I.addControl(le),I.on(Bi.Draw.Event.CREATED,nt=>{const gt=nt.layer;xt==null||xt.addLayer(gt),Y("vector",!0,`Created ${nt.layerType}`)}),Qt(),window.addEventListener("resize",tt)}}),()=>{E=!0,window.removeEventListener("resize",tt),zt==null||zt.disconnect(),at==null||at.disconnect()}});function Wt(E,tt){var nt;const rt=j[E.id];return rt&&typeof rt=="object"&&rt.type==="raster"&&rt.path?rt.path:E.type==="raster.input"&&typeof((nt=i[tt].args)==null?void 0:nt.path)=="string"?i[tt].args.path:null}async function be(E,tt){if(!I||!$t){alert("Map not ready yet.");return}const rt=Wt(E,tt);if(!rt){alert("No raster path available. Run the pipeline or set args.path for raster.input.");return}const nt=E.id;await fetch("/preview/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:nt,path:rt})});const gt=`/preview/tile/${nt}/{z}/{x}/{y}.png`,vt=`${E.label} (${E.id})`;if(Ft.has(nt)){const jt=Ft.get(nt);I.removeLayer(jt),$t.removeLayer(jt),Ft.delete(nt)}const Xe=Bi.tileLayer(gt,{tms:!1,opacity:.8,maxZoom:22});Ft.set(nt,Xe),Xe.addTo(I),$t.addOverlay(Xe,vt);try{const jt=await fetch(`/preview/bounds/${nt}`).then(yn=>yn.json()),[Zt,qe,xi,rn]=jt.bounds,Qi=Bi.latLngBounds([qe,Zt],[rn,xi]);I.fitBounds(Qi,{padding:[10,10],animate:!0})}catch(jt){console.warn("Failed to get bounds for zoom:",jt)}}function Ne(){if(!(!I||!$t)){for(const[,E]of Ft)I.removeLayer(E),$t.removeLayer(E);Ft.clear()}}let fe=null,Kt="",Ht=[],Jt={},ne=!1;function We(E){var nt;o(18,fe=E),o(20,Ht=y(E.type)),o(21,Jt={});const rt={...((nt=p.find(gt=>gt.name===E.type))==null?void 0:nt.default_args)??{},...E.args??{}};for(const gt of Ht)o(21,Jt[gt.key]=rt[gt.key],Jt);o(19,Kt=JSON.stringify(E.args??{},null,2)),o(22,ne=!1)}function De(){if(!fe)return;const E={};for(const tt of Ht){let rt=Jt[tt.key];if(tt.type==="number"&&(rt=Number(rt)),tt.type==="array"){if(Array.isArray(rt))E[tt.key]=rt;else if(typeof rt=="string"){const nt=rt.split(",").map(gt=>gt.trim()).filter(Boolean);E[tt.key]=tt.itemType==="number"?nt.map(Number):nt}else E[tt.key]=[];continue}tt.type==="boolean"&&(rt=!!rt),E[tt.key]=rt}o(18,fe.args=E,fe),o(3,f[fe.id]=JSON.stringify(E,null,2),f)}function ze(){if(fe)if(ne)try{const E=JSON.parse(Kt||"{}");o(18,fe.args=E,fe),o(3,f[fe.id]=JSON.stringify(E,null,2),f),o(18,fe=null)}catch{alert("Invalid JSON")}else De(),o(18,fe=null)}const He=E=>{const tt=i.find(rt=>rt.id===E);if(!tt)throw new Error(`Node not found: ${E}`);return tt};let he=null;async function $e(E){o(4,F=!0),o(7,T=[]),await vi(E),he&&clearInterval(he),o(66,he=setInterval(()=>vi(E),1e3))}async function vi(E){try{const tt=await fetch(`/pipeline/schedules/${E}/runs`).then(gt=>gt.json());if(!Array.isArray(tt)||tt.length===0){o(7,T=[{nodeId:"system",ok:!0,text:"(no runs yet)"}]);return}const rt=tt[0],nt=await fetch(`/pipeline/schedules/runs/${rt.id}`).then(gt=>gt.json());o(7,T=nt.logs.map(gt=>({nodeId:nt.status==="running"?"run":nt.status==="success"?"ok":"err",ok:!/|exception/i.test(gt),text:gt}))),nt.status!=="running"&&he&&(clearInterval(he),o(66,he=null))}catch{o(7,T=[{nodeId:"system",ok:!1,text:"Failed to fetch run logs"}])}}oo(()=>{he&&clearInterval(he)});let we=!1,Le="once",It="",fi=0,Ae=0,ci=0,Re="0 5 * * *",ui=!1,Ce="",ti=[];function _i(){const{activeNodes:E}=z();if(E.length===0){alert("No connected nodes to schedule. Connect nodes with edges first.");return}o(23,we=!0),o(24,Le="once"),o(25,It=""),o(26,fi=o(27,Ae=o(28,ci=0))),o(29,Re="0 5 * * *"),o(31,Ce="")}function _e(){const{activeNodes:E,activeEdges:tt}=z(),rt=E.map(gt=>({id:gt.id,type:gt.type,args:gt.args??{}})),nt=tt.map(gt=>({source:gt.source,target:gt.target}));return{nodes:rt,edges:nt}}async function ce(){const E=_e();if(E.nodes.length===0){o(31,Ce="Nothing to schedule (empty graph).");return}const tt={mode:Le,graph:E};if(Le==="once"){if(!It){o(31,Ce="Please pick a date & time.");return}tt.run_at=new Date(It).toISOString()}else if(Le==="interval"){if(tt.hours=Number(fi)||0,tt.minutes=Number(Ae)||0,tt.seconds=Number(ci)||0,!(tt.hours||tt.minutes||tt.seconds)){o(31,Ce="Interval must be > 0.");return}}else if(tt.cron=(Re||"").trim(),!tt.cron){o(31,Ce="Cron expression is required.");return}o(30,ui=!0),o(31,Ce="");try{const rt=await fetch("/pipeline/schedules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(tt)});if(!rt.ok)throw new Error(`HTTP ${rt.status}`);await rt.json(),o(23,we=!1),await je()}catch(rt){o(31,Ce=`Failed to create schedule: ${(rt==null?void 0:rt.message)||rt}`)}finally{o(30,ui=!1)}}async function je(){try{const E=await fetch("/pipeline/schedules");if(E.ok){o(32,ti=await E.json());return}}catch{}try{const E=await fetch("/schedules");E.ok&&o(32,ti=await E.json())}catch{}}async function Ve(E){await fetch(`/pipeline/schedules/${E}`,{method:"DELETE"}).catch(()=>{}),await je()}async function yi(E){await fetch(`/pipeline/schedules/${E}/pause`,{method:"POST"}).catch(()=>{}),await je()}async function Si(E){await fetch(`/pipeline/schedules/${E}/resume`,{method:"POST"}).catch(()=>{}),await je()}qi(async()=>{await je().catch(()=>{})});async function Ci(){const E=document.createElement("input");E.type="file",E.accept=".zip",E.onchange=async tt=>{var nt,gt;const rt=(nt=tt.target.files)==null?void 0:nt[0];if(rt)try{const vt=new FormData;vt.append("file",rt);const Xe=await fetch("/vector/upload",{method:"POST",body:vt});if(!Xe.ok)throw new Error(`HTTP ${Xe.status}`);const jt=await Xe.json();if(I&&xt){const Zt=Bi.geoJSON(jt,{style:{color:"#3388ff",weight:2,opacity:.8,fillOpacity:.3}});Zt.eachLayer(xi=>{xt==null||xt.addLayer(xi)});const qe=Zt.getBounds();qe.isValid()&&I.fitBounds(qe,{padding:[20,20]}),Y("vector",!0,`Loaded shapefile with ${((gt=jt.features)==null?void 0:gt.length)||0} features`),o(4,F=!0)}}catch(vt){const Xe=vt instanceof Error?vt.message:String(vt);alert(`Failed to load shapefile: ${Xe}`),Y("vector",!1,`Failed to load shapefile: ${Xe}`),o(4,F=!0)}},E.click()}async function Je(){if(!xt||xt.getLayers().length===0){alert("No vector data to save. Draw some features on the map first.");return}try{const E=xt.toGeoJSON(),tt=prompt("Enter filename (without extension):","vector_data");if(!tt)return;const rt=await fetch("/vector/save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({geojson:E,filename:tt})});if(!rt.ok)throw new Error(`HTTP ${rt.status}`);const nt=await rt.blob(),gt=URL.createObjectURL(nt),vt=document.createElement("a");vt.href=gt,vt.download=`${tt}.zip`,vt.click(),URL.revokeObjectURL(gt),Y("vector",!0,`Saved ${xt.getLayers().length} features as shapefile`),o(4,F=!0)}catch(E){const tt=E instanceof Error?E.message:String(E);alert(`Failed to save shapefile: ${tt}`),Y("vector",!1,`Failed to save shapefile: ${tt}`),o(4,F=!0)}}function Pt(){xt&&(xt.clearLayers(),Y("vector",!0,"Cleared all vector data"),o(4,F=!0))}function ei(){if(I)if(o(17,ue=!ue),ue){const E=I.getZoom();pe=Bi.tileLayer("https://tiles.wmflabs.org/hillshading/{z}/{x}/{y}.png",{opacity:.4,maxZoom:18,attribution:" OpenStreetMap contributors, Hillshading: Colin Marquardt"}),pe.addTo(I),E>=15&&ii(),I.on("moveend",ii),Y("3d",!0,"3D mode enabled - Terrain hillshading and buildings layer active"),o(4,F=!0)}else pe&&I&&(I.removeLayer(pe),pe=null),it&&I&&(I.removeLayer(it),it=null),I.off("moveend",ii),Y("3d",!0,"3D mode disabled"),o(4,F=!0)}async function ii(){if(!I||!ue||I.getZoom()<15)return;const tt=I.getBounds(),rt=`${tt.getSouth()},${tt.getWest()},${tt.getNorth()},${tt.getEast()}`;try{const nt=`[out:json][timeout:${ff}];(way["building"](${rt}););out geom;`,gt=`https://overpass-api.de/api/interpreter?data=${encodeURIComponent(nt)}`,vt=await fetch(gt);if(!vt.ok)return;const Xe=await vt.json();it&&I&&(I.removeLayer(it),it=null);const jt=Xe.elements.filter(Zt=>Zt.type==="way").map(Zt=>{var rn,Qi;const qe=Zt.geometry.map(yn=>[yn.lon,yn.lat]);let xi=Ha;return(rn=Zt.tags)!=null&&rn.height&&parseFloat(Zt.tags.height)>0?xi=parseFloat(Zt.tags.height):(Qi=Zt.tags)!=null&&Qi["building:levels"]&&parseInt(Zt.tags["building:levels"])>0&&(xi=parseInt(Zt.tags["building:levels"])*_f),{type:"Feature",properties:{height:xi},geometry:{type:"Polygon",coordinates:[qe]}}});jt.length>0&&(it=Bi.geoJSON({type:"FeatureCollection",features:jt},{style:Zt=>{var rn;const qe=((rn=Zt==null?void 0:Zt.properties)==null?void 0:rn.height)||Ha,xi=Math.max(.3,Math.min(1,qe/50));return{fillColor:`rgba(${te.r}, ${te.g}, ${te.b}, ${xi})`,color:"#444",weight:1,fillOpacity:.7,className:"buildings-3d"}}}),it.addTo(I))}catch(nt){console.warn("Failed to fetch buildings:",nt)}}function ni(){const E={nodes:i.map(vt=>({id:vt.id,position:vt.position,label:vt.label,type:vt.type,args:vt.args})),edges:l.map(vt=>({id:vt.id,source:vt.source,target:vt.target}))},tt=JSON.stringify(E,null,2),rt=new Blob([tt],{type:"application/json"}),nt=URL.createObjectURL(rt),gt=document.createElement("a");gt.href=nt,gt.download=`saterys-workflow-${new Date().toISOString().replace(/:/g,"-").split(".")[0]}.json`,gt.click(),URL.revokeObjectURL(nt)}function pi(){const E=document.createElement("input");E.type="file",E.accept=".json",E.onchange=async tt=>{var nt;const rt=(nt=tt.target.files)==null?void 0:nt[0];if(rt)try{const gt=await rt.text(),vt=JSON.parse(gt);if(!vt.nodes||!Array.isArray(vt.nodes)){alert("Invalid workflow file: missing nodes array");return}o(1,i=[]),o(2,l=[]),o(3,f={}),Ne(),o(1,i=vt.nodes.map(jt=>({id:jt.id||`n${r++}`,position:jt.position||{x:100,y:100},label:jt.label||"unknown",type:jt.type||"hello",args:jt.args||{}}))),r=Math.max(...i.map(jt=>{const Zt=jt.id.match(/^n(\d+)$/);return Zt?parseInt(Zt[1]):0}),0)+1,vt.edges&&Array.isArray(vt.edges)&&(o(2,l=vt.edges.map(Zt=>({id:Zt.id||`e${c++}`,source:Zt.source,target:Zt.target}))),c=Math.max(...l.map(Zt=>{const qe=Zt.id.match(/^e(\d+)$/);return qe?parseInt(qe[1]):0}),0)+1);for(const jt of i)o(3,f[jt.id]=JSON.stringify(jt.args||{},null,2),f);Y("system",!0,`Loaded workflow with ${i.length} nodes and ${l.length} edges`),o(4,F=!0)}catch(gt){alert(`Failed to load workflow: ${gt instanceof Error?gt.message:String(gt)}`)}},E.click()}function b(E){Ke.call(this,n,E)}function pt(E){Ke.call(this,n,E)}const Et=()=>o(4,F=!F),kt=()=>o(0,a=a==="dark"?"light":"dark"),At=()=>o(0,a=a==="dark"?"light":"dark"),A=E=>C(E.id),Xt=E=>{gf(E.id),$e(E.id)},oe=E=>yi(E.id),Yt=E=>Si(E.id),me=E=>$e(E.id),Fe=E=>Ve(E.id),oi=E=>ct(E.id),si=E=>$(E.id),Zi=E=>D(E.id);function Hi(E){i[E].type=Go(this),o(1,i),o(6,p)}const Ki=(E,tt)=>{const rt=p.find(gt=>gt.name===i[E].type),nt=(rt==null?void 0:rt.default_args)??{};o(1,i[E].args=JSON.parse(JSON.stringify(nt)),i),o(1,i[E].label=`${i[E].type} (${tt.id})`,i),o(3,f[tt.id]=JSON.stringify(i[E].args,null,2),f)},Di=E=>We(E),Oi=(E,tt)=>be(E,tt),Yi=async E=>{var tt;try{const rt=await ja(E,{});o(4,F=!0),Y(E.id,!!(rt!=null&&rt.ok),rt!=null&&rt.ok?((tt=rt==null?void 0:rt.output)==null?void 0:tt.message)||"Started":(rt==null?void 0:rt.error)||"Error")}catch(rt){Y(E.id,!1,`Exception: ${typeof rt=="object"&&rt!==null&&"message"in rt?rt.message:String(rt)}`),o(4,F=!0)}};function on(E,tt){n.$$.not_equal(i[tt].position,E)&&(i[tt].position=E,o(1,i))}function mt(E){nn[E?"unshift":"push"](()=>{U=E,o(11,U)})}function Bt(E){nn[E?"unshift":"push"](()=>{dt=E,o(15,dt)})}function se(E){nn[E?"unshift":"push"](()=>{Dt=E,o(16,Dt)})}const Pi=()=>o(18,fe=null),ri=()=>o(22,ne=!1),Ge=()=>o(22,ne=!0);function Te(E){Jt[E.key]=this.value,o(21,Jt),o(20,Ht)}function Rt(E){Jt[E.key]=Ln(this.value),o(21,Jt),o(20,Ht)}function xe(E){Jt[E.key]=this.checked,o(21,Jt),o(20,Ht)}function ji(E){Jt[E.key]=this.value,o(21,Jt),o(20,Ht)}function Ji(E){Jt[E.key]=this.value,o(21,Jt),o(20,Ht)}function ai(E){Jt[E.key]=Go(this),o(21,Jt),o(20,Ht)}function sn(){Kt=this.value,o(19,Kt)}const Ye=()=>o(18,fe=null),Ii=()=>o(23,we=!1);function Ue(){Le=Go(this),o(24,Le)}function Fi(){It=this.value,o(25,It)}function Gi(){fi=Ln(this.value),o(26,fi)}function bi(){Ae=Ln(this.value),o(27,Ae)}function li(){ci=Ln(this.value),o(28,ci)}function Ui(){Re=this.value,o(29,Re)}const hn=()=>o(23,we=!1),Ai=()=>navigator.clipboard.writeText(T.map(E=>`[${E.nodeId}] ${E.ok?"OK":"ERR"} ${E.text}`).join(`
`)),mi=()=>o(7,T=[]),wi=()=>o(4,F=!1);return n.$$.update=()=>{if(n.$$.dirty[0]&1&&document!=null&&document.body&&(document.body.dataset.theme=a),n.$$.dirty[0]&10){for(const E of i)if(f[E.id]===void 0)try{o(3,f[E.id]=JSON.stringify(E.args??{},null,2),f)}catch{o(3,f[E.id]="{}",f)}}if(n.$$.dirty[0]&6){const E=new Set(i.map(rt=>rt.id)),tt=l.filter(rt=>E.has(rt.source)&&E.has(rt.target));tt.length!==l.length&&o(2,l=tt)}n.$$.dirty[0]&2&&o(10,_t=i.map(E=>`${E.id}:${E.position.x},${E.position.y}`).join("|")),n.$$.dirty[0]&16|n.$$.dirty[2]&16&&!F&&he&&(clearInterval(he),o(66,he=null))},[a,i,l,f,F,u,p,T,x,W,_t,U,Z,St,Ct,dt,Dt,ue,fe,Kt,Ht,Jt,ne,we,Le,It,fi,Ae,ci,Re,ui,Ce,ti,k,C,D,Y,st,ot,$,ct,N,lt,V,yt,H,Ft,Ot,be,Ne,We,ze,He,$e,_i,ce,je,Ve,yi,Si,Ci,Je,Pt,ei,ni,pi,he,b,pt,Et,kt,At,A,Xt,oe,Yt,me,Fe,oi,si,Zi,Hi,Ki,Di,Oi,Yi,on,mt,Bt,se,Pi,ri,Ge,Te,Rt,xe,ji,Ji,ai,sn,Ye,Ii,Ue,Fi,Gi,bi,li,Ui,hn,Ai,mi,wi]}class yf extends Mi{constructor(e){super(),ki(this,e,vf,df,di,{},null,[-1,-1,-1,-1,-1,-1])}}new yf({target:document.getElementById("app")});export{oo as $,ie as A,el as B,il as C,ee as D,ae as E,Lt as F,hi as G,Ei as H,en as I,Ze as J,Yo as K,ke as L,Pe as M,Ee as N,Me as O,Qs as P,Vi as Q,ec as R,Mi as S,Be as T,Ln as U,jn as V,Xi as W,Sn as X,Go as Y,J as Z,nn as _,ht as a,Mo as a0,qt as a1,fn as a2,Co as a3,et as b,m as c,Q as d,S as e,bt as f,gi as g,Se as h,ki as i,G as j,B as k,ft as l,ve as m,Gt as n,qi as o,io as p,ye as q,w as r,di as s,Vt as t,vn as u,K as v,de as w,To as x,Ie as y,ss as z};
