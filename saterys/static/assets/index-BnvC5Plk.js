const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Controls-WC3I_igS.js","assets/Icon-BYTN2NOV.js","assets/DrawerController-D9M15AZT.js","assets/DrawerController-ZXfKNTdC.css"])))=>i.map(i=>d[i]);
var _u=Object.defineProperty;var mu=(n,e,i)=>e in n?_u(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i;var is=(n,e,i)=>mu(n,typeof e!="symbol"?e+"":e,i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function i(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=i(r);fetch(r.href,a)}})();function Ht(){}function bs(n,e){for(const i in e)n[i]=e[i];return n}function aa(n){return n()}function er(){return Object.create(null)}function qe(n){n.forEach(aa)}function ho(n){return typeof n=="function"}function pn(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function pu(n){return Object.keys(n).length===0}function yn(n,...e){if(n==null){for(const s of e)s(void 0);return Ht}const i=n.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function bt(n){let e;return yn(n,i=>e=i)(),e}function gt(n,e,i){n.$$.on_destroy.push(yn(e,i))}function ke(n,e,i,s){if(n){const r=ua(n,e,i,s);return n[0](r)}}function ua(n,e,i,s){return n[1]&&s?bs(i.ctx.slice(),n[1](s(e))):i.ctx}function Pe(n,e,i,s){if(n[2]&&s){const r=n[2](s(i));if(e.dirty===void 0)return r;if(typeof r=="object"){const a=[],u=Math.max(e.dirty.length,r.length);for(let c=0;c<u;c+=1)a[c]=e.dirty[c]|r[c];return a}return e.dirty|r}return e.dirty}function Le(n,e,i,s,r,a){if(r){const u=ua(e,i,s,a);n.p(u,r)}}function Ce(n){if(n.ctx.length>32){const e=[],i=n.ctx.length/32;for(let s=0;s<i;s++)e[s]=-1;return e}return-1}function ws(n){const e={};for(const i in n)e[i]=!0;return e}function Ro(n){return n??""}function Bt(n,e,i){return n.set(i),e}function ki(n){return n&&ho(n.destroy)?n.destroy:Ht}const gu=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function y(n,e){n.appendChild(e)}function K(n,e,i){n.insertBefore(e,i||null)}function Y(n){n.parentNode&&n.parentNode.removeChild(n)}function Pi(n,e){for(let i=0;i<n.length;i+=1)n[i]&&n[i].d(e)}function T(n){return document.createElement(n)}function Qt(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function ge(n){return document.createTextNode(n)}function W(){return ge(" ")}function Ee(){return ge("")}function lt(n,e,i,s){return n.addEventListener(e,i,s),()=>n.removeEventListener(e,i,s)}function Yn(n){return function(e){return e.preventDefault(),n.call(this,e)}}function Un(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function ro(n){return function(e){e.target===this&&n.call(this,e)}}function m(n,e,i){i==null?n.removeAttribute(e):n.getAttribute(e)!==i&&n.setAttribute(e,i)}function wi(n){return n===""?null:+n}function vu(n){return Array.from(n.childNodes)}function sn(n,e){e=""+e,n.data!==e&&(n.data=e)}function pe(n,e){n.value=e??""}function at(n,e,i,s){i==null?n.style.removeProperty(e):n.style.setProperty(e,i,"")}function Gi(n,e,i){for(let s=0;s<n.options.length;s+=1){const r=n.options[s];if(r.__value===e){r.selected=!0;return}}(!i||e!==void 0)&&(n.selectedIndex=-1)}function os(n){const e=n.querySelector(":checked");return e&&e.__value}let No;function yu(){if(No===void 0){No=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{No=!0}}return No}function bu(n,e){getComputedStyle(n).position==="static"&&(n.style.position="relative");const s=T("iframe");s.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),s.setAttribute("aria-hidden","true"),s.tabIndex=-1;const r=yu();let a;return r?(s.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",a=lt(window,"message",u=>{u.source===s.contentWindow&&e()})):(s.src="about:blank",s.onload=()=>{a=lt(s.contentWindow,"resize",e),e()}),y(n,s),()=>{(r||a&&s.contentWindow)&&a(),Y(s)}}function Yt(n,e,i){n.classList.toggle(e,!!i)}function wu(n,e,{bubbles:i=!1,cancelable:s=!1}={}){return new CustomEvent(n,{detail:e,bubbles:i,cancelable:s})}function ci(n,e){return new n(e)}let uo;function lo(n){uo=n}function Ai(){if(!uo)throw new Error("Function called outside component initialization");return uo}function ku(n){Ai().$$.before_update.push(n)}function qn(n){Ai().$$.on_mount.push(n)}function ca(n){Ai().$$.after_update.push(n)}function fo(n){Ai().$$.on_destroy.push(n)}function ji(){const n=Ai();return(e,i,{cancelable:s=!1}={})=>{const r=n.$$.callbacks[e];if(r){const a=wu(e,i,{cancelable:s});return r.slice().forEach(u=>{u.call(n,a)}),!a.defaultPrevented}return!0}}function Ae(n,e){return Ai().$$.context.set(n,e),e}function de(n){return Ai().$$.context.get(n)}function We(n,e){const i=n.$$.callbacks[e.type];i&&i.slice().forEach(s=>s.call(this,e))}const Hi=[],Kn=[];let Fi=[];const _s=[],ha=Promise.resolve();let ms=!1;function fa(){ms||(ms=!0,ha.then(_a))}function da(){return fa(),ha}function Ei(n){Fi.push(n)}function Pu(n){_s.push(n)}const ss=new Set;let xi=0;function _a(){if(xi!==0)return;const n=uo;do{try{for(;xi<Hi.length;){const e=Hi[xi];xi++,lo(e),Lu(e.$$)}}catch(e){throw Hi.length=0,xi=0,e}for(lo(null),Hi.length=0,xi=0;Kn.length;)Kn.pop()();for(let e=0;e<Fi.length;e+=1){const i=Fi[e];ss.has(i)||(ss.add(i),i())}Fi.length=0}while(Hi.length);for(;_s.length;)_s.pop()();ms=!1,ss.clear(),lo(n)}function Lu(n){if(n.fragment!==null){n.update(),qe(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(Ei)}}function Cu(n){const e=[],i=[];Fi.forEach(s=>n.indexOf(s)===-1?e.push(s):i.push(s)),i.forEach(s=>s()),Fi=e}const Zo=new Set;let Mi;function ve(){Mi={r:0,c:[],p:Mi}}function ye(){Mi.r||qe(Mi.c),Mi=Mi.p}function Z(n,e){n&&n.i&&(Zo.delete(n),n.i(e))}function q(n,e,i,s){if(n&&n.o){if(Zo.has(n))return;Zo.add(n),Mi.c.push(()=>{Zo.delete(n),s&&(i&&n.d(1),s())}),n.o(e)}else s&&s()}function be(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function Ho(n,e){n.d(1),e.delete(n.key)}function co(n,e){q(n,1,1,()=>{e.delete(n.key)})}function vi(n,e,i,s,r,a,u,c,f,d,p,g){let w=n.length,k=a.length,P=w;const C={};for(;P--;)C[n[P].key]=P;const A=[],z=new Map,E=new Map,I=[];for(P=k;P--;){const j=g(r,a,P),J=i(j);let $=u.get(J);$?I.push(()=>$.p(j,e)):($=d(J,j),$.c()),z.set(J,A[P]=$),J in C&&E.set(J,Math.abs(P-C[J]))}const D=new Set,X=new Set;function H(j){Z(j,1),j.m(c,p),u.set(j.key,j),p=j.first,k--}for(;w&&k;){const j=A[k-1],J=n[w-1],$=j.key,st=J.key;j===J?(p=j.first,w--,k--):z.has(st)?!u.has($)||D.has($)?H(j):X.has(st)?w--:E.get($)>E.get(st)?(X.add($),H(j)):(D.add(st),w--):(f(J,u),w--)}for(;w--;){const j=n[w];z.has(j.key)||f(j,u)}for(;k;)H(A[k-1]);return qe(I),A}function ma(n,e){const i={},s={},r={$$scope:1};let a=n.length;for(;a--;){const u=n[a],c=e[a];if(c){for(const f in u)f in c||(s[f]=1);for(const f in c)r[f]||(i[f]=c[f],r[f]=1);n[a]=c}else for(const f in u)r[f]=1}for(const u in s)u in i||(i[u]=void 0);return i}function pa(n){return typeof n=="object"&&n!==null?n:{}}function Su(n,e,i){const s=n.$$.props[e];s!==void 0&&(n.$$.bound[s]=i,i(n.$$.ctx[s]))}function le(n){n&&n.c()}function oe(n,e,i){const{fragment:s,after_update:r}=n.$$;s&&s.m(e,i),Ei(()=>{const a=n.$$.on_mount.map(aa).filter(ho);n.$$.on_destroy?n.$$.on_destroy.push(...a):qe(a),n.$$.on_mount=[]}),r.forEach(Ei)}function se(n,e){const i=n.$$;i.fragment!==null&&(Cu(i.after_update),qe(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function Mu(n,e){n.$$.dirty[0]===-1&&(Hi.push(n),fa(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Sn(n,e,i,s,r,a,u=null,c=[-1]){const f=uo;lo(n);const d=n.$$={fragment:null,ctx:[],props:a,update:Ht,not_equal:r,bound:er(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:er(),dirty:c,skip_bound:!1,root:e.target||f.$$.root};u&&u(d.root);let p=!1;if(d.ctx=i?i(n,e.props||{},(g,w,...k)=>{const P=k.length?k[0]:w;return d.ctx&&r(d.ctx[g],d.ctx[g]=P)&&(!d.skip_bound&&d.bound[g]&&d.bound[g](P),p&&Mu(n,g)),w}):[],d.update(),p=!0,qe(d.before_update),d.fragment=s?s(d.ctx):!1,e.target){if(e.hydrate){const g=vu(e.target);d.fragment&&d.fragment.l(g),g.forEach(Y)}else d.fragment&&d.fragment.c();e.intro&&Z(n.$$.fragment),oe(n,e.target,e.anchor),_a()}lo(f)}class Mn{constructor(){is(this,"$$");is(this,"$$set")}$destroy(){se(this,1),this.$destroy=Ht}$on(e,i){if(!ho(i))return Ht;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(i),()=>{const r=s.indexOf(i);r!==-1&&s.splice(r,1)}}$set(e){this.$$set&&!pu(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Tu="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Tu);const Wi=[];function xo(n,e){return{subscribe:nt(n,e).subscribe}}function nt(n,e=Ht){let i;const s=new Set;function r(c){if(pn(n,c)&&(n=c,i)){const f=!Wi.length;for(const d of s)d[1](),Wi.push(d,n);if(f){for(let d=0;d<Wi.length;d+=2)Wi[d][0](Wi[d+1]);Wi.length=0}}}function a(c){r(c(n))}function u(c,f=Ht){const d=[c,f];return s.add(d),s.size===1&&(i=e(r,a)||Ht),c(n),()=>{s.delete(d),s.size===0&&i&&(i(),i=null)}}return{set:r,update:a,subscribe:u}}function ao(n,e,i){const s=!Array.isArray(n),r=s?[n]:n;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const a=e.length<2;return xo(i,(u,c)=>{let f=!1;const d=[];let p=0,g=Ht;const w=()=>{if(p)return;g();const P=e(s?d[0]:d,u,c);a?u(P):g=ho(P)?P:Ht},k=r.map((P,C)=>yn(P,A=>{d[C]=A,p&=~(1<<C),f&&w()},()=>{p|=1<<C}));return f=!0,w(),function(){qe(k),g(),f=!1}})}function Wo(){const n=new Map,{subscribe:e,set:i,update:s}=nt(n);return{subscribe:e,set:i,update:s,add:(a,u)=>(s(c=>(c.set(u,a),c)),n),get:a=>n.get(a)||null,getAll:()=>Array.from(n.values()),delete:a=>{let u=!1;return s(c=>(c.delete(a),u=!0,c)),u},count:()=>n.size}}function Eu(n){const{id:e,inputs:i,outputs:s,resizable:r,dimensions:a,editable:u,direction:c,zIndex:f,position:d,selectionColor:p,borderWidth:g,edge:w}=n,{bgColor:k,borderColor:P,rotation:C,borderRadius:A,connections:z,textColor:E,locked:I,group:D}=n,X=Wo(),H=($="self")=>{bt(X).forEach(st=>{($==="self"||bt(st.direction)===$)&&st.recalculatePosition()})};return{id:typeof e=="string"&&e.slice(0,2)==="N-"?e:`N-${e}`,position:nt({x:(d==null?void 0:d.x)||0,y:(d==null?void 0:d.y)||0}),dimensions:{width:nt((a==null?void 0:a.width)||0),height:nt((a==null?void 0:a.height)||(a==null?void 0:a.width))},group:nt(D||null),locked:nt(I||!1),inputs:nt(i),outputs:nt(s),recalculateAnchors:H,rotation:nt(C||0),moving:nt(!1),resizingWidth:nt(!1),resizingHeight:nt(!1),rotating:nt(!1),editable:nt(u||!1),resizable:nt(r),anchors:X,zIndex:nt(f||2),collapsed:nt(!1),edge:w||null,borderRadius:nt(A),bgColor:nt(k||null),direction:nt(c),label:nt(n.label||""),borderColor:nt(P||null),borderWidth:nt(g),selectionColor:nt(p||null),textColor:nt(E||null),connections:nt(z)}}const Au=10,zu=100,Nu=50,Iu="#000",Ou="#fff",Bu="12px",Zu=22,Du=1.4,Ru=40;function xu(n,e){const i=[n,e].sort();return`${i[0]}+${i[1]}`}function nr(n,e,i){var c,f,d,p,g;const{source:s,target:r}=n,u={id:s.id&&r.id?xu(s.id,r.id):"cursor",target:n.target,source:n.source,component:e,type:nt((i==null?void 0:i.type)||null),color:(i==null?void 0:i.color)||nt(null),width:nt((i==null?void 0:i.width)||0),animated:nt((i==null?void 0:i.animated)||!1),rendered:nt(!1),start:(i==null?void 0:i.start)||null,end:(i==null?void 0:i.end)||null};if(i!=null&&i.disconnect&&(u.disconnect=!0),i!=null&&i.label){const w={text:nt(i==null?void 0:i.label.text),color:nt(((c=i==null?void 0:i.label)==null?void 0:c.color)||Iu),textColor:nt(((f=i==null?void 0:i.label)==null?void 0:f.textColor)||Ou),fontSize:nt(((d=i==null?void 0:i.label)==null?void 0:d.fontSize)||Bu),dimensions:{width:nt(((p=i==null?void 0:i.label.dimensions)==null?void 0:p.width)||zu),height:nt(((g=i==null?void 0:i.label.dimensions)==null?void 0:g.height)||Nu)},borderRadius:nt((i==null?void 0:i.label.borderRadius)||Au)};u.label=w}return u}function Wu(){const n=new Map,e=new Set,{subscribe:i,set:s,update:r}=nt(n),a={subscribe:i,set:s,update:r,add:(u,c)=>{if(typeof c!="string"){const f=Array.from(c),d=f[0],p=f[1];if(d.connected.update(g=>g.add(p)),p.connected.update(g=>g.add(d)),a.match(...Array.from(c)).length)return;e.forEach(g=>g(u,"connection"))}r(f=>(f.set(c,u),f))},getAll:()=>Array.from(n.values()),get:u=>n.get(u)||null,match:(...u)=>Array.from(n.keys()).filter(c=>c==="cursor"?!1:u.every(f=>f?c.has(f):!0)),fetch:(u,c)=>{const f=Array.from(n.keys()).filter(d=>d==="cursor"?!1:[u,c].every(p=>p?d.has(p):!0))[0];return n.get(f)||null},delete:u=>{if(typeof u!="string"){const f=Array.from(u),d=f[0],p=f[1];d.connected.update(g=>(g.delete(p),g)),p.connected.update(g=>(g.delete(d),g))}let c=!1;return r(f=>{const d=f.get(u);return d&&(f.delete(u),c=!0,typeof u!="string"&&e.forEach(p=>p(d,"disconnection"))),f}),c},onEdgeChange:u=>(e.add(u),()=>e.delete(u)),count:()=>n.size};return a}function Hu(n,e){const i=n.clientX-e.clientX,s=n.clientY-e.clientY;return Math.sqrt(i*i+s*s)}function Fu(){const n=()=>Math.floor(Math.random()*256),e=n(),i=n(),s=n();return`rgb(${e},${i},${s})`}const Gu={"(":"round","[":"square","([":"stadium","[[":"subroutine","[(":"cylindrical","((":"circle","{":"rhombus","{{":"hexagon"},ir={"-":"straight","~":"bezier"},ga={"(":")","[":"]","{":"}"},ju=/[-=~]*>(?:\s*\|(.+?)\|)?/g,Uu=n=>{const e=n.split(`
`),i={parentNodes:[],nodeList:{}};for(const s of e){const{parentNodes:r,childNodes:a,edge:u}=Xu(s);for(const c of r){i.nodeList[c.id]||i.parentNodes.push(c);for(const f of a){if(i.nodeList[c.id]){if(i.nodeList[f.id]&&i.nodeList[f.id].children.some(({node:d})=>d.id===c.id))throw new Error("Circular reference detected");i.nodeList[c.id].children.push({node:i.nodeList[f.id]||f,...u})}else c.children.push({node:i.nodeList[f.id]||f,...u}),i.nodeList[c.id]=c;i.nodeList[f.id]?i.nodeList[f.id].parents.push({node:i.nodeList[c.id]||c}):(f.parents.push({node:i.nodeList[c.id]||c}),i.nodeList[f.id]=f),i.parentNodes=i.parentNodes.filter(d=>d.id!==f.id)}}}return i},Xu=n=>{const e=[],i=[],s=n.trim();let r="";const a=s.match(ju);if(a)r=a[0];else throw new Error("Invalid edge");const[u,c]=s.split(r);for(const d of u.split("&"))e.push(or(d));for(const d of c.split("&"))i.push(or(d));const f=Vu(r);return{parentNodes:e,childNodes:i,edge:f}},or=n=>{n=n.trim();const e=n[0],i=n.slice(1);let s="",r="";const a="Default",u={shape:""},c=[];for(let f=0;f<i.length;f++)if(Yu(i[f]))c.push(i[f]);else if(ga[c[c.length-1]]===i[f]){r=Gu[c.join("")];break}else s+=i[f];return u.shape=r,u.content=s,{id:e,data:u,type:a,children:[],parents:[],depth:0,nesting:0}},Vu=n=>{n=n.trim();let e="";const[i,s]=n.split("|"),r=i[0];if(r in ir)e=ir[r];else throw new Error("Not a valid edge type");return s?{shape:e,content:s.trim(),length:Math.floor((i.trim().length-1)/2)}:{shape:e,length:Math.floor((i.trim().length-1)/2)}};function Yu(n){return n in ga}function qu(){return Math.random().toString(36).substring(7)}function Ku(n,e){const i=Math.sign(n.x).toString(),s=Math.sign(n.y).toString(),r=Math.sign(e.x).toString(),a=Math.sign(e.y).toString();return`${i}${s}${r}${a}`}function Ju(n,e){return{1001:`a ${n} ${n} 0 0 1 ${n} ${n}`,"0110":`a ${n} ${n} 0 0 0 ${n} ${n}`,"100-1":`a ${n} ${n} 0 0 0 ${n} -${n}`,"0-110":`a ${n} ${n} 0 0 1 ${n} -${n}`,"-1001":`a ${n} ${n} 0 0 0 -${n} ${n}`,"01-10":`a ${n} ${n} 0 0 1 -${n} ${n}`,"-100-1":`a ${n} ${n} 0 0 1 -${n} -${n}`,"0-1-10":`a ${n} ${n} 0 0 0 -${n} -${n}`}[e]||""}function sr(n,e){const i=e*(Math.PI/180),s=n.x*Math.cos(i)-n.y*Math.sin(i),r=n.x*Math.sin(i)+n.y*Math.cos(i);return{x:s,y:r}}const Qu=(n,e,i,s)=>n+` l ${e} ${i} `+s,jn=nt({x:0,y:0}),ps=nt(0),Vn=nt(!1),gs=nt(!1),va=xo({x:0,y:0},n=>{const e=a=>{n({x:a.clientX,y:a.clientY})},i=a=>{if(a.touches.length===2){const u=Hu(a.touches[0],a.touches[1]);ps.set(u);const c={x:a.touches[0].clientX,y:a.touches[0].clientY};n(c)}else if(a.touches.length===1){const u=a.touches[0].clientX,c=a.touches[0].clientY;n({x:u,y:c}),Vn.set(!0)}},s=a=>{i(a),window.addEventListener("touchend",r),window.addEventListener("touchmove",i)},r=()=>{Vn.set(!1),ps.set(0),window.removeEventListener("touchmove",i)};return document.addEventListener("mousemove",e),window.addEventListener("touchstart",s,!0),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchstart",s),window.removeEventListener("touchmove",i),window.removeEventListener("touchend",r)}});function rs(n){const e=n.style.width,i=n.style.height;n.style.width="fit-content",n.style.height="fit-content";const s=n.offsetWidth,r=n.offsetHeight;return n.style.width=e,n.style.height=i,[s,r]}function ya(n,e,i,s,r){const a={x:0,y:0},u=s.x-r.left-r.width/2,c=s.y-r.top-r.height/2,f=(u-i.x)/n,d=(c-i.y)/n;return a.x=u-f*e,a.y=c-d*e,a}const $u=3,tc=.1,so={north:{x:0,y:-1},south:{x:0,y:1},east:{x:1,y:0},west:{x:-1,y:0},self:{x:0,y:0}};function ba(n,e,i){const s=e*i,r=n-s;return Number(Math.max(tc,Math.min($u,r)).toFixed(9))}const Fo=(n,e,i,s,r,a,u)=>{const{clientX:c,clientY:f}=n,d=a,p=c-i,g=f-e,w=u.x,k=u.y,P=s*(1-a)/2,C=r*(1-a)/2,A=p-w-P,z=g-k-C,E=A/d,I=z/d;return{x:E,y:I}};function ec(n,e,i){const{top:s,left:r,width:a,height:u}=bt(n),c=bt(e.scale),f=bt(e.translation);return{scaled:Fo({clientX:i.x,clientY:i.y},s,r,a,u,c,f),scale:c}}function nc(n,e,i){const{scale:s,translation:r}=i,a=bt(s),u=bt(r),c=e.x-n.x,f=e.y-n.y,d=u.x+c*a,p=u.y+f*a;return{x:d,y:p}}function ic(n,e){return n.x*e.x+n.y*e.y}function oc(n,e,i){const s=[],r=e.x-n.x,a=e.y-n.y,u=rc(n.direction,e.direction),c=ic(n.direction,e.direction)===0,f=sc(n,e),d=on(n.direction,-1,-1),p=on(e.direction,-1,-1),g={x:Math.abs(n.direction.y),y:Math.abs(n.direction.x)},w=on(n.direction,r-i*n.direction.x*(c?1:u?0:2),a-i*n.direction.y*(c?1:u?0:2)),k=on(e.direction,r+i*e.direction.x*(c?1:u?0:2),a+i*e.direction.y*(c?1:u?0:2)),P=Math.sign(w.x)===-1||Math.sign(w.y)===-1,C=Math.sign(k.x)===1||Math.sign(k.y)===1,A=Math.abs(r),z=Math.abs(a),E=on(n.direction,i,i),I=on(p,i,i),D=on(e.direction,i,i),X=on(n.direction,A,z),H=on(p,A,z),j=on(n.direction,A/2,z/2),J=on(p,A/2,z/2),$=on(g,r,a),st=!f&&!C&&!P,ut=n.x+E.x,O=n.y+E.y,it=e.x+D.x,V=e.y+D.y;if(P&&s.push(E),f&&!C&&!P)s.push(X),s.push(H);else if(u)P||s.push(on(n.direction,i+A,i+z)),s.push($),C||s.push(on(p,i+A,i+z));else if(st)s.push(j),s.push($),s.push(J);else if(P&&C)if(c){const _t=Math.abs(ut-it),mt=Math.abs(O-V);s.push(on(e.direction,A<i*2?e.direction.x*(r+e.direction.x*i):A+i,z<i*2?e.direction.y*(a+e.direction.y*i):z+i)),s.push(on(d,_t,mt))}else{const _t=Math.abs(ut-it),mt=Math.abs(O-V);s.push(on(g,r/2,a/2)),s.push(on(e.direction,_t,mt)),s.push(on(g,r/2,a/2))}else if(P){const _t=Math.abs(ut-e.x),mt=Math.abs(O-e.y);s.push(on(p,A<i*2?A-i:A/2,z<i*2?z-i:z/2)),s.push(on(d,_t,mt)),s.push(on(p,Math.max(i,A/2),Math.max(i,z/2)))}else if(C){const _t=Math.abs(it-n.x),mt=Math.abs(V-n.y);s.push(on(n.direction,Math.max(i,A/2),Math.max(i,z/2))),s.push(on(e.direction,_t,mt)),s.push(on(n.direction,A<i*2?A-i:A/2,z<i*2?z-i:z/2))}return C&&s.push(I),s}function sc(n,e){const{x:i,y:s}=n.direction,{x:r,y:a}=e.direction,u=e.x-n.x,c=e.y-n.y;return i*a===r*s?!1:Math.sign(c)===Math.sign(s+a)!=(Math.sign(u)===Math.sign(i+r))}function on(n,e,i){return{x:n.x*e,y:n.y*i}}function rc(n,e){return n.x===e.x&&n.y===e.y}function lc(n,e){const{width:i,height:s}=n,{top:r,left:a,right:u,bottom:c}=e,f=u-a,d=c-r;if(!f||!d)return{x:null,y:null,scale:null};const p=a+f/2,g=r+d/2,w=Math.min(i/f,s/d)*.8,k=i/2,P=s/2,C=k-p,A=P-g;return{x:C*w,y:A*w,scale:w}}const Io=(n,e,i)=>Math.min(Math.abs(n||e)/2,i);function ls(n,e){const s=n.getTotalLength()*e;return n.getPointAtLength(s)}function ac(n,e,i,s){return ao([n,e,i,s],([a,u,c,f])=>{const d={clientX:a.x,clientY:a.y};return Fo(d,u.top,u.left,u.width,u.height,f,c)})}function uc(n,e,i,s){const r=nt({top:1/0,left:1/0,right:-1/0,bottom:-1/0}),a=nt({top:1/0,left:1/0,right:-1/0,bottom:-1/0});let u,c=bt(e),f=bt(i),d=bt(s),p=c.width/f,g=c.height/f;function w(){const{x:P,y:C}=Fo({clientX:c.left,clientY:c.top},c.top,c.left,c.width,c.height,f,d),A=bt(a);r.set({top:Math.min(A.top,C),left:Math.min(A.left,P),right:Math.max(A.right,P+p),bottom:Math.max(A.bottom,g+C)})}function k(P=!1){let C=1/0,A=1/0,z=-1/0,E=-1/0;for(const I of n.getAll()){console.log("dentro del for, este es e node:",I);const{x:D,y:X}=bt(I.position),H=bt(I.dimensions.width),j=bt(I.dimensions.height);A=Math.min(A,D),C=Math.min(C,X),z=Math.max(z,D+H),E=Math.max(E,X+j)}a.set({top:C,left:A,right:z,bottom:E}),w(),P&&(u=requestAnimationFrame(()=>k(P)))}return n.subscribe(()=>{console.log("dentro del nodes.subscribe...........Aqui no estan llegando los nodes"),k()}),gs.subscribe(P=>{P&&k(P),P||cancelAnimationFrame(u)}),Vn.subscribe(P=>{P&&k(P),P||cancelAnimationFrame(u)}),e.subscribe(()=>{c=bt(e),p=c.width/f,g=c.height/f,w()}),i.subscribe(()=>{f=bt(i),p=c.width/f,g=c.height/f,w()}),s.subscribe(()=>{d=bt(s),w()}),{graphBounds:r,nodeBounds:a}}function cc(n,e,i){const{width:s,height:r,top:a,left:u}=n,c={clientX:s/2,clientY:r/2};return Fo(c,a,u,s,r,i,e)}function wa(n,e){const{zoom:i,editable:s,translation:r,direction:a,locked:u,edge:c,nodes:f}=e,d=nt({x:(r==null?void 0:r.x)||0,y:(r==null?void 0:r.y)||0}),p=nt({top:0,left:0,width:0,height:0,bottom:0,right:0}),g=nt(i),w=nt(!1),k=Wo(),P=uc(k,p,g,d),C=ao([p,d,g],([z,E,I])=>cc(z,E,I));return{id:n,nodes:k,edges:Wu(),transforms:{translation:d,scale:g},maxZIndex:nt(2),dimensions:p,bounds:P,center:C,mounted:w,direction:a||"LR",editable:s||!1,edge:c||null,editing:nt(null),cursor:ac(va,p,d,g),locked:nt(u||!1),groups:nt({selected:{parent:nt(null),nodes:nt(new Set)},hidden:{parent:nt(null),nodes:nt(new Set)}}),groupBoxes:Wo(),activeGroup:nt(null),initialNodePositions:nt([])}}const as=Wo(),Oo={width:200,height:100};function Do(n,e){return{x:Math.round(n/Oo.width)*Oo.width,y:Math.round(e/Oo.height)*Oo.height}}const Bo=10;function ka(n){const e=bt(n);return Array.from(e).map(s=>bt(s.position))}function hc(n,e){console.log("moveNodes called");let i;const s=bt(n.groups),r=bt(n.activeGroup);if(console.log("Graph Groups:",s),console.log("Active Group:",r),!r)return;const a=s[r].nodes;if(!a)return;const u=bt(n.initialNodePositions),{x:c,y:f}=bt(jn),d=Array.from(bt(a)),p=bt(n.groupBoxes);console.log("Group Boxes:",p),d.forEach(w=>w.moving.set(!0)),g();function g(){const w=bt(n.cursor);let k=w.x-c,P=w.y-f;if(e){const A=Do(k,P);k=A.x,P=A.y}const C={x:k,y:P};d.forEach((A,z)=>{const{group:E,position:I}=A,D=u[z];let X;if(r==="selected"){const H=bt(E);H&&(X=p.get(H))}if(!X)fc(D,C,I);else{const H=bt(A.dimensions.width),j=bt(A.dimensions.height),J=La(X,H,j);Pa(D,C,I,J)}}),bt(Vn)?i=requestAnimationFrame(g):cancelAnimationFrame(i)}}function fc(n,e,i){i.set({x:n.x+e.x,y:n.y+e.y})}function Pa(n,e,i,s){i.set({x:Math.min(Math.max(s.left,n.x+e.x),s.right),y:Math.min(Math.max(s.top,n.y+e.y),s.bottom)})}function La(n,e,i){const{x:s,y:r}=bt(n.position);return console.log("Group Box Position:",{x:s,y:r}),{left:s+Bo,right:s+bt(n.dimensions.width)-e-Bo,top:r+Bo,bottom:r+bt(n.dimensions.height)-i-Bo}}function rr(n=1,e,i,s=.1){const r=bt(e),{width:a,height:u,top:c,left:f}=r,d=i.scale,p=bt(i.translation),g=bt(d),w=ba(g,n,s),k=ya(g,w,p,{x:a/2+f,y:u/2+c},r);d.set(w),i.translation.set(k)}function dc(n,e,i,s,r,a,u,c,f,d,p,g){const{width:w,height:k}=r,{x:P,y:C}=s,A=bt(e.position),z=nt({x:P-A.x+w/2,y:C-A.y+k/2}),E=ao([e.position,z],([$,st])=>({x:$.x+st.x,y:$.y+st.y})),I=n.transforms,D=n.dimensions,X=nt(f||"self"),H=()=>{const $=document.getElementById(i),st=bt(X),ut=so[st];if(!$)return;const{x:O,y:it,width:V,height:_t}=$.getBoundingClientRect(),mt=bt(z),F=bt(E),{scaled:R,scale:yt}=ec(D,I,{x:O,y:it}),tt=R.x-F.x,Pt=R.y-F.y;z.set({x:mt.x+tt+V/yt/2+ut.x*V/yt/2,y:mt.y+Pt+_t/yt/2+ut.y*_t/yt/2})},j=ao([e.moving,e.resizingWidth,e.resizingHeight,e.rotating],([$,st,ut,O])=>$||st||ut||O),J=ao([e.rotation],([$])=>$);return{id:i,position:E,offset:z,direction:X,dynamic:nt(d||!1),type:c,edge:u,moving:j,mounted:nt(!1),recalculatePosition:H,connected:nt(new Set),store:a||null,inputKey:p||null,edgeColor:g||nt(null),rotation:J,node:e}}function _c(n){var s,r;const e=JSON.parse(n);return wa(e.id,{...e,editable:e.editable,direction:e.direction,locked:e.locked,zoom:((s=e.transforms)==null?void 0:s.scale)??1,translation:((r=e.transforms)==null?void 0:r.translation)??{x:0,y:0},edge:e.edge})}function mc(n){let e;const i=n[2].default,s=ke(i,n,n[1],null);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,[a]){s&&s.p&&(!e||a&2)&&Le(s,i,r,r[1],e?Pe(i,r[1],a,null):Ce(r[1]),null)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function pc(n,e,i){let{$$slots:s={},$$scope:r}=e,{edge:a}=e;return Ae("edge",a),n.$$set=u=>{"edge"in u&&i(0,a=u.edge),"$$scope"in u&&i(1,r=u.$$scope)},[a,r,s]}class Ca extends Mn{constructor(e){super(),Sn(this,e,pc,mc,pn,{edge:0})}}const gc=n=>({hovering:n[0]&32768}),lr=n=>({destroy:n[9],hovering:n[15]}),vc=n=>({path:n[0]&4096,hovering:n[0]&32768}),ar=n=>({path:n[12],destroy:n[9],hovering:n[15]});function yc(n){let e,i,s,r,a,u=(n[0]||n[1])&&ur(n);const c=n[91].default,f=ke(c,n,n[90],ar),d=f||bc(n);let p=n[10]&&cr(n);return{c(){e=Qt("svg"),u&&u.c(),i=Qt("path"),d&&d.c(),p&&p.c(),m(i,"role","presentation"),m(i,"id",n[38]+"-target"),m(i,"class","target svelte-ppcocz"),m(i,"d",n[12]),Yt(i,"cursor",n[38]==="cursor"||!n[4]&&!n[3]),at(i,"cursor",n[4]||n[15]?"pointer":"move"),at(i,"--prop-target-edge-color",n[4]||n[15]?n[8]||null:"transparent"),m(e,"class","edges-wrapper svelte-ppcocz"),at(e,"z-index",n[17])},m(g,w){K(g,e,w),u&&u.m(e,null),y(e,i),n[94](i),d&&d.m(e,null),p&&p.m(e,null),n[95](e),s=!0,r||(a=[lt(i,"mousedown",function(){ho(n[4])&&n[4].apply(this,arguments)}),lt(i,"mouseenter",n[92]),lt(i,"mouseleave",n[93])],r=!0)},p(g,w){n=g,n[0]||n[1]?u?u.p(n,w):(u=ur(n),u.c(),u.m(e,i)):u&&(u.d(1),u=null),(!s||w[0]&4096)&&m(i,"d",n[12]),(!s||w[0]&24|w[1]&128)&&Yt(i,"cursor",n[38]==="cursor"||!n[4]&&!n[3]),w[0]&32784&&at(i,"cursor",n[4]||n[15]?"pointer":"move"),w[0]&33040&&at(i,"--prop-target-edge-color",n[4]||n[15]?n[8]||null:"transparent"),f?f.p&&(!s||w[0]&36864|w[2]&268435456)&&Le(f,c,n,n[90],s?Pe(c,n[90],w,vc):Ce(n[90]),ar):d&&d.p&&(!s||w[0]&1052711)&&d.p(n,s?w:[-1,-1,-1,-1]),n[10]?p?(p.p(n,w),w[0]&1024&&Z(p,1)):(p=cr(n),p.c(),Z(p,1),p.m(e,null)):p&&(ve(),q(p,1,1,()=>{p=null}),ye()),w[0]&131072&&at(e,"z-index",n[17])},i(g){s||(Z(d,g),Z(p),s=!0)},o(g){q(d,g),q(p),s=!1},d(g){g&&Y(e),u&&u.d(),n[94](null),d&&d.d(g),p&&p.d(),n[95](null),r=!1,qe(a)}}}function ur(n){let e,i,s,r,a;return{c(){e=Qt("defs"),i=Qt("marker"),s=Qt("polygon"),r=Qt("marker"),a=Qt("polygon"),m(s,"class","arrow svelte-ppcocz"),m(s,"points","0 0, 15 5, 0 10"),at(s,"--prop-edge-color",n[20]),m(i,"id",n[38]+"-end-arrow"),m(i,"viewBox","0 0 15 15"),m(i,"markerWidth","15"),m(i,"markerHeight","10"),m(i,"refX","12.5"),m(i,"refY","5"),m(i,"orient","auto"),m(a,"class","arrow svelte-ppcocz"),m(a,"points","0 5, 15 0, 15 10"),at(a,"--prop-edge-color",n[20]),m(r,"id",n[38]+"-start-arrow"),m(r,"viewBox","0 0 15 15"),m(r,"markerWidth","15"),m(r,"markerHeight","10"),m(r,"refX","0"),m(r,"refY","5"),m(r,"orient","auto")},m(u,c){K(u,e,c),y(e,i),y(i,s),y(e,r),y(r,a)},p(u,c){c[0]&1048576&&at(s,"--prop-edge-color",u[20]),c[0]&1048576&&at(a,"--prop-edge-color",u[20])},d(u){u&&Y(e)}}}function bc(n){let e,i,s;return{c(){e=Qt("path"),m(e,"id",n[38]),m(e,"class","edge svelte-ppcocz"),m(e,"d",n[12]),m(e,"marker-end",i=n[1]==="arrow"?`url(#${n[38]+"-end-arrow"})`:""),m(e,"marker-start",s=n[0]==="arrow"?`url(#${n[38]+"-start-arrow"})`:""),Yt(e,"animate",n[2]),at(e,"--prop-edge-color",n[20]),at(e,"--prop-stroke-width",n[5]?n[5]+"px":null)},m(r,a){K(r,e,a)},p(r,a){a[0]&4096&&m(e,"d",r[12]),a[0]&2&&i!==(i=r[1]==="arrow"?`url(#${r[38]+"-end-arrow"})`:"")&&m(e,"marker-end",i),a[0]&1&&s!==(s=r[0]==="arrow"?`url(#${r[38]+"-start-arrow"})`:"")&&m(e,"marker-start",s),a[0]&4&&Yt(e,"animate",r[2]),a[0]&1048576&&at(e,"--prop-edge-color",r[20]),a[0]&32&&at(e,"--prop-stroke-width",r[5]?r[5]+"px":null)},d(r){r&&Y(e)}}}function cr(n){let e,i,s,r,a;const u=n[91].label,c=ke(u,n,n[90],lr),f=c||wc(n);return{c(){e=Qt("foreignObject"),i=T("span"),f&&f.c(),m(i,"class","label-wrapper svelte-ppcocz"),m(e,"x",s=n[14].x),m(e,"y",r=n[14].y),m(e,"width","100%"),m(e,"height","100%"),m(e,"class","svelte-ppcocz")},m(d,p){K(d,e,p),y(e,i),f&&f.m(i,null),a=!0},p(d,p){c?c.p&&(!a||p[0]&32768|p[2]&268435456)&&Le(c,u,d,d[90],a?Pe(u,d[90],p,gc):Ce(d[90]),lr):f&&f.p&&(!a||p[0]&2240)&&f.p(d,a?p:[-1,-1,-1,-1]),(!a||p[0]&16384&&s!==(s=d[14].x))&&m(e,"x",s),(!a||p[0]&16384&&r!==(r=d[14].y))&&m(e,"y",r)},i(d){a||(Z(f,d),a=!0)},o(d){q(f,d),a=!1},d(d){d&&Y(e),f&&f.d(d)}}}function wc(n){let e,i;return{c(){e=T("div"),i=ge(n[11]),m(e,"class","default-label svelte-ppcocz"),at(e,"--prop-label-color",n[6]),at(e,"--prop-label-text-color",n[7])},m(s,r){K(s,e,r),y(e,i)},p(s,r){r[0]&2048&&sn(i,s[11]),r[0]&64&&at(e,"--prop-label-color",s[6]),r[0]&128&&at(e,"--prop-label-text-color",s[7])},d(s){s&&Y(e)}}}function kc(n){let e,i,s=n[23]&&n[24]&&yc(n);return{c(){s&&s.c(),e=Ee()},m(r,a){s&&s.m(r,a),K(r,e,a),i=!0},p(r,a){r[23]&&r[24]&&s.p(r,a)},i(r){i||(Z(s),i=!0)},o(r){q(s),i=!1},d(r){r&&Y(e),s&&s.d(r)}}}let us;function Pc(n){const e=n.parentNode;if(!e)return;e.removeChild(n);const i=document.querySelector(".svelvet-graph-wrapper");i&&i.appendChild(n)}function Lc(n,e,i){var xn,si;let s,r,a,u,c,f,d,p,g,w,k,P,C,A,z,E,I,D,X,H,j,J,$,st,ut,O,it,V,_t,mt,F,R,yt=Ht,tt=()=>(yt(),yt=yn(_t,pt=>i(73,R=pt)),_t),Pt,Mt=Ht,vt=()=>(Mt(),Mt=yn(V,pt=>i(74,Pt=pt)),V),U,ot,Q,et,Tt,jt,ft,At,Dt,Zt,$t,ze,ae,rt,_e=Ht,Rt=()=>(_e(),_e=yn(a,pt=>i(88,rt=pt)),a),zt,Ft=Ht,Xt=()=>(Ft(),Ft=yn(r,pt=>i(89,zt=pt)),r);n.$$.on_destroy.push(()=>yt()),n.$$.on_destroy.push(()=>Mt()),n.$$.on_destroy.push(()=>_e()),n.$$.on_destroy.push(()=>Ft());let{$$slots:Ne={},$$scope:Ie}=e;const we=ws(Ne),Ut=de("edgeStore"),tn=de("edgeStyle"),te=de("endStyles"),cn=de("raiseEdgesOnSelect"),fe=de("edgesAboveNode");let{edge:ee=de("edge")}=e,{straight:me=tn==="straight"}=e,{step:Ze=tn==="step"}=e,{start:He=te[0]}=e,{end:hn=te[1]}=e,{animate:je=!1}=e,{label:Ue=""}=e,{enableHover:It=!1}=e,{edgeClick:Ke=null}=e,{labelPosition:Je=.5}=e,{width:gn=null}=e,{color:zn=null}=e,{labelColor:Bn=null}=e,{textColor:Se=null}=e,{cornerRadius:De=8}=e,{targetColor:fn=null}=e;const Kt=ee.source,ue=ee.target,Fe=Kt.direction;gt(n,Fe,pt=>i(76,ot=pt));const _n=ue.direction;gt(n,_n,pt=>i(75,U=pt));const Xe=Kt.rotation;gt(n,Xe,pt=>i(83,Dt=pt));const bn=ue.rotation;gt(n,bn,pt=>i(82,At=pt));const Tn=Kt.position;gt(n,Tn,pt=>i(87,ae=pt));const en=ue.position;gt(n,en,pt=>i(86,ze=pt));const Lt=Kt.dynamic;gt(n,Lt,pt=>i(79,Tt=pt));const Ve=ue.dynamic;gt(n,Ve,pt=>i(78,et=pt));const wn=Kt.moving;gt(n,wn,pt=>i(81,ft=pt));const nn=ue.moving;gt(n,nn,pt=>i(80,jt=pt));const kn=(xn=Kt.node)==null?void 0:xn.position;gt(n,kn,pt=>i(85,$t=pt));const b=(si=ue.node)==null?void 0:si.position;gt(n,b,pt=>i(84,Zt=pt));const dt=ee.type;gt(n,dt,pt=>i(77,Q=pt));const wt=ee.id;let kt,Et,B={x:0,y:0},Vt=!1,ce=!1,Jt=!1,Oe=!1,dn=!1,Re;ee.rendered.set(!0),qn(()=>{setTimeout(()=>{Et&&i(14,B=ls(Et,Je))},0),Pc(Re)}),ca(()=>{Et&&i(14,B=ls(Et,Je))}),fo(()=>{Re.remove(),cancelAnimationFrame(us)});function mn(){Vt&&(Et&&i(14,B=ls(Et,Je)),us=requestAnimationFrame(mn))}function Zn(){if(Kt.id===null||ue.id===null)return;const pt=Ut.match(Kt,ue);Ut.delete(pt[0]),Kt==null||Kt.connected.update(xt=>(ue&&xt.delete(ue),xt)),ue==null||ue.connected.update(xt=>(Kt&&xt.delete(Kt),xt))}const ti=()=>i(15,dn=!0),Dn=()=>i(15,dn=!1);function En(pt){Kn[pt?"unshift":"push"](()=>{Et=pt,i(13,Et)})}function Rn(pt){Kn[pt?"unshift":"push"](()=>{Re=pt,i(16,Re)})}return n.$$set=pt=>{"edge"in pt&&i(39,ee=pt.edge),"straight"in pt&&i(40,me=pt.straight),"step"in pt&&i(41,Ze=pt.step),"start"in pt&&i(0,He=pt.start),"end"in pt&&i(1,hn=pt.end),"animate"in pt&&i(2,je=pt.animate),"label"in pt&&i(42,Ue=pt.label),"enableHover"in pt&&i(3,It=pt.enableHover),"edgeClick"in pt&&i(4,Ke=pt.edgeClick),"labelPosition"in pt&&i(43,Je=pt.labelPosition),"width"in pt&&i(5,gn=pt.width),"color"in pt&&i(44,zn=pt.color),"labelColor"in pt&&i(6,Bn=pt.labelColor),"textColor"in pt&&i(7,Se=pt.textColor),"cornerRadius"in pt&&i(45,De=pt.cornerRadius),"targetColor"in pt&&i(8,fn=pt.targetColor),"$$scope"in pt&&i(90,Ie=pt.$$scope)},n.$$.update=()=>{var pt;if(n.$$.dirty[2]&196608&&i(55,s=Tt||et),n.$$.dirty[1]&256&&Rt(i(21,a=(pt=ee.label)==null?void 0:pt.text)),n.$$.dirty[1]&8192|n.$$.dirty[2]&134217728&&i(20,u=zn||zt||null),n.$$.dirty[1]&2048|n.$$.dirty[2]&67108864&&i(11,c=Ue||rt||""),n.$$.dirty[0]&2048&&i(10,f=c||we.label),n.$$.dirty[2]&33554432&&i(72,d=ae),n.$$.dirty[2]&16777216&&i(71,p=ze),n.$$.dirty[2]&8388608&&i(56,g=$t),n.$$.dirty[2]&4194304&&i(57,w=Zt),n.$$.dirty[2]&1024&&i(52,k=d.x),n.$$.dirty[2]&1024&&i(51,P=d.y),n.$$.dirty[2]&512&&i(54,C=p.x),n.$$.dirty[2]&512&&i(53,A=p.y),n.$$.dirty[1]&10485760&&i(70,z=C-k),n.$$.dirty[1]&5242880&&i(69,E=A-P),n.$$.dirty[2]&256&&i(68,I=Math.abs(z)),n.$$.dirty[2]&128&&i(67,D=Math.abs(E)),n.$$.dirty[2]&64&&i(65,X=Math.max(30,Math.min(600,I/2))),n.$$.dirty[2]&32&&i(63,H=Math.max(30,Math.min(600,D/2))),n.$$.dirty[1]&117833728&&s&&Kt.node&&ue.node){const xt=w.x-g.x,ne=w.y-g.y;i(48,Jt=ne>0),i(49,Oe=xt>0);let vn,xe;if(Jt){const rn=bt(Kt.node.dimensions.height),Me=g.y+rn;vn=w.y-Me}else{const rn=bt(ue.node.dimensions.height),Me=w.y+rn;vn=g.y-Me}if(Oe){const rn=bt(Kt.node.dimensions.width),Me=g.x+rn;xe=w.x-Me}else{const rn=bt(ue.node.dimensions.width),Me=w.x+rn;xe=g.x-Me}i(47,ce=vn>xe)}if(n.$$.dirty[1]&17235968|n.$$.dirty[2]&196608&&s){let xt,ne;ce?(xt=Jt?"south":"north",ne=Jt?"north":"south"):(xt=Oe?"east":"west",ne=Oe?"west":"east"),Tt&&Bt(Fe,ot=xt,ot),et&&Bt(_n,U=ne,U)}if(n.$$.dirty[2]&2113536&&i(66,j=sr(so[ot],Dt||0)),n.$$.dirty[2]&1056768&&i(64,J=sr(so[U],At||0)),n.$$.dirty[1]&2097152|n.$$.dirty[2]&24&&i(62,$=k+j.x*X),n.$$.dirty[1]&1048576|n.$$.dirty[2]&18&&i(61,st=P+j.y*H),n.$$.dirty[1]&8388608|n.$$.dirty[2]&12&&i(60,ut=C+J.x*X),n.$$.dirty[1]&4194304|n.$$.dirty[2]&6&&i(59,O=A+J.y*H),n.$$.dirty[1]&1879048192|n.$$.dirty[2]&1&&i(58,it=`C ${$}, ${st} ${ut}, ${O}`),n.$$.dirty[1]&149947904|n.$$.dirty[2]&32768&&(!Ze||wt==="cursor"||Q==="bezier")&&i(12,kt=`M ${k}, ${P} ${me?"":it} ${C}, ${A}`),n.$$.dirty[0]&1024|n.$$.dirty[1]&32768|n.$$.dirty[2]&786432&&(f&&!Vt&&(ft||jt||wt==="cursor")?(i(46,Vt=!0),mn()):Vt&&!ft&&!jt&&wt!=="cursor"&&(i(46,Vt=!1),cancelAnimationFrame(us))),n.$$.dirty[1]&15746048|n.$$.dirty[2]&57344&&Ze&&wt!=="cursor"&&!(Q&&Q==="bezier")){const xt={x:k,y:P,direction:so[ot]},ne={x:C,y:A,direction:so[U]},vn=oc(xt,ne,Ru),xe=(rn,Me,Wt)=>{if(Me<vn.length-1){const Te=Ku(rn,vn[Me+1]);return Ju(Wt,Te)}return""};i(12,kt=vn.reduce((rn,Me,Wt)=>{const Te=Math.sign(Me.x),Nn=Math.sign(Me.y);let ln=Me.x,Pn=Me.y,ei="";if(De){const Ln=vn[Wt+1]||{x:0,y:0},Ye=vn[Wt-1]||{x:0,y:0},ie=Io(Me.x,Ln.x,De),Qe=Io(Ln.y,Me.y,De),an=Io(Ye.x,Me.x,De),un=Io(Ye.y,Me.y,De),ni=Math.min(an,un),Wn=Math.min(ie,Qe);Me.x?ln=Me.x-(Wn+ni)*Te:Pn=Me.y-(Wn+ni)*Nn,ei=xe(Me,Wt,Wn)}return Qu(rn,ln,Pn,ei)},`M ${k}, ${P}`))}n.$$.dirty[2]&6144&&i(50,mt=Math.max(Pt,R)),n.$$.dirty[1]&524288|n.$$.dirty[2]&6144&&i(17,F=fe==="all"?1e5:fe?mt:cn===!0?mt-1:cn==="source"?Pt-1:cn==="target"?R-1:0)},Xt(i(22,r=(Kt==null?void 0:Kt.edgeColor)||(ue==null?void 0:ue.edgeColor)||null)),vt(i(19,V=Kt.node.zIndex||0)),tt(i(18,_t=ue.node.zIndex||0)),[He,hn,je,It,Ke,gn,Bn,Se,fn,Zn,f,c,kt,Et,B,dn,Re,F,_t,V,u,a,r,Kt,ue,Fe,_n,Xe,bn,Tn,en,Lt,Ve,wn,nn,kn,b,dt,wt,ee,me,Ze,Ue,Je,zn,De,Vt,ce,Jt,Oe,mt,P,k,A,C,s,g,w,it,O,ut,st,$,H,J,X,j,D,I,E,z,p,d,R,Pt,U,ot,Q,et,Tt,jt,ft,At,Dt,Zt,$t,ze,ae,rt,zt,Ie,Ne,ti,Dn,En,Rn]}class Sa extends Mn{constructor(e){super(),Sn(this,e,Lc,kc,pn,{edge:39,straight:40,step:41,start:0,end:1,animate:2,label:42,enableHover:3,edgeClick:4,labelPosition:43,width:5,color:44,labelColor:6,textColor:7,cornerRadius:45,targetColor:8,destroy:9},null,[-1,-1,-1,-1])}get destroy(){return this.$$.ctx[9]}}function Cc(n){let e;return{c(){e=T("div"),m(e,"class","svelvet-anchor svelte-19t6skv"),Yt(e,"output",n[0]),Yt(e,"input",n[1]),Yt(e,"connected",n[3]),Yt(e,"connecting",n[2]),Yt(e,"hovering",n[4]),at(e,"--prop-anchor-color",n[5])},m(i,s){K(i,e,s)},p(i,[s]){s&1&&Yt(e,"output",i[0]),s&2&&Yt(e,"input",i[1]),s&8&&Yt(e,"connected",i[3]),s&4&&Yt(e,"connecting",i[2]),s&16&&Yt(e,"hovering",i[4]),s&32&&at(e,"--prop-anchor-color",i[5])},i:Ht,o:Ht,d(i){i&&Y(e)}}}function Sc(n,e,i){let{output:s}=e,{input:r}=e,{connecting:a}=e,{connected:u}=e,{hovering:c}=e,{bgColor:f}=e;return n.$$set=d=>{"output"in d&&i(0,s=d.output),"input"in d&&i(1,r=d.input),"connecting"in d&&i(2,a=d.connecting),"connected"in d&&i(3,u=d.connected),"hovering"in d&&i(4,c=d.hovering),"bgColor"in d&&i(5,f=d.bgColor)},[s,r,a,u,c,f]}class Mc extends Mn{constructor(e){super(),Sn(this,e,Sc,Cc,pn,{output:0,input:1,connecting:2,connected:3,hovering:4,bgColor:5})}}const Tc=n=>({}),hr=n=>({});function fr(n){const e=n.slice(),i=e[7].component;return e[86]=i,e}function cs(n){const e=n.slice(),i=e[14].get("cursor");return e[7]=i,e}function dr(n,e,i){const s=n.slice();s[87]=e[i];const r=s[14].fetch(s[23],s[87]);return s[7]=r,s}const Ec=n=>({}),_r=n=>({});function hs(n){const e=n.slice(),i=e[7].component;return e[86]=i,e}const Ac=n=>({linked:n[0]&512,hovering:n[0]&1024,connecting:n[0]&2048}),mr=n=>{var e;return{linked:((e=n[9])==null?void 0:e.size)>=1,hovering:n[10],connecting:n[11]}};function pr(n){var s;let e,i;return e=new Mc({props:{output:n[2],input:n[1],connecting:n[11],hovering:n[10],bgColor:n[0],connected:((s=n[9])==null?void 0:s.size)>=1}}),{c(){le(e.$$.fragment)},m(r,a){oe(e,r,a),i=!0},p(r,a){var c;const u={};a[0]&4&&(u.output=r[2]),a[0]&2&&(u.input=r[1]),a[0]&2048&&(u.connecting=r[11]),a[0]&1024&&(u.hovering=r[10]),a[0]&1&&(u.bgColor=r[0]),a[0]&512&&(u.connected=((c=r[9])==null?void 0:c.size)>=1),e.$set(u)},i(r){i||(Z(e.$$.fragment,r),i=!0)},o(r){q(e.$$.fragment,r),i=!1},d(r){se(e,r)}}}function zc(n){let e,i,s=!n[5]&&pr(n);return{c(){s&&s.c(),e=Ee()},m(r,a){s&&s.m(r,a),K(r,e,a),i=!0},p(r,a){r[5]?s&&(ve(),q(s,1,1,()=>{s=null}),ye()):s?(s.p(r,a),a[0]&32&&Z(s,1)):(s=pr(r),s.c(),Z(s,1),s.m(e.parentNode,e))},i(r){i||(Z(s),i=!0)},o(r){q(s),i=!1},d(r){r&&Y(e),s&&s.d(r)}}}function gr(n){let e,i;return e=new Ca({props:{edge:n[7],$$slots:{default:[Bc]},$$scope:{ctx:n}}}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const a={};r[0]&512&&(a.edge=s[7]),r[0]&512|r[1]&8388608&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Nc(n){let e,i;return e=new Sa({}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Ic(n){let e,i;return e=new n[86]({}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Oc(n){let e,i,s,r;const a=[Ic,Nc],u=[];function c(f,d){return f[86]?0:1}return e=c(n),i=u[e]=a[e](n),{c(){i.c(),s=Ee()},m(f,d){u[e].m(f,d),K(f,s,d),r=!0},p(f,d){let p=e;e=c(f),e!==p&&(ve(),q(u[p],1,1,()=>{u[p]=null}),ye(),i=u[e],i||(i=u[e]=a[e](f),i.c()),Z(i,1),i.m(s.parentNode,s))},i(f){r||(Z(i),r=!0)},o(f){q(i),r=!1},d(f){f&&Y(s),u[e].d(f)}}}function Bc(n){let e;const i=n[50].edge,s=ke(i,n,n[54],_r),r=s||Oc(n);return{c(){r&&r.c()},m(a,u){r&&r.m(a,u),e=!0},p(a,u){s?s.p&&(!e||u[1]&8388608)&&Le(s,i,a,a[54],e?Pe(i,a[54],u,Ec):Ce(a[54]),_r):r&&r.p&&(!e||u[0]&512)&&r.p(a,e?u:[-1,-1,-1])},i(a){e||(Z(r,a),e=!0)},o(a){q(r,a),e=!1},d(a){r&&r.d(a)}}}function vr(n,e){let i,s,r,a=e[7]&&e[7].source===e[23]&&gr(hs(e));return{key:n,first:null,c(){i=Ee(),a&&a.c(),s=Ee(),this.first=i},m(u,c){K(u,i,c),a&&a.m(u,c),K(u,s,c),r=!0},p(u,c){e=u,e[7]&&e[7].source===e[23]?a?(a.p(hs(e),c),c[0]&512&&Z(a,1)):(a=gr(hs(e)),a.c(),Z(a,1),a.m(s.parentNode,s)):a&&(ve(),q(a,1,1,()=>{a=null}),ye())},i(u){r||(Z(a),r=!0)},o(u){q(a),r=!1},d(u){u&&(Y(i),Y(s)),a&&a.d(u)}}}function yr(n){let e,i,s=n[7]&&Zc(fr(n));return{c(){s&&s.c(),e=Ee()},m(r,a){s&&s.m(r,a),K(r,e,a),i=!0},p(r,a){r[7]&&s.p(fr(r),a)},i(r){i||(Z(s),i=!0)},o(r){q(s),i=!1},d(r){r&&Y(e),s&&s.d(r)}}}function Zc(n){let e,i;return e=new Ca({props:{edge:n[7],$$slots:{default:[Wc]},$$scope:{ctx:n}}}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const a={};r[1]&8388608&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Dc(n){let e,i;return e=new Sa({}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Rc(n){let e,i;return e=new n[86]({}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function xc(n){let e,i,s,r;const a=[Rc,Dc],u=[];function c(f,d){return f[86]?0:1}return e=c(n),i=u[e]=a[e](n),{c(){i.c(),s=Ee()},m(f,d){u[e].m(f,d),K(f,s,d),r=!0},p:Ht,i(f){r||(Z(i),r=!0)},o(f){q(i),r=!1},d(f){f&&Y(s),u[e].d(f)}}}function Wc(n){let e;const i=n[50].edge,s=ke(i,n,n[54],hr),r=s||xc(n);return{c(){r&&r.c()},m(a,u){r&&r.m(a,u),e=!0},p(a,u){s&&s.p&&(!e||u[1]&8388608)&&Le(s,i,a,a[54],e?Pe(i,a[54],u,Tc):Ce(a[54]),hr)},i(a){e||(Z(r,a),e=!0)},o(a){q(r,a),e=!1},d(a){r&&r.d(a)}}}function Hc(n){let e,i,s,r=[],a=new Map,u,c,f,d,p;const g=n[50].default,w=ke(g,n,n[54],mr),k=w||zc(n);let P=be(Array.from(n[9]));const C=z=>z[87].id;for(let z=0;z<P.length;z+=1){let E=dr(n,P,z),I=C(E);a.set(I,r[z]=vr(I,E))}let A=n[11]&&yr(cs(n));return{c(){var z;e=T("div"),k&&k.c(),s=W();for(let E=0;E<r.length;E+=1)r[E].c();u=W(),A&&A.c(),c=Ee(),m(e,"id",(z=n[23])==null?void 0:z.id),m(e,"class","anchor-wrapper svelte-bazd6o"),m(e,"role","button"),m(e,"tabindex","0"),m(e,"title",i=n[6]||""),Yt(e,"locked",n[4])},m(z,E){K(z,e,E),k&&k.m(e,null),n[53](e),K(z,s,E);for(let I=0;I<r.length;I+=1)r[I]&&r[I].m(z,E);K(z,u,E),A&&A.m(z,E),K(z,c,E),f=!0,d||(p=[lt(e,"mouseenter",n[51]),lt(e,"mouseleave",n[52]),lt(e,"mousedown",Un(Yn(n[25]))),lt(e,"mouseup",Un(n[24])),lt(e,"touchstart",Un(Yn(n[25]))),lt(e,"touchend",Un(n[24]))],d=!0)},p(z,E){w?w.p&&(!f||E[0]&3584|E[1]&8388608)&&Le(w,g,z,z[54],f?Pe(g,z[54],E,Ac):Ce(z[54]),mr):k&&k.p&&(!f||E[0]&3623)&&k.p(z,f?E:[-1,-1,-1]),(!f||E[0]&64&&i!==(i=z[6]||""))&&m(e,"title",i),(!f||E[0]&16)&&Yt(e,"locked",z[4]),E[0]&8405504|E[1]&8388608&&(P=be(Array.from(z[9])),ve(),r=vi(r,E,C,1,z,P,a,u.parentNode,co,vr,u,dr),ye()),z[11]?A?(A.p(cs(z),E),E[0]&2048&&Z(A,1)):(A=yr(cs(z)),A.c(),Z(A,1),A.m(c.parentNode,c)):A&&(ve(),q(A,1,1,()=>{A=null}),ye())},i(z){if(!f){Z(k,z);for(let E=0;E<P.length;E+=1)Z(r[E]);Z(A),f=!0}},o(z){q(k,z);for(let E=0;E<r.length;E+=1)q(r[E]);q(A),f=!1},d(z){z&&(Y(e),Y(s),Y(u),Y(c)),k&&k.d(z),n[53](null);for(let E=0;E<r.length;E+=1)r[E].d(z);A&&A.d(z),d=!1,qe(p)}}}let fs;const ui=nt(null);function Fc(n,e,i){if(e==="self")return;const s=n.parentNode;if(!s)return;s.removeChild(n);const r=document.querySelector(`#anchors-${e}-${i.id}`);r&&(r.appendChild(n),n&&i.recalculateAnchors())}function Gc(n,e,i){let s,r,a,u,c=Ht,f=()=>(c(),c=yn(ft,b=>i(55,u=b)),ft),d,p=Ht,g,w,k=Ht,P=()=>(k(),k=yn(r,b=>i(9,w=b)),r),C,A,z,E,I=Ht,D=()=>(I(),I=yn(a,b=>i(47,E=b)),a),X,H,j,J;gt(n,ui,b=>i(42,d=b)),n.$$.on_destroy.push(()=>c()),n.$$.on_destroy.push(()=>p()),n.$$.on_destroy.push(()=>k()),n.$$.on_destroy.push(()=>I());let{$$slots:$={},$$scope:st}=e;const ut=de("dynamic"),O=de("node"),it=de("edgeStore"),V=de("cursorAnchor"),_t=de("direction"),mt=de("mounted");gt(n,mt,b=>i(49,H=b));const F=de("graph"),R=de("nodeStore"),yt=de("graphEdge"),tt=de("nodeConnectEvent");gt(n,tt,b=>i(43,g=b));const Pt=de("anchorsMounted");gt(n,Pt,b=>i(56,j=b));const Mt=de("flowchart")||void 0;let{bgColor:vt=null}=e,{id:U=0}=e,{input:ot=!1}=e,{output:Q=!1}=e,{multiple:et=Q?!0:!ot}=e,{dynamic:Tt=ut||!1}=e,{edge:jt=null}=e,{inputsStore:ft=null}=e;f();let{key:At=null}=e,{outputStore:Dt=null}=e,{connections:Zt=[]}=e,{edgeColor:$t=nt(null)}=e,{edgeLabel:ze=""}=e,{locked:ae=!1}=e,{nodeConnect:rt=!1}=e,{edgeStyle:_e=null}=e,{endStyles:Rt=[null,null]}=e,{invisible:zt=!1}=e,{direction:Ft=_t==="TD"?ot?"north":"south":ot?"west":"east"}=e,{title:Xt=""}=e;const Ne=ji(),Ie=ji();let we,Ut=!1,tn=!1,te=0,cn=ot===Q?null:ot?"input":"output",fe=[];const ee=O.edge,me=O.anchors;gt(n,me,b=>i(48,X=b));const Ze=O.resizingWidth;gt(n,Ze,b=>i(46,z=b));const He=O.resizingHeight;gt(n,He,b=>i(45,A=b));const hn=O.rotating;gt(n,hn,b=>i(44,C=b));const je=O.connections;gt(n,je,b=>i(57,J=b));const Ue=`A-${U||me.count()+1}/${O.id}`,It=dc(F,O,Ue,{x:0,y:0},{width:0,height:0},ft||Dt||null,jt||ee||yt||null,cn,Ft,Tt,At,$t);me.add(It,It.id),qn(()=>{we&&It.recalculatePosition();const b=Array.from(bt(O.anchors)).reduce((dt,[,wt])=>(wt.type==="output"&&dt++,dt),0);if(J!=null&&J.length&&!ot){const dt=[];let wt=null;J.forEach((kt,Et)=>{kt&&(wt===null&&(wt=Et),(Et-wt)%b===0?(fe.push(kt),dt.push(null)):dt.push(kt))}),Bt(je,J=dt,J)}Bt(Pt,j++,j)}),ca(()=>{we&&It.recalculatePosition()}),fo(()=>{Xe(),cancelAnimationFrame(fs)});function Ke(b){var ce;it.delete("cursor");const dt={x:b.changedTouches[0].clientX,y:b.changedTouches[0].clientY},wt=document.elementFromPoint(dt.x,dt.y);if(!wt)return;const kt=wt.parentElement;if(!kt)return;const Et=kt.id,B=Et.split("/")[1],Vt=(ce=R.get(B))==null?void 0:ce.anchors.get(Et);Vt&&(it.delete("cursor"),Je(It,Vt,b))}function Je(b,dt,wt){const kt=fn(b,dt);kt&&Kt(),wt.shiftKey||Fe(kt)}function gn(b){if("changedTouches"in b&&s){Ke(b);return}if(!s){if(w!=null&&w.size&&!et){it.delete("cursor"),b.shiftKey||Fe(!1);return}d&&De(b)}}function zn(b){if(!ae){if(w!=null&&w.size&&!et&&!d)return bn();if(!d)return Bn();De(b)}}function Bn(){ot===Q?(Bt(ui,d={anchor:It,store:null,key:null},d),Se(It,V)):ot?(Bt(ui,d={anchor:It,store:ft,key:At},d),Se(V,It)):Q&&(Bt(ui,d={anchor:It,store:Dt,key:null},d),Se(It,V))}function Se(b,dt,wt=!1){const kt={color:$t,label:{text:ze}};wt&&(kt.disconnect=!0),_e&&(kt.type=_e),Rt[0]&&(kt.start=Rt[0]),Rt[1]&&(kt.start=Rt[1]);const Et=nr({source:b,target:dt},(b==null?void 0:b.edge)||null,kt);it.add(Et,"cursor")}function De(b){if(it.delete("cursor"),!d)return;const dt=d.anchor.type;if(d.anchor===It||dt===It.type&&dt){Fe(!1);return}It.recalculatePosition();let wt,kt;ot===Q?dt==="input"?(wt=It,kt=d.anchor):(wt=d.anchor,kt=It):ot?(wt=d.anchor,kt=It):(wt=It,kt=d.anchor),Je(wt,kt,b)}function fn(b,dt){if(b===dt||bt(b.connected).has(It))return!1;const wt={color:$t,label:{text:ze}};if(Mt){const Et=b.node.id.slice(2),B=Mt.nodeList[Et];if(B){const Vt=dt.node.id.slice(2),ce=B.children.filter(Jt=>Jt.node.id===Vt)[0];if(ce){const Jt=ce;wt.label={text:Jt.content}}}}_e&&(wt.type=_e),Rt[0]&&(wt.start=Rt[0]),Rt[1]&&(wt.start=Rt[1]);const kt=nr({source:b,target:dt},(b==null?void 0:b.edge)||null,wt);return!b.node||!dt.node?!1:(it.add(kt,new Set([b,dt,b.node,dt.node])),!0)}function Kt(){if(ot&&d&&d.store)u&&At&&ft&&typeof ft.set=="function"&&typeof ft.update=="function"&&Bt(ft,u[At]=d.store,u);else if(Q&&d&&d.store){const{store:b,key:dt}=d;b&&dt&&typeof b.update=="function"&&b.update(wt=>(Dt&&(wt[dt]=Dt),wt))}}function ue(){u&&At&&u[At]&&Bt(ft,u[At]=nt(bt(u[At])),u)}function Fe(b){(b||!g)&&(Bt(ui,d=null,d),Bt(tt,g=null,g))}function _n(){Ut&&(we&&It.recalculatePosition(),fs=requestAnimationFrame(_n))}function Xe(){it.delete("cursor"),it.match(It).forEach(dt=>it.delete(dt)),Fe(!1),ue()}function bn(){if(bt(It.connected).size>1)return;const b=Array.from(bt(It.connected))[0];if(b.type!=="input")if(Xe(),b.type==="output"){Se(b,V,!0),ue();const dt=b.store;Bt(ui,d={anchor:b,store:dt,key:null},d)}else Se(b,V,!0),Bt(ui,d={anchor:b,store:null,key:null},d)}function Tn(){fe.forEach((b,dt)=>{if(!b)return;Ve(b)&&i(26,Zt[dt]=null,Zt)}),i(41,fe=fe.filter(b=>b!==null))}function en(){Zt.forEach(b=>{b&&Ve(b)})}function Lt(b){const dt=`N-${b[0]}`,wt=R.get(dt);if(!wt)return;const kt=wt.anchors.get(`A-${b[1]}/N-${b[0]}`);if(!kt)return;const Et=it.match(It,kt);Et&&it.delete(Et[0])}const Ve=b=>{let dt,wt,kt=null;Array.isArray(b)?(dt=b[0].toString(),wt=b[1].toString()):(dt=b.toString(),wt=null);const Et=`N-${dt}`,B=R.get(Et);if(!B)return!1;if(wt){const Vt=`A-${wt}/${Et}`;kt=B.anchors.get(Vt)||null}else{const Vt=bt(B.anchors),ce=Array.from(Vt.values());if(!ce.length)return!1;kt=ce.reduce((Jt,Oe)=>!Jt&&Oe.type==="output"?null:Oe.type==="output"?Jt:!Jt||bt(Oe.connected).size<bt(Jt.connected).size?Oe:Jt,null)}if(!kt)return!1;if(fn(It,kt),kt.store&&(ft||Dt)){if(ot&&kt.type==="output")u&&At&&ft&&typeof ft.set=="function"&&typeof ft.update=="function"&&Bt(ft,u[At]=kt.store,u);else if(Q&&kt.type==="input"){const{store:Vt,inputKey:ce}=kt;Vt&&ce&&typeof Vt.update=="function"&&Vt.update(Jt=>(Dt&&(Jt[ce]=Dt),Jt))}}return!0},wn=()=>i(10,tn=!0),nn=()=>i(10,tn=!1);function kn(b){Kn[b?"unshift":"push"](()=>{we=b,i(8,we)})}return n.$$set=b=>{"bgColor"in b&&i(0,vt=b.bgColor),"id"in b&&i(27,U=b.id),"input"in b&&i(1,ot=b.input),"output"in b&&i(2,Q=b.output),"multiple"in b&&i(28,et=b.multiple),"dynamic"in b&&i(29,Tt=b.dynamic),"edge"in b&&i(7,jt=b.edge),"inputsStore"in b&&f(i(3,ft=b.inputsStore)),"key"in b&&i(30,At=b.key),"outputStore"in b&&i(31,Dt=b.outputStore),"connections"in b&&i(26,Zt=b.connections),"edgeColor"in b&&i(32,$t=b.edgeColor),"edgeLabel"in b&&i(33,ze=b.edgeLabel),"locked"in b&&i(4,ae=b.locked),"nodeConnect"in b&&i(34,rt=b.nodeConnect),"edgeStyle"in b&&i(35,_e=b.edgeStyle),"endStyles"in b&&i(36,Rt=b.endStyles),"invisible"in b&&i(5,zt=b.invisible),"direction"in b&&i(37,Ft=b.direction),"title"in b&&i(6,Xt=b.title),"$$scope"in b&&i(54,st=b.$$scope)},n.$$.update=()=>{if(n.$$.dirty[1]&2048&&i(11,s=(d==null?void 0:d.anchor)===It),n.$$.dirty[0]&536871168|n.$$.dirty[1]&65536&&Tt&&we&&Fc(we,E,O),n.$$.dirty[0]&67108864|n.$$.dirty[1]&262144&&H===R.count()&&Zt.length&&en(),n.$$.dirty[1]&4104&&rt&&g&&gn(g),n.$$.dirty[1]&263168&&H===R.count()&&fe.length&&Tn(),n.$$.dirty[0]&768|n.$$.dirty[1]&196608&&we&&It.recalculatePosition(),n.$$.dirty[1]&57600&&(!Ut&&(z||A||C)?(i(39,Ut=!0),_n()):!z&&!A&&Ut&&!C&&(i(39,Ut=!1),cancelAnimationFrame(fs))),n.$$.dirty[0]&512|n.$$.dirty[1]&512&&w){if(w.size<te)Ie("disconnection",{node:O,anchor:It});else if(w.size>te){const b=Array.from(w),dt=b[b.length-1];Ne("connection",{node:O,anchor:It,connectedNode:dt.node,connectedAnchor:dt})}i(40,te=w.size)}},P(i(13,r=It&&It.connected)),D(i(12,a=It==null?void 0:It.direction)),[vt,ot,Q,ft,ae,zt,Xt,jt,we,w,tn,s,a,r,it,mt,tt,Pt,me,Ze,He,hn,je,It,gn,zn,Zt,U,et,Tt,At,Dt,$t,ze,rt,_e,Rt,Ft,Lt,Ut,te,fe,d,g,C,A,z,E,X,H,$,wn,nn,kn,st]}class Go extends Mn{constructor(e){super(),Sn(this,e,Gc,Hc,pn,{bgColor:0,id:27,input:1,output:2,multiple:28,dynamic:29,edge:7,inputsStore:3,key:30,outputStore:31,connections:26,edgeColor:32,edgeLabel:33,locked:4,nodeConnect:34,edgeStyle:35,endStyles:36,invisible:5,direction:37,title:6,disconnect:38},null,[-1,-1,-1])}get disconnect(){return this.$$.ctx[38]}}function br(n){let e,i,s,r,a;return{c(){e=T("div"),i=W(),s=T("div"),m(e,"class","left svelte-1ryxg7v"),Yt(e,"width",n[0]),m(s,"class","right svelte-1ryxg7v"),Yt(s,"width",n[0])},m(u,c){K(u,e,c),K(u,i,c),K(u,s,c),r||(a=[ki(n[16].call(null,e,{left:n[3]})),ki(n[16].call(null,s,{right:n[4]}))],r=!0)},p(u,c){c[0]&1&&Yt(e,"width",u[0]),c[0]&1&&Yt(s,"width",u[0])},d(u){u&&(Y(e),Y(i),Y(s)),r=!1,qe(a)}}}function wr(n){let e,i,s,r,a;return{c(){e=T("div"),i=W(),s=T("div"),m(e,"class","top svelte-1ryxg7v"),Yt(e,"height",n[1]),m(s,"class","bottom svelte-1ryxg7v"),Yt(s,"height",n[1])},m(u,c){K(u,e,c),K(u,i,c),K(u,s,c),r||(a=[ki(n[16].call(null,e,{top:n[5]})),ki(n[16].call(null,s,{bottom:n[6]}))],r=!0)},p(u,c){c[0]&2&&Yt(e,"height",u[1]),c[0]&2&&Yt(s,"height",u[1])},d(u){u&&(Y(e),Y(i),Y(s)),r=!1,qe(a)}}}function jc(n){let e,i,s;return{c(){e=T("div"),m(e,"class","svelte-1ryxg7v"),Yt(e,"both",n[7])},m(r,a){K(r,e,a),i||(s=ki(n[16].call(null,e,{both:n[7]})),i=!0)},p:Ht,d(r){r&&Y(e),i=!1,s()}}}function kr(n){let e,i,s;return{c(){e=T("div"),m(e,"class","svelte-1ryxg7v"),Yt(e,"rotation",n[2])},m(r,a){K(r,e,a),i||(s=ki(n[17].call(null,e)),i=!0)},p(r,a){a[0]&4&&Yt(e,"rotation",r[2])},d(r){r&&Y(e),i=!1,s()}}}function Uc(n){let e,i,s,r,a=n[0]&&br(n),u=n[1]&&wr(n),c=n[7]&&jc(n),f=n[2]&&kr(n);return{c(){a&&a.c(),e=W(),u&&u.c(),i=W(),c&&c.c(),s=W(),f&&f.c(),r=Ee()},m(d,p){a&&a.m(d,p),K(d,e,p),u&&u.m(d,p),K(d,i,p),c&&c.m(d,p),K(d,s,p),f&&f.m(d,p),K(d,r,p)},p(d,p){d[0]?a?a.p(d,p):(a=br(d),a.c(),a.m(e.parentNode,e)):a&&(a.d(1),a=null),d[1]?u?u.p(d,p):(u=wr(d),u.c(),u.m(i.parentNode,i)):u&&(u.d(1),u=null),d[7]&&c.p(d,p),d[2]?f?f.p(d,p):(f=kr(d),f.c(),f.m(r.parentNode,r)):f&&(f.d(1),f=null)},i:Ht,o:Ht,d(d){d&&(Y(e),Y(i),Y(s),Y(r)),a&&a.d(d),u&&u.d(d),c&&c.d(d),f&&f.d(d)}}}function Xc(n){return n*(180/Math.PI)}function Vc(n,e,i){let s,r,a,u,c,f,d,p,g,w,k,P;gt(n,jn,ft=>i(38,d=ft));const C=de("graph"),A=de("node"),z=de("resized");let{width:E=!1}=e,{height:I=!1}=e,{rotation:D=!1}=e,{minHeight:X=0}=e,{minWidth:H=0}=e,j,J=E,$=E,st=I,ut=I,O=E&&I,it=0,V=0,_t=bt(A.position);const mt=A.position;gt(n,mt,ft=>i(32,k=ft));const F=A.resizingWidth;gt(n,F,ft=>i(31,w=ft));const R=A.resizingHeight;gt(n,R,ft=>i(30,g=ft));const yt=A.rotating;gt(n,yt,ft=>i(28,f=ft));const tt=A.rotation;gt(n,tt,ft=>i(29,p=ft));const Pt=A.dimensions.height;gt(n,Pt,ft=>i(26,u=ft));const Mt=A.dimensions.width;gt(n,Mt,ft=>i(27,c=ft));const vt=C.cursor;gt(n,vt,ft=>i(33,P=ft));let U,ot,Q=1;qn(()=>{try{j=document.querySelector(`#${A.id}`),j&&i(19,[H,X]=rs(j),H,i(18,X))}catch(ft){console.error(ft)}});function et(ft,At){const Dt=$t=>{$t.stopPropagation(),$t.preventDefault(),At.left||At.top?i(23,Q=-1):i(23,Q=1),gs.set(!0),Bt(jn,d=bt(vt),d),i(21,U=c),i(22,ot=u),i(20,_t=k),At.both?Bt(F,w=!0,w):Bt(F,w=!1,w),Bt(F,w=At.left||At.right||At.both||!1,w),Bt(R,g=At.top||At.bottom||At.both||!1,g),j&&i(19,[H,X]=rs(j),H,i(18,X)),window.addEventListener("mouseup",Zt)},Zt=()=>{Bt(F,w=!1,w),Bt(R,g=!1,g),gs.set(!1),window.removeEventListener("mouseup",Zt)};return ft.addEventListener("mousedown",Dt),{destroy(){ft.removeEventListener("mousedown",Dt)}}}function Tt(ft){const At=Zt=>{Zt.stopPropagation(),Zt.preventDefault(),it=p,Bt(jn,d=bt(vt),d);const $t=d.x-a.x,ze=d.y-a.y;V=Math.atan2(ze,$t),Bt(yt,f=!0,f),window.addEventListener("mouseup",Dt)},Dt=()=>{Bt(yt,f=!1,f),window.removeEventListener("mouseup",Dt)};return ft.addEventListener("mousedown",At),{destroy(){ft.removeEventListener("mousedown",At)}}}function jt(){const ft=bt(vt),At=ft.x-a.x,Dt=ft.y-a.y,Zt=Math.atan2(Dt,At),$t=V-Zt;return it-Xc($t)}return ku(()=>{j&&i(19,[H,X]=rs(j),H,i(18,X)),c<H&&z.set(!1),u<X&&z.set(!1)}),n.$$set=ft=>{"width"in ft&&i(0,E=ft.width),"height"in ft&&i(1,I=ft.height),"rotation"in ft&&i(2,D=ft.rotation),"minHeight"in ft&&i(18,X=ft.minHeight),"minWidth"in ft&&i(19,H=ft.minWidth)},n.$$.update=()=>{if(n.$$.dirty[0]&268435456|n.$$.dirty[1]&4&&f&&Bt(tt,p=jt(),p),n.$$.dirty[0]&1624506368|n.$$.dirty[1]&4&&g){const ft=bt(jn),At=P,Dt=Math.max(X,ot+(At.y-ft.y)*Q);Dt>X?(z.set(!0),Bt(Pt,u=Dt,u)):z.set(!1),Q===-1&&Bt(mt,k={x:_t.x,y:_t.y+At.y-ft.y},k),p!==0&&A.position.update(Zt=>({y:_t.y-(Dt-ot)/2,x:Zt.x}))}if(n.$$.dirty[0]&548929536|n.$$.dirty[1]&5&&w){const ft=bt(jn),At=P,Dt=Math.max(H,U+(At.x-ft.x)*Q);Dt>H?(z.set(!0),Bt(Mt,c=Dt,c)):z.set(!1),Q===-1&&Bt(mt,k={x:_t.x+At.x-ft.x,y:_t.y},k),p!==0&&A.position.update(Zt=>({x:_t.x-(Dt-U)/2,y:Zt.y}))}n.$$.dirty[1]&2&&i(25,s=k.x),n.$$.dirty[1]&2&&i(24,r=k.y),n.$$.dirty[0]&251658240&&(a={x:s+c/2,y:r+u/2})},[E,I,D,J,$,st,ut,O,mt,F,R,yt,tt,Pt,Mt,vt,et,Tt,X,H,_t,U,ot,Q,r,s,u,c,f,p,g,w,k,P]}class Yc extends Mn{constructor(e){super(),Sn(this,e,Vc,Uc,pn,{width:0,height:1,rotation:2,minHeight:18,minWidth:19},null,[-1,-1])}}function Pr(n,e,i){const s=n.slice();return s[28]=e[i],s[34]=i,s}function Lr(n,e,i){const s=n.slice();return s[28]=e[i],s[34]=i,s}function Cr(n,e,i){const s=n.slice();return s[28]=e[i],s}function Sr(n,e,i){const s=n.slice();return s[28]=e[i],s}function qc(n){let e,i=[],s=new Map,r,a,u=[],c=new Map,f,d=be({length:n[2]});const p=k=>k[34];for(let k=0;k<d.length;k+=1){let P=Lr(n,d,k),C=p(P);s.set(C,i[k]=Mr(C,P))}let g=be({length:n[3]});const w=k=>k[34];for(let k=0;k<g.length;k+=1){let P=Pr(n,g,k),C=w(P);c.set(C,u[k]=Tr(C,P))}return{c(){e=T("div");for(let k=0;k<i.length;k+=1)i[k].c();r=W(),a=T("div");for(let k=0;k<u.length;k+=1)u[k].c();m(e,"class","input-anchors svelte-j5bq7k"),Yt(e,"top",n[14]),Yt(e,"left",n[16]),m(a,"class","output-anchors svelte-j5bq7k"),Yt(a,"bottom",n[15]),Yt(a,"right",n[17])},m(k,P){K(k,e,P);for(let C=0;C<i.length;C+=1)i[C]&&i[C].m(e,null);K(k,r,P),K(k,a,P);for(let C=0;C<u.length;C+=1)u[C]&&u[C].m(a,null);f=!0},p(k,P){P[0]&16388&&(d=be({length:k[2]}),ve(),i=vi(i,P,p,1,k,d,s,e,co,Mr,null,Lr),ye()),P[0]&16392&&(g=be({length:k[3]}),ve(),u=vi(u,P,w,1,k,g,c,a,co,Tr,null,Pr),ye())},i(k){if(!f){for(let P=0;P<d.length;P+=1)Z(i[P]);for(let P=0;P<g.length;P+=1)Z(u[P]);f=!0}},o(k){for(let P=0;P<i.length;P+=1)q(i[P]);for(let P=0;P<u.length;P+=1)q(u[P]);f=!1},d(k){k&&(Y(e),Y(r),Y(a));for(let P=0;P<i.length;P+=1)i[P].d();for(let P=0;P<u.length;P+=1)u[P].d()}}}function Kc(n){let e,i,s,r=be({length:n[2]}),a=[];for(let p=0;p<r.length;p+=1)a[p]=Er(Sr(n,r,p));const u=p=>q(a[p],1,1,()=>{a[p]=null});let c=be({length:n[3]}),f=[];for(let p=0;p<c.length;p+=1)f[p]=Ar(Cr(n,c,p));const d=p=>q(f[p],1,1,()=>{f[p]=null});return{c(){for(let p=0;p<a.length;p+=1)a[p].c();e=W();for(let p=0;p<f.length;p+=1)f[p].c();i=Ee()},m(p,g){for(let w=0;w<a.length;w+=1)a[w]&&a[w].m(p,g);K(p,e,g);for(let w=0;w<f.length;w+=1)f[w]&&f[w].m(p,g);K(p,i,g),s=!0},p(p,g){if(g[0]&4){const w=r.length;r=be({length:p[2]});let k;for(k=w;k<r.length;k+=1){const P=Sr(p,r,k);a[k]?Z(a[k],1):(a[k]=Er(P),a[k].c(),Z(a[k],1),a[k].m(e.parentNode,e))}for(ve(),k=r.length;k<a.length;k+=1)u(k);ye()}if(g[0]&8){const w=c.length;c=be({length:p[3]});let k;for(k=w;k<c.length;k+=1){const P=Cr(p,c,k);f[k]?Z(f[k],1):(f[k]=Ar(P),f[k].c(),Z(f[k],1),f[k].m(i.parentNode,i))}for(ve(),k=c.length;k<f.length;k+=1)d(k);ye()}},i(p){if(!s){for(let g=0;g<r.length;g+=1)Z(a[g]);for(let g=0;g<c.length;g+=1)Z(f[g]);s=!0}},o(p){a=a.filter(Boolean);for(let g=0;g<a.length;g+=1)q(a[g]);f=f.filter(Boolean);for(let g=0;g<f.length;g+=1)q(f[g]);s=!1},d(p){p&&(Y(e),Y(i)),Pi(a,p),Pi(f,p)}}}function Mr(n,e){let i,s,r;return s=new Go({props:{input:!0,direction:e[14]?"north":"west"}}),s.$on("connection",e[22]),s.$on("disconnection",e[23]),{key:n,first:null,c(){i=Ee(),le(s.$$.fragment),this.first=i},m(a,u){K(a,i,u),oe(s,a,u),r=!0},p(a,u){e=a},i(a){r||(Z(s.$$.fragment,a),r=!0)},o(a){q(s.$$.fragment,a),r=!1},d(a){a&&Y(i),se(s,a)}}}function Tr(n,e){let i,s,r;return s=new Go({props:{output:!0,direction:e[14]?"south":"east"}}),s.$on("connection",e[24]),s.$on("disconnection",e[25]),{key:n,first:null,c(){i=Ee(),le(s.$$.fragment),this.first=i},m(a,u){K(a,i,u),oe(s,a,u),r=!0},p(a,u){e=a},i(a){r||(Z(s.$$.fragment,a),r=!0)},o(a){q(s.$$.fragment,a),r=!1},d(a){a&&Y(i),se(s,a)}}}function Er(n){let e,i;return e=new Go({}),e.$on("connection",n[18]),e.$on("disconnection",n[19]),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Ar(n){let e,i;return e=new Go({}),e.$on("connection",n[20]),e.$on("disconnection",n[21]),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function zr(n){let e,i;return e=new Yc({props:{width:!0,height:!0,rotation:!0}}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Jc(n){let e,i,s,r,a,u,c,f=`${n[1]}px`,d;const p=[Kc,qc],g=[];function w(P,C){return P[7]?0:1}i=w(n),s=g[i]=p[i](n);let k=n[6]&&zr();return{c(){e=T("div"),s.c(),r=W(),a=T("p"),u=ge(n[5]),c=W(),k&&k.c(),m(a,"class","svelte-j5bq7k"),at(a,"color",n[4]),m(e,"class","default-node svelte-j5bq7k"),Yt(e,"selected",n[0]),at(e,"border-radius",f)},m(P,C){K(P,e,C),g[i].m(e,null),y(e,r),y(e,a),y(a,u),y(e,c),k&&k.m(e,null),d=!0},p(P,C){s.p(P,C),(!d||C[0]&32)&&sn(u,P[5]),C[0]&16&&at(a,"color",P[4]),P[6]?k?C[0]&64&&Z(k,1):(k=zr(),k.c(),Z(k,1),k.m(e,null)):k&&(ve(),q(k,1,1,()=>{k=null}),ye()),(!d||C[0]&1)&&Yt(e,"selected",P[0]),C[0]&2&&f!==(f=`${P[1]}px`)&&at(e,"border-radius",f)},i(P){d||(Z(s),Z(k),d=!0)},o(P){q(s),q(k),d=!1},d(P){P&&Y(e),g[i].d(),k&&k.d()}}}function Qc(n,e,i){let s,r,a,u,c,f;const d=de("dynamic"),p=de("node");let{selected:g}=e;const w=p.label;gt(n,w,_t=>i(5,c=_t));const k=p.borderRadius;gt(n,k,_t=>i(1,s=_t));const P=p.textColor;gt(n,P,_t=>i(4,u=_t));const C=p.inputs;gt(n,C,_t=>i(2,r=_t));const A=p.outputs;gt(n,A,_t=>i(3,a=_t));const z=p.resizable;gt(n,z,_t=>i(6,f=_t));const E=bt(p.direction);let I=E==="TD",D=E==="TD",X=E!=="TD",H=E!=="TD";function j(_t){We.call(this,n,_t)}function J(_t){We.call(this,n,_t)}function $(_t){We.call(this,n,_t)}function st(_t){We.call(this,n,_t)}function ut(_t){We.call(this,n,_t)}function O(_t){We.call(this,n,_t)}function it(_t){We.call(this,n,_t)}function V(_t){We.call(this,n,_t)}return n.$$set=_t=>{"selected"in _t&&i(0,g=_t.selected)},[g,s,r,a,u,c,f,d,w,k,P,C,A,z,I,D,X,H,j,J,$,st,ut,O,it,V]}class $c extends Mn{constructor(e){super(),Sn(this,e,Qc,Jc,pn,{selected:0},null,[-1,-1])}}const th=n=>({}),Nr=n=>({}),eh=n=>({}),Ir=n=>({}),nh=n=>({}),Or=n=>({}),ih=n=>({}),Br=n=>({}),oh=n=>({selected:n[0]&2048}),Zr=n=>({grabHandle:n[50],selected:n[11],destroy:n[48]}),sh=n=>({selected:n[0]&2048}),Dr=n=>({grabHandle:n[50],selected:n[11],destroy:n[48]});function Rr(n){let e,i,s,r,a,u,c,f,d,p,g,w,k,P,C,A=`${n[14].y}px`,z=`${n[14].x}px`,E=`rotate(${n[20]}deg)`,I,D,X;const H=[lh,rh],j=[];function J(F,R){return F[12]?1:0}i=J(n),s=j[i]=H[i](n);const $=n[61].anchorWest,st=ke($,n,n[60],Br),ut=n[61].anchorEast,O=ke(ut,n,n[60],Or),it=n[61].anchorNorth,V=ke(it,n,n[60],Ir),_t=n[61].anchorSouth,mt=ke(_t,n,n[60],Nr);return{c(){e=T("div"),s.c(),r=W(),a=T("div"),st&&st.c(),c=W(),f=T("div"),O&&O.c(),p=W(),g=T("div"),V&&V.c(),k=W(),P=T("div"),mt&&mt.c(),m(a,"id",u=`anchors-west-${n[0].id}`),m(a,"class","anchors left svelte-1iknrz0"),m(f,"id",d=`anchors-east-${n[0].id}`),m(f,"class","anchors right svelte-1iknrz0"),m(g,"id",w=`anchors-north-${n[0].id}`),m(g,"class","anchors top svelte-1iknrz0"),m(P,"id",C=`anchors-south-${n[0].id}`),m(P,"class","anchors bottom svelte-1iknrz0"),m(e,"id",n[30]),m(e,"class","svelvet-node svelte-1iknrz0"),m(e,"role","button"),m(e,"title",n[10]),m(e,"tabindex",0),Yt(e,"selected",n[11]),Yt(e,"locked",n[16]||n[15]),at(e,"top",A),at(e,"left",z),at(e,"z-index",n[17]),at(e,"width",n[12]?n[19]+"px":"fit-content"),at(e,"height",n[12]?n[18]+"px":"fit-content"),at(e,"transform",E),at(e,"--prop-background-color",n[21]||(n[1]||n[2]?null:"transparent")),at(e,"--prop-text-color",n[22]),at(e,"--prop-border-color",n[23]),at(e,"--prop-selection-color",n[24]),at(e,"--prop-border-radius",n[25]?`${n[25]}px`:n[1]||n[2]?null:"0px"),at(e,"--prop-border-width",n[26]||(n[1]||n[2]?null:"0px"))},m(F,R){K(F,e,R),j[i].m(e,null),y(e,r),y(e,a),st&&st.m(a,null),y(e,c),y(e,f),O&&O.m(f,null),y(e,p),y(e,g),V&&V.m(g,null),y(e,k),y(e,P),mt&&mt.m(P,null),I=!0,D||(X=[lt(e,"contextmenu",Un(Yn(n[62]))),lt(e,"mouseup",n[49]),ki(n[50].call(null,e))],D=!0)},p(F,R){let yt=i;i=J(F),i===yt?j[i].p(F,R):(ve(),q(j[yt],1,1,()=>{j[yt]=null}),ye(),s=j[i],s?s.p(F,R):(s=j[i]=H[i](F),s.c()),Z(s,1),s.m(e,r)),st&&st.p&&(!I||R[1]&536870912)&&Le(st,$,F,F[60],I?Pe($,F[60],R,ih):Ce(F[60]),Br),(!I||R[0]&1&&u!==(u=`anchors-west-${F[0].id}`))&&m(a,"id",u),O&&O.p&&(!I||R[1]&536870912)&&Le(O,ut,F,F[60],I?Pe(ut,F[60],R,nh):Ce(F[60]),Or),(!I||R[0]&1&&d!==(d=`anchors-east-${F[0].id}`))&&m(f,"id",d),V&&V.p&&(!I||R[1]&536870912)&&Le(V,it,F,F[60],I?Pe(it,F[60],R,eh):Ce(F[60]),Ir),(!I||R[0]&1&&w!==(w=`anchors-north-${F[0].id}`))&&m(g,"id",w),mt&&mt.p&&(!I||R[1]&536870912)&&Le(mt,_t,F,F[60],I?Pe(_t,F[60],R,th):Ce(F[60]),Nr),(!I||R[0]&1&&C!==(C=`anchors-south-${F[0].id}`))&&m(P,"id",C),(!I||R[0]&1024)&&m(e,"title",F[10]),(!I||R[0]&2048)&&Yt(e,"selected",F[11]),(!I||R[0]&98304)&&Yt(e,"locked",F[16]||F[15]),R[0]&16384&&A!==(A=`${F[14].y}px`)&&at(e,"top",A),R[0]&16384&&z!==(z=`${F[14].x}px`)&&at(e,"left",z),R[0]&131072&&at(e,"z-index",F[17]),R[0]&528384&&at(e,"width",F[12]?F[19]+"px":"fit-content"),R[0]&266240&&at(e,"height",F[12]?F[18]+"px":"fit-content"),R[0]&1048576&&E!==(E=`rotate(${F[20]}deg)`)&&at(e,"transform",E),R[0]&2097158&&at(e,"--prop-background-color",F[21]||(F[1]||F[2]?null:"transparent")),R[0]&4194304&&at(e,"--prop-text-color",F[22]),R[0]&8388608&&at(e,"--prop-border-color",F[23]),R[0]&16777216&&at(e,"--prop-selection-color",F[24]),R[0]&33554438&&at(e,"--prop-border-radius",F[25]?`${F[25]}px`:F[1]||F[2]?null:"0px"),R[0]&67108870&&at(e,"--prop-border-width",F[26]||(F[1]||F[2]?null:"0px"))},i(F){I||(Z(s),Z(st,F),Z(O,F),Z(V,F),Z(mt,F),I=!0)},o(F){q(s),q(st,F),q(O,F),q(V,F),q(mt,F),I=!1},d(F){F&&Y(e),j[i].d(),st&&st.d(F),O&&O.d(F),V&&V.d(F),mt&&mt.d(F),D=!1,qe(X)}}}function rh(n){let e;const i=n[61].default,s=ke(i,n,n[60],Zr);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[0]&2048|a[1]&536870912)&&Le(s,i,r,r[60],e?Pe(i,r[60],a,oh):Ce(r[60]),Zr)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function lh(n){let e,i,s;const r=n[61].default,a=ke(r,n,n[60],Dr);return{c(){e=T("div"),a&&a.c(),Ei(()=>n[63].call(e)),at(e,"width","fit-content"),at(e,"height","fit-content")},m(u,c){K(u,e,c),a&&a.m(e,null),i=bu(e,n[63].bind(e)),s=!0},p(u,c){a&&a.p&&(!s||c[0]&2048|c[1]&536870912)&&Le(a,r,u,u[60],s?Pe(r,u[60],c,sh):Ce(u[60]),Dr)},i(u){s||(Z(a,u),s=!0)},o(u){q(a,u),s=!1},d(u){u&&Y(e),a&&a.d(u),i()}}}function ah(n){let e,i,s=!n[13]&&Rr(n);return{c(){s&&s.c(),e=Ee()},m(r,a){s&&s.m(r,a),K(r,e,a),i=!0},p(r,a){r[13]?s&&(ve(),q(s,1,1,()=>{s=null}),ye()):s?(s.p(r,a),a[0]&8192&&Z(s,1)):(s=Rr(r),s.c(),Z(s,1),s.m(e.parentNode,e))},i(r){i||(Z(s),i=!0)},o(r){q(s),i=!1},d(r){r&&Y(e),s&&s.d(r)}}}const uh=new Set(["INPUT","SELECT","BUTTON","TEXTAREA"]);function ch(n,e,i){let s,r,a,u,c,f,d,p=Ht,g=()=>(p(),p=yn(Ut,B=>i(66,d=B)),Ut),w,k=Ht,P=()=>(k(),k=yn(fe,B=>i(67,w=B)),fe),C,A,z=Ht,E=()=>(z(),z=yn(ee,B=>i(68,A=B)),ee),I,D,X,H=Ht,j=()=>(H(),H=yn(me,B=>i(71,X=B)),me),J,$,st,ut=Ht,O=()=>(ut(),ut=yn(we,B=>i(16,st=B)),we),it,V=Ht,_t=()=>(V(),V=yn(tn,B=>i(73,it=B)),tn),mt,F,R,yt,tt=Ht,Pt=()=>(tt(),tt=yn(te,B=>i(75,yt=B)),te),Mt,vt,U,ot,Q,et,Tt,jt,ft,At,Dt,Zt;gt(n,jn,B=>i(65,f=B)),gt(n,Vn,B=>i(70,D=B)),n.$$.on_destroy.push(()=>p()),n.$$.on_destroy.push(()=>k()),n.$$.on_destroy.push(()=>z()),n.$$.on_destroy.push(()=>H()),n.$$.on_destroy.push(()=>ut()),n.$$.on_destroy.push(()=>V()),n.$$.on_destroy.push(()=>tt());let{$$slots:$t={},$$scope:ze}=e;const ae=de("mounted"),rt=de("duplicate");gt(n,rt,B=>i(56,vt=B));const _e=de("graphDOMElement");gt(n,_e,B=>i(74,F=B));const Rt=ji();let{node:zt}=e,{isDefault:Ft}=e,{useDefaults:Xt}=e,{center:Ne}=e,{nodeStore:Ie}=e,{locked:we}=e;O();let{groups:Ut}=e;g();let{maxZIndex:tn}=e;_t();let{centerPoint:te}=e;Pt();let{cursor:cn}=e,{initialNodePositions:fe}=e;P();let{activeGroup:ee}=e;E();let{editing:me}=e;j();let{dimensionsProvided:Ze=!1}=e,{title:He}=e;const hn=nt(0),je=nt(null);gt(n,je,B=>i(64,c=B));const Ue=zt.id,It=zt.position;gt(n,It,B=>i(59,Q=B));const Ke=zt.dimensions.width;gt(n,Ke,B=>i(19,Mt=B));const Je=zt.dimensions.height;gt(n,Je,B=>i(18,R=B));const gn=zt.selectionColor;gt(n,gn,B=>i(24,At=B));const zn=zt.editable;gt(n,zn,B=>i(72,J=B));const Bn=zt.locked;gt(n,Bn,B=>i(15,$=B));const Se=zt.zIndex;gt(n,Se,B=>i(17,mt=B));const De=zt.bgColor;gt(n,De,B=>i(21,Tt=B));const fn=zt.borderRadius;gt(n,fn,B=>i(25,Dt=B));const Kt=zt.textColor;gt(n,Kt,B=>i(22,jt=B));const ue=zt.group;gt(n,ue,B=>i(69,I=B));const Fe=zt.borderColor;gt(n,Fe,B=>i(23,ft=B));const _n=zt.borderWidth;gt(n,_n,B=>i(26,Zt=B));const Xe=zt.rotation;gt(n,Xe,B=>i(20,et=B));const{selected:bn,hidden:Tn}=d,en=Tn.nodes;gt(n,en,B=>i(58,ot=B));const Lt=bn.nodes;gt(n,Lt,B=>i(55,C=B));const Ve=nt(!1);gt(n,Ve,B=>i(57,U=B)),Ae("node",zt),Ae("anchorsMounted",hn),Ae("resized",Ve),Ae("nodeConnectEvent",je),qn(()=>{if(Ne){const B={x:yt.x-Mt/2,y:yt.y-R/2};zt.position.set(B),Vn.set(!0),Vn.set(!1)}ae.update(B=>B+1)}),fo(()=>{r&&(C.delete(zt),Lt.set(C)),ae.update(B=>B-1)});function wn(){r?(zt&&C.delete(zt),Lt.set(C)):(zt&&C.add(zt),Lt.set(C))}function nn(B){Bt(jn,f=bt(cn),f),F.focus(),mt!==it&&mt!==1/0&&Bt(Se,mt=Bt(tn,++it,it),mt);const Vt=B.target;if(!uh.has(Vt.tagName)&&(B.preventDefault(),Rt("nodeClicked",{node:zt,e:B}),!(st||$))){if("touches"in B){if(B.touches&&B.touches.length>1)return}else B.button===2&&J&&Bt(me,X=zt,X);Bt(Vn,D=!0,D),kn(B)}}function kn(B){let Vt,ce,Jt=!1;const Oe=I;Oe&&(Vt=d[Oe],ce=bt(Vt.parent),Jt=ce===zt),Jt?Bt(ee,A=Oe,A):Bt(ee,A="selected",A),!B.shiftKey&&r?Bt(ee,A="selected",A):(!B.shiftKey&&!r&&!B.shiftKey&&(C.clear(),Lt.set(C)),wn()),Bt(fe,w=ka(d.selected.nodes),w)}function b(){Ie.delete(Ue)}function dt(B){const Vt=bt(cn),ce=Vt.x-f.x,Jt=Vt.y-f.y;Math.abs(ce)+Math.abs(Jt)<4&&Rt("nodeReleased",{e:B,node:zt}),Bt(je,c=B,c)}function wt(B){return B.addEventListener("mousedown",nn),B.addEventListener("touchstart",nn),{destroy(){B.removeEventListener("mousedown",nn),B.removeEventListener("touchstart",nn)}}}function kt(B){We.call(this,n,B)}function Et(){R=this.clientHeight,Je.set(R),Mt=this.clientWidth,Ke.set(Mt)}return n.$$set=B=>{"node"in B&&i(0,zt=B.node),"isDefault"in B&&i(1,Ft=B.isDefault),"useDefaults"in B&&i(2,Xt=B.useDefaults),"center"in B&&i(51,Ne=B.center),"nodeStore"in B&&i(52,Ie=B.nodeStore),"locked"in B&&O(i(3,we=B.locked)),"groups"in B&&g(i(4,Ut=B.groups)),"maxZIndex"in B&&_t(i(5,tn=B.maxZIndex)),"centerPoint"in B&&Pt(i(6,te=B.centerPoint)),"cursor"in B&&i(53,cn=B.cursor),"initialNodePositions"in B&&P(i(7,fe=B.initialNodePositions)),"activeGroup"in B&&E(i(8,ee=B.activeGroup)),"editing"in B&&j(i(9,me=B.editing)),"dimensionsProvided"in B&&i(54,Ze=B.dimensionsProvided),"title"in B&&i(10,He=B.title),"$$scope"in B&&i(60,ze=B.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&268435456&&i(14,s=Q),n.$$.dirty[0]&1|n.$$.dirty[1]&16777216&&i(11,r=C.has(zt)),n.$$.dirty[0]&1|n.$$.dirty[1]&134217728&&i(13,a=ot.has(zt)),n.$$.dirty[1]&75497472&&i(12,u=Ze||U),n.$$.dirty[0]&2049|n.$$.dirty[1]&33554432&&r&&vt&&Rt("duplicate",zt)},[zt,Ft,Xt,we,Ut,tn,te,fe,ee,me,He,r,u,a,s,$,st,mt,R,Mt,et,Tt,jt,ft,At,Dt,Zt,rt,_e,je,Ue,It,Ke,Je,gn,zn,Bn,Se,De,fn,Kt,ue,Fe,_n,Xe,en,Lt,Ve,b,dt,wt,Ne,Ie,cn,Ze,C,vt,U,ot,Q,ze,$t,kt,Et]}class hh extends Mn{constructor(e){super(),Sn(this,e,ch,ah,pn,{node:0,isDefault:1,useDefaults:2,center:51,nodeStore:52,locked:3,groups:4,maxZIndex:5,centerPoint:6,cursor:53,initialNodePositions:7,activeGroup:8,editing:9,dimensionsProvided:54,title:10},null,[-1,-1,-1])}}const fh=n=>({selected:n[1]&262144,grabHandle:n[1]&524288,node:n[0]&128,destroy:n[1]&131072}),xr=n=>({selected:n[49],grabHandle:n[50],disconnect:n[14],connect:n[13],node:n[7],destroy:n[48]}),dh=n=>({}),Wr=n=>({slot:"anchorWest"}),_h=n=>({}),Hr=n=>({slot:"anchorEast"}),mh=n=>({}),Fr=n=>({slot:"anchorNorth"}),ph=n=>({}),Gr=n=>({slot:"anchorSouth"});function jr(n){let e,i;return e=new hh({props:{node:n[7],center:n[5]||n[0]==="center",isDefault:n[8],useDefaults:n[4],dimensionsProvided:!!n[1]||!!n[2]||!!n[3]||n[8]||!1,nodeStore:n[11].nodes,locked:n[11].locked,groups:n[11].groups,title:n[6],maxZIndex:n[11].maxZIndex,centerPoint:n[11].center,cursor:n[11].cursor,activeGroup:n[11].activeGroup,editing:n[11].editing,initialNodePositions:n[11].initialNodePositions,$$slots:{anchorSouth:[kh],anchorNorth:[wh],anchorEast:[bh],anchorWest:[yh],default:[vh,({destroy:s,selected:r,grabHandle:a})=>({48:s,49:r,50:a}),({destroy:s,selected:r,grabHandle:a})=>[0,(s?131072:0)|(r?262144:0)|(a?524288:0)]]},$$scope:{ctx:n}}}),e.$on("nodeClicked",n[41]),e.$on("nodeMount",n[42]),e.$on("nodeReleased",n[43]),e.$on("duplicate",n[44]),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const a={};r[0]&128&&(a.node=s[7]),r[0]&33&&(a.center=s[5]||s[0]==="center"),r[0]&256&&(a.isDefault=s[8]),r[0]&16&&(a.useDefaults=s[4]),r[0]&270&&(a.dimensionsProvided=!!s[1]||!!s[2]||!!s[3]||s[8]||!1),r[0]&64&&(a.title=s[6]),r[0]&384|r[1]&933888&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Ur(n){let e,i;return e=new $c({props:{selected:n[49]}}),e.$on("connection",n[39]),e.$on("disconnection",n[40]),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const a={};r[1]&262144&&(a.selected=s[49]),e.$set(a)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function gh(n){let e,i,s=n[8]&&Ur(n);return{c(){s&&s.c(),e=Ee()},m(r,a){s&&s.m(r,a),K(r,e,a),i=!0},p(r,a){r[8]?s?(s.p(r,a),a[0]&256&&Z(s,1)):(s=Ur(r),s.c(),Z(s,1),s.m(e.parentNode,e)):s&&(ve(),q(s,1,1,()=>{s=null}),ye())},i(r){i||(Z(s),i=!0)},o(r){q(s),i=!1},d(r){r&&Y(e),s&&s.d(r)}}}function vh(n){let e;const i=n[38].default,s=ke(i,n,n[45],xr),r=s||gh(n);return{c(){r&&r.c()},m(a,u){r&&r.m(a,u),e=!0},p(a,u){s?s.p&&(!e||u[0]&128|u[1]&933888)&&Le(s,i,a,a[45],e?Pe(i,a[45],u,fh):Ce(a[45]),xr):r&&r.p&&(!e||u[0]&256|u[1]&262144)&&r.p(a,e?u:[-1,-1])},i(a){e||(Z(r,a),e=!0)},o(a){q(r,a),e=!1},d(a){r&&r.d(a)}}}function yh(n){let e;const i=n[38].anchorWest,s=ke(i,n,n[45],Wr);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&16384)&&Le(s,i,r,r[45],e?Pe(i,r[45],a,dh):Ce(r[45]),Wr)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function bh(n){let e;const i=n[38].anchorEast,s=ke(i,n,n[45],Hr);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&16384)&&Le(s,i,r,r[45],e?Pe(i,r[45],a,_h):Ce(r[45]),Hr)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function wh(n){let e;const i=n[38].anchorNorth,s=ke(i,n,n[45],Fr);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&16384)&&Le(s,i,r,r[45],e?Pe(i,r[45],a,mh):Ce(r[45]),Fr)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function kh(n){let e;const i=n[38].anchorSouth,s=ke(i,n,n[45],Gr);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&16384)&&Le(s,i,r,r[45],e?Pe(i,r[45],a,ph):Ce(r[45]),Gr)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function Ph(n){let e=n[7]&&n[10].get(n[7].id),i,s,r=e&&jr(n);return{c(){r&&r.c(),i=Ee()},m(a,u){r&&r.m(a,u),K(a,i,u),s=!0},p(a,u){u[0]&1152&&(e=a[7]&&a[10].get(a[7].id)),e?r?(r.p(a,u),u[0]&1152&&Z(r,1)):(r=jr(a),r.c(),Z(r,1),r.m(i.parentNode,i)):r&&(ve(),q(r,1,1,()=>{r=null}),ye())},i(a){s||(Z(r),s=!0)},o(a){q(r),s=!1},d(a){a&&Y(i),r&&r.d(a)}}}function Lh(n,e,i){let s,r,a=Ht,u=()=>(a(),a=yn(s,rt=>i(37,r=rt)),s),c;n.$$.on_destroy.push(()=>a());let{$$slots:f={},$$scope:d}=e;const p=ws(f),g=de("graph"),w=de("group");let{position:k={x:0,y:0}}=e,{drop:P=!1}=e,{dimensions:C=null}=e,{id:A=0}=e,{bgColor:z=null}=e,{borderRadius:E=null}=e,{borderColor:I=null}=e,{borderWidth:D=null}=e,{selectionColor:X=null}=e,{textColor:H=null}=e,{resizable:j=!1}=e,{label:J=""}=e,{inputs:$=1}=e,{outputs:st=1}=e,{width:ut=null}=e,{height:O=null}=e,{TD:it=!1}=e,{LR:V=!1}=e,{zIndex:_t=1}=e,{editable:mt=!0}=e,{locked:F=!1}=e,{rotation:R=0}=e,{edge:yt=null}=e,{connections:tt=[]}=e,{useDefaults:Pt=!1}=e,{center:Mt=!1}=e,{dynamic:vt=!1}=e,{title:U=""}=e;const ot=g.nodes;gt(n,ot,rt=>i(10,c=rt)),Ae("dynamic",vt);let Q,et=!0;qn(()=>{const rt=it?"TD":V?"LR":g.direction,_e=g.groupBoxes.get(w),Rt=g.nodes.count()+1;i(8,et=!p.default),(p.anchorWest||p.anchorEast||p.anchorNorth||p.anchorSouth)&&i(8,et=!1);const zt=C||(ut||O?{width:ut||O||200,height:O||ut||100}:et?{width:200,height:100}:{width:0,height:0}),Ft={id:A||Rt,position:P==="cursor"?{x:bt(g.cursor).x,y:bt(g.cursor).y}:_e?{x:bt(_e.position).x+k.x,y:bt(_e.position).y+k.y}:k,dimensions:zt,editable:mt||g.editable,label:J,group:w,resizable:j,inputs:$,outputs:st,zIndex:_t,direction:rt,locked:F,rotation:R};tt.length&&(Ft.connections=tt),D&&(Ft.borderWidth=D),E&&(Ft.borderRadius=E),I&&(Ft.borderColor=I),X&&(Ft.selectionColor=X),H&&(Ft.textColor=H),z&&(Ft.bgColor=z),yt&&(Ft.edge=yt),i(7,Q=Eu(Ft)),_e&&g.groups.update(Xt=>{const Ne=bt(Xt[w].nodes);return Xt[w].nodes.set(new Set([...Ne,Q])),Xt}),g.nodes.add(Q,Q.id)}),fo(()=>{g.nodes.delete(Q.id)});function Tt(rt){Q&&Q.connections.set([rt])}function jt(rt){if(!Q)return;(Array.isArray(rt)?rt:[rt]).forEach(Rt=>{const[zt,Ft]=Array.isArray(Rt)?Rt:[Rt,null],Xt=`N-${zt}`,Ne=g.nodes.get(Xt);if(!Ne)return;let Ie=null;const we=Ft?`A-${Ft}/${Xt}`:null;we&&(Ie=Ne.anchors.get(we));const Ut=g.edges.match(Q,Ne,Ie);Ut.length&&g.edges.delete(Ut[Ut.length-1])})}Ae("connect",Tt),Ae("disconnect",jt);let ft=k;function At(rt){We.call(this,n,rt)}function Dt(rt){We.call(this,n,rt)}function Zt(rt){We.call(this,n,rt)}function $t(rt){We.call(this,n,rt)}function ze(rt){We.call(this,n,rt)}function ae(rt){We.call(this,n,rt)}return n.$$set=rt=>{"position"in rt&&i(15,k=rt.position),"drop"in rt&&i(0,P=rt.drop),"dimensions"in rt&&i(1,C=rt.dimensions),"id"in rt&&i(16,A=rt.id),"bgColor"in rt&&i(17,z=rt.bgColor),"borderRadius"in rt&&i(18,E=rt.borderRadius),"borderColor"in rt&&i(19,I=rt.borderColor),"borderWidth"in rt&&i(20,D=rt.borderWidth),"selectionColor"in rt&&i(21,X=rt.selectionColor),"textColor"in rt&&i(22,H=rt.textColor),"resizable"in rt&&i(23,j=rt.resizable),"label"in rt&&i(24,J=rt.label),"inputs"in rt&&i(25,$=rt.inputs),"outputs"in rt&&i(26,st=rt.outputs),"width"in rt&&i(2,ut=rt.width),"height"in rt&&i(3,O=rt.height),"TD"in rt&&i(27,it=rt.TD),"LR"in rt&&i(28,V=rt.LR),"zIndex"in rt&&i(29,_t=rt.zIndex),"editable"in rt&&i(30,mt=rt.editable),"locked"in rt&&i(31,F=rt.locked),"rotation"in rt&&i(32,R=rt.rotation),"edge"in rt&&i(33,yt=rt.edge),"connections"in rt&&i(34,tt=rt.connections),"useDefaults"in rt&&i(4,Pt=rt.useDefaults),"center"in rt&&i(5,Mt=rt.center),"dynamic"in rt&&i(35,vt=rt.dynamic),"title"in rt&&i(6,U=rt.title),"$$scope"in rt&&i(45,d=rt.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&128|n.$$.dirty[1]&8&&Q&&Q.connections.set(tt),n.$$.dirty[0]&131200&&Q&&Q.bgColor.set(z),n.$$.dirty[0]&16777344&&Q&&Q.label.set(J),n.$$.dirty[0]&4194432&&Q&&Q.textColor.set(H),n.$$.dirty[0]&524416&&Q&&Q.borderColor.set(I),n.$$.dirty[0]&2097280&&Q&&Q.selectionColor.set(X),n.$$.dirty[0]&8388736&&Q&&Q.resizable.set(j),n.$$.dirty[0]&1073741952&&Q&&Q.editable.set(mt),n.$$.dirty[0]&128|n.$$.dirty[1]&1&&Q&&Q.locked.set(F),n.$$.dirty[0]&33554560&&Q&&Q.inputs.set($),n.$$.dirty[0]&67108992&&Q&&Q.outputs.set(st),n.$$.dirty[0]&536871040&&Q&&Q.zIndex.set(_t),n.$$.dirty[0]&128&&u(i(9,s=Q&&(Q==null?void 0:Q.position))),n.$$.dirty[0]&32896|n.$$.dirty[1]&96&&Q){const{x:rt,y:_e}=ft,{x:Rt,y:zt}=r,{x:Ft,y:Xt}=k;(Ft!==Rt||Xt!==zt)&&(Ft!==rt||Xt!==_e?(i(36,ft=k),Q.position.set(k)):(i(36,ft=r),i(15,k=r)))}n.$$.dirty[0]&33554560&&Q&&Q.inputs.set($),n.$$.dirty[0]&67108992&&Q&&Q.outputs.set(st)},[P,C,ut,O,Pt,Mt,U,Q,et,s,c,g,ot,Tt,jt,k,A,z,E,I,D,X,H,j,J,$,st,it,V,_t,mt,F,R,yt,tt,vt,ft,r,f,At,Dt,Zt,$t,ze,ae,d]}class ks extends Mn{constructor(e){super(),Sn(this,e,Lh,Ph,pn,{position:15,drop:0,dimensions:1,id:16,bgColor:17,borderRadius:18,borderColor:19,borderWidth:20,selectionColor:21,textColor:22,resizable:23,label:24,inputs:25,outputs:26,width:2,height:3,TD:27,LR:28,zIndex:29,editable:30,locked:31,rotation:32,edge:33,connections:34,useDefaults:4,center:5,dynamic:35,title:6},null,[-1,-1])}}function Ch(n){n.parentNodes.forEach(a=>Sh(a));const[e,i]=Mh(n);Th(e,n),Eh(e);for(let a=0;a<10;a++){let u=!1;for(let c=0;c<=i;c++)if(e[c])for(let f=0;f<e[c].length;f++){const d=e[c][f],p=zh(e,d,f);p&&(Ti(e[c],f,p),u=!0)}if(!u)break}const s=Nh(e);for(let a=0;a<10&&Ih(e,s);a++);for(let a=0;a<2;a++){let u=!1;for(let c=0;c<=i;c++)for(let f=0;f<e[c].length;f++){const d=e[c][f],p=Ah(e,d,f);p&&(Ti(e[c],f,p),u=!0)}if(!u)break}const r=[];for(let a=0;a<=i;a++)r.push(e[a]);return r}function Sh(n,e=0,i=0){const s=[],r=(a,u=0,c=0)=>{a.depth=Math.max(a.depth,u),a.nesting=Math.max(a.nesting,c),s.push(a);for(const f of a.children){const{node:d,length:p}=f;r(d,p+u,c+1)}};r(n,e,i);for(const a of s)if(a.children.length){a.nesting=a.children[0].node.nesting-1,a.depth=a.children[0].node.depth-a.children[0].length;for(const u of a.children)a.nesting=Math.min(a.nesting,u.node.nesting-1),a.depth=Math.min(a.depth,u.node.depth-u.length)}}function Mh(n){let e=0;const i={};for(const s in n.nodeList){const{depth:r,parents:a,children:u,type:c,data:f}=n.nodeList[s];e=Math.max(e,r),i[r]||(i[r]=[]);const d={id:s,label:f.content,children:[],parents:[],layer:r,type:c.trim()};f.props&&(d.propsId=f.props.trim());for(const p of a)d.parents.push(p.node.id);for(const p of u)d.children.push(p.node.id);i[r].push(d)}return[i,e]}function Th(n,e){for(const i in e.nodeList)for(const s of e.nodeList[i].children)if(s.node.depth-1>e.nodeList[i].depth){const r=e.nodeList[i].depth+1,a=s.node.depth-1,u=[];let c=0;for(let f=r;f<=a;f++){const d={id:`GHOST_${s.node.id}_${c}`,label:"",children:[],parents:[],layer:f,ignore:!0};u.push(d),c++}for(const f of s.node.parents)u[0].parents.push(f.node.id);u[u.length-1].children.push(s.node.id);for(let f=0;f<u.length-1;f++)u[f].children.push(`GHOST_${s.node.id}_${f+1}`);for(let f=a;f>=r;f--)u.length>0&&n[f].push(u[0]);for(const f of n[e.nodeList[i].depth])f.id===i&&(f.children.push(u[0].id),f.children=f.children.filter(d=>d!==s.node.id))}}function Eh(n){let e=0;for(const i in n)e=Math.max(n[i].length,e);for(const i in n)if(n[i].length<e){const s=Array.from({length:e-n[i].length},()=>({id:"NULL_NODE",children:[],parents:[],layer:parseInt(i),ignore:!0}));n[i]=n[i].concat(s)}}function Xr(n,e,i){let s=0,r=0;for(const a of e.parents){for(let u=0;u<n[e.layer-1].length;u++)if(a===n[e.layer-1][u].id){s+=Math.abs(i-u);break}r++}for(const a of e.children){for(let u=0;u<n[e.layer+1].length;u++)if(a===n[e.layer+1][u].id){s+=Math.abs(i-u);break}r++}return isNaN(s/r)?0:s/r}function Vr(n,e,i){let s=0,r=0;for(const a of e.parents){for(let u=0;u<n[e.layer-1].length;u++)if(a===n[e.layer-1][u].id){s+=Math.abs(i-u);break}r++}return isNaN(s/r)?0:s/r}function Yr(n,e,i){let s=0,r=0;for(const a of e.children){for(let u=0;u<n[e.layer+1].length;u++)if(a===n[e.layer+1][u].id){s+=Math.abs(i-u);break}r++}return isNaN(s/r)?0:s/r}function Ah(n,e,i){const s=vs(n,e.layer);let r=0;e.layer===0?r=Yr(n,e,i):r=Vr(n,e,i);let a=r,u=i;for(let c=0;c<n[e.layer].length;c++)if(n[e.layer][c].id==="NULL_NODE"){Ti(n[e.layer],i,c);const d=vs(n,e.layer);let p=0;e.layer===0?p=Yr(n,e,c):p=Vr(n,e,c),d<=s&&p<a&&(a=p,u=c),Ti(n[e.layer],c,i)}return u===i?null:u}function zh(n,e,i){const s={};let r=1/0,a=0;for(let u=0;u<n[e.layer].length;u++){const c=Xr(n,e,u),f=Xr(n,n[e.layer][u],i);s[u]=c+f}for(const u in s)s[u]<r&&(r=s[u],a=parseInt(u));return a===i?null:a}function Ti(n,e,i){const s=n[e];n[e]=n[i],n[i]=s}function Nh(n){const e=[];for(const i in n)for(const s of n[i])e.push(s);return e.sort((i,s)=>s.parents.length+s.children.length-(i.parents.length+i.children.length))}function vs(n,e){let i=0;for(let s=0;s<n[e].length;s++){const r=n[e][s],a=[],u=[];if(n[e-1])for(let c=s+1;c<n[e-1].length;c++)r.parents.includes(n[e-1][c].id)&&a.push(c);if(n[e+1])for(let c=s+1;c<n[e+1].length;c++)r.children.includes(n[e+1][c].id)&&u.push(c);for(let c=s+1;c<n[e].length;c++){const f=n[e][c];if(a.length)for(let d=0;d<n[e-1].length;d++)f.parents.includes(n[e-1][d].id)&&a.forEach(p=>{d<p&&i++});if(u.length)for(let d=0;d<n[e+1].length;d++)f.children.includes(n[e+1][d].id)&&u.forEach(p=>{d<p&&i++})}}return i}function Ih(n,e){let i=!1;for(const s of e){if(s.children.length+s.parents.length===0)return i;let r=0;for(let c=0;c<n[s.layer].length;c++)if(n[s.layer][c].id===s.id){r=c;break}let a=1/0,u=r;for(let c=0;c<n[s.layer].length;c++){Ti(n[s.layer],r,c);const f=vs(n,s.layer);f<a&&(a=f,u=c),Ti(n[s.layer],c,r)}u!==r&&(Ti(n[s.layer],r,u),i=!0)}return i}function qr(n,e,i){const s=n.slice();return s[6]=e[i],s}function Kr(n,e,i){const s=n.slice();return s[9]=e[i],s}function Oh(n){let e,i;const s=[{label:n[9].label},{id:n[9].id},{TD:!0},n[0][n[9].id],{connections:n[9].children.map($r)}];let r={};for(let a=0;a<s.length;a+=1)r=bs(r,s[a]);return e=new ks({props:r}),{c(){le(e.$$.fragment)},m(a,u){oe(e,a,u),i=!0},p(a,u){const c=u&3?ma(s,[u&2&&{label:a[9].label},u&2&&{id:a[9].id},s[2],pa(a[0][a[9].id]),u&2&&{connections:a[9].children.map($r)}]):{};e.$set(c)},i(a){i||(Z(e.$$.fragment,a),i=!0)},o(a){q(e.$$.fragment,a),i=!1},d(a){se(e,a)}}}function Jr(n){let e,i,s=!n[9].ignore&&Oh(n);return{c(){s&&s.c(),e=Ee()},m(r,a){s&&s.m(r,a),K(r,e,a),i=!0},p(r,a){r[9].ignore||s.p(r,a)},i(r){i||(Z(s),i=!0)},o(r){q(s),i=!1},d(r){r&&Y(e),s&&s.d(r)}}}function Qr(n){let e,i,s=be(n[6]),r=[];for(let u=0;u<s.length;u+=1)r[u]=Jr(Kr(n,s,u));const a=u=>q(r[u],1,1,()=>{r[u]=null});return{c(){for(let u=0;u<r.length;u+=1)r[u].c();e=Ee()},m(u,c){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(u,c);K(u,e,c),i=!0},p(u,c){if(c&3){s=be(u[6]);let f;for(f=0;f<s.length;f+=1){const d=Kr(u,s,f);r[f]?(r[f].p(d,c),Z(r[f],1)):(r[f]=Jr(d),r[f].c(),Z(r[f],1),r[f].m(e.parentNode,e))}for(ve(),f=s.length;f<r.length;f+=1)a(f);ye()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)Z(r[c]);i=!0}},o(u){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)q(r[c]);i=!1},d(u){u&&Y(e),Pi(r,u)}}}function Bh(n){let e,i,s=be(n[1]),r=[];for(let u=0;u<s.length;u+=1)r[u]=Qr(qr(n,s,u));const a=u=>q(r[u],1,1,()=>{r[u]=null});return{c(){for(let u=0;u<r.length;u+=1)r[u].c();e=Ee()},m(u,c){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(u,c);K(u,e,c),i=!0},p(u,[c]){if(c&3){s=be(u[1]);let f;for(f=0;f<s.length;f+=1){const d=qr(u,s,f);r[f]?(r[f].p(d,c),Z(r[f],1)):(r[f]=Qr(d),r[f].c(),Z(r[f],1),r[f].m(e.parentNode,e))}for(ve(),f=s.length;f<r.length;f+=1)a(f);ye()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)Z(r[c]);i=!0}},o(u){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)q(r[c]);i=!1},d(u){u&&Y(e),Pi(r,u)}}}const Zh=100,Dh=100,$r=n=>[n,"1"];function Rh(n,e,i){let{mermaid:s=""}=e,{mermaidConfig:r={}}=e;const a=Uu(s);Ae("flowchart",a);const u=Ch(a),c=de("graph");let f;return qn(()=>{c.nodes.subscribe(p=>f=Object.fromEntries(p));let d=0;for(const p of u){let g=0,w=-1/0;for(const k of p)k.ignore||(f[`N-${k.id}`].position.update(()=>({x:g,y:d})),f[`N-${k.id}`].dimensions.width.subscribe(P=>g+=P),f[`N-${k.id}`].dimensions.height.subscribe(P=>w=Math.max(w,P))),g+=Zh;d+=w+Dh}}),n.$$set=d=>{"mermaid"in d&&i(2,s=d.mermaid),"mermaidConfig"in d&&i(0,r=d.mermaidConfig)},[r,u,s]}class xh extends Mn{constructor(e){super(),Sn(this,e,Rh,Bh,pn,{mermaid:2,mermaidConfig:0})}}const Wh="modulepreload",Hh=function(n){return"/"+n},tl={},oo=function(e,i,s){let r=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),c=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));r=Promise.allSettled(i.map(f=>{if(f=Hh(f),f in tl)return;tl[f]=!0;const d=f.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${p}`))return;const g=document.createElement("link");if(g.rel=d?"stylesheet":Wh,d||(g.as="script"),g.crossOrigin="",g.href=f,c&&g.setAttribute("nonce",c),document.head.appendChild(g),d)return new Promise((w,k)=>{g.addEventListener("load",w),g.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return r.then(u=>{for(const c of u||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})},Fh=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"],Gh=new Set(Fh),el=n=>Gh.has(n);function jh(n){let e,i,s;return{c(){e=T("input"),m(e,"placeholder",n[0]),m(e,"type","text")},m(r,a){K(r,e,a),pe(e,n[1]),i||(s=[lt(e,"keydown",Un(n[3])),lt(e,"click",Un(n[4])),lt(e,"mousedown",Un(n[5])),lt(e,"input",n[6])],i=!0)},p(r,[a]){a&1&&m(e,"placeholder",r[0]),a&2&&e.value!==r[1]&&pe(e,r[1])},i:Ht,o:Ht,d(r){r&&Y(e),i=!1,qe(s)}}}function Uh(n,e,i){let s,{placeholder:r}=e;const a=de("textStore");gt(n,a,p=>i(1,s=p));function u(p){We.call(this,n,p)}function c(p){We.call(this,n,p)}function f(p){We.call(this,n,p)}function d(){s=this.value,a.set(s)}return n.$$set=p=>{"placeholder"in p&&i(0,r=p.placeholder)},[r,s,a,u,c,f,d]}class Xh extends Mn{constructor(e){super(),Sn(this,e,Uh,jh,pn,{placeholder:0})}}function Vh(n){let e,i,s,r,a,u,c,f,d,p,g,w,k;return u=new Xh({props:{placeholder:"Node Label"}}),{c(){e=T("div"),i=T("span"),i.textContent="Editor",s=W(),r=T("button"),r.textContent="X",a=W(),le(u.$$.fragment),c=W(),f=T("button"),f.textContent="Delete Node",d=W(),p=T("button"),p.textContent="Resize Node",at(i,"color","white"),at(i,"font-size","45px"),at(r,"position","absolute"),at(r,"top","10px"),at(r,"right","10px"),m(e,"class","editor svelte-1nv0yho")},m(P,C){K(P,e,C),y(e,i),y(e,s),y(e,r),y(e,a),oe(u,e,null),y(e,c),y(e,f),y(e,d),y(e,p),g=!0,w||(k=[lt(r,"click",n[6]),lt(f,"click",n[3]),lt(p,"click",n[4]),lt(e,"contextmenu",n[2])],w=!0)},p:Ht,i(P){g||(Z(u.$$.fragment,P),g=!0)},o(P){q(u.$$.fragment,P),g=!1},d(P){P&&Y(e),se(u),w=!1,qe(k)}}}function Yh(n){let e,i;return e=new ks({props:{zIndex:1/0,position:n[0],bgColor:"white",id:"editor",$$slots:{default:[Vh]},$$scope:{ctx:n}}}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,[r]){const a={};r&1&&(a.position=s[0]),r&512&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function qh(n,e,i){let{editing:s}=e;const r=de("graph");Ae("graph",r),Ae("textStore",s.label),Ae("colorStore",s.bgColor);let a={x:150,y:50};function u(p){p.preventDefault(),i(0,a={x:p.clientX,y:p.clientY}),r.editing.set(s)}function c(){r.nodes.delete(s.id),r.editing.set(null)}function f(){const p=s.id,g=r.nodes.get(p);if(g){const w=g.dimensions.width,k=g.dimensions.height,P=prompt("Enter new width (for example:250):",w?w.toString():""),C=prompt("Enter new height (for example:200):",k?k.toString():"");if(P===null||C===null)return;g.dimensions.width.set(parseInt(P,10)||0),g.dimensions.height.set(parseInt(C,10)||0),g.resizingWidth.set(!0),g.resizingHeight.set(!0)}}const d=()=>r.editing.set(null);return n.$$set=p=>{"editing"in p&&i(5,s=p.editing)},r.cursor,[a,r,u,c,f,s,d]}class Kh extends Mn{constructor(e){super(),Sn(this,e,qh,Yh,pn,{editing:5})}}function Jh(n){let e,i,s,r;return{c(){e=T("div"),i=T("div"),m(i,"class","bounding-box svelte-1e5jg43"),at(i,"background-color",n[6]),m(e,"role","button"),m(e,"tabindex","0"),m(e,"class","bounding-box-border svelte-1e5jg43"),m(e,"id",n[2]),at(e,"border","solid 4px "+n[6]),at(e,"top",`${n[3].y}px`),at(e,"left",`${n[3].x}px`),at(e,"width",`${n[4]}px`),at(e,"height",`${n[5]}px`)},m(a,u){K(a,e,u),y(e,i),s||(r=[lt(e,"contextmenu",Un(Yn(n[12]))),lt(e,"mousedown",Un(Yn(n[9])))],s=!0)},p(a,[u]){u&64&&at(i,"background-color",a[6]),u&4&&m(e,"id",a[2]),u&64&&at(e,"border","solid 4px "+a[6]);const c=u&64;(u&72||c)&&at(e,"top",`${a[3].y}px`),(u&72||c)&&at(e,"left",`${a[3].x}px`),(u&80||c)&&at(e,"width",`${a[4]}px`),(u&96||c)&&at(e,"height",`${a[5]}px`)},i:Ht,o:Ht,d(a){a&&Y(e),s=!1,qe(r)}}}function Qh(n,e,i){let s,r,a=Ht,u=()=>(a(),a=yn(k,X=>i(3,r=X)),k),c,f,d,p=Ht,g=()=>(p(),p=yn(P,X=>i(6,d=X)),P);n.$$.on_destroy.push(()=>a()),n.$$.on_destroy.push(()=>p());let{dimensions:w}=e,{position:k}=e;u();let{color:P}=e;g();let{groupName:C}=e;const{width:A,height:z}=w;gt(n,A,X=>i(4,c=X)),gt(n,z,X=>i(5,f=X));const E=ji();function I(){E("groupClick",{groupName:C})}function D(X){We.call(this,n,X)}return n.$$set=X=>{"dimensions"in X&&i(10,w=X.dimensions),"position"in X&&u(i(0,k=X.position)),"color"in X&&g(i(1,P=X.color)),"groupName"in X&&i(11,C=X.groupName)},n.$$.update=()=>{n.$$.dirty&2048&&i(2,s=`${C}-bounding-box`)},[k,P,s,r,c,f,d,A,z,I,w,C,D]}class $h extends Mn{constructor(e){super(),Sn(this,e,Qh,Jh,pn,{dimensions:10,position:0,color:1,groupName:11})}}function nl(n,e,i){const s=n.slice();return s[4]=e[i][0],s[5]=e[i][1],s}function il(n,e){let i,s,r;const a=[e[5],{groupName:e[4]}];let u={};for(let c=0;c<a.length;c+=1)u=bs(u,a[c]);return s=new $h({props:u}),s.$on("groupClick",e[2]),{key:n,first:null,c(){i=Ee(),le(s.$$.fragment),this.first=i},m(c,f){K(c,i,f),oe(s,c,f),r=!0},p(c,f){e=c;const d=f&1?ma(a,[pa(e[5]),{groupName:e[4]}]):{};s.$set(d)},i(c){r||(Z(s.$$.fragment,c),r=!0)},o(c){q(s.$$.fragment,c),r=!1},d(c){c&&Y(i),se(s,c)}}}function tf(n){let e=[],i=new Map,s,r,a=be(Array.from(n[0]));const u=c=>c[4];for(let c=0;c<a.length;c+=1){let f=nl(n,a,c),d=u(f);i.set(d,e[c]=il(d,f))}return{c(){for(let c=0;c<e.length;c+=1)e[c].c();s=Ee()},m(c,f){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(c,f);K(c,s,f),r=!0},p(c,[f]){f&1&&(a=be(Array.from(c[0])),ve(),e=vi(e,f,u,1,c,a,i,s.parentNode,co,il,s,nl),ye())},i(c){if(!r){for(let f=0;f<a.length;f+=1)Z(e[f]);r=!0}},o(c){for(let f=0;f<e.length;f+=1)q(e[f]);r=!1},d(c){c&&Y(s);for(let f=0;f<e.length;f+=1)e[f].d(c)}}}function ef(n,e,i){let s;const a=de("graph").groupBoxes;gt(n,a,c=>i(0,s=c));function u(c){We.call(this,n,c)}return[s,a,u]}class nf extends Mn{constructor(e){super(),Sn(this,e,ef,tf,pn,{})}}function of(n){let e,i,s,r;const a=n[11].default,u=ke(a,n,n[10],null);return{c(){e=T("div"),u&&u.c(),m(e,"class","svelvet-graph-wrapper svelte-19pa6i0"),m(e,"role","presentation"),at(e,"transform",n[0])},m(c,f){K(c,e,f),u&&u.m(e,null),i=!0,s||(r=[lt(e,"contextmenu",ro(Yn(n[12]))),lt(e,"click",ro(Yn(n[13]))),lt(e,"touchstart",ro(Yn(n[14])))],s=!0)},p(c,[f]){u&&u.p&&(!i||f&1024)&&Le(u,a,c,c[10],i?Pe(a,c[10],f,null):Ce(c[10]),null),f&1&&at(e,"transform",c[0])},i(c){i||(Z(u,c),i=!0)},o(c){q(u,c),i=!1},d(c){c&&Y(e),u&&u.d(c),s=!1,qe(r)}}}function sf(n,e,i){let s,r,a,u,c,{$$slots:f={},$$scope:d}=e;const p=de("graph"),g=p.transforms,w=g.scale;gt(n,w,H=>i(9,c=H));const k=g.translation;gt(n,k,H=>i(8,u=H));const P=p.cursor;gt(n,P,H=>i(15,a=H));let{isMovable:C}=e,A,z=!1;function E(){Bt(k,u=nc(bt(jn),a,g),u),i(5,A=requestAnimationFrame(E))}function I(H){We.call(this,n,H)}function D(H){We.call(this,n,H)}function X(H){We.call(this,n,H)}return n.$$set=H=>{"isMovable"in H&&i(4,C=H.isMovable),"$$scope"in H&&i(10,d=H.$$scope)},n.$$.update=()=>{n.$$.dirty&256&&i(7,s=u),n.$$.dirty&640&&i(0,r=`translate(${s.x}px, ${s.y}px) scale(${c})`),n.$$.dirty&112&&(C&&!z?(i(6,z=!0),i(5,A=requestAnimationFrame(E))):(!C||!z)&&(i(6,z=!1),cancelAnimationFrame(A)))},[r,w,k,P,C,A,z,s,u,c,d,f,I,D,X]}class rf extends Mn{constructor(e){super(),Sn(this,e,sf,of,pn,{isMovable:4})}}function lf(n){let e,i,s;const r=n[8].default,a=ke(r,n,n[9],null);return i=new nf({}),i.$on("groupClick",n[5]),{c(){a&&a.c(),e=W(),le(i.$$.fragment)},m(u,c){a&&a.m(u,c),K(u,e,c),oe(i,u,c),s=!0},p(u,c){a&&a.p&&(!s||c&512)&&Le(a,r,u,u[9],s?Pe(r,u[9],c,null):Ce(u[9]),null)},i(u){s||(Z(a,u),Z(i.$$.fragment,u),s=!0)},o(u){q(a,u),q(i.$$.fragment,u),s=!1},d(u){u&&Y(e),a&&a.d(u),se(i,u)}}}function af(n){let e,i;return e=new rf({props:{isMovable:n[0],$$slots:{default:[lf]},$$scope:{ctx:n}}}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,[r]){const a={};r&1&&(a.isMovable=s[0]),r&512&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function uf(n,e,i){let s,r,a,u,c,f;gt(n,jn,I=>i(13,u=I)),gt(n,Vn,I=>i(7,f=I));let{$$slots:d={},$$scope:p}=e;console.log("Componente GraphRenderer.svelte");const g=de("graph"),w=de("snapTo");let{isMovable:k}=e;const P=g.activeGroup;gt(n,P,I=>i(6,c=I));const C=g.groups;gt(n,C,I=>i(10,s=I));const A=g.initialNodePositions;gt(n,A,I=>i(11,r=I));const z=g.cursor;gt(n,z,I=>i(12,a=I));function E(I){Bt(Vn,f=!0,f);const{groupName:D}=I.detail;Bt(P,c=D,c),Bt(jn,u=a,u),Bt(A,r=ka(s[D].nodes),r)}return n.$$set=I=>{"isMovable"in I&&i(0,k=I.isMovable),"$$scope"in I&&i(9,p=I.$$scope)},n.$$.update=()=>{n.$$.dirty&192&&c&&f&&hc(g,w)},[k,P,C,A,z,E,c,f,d,p]}class cf extends Mn{constructor(e){super(),Sn(this,e,uf,af,pn,{isMovable:0})}}function hf(n){let e,i;return{c(){e=Qt("line"),i=Qt("line"),m(e,"class","background-line svelte-rryw83"),m(e,"x1",n[11]),m(e,"y1",0),m(e,"x2",n[11]),m(e,"y2",n[6]),m(e,"stroke-width",n[5]),at(e,"--calculated-dot-color",n[2]),m(i,"class","background-line svelte-rryw83"),m(i,"y1",n[11]),m(i,"x1",0),m(i,"y2",n[11]),m(i,"x2",n[6]),m(i,"stroke-width",n[5]),at(i,"--calculated-dot-color",n[2])},m(s,r){K(s,e,r),K(s,i,r)},p(s,r){r&2048&&m(e,"x1",s[11]),r&2048&&m(e,"x2",s[11]),r&64&&m(e,"y2",s[6]),r&32&&m(e,"stroke-width",s[5]),r&4&&at(e,"--calculated-dot-color",s[2]),r&2048&&m(i,"y1",s[11]),r&2048&&m(i,"y2",s[11]),r&64&&m(i,"x2",s[6]),r&32&&m(i,"stroke-width",s[5]),r&4&&at(i,"--calculated-dot-color",s[2])},d(s){s&&(Y(e),Y(i))}}}function ff(n){let e;return{c(){e=Qt("circle"),m(e,"class","background-dot svelte-rryw83"),m(e,"r",n[5]),m(e,"cx",n[11]),m(e,"cy",n[11]),at(e,"--calculated-dot-color",n[2])},m(i,s){K(i,e,s)},p(i,s){s&32&&m(e,"r",i[5]),s&2048&&m(e,"cx",i[11]),s&2048&&m(e,"cy",i[11]),s&4&&at(e,"--calculated-dot-color",i[2])},d(i){i&&Y(e)}}}function ol(n){let e,i,s;function r(c,f){if(c[0]==="dots")return _f;if(c[0]==="lines")return df}let a=r(n),u=a&&a(n);return{c(){e=Qt("pattern"),u&&u.c(),m(e,"id","graph-coarse-pattern"),m(e,"x",n[7]),m(e,"y",n[8]),m(e,"width",i=n[6]*n[3]),m(e,"height",s=n[6]*n[3]),m(e,"patternUnits","userSpaceOnUse")},m(c,f){K(c,e,f),u&&u.m(e,null)},p(c,f){a===(a=r(c))&&u?u.p(c,f):(u&&u.d(1),u=a&&a(c),u&&(u.c(),u.m(e,null))),f&128&&m(e,"x",c[7]),f&256&&m(e,"y",c[8]),f&72&&i!==(i=c[6]*c[3])&&m(e,"width",i),f&72&&s!==(s=c[6]*c[3])&&m(e,"height",s)},d(c){c&&Y(e),u&&u.d()}}}function df(n){let e,i,s,r,a,u;return{c(){e=Qt("line"),r=Qt("line"),m(e,"class","background-line svelte-rryw83"),m(e,"x1",n[11]),m(e,"y1",0),m(e,"x2",n[11]),m(e,"y2",i=n[6]*n[3]),m(e,"stroke-width",s=n[5]*1.2),at(e,"--calculated-dot-color",n[2]),m(r,"class","background-line svelte-rryw83"),m(r,"y1",n[11]),m(r,"x1",0),m(r,"y2",n[11]),m(r,"x2",a=n[6]*n[3]),m(r,"stroke-width",u=n[5]*1.2),at(r,"--calculated-dot-color",n[2])},m(c,f){K(c,e,f),K(c,r,f)},p(c,f){f&2048&&m(e,"x1",c[11]),f&2048&&m(e,"x2",c[11]),f&72&&i!==(i=c[6]*c[3])&&m(e,"y2",i),f&32&&s!==(s=c[5]*1.2)&&m(e,"stroke-width",s),f&4&&at(e,"--calculated-dot-color",c[2]),f&2048&&m(r,"y1",c[11]),f&2048&&m(r,"y2",c[11]),f&72&&a!==(a=c[6]*c[3])&&m(r,"x2",a),f&32&&u!==(u=c[5]*1.2)&&m(r,"stroke-width",u),f&4&&at(r,"--calculated-dot-color",c[2])},d(c){c&&(Y(e),Y(r))}}}function _f(n){let e,i;return{c(){e=Qt("circle"),m(e,"class","background-dot svelte-rryw83"),m(e,"r",i=n[5]*2),m(e,"cx",n[11]),m(e,"cy",n[11]),at(e,"--calculated-dot-color",n[2])},m(s,r){K(s,e,r)},p(s,r){r&32&&i!==(i=s[5]*2)&&m(e,"r",i),r&2048&&m(e,"cx",s[11]),r&2048&&m(e,"cy",s[11]),r&4&&at(e,"--calculated-dot-color",s[2])},d(s){s&&Y(e)}}}function sl(n){let e;return{c(){e=Qt("rect"),m(e,"width","100%"),m(e,"height","100%"),m(e,"fill","url(#graph-coarse-pattern)"),m(e,"opacity",n[10])},m(i,s){K(i,e,s)},p(i,s){s&1024&&m(e,"opacity",i[10])},d(i){i&&Y(e)}}}function mf(n){let e,i,s,r,a;function u(g,w){if(g[0]==="dots")return ff;if(g[0]==="lines")return hf}let c=u(n),f=c&&c(n),d=n[3]>0&&ol(n),p=n[3]>0&&sl(n);return{c(){e=T("div"),i=Qt("svg"),s=Qt("defs"),r=Qt("pattern"),f&&f.c(),d&&d.c(),a=Qt("rect"),p&&p.c(),m(r,"id","graph-pattern"),m(r,"x",n[7]),m(r,"y",n[8]),m(r,"width",n[6]),m(r,"height",n[6]),m(r,"patternUnits","userSpaceOnUse"),m(a,"width","100%"),m(a,"height","100%"),m(a,"fill","url(#graph-pattern)"),m(a,"opacity",n[9]),m(i,"class","svelte-rryw83"),m(e,"id","background-wrapper"),m(e,"class","svelte-rryw83"),at(e,"--calculated-background-color",n[1])},m(g,w){K(g,e,w),y(e,i),y(i,s),y(s,r),f&&f.m(r,null),d&&d.m(s,null),y(i,a),p&&p.m(i,null),n[24](e)},p(g,[w]){c===(c=u(g))&&f?f.p(g,w):(f&&f.d(1),f=c&&c(g),f&&(f.c(),f.m(r,null))),w&128&&m(r,"x",g[7]),w&256&&m(r,"y",g[8]),w&64&&m(r,"width",g[6]),w&64&&m(r,"height",g[6]),g[3]>0?d?d.p(g,w):(d=ol(g),d.c(),d.m(s,null)):d&&(d.d(1),d=null),w&512&&m(a,"opacity",g[9]),g[3]>0?p?p.p(g,w):(p=sl(g),p.c(),p.m(i,null)):p&&(p.d(1),p=null),w&2&&at(e,"--calculated-background-color",g[1])},i:Ht,o:Ht,d(g){g&&Y(e),f&&f.d(),d&&d.d(),p&&p.d(),n[24](null)}}}function pf(n,e,i){let s,r,a,u,c,f,d;const p=de("graph");let{style:g="dots"}=e,{gridWidth:w=Zu}=e,{dotSize:k=Du}=e,{bgColor:P=null}=e,{dotColor:C=null}=e,{opacityThreshold:A=3}=e,{majorGrid:z=0}=e,{minOpacity:E=.4}=e;const I=p.transforms,D=I.scale;gt(n,D,V=>i(22,f=V));const X=I.translation;gt(n,X,V=>i(23,d=V));let H,j,J,$,st,ut=1,O=1;function it(V){Kn[V?"unshift":"push"](()=>{H=V,i(4,H)})}return n.$$set=V=>{"style"in V&&i(0,g=V.style),"gridWidth"in V&&i(14,w=V.gridWidth),"dotSize"in V&&i(15,k=V.dotSize),"bgColor"in V&&i(1,P=V.bgColor),"dotColor"in V&&i(2,C=V.dotColor),"opacityThreshold"in V&&i(16,A=V.opacityThreshold),"majorGrid"in V&&i(3,z=V.majorGrid),"minOpacity"in V&&i(17,E=V.minOpacity)},n.$$.update=()=>{n.$$.dirty&8388608&&i(21,s=d),n.$$.dirty&4194304&&i(20,r=f),n.$$.dirty&1064960&&i(6,a=r*w),n.$$.dirty&1081344&&i(5,u=r*k/2),n.$$.dirty&64&&i(11,c=a/2),n.$$.dirty&4128816&&(i(18,j=(H==null?void 0:H.offsetWidth)||0),i(19,J=(H==null?void 0:H.offsetHeight)||0),i(7,$=(j+u)*(1-r)/2+s.x),i(8,st=(J+u)*(1-r)/2+s.y),i(9,ut=r>A?1:r/A+E),i(10,O=r>A/3?1:r/(A/3)+E))},[g,P,C,z,H,u,a,$,st,ut,O,c,D,X,w,k,A,E,j,J,r,s,f,d,it]}class gf extends Mn{constructor(e){super(),Sn(this,e,pf,mf,pn,{style:0,gridWidth:14,dotSize:15,bgColor:1,dotColor:2,opacityThreshold:16,majorGrid:3,minOpacity:17})}}function vf(n){let e,i;return{c(){e=T("div"),i=T("div"),m(i,"class","selection-box svelte-10ds4jd"),Yt(i,"creating",n[0]),m(e,"class","selection-border svelte-10ds4jd"),Yt(e,"creating",n[0]),at(e,"--prop-selection-box-color",n[1]),at(e,"height",n[4]),at(e,"width",n[3]),at(e,"top",n[6]),at(e,"left",n[5])},m(s,r){K(s,e,r),y(e,i),n[18](i)},p(s,[r]){r&1&&Yt(i,"creating",s[0]),r&1&&Yt(e,"creating",s[0]),r&2&&at(e,"--prop-selection-box-color",s[1]),r&16&&at(e,"height",s[4]),r&8&&at(e,"width",s[3]),r&64&&at(e,"top",s[6]),r&32&&at(e,"left",s[5])},i:Ht,o:Ht,d(s){s&&Y(e),n[18](null)}}}function yf(n,e,i){let s,r,a,u,c,f,d,p,g,w,k=Ht,P=()=>(k(),k=yn(s,O=>i(20,w=O)),s),C,A;gt(n,va,O=>i(16,C=O)),n.$$.on_destroy.push(()=>k());let{graph:z}=e,{anchor:E}=e,{adding:I=!1}=e,{creating:D=!1}=e,{color:X=null}=e;const{groups:H}=z;gt(n,H,O=>i(17,A=O));let j,J;qn($);function $(){j=Array.from(document.querySelectorAll(".svelvet-node")).map(it=>{const{top:V,left:_t,width:mt,height:F}=it.getBoundingClientRect();return{id:it.id,top:V,left:_t,width:mt,height:F}})}function st(){if(!j)return;const O=j.reduce((it,V)=>{if(c+E.left<=V.left&&u+E.top<=V.top&&c+E.left+Math.abs(a)>=V.left+V.width&&u+E.top+Math.abs(r)>=V.top+V.height){const _t=V.id,mt=z.nodes.get(_t);if(!mt)return it;it.push(mt)}return it},[]);I?O.forEach(it=>{w.add(it)}):Bt(s,w=new Set(O),w),s.set(w)}function ut(O){Kn[O?"unshift":"push"](()=>{J=O,i(2,J)})}return n.$$set=O=>{"graph"in O&&i(9,z=O.graph),"anchor"in O&&i(10,E=O.anchor),"adding"in O&&i(11,I=O.adding),"creating"in O&&i(0,D=O.creating),"color"in O&&i(1,X=O.color)},n.$$.update=()=>{n.$$.dirty&131072&&P(i(7,s=A.selected.nodes)),n.$$.dirty&66560&&i(12,r=C.y-E.y-E.top),n.$$.dirty&66560&&i(14,a=C.x-E.x-E.left),n.$$.dirty&5120&&i(13,u=Math.min(E.y,E.y+r)),n.$$.dirty&17408&&i(15,c=Math.min(E.x,E.x+a)),n.$$.dirty&8192&&i(6,f=`${u}px`),n.$$.dirty&32768&&i(5,d=`${c}px`),n.$$.dirty&4096&&i(4,p=`${Math.abs(r)}px`),n.$$.dirty&16384&&i(3,g=`${Math.abs(a)}px`),n.$$.dirty&20480&&(a||r)&&st()},[D,X,J,g,p,d,f,s,H,z,E,I,r,u,a,c,C,A,ut]}class bf extends Mn{constructor(e){super(),Sn(this,e,yf,vf,pn,{graph:9,anchor:10,adding:11,creating:0,color:1})}}const wf=n=>({}),rl=n=>({}),kf=n=>({}),ll=n=>({}),Pf=n=>({}),al=n=>({}),Lf=n=>({}),ul=n=>({}),Cf=n=>({}),cl=n=>({}),Sf=n=>({}),hl=n=>({});function fl(n){let e,i;return e=new Kh({props:{editing:n[24]}}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const a={};r[0]&16777216&&(a.editing=s[24]),e.$set(a)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Mf(n){let e,i,s=n[24]&&fl(n);const r=n[56].default,a=ke(r,n,n[58],null);return{c(){s&&s.c(),e=W(),a&&a.c()},m(u,c){s&&s.m(u,c),K(u,e,c),a&&a.m(u,c),i=!0},p(u,c){u[24]?s?(s.p(u,c),c[0]&16777216&&Z(s,1)):(s=fl(u),s.c(),Z(s,1),s.m(e.parentNode,e)):s&&(ve(),q(s,1,1,()=>{s=null}),ye()),a&&a.p&&(!i||c[1]&134217728)&&Le(a,r,u,u[58],i?Pe(r,u[58],c,null):Ce(u[58]),null)},i(u){i||(Z(s),Z(a,u),i=!0)},o(u){q(s),q(a,u),i=!1},d(u){u&&Y(e),s&&s.d(u),a&&a.d(u)}}}function Tf(n){let e,i;return e=new gf({}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p:Ht,i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Ef(n){let e;const i=n[56].background,s=ke(i,n,n[58],hl);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&134217728)&&Le(s,i,r,r[58],e?Pe(i,r[58],a,Sf):Ce(r[58]),hl)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function dl(n){let e,i,s;var r=n[14];function a(u,c){return{}}return r&&(e=ci(r,a())),{c(){e&&le(e.$$.fragment),i=Ee()},m(u,c){e&&oe(e,u,c),K(u,i,c),s=!0},p(u,c){if(c[0]&16384&&r!==(r=u[14])){if(e){ve();const f=e;q(f.$$.fragment,1,0,()=>{se(f,1)}),ye()}r?(e=ci(r,a()),le(e.$$.fragment),Z(e.$$.fragment,1),oe(e,i.parentNode,i)):e=null}},i(u){s||(e&&Z(e.$$.fragment,u),s=!0)},o(u){e&&q(e.$$.fragment,u),s=!1},d(u){u&&Y(i),e&&se(e,u)}}}function _l(n){let e,i,s;var r=n[15];function a(u,c){return{}}return r&&(e=ci(r,a())),{c(){e&&le(e.$$.fragment),i=Ee()},m(u,c){e&&oe(e,u,c),K(u,i,c),s=!0},p(u,c){if(c[0]&32768&&r!==(r=u[15])){if(e){ve();const f=e;q(f.$$.fragment,1,0,()=>{se(f,1)}),ye()}r?(e=ci(r,a()),le(e.$$.fragment),Z(e.$$.fragment,1),oe(e,i.parentNode,i)):e=null}},i(u){s||(e&&Z(e.$$.fragment,u),s=!0)},o(u){e&&q(e.$$.fragment,u),s=!1},d(u){u&&Y(i),e&&se(e,u)}}}function ml(n){let e,i,s;var r=n[13];function a(u,c){return{}}return r&&(e=ci(r,a())),{c(){e&&le(e.$$.fragment),i=Ee()},m(u,c){e&&oe(e,u,c),K(u,i,c),s=!0},p(u,c){if(c[0]&8192&&r!==(r=u[13])){if(e){ve();const f=e;q(f.$$.fragment,1,0,()=>{se(f,1)}),ye()}r?(e=ci(r,a()),le(e.$$.fragment),Z(e.$$.fragment,1),oe(e,i.parentNode,i)):e=null}},i(u){s||(e&&Z(e.$$.fragment,u),s=!0)},o(u){e&&q(e.$$.fragment,u),s=!1},d(u){u&&Y(i),e&&se(e,u)}}}function pl(n){let e,i,s;var r=n[16];function a(u,c){return{}}return r&&(e=ci(r,a())),{c(){e&&le(e.$$.fragment),i=Ee()},m(u,c){e&&oe(e,u,c),K(u,i,c),s=!0},p(u,c){if(c[0]&65536&&r!==(r=u[16])){if(e){ve();const f=e;q(f.$$.fragment,1,0,()=>{se(f,1)}),ye()}r?(e=ci(r,a()),le(e.$$.fragment),Z(e.$$.fragment,1),oe(e,i.parentNode,i)):e=null}},i(u){s||(e&&Z(e.$$.fragment,u),s=!0)},o(u){e&&q(e.$$.fragment,u),s=!1},d(u){u&&Y(i),e&&se(e,u)}}}function gl(n){let e,i,s;var r=n[17];function a(u,c){return{}}return r&&(e=ci(r,a())),{c(){e&&le(e.$$.fragment),i=Ee()},m(u,c){e&&oe(e,u,c),K(u,i,c),s=!0},p(u,c){if(c[0]&131072&&r!==(r=u[17])){if(e){ve();const f=e;q(f.$$.fragment,1,0,()=>{se(f,1)}),ye()}r?(e=ci(r,a()),le(e.$$.fragment),Z(e.$$.fragment,1),oe(e,i.parentNode,i)):e=null}},i(u){s||(e&&Z(e.$$.fragment,u),s=!0)},o(u){e&&q(e.$$.fragment,u),s=!1},d(u){u&&Y(i),e&&se(e,u)}}}function vl(n){let e,i;return e=new bf({props:{creating:n[20],anchor:n[18],graph:n[3],adding:n[21],color:n[9]}}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const a={};r[0]&1048576&&(a.creating=s[20]),r[0]&262144&&(a.anchor=s[18]),r[0]&8&&(a.graph=s[3]),r[0]&2097152&&(a.adding=s[21]),r[0]&512&&(a.color=s[9]),e.$set(a)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Af(n){let e,i,s,r,a,u,c,f,d,p,g,w,k,P,C,A,z,E,I,D;i=new cf({props:{isMovable:n[22],$$slots:{default:[Mf]},$$scope:{ctx:n}}});const X=[Ef,Tf],H=[];function j(U,ot){return U[10]?0:1}r=j(n),a=H[r]=X[r](n);let J=n[0]&&dl(n),$=n[1]&&_l(n),st=n[6]&&ml(n),ut=n[2]&&pl(n),O=n[12]&&gl(n);const it=n[56].minimap,V=ke(it,n,n[58],cl),_t=n[56].drawer,mt=ke(_t,n,n[58],ul),F=n[56].controls,R=ke(F,n,n[58],al),yt=n[56].toggle,tt=ke(yt,n,n[58],ll),Pt=n[56].contrast,Mt=ke(Pt,n,n[58],rl);let vt=n[19]&&!n[8]&&vl(n);return{c(){e=T("section"),le(i.$$.fragment),s=W(),a.c(),u=W(),J&&J.c(),c=W(),$&&$.c(),f=W(),st&&st.c(),d=W(),ut&&ut.c(),p=W(),O&&O.c(),g=W(),V&&V.c(),w=W(),mt&&mt.c(),k=W(),R&&R.c(),P=W(),tt&&tt.c(),C=W(),Mt&&Mt.c(),A=W(),vt&&vt.c(),m(e,"role","presentation"),m(e,"id",z=n[3].id),m(e,"class","svelvet-wrapper svelte-13nq7cv"),m(e,"title",n[11]),m(e,"tabindex",0),at(e,"width",n[4]?n[4]+"px":"100%"),at(e,"height",n[5]?n[5]+"px":"100%"),at(e,"cursor",n[7]?"move":"default")},m(U,ot){K(U,e,ot),oe(i,e,null),y(e,s),H[r].m(e,null),y(e,u),J&&J.m(e,null),y(e,c),$&&$.m(e,null),y(e,f),st&&st.m(e,null),y(e,d),ut&&ut.m(e,null),y(e,p),O&&O.m(e,null),y(e,g),V&&V.m(e,null),y(e,w),mt&&mt.m(e,null),y(e,k),R&&R.m(e,null),y(e,P),tt&&tt.m(e,null),y(e,C),Mt&&Mt.m(e,null),y(e,A),vt&&vt.m(e,null),n[57](e),E=!0,I||(D=[lt(window,"touchend",n[36]),lt(window,"mouseup",n[36]),lt(window,"resize",n[35]),lt(window,"scroll",n[35]),lt(e,"wheel",Yn(n[43])),lt(e,"mousedown",ro(Yn(n[37]))),lt(e,"touchend",Yn(n[39])),lt(e,"touchstart",ro(Yn(n[38]))),lt(e,"keydown",n[40]),lt(e,"keyup",n[42]),lt(e,"dragover",Yn(zf)),lt(e,"drop",n[41])],I=!0)},p(U,ot){const Q={};ot[0]&4194304&&(Q.isMovable=U[22]),ot[0]&16777216|ot[1]&134217728&&(Q.$$scope={dirty:ot,ctx:U}),i.$set(Q);let et=r;r=j(U),r===et?H[r].p(U,ot):(ve(),q(H[et],1,1,()=>{H[et]=null}),ye(),a=H[r],a?a.p(U,ot):(a=H[r]=X[r](U),a.c()),Z(a,1),a.m(e,u)),U[0]?J?(J.p(U,ot),ot[0]&1&&Z(J,1)):(J=dl(U),J.c(),Z(J,1),J.m(e,c)):J&&(ve(),q(J,1,1,()=>{J=null}),ye()),U[1]?$?($.p(U,ot),ot[0]&2&&Z($,1)):($=_l(U),$.c(),Z($,1),$.m(e,f)):$&&(ve(),q($,1,1,()=>{$=null}),ye()),U[6]?st?(st.p(U,ot),ot[0]&64&&Z(st,1)):(st=ml(U),st.c(),Z(st,1),st.m(e,d)):st&&(ve(),q(st,1,1,()=>{st=null}),ye()),U[2]?ut?(ut.p(U,ot),ot[0]&4&&Z(ut,1)):(ut=pl(U),ut.c(),Z(ut,1),ut.m(e,p)):ut&&(ve(),q(ut,1,1,()=>{ut=null}),ye()),U[12]?O?(O.p(U,ot),ot[0]&4096&&Z(O,1)):(O=gl(U),O.c(),Z(O,1),O.m(e,g)):O&&(ve(),q(O,1,1,()=>{O=null}),ye()),V&&V.p&&(!E||ot[1]&134217728)&&Le(V,it,U,U[58],E?Pe(it,U[58],ot,Cf):Ce(U[58]),cl),mt&&mt.p&&(!E||ot[1]&134217728)&&Le(mt,_t,U,U[58],E?Pe(_t,U[58],ot,Lf):Ce(U[58]),ul),R&&R.p&&(!E||ot[1]&134217728)&&Le(R,F,U,U[58],E?Pe(F,U[58],ot,Pf):Ce(U[58]),al),tt&&tt.p&&(!E||ot[1]&134217728)&&Le(tt,yt,U,U[58],E?Pe(yt,U[58],ot,kf):Ce(U[58]),ll),Mt&&Mt.p&&(!E||ot[1]&134217728)&&Le(Mt,Pt,U,U[58],E?Pe(Pt,U[58],ot,wf):Ce(U[58]),rl),U[19]&&!U[8]?vt?(vt.p(U,ot),ot[0]&524544&&Z(vt,1)):(vt=vl(U),vt.c(),Z(vt,1),vt.m(e,null)):vt&&(ve(),q(vt,1,1,()=>{vt=null}),ye()),(!E||ot[0]&8&&z!==(z=U[3].id))&&m(e,"id",z),(!E||ot[0]&2048)&&m(e,"title",U[11]),ot[0]&16&&at(e,"width",U[4]?U[4]+"px":"100%"),ot[0]&32&&at(e,"height",U[5]?U[5]+"px":"100%"),ot[0]&128&&at(e,"cursor",U[7]?"move":"default")},i(U){E||(Z(i.$$.fragment,U),Z(a),Z(J),Z($),Z(st),Z(ut),Z(O),Z(V,U),Z(mt,U),Z(R,U),Z(tt,U),Z(Mt,U),Z(vt),E=!0)},o(U){q(i.$$.fragment,U),q(a),q(J),q($),q(st),q(ut),q(O),q(V,U),q(mt,U),q(R,U),q(tt,U),q(Mt,U),q(vt),E=!1},d(U){U&&Y(e),se(i),H[r].d(),J&&J.d(),$&&$.d(),st&&st.d(),ut&&ut.d(),O&&O.d(),V&&V.d(U),mt&&mt.d(U),R&&R.d(U),tt&&tt.d(U),Mt&&Mt.d(U),vt&&vt.d(),n[57](null),I=!1,qe(D)}}}function zf(n){n.preventDefault()}function Nf(n,e,i){let s,r,a,u,c,f,d,p,g,w,k,P,C,A,z;gt(n,ps,b=>i(70,d=b)),gt(n,jn,b=>i(71,p=b)),gt(n,Vn,b=>i(72,g=b)),gt(n,ui,b=>i(75,P=b));let{$$slots:E={},$$scope:I}=e,{graph:D}=e,{width:X}=e,{height:H}=e,{minimap:j=!1}=e,{controls:J=!1}=e,{toggle:$=!1}=e,{fixedZoom:st=!1}=e,{pannable:ut=!0}=e,{disableSelection:O=!1}=e,{ZOOM_INCREMENT:it=.1}=e,{PAN_INCREMENT:V=50}=e,{PAN_TIME:_t=250}=e,{MAX_SCALE:mt=3}=e,{MIN_SCALE:F=.2}=e,{selectionColor:R}=e,{backgroundExists:yt}=e,{fitView:tt=!1}=e,{trackpadPan:Pt}=e,{modifier:Mt}=e,{theme:vt="light"}=e,{title:U}=e,{drawer:ot=!1}=e,{contrast:Q=!1}=e;console.log("Initial Graph drawer prop:",ot);let et;const Tt=ji(),jt={},ft=nt(!1),At=nt(0),Dt=nt(null);gt(n,Dt,b=>i(23,c=b));const Zt=D.cursor,$t=D.transforms.scale;gt(n,$t,b=>i(68,u=b));const ze=D.dimensions;gt(n,ze,b=>i(55,A=b));const ae=D.transforms.translation;gt(n,ae,b=>i(67,a=b));const rt=D.groups;gt(n,rt,b=>i(69,f=b));const _e=D.groupBoxes,Rt=f.selected.nodes;gt(n,Rt,b=>i(66,r=b));const zt=D.activeGroup;gt(n,zt,b=>i(74,k=b));const Ft=D.initialNodePositions;gt(n,Ft,b=>i(73,w=b));const Xt=D.editing;gt(n,Xt,b=>i(24,z=b));const Ne=D.bounds.nodeBounds;gt(n,Ne,b=>i(76,C=b));let Ie=0,we=1,Ut={x:0,y:0,top:0,left:0},tn=!1,te=!1,cn=!1,fe=!1,ee=!1,me=!1,Ze,He=null,hn=null,je=null,Ue=null,It=null;const Ke={id:null,position:D.cursor,offset:nt({x:0,y:0}),connected:nt(new Set),dynamic:nt(!1),edge:null,edgeColor:nt(null),direction:nt("self"),inputKey:null,type:"output",moving:xo(!1),store:null,mounted:nt(!0),rotation:xo(0),node:{zIndex:nt(1/0),rotating:nt(!1),position:D.cursor,dimensions:{width:nt(0),height:nt(0)}}};Ae("graphDOMElement",Dt),Ae("cursorAnchor",Ke),Ae("duplicate",ft),Ae("graph",D),Ae("transforms",D.transforms),Ae("dimensions",D.dimensions),Ae("locked",D.locked),Ae("groups",D.groups),Ae("bounds",D.bounds),Ae("edgeStore",D.edges),Ae("nodeStore",D.nodes),Ae("mounted",At),qn(()=>{console.log("Graph component mounted with drawer1:",ot),fn()});async function Je(){await da(),Vn.set(!0);const{x:b,y:dt,scale:wt}=lc(Ze,C);b!==null&&dt!==null&&wt!==null&&(D.transforms.scale.set(wt),ae.set({x:b,y:dt})),Vn.set(!1),i(54,me=!0)}async function gn(){i(14,hn=(await oo(async()=>{const{default:b}=await import("./Minimap-VJwJi3_e.js");return{default:b}},[])).default)}async function zn(){i(13,He=(await oo(async()=>{const{default:b}=await import("./ThemeToggle-CXYsZ1qO.js");return{default:b}},[])).default)}async function Bn(){i(15,je=(await oo(async()=>{const{default:b}=await import("./Controls-WC3I_igS.js");return{default:b}},__vite__mapDeps([0,1]))).default)}async function Se(){i(16,Ue=(await oo(async()=>{const{default:b}=await import("./DrawerController-D9M15AZT.js");return{default:b}},__vite__mapDeps([2,1,3]))).default)}async function De(){i(17,It=(await oo(async()=>{const{default:b}=await import("./ContrastTheme-D3v3Aw16.js");return{default:b}},[])).default)}function fn(){if(!c)return;const b=c.getBoundingClientRect();Ze={top:b.top,left:b.left,bottom:b.bottom,right:b.right,width:b.width,height:b.height},D.dimensions.set(Ze),tt==="resize"&&Je()}function Kt(b){if(te){const kt=`${qu()}/${D.id}`,Et=bt(Zt),B=Et.x-p.x,Vt=Et.y-p.y,ce=Math.min(p.y,p.y+Vt),Jt=Math.min(p.x,p.x+B),Oe={width:nt(Math.abs(B)),height:nt(Math.abs(Vt))},dn=nt({x:Jt,y:ce}),Re={group:nt(kt),dimensions:Oe,position:dn,color:nt(Fu()),moving:nt(!1)};_e.add(Re,kt),Array.from(r).forEach(mn=>{mn.group.set(kt)}),rt.update(mn=>{const Zn={parent:nt(Re),nodes:nt(new Set([...r,Re]))};return mn[kt]=Zn,mn}),Bt(Rt,r=new Set,r),i(20,te=!1),i(19,tn=!1)}k&&Array.from(bt(f[k].nodes)).forEach(kt=>{const Et=Do(bt(kt.position).x,bt(kt.position).y);kt.position.set(Et),kt.moving.set(!1)});const dt=D.edges.get("cursor");dt&&(D.edges.delete("cursor"),dt.disconnect||Tt("edgeDrop",{cursor:bt(Zt),source:{node:P==null?void 0:P.anchor.node.id.slice(2),anchor:P==null?void 0:P.anchor.id.split("/")[0].slice(2)}})),Bt(zt,k=null,k),Bt(jn,p={x:0,y:0},p),Bt(Ft,w=[],w),i(19,tn=!1),i(22,fe=!1),Bt(Vn,g=!1,g),b.shiftKey||ui.set(null),i(18,Ut.y=0,Ut),i(18,Ut.x=0,Ut)}function ue(b){if(!ut&&!(b.shiftKey||b.metaKey)||b.button===2)return;c&&c.focus();const{clientX:dt,clientY:wt}=b;if(Bt(jn,p=bt(Zt),p),b.shiftKey||b.metaKey){b.preventDefault(),i(19,tn=!0);const{top:kt,left:Et}=s;i(18,Ut.y=wt-kt,Ut),i(18,Ut.x=dt-Et,Ut),i(18,Ut.top=kt,Ut),i(18,Ut.left=Et,Ut),b.shiftKey&&b.metaKey?i(20,te=!0):i(20,te=!1),b.metaKey&&!b.shiftKey?i(21,cn=!0):i(21,cn=!1)}else i(22,fe=!0),Bt(Rt,r=new Set,r),Rt.set(r)}function Fe(b){Bt(Rt,r=new Set,r),Rt.set(r),Bt(jn,p=bt(Zt),p),i(22,fe=!0),b.touches.length===2&&(Xe(),Ie=d,we=u)}function _n(){i(22,fe=!1),ee=!1}function Xe(){ee||(ee=!0,et=requestAnimationFrame(bn))}function bn(){if(!ee){cancelAnimationFrame(et);return}const dt=d/Ie;Bt($t,u=we*dt,u),et=requestAnimationFrame(bn)}function Tn(b){const{key:dt,code:wt}=b,kt=b.target;if(!(kt.tagName=="INPUT"||kt.tagName=="TEXTAREA")){if(wt==="KeyA"&&b[`${Mt}Key`]){const Et=D.nodes.getAll().filter(B=>!bt(B.locked));Bt(Rt,r=new Set(Et),r)}else if(el(dt))nn(dt,b);else if(dt==="=")rr(-1,D.dimensions,D.transforms,it);else if(dt==="-")rr(1,D.dimensions,D.transforms,it);else if(dt==="0")Je();else if(dt==="Control")f.selected.nodes.set(new Set);else if(wt==="KeyD"&&b[`${Mt}Key`])ft.set(!0),setTimeout(()=>{ft.set(!1)},100);else if(dt==="Tab"&&(b.altKey||b.ctrlKey))Lt();else if(dt==="l")i(44,vt=vt==="light"?"dark":"light");else if(dt==="d")i(2,ot=!ot);else if(dt==="m")i(0,j=!j);else if(dt==="c")i(1,J=!J);else if(dt==="e"){const Et=Array.from(r)[0];D.editing.set(Et)}else return;b.preventDefault()}}function en(b){b.preventDefault();const dt=c==null?void 0:c.getBoundingClientRect();if(!dt)return;const wt=b.clientX-dt.left,kt=b.clientY-dt.top,{x:Et,y:B}=Do(wt,kt);if(console.log(`Dropped Node at Snapped Position: (${Et}, ${B})`),!ce)return;const Vt={id:`node-${Date.now()}`,rotation:nt(0),position:nt({x:Et,y:B}),moving:nt(!1),label:nt("New Node"),dimensions:{width:nt(200),height:nt(100)},inputs:nt(2),outputs:nt(2),anchors:nt([]),group:nt(null),collapsed:nt(!1),resizingWidth:nt(!1),resizingHeight:nt(!1),rotating:nt(!1),editable:nt(!0),locked:nt(!1),recalculateAnchors:Jt=>{},resizable:nt(!0),zIndex:nt(1),edge:null,direction:nt("TD"),borderRadius:nt(5),borderWidth:nt(1),connections:nt([]),bgColor:nt("#007bff"),borderColor:nt("#000"),selectionColor:nt("#ff0000"),textColor:nt("#fff")};let ce=null;D.nodes.add(Vt,Vt.id),ce=null}function Lt(){const b=D.nodes.getAll(),dt=b.findIndex(kt=>r.has(kt)),wt=dt+1;r.delete(b[dt]),r.add(b[wt])}function Ve(b){const{key:dt}=b;el(dt)?(clearInterval(jt[dt]),delete jt[dt]):dt==="Shift"&&ui.set(null)}function wn(b){if(st)return;const dt=b.shiftKey?.15:1,{clientX:wt,clientY:kt,deltaY:Et}=b,B=a,Vt={x:wt,y:kt};if((Pt||b.metaKey)&&Et%1===0){Bt(ae,a={x:Bt(ae,a.x-=b.deltaX,a),y:Bt(ae,a.y-=b.deltaY,a)},a);return}if(u>=mt&&Et<0||u<=F&&Et>0)return;const ce=Math.min(.009*dt*Math.abs(Et),.08),Jt=ba(u,Math.sign(Et),ce),Oe=ya(u,Jt,B,Vt,Ze);$t.set(Jt),ae.set(Oe)}function nn(b,dt){const wt=dt.shiftKey?2:1,kt=b==="ArrowLeft"||b==="ArrowUp"?1:-1,Et=b==="ArrowLeft"||b==="ArrowRight",B=Et?a.x:a.y,Vt=B+kt*V*wt;if(!jt[b]){const ce=performance.now();let Jt=setInterval(()=>{const Oe=performance.now()-ce;if(r.size===0){const dn=B+(Vt-B)*(Oe/_t);ae.set({x:Et?dn:a.x,y:Et?a.y:dn})}else{const dn={x:Et?-kt*2:0,y:Et?0:-kt*2};Array.from(r).forEach(Re=>{const mn=bt(Re.position);let Zn;const ti=bt(Re.group),Dn=bt(D.groupBoxes);if(ti&&(Zn=Dn.get(ti)),Zn){const En=bt(Re.dimensions.width),Rn=bt(Re.dimensions.height),xn=La(Zn,En,Rn);Pa(mn,dn,Re.position,xn)}else{const En={x:mn.x+dn.x,y:mn.y+dn.y},Rn=Do(En.x,En.y);Re.position.set(Rn)}})}},2);jt[b]=Jt}}function kn(b){Kn[b?"unshift":"push"](()=>{c=b,Dt.set(c)})}return n.$$set=b=>{"graph"in b&&i(3,D=b.graph),"width"in b&&i(4,X=b.width),"height"in b&&i(5,H=b.height),"minimap"in b&&i(0,j=b.minimap),"controls"in b&&i(1,J=b.controls),"toggle"in b&&i(6,$=b.toggle),"fixedZoom"in b&&i(45,st=b.fixedZoom),"pannable"in b&&i(7,ut=b.pannable),"disableSelection"in b&&i(8,O=b.disableSelection),"ZOOM_INCREMENT"in b&&i(46,it=b.ZOOM_INCREMENT),"PAN_INCREMENT"in b&&i(47,V=b.PAN_INCREMENT),"PAN_TIME"in b&&i(48,_t=b.PAN_TIME),"MAX_SCALE"in b&&i(49,mt=b.MAX_SCALE),"MIN_SCALE"in b&&i(50,F=b.MIN_SCALE),"selectionColor"in b&&i(9,R=b.selectionColor),"backgroundExists"in b&&i(10,yt=b.backgroundExists),"fitView"in b&&i(51,tt=b.fitView),"trackpadPan"in b&&i(52,Pt=b.trackpadPan),"modifier"in b&&i(53,Mt=b.modifier),"theme"in b&&i(44,vt=b.theme),"title"in b&&i(11,U=b.title),"drawer"in b&&i(2,ot=b.drawer),"contrast"in b&&i(12,Q=b.contrast),"$$scope"in b&&i(58,I=b.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&16777216&&(s=A),n.$$.dirty[1]&8192&&vt&&document.documentElement.setAttribute("svelvet-theme",vt),n.$$.dirty[1]&9437184&&!me&&tt&&Je(),n.$$.dirty[0]&8256&&$&&!He&&zn(),n.$$.dirty[0]&16385&&j&&!hn&&gn(),n.$$.dirty[0]&32770&&J&&!je&&Bn(),n.$$.dirty[0]&65540&&ot&&!Ue&&Se(),n.$$.dirty[0]&135168&&Q&&!It&&De(),n.$$.dirty[0]&4&&console.log("Reactive Graph drawer prop:",ot)},[j,J,ot,D,X,H,$,ut,O,R,yt,U,Q,He,hn,je,Ue,It,Ut,tn,te,cn,fe,c,z,Dt,$t,ze,ae,rt,Rt,zt,Ft,Xt,Ne,fn,Kt,ue,Fe,_n,Tn,en,Ve,wn,vt,st,it,V,_t,mt,F,tt,Pt,Mt,me,A,E,kn,I]}class If extends Mn{constructor(e){super(),Sn(this,e,Nf,Af,pn,{graph:3,width:4,height:5,minimap:0,controls:1,toggle:6,fixedZoom:45,pannable:7,disableSelection:8,ZOOM_INCREMENT:46,PAN_INCREMENT:47,PAN_TIME:48,MAX_SCALE:49,MIN_SCALE:50,selectionColor:9,backgroundExists:10,fitView:51,trackpadPan:52,modifier:53,theme:44,title:11,drawer:2,contrast:12},null,[-1,-1,-1])}}const Of=n=>({}),yl=n=>({slot:"minimap"}),Bf=n=>({}),bl=n=>({slot:"controls"}),Zf=n=>({}),wl=n=>({slot:"background"}),Df=n=>({}),kl=n=>({slot:"toggle"}),Rf=n=>({}),Pl=n=>({slot:"drawer"}),xf=n=>({}),Ll=n=>({slot:"contrast"});function Wf(n){let e;return{c(){e=T("div"),m(e,"class","svelvet-temp svelte-lsy29y"),at(e,"width",n[2]?n[2]+"px":"100%"),at(e,"height",n[3]?n[3]+"px":"100%")},m(i,s){K(i,e,s)},p(i,s){s[0]&4&&at(e,"width",i[2]?i[2]+"px":"100%"),s[0]&8&&at(e,"height",i[3]?i[3]+"px":"100%")},i:Ht,o:Ht,d(i){i&&Y(e)}}}function Hf(n){let e,i;return e=new If({props:{width:n[2],height:n[3],toggle:n[6],backgroundExists:n[19],minimap:n[4],graph:n[18],fitView:n[9],fixedZoom:n[16],pannable:n[17],theme:n[1],drawer:n[7],controls:n[5],selectionColor:n[10],disableSelection:n[11],trackpadPan:n[13],modifier:n[14],title:n[15],contrast:n[8],$$slots:{contrast:[Yf],drawer:[Vf],toggle:[Xf],background:[Uf],controls:[jf],minimap:[Gf],default:[Ff]},$$scope:{ctx:n}}}),e.$on("edgeDrop",n[35]),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const a={};r[0]&4&&(a.width=s[2]),r[0]&8&&(a.height=s[3]),r[0]&64&&(a.toggle=s[6]),r[0]&524288&&(a.backgroundExists=s[19]),r[0]&16&&(a.minimap=s[4]),r[0]&262144&&(a.graph=s[18]),r[0]&512&&(a.fitView=s[9]),r[0]&65536&&(a.fixedZoom=s[16]),r[0]&131072&&(a.pannable=s[17]),r[0]&2&&(a.theme=s[1]),r[0]&128&&(a.drawer=s[7]),r[0]&32&&(a.controls=s[5]),r[0]&1024&&(a.selectionColor=s[10]),r[0]&2048&&(a.disableSelection=s[11]),r[0]&8192&&(a.trackpadPan=s[13]),r[0]&16384&&(a.modifier=s[14]),r[0]&32768&&(a.title=s[15]),r[0]&256&&(a.contrast=s[8]),r[0]&4097|r[1]&32&&(a.$$scope={dirty:r,ctx:s}),e.$set(a)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Cl(n){let e,i;return e=new xh({props:{mermaid:n[0],mermaidConfig:n[12]}}),{c(){le(e.$$.fragment)},m(s,r){oe(e,s,r),i=!0},p(s,r){const a={};r[0]&1&&(a.mermaid=s[0]),r[0]&4096&&(a.mermaidConfig=s[12]),e.$set(a)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){q(e.$$.fragment,s),i=!1},d(s){se(e,s)}}}function Ff(n){let e,i,s=n[0].length&&Cl(n);const r=n[34].default,a=ke(r,n,n[36],null);return{c(){s&&s.c(),e=W(),a&&a.c()},m(u,c){s&&s.m(u,c),K(u,e,c),a&&a.m(u,c),i=!0},p(u,c){u[0].length?s?(s.p(u,c),c[0]&1&&Z(s,1)):(s=Cl(u),s.c(),Z(s,1),s.m(e.parentNode,e)):s&&(ve(),q(s,1,1,()=>{s=null}),ye()),a&&a.p&&(!i||c[1]&32)&&Le(a,r,u,u[36],i?Pe(r,u[36],c,null):Ce(u[36]),null)},i(u){i||(Z(s),Z(a,u),i=!0)},o(u){q(s),q(a,u),i=!1},d(u){u&&Y(e),s&&s.d(u),a&&a.d(u)}}}function Gf(n){let e;const i=n[34].minimap,s=ke(i,n,n[36],yl);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&32)&&Le(s,i,r,r[36],e?Pe(i,r[36],a,Of):Ce(r[36]),yl)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function jf(n){let e;const i=n[34].controls,s=ke(i,n,n[36],bl);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&32)&&Le(s,i,r,r[36],e?Pe(i,r[36],a,Bf):Ce(r[36]),bl)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function Uf(n){let e;const i=n[34].background,s=ke(i,n,n[36],wl);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&32)&&Le(s,i,r,r[36],e?Pe(i,r[36],a,Zf):Ce(r[36]),wl)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function Xf(n){let e;const i=n[34].toggle,s=ke(i,n,n[36],kl);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&32)&&Le(s,i,r,r[36],e?Pe(i,r[36],a,Df):Ce(r[36]),kl)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function Vf(n){let e;const i=n[34].drawer,s=ke(i,n,n[36],Pl);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&32)&&Le(s,i,r,r[36],e?Pe(i,r[36],a,Rf):Ce(r[36]),Pl)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function Yf(n){let e;const i=n[34].contrast,s=ke(i,n,n[36],Ll);return{c(){s&&s.c()},m(r,a){s&&s.m(r,a),e=!0},p(r,a){s&&s.p&&(!e||a[1]&32)&&Le(s,i,r,r[36],e?Pe(i,r[36],a,xf):Ce(r[36]),Ll)},i(r){e||(Z(s,r),e=!0)},o(r){q(s,r),e=!1},d(r){s&&s.d(r)}}}function qf(n){let e,i,s,r;const a=[Hf,Wf],u=[];function c(f,d){return f[18]?0:1}return e=c(n),i=u[e]=a[e](n),{c(){i.c(),s=Ee()},m(f,d){u[e].m(f,d),K(f,s,d),r=!0},p(f,d){let p=e;e=c(f),e===p?u[e].p(f,d):(ve(),q(u[p],1,1,()=>{u[p]=null}),ye(),i=u[e],i?i.p(f,d):(i=u[e]=a[e](f),i.c()),Z(i,1),i.m(s.parentNode,s))},i(f){r||(Z(i),r=!0)},o(f){q(i),r=!1},d(f){f&&Y(s),u[e].d(f)}}}function Kf(n,e,i){let s,r,{$$slots:a={},$$scope:u}=e;const c=ws(a);let{mermaid:f=""}=e,{theme:d="light"}=e,{id:p=0}=e,{snapTo:g=0}=e,{zoom:w=1}=e,{TD:k=!1}=e,{editable:P=!0}=e,{locked:C=!1}=e,{width:A=0}=e,{height:z=0}=e,{minimap:E=!1}=e,{controls:I=!1}=e,{toggle:D=!1}=e,{drawer:X=!1}=e,{contrast:H=!1}=e,{fitView:j=!1}=e,{selectionColor:J="lightblue"}=e,{edgeStyle:$="bezier"}=e,{endStyles:st=[null,null]}=e,{edge:ut=null}=e,{disableSelection:O=!1}=e,{mermaidConfig:it={}}=e,{translation:V={x:0,y:0}}=e,{trackpadPan:_t=!1}=e,{modifier:mt="meta"}=e,{raiseEdgesOnSelect:F=!1}=e,{edgesAboveNode:R=!1}=e,{title:yt=""}=e,{fixedZoom:tt=!1}=e,{pannable:Pt=!0}=e;const Mt=ji();let vt=null,U=k?"TD":"LR";Ae("snapTo",g),Ae("edgeStyle",$),Ae("endStyles",st),Ae("graphEdge",ut),Ae("raiseEdgesOnSelect",F),Ae("edgesAboveNode",R),Ae("graph",vt),qn(()=>{console.log("Graph component mounted with drawer:",X);const et=localStorage.getItem("state");if(console.log("stateObject during onMount:",et),et)i(18,vt=_c(et)),console.log("This is the graph set using reloadStore",vt),as.add(vt,vt.id),console.log("graphStore updated",vt);else{let Tt=`G-${p||as.count()+1}`;i(18,vt=wa(Tt,{zoom:w,direction:U,editable:P,locked:C,translation:V})),as.add(vt,Tt)}});function ot(et,Tt){if(!vt)return;const jt=`N-${et[0]}`,ft=vt.nodes.get(jt);if(!ft)return;const At=ft.anchors.get(`A-${et[1]}/N-${et[0]}`);if(!At)return;const Dt=`N-${Tt[0]}`,Zt=vt.nodes.get(Dt);if(!Zt)return;const $t=Zt.anchors.get(`A-${Tt[1]}/N-${Tt[0]}`);if(!$t)return;const ze=vt.edges.match(At,$t);ze&&vt.edges.delete(ze[0])}function Q(et){We.call(this,n,et)}return n.$$set=et=>{"mermaid"in et&&i(0,f=et.mermaid),"theme"in et&&i(1,d=et.theme),"id"in et&&i(20,p=et.id),"snapTo"in et&&i(21,g=et.snapTo),"zoom"in et&&i(22,w=et.zoom),"TD"in et&&i(23,k=et.TD),"editable"in et&&i(24,P=et.editable),"locked"in et&&i(25,C=et.locked),"width"in et&&i(2,A=et.width),"height"in et&&i(3,z=et.height),"minimap"in et&&i(4,E=et.minimap),"controls"in et&&i(5,I=et.controls),"toggle"in et&&i(6,D=et.toggle),"drawer"in et&&i(7,X=et.drawer),"contrast"in et&&i(8,H=et.contrast),"fitView"in et&&i(9,j=et.fitView),"selectionColor"in et&&i(10,J=et.selectionColor),"edgeStyle"in et&&i(26,$=et.edgeStyle),"endStyles"in et&&i(27,st=et.endStyles),"edge"in et&&i(28,ut=et.edge),"disableSelection"in et&&i(11,O=et.disableSelection),"mermaidConfig"in et&&i(12,it=et.mermaidConfig),"translation"in et&&i(29,V=et.translation),"trackpadPan"in et&&i(13,_t=et.trackpadPan),"modifier"in et&&i(14,mt=et.modifier),"raiseEdgesOnSelect"in et&&i(30,F=et.raiseEdgesOnSelect),"edgesAboveNode"in et&&i(31,R=et.edgesAboveNode),"title"in et&&i(15,yt=et.title),"fixedZoom"in et&&i(16,tt=et.fixedZoom),"pannable"in et&&i(17,Pt=et.pannable),"$$scope"in et&&i(36,u=et.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&262144&&i(33,r=vt&&vt.edges),n.$$.dirty[0]&4456448&&vt&&vt.transforms.scale.set(w),n.$$.dirty[1]&4&&r&&r.onEdgeChange((et,Tt)=>{Mt(Tt,{sourceAnchor:et.source,targetAnchor:et.target,sourceNode:et.source.node,targetNode:et.target.node})})},i(19,s=c.background),[f,d,A,z,E,I,D,X,H,j,J,O,it,_t,mt,yt,tt,Pt,vt,s,p,g,w,k,P,C,$,st,ut,V,F,R,ot,r,a,Q,u]}class Jf extends Mn{constructor(e){super(),Sn(this,e,Kf,qf,pn,{mermaid:0,theme:1,id:20,snapTo:21,zoom:22,TD:23,editable:24,locked:25,width:2,height:3,minimap:4,controls:5,toggle:6,drawer:7,contrast:8,fitView:9,selectionColor:10,edgeStyle:26,endStyles:27,edge:28,disableSelection:11,mermaidConfig:12,translation:29,trackpadPan:13,modifier:14,raiseEdgesOnSelect:30,edgesAboveNode:31,title:15,fixedZoom:16,pannable:17,disconnect:32},null,[-1,-1])}get disconnect(){return this.$$.ctx[32]}}var Qf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ys={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(n,e){(function(i,s){s(e)})(Qf,function(i){var s="1.9.4";function r(t){var o,l,h,_;for(l=1,h=arguments.length;l<h;l++){_=arguments[l];for(o in _)t[o]=_[o]}return t}var a=Object.create||function(){function t(){}return function(o){return t.prototype=o,new t}}();function u(t,o){var l=Array.prototype.slice;if(t.bind)return t.bind.apply(t,l.call(arguments,1));var h=l.call(arguments,2);return function(){return t.apply(o,h.length?h.concat(l.call(arguments)):arguments)}}var c=0;function f(t){return"_leaflet_id"in t||(t._leaflet_id=++c),t._leaflet_id}function d(t,o,l){var h,_,v,S;return S=function(){h=!1,_&&(v.apply(l,_),_=!1)},v=function(){h?_=arguments:(t.apply(l,arguments),setTimeout(S,o),h=!0)},v}function p(t,o,l){var h=o[1],_=o[0],v=h-_;return t===h&&l?t:((t-_)%v+v)%v+_}function g(){return!1}function w(t,o){if(o===!1)return t;var l=Math.pow(10,o===void 0?6:o);return Math.round(t*l)/l}function k(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function P(t){return k(t).split(/\s+/)}function C(t,o){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?a(t.options):{});for(var l in o)t.options[l]=o[l];return t.options}function A(t,o,l){var h=[];for(var _ in t)h.push(encodeURIComponent(l?_.toUpperCase():_)+"="+encodeURIComponent(t[_]));return(!o||o.indexOf("?")===-1?"?":"&")+h.join("&")}var z=/\{ *([\w_ -]+) *\}/g;function E(t,o){return t.replace(z,function(l,h){var _=o[h];if(_===void 0)throw new Error("No value provided for variable "+l);return typeof _=="function"&&(_=_(o)),_})}var I=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function D(t,o){for(var l=0;l<t.length;l++)if(t[l]===o)return l;return-1}var X="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function H(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var j=0;function J(t){var o=+new Date,l=Math.max(0,16-(o-j));return j=o+l,window.setTimeout(t,l)}var $=window.requestAnimationFrame||H("RequestAnimationFrame")||J,st=window.cancelAnimationFrame||H("CancelAnimationFrame")||H("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function ut(t,o,l){if(l&&$===J)t.call(o);else return $.call(window,u(t,o))}function O(t){t&&st.call(window,t)}var it={__proto__:null,extend:r,create:a,bind:u,get lastId(){return c},stamp:f,throttle:d,wrapNum:p,falseFn:g,formatNum:w,trim:k,splitWords:P,setOptions:C,getParamString:A,template:E,isArray:I,indexOf:D,emptyImageUrl:X,requestFn:$,cancelFn:st,requestAnimFrame:ut,cancelAnimFrame:O};function V(){}V.extend=function(t){var o=function(){C(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},l=o.__super__=this.prototype,h=a(l);h.constructor=o,o.prototype=h;for(var _ in this)Object.prototype.hasOwnProperty.call(this,_)&&_!=="prototype"&&_!=="__super__"&&(o[_]=this[_]);return t.statics&&r(o,t.statics),t.includes&&(_t(t.includes),r.apply(null,[h].concat(t.includes))),r(h,t),delete h.statics,delete h.includes,h.options&&(h.options=l.options?a(l.options):{},r(h.options,t.options)),h._initHooks=[],h.callInitHooks=function(){if(!this._initHooksCalled){l.callInitHooks&&l.callInitHooks.call(this),this._initHooksCalled=!0;for(var v=0,S=h._initHooks.length;v<S;v++)h._initHooks[v].call(this)}},o},V.include=function(t){var o=this.prototype.options;return r(this.prototype,t),t.options&&(this.prototype.options=o,this.mergeOptions(t.options)),this},V.mergeOptions=function(t){return r(this.prototype.options,t),this},V.addInitHook=function(t){var o=Array.prototype.slice.call(arguments,1),l=typeof t=="function"?t:function(){this[t].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(l),this};function _t(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=I(t)?t:[t];for(var o=0;o<t.length;o++)t[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var mt={on:function(t,o,l){if(typeof t=="object")for(var h in t)this._on(h,t[h],o);else{t=P(t);for(var _=0,v=t.length;_<v;_++)this._on(t[_],o,l)}return this},off:function(t,o,l){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var h in t)this._off(h,t[h],o);else{t=P(t);for(var _=arguments.length===1,v=0,S=t.length;v<S;v++)_?this._off(t[v]):this._off(t[v],o,l)}return this},_on:function(t,o,l,h){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(t,o,l)===!1){l===this&&(l=void 0);var _={fn:o,ctx:l};h&&(_.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(_)}},_off:function(t,o,l){var h,_,v;if(this._events&&(h=this._events[t],!!h)){if(arguments.length===1){if(this._firingCount)for(_=0,v=h.length;_<v;_++)h[_].fn=g;delete this._events[t];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var S=this._listens(t,o,l);if(S!==!1){var N=h[S];this._firingCount&&(N.fn=g,this._events[t]=h=h.slice()),h.splice(S,1)}}},fire:function(t,o,l){if(!this.listens(t,l))return this;var h=r({},o,{type:t,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var _=this._events[t];if(_){this._firingCount=this._firingCount+1||1;for(var v=0,S=_.length;v<S;v++){var N=_[v],G=N.fn;N.once&&this.off(t,G,N.ctx),G.call(N.ctx||this,h)}this._firingCount--}}return l&&this._propagateEvent(h),this},listens:function(t,o,l,h){typeof t!="string"&&console.warn('"string" type argument expected');var _=o;typeof o!="function"&&(h=!!o,_=void 0,l=void 0);var v=this._events&&this._events[t];if(v&&v.length&&this._listens(t,_,l)!==!1)return!0;if(h){for(var S in this._eventParents)if(this._eventParents[S].listens(t,o,l,h))return!0}return!1},_listens:function(t,o,l){if(!this._events)return!1;var h=this._events[t]||[];if(!o)return!!h.length;l===this&&(l=void 0);for(var _=0,v=h.length;_<v;_++)if(h[_].fn===o&&h[_].ctx===l)return _;return!1},once:function(t,o,l){if(typeof t=="object")for(var h in t)this._on(h,t[h],o,!0);else{t=P(t);for(var _=0,v=t.length;_<v;_++)this._on(t[_],o,l,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[f(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[f(t)],this},_propagateEvent:function(t){for(var o in this._eventParents)this._eventParents[o].fire(t.type,r({layer:t.target,propagatedFrom:t.target},t),!0)}};mt.addEventListener=mt.on,mt.removeEventListener=mt.clearAllEventListeners=mt.off,mt.addOneTimeEventListener=mt.once,mt.fireEvent=mt.fire,mt.hasEventListeners=mt.listens;var F=V.extend(mt);function R(t,o,l){this.x=l?Math.round(t):t,this.y=l?Math.round(o):o}var yt=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};R.prototype={clone:function(){return new R(this.x,this.y)},add:function(t){return this.clone()._add(tt(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(tt(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new R(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new R(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=yt(this.x),this.y=yt(this.y),this},distanceTo:function(t){t=tt(t);var o=t.x-this.x,l=t.y-this.y;return Math.sqrt(o*o+l*l)},equals:function(t){return t=tt(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=tt(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function tt(t,o,l){return t instanceof R?t:I(t)?new R(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new R(t.x,t.y):new R(t,o,l)}function Pt(t,o){if(t)for(var l=o?[t,o]:t,h=0,_=l.length;h<_;h++)this.extend(l[h])}Pt.prototype={extend:function(t){var o,l;if(!t)return this;if(t instanceof R||typeof t[0]=="number"||"x"in t)o=l=tt(t);else if(t=Mt(t),o=t.min,l=t.max,!o||!l)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=l.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(l.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(l.y,this.max.y)),this},getCenter:function(t){return tt((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return tt(this.min.x,this.max.y)},getTopRight:function(){return tt(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var o,l;return typeof t[0]=="number"||t instanceof R?t=tt(t):t=Mt(t),t instanceof Pt?(o=t.min,l=t.max):o=l=t,o.x>=this.min.x&&l.x<=this.max.x&&o.y>=this.min.y&&l.y<=this.max.y},intersects:function(t){t=Mt(t);var o=this.min,l=this.max,h=t.min,_=t.max,v=_.x>=o.x&&h.x<=l.x,S=_.y>=o.y&&h.y<=l.y;return v&&S},overlaps:function(t){t=Mt(t);var o=this.min,l=this.max,h=t.min,_=t.max,v=_.x>o.x&&h.x<l.x,S=_.y>o.y&&h.y<l.y;return v&&S},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var o=this.min,l=this.max,h=Math.abs(o.x-l.x)*t,_=Math.abs(o.y-l.y)*t;return Mt(tt(o.x-h,o.y-_),tt(l.x+h,l.y+_))},equals:function(t){return t?(t=Mt(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function Mt(t,o){return!t||t instanceof Pt?t:new Pt(t,o)}function vt(t,o){if(t)for(var l=o?[t,o]:t,h=0,_=l.length;h<_;h++)this.extend(l[h])}vt.prototype={extend:function(t){var o=this._southWest,l=this._northEast,h,_;if(t instanceof ot)h=t,_=t;else if(t instanceof vt){if(h=t._southWest,_=t._northEast,!h||!_)return this}else return t?this.extend(Q(t)||U(t)):this;return!o&&!l?(this._southWest=new ot(h.lat,h.lng),this._northEast=new ot(_.lat,_.lng)):(o.lat=Math.min(h.lat,o.lat),o.lng=Math.min(h.lng,o.lng),l.lat=Math.max(_.lat,l.lat),l.lng=Math.max(_.lng,l.lng)),this},pad:function(t){var o=this._southWest,l=this._northEast,h=Math.abs(o.lat-l.lat)*t,_=Math.abs(o.lng-l.lng)*t;return new vt(new ot(o.lat-h,o.lng-_),new ot(l.lat+h,l.lng+_))},getCenter:function(){return new ot((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ot(this.getNorth(),this.getWest())},getSouthEast:function(){return new ot(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof ot||"lat"in t?t=Q(t):t=U(t);var o=this._southWest,l=this._northEast,h,_;return t instanceof vt?(h=t.getSouthWest(),_=t.getNorthEast()):h=_=t,h.lat>=o.lat&&_.lat<=l.lat&&h.lng>=o.lng&&_.lng<=l.lng},intersects:function(t){t=U(t);var o=this._southWest,l=this._northEast,h=t.getSouthWest(),_=t.getNorthEast(),v=_.lat>=o.lat&&h.lat<=l.lat,S=_.lng>=o.lng&&h.lng<=l.lng;return v&&S},overlaps:function(t){t=U(t);var o=this._southWest,l=this._northEast,h=t.getSouthWest(),_=t.getNorthEast(),v=_.lat>o.lat&&h.lat<l.lat,S=_.lng>o.lng&&h.lng<l.lng;return v&&S},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,o){return t?(t=U(t),this._southWest.equals(t.getSouthWest(),o)&&this._northEast.equals(t.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function U(t,o){return t instanceof vt?t:new vt(t,o)}function ot(t,o,l){if(isNaN(t)||isNaN(o))throw new Error("Invalid LatLng object: ("+t+", "+o+")");this.lat=+t,this.lng=+o,l!==void 0&&(this.alt=+l)}ot.prototype={equals:function(t,o){if(!t)return!1;t=Q(t);var l=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return l<=(o===void 0?1e-9:o)},toString:function(t){return"LatLng("+w(this.lat,t)+", "+w(this.lng,t)+")"},distanceTo:function(t){return Tt.distance(this,Q(t))},wrap:function(){return Tt.wrapLatLng(this)},toBounds:function(t){var o=180*t/40075017,l=o/Math.cos(Math.PI/180*this.lat);return U([this.lat-o,this.lng-l],[this.lat+o,this.lng+l])},clone:function(){return new ot(this.lat,this.lng,this.alt)}};function Q(t,o,l){return t instanceof ot?t:I(t)&&typeof t[0]!="object"?t.length===3?new ot(t[0],t[1],t[2]):t.length===2?new ot(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new ot(t.lat,"lng"in t?t.lng:t.lon,t.alt):o===void 0?null:new ot(t,o,l)}var et={latLngToPoint:function(t,o){var l=this.projection.project(t),h=this.scale(o);return this.transformation._transform(l,h)},pointToLatLng:function(t,o){var l=this.scale(o),h=this.transformation.untransform(t,l);return this.projection.unproject(h)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var o=this.projection.bounds,l=this.scale(t),h=this.transformation.transform(o.min,l),_=this.transformation.transform(o.max,l);return new Pt(h,_)},infinite:!1,wrapLatLng:function(t){var o=this.wrapLng?p(t.lng,this.wrapLng,!0):t.lng,l=this.wrapLat?p(t.lat,this.wrapLat,!0):t.lat,h=t.alt;return new ot(l,o,h)},wrapLatLngBounds:function(t){var o=t.getCenter(),l=this.wrapLatLng(o),h=o.lat-l.lat,_=o.lng-l.lng;if(h===0&&_===0)return t;var v=t.getSouthWest(),S=t.getNorthEast(),N=new ot(v.lat-h,v.lng-_),G=new ot(S.lat-h,S.lng-_);return new vt(N,G)}},Tt=r({},et,{wrapLng:[-180,180],R:6371e3,distance:function(t,o){var l=Math.PI/180,h=t.lat*l,_=o.lat*l,v=Math.sin((o.lat-t.lat)*l/2),S=Math.sin((o.lng-t.lng)*l/2),N=v*v+Math.cos(h)*Math.cos(_)*S*S,G=2*Math.atan2(Math.sqrt(N),Math.sqrt(1-N));return this.R*G}}),jt=6378137,ft={R:jt,MAX_LATITUDE:85.0511287798,project:function(t){var o=Math.PI/180,l=this.MAX_LATITUDE,h=Math.max(Math.min(l,t.lat),-l),_=Math.sin(h*o);return new R(this.R*t.lng*o,this.R*Math.log((1+_)/(1-_))/2)},unproject:function(t){var o=180/Math.PI;return new ot((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*o,t.x*o/this.R)},bounds:function(){var t=jt*Math.PI;return new Pt([-t,-t],[t,t])}()};function At(t,o,l,h){if(I(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=o,this._c=l,this._d=h}At.prototype={transform:function(t,o){return this._transform(t.clone(),o)},_transform:function(t,o){return o=o||1,t.x=o*(this._a*t.x+this._b),t.y=o*(this._c*t.y+this._d),t},untransform:function(t,o){return o=o||1,new R((t.x/o-this._b)/this._a,(t.y/o-this._d)/this._c)}};function Dt(t,o,l,h){return new At(t,o,l,h)}var Zt=r({},Tt,{code:"EPSG:3857",projection:ft,transformation:function(){var t=.5/(Math.PI*ft.R);return Dt(t,.5,-t,.5)}()}),$t=r({},Zt,{code:"EPSG:900913"});function ze(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function ae(t,o){var l="",h,_,v,S,N,G;for(h=0,v=t.length;h<v;h++){for(N=t[h],_=0,S=N.length;_<S;_++)G=N[_],l+=(_?"L":"M")+G.x+" "+G.y;l+=o?Lt.svg?"z":"x":""}return l||"M0 0"}var rt=document.documentElement.style,_e="ActiveXObject"in window,Rt=_e&&!document.addEventListener,zt="msLaunchUri"in navigator&&!("documentMode"in document),Ft=en("webkit"),Xt=en("android"),Ne=en("android 2")||en("android 3"),Ie=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),we=Xt&&en("Google")&&Ie<537&&!("AudioNode"in window),Ut=!!window.opera,tn=!zt&&en("chrome"),te=en("gecko")&&!Ft&&!Ut&&!_e,cn=!tn&&en("safari"),fe=en("phantom"),ee="OTransition"in rt,me=navigator.platform.indexOf("Win")===0,Ze=_e&&"transition"in rt,He="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ne,hn="MozPerspective"in rt,je=!window.L_DISABLE_3D&&(Ze||He||hn)&&!ee&&!fe,Ue=typeof orientation<"u"||en("mobile"),It=Ue&&Ft,Ke=Ue&&He,Je=!window.PointerEvent&&window.MSPointerEvent,gn=!!(window.PointerEvent||Je),zn="ontouchstart"in window||!!window.TouchEvent,Bn=!window.L_NO_TOUCH&&(zn||gn),Se=Ue&&Ut,De=Ue&&te,fn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Kt=function(){var t=!1;try{var o=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",g,o),window.removeEventListener("testPassiveEventSupport",g,o)}catch{}return t}(),ue=function(){return!!document.createElement("canvas").getContext}(),Fe=!!(document.createElementNS&&ze("svg").createSVGRect),_n=!!Fe&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Xe=!Fe&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var o=t.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}}(),bn=navigator.platform.indexOf("Mac")===0,Tn=navigator.platform.indexOf("Linux")===0;function en(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Lt={ie:_e,ielt9:Rt,edge:zt,webkit:Ft,android:Xt,android23:Ne,androidStock:we,opera:Ut,chrome:tn,gecko:te,safari:cn,phantom:fe,opera12:ee,win:me,ie3d:Ze,webkit3d:He,gecko3d:hn,any3d:je,mobile:Ue,mobileWebkit:It,mobileWebkit3d:Ke,msPointer:Je,pointer:gn,touch:Bn,touchNative:zn,mobileOpera:Se,mobileGecko:De,retina:fn,passiveEvents:Kt,canvas:ue,svg:Fe,vml:Xe,inlineSvg:_n,mac:bn,linux:Tn},Ve=Lt.msPointer?"MSPointerDown":"pointerdown",wn=Lt.msPointer?"MSPointerMove":"pointermove",nn=Lt.msPointer?"MSPointerUp":"pointerup",kn=Lt.msPointer?"MSPointerCancel":"pointercancel",b={touchstart:Ve,touchmove:wn,touchend:nn,touchcancel:kn},dt={touchstart:Re,touchmove:dn,touchend:dn,touchcancel:dn},wt={},kt=!1;function Et(t,o,l){return o==="touchstart"&&Oe(),dt[o]?(l=dt[o].bind(this,l),t.addEventListener(b[o],l,!1),l):(console.warn("wrong event specified:",o),g)}function B(t,o,l){if(!b[o]){console.warn("wrong event specified:",o);return}t.removeEventListener(b[o],l,!1)}function Vt(t){wt[t.pointerId]=t}function ce(t){wt[t.pointerId]&&(wt[t.pointerId]=t)}function Jt(t){delete wt[t.pointerId]}function Oe(){kt||(document.addEventListener(Ve,Vt,!0),document.addEventListener(wn,ce,!0),document.addEventListener(nn,Jt,!0),document.addEventListener(kn,Jt,!0),kt=!0)}function dn(t,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var l in wt)o.touches.push(wt[l]);o.changedTouches=[o],t(o)}}function Re(t,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&An(o),dn(t,o)}function mn(t){var o={},l,h;for(h in t)l=t[h],o[h]=l&&l.bind?l.bind(t):l;return t=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var Zn=200;function ti(t,o){t.addEventListener("dblclick",o);var l=0,h;function _(v){if(v.detail!==1){h=v.detail;return}if(!(v.pointerType==="mouse"||v.sourceCapabilities&&!v.sourceCapabilities.firesTouchEvents)){var S=go(v);if(!(S.some(function(G){return G instanceof HTMLLabelElement&&G.attributes.for})&&!S.some(function(G){return G instanceof HTMLInputElement||G instanceof HTMLSelectElement}))){var N=Date.now();N-l<=Zn?(h++,h===2&&o(mn(v))):h=1,l=N}}}return t.addEventListener("click",_),{dblclick:o,simDblclick:_}}function Dn(t,o){t.removeEventListener("dblclick",o.dblclick),t.removeEventListener("click",o.simDblclick)}var En=Ln(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),Rn=Ln(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),xn=Rn==="webkitTransition"||Rn==="OTransition"?Rn+"End":"transitionend";function si(t){return typeof t=="string"?document.getElementById(t):t}function pt(t,o){var l=t.style[o]||t.currentStyle&&t.currentStyle[o];if((!l||l==="auto")&&document.defaultView){var h=document.defaultView.getComputedStyle(t,null);l=h?h[o]:null}return l==="auto"?null:l}function xt(t,o,l){var h=document.createElement(t);return h.className=o||"",l&&l.appendChild(h),h}function ne(t){var o=t.parentNode;o&&o.removeChild(t)}function vn(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function xe(t){var o=t.parentNode;o&&o.lastChild!==t&&o.appendChild(t)}function rn(t){var o=t.parentNode;o&&o.firstChild!==t&&o.insertBefore(t,o.firstChild)}function Me(t,o){if(t.classList!==void 0)return t.classList.contains(o);var l=ln(t);return l.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(l)}function Wt(t,o){if(t.classList!==void 0)for(var l=P(o),h=0,_=l.length;h<_;h++)t.classList.add(l[h]);else if(!Me(t,o)){var v=ln(t);Nn(t,(v?v+" ":"")+o)}}function Te(t,o){t.classList!==void 0?t.classList.remove(o):Nn(t,k((" "+ln(t)+" ").replace(" "+o+" "," ")))}function Nn(t,o){t.className.baseVal===void 0?t.className=o:t.className.baseVal=o}function ln(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function Pn(t,o){"opacity"in t.style?t.style.opacity=o:"filter"in t.style&&ei(t,o)}function ei(t,o){var l=!1,h="DXImageTransform.Microsoft.Alpha";try{l=t.filters.item(h)}catch{if(o===1)return}o=Math.round(o*100),l?(l.Enabled=o!==100,l.Opacity=o):t.style.filter+=" progid:"+h+"(opacity="+o+")"}function Ln(t){for(var o=document.documentElement.style,l=0;l<t.length;l++)if(t[l]in o)return t[l];return!1}function Ye(t,o,l){var h=o||new R(0,0);t.style[En]=(Lt.ie3d?"translate("+h.x+"px,"+h.y+"px)":"translate3d("+h.x+"px,"+h.y+"px,0)")+(l?" scale("+l+")":"")}function ie(t,o){t._leaflet_pos=o,Lt.any3d?Ye(t,o):(t.style.left=o.x+"px",t.style.top=o.y+"px")}function Qe(t){return t._leaflet_pos||new R(0,0)}var an,un,ni;if("onselectstart"in document)an=function(){qt(window,"selectstart",An)},un=function(){Ge(window,"selectstart",An)};else{var Wn=Ln(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);an=function(){if(Wn){var t=document.documentElement.style;ni=t[Wn],t[Wn]="none"}},un=function(){Wn&&(document.documentElement.style[Wn]=ni,ni=void 0)}}function Hn(){qt(window,"dragstart",An)}function Nt(){Ge(window,"dragstart",An)}var he,ii;function Ui(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(zi(),he=t,ii=t.style.outlineStyle,t.style.outlineStyle="none",qt(window,"keydown",zi))}function zi(){he&&(he.style.outlineStyle=ii,he=void 0,ii=void 0,Ge(window,"keydown",zi))}function mo(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function Xi(t){var o=t.getBoundingClientRect();return{x:o.width/t.offsetWidth||1,y:o.height/t.offsetHeight||1,boundingClientRect:o}}var jo={__proto__:null,TRANSFORM:En,TRANSITION:Rn,TRANSITION_END:xn,get:si,getStyle:pt,create:xt,remove:ne,empty:vn,toFront:xe,toBack:rn,hasClass:Me,addClass:Wt,removeClass:Te,setClass:Nn,getClass:ln,setOpacity:Pn,testProp:Ln,setTransform:Ye,setPosition:ie,getPosition:Qe,get disableTextSelection(){return an},get enableTextSelection(){return un},disableImageDrag:Hn,enableImageDrag:Nt,preventOutline:Ui,restoreOutline:zi,getSizedParentNode:mo,getScale:Xi};function qt(t,o,l,h){if(o&&typeof o=="object")for(var _ in o)Yi(t,_,o[_],l);else{o=P(o);for(var v=0,S=o.length;v<S;v++)Yi(t,o[v],l,h)}return this}var Jn="_leaflet_events";function Ge(t,o,l,h){if(arguments.length===1)po(t),delete t[Jn];else if(o&&typeof o=="object")for(var _ in o)qi(t,_,o[_],l);else if(o=P(o),arguments.length===2)po(t,function(N){return D(o,N)!==-1});else for(var v=0,S=o.length;v<S;v++)qi(t,o[v],l,h);return this}function po(t,o){for(var l in t[Jn]){var h=l.split(/\d/)[0];(!o||o(h))&&qi(t,h,null,null,l)}}var Vi={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Yi(t,o,l,h){var _=o+f(l)+(h?"_"+f(h):"");if(t[Jn]&&t[Jn][_])return this;var v=function(N){return l.call(h||t,N||window.event)},S=v;!Lt.touchNative&&Lt.pointer&&o.indexOf("touch")===0?v=Et(t,o,v):Lt.touch&&o==="dblclick"?v=ti(t,v):"addEventListener"in t?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?t.addEventListener(Vi[o]||o,v,Lt.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(v=function(N){N=N||window.event,Ji(t,N)&&S(N)},t.addEventListener(Vi[o],v,!1)):t.addEventListener(o,S,!1):t.attachEvent("on"+o,v),t[Jn]=t[Jn]||{},t[Jn][_]=v}function qi(t,o,l,h,_){_=_||o+f(l)+(h?"_"+f(h):"");var v=t[Jn]&&t[Jn][_];if(!v)return this;!Lt.touchNative&&Lt.pointer&&o.indexOf("touch")===0?B(t,o,v):Lt.touch&&o==="dblclick"?Dn(t,v):"removeEventListener"in t?t.removeEventListener(Vi[o]||o,v,!1):t.detachEvent("on"+o,v),t[Jn][_]=null}function hi(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function Ki(t){return Yi(t,"wheel",hi),this}function Li(t){return qt(t,"mousedown touchstart dblclick contextmenu",hi),t._leaflet_disable_click=!0,this}function An(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function fi(t){return An(t),hi(t),this}function go(t){if(t.composedPath)return t.composedPath();for(var o=[],l=t.target;l;)o.push(l),l=l.parentNode;return o}function vo(t,o){if(!o)return new R(t.clientX,t.clientY);var l=Xi(o),h=l.boundingClientRect;return new R((t.clientX-h.left)/l.x-o.clientLeft,(t.clientY-h.top)/l.y-o.clientTop)}var Uo=Lt.linux&&Lt.chrome?window.devicePixelRatio:Lt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function yo(t){return Lt.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/Uo:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function Ji(t,o){var l=o.relatedTarget;if(!l)return!0;try{for(;l&&l!==t;)l=l.parentNode}catch{return!1}return l!==t}var Xo={__proto__:null,on:qt,off:Ge,stopPropagation:hi,disableScrollPropagation:Ki,disableClickPropagation:Li,preventDefault:An,stop:fi,getPropagationPath:go,getMousePosition:vo,getWheelDelta:yo,isExternalTarget:Ji,addListener:qt,removeListener:Ge},M=F.extend({run:function(t,o,l,h){this.stop(),this._el=t,this._inProgress=!0,this._duration=l||.25,this._easeOutPower=1/Math.max(h||.5,.2),this._startPos=Qe(t),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ut(this._animate,this),this._step()},_step:function(t){var o=+new Date-this._startTime,l=this._duration*1e3;o<l?this._runFrame(this._easeOut(o/l),t):(this._runFrame(1),this._complete())},_runFrame:function(t,o){var l=this._startPos.add(this._offset.multiplyBy(t));o&&l._round(),ie(this._el,l),this.fire("step")},_complete:function(){O(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),x=F.extend({options:{crs:Zt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,o){o=C(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=u(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView(Q(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=Rn&&Lt.any3d&&!Lt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),qt(this._proxy,xn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,o,l){if(o=o===void 0?this._zoom:this._limitZoom(o),t=this._limitCenter(Q(t),o,this.options.maxBounds),l=l||{},this._stop(),this._loaded&&!l.reset&&l!==!0){l.animate!==void 0&&(l.zoom=r({animate:l.animate},l.zoom),l.pan=r({animate:l.animate,duration:l.duration},l.pan));var h=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,o,l.zoom):this._tryAnimatedPan(t,l.pan);if(h)return clearTimeout(this._sizeTimer),this}return this._resetView(t,o,l.pan&&l.pan.noMoveStart),this},setZoom:function(t,o){return this._loaded?this.setView(this.getCenter(),t,{zoom:o}):(this._zoom=t,this)},zoomIn:function(t,o){return t=t||(Lt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,o)},zoomOut:function(t,o){return t=t||(Lt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,o)},setZoomAround:function(t,o,l){var h=this.getZoomScale(o),_=this.getSize().divideBy(2),v=t instanceof R?t:this.latLngToContainerPoint(t),S=v.subtract(_).multiplyBy(1-1/h),N=this.containerPointToLatLng(_.add(S));return this.setView(N,o,{zoom:l})},_getBoundsCenterZoom:function(t,o){o=o||{},t=t.getBounds?t.getBounds():U(t);var l=tt(o.paddingTopLeft||o.padding||[0,0]),h=tt(o.paddingBottomRight||o.padding||[0,0]),_=this.getBoundsZoom(t,!1,l.add(h));if(_=typeof o.maxZoom=="number"?Math.min(o.maxZoom,_):_,_===1/0)return{center:t.getCenter(),zoom:_};var v=h.subtract(l).divideBy(2),S=this.project(t.getSouthWest(),_),N=this.project(t.getNorthEast(),_),G=this.unproject(S.add(N).divideBy(2).add(v),_);return{center:G,zoom:_}},fitBounds:function(t,o){if(t=U(t),!t.isValid())throw new Error("Bounds are not valid.");var l=this._getBoundsCenterZoom(t,o);return this.setView(l.center,l.zoom,o)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,o){return this.setView(t,this._zoom,{pan:o})},panBy:function(t,o){if(t=tt(t).round(),o=o||{},!t.x&&!t.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new M,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){Wt(this._mapPane,"leaflet-pan-anim");var l=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,l,o.duration||.25,o.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,o,l){if(l=l||{},l.animate===!1||!Lt.any3d)return this.setView(t,o,l);this._stop();var h=this.project(this.getCenter()),_=this.project(t),v=this.getSize(),S=this._zoom;t=Q(t),o=o===void 0?S:o;var N=Math.max(v.x,v.y),G=N*this.getZoomScale(S,o),ht=_.distanceTo(h)||1,St=1.42,Gt=St*St;function re(Cn){var zo=Cn?-1:1,cu=Cn?G:N,hu=G*G-N*N+zo*Gt*Gt*ht*ht,fu=2*cu*Gt*ht,ns=hu/fu,tr=Math.sqrt(ns*ns+1)-ns,du=tr<1e-9?-18:Math.log(tr);return du}function Gn(Cn){return(Math.exp(Cn)-Math.exp(-Cn))/2}function On(Cn){return(Math.exp(Cn)+Math.exp(-Cn))/2}function $n(Cn){return Gn(Cn)/On(Cn)}var Xn=re(0);function Ri(Cn){return N*(On(Xn)/On(Xn+St*Cn))}function ru(Cn){return N*(On(Xn)*$n(Xn+St*Cn)-Gn(Xn))/Gt}function lu(Cn){return 1-Math.pow(1-Cn,1.5)}var au=Date.now(),Qs=(re(1)-Xn)/St,uu=l.duration?1e3*l.duration:1e3*Qs*.8;function $s(){var Cn=(Date.now()-au)/uu,zo=lu(Cn)*Qs;Cn<=1?(this._flyToFrame=ut($s,this),this._move(this.unproject(h.add(_.subtract(h).multiplyBy(ru(zo)/ht)),S),this.getScaleZoom(N/Ri(zo),S),{flyTo:!0})):this._move(t,o)._moveEnd(!0)}return this._moveStart(!0,l.noMoveStart),$s.call(this),this},flyToBounds:function(t,o){var l=this._getBoundsCenterZoom(t,o);return this.flyTo(l.center,l.zoom,o)},setMaxBounds:function(t){return t=U(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var o=this.options.minZoom;return this.options.minZoom=t,this._loaded&&o!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var o=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&o!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,o){this._enforcingBounds=!0;var l=this.getCenter(),h=this._limitCenter(l,this._zoom,U(t));return l.equals(h)||this.panTo(h,o),this._enforcingBounds=!1,this},panInside:function(t,o){o=o||{};var l=tt(o.paddingTopLeft||o.padding||[0,0]),h=tt(o.paddingBottomRight||o.padding||[0,0]),_=this.project(this.getCenter()),v=this.project(t),S=this.getPixelBounds(),N=Mt([S.min.add(l),S.max.subtract(h)]),G=N.getSize();if(!N.contains(v)){this._enforcingBounds=!0;var ht=v.subtract(N.getCenter()),St=N.extend(v).getSize().subtract(G);_.x+=ht.x<0?-St.x:St.x,_.y+=ht.y<0?-St.y:St.y,this.panTo(this.unproject(_),o),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=r({animate:!1,pan:!0},t===!0?{animate:!0}:t);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var l=this.getSize(),h=o.divideBy(2).round(),_=l.divideBy(2).round(),v=h.subtract(_);return!v.x&&!v.y?this:(t.animate&&t.pan?this.panBy(v):(t.pan&&this._rawPanBy(v),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(u(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:l}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=r({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=u(this._handleGeolocationResponse,this),l=u(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,l,t):navigator.geolocation.getCurrentPosition(o,l,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var o=t.code,l=t.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+l+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var o=t.coords.latitude,l=t.coords.longitude,h=new ot(o,l),_=h.toBounds(t.coords.accuracy*2),v=this._locateOptions;if(v.setView){var S=this.getBoundsZoom(_);this.setView(h,v.maxZoom?Math.min(S,v.maxZoom):S)}var N={latlng:h,bounds:_,timestamp:t.timestamp};for(var G in t.coords)typeof t.coords[G]=="number"&&(N[G]=t.coords[G]);this.fire("locationfound",N)}},addHandler:function(t,o){if(!o)return this;var l=this[t]=new o(this);return this._handlers.push(l),this.options[t]&&l.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ne(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(O(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)ne(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,o){var l="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),h=xt("div",l,o||this._mapPane);return t&&(this._panes[t]=h),h},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),o=this.unproject(t.getBottomLeft()),l=this.unproject(t.getTopRight());return new vt(o,l)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,o,l){t=U(t),l=tt(l||[0,0]);var h=this.getZoom()||0,_=this.getMinZoom(),v=this.getMaxZoom(),S=t.getNorthWest(),N=t.getSouthEast(),G=this.getSize().subtract(l),ht=Mt(this.project(N,h),this.project(S,h)).getSize(),St=Lt.any3d?this.options.zoomSnap:1,Gt=G.x/ht.x,re=G.y/ht.y,Gn=o?Math.max(Gt,re):Math.min(Gt,re);return h=this.getScaleZoom(Gn,h),St&&(h=Math.round(h/(St/100))*(St/100),h=o?Math.ceil(h/St)*St:Math.floor(h/St)*St),Math.max(_,Math.min(v,h))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new R(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,o){var l=this._getTopLeftPoint(t,o);return new Pt(l,l.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,o){var l=this.options.crs;return o=o===void 0?this._zoom:o,l.scale(t)/l.scale(o)},getScaleZoom:function(t,o){var l=this.options.crs;o=o===void 0?this._zoom:o;var h=l.zoom(t*l.scale(o));return isNaN(h)?1/0:h},project:function(t,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint(Q(t),o)},unproject:function(t,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(tt(t),o)},layerPointToLatLng:function(t){var o=tt(t).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(t){var o=this.project(Q(t))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(Q(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(U(t))},distance:function(t,o){return this.options.crs.distance(Q(t),Q(o))},containerPointToLayerPoint:function(t){return tt(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return tt(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var o=this.containerPointToLayerPoint(tt(t));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Q(t)))},mouseEventToContainerPoint:function(t){return vo(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var o=this._container=si(t);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");qt(o,"scroll",this._onScroll,this),this._containerId=f(o)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Lt.any3d,Wt(t,"leaflet-container"+(Lt.touch?" leaflet-touch":"")+(Lt.retina?" leaflet-retina":"")+(Lt.ielt9?" leaflet-oldie":"")+(Lt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=pt(t,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ie(this._mapPane,new R(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Wt(t.markerPane,"leaflet-zoom-hide"),Wt(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,o,l){ie(this._mapPane,new R(0,0));var h=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var _=this._zoom!==o;this._moveStart(_,l)._move(t,o)._moveEnd(_),this.fire("viewreset"),h&&this.fire("load")},_moveStart:function(t,o){return t&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(t,o,l,h){o===void 0&&(o=this._zoom);var _=this._zoom!==o;return this._zoom=o,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),h?l&&l.pinch&&this.fire("zoom",l):((_||l&&l.pinch)&&this.fire("zoom",l),this.fire("move",l)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return O(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){ie(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[f(this._container)]=this;var o=t?Ge:qt;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),Lt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){O(this._resizeRequest),this._resizeRequest=ut(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,o){for(var l=[],h,_=o==="mouseout"||o==="mouseover",v=t.target||t.srcElement,S=!1;v;){if(h=this._targets[f(v)],h&&(o==="click"||o==="preclick")&&this._draggableMoved(h)){S=!0;break}if(h&&h.listens(o,!0)&&(_&&!Ji(v,t)||(l.push(h),_))||v===this._container)break;v=v.parentNode}return!l.length&&!S&&!_&&this.listens(o,!0)&&(l=[this]),l},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var o=t.target||t.srcElement;if(!(!this._loaded||o._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(o))){var l=t.type;l==="mousedown"&&Ui(o),this._fireDOMEvent(t,l)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,o,l){if(t.type==="click"){var h=r({},t);h.type="preclick",this._fireDOMEvent(h,h.type,l)}var _=this._findEventTargets(t,o);if(l){for(var v=[],S=0;S<l.length;S++)l[S].listens(o,!0)&&v.push(l[S]);_=v.concat(_)}if(_.length){o==="contextmenu"&&An(t);var N=_[0],G={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var ht=N.getLatLng&&(!N._radius||N._radius<=10);G.containerPoint=ht?this.latLngToContainerPoint(N.getLatLng()):this.mouseEventToContainerPoint(t),G.layerPoint=this.containerPointToLayerPoint(G.containerPoint),G.latlng=ht?N.getLatLng():this.layerPointToLatLng(G.layerPoint)}for(S=0;S<_.length;S++)if(_[S].fire(o,G,!0),G.originalEvent._stopped||_[S].options.bubblingMouseEvents===!1&&D(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,o=this._handlers.length;t<o;t++)this._handlers[t].disable()},whenReady:function(t,o){return this._loaded?t.call(o||this,{target:this}):this.on("load",t,o),this},_getMapPanePos:function(){return Qe(this._mapPane)||new R(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,o){var l=t&&o!==void 0?this._getNewPixelOrigin(t,o):this.getPixelOrigin();return l.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,o){var l=this.getSize()._divideBy(2);return this.project(t,o)._subtract(l)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,o,l){var h=this._getNewPixelOrigin(l,o);return this.project(t,o)._subtract(h)},_latLngBoundsToNewLayerBounds:function(t,o,l){var h=this._getNewPixelOrigin(l,o);return Mt([this.project(t.getSouthWest(),o)._subtract(h),this.project(t.getNorthWest(),o)._subtract(h),this.project(t.getSouthEast(),o)._subtract(h),this.project(t.getNorthEast(),o)._subtract(h)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,o,l){if(!l)return t;var h=this.project(t,o),_=this.getSize().divideBy(2),v=new Pt(h.subtract(_),h.add(_)),S=this._getBoundsOffset(v,l,o);return Math.abs(S.x)<=1&&Math.abs(S.y)<=1?t:this.unproject(h.add(S),o)},_limitOffset:function(t,o){if(!o)return t;var l=this.getPixelBounds(),h=new Pt(l.min.add(t),l.max.add(t));return t.add(this._getBoundsOffset(h,o))},_getBoundsOffset:function(t,o,l){var h=Mt(this.project(o.getNorthEast(),l),this.project(o.getSouthWest(),l)),_=h.min.subtract(t.min),v=h.max.subtract(t.max),S=this._rebound(_.x,-v.x),N=this._rebound(_.y,-v.y);return new R(S,N)},_rebound:function(t,o){return t+o>0?Math.round(t-o)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(o))},_limitZoom:function(t){var o=this.getMinZoom(),l=this.getMaxZoom(),h=Lt.any3d?this.options.zoomSnap:1;return h&&(t=Math.round(t/h)*h),Math.max(o,Math.min(l,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){Te(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,o){var l=this._getCenterOffset(t)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(l)?!1:(this.panBy(l,o),!0)},_createAnimProxy:function(){var t=this._proxy=xt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(o){var l=En,h=this._proxy.style[l];Ye(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),h===this._proxy.style[l]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ne(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),o=this.getZoom();Ye(this._proxy,this.project(t,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,o,l){if(this._animatingZoom)return!0;if(l=l||{},!this._zoomAnimated||l.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var h=this.getZoomScale(o),_=this._getCenterOffset(t)._divideBy(1-1/h);return l.animate!==!0&&!this.getSize().contains(_)?!1:(ut(function(){this._moveStart(!0,l.noMoveStart||!1)._animateZoom(t,o,!0)},this),!0)},_animateZoom:function(t,o,l,h){this._mapPane&&(l&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=o,Wt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:o,noUpdate:h}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(u(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&Te(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ct(t,o){return new x(t,o)}var Ot=V.extend({options:{position:"topright"},initialize:function(t){C(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var o=this._map;return o&&o.removeControl(this),this.options.position=t,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var o=this._container=this.onAdd(t),l=this.getPosition(),h=t._controlCorners[l];return Wt(o,"leaflet-control"),l.indexOf("bottom")!==-1?h.insertBefore(o,h.firstChild):h.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ne(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),Ct=function(t){return new Ot(t)};x.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},o="leaflet-",l=this._controlContainer=xt("div",o+"control-container",this._container);function h(_,v){var S=o+_+" "+o+v;t[_+v]=xt("div",S,l)}h("top","left"),h("top","right"),h("bottom","left"),h("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ne(this._controlCorners[t]);ne(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var $e=Ot.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,o,l,h){return l<h?-1:h<l?1:0}},initialize:function(t,o,l){C(this,l),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var h in t)this._addLayer(t[h],h);for(h in o)this._addLayer(o[h],h,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Ot.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,o){return this._addLayer(t,o),this._map?this._update():this},addOverlay:function(t,o){return this._addLayer(t,o,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var o=this._getLayer(f(t));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){Wt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(Wt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):Te(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return Te(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",o=this._container=xt("div",t),l=this.options.collapsed;o.setAttribute("aria-haspopup",!0),Li(o),Ki(o);var h=this._section=xt("section",t+"-list");l&&(this._map.on("click",this.collapse,this),qt(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var _=this._layersLink=xt("a",t+"-toggle",o);_.href="#",_.title="Layers",_.setAttribute("role","button"),qt(_,{keydown:function(v){v.keyCode===13&&this._expandSafely()},click:function(v){An(v),this._expandSafely()}},this),l||this.expand(),this._baseLayersList=xt("div",t+"-base",h),this._separator=xt("div",t+"-separator",h),this._overlaysList=xt("div",t+"-overlays",h),o.appendChild(h)},_getLayer:function(t){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&f(this._layers[o].layer)===t)return this._layers[o]},_addLayer:function(t,o,l){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:o,overlay:l}),this.options.sortLayers&&this._layers.sort(u(function(h,_){return this.options.sortFunction(h.layer,_.layer,h.name,_.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;vn(this._baseLayersList),vn(this._overlaysList),this._layerControlInputs=[];var t,o,l,h,_=0;for(l=0;l<this._layers.length;l++)h=this._layers[l],this._addItem(h),o=o||h.overlay,t=t||!h.overlay,_+=h.overlay?0:1;return this.options.hideSingleBase&&(t=t&&_>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=o&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var o=this._getLayer(f(t.target)),l=o.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;l&&this._map.fire(l,o)},_createRadioElement:function(t,o){var l='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(o?' checked="checked"':"")+"/>",h=document.createElement("div");return h.innerHTML=l,h.firstChild},_addItem:function(t){var o=document.createElement("label"),l=this._map.hasLayer(t.layer),h;t.overlay?(h=document.createElement("input"),h.type="checkbox",h.className="leaflet-control-layers-selector",h.defaultChecked=l):h=this._createRadioElement("leaflet-base-layers_"+f(this),l),this._layerControlInputs.push(h),h.layerId=f(t.layer),qt(h,"click",this._onInputClick,this);var _=document.createElement("span");_.innerHTML=" "+t.name;var v=document.createElement("span");o.appendChild(v),v.appendChild(h),v.appendChild(_);var S=t.overlay?this._overlaysList:this._baseLayersList;return S.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,o,l,h=[],_=[];this._handlingClick=!0;for(var v=t.length-1;v>=0;v--)o=t[v],l=this._getLayer(o.layerId).layer,o.checked?h.push(l):o.checked||_.push(l);for(v=0;v<_.length;v++)this._map.hasLayer(_[v])&&this._map.removeLayer(_[v]);for(v=0;v<h.length;v++)this._map.hasLayer(h[v])||this._map.addLayer(h[v]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,o,l,h=this._map.getZoom(),_=t.length-1;_>=0;_--)o=t[_],l=this._getLayer(o.layerId).layer,o.disabled=l.options.minZoom!==void 0&&h<l.options.minZoom||l.options.maxZoom!==void 0&&h>l.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,qt(t,"click",An),this.expand();var o=this;setTimeout(function(){Ge(t,"click",An),o._preventClick=!1})}}),Fn=function(t,o,l){return new $e(t,o,l)},ri=Ot.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var o="leaflet-control-zoom",l=xt("div",o+" leaflet-bar"),h=this.options;return this._zoomInButton=this._createButton(h.zoomInText,h.zoomInTitle,o+"-in",l,this._zoomIn),this._zoomOutButton=this._createButton(h.zoomOutText,h.zoomOutTitle,o+"-out",l,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),l},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,o,l,h,_){var v=xt("a",l,h);return v.innerHTML=t,v.href="#",v.title=o,v.setAttribute("role","button"),v.setAttribute("aria-label",o),Li(v),qt(v,"click",fi),qt(v,"click",_,this),qt(v,"click",this._refocusOnMap,this),v},_updateDisabled:function(){var t=this._map,o="leaflet-disabled";Te(this._zoomInButton,o),Te(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(Wt(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(Wt(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});x.mergeOptions({zoomControl:!0}),x.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new ri,this.addControl(this.zoomControl))});var Be=function(t){return new ri(t)},In=Ot.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var o="leaflet-control-scale",l=xt("div",o),h=this.options;return this._addScales(h,o+"-line",l),t.on(h.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),l},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,o,l){t.metric&&(this._mScale=xt("div",o,l)),t.imperial&&(this._iScale=xt("div",o,l))},_update:function(){var t=this._map,o=t.getSize().y/2,l=t.distance(t.containerPointToLatLng([0,o]),t.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(l)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var o=this._getRoundNum(t),l=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,l,o/t)},_updateImperial:function(t){var o=t*3.2808399,l,h,_;o>5280?(l=o/5280,h=this._getRoundNum(l),this._updateScale(this._iScale,h+" mi",h/l)):(_=this._getRoundNum(o),this._updateScale(this._iScale,_+" ft",_/o))},_updateScale:function(t,o,l){t.style.width=Math.round(this.options.maxWidth*l)+"px",t.innerHTML=o},_getRoundNum:function(t){var o=Math.pow(10,(Math.floor(t)+"").length-1),l=t/o;return l=l>=10?10:l>=5?5:l>=3?3:l>=2?2:1,o*l}}),Ci=function(t){return new In(t)},Vo='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Qi=Ot.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Lt.inlineSvg?Vo+" ":"")+"Leaflet</a>"},initialize:function(t){C(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=xt("div","leaflet-control-attribution"),Li(this._container);for(var o in t._layers)t._layers[o].getAttribution&&this.addAttribution(t._layers[o].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var o in this._attributions)this._attributions[o]&&t.push(o);var l=[];this.options.prefix&&l.push(this.options.prefix),t.length&&l.push(t.join(", ")),this._container.innerHTML=l.join(' <span aria-hidden="true">|</span> ')}}});x.mergeOptions({attributionControl:!0}),x.addInitHook(function(){this.options.attributionControl&&new Qi().addTo(this)});var Ni=function(t){return new Qi(t)};Ot.Layers=$e,Ot.Zoom=ri,Ot.Scale=In,Ot.Attribution=Qi,Ct.layers=Fn,Ct.zoom=Be,Ct.scale=Ci,Ct.attribution=Ni;var li=V.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});li.addTo=function(t,o){return t.addHandler(o,this),this};var Ea={Events:mt},Ps=Lt.touch?"touchstart mousedown":"mousedown",yi=F.extend({options:{clickTolerance:3},initialize:function(t,o,l,h){C(this,h),this._element=t,this._dragStartTarget=o||t,this._preventOutline=l},enable:function(){this._enabled||(qt(this._dragStartTarget,Ps,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(yi._dragging===this&&this.finishDrag(!0),Ge(this._dragStartTarget,Ps,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!Me(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){yi._dragging===this&&this.finishDrag();return}if(!(yi._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(yi._dragging=this,this._preventOutline&&Ui(this._element),Hn(),an(),!this._moving)){this.fire("down");var o=t.touches?t.touches[0]:t,l=mo(this._element);this._startPoint=new R(o.clientX,o.clientY),this._startPos=Qe(this._element),this._parentScale=Xi(l);var h=t.type==="mousedown";qt(document,h?"mousemove":"touchmove",this._onMove,this),qt(document,h?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var o=t.touches&&t.touches.length===1?t.touches[0]:t,l=new R(o.clientX,o.clientY)._subtract(this._startPoint);!l.x&&!l.y||Math.abs(l.x)+Math.abs(l.y)<this.options.clickTolerance||(l.x/=this._parentScale.x,l.y/=this._parentScale.y,An(t),this._moved||(this.fire("dragstart"),this._moved=!0,Wt(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Wt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(l),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),ie(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){Te(document.body,"leaflet-dragging"),this._lastTarget&&(Te(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),Ge(document,"mousemove touchmove",this._onMove,this),Ge(document,"mouseup touchend touchcancel",this._onUp,this),Nt(),un();var o=this._moved&&this._moving;this._moving=!1,yi._dragging=!1,o&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function Ls(t,o,l){var h,_=[1,4,2,8],v,S,N,G,ht,St,Gt,re;for(v=0,St=t.length;v<St;v++)t[v]._code=Si(t[v],o);for(N=0;N<4;N++){for(Gt=_[N],h=[],v=0,St=t.length,S=St-1;v<St;S=v++)G=t[v],ht=t[S],G._code&Gt?ht._code&Gt||(re=bo(ht,G,Gt,o,l),re._code=Si(re,o),h.push(re)):(ht._code&Gt&&(re=bo(ht,G,Gt,o,l),re._code=Si(re,o),h.push(re)),h.push(G));t=h}return t}function Cs(t,o){var l,h,_,v,S,N,G,ht,St;if(!t||t.length===0)throw new Error("latlngs not passed");Qn(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var Gt=Q([0,0]),re=U(t),Gn=re.getNorthWest().distanceTo(re.getSouthWest())*re.getNorthEast().distanceTo(re.getNorthWest());Gn<1700&&(Gt=Yo(t));var On=t.length,$n=[];for(l=0;l<On;l++){var Xn=Q(t[l]);$n.push(o.project(Q([Xn.lat-Gt.lat,Xn.lng-Gt.lng])))}for(N=G=ht=0,l=0,h=On-1;l<On;h=l++)_=$n[l],v=$n[h],S=_.y*v.x-v.y*_.x,G+=(_.x+v.x)*S,ht+=(_.y+v.y)*S,N+=S*3;N===0?St=$n[0]:St=[G/N,ht/N];var Ri=o.unproject(tt(St));return Q([Ri.lat+Gt.lat,Ri.lng+Gt.lng])}function Yo(t){for(var o=0,l=0,h=0,_=0;_<t.length;_++){var v=Q(t[_]);o+=v.lat,l+=v.lng,h++}return Q([o/h,l/h])}var Aa={__proto__:null,clipPolygon:Ls,polygonCenter:Cs,centroid:Yo};function Ss(t,o){if(!o||!t.length)return t.slice();var l=o*o;return t=Ia(t,l),t=Na(t,l),t}function Ms(t,o,l){return Math.sqrt($i(t,o,l,!0))}function za(t,o,l){return $i(t,o,l)}function Na(t,o){var l=t.length,h=typeof Uint8Array<"u"?Uint8Array:Array,_=new h(l);_[0]=_[l-1]=1,qo(t,_,o,0,l-1);var v,S=[];for(v=0;v<l;v++)_[v]&&S.push(t[v]);return S}function qo(t,o,l,h,_){var v=0,S,N,G;for(N=h+1;N<=_-1;N++)G=$i(t[N],t[h],t[_],!0),G>v&&(S=N,v=G);v>l&&(o[S]=1,qo(t,o,l,h,S),qo(t,o,l,S,_))}function Ia(t,o){for(var l=[t[0]],h=1,_=0,v=t.length;h<v;h++)Oa(t[h],t[_])>o&&(l.push(t[h]),_=h);return _<v-1&&l.push(t[v-1]),l}var Ts;function Es(t,o,l,h,_){var v=h?Ts:Si(t,l),S=Si(o,l),N,G,ht;for(Ts=S;;){if(!(v|S))return[t,o];if(v&S)return!1;N=v||S,G=bo(t,o,N,l,_),ht=Si(G,l),N===v?(t=G,v=ht):(o=G,S=ht)}}function bo(t,o,l,h,_){var v=o.x-t.x,S=o.y-t.y,N=h.min,G=h.max,ht,St;return l&8?(ht=t.x+v*(G.y-t.y)/S,St=G.y):l&4?(ht=t.x+v*(N.y-t.y)/S,St=N.y):l&2?(ht=G.x,St=t.y+S*(G.x-t.x)/v):l&1&&(ht=N.x,St=t.y+S*(N.x-t.x)/v),new R(ht,St,_)}function Si(t,o){var l=0;return t.x<o.min.x?l|=1:t.x>o.max.x&&(l|=2),t.y<o.min.y?l|=4:t.y>o.max.y&&(l|=8),l}function Oa(t,o){var l=o.x-t.x,h=o.y-t.y;return l*l+h*h}function $i(t,o,l,h){var _=o.x,v=o.y,S=l.x-_,N=l.y-v,G=S*S+N*N,ht;return G>0&&(ht=((t.x-_)*S+(t.y-v)*N)/G,ht>1?(_=l.x,v=l.y):ht>0&&(_+=S*ht,v+=N*ht)),S=t.x-_,N=t.y-v,h?S*S+N*N:new R(_,v)}function Qn(t){return!I(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function As(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Qn(t)}function zs(t,o){var l,h,_,v,S,N,G,ht;if(!t||t.length===0)throw new Error("latlngs not passed");Qn(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var St=Q([0,0]),Gt=U(t),re=Gt.getNorthWest().distanceTo(Gt.getSouthWest())*Gt.getNorthEast().distanceTo(Gt.getNorthWest());re<1700&&(St=Yo(t));var Gn=t.length,On=[];for(l=0;l<Gn;l++){var $n=Q(t[l]);On.push(o.project(Q([$n.lat-St.lat,$n.lng-St.lng])))}for(l=0,h=0;l<Gn-1;l++)h+=On[l].distanceTo(On[l+1])/2;if(h===0)ht=On[0];else for(l=0,v=0;l<Gn-1;l++)if(S=On[l],N=On[l+1],_=S.distanceTo(N),v+=_,v>h){G=(v-h)/_,ht=[N.x-G*(N.x-S.x),N.y-G*(N.y-S.y)];break}var Xn=o.unproject(tt(ht));return Q([Xn.lat+St.lat,Xn.lng+St.lng])}var Ba={__proto__:null,simplify:Ss,pointToSegmentDistance:Ms,closestPointOnSegment:za,clipSegment:Es,_getEdgeIntersection:bo,_getBitCode:Si,_sqClosestPointOnSegment:$i,isFlat:Qn,_flat:As,polylineCenter:zs},Ko={project:function(t){return new R(t.lng,t.lat)},unproject:function(t){return new ot(t.y,t.x)},bounds:new Pt([-180,-90],[180,90])},Jo={R:6378137,R_MINOR:6356752314245179e-9,bounds:new Pt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var o=Math.PI/180,l=this.R,h=t.lat*o,_=this.R_MINOR/l,v=Math.sqrt(1-_*_),S=v*Math.sin(h),N=Math.tan(Math.PI/4-h/2)/Math.pow((1-S)/(1+S),v/2);return h=-l*Math.log(Math.max(N,1e-10)),new R(t.lng*o*l,h)},unproject:function(t){for(var o=180/Math.PI,l=this.R,h=this.R_MINOR/l,_=Math.sqrt(1-h*h),v=Math.exp(-t.y/l),S=Math.PI/2-2*Math.atan(v),N=0,G=.1,ht;N<15&&Math.abs(G)>1e-7;N++)ht=_*Math.sin(S),ht=Math.pow((1-ht)/(1+ht),_/2),G=Math.PI/2-2*Math.atan(v*ht)-S,S+=G;return new ot(S*o,t.x*o/l)}},Za={__proto__:null,LonLat:Ko,Mercator:Jo,SphericalMercator:ft},Da=r({},Tt,{code:"EPSG:3395",projection:Jo,transformation:function(){var t=.5/(Math.PI*Jo.R);return Dt(t,.5,-t,.5)}()}),Ns=r({},Tt,{code:"EPSG:4326",projection:Ko,transformation:Dt(1/180,1,-1/180,.5)}),Ra=r({},et,{projection:Ko,transformation:Dt(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,o){var l=o.lng-t.lng,h=o.lat-t.lat;return Math.sqrt(l*l+h*h)},infinite:!0});et.Earth=Tt,et.EPSG3395=Da,et.EPSG3857=Zt,et.EPSG900913=$t,et.EPSG4326=Ns,et.Simple=Ra;var oi=F.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[f(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[f(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var o=t.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var l=this.getEvents();o.on(l,this),this.once("remove",function(){o.off(l,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});x.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var o=f(t);return this._layers[o]?this:(this._layers[o]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var o=f(t);return this._layers[o]?(this._loaded&&t.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return f(t)in this._layers},eachLayer:function(t,o){for(var l in this._layers)t.call(o,this._layers[l]);return this},_addLayers:function(t){t=t?I(t)?t:[t]:[];for(var o=0,l=t.length;o<l;o++)this.addLayer(t[o])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[f(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var o=f(t);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,o=-1/0,l=this._getZoomSpan();for(var h in this._zoomBoundLayers){var _=this._zoomBoundLayers[h].options;t=_.minZoom===void 0?t:Math.min(t,_.minZoom),o=_.maxZoom===void 0?o:Math.max(o,_.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=t===1/0?void 0:t,l!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ii=oi.extend({initialize:function(t,o){C(this,o),this._layers={};var l,h;if(t)for(l=0,h=t.length;l<h;l++)this.addLayer(t[l])},addLayer:function(t){var o=this.getLayerId(t);return this._layers[o]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var o=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(t){var o=typeof t=="number"?t:this.getLayerId(t);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var o=Array.prototype.slice.call(arguments,1),l,h;for(l in this._layers)h=this._layers[l],h[t]&&h[t].apply(h,o);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,o){for(var l in this._layers)t.call(o,this._layers[l]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return f(t)}}),xa=function(t,o){return new Ii(t,o)},di=Ii.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Ii.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Ii.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new vt;for(var o in this._layers){var l=this._layers[o];t.extend(l.getBounds?l.getBounds():l.getLatLng())}return t}}),Wa=function(t,o){return new di(t,o)},Oi=V.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){C(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,o){var l=this._getIconUrl(t);if(!l){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var h=this._createImg(l,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(h,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),h},_setIconStyles:function(t,o){var l=this.options,h=l[o+"Size"];typeof h=="number"&&(h=[h,h]);var _=tt(h),v=tt(o==="shadow"&&l.shadowAnchor||l.iconAnchor||_&&_.divideBy(2,!0));t.className="leaflet-marker-"+o+" "+(l.className||""),v&&(t.style.marginLeft=-v.x+"px",t.style.marginTop=-v.y+"px"),_&&(t.style.width=_.x+"px",t.style.height=_.y+"px")},_createImg:function(t,o){return o=o||document.createElement("img"),o.src=t,o},_getIconUrl:function(t){return Lt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function Ha(t){return new Oi(t)}var to=Oi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof to.imagePath!="string"&&(to.imagePath=this._detectIconPath()),(this.options.imagePath||to.imagePath)+Oi.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var o=function(l,h,_){var v=h.exec(l);return v&&v[_]};return t=o(t,/^url\((['"])?(.+)\1\)$/,2),t&&o(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=xt("div","leaflet-default-icon-path",document.body),o=pt(t,"background-image")||pt(t,"backgroundImage");if(document.body.removeChild(t),o=this._stripUrl(o),o)return o;var l=document.querySelector('link[href$="leaflet.css"]');return l?l.href.substring(0,l.href.length-11-1):""}}),Is=li.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new yi(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Wt(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&Te(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var o=this._marker,l=o._map,h=this._marker.options.autoPanSpeed,_=this._marker.options.autoPanPadding,v=Qe(o._icon),S=l.getPixelBounds(),N=l.getPixelOrigin(),G=Mt(S.min._subtract(N).add(_),S.max._subtract(N).subtract(_));if(!G.contains(v)){var ht=tt((Math.max(G.max.x,v.x)-G.max.x)/(S.max.x-G.max.x)-(Math.min(G.min.x,v.x)-G.min.x)/(S.min.x-G.min.x),(Math.max(G.max.y,v.y)-G.max.y)/(S.max.y-G.max.y)-(Math.min(G.min.y,v.y)-G.min.y)/(S.min.y-G.min.y)).multiplyBy(h);l.panBy(ht,{animate:!1}),this._draggable._newPos._add(ht),this._draggable._startPos._add(ht),ie(o._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=ut(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(O(this._panRequest),this._panRequest=ut(this._adjustPan.bind(this,t)))},_onDrag:function(t){var o=this._marker,l=o._shadow,h=Qe(o._icon),_=o._map.layerPointToLatLng(h);l&&ie(l,h),o._latlng=_,t.latlng=_,t.oldLatLng=this._oldLatLng,o.fire("move",t).fire("drag",t)},_onDragEnd:function(t){O(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),wo=oi.extend({options:{icon:new to,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,o){C(this,o),this._latlng=Q(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var o=this._latlng;return this._latlng=Q(t),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),l=t.icon.createIcon(this._icon),h=!1;l!==this._icon&&(this._icon&&this._removeIcon(),h=!0,t.title&&(l.title=t.title),l.tagName==="IMG"&&(l.alt=t.alt||"")),Wt(l,o),t.keyboard&&(l.tabIndex="0",l.setAttribute("role","button")),this._icon=l,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&qt(l,"focus",this._panOnFocus,this);var _=t.icon.createShadow(this._shadow),v=!1;_!==this._shadow&&(this._removeShadow(),v=!0),_&&(Wt(_,o),_.alt=""),this._shadow=_,t.opacity<1&&this._updateOpacity(),h&&this.getPane().appendChild(this._icon),this._initInteraction(),_&&v&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ge(this._icon,"focus",this._panOnFocus,this),ne(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ne(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&ie(this._icon,t),this._shadow&&ie(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(Wt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Is)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Is(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&Pn(this._icon,t),this._shadow&&Pn(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var o=this.options.icon.options,l=o.iconSize?tt(o.iconSize):tt(0,0),h=o.iconAnchor?tt(o.iconAnchor):tt(0,0);t.panInside(this._latlng,{paddingTopLeft:h,paddingBottomRight:l.subtract(h)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Fa(t,o){return new wo(t,o)}var bi=oi.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return C(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),ko=bi.extend({options:{fill:!0,radius:10},initialize:function(t,o){C(this,o),this._latlng=Q(t),this._radius=this.options.radius},setLatLng:function(t){var o=this._latlng;return this._latlng=Q(t),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var o=t&&t.radius||this._radius;return bi.prototype.setStyle.call(this,t),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,o=this._radiusY||t,l=this._clickTolerance(),h=[t+l,o+l];this._pxBounds=new Pt(this._point.subtract(h),this._point.add(h))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ga(t,o){return new ko(t,o)}var Qo=ko.extend({initialize:function(t,o,l){if(typeof o=="number"&&(o=r({},l,{radius:o})),C(this,o),this._latlng=Q(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new vt(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:bi.prototype.setStyle,_project:function(){var t=this._latlng.lng,o=this._latlng.lat,l=this._map,h=l.options.crs;if(h.distance===Tt.distance){var _=Math.PI/180,v=this._mRadius/Tt.R/_,S=l.project([o+v,t]),N=l.project([o-v,t]),G=S.add(N).divideBy(2),ht=l.unproject(G).lat,St=Math.acos((Math.cos(v*_)-Math.sin(o*_)*Math.sin(ht*_))/(Math.cos(o*_)*Math.cos(ht*_)))/_;(isNaN(St)||St===0)&&(St=v/Math.cos(Math.PI/180*o)),this._point=G.subtract(l.getPixelOrigin()),this._radius=isNaN(St)?0:G.x-l.project([ht,t-St]).x,this._radiusY=G.y-S.y}else{var Gt=h.unproject(h.project(this._latlng).subtract([this._mRadius,0]));this._point=l.latLngToLayerPoint(this._latlng),this._radius=this._point.x-l.latLngToLayerPoint(Gt).x}this._updateBounds()}});function ja(t,o,l){return new Qo(t,o,l)}var _i=bi.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,o){C(this,o),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var o=1/0,l=null,h=$i,_,v,S=0,N=this._parts.length;S<N;S++)for(var G=this._parts[S],ht=1,St=G.length;ht<St;ht++){_=G[ht-1],v=G[ht];var Gt=h(t,_,v,!0);Gt<o&&(o=Gt,l=h(t,_,v))}return l&&(l.distance=Math.sqrt(o)),l},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return zs(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,o){return o=o||this._defaultShape(),t=Q(t),o.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new vt,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return Qn(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var o=[],l=Qn(t),h=0,_=t.length;h<_;h++)l?(o[h]=Q(t[h]),this._bounds.extend(o[h])):o[h]=this._convertLatLngs(t[h]);return o},_project:function(){var t=new Pt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),o=new R(t,t);this._rawPxBounds&&(this._pxBounds=new Pt([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(t,o,l){var h=t[0]instanceof ot,_=t.length,v,S;if(h){for(S=[],v=0;v<_;v++)S[v]=this._map.latLngToLayerPoint(t[v]),l.extend(S[v]);o.push(S)}else for(v=0;v<_;v++)this._projectLatlngs(t[v],o,l)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,l,h,_,v,S,N,G;for(l=0,_=0,v=this._rings.length;l<v;l++)for(G=this._rings[l],h=0,S=G.length;h<S-1;h++)N=Es(G[h],G[h+1],t,h,!0),N&&(o[_]=o[_]||[],o[_].push(N[0]),(N[1]!==G[h+1]||h===S-2)&&(o[_].push(N[1]),_++))}},_simplifyPoints:function(){for(var t=this._parts,o=this.options.smoothFactor,l=0,h=t.length;l<h;l++)t[l]=Ss(t[l],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,o){var l,h,_,v,S,N,G=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(l=0,v=this._parts.length;l<v;l++)for(N=this._parts[l],h=0,S=N.length,_=S-1;h<S;_=h++)if(!(!o&&h===0)&&Ms(t,N[_],N[h])<=G)return!0;return!1}});function Ua(t,o){return new _i(t,o)}_i._flat=As;var Bi=_i.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Cs(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var o=_i.prototype._convertLatLngs.call(this,t),l=o.length;return l>=2&&o[0]instanceof ot&&o[0].equals(o[l-1])&&o.pop(),o},_setLatLngs:function(t){_i.prototype._setLatLngs.call(this,t),Qn(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Qn(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,o=this.options.weight,l=new R(o,o);if(t=new Pt(t.min.subtract(l),t.max.add(l)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var h=0,_=this._rings.length,v;h<_;h++)v=Ls(this._rings[h],t,!0),v.length&&this._parts.push(v)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var o=!1,l,h,_,v,S,N,G,ht;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(v=0,G=this._parts.length;v<G;v++)for(l=this._parts[v],S=0,ht=l.length,N=ht-1;S<ht;N=S++)h=l[S],_=l[N],h.y>t.y!=_.y>t.y&&t.x<(_.x-h.x)*(t.y-h.y)/(_.y-h.y)+h.x&&(o=!o);return o||_i.prototype._containsPoint.call(this,t,!0)}});function Xa(t,o){return new Bi(t,o)}var mi=di.extend({initialize:function(t,o){C(this,o),this._layers={},t&&this.addData(t)},addData:function(t){var o=I(t)?t:t.features,l,h,_;if(o){for(l=0,h=o.length;l<h;l++)_=o[l],(_.geometries||_.geometry||_.features||_.coordinates)&&this.addData(_);return this}var v=this.options;if(v.filter&&!v.filter(t))return this;var S=Po(t,v);return S?(S.feature=So(t),S.defaultOptions=S.options,this.resetStyle(S),v.onEachFeature&&v.onEachFeature(t,S),this.addLayer(S)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=r({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(o){this._setLayerStyle(o,t)},this)},_setLayerStyle:function(t,o){t.setStyle&&(typeof o=="function"&&(o=o(t.feature)),t.setStyle(o))}});function Po(t,o){var l=t.type==="Feature"?t.geometry:t,h=l?l.coordinates:null,_=[],v=o&&o.pointToLayer,S=o&&o.coordsToLatLng||$o,N,G,ht,St;if(!h&&!l)return null;switch(l.type){case"Point":return N=S(h),Os(v,t,N,o);case"MultiPoint":for(ht=0,St=h.length;ht<St;ht++)N=S(h[ht]),_.push(Os(v,t,N,o));return new di(_);case"LineString":case"MultiLineString":return G=Lo(h,l.type==="LineString"?0:1,S),new _i(G,o);case"Polygon":case"MultiPolygon":return G=Lo(h,l.type==="Polygon"?1:2,S),new Bi(G,o);case"GeometryCollection":for(ht=0,St=l.geometries.length;ht<St;ht++){var Gt=Po({geometry:l.geometries[ht],type:"Feature",properties:t.properties},o);Gt&&_.push(Gt)}return new di(_);case"FeatureCollection":for(ht=0,St=l.features.length;ht<St;ht++){var re=Po(l.features[ht],o);re&&_.push(re)}return new di(_);default:throw new Error("Invalid GeoJSON object.")}}function Os(t,o,l,h){return t?t(o,l):new wo(l,h&&h.markersInheritOptions&&h)}function $o(t){return new ot(t[1],t[0],t[2])}function Lo(t,o,l){for(var h=[],_=0,v=t.length,S;_<v;_++)S=o?Lo(t[_],o-1,l):(l||$o)(t[_]),h.push(S);return h}function ts(t,o){return t=Q(t),t.alt!==void 0?[w(t.lng,o),w(t.lat,o),w(t.alt,o)]:[w(t.lng,o),w(t.lat,o)]}function Co(t,o,l,h){for(var _=[],v=0,S=t.length;v<S;v++)_.push(o?Co(t[v],Qn(t[v])?0:o-1,l,h):ts(t[v],h));return!o&&l&&_.length>0&&_.push(_[0].slice()),_}function Zi(t,o){return t.feature?r({},t.feature,{geometry:o}):So(o)}function So(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var es={toGeoJSON:function(t){return Zi(this,{type:"Point",coordinates:ts(this.getLatLng(),t)})}};wo.include(es),Qo.include(es),ko.include(es),_i.include({toGeoJSON:function(t){var o=!Qn(this._latlngs),l=Co(this._latlngs,o?1:0,!1,t);return Zi(this,{type:(o?"Multi":"")+"LineString",coordinates:l})}}),Bi.include({toGeoJSON:function(t){var o=!Qn(this._latlngs),l=o&&!Qn(this._latlngs[0]),h=Co(this._latlngs,l?2:o?1:0,!0,t);return o||(h=[h]),Zi(this,{type:(l?"Multi":"")+"Polygon",coordinates:h})}}),Ii.include({toMultiPoint:function(t){var o=[];return this.eachLayer(function(l){o.push(l.toGeoJSON(t).geometry.coordinates)}),Zi(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(t){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(t);var l=o==="GeometryCollection",h=[];return this.eachLayer(function(_){if(_.toGeoJSON){var v=_.toGeoJSON(t);if(l)h.push(v.geometry);else{var S=So(v);S.type==="FeatureCollection"?h.push.apply(h,S.features):h.push(S)}}}),l?Zi(this,{geometries:h,type:"GeometryCollection"}):{type:"FeatureCollection",features:h}}});function Bs(t,o){return new mi(t,o)}var Va=Bs,Mo=oi.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,o,l){this._url=t,this._bounds=U(o),C(this,l)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Wt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ne(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&xe(this._image),this},bringToBack:function(){return this._map&&rn(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=U(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",o=this._image=t?this._url:xt("img");if(Wt(o,"leaflet-image-layer"),this._zoomAnimated&&Wt(o,"leaflet-zoom-animated"),this.options.className&&Wt(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onload=u(this.fire,this,"load"),o.onerror=u(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(t){var o=this._map.getZoomScale(t.zoom),l=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;Ye(this._image,l,o)},_reset:function(){var t=this._image,o=new Pt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),l=o.getSize();ie(t,o.min),t.style.width=l.x+"px",t.style.height=l.y+"px"},_updateOpacity:function(){Pn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Ya=function(t,o,l){return new Mo(t,o,l)},Zs=Mo.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",o=this._image=t?this._url:xt("video");if(Wt(o,"leaflet-image-layer"),this._zoomAnimated&&Wt(o,"leaflet-zoom-animated"),this.options.className&&Wt(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onloadeddata=u(this.fire,this,"load"),t){for(var l=o.getElementsByTagName("source"),h=[],_=0;_<l.length;_++)h.push(l[_].src);this._url=l.length>0?h:[o.src];return}I(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var v=0;v<this._url.length;v++){var S=xt("source");S.src=this._url[v],o.appendChild(S)}}});function qa(t,o,l){return new Zs(t,o,l)}var Ds=Mo.extend({_initImage:function(){var t=this._image=this._url;Wt(t,"leaflet-image-layer"),this._zoomAnimated&&Wt(t,"leaflet-zoom-animated"),this.options.className&&Wt(t,this.options.className),t.onselectstart=g,t.onmousemove=g}});function Ka(t,o,l){return new Ds(t,o,l)}var ai=oi.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,o){t&&(t instanceof ot||I(t))?(this._latlng=Q(t),C(this,o)):(C(this,t),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&Pn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&Pn(this._container,1),this.bringToFront(),this.options.interactive&&(Wt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(Pn(this._container,0),this._removeTimeout=setTimeout(u(ne,void 0,this._container),200)):ne(this._container),this.options.interactive&&(Te(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=Q(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&xe(this._container),this},bringToBack:function(){return this._map&&rn(this._container),this},_prepareOpen:function(t){var o=this._source;if(!o._map)return!1;if(o instanceof di){o=null;var l=this._source._layers;for(var h in l)if(l[h]._map){o=l[h];break}if(!o)return!1;this._source=o}if(!t)if(o.getCenter)t=o.getCenter();else if(o.getLatLng)t=o.getLatLng();else if(o.getBounds)t=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")t.innerHTML=o;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),o=tt(this.options.offset),l=this._getAnchor();this._zoomAnimated?ie(this._container,t.add(l)):o=o.add(t).add(l);var h=this._containerBottom=-o.y,_=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=h+"px",this._container.style.left=_+"px"}},_getAnchor:function(){return[0,0]}});x.include({_initOverlay:function(t,o,l,h){var _=o;return _ instanceof t||(_=new t(h).setContent(o)),l&&_.setLatLng(l),_}}),oi.include({_initOverlay:function(t,o,l,h){var _=l;return _ instanceof t?(C(_,h),_._source=this):(_=o&&!h?o:new t(h,this),_.setContent(l)),_}});var To=ai.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,ai.prototype.openOn.call(this,t)},onAdd:function(t){ai.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof bi||this._source.on("preclick",hi))},onRemove:function(t){ai.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof bi||this._source.off("preclick",hi))},getEvents:function(){var t=ai.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",o=this._container=xt("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),l=this._wrapper=xt("div",t+"-content-wrapper",o);if(this._contentNode=xt("div",t+"-content",l),Li(o),Ki(this._contentNode),qt(o,"contextmenu",hi),this._tipContainer=xt("div",t+"-tip-container",o),this._tip=xt("div",t+"-tip",this._tipContainer),this.options.closeButton){var h=this._closeButton=xt("a",t+"-close-button",o);h.setAttribute("role","button"),h.setAttribute("aria-label","Close popup"),h.href="#close",h.innerHTML='<span aria-hidden="true">&#215;</span>',qt(h,"click",function(_){An(_),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,o=t.style;o.width="",o.whiteSpace="nowrap";var l=t.offsetWidth;l=Math.min(l,this.options.maxWidth),l=Math.max(l,this.options.minWidth),o.width=l+1+"px",o.whiteSpace="",o.height="";var h=t.offsetHeight,_=this.options.maxHeight,v="leaflet-popup-scrolled";_&&h>_?(o.height=_+"px",Wt(t,v)):Te(t,v),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),l=this._getAnchor();ie(this._container,o.add(l))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,o=parseInt(pt(this._container,"marginBottom"),10)||0,l=this._container.offsetHeight+o,h=this._containerWidth,_=new R(this._containerLeft,-l-this._containerBottom);_._add(Qe(this._container));var v=t.layerPointToContainerPoint(_),S=tt(this.options.autoPanPadding),N=tt(this.options.autoPanPaddingTopLeft||S),G=tt(this.options.autoPanPaddingBottomRight||S),ht=t.getSize(),St=0,Gt=0;v.x+h+G.x>ht.x&&(St=v.x+h-ht.x+G.x),v.x-St-N.x<0&&(St=v.x-N.x),v.y+l+G.y>ht.y&&(Gt=v.y+l-ht.y+G.y),v.y-Gt-N.y<0&&(Gt=v.y-N.y),(St||Gt)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([St,Gt]))}},_getAnchor:function(){return tt(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Ja=function(t,o){return new To(t,o)};x.mergeOptions({closePopupOnClick:!0}),x.include({openPopup:function(t,o,l){return this._initOverlay(To,t,o,l).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),oi.include({bindPopup:function(t,o){return this._popup=this._initOverlay(To,this._popup,t,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof di||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){fi(t);var o=t.layer||t.target;if(this._popup._source===o&&!(o instanceof bi)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=o,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var Eo=ai.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){ai.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){ai.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=ai.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",o=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=xt("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var o,l,h=this._map,_=this._container,v=h.latLngToContainerPoint(h.getCenter()),S=h.layerPointToContainerPoint(t),N=this.options.direction,G=_.offsetWidth,ht=_.offsetHeight,St=tt(this.options.offset),Gt=this._getAnchor();N==="top"?(o=G/2,l=ht):N==="bottom"?(o=G/2,l=0):N==="center"?(o=G/2,l=ht/2):N==="right"?(o=0,l=ht/2):N==="left"?(o=G,l=ht/2):S.x<v.x?(N="right",o=0,l=ht/2):(N="left",o=G+(St.x+Gt.x)*2,l=ht/2),t=t.subtract(tt(o,l,!0)).add(St).add(Gt),Te(_,"leaflet-tooltip-right"),Te(_,"leaflet-tooltip-left"),Te(_,"leaflet-tooltip-top"),Te(_,"leaflet-tooltip-bottom"),Wt(_,"leaflet-tooltip-"+N),ie(_,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&Pn(this._container,t)},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(o)},_getAnchor:function(){return tt(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Qa=function(t,o){return new Eo(t,o)};x.include({openTooltip:function(t,o,l){return this._initOverlay(Eo,t,o,l).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),oi.include({bindTooltip:function(t,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Eo,this._tooltip,t,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var o=t?"off":"on",l={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?l.add=this._openTooltip:(l.mouseover=this._openTooltip,l.mouseout=this.closeTooltip,l.click=this._openTooltip,this._map?this._addFocusListeners():l.add=this._addFocusListeners),this._tooltip.options.sticky&&(l.mousemove=this._moveTooltip),this[o](l),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof di||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var o=typeof t.getElement=="function"&&t.getElement();o&&(qt(o,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),qt(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var o=typeof t.getElement=="function"&&t.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var o=t.latlng,l,h;this._tooltip.options.sticky&&t.originalEvent&&(l=this._map.mouseEventToContainerPoint(t.originalEvent),h=this._map.containerPointToLayerPoint(l),o=this._map.layerPointToLatLng(h)),this._tooltip.setLatLng(o)}});var Rs=Oi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var o=t&&t.tagName==="DIV"?t:document.createElement("div"),l=this.options;if(l.html instanceof Element?(vn(o),o.appendChild(l.html)):o.innerHTML=l.html!==!1?l.html:"",l.bgPos){var h=tt(l.bgPos);o.style.backgroundPosition=-h.x+"px "+-h.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function $a(t){return new Rs(t)}Oi.Default=to;var eo=oi.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Lt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){C(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ne(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(xe(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(rn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof R?t:new R(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var o=this.getPane().children,l=-t(-1/0,1/0),h=0,_=o.length,v;h<_;h++)v=o[h].style.zIndex,o[h]!==this._container&&v&&(l=t(l,+v));isFinite(l)&&(this.options.zIndex=l+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Lt.ielt9){Pn(this._container,this.options.opacity);var t=+new Date,o=!1,l=!1;for(var h in this._tiles){var _=this._tiles[h];if(!(!_.current||!_.loaded)){var v=Math.min(1,(t-_.loaded)/200);Pn(_.el,v),v<1?o=!0:(_.active?l=!0:this._onOpaqueTile(_),_.active=!0)}}l&&!this._noPrune&&this._pruneTiles(),o&&(O(this._fadeFrame),this._fadeFrame=ut(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=xt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,o=this.options.maxZoom;if(t!==void 0){for(var l in this._levels)l=Number(l),this._levels[l].el.children.length||l===t?(this._levels[l].el.style.zIndex=o-Math.abs(t-l),this._onUpdateLevel(l)):(ne(this._levels[l].el),this._removeTilesAtZoom(l),this._onRemoveLevel(l),delete this._levels[l]);var h=this._levels[t],_=this._map;return h||(h=this._levels[t]={},h.el=xt("div","leaflet-tile-container leaflet-zoom-animated",this._container),h.el.style.zIndex=o,h.origin=_.project(_.unproject(_.getPixelOrigin()),t).round(),h.zoom=t,this._setZoomTransform(h,_.getCenter(),_.getZoom()),g(h.el.offsetWidth),this._onCreateLevel(h)),this._level=h,h}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var t,o,l=this._map.getZoom();if(l>this.options.maxZoom||l<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)o=this._tiles[t],o.retain=o.current;for(t in this._tiles)if(o=this._tiles[t],o.current&&!o.active){var h=o.coords;this._retainParent(h.x,h.y,h.z,h.z-5)||this._retainChildren(h.x,h.y,h.z,h.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var o in this._tiles)this._tiles[o].coords.z===t&&this._removeTile(o)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ne(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,o,l,h){var _=Math.floor(t/2),v=Math.floor(o/2),S=l-1,N=new R(+_,+v);N.z=+S;var G=this._tileCoordsToKey(N),ht=this._tiles[G];return ht&&ht.active?(ht.retain=!0,!0):(ht&&ht.loaded&&(ht.retain=!0),S>h?this._retainParent(_,v,S,h):!1)},_retainChildren:function(t,o,l,h){for(var _=2*t;_<2*t+2;_++)for(var v=2*o;v<2*o+2;v++){var S=new R(_,v);S.z=l+1;var N=this._tileCoordsToKey(S),G=this._tiles[N];if(G&&G.active){G.retain=!0;continue}else G&&G.loaded&&(G.retain=!0);l+1<h&&this._retainChildren(_,v,l+1,h)}},_resetView:function(t){var o=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var o=this.options;return o.minNativeZoom!==void 0&&t<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<t?o.maxNativeZoom:t},_setView:function(t,o,l,h){var _=Math.round(o);this.options.maxZoom!==void 0&&_>this.options.maxZoom||this.options.minZoom!==void 0&&_<this.options.minZoom?_=void 0:_=this._clampZoom(_);var v=this.options.updateWhenZooming&&_!==this._tileZoom;(!h||v)&&(this._tileZoom=_,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),_!==void 0&&this._update(t),l||this._pruneTiles(),this._noPrune=!!l),this._setZoomTransforms(t,o)},_setZoomTransforms:function(t,o){for(var l in this._levels)this._setZoomTransform(this._levels[l],t,o)},_setZoomTransform:function(t,o,l){var h=this._map.getZoomScale(l,t.zoom),_=t.origin.multiplyBy(h).subtract(this._map._getNewPixelOrigin(o,l)).round();Lt.any3d?Ye(t.el,_,h):ie(t.el,_)},_resetGrid:function(){var t=this._map,o=t.options.crs,l=this._tileSize=this.getTileSize(),h=this._tileZoom,_=this._map.getPixelWorldBounds(this._tileZoom);_&&(this._globalTileRange=this._pxBoundsToTileRange(_)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,o.wrapLng[0]],h).x/l.x),Math.ceil(t.project([0,o.wrapLng[1]],h).x/l.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([o.wrapLat[0],0],h).y/l.x),Math.ceil(t.project([o.wrapLat[1],0],h).y/l.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var o=this._map,l=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),h=o.getZoomScale(l,this._tileZoom),_=o.project(t,this._tileZoom).floor(),v=o.getSize().divideBy(h*2);return new Pt(_.subtract(v),_.add(v))},_update:function(t){var o=this._map;if(o){var l=this._clampZoom(o.getZoom());if(t===void 0&&(t=o.getCenter()),this._tileZoom!==void 0){var h=this._getTiledPixelBounds(t),_=this._pxBoundsToTileRange(h),v=_.getCenter(),S=[],N=this.options.keepBuffer,G=new Pt(_.getBottomLeft().subtract([N,-N]),_.getTopRight().add([N,-N]));if(!(isFinite(_.min.x)&&isFinite(_.min.y)&&isFinite(_.max.x)&&isFinite(_.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ht in this._tiles){var St=this._tiles[ht].coords;(St.z!==this._tileZoom||!G.contains(new R(St.x,St.y)))&&(this._tiles[ht].current=!1)}if(Math.abs(l-this._tileZoom)>1){this._setView(t,l);return}for(var Gt=_.min.y;Gt<=_.max.y;Gt++)for(var re=_.min.x;re<=_.max.x;re++){var Gn=new R(re,Gt);if(Gn.z=this._tileZoom,!!this._isValidTile(Gn)){var On=this._tiles[this._tileCoordsToKey(Gn)];On?On.current=!0:S.push(Gn)}}if(S.sort(function(Xn,Ri){return Xn.distanceTo(v)-Ri.distanceTo(v)}),S.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var $n=document.createDocumentFragment();for(re=0;re<S.length;re++)this._addTile(S[re],$n);this._level.el.appendChild($n)}}}},_isValidTile:function(t){var o=this._map.options.crs;if(!o.infinite){var l=this._globalTileRange;if(!o.wrapLng&&(t.x<l.min.x||t.x>l.max.x)||!o.wrapLat&&(t.y<l.min.y||t.y>l.max.y))return!1}if(!this.options.bounds)return!0;var h=this._tileCoordsToBounds(t);return U(this.options.bounds).overlaps(h)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var o=this._map,l=this.getTileSize(),h=t.scaleBy(l),_=h.add(l),v=o.unproject(h,t.z),S=o.unproject(_,t.z);return[v,S]},_tileCoordsToBounds:function(t){var o=this._tileCoordsToNwSe(t),l=new vt(o[0],o[1]);return this.options.noWrap||(l=this._map.wrapLatLngBounds(l)),l},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var o=t.split(":"),l=new R(+o[0],+o[1]);return l.z=+o[2],l},_removeTile:function(t){var o=this._tiles[t];o&&(ne(o.el),delete this._tiles[t],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){Wt(t,"leaflet-tile");var o=this.getTileSize();t.style.width=o.x+"px",t.style.height=o.y+"px",t.onselectstart=g,t.onmousemove=g,Lt.ielt9&&this.options.opacity<1&&Pn(t,this.options.opacity)},_addTile:function(t,o){var l=this._getTilePos(t),h=this._tileCoordsToKey(t),_=this.createTile(this._wrapCoords(t),u(this._tileReady,this,t));this._initTile(_),this.createTile.length<2&&ut(u(this._tileReady,this,t,null,_)),ie(_,l),this._tiles[h]={el:_,coords:t,current:!0},o.appendChild(_),this.fire("tileloadstart",{tile:_,coords:t})},_tileReady:function(t,o,l){o&&this.fire("tileerror",{error:o,tile:l,coords:t});var h=this._tileCoordsToKey(t);l=this._tiles[h],l&&(l.loaded=+new Date,this._map._fadeAnimated?(Pn(l.el,0),O(this._fadeFrame),this._fadeFrame=ut(this._updateOpacity,this)):(l.active=!0,this._pruneTiles()),o||(Wt(l.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:l.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Lt.ielt9||!this._map._fadeAnimated?ut(this._pruneTiles,this):setTimeout(u(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var o=new R(this._wrapX?p(t.x,this._wrapX):t.x,this._wrapY?p(t.y,this._wrapY):t.y);return o.z=t.z,o},_pxBoundsToTileRange:function(t){var o=this.getTileSize();return new Pt(t.min.unscaleBy(o).floor(),t.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function tu(t){return new eo(t)}var Di=eo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,o){this._url=t,o=C(this,o),o.detectRetina&&Lt.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,o){return this._url===t&&o===void 0&&(o=!0),this._url=t,o||this.redraw(),this},createTile:function(t,o){var l=document.createElement("img");return qt(l,"load",u(this._tileOnLoad,this,o,l)),qt(l,"error",u(this._tileOnError,this,o,l)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(l.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(l.referrerPolicy=this.options.referrerPolicy),l.alt="",l.src=this.getTileUrl(t),l},getTileUrl:function(t){var o={r:Lt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var l=this._globalTileRange.max.y-t.y;this.options.tms&&(o.y=l),o["-y"]=l}return E(this._url,r(o,this.options))},_tileOnLoad:function(t,o){Lt.ielt9?setTimeout(u(t,this,null,o),0):t(null,o)},_tileOnError:function(t,o,l){var h=this.options.errorTileUrl;h&&o.getAttribute("src")!==h&&(o.src=h),t(l,o)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,o=this.options.maxZoom,l=this.options.zoomReverse,h=this.options.zoomOffset;return l&&(t=o-t),t+h},_getSubdomain:function(t){var o=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var t,o;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(o=this._tiles[t].el,o.onload=g,o.onerror=g,!o.complete)){o.src=X;var l=this._tiles[t].coords;ne(o),delete this._tiles[t],this.fire("tileabort",{tile:o,coords:l})}},_removeTile:function(t){var o=this._tiles[t];if(o)return o.el.setAttribute("src",X),eo.prototype._removeTile.call(this,t)},_tileReady:function(t,o,l){if(!(!this._map||l&&l.getAttribute("src")===X))return eo.prototype._tileReady.call(this,t,o,l)}});function xs(t,o){return new Di(t,o)}var Ws=Di.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,o){this._url=t;var l=r({},this.defaultWmsParams);for(var h in o)h in this.options||(l[h]=o[h]);o=C(this,o);var _=o.detectRetina&&Lt.retina?2:1,v=this.getTileSize();l.width=v.x*_,l.height=v.y*_,this.wmsParams=l},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,Di.prototype.onAdd.call(this,t)},getTileUrl:function(t){var o=this._tileCoordsToNwSe(t),l=this._crs,h=Mt(l.project(o[0]),l.project(o[1])),_=h.min,v=h.max,S=(this._wmsVersion>=1.3&&this._crs===Ns?[_.y,_.x,v.y,v.x]:[_.x,_.y,v.x,v.y]).join(","),N=Di.prototype.getTileUrl.call(this,t);return N+A(this.wmsParams,N,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+S},setParams:function(t,o){return r(this.wmsParams,t),o||this.redraw(),this}});function eu(t,o){return new Ws(t,o)}Di.WMS=Ws,xs.wms=eu;var pi=oi.extend({options:{padding:.1},initialize:function(t){C(this,t),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Wt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,o){var l=this._map.getZoomScale(o,this._zoom),h=this._map.getSize().multiplyBy(.5+this.options.padding),_=this._map.project(this._center,o),v=h.multiplyBy(-l).add(_).subtract(this._map._getNewPixelOrigin(t,o));Lt.any3d?Ye(this._container,v,l):ie(this._container,v)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,o=this._map.getSize(),l=this._map.containerPointToLayerPoint(o.multiplyBy(-t)).round();this._bounds=new Pt(l,l.add(o.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Hs=pi.extend({options:{tolerance:0},getEvents:function(){var t=pi.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){pi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");qt(t,"mousemove",this._onMouseMove,this),qt(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),qt(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){O(this._redrawRequest),delete this._ctx,ne(this._container),Ge(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var o in this._layers)t=this._layers[o],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){pi.prototype._update.call(this);var t=this._bounds,o=this._container,l=t.getSize(),h=Lt.retina?2:1;ie(o,t.min),o.width=h*l.x,o.height=h*l.y,o.style.width=l.x+"px",o.style.height=l.y+"px",Lt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){pi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[f(t)]=t;var o=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var o=t._order,l=o.next,h=o.prev;l?l.prev=h:this._drawLast=h,h?h.next=l:this._drawFirst=l,delete t._order,delete this._layers[f(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var o=t.options.dashArray.split(/[, ]+/),l=[],h,_;for(_=0;_<o.length;_++){if(h=Number(o[_]),isNaN(h))return;l.push(h)}t.options._dashArray=l}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||ut(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var o=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new Pt,this._redrawBounds.extend(t._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(t._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var o=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,o=this._redrawBounds;if(this._ctx.save(),o){var l=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,l.x,l.y),this._ctx.clip()}this._drawing=!0;for(var h=this._drawFirst;h;h=h.next)t=h.layer,(!o||t._pxBounds&&t._pxBounds.intersects(o))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,o){if(this._drawing){var l,h,_,v,S=t._parts,N=S.length,G=this._ctx;if(N){for(G.beginPath(),l=0;l<N;l++){for(h=0,_=S[l].length;h<_;h++)v=S[l][h],G[h?"lineTo":"moveTo"](v.x,v.y);o&&G.closePath()}this._fillStroke(G,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var o=t._point,l=this._ctx,h=Math.max(Math.round(t._radius),1),_=(Math.max(Math.round(t._radiusY),1)||h)/h;_!==1&&(l.save(),l.scale(1,_)),l.beginPath(),l.arc(o.x,o.y/_,h,0,Math.PI*2,!1),_!==1&&l.restore(),this._fillStroke(l,t)}},_fillStroke:function(t,o){var l=o.options;l.fill&&(t.globalAlpha=l.fillOpacity,t.fillStyle=l.fillColor||l.color,t.fill(l.fillRule||"evenodd")),l.stroke&&l.weight!==0&&(t.setLineDash&&t.setLineDash(o.options&&o.options._dashArray||[]),t.globalAlpha=l.opacity,t.lineWidth=l.weight,t.strokeStyle=l.color,t.lineCap=l.lineCap,t.lineJoin=l.lineJoin,t.stroke())},_onClick:function(t){for(var o=this._map.mouseEventToLayerPoint(t),l,h,_=this._drawFirst;_;_=_.next)l=_.layer,l.options.interactive&&l._containsPoint(o)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(l))&&(h=l);this._fireEvent(h?[h]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,o)}},_handleMouseOut:function(t){var o=this._hoveredLayer;o&&(Te(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,o){if(!this._mouseHoverThrottled){for(var l,h,_=this._drawFirst;_;_=_.next)l=_.layer,l.options.interactive&&l._containsPoint(o)&&(h=l);h!==this._hoveredLayer&&(this._handleMouseOut(t),h&&(Wt(this._container,"leaflet-interactive"),this._fireEvent([h],t,"mouseover"),this._hoveredLayer=h)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(u(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,o,l){this._map._fireDOMEvent(o,l||o.type,t)},_bringToFront:function(t){var o=t._order;if(o){var l=o.next,h=o.prev;if(l)l.prev=h;else return;h?h.next=l:l&&(this._drawFirst=l),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(t)}},_bringToBack:function(t){var o=t._order;if(o){var l=o.next,h=o.prev;if(h)h.next=l;else return;l?l.prev=h:h&&(this._drawLast=h),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(t)}}});function Fs(t){return Lt.canvas?new Hs(t):null}var no=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),nu={_initContainer:function(){this._container=xt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(pi.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var o=t._container=no("shape");Wt(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",t._path=no("path"),o.appendChild(t._path),this._updateStyle(t),this._layers[f(t)]=t},_addPath:function(t){var o=t._container;this._container.appendChild(o),t.options.interactive&&t.addInteractiveTarget(o)},_removePath:function(t){var o=t._container;ne(o),t.removeInteractiveTarget(o),delete this._layers[f(t)]},_updateStyle:function(t){var o=t._stroke,l=t._fill,h=t.options,_=t._container;_.stroked=!!h.stroke,_.filled=!!h.fill,h.stroke?(o||(o=t._stroke=no("stroke")),_.appendChild(o),o.weight=h.weight+"px",o.color=h.color,o.opacity=h.opacity,h.dashArray?o.dashStyle=I(h.dashArray)?h.dashArray.join(" "):h.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=h.lineCap.replace("butt","flat"),o.joinstyle=h.lineJoin):o&&(_.removeChild(o),t._stroke=null),h.fill?(l||(l=t._fill=no("fill")),_.appendChild(l),l.color=h.fillColor||h.color,l.opacity=h.fillOpacity):l&&(_.removeChild(l),t._fill=null)},_updateCircle:function(t){var o=t._point.round(),l=Math.round(t._radius),h=Math.round(t._radiusY||l);this._setPath(t,t._empty()?"M0 0":"AL "+o.x+","+o.y+" "+l+","+h+" 0,"+65535*360)},_setPath:function(t,o){t._path.v=o},_bringToFront:function(t){xe(t._container)},_bringToBack:function(t){rn(t._container)}},Ao=Lt.vml?no:ze,io=pi.extend({_initContainer:function(){this._container=Ao("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Ao("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ne(this._container),Ge(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){pi.prototype._update.call(this);var t=this._bounds,o=t.getSize(),l=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,l.setAttribute("width",o.x),l.setAttribute("height",o.y)),ie(l,t.min),l.setAttribute("viewBox",[t.min.x,t.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(t){var o=t._path=Ao("path");t.options.className&&Wt(o,t.options.className),t.options.interactive&&Wt(o,"leaflet-interactive"),this._updateStyle(t),this._layers[f(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ne(t._path),t.removeInteractiveTarget(t._path),delete this._layers[f(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var o=t._path,l=t.options;o&&(l.stroke?(o.setAttribute("stroke",l.color),o.setAttribute("stroke-opacity",l.opacity),o.setAttribute("stroke-width",l.weight),o.setAttribute("stroke-linecap",l.lineCap),o.setAttribute("stroke-linejoin",l.lineJoin),l.dashArray?o.setAttribute("stroke-dasharray",l.dashArray):o.removeAttribute("stroke-dasharray"),l.dashOffset?o.setAttribute("stroke-dashoffset",l.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),l.fill?(o.setAttribute("fill",l.fillColor||l.color),o.setAttribute("fill-opacity",l.fillOpacity),o.setAttribute("fill-rule",l.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(t,o){this._setPath(t,ae(t._parts,o))},_updateCircle:function(t){var o=t._point,l=Math.max(Math.round(t._radius),1),h=Math.max(Math.round(t._radiusY),1)||l,_="a"+l+","+h+" 0 1,0 ",v=t._empty()?"M0 0":"M"+(o.x-l)+","+o.y+_+l*2+",0 "+_+-l*2+",0 ";this._setPath(t,v)},_setPath:function(t,o){t._path.setAttribute("d",o)},_bringToFront:function(t){xe(t._path)},_bringToBack:function(t){rn(t._path)}});Lt.vml&&io.include(nu);function Gs(t){return Lt.svg||Lt.vml?new io(t):null}x.include({getRenderer:function(t){var o=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var o=this._paneRenderers[t];return o===void 0&&(o=this._createRenderer({pane:t}),this._paneRenderers[t]=o),o},_createRenderer:function(t){return this.options.preferCanvas&&Fs(t)||Gs(t)}});var js=Bi.extend({initialize:function(t,o){Bi.prototype.initialize.call(this,this._boundsToLatLngs(t),o)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=U(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function iu(t,o){return new js(t,o)}io.create=Ao,io.pointsToPath=ae,mi.geometryToLayer=Po,mi.coordsToLatLng=$o,mi.coordsToLatLngs=Lo,mi.latLngToCoords=ts,mi.latLngsToCoords=Co,mi.getFeature=Zi,mi.asFeature=So,x.mergeOptions({boxZoom:!0});var Us=li.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){qt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){Ge(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ne(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),an(),Hn(),this._startPoint=this._map.mouseEventToContainerPoint(t),qt(document,{contextmenu:fi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=xt("div","leaflet-zoom-box",this._container),Wt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var o=new Pt(this._point,this._startPoint),l=o.getSize();ie(this._box,o.min),this._box.style.width=l.x+"px",this._box.style.height=l.y+"px"},_finish:function(){this._moved&&(ne(this._box),Te(this._container,"leaflet-crosshair")),un(),Nt(),Ge(document,{contextmenu:fi,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(u(this._resetState,this),0);var o=new vt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});x.addInitHook("addHandler","boxZoom",Us),x.mergeOptions({doubleClickZoom:!0});var Xs=li.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var o=this._map,l=o.getZoom(),h=o.options.zoomDelta,_=t.originalEvent.shiftKey?l-h:l+h;o.options.doubleClickZoom==="center"?o.setZoom(_):o.setZoomAround(t.containerPoint,_)}});x.addInitHook("addHandler","doubleClickZoom",Xs),x.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Vs=li.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new yi(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}Wt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){Te(this._map._container,"leaflet-grab"),Te(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=U(this._map.options.maxBounds);this._offsetLimit=Mt(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var o=this._lastTime=+new Date,l=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(l),this._times.push(o),this._prunePositions(o)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,o){return t-(t-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;t.x<o.min.x&&(t.x=this._viscousLimit(t.x,o.min.x)),t.y<o.min.y&&(t.y=this._viscousLimit(t.y,o.min.y)),t.x>o.max.x&&(t.x=this._viscousLimit(t.x,o.max.x)),t.y>o.max.y&&(t.y=this._viscousLimit(t.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,o=Math.round(t/2),l=this._initialWorldOffset,h=this._draggable._newPos.x,_=(h-o+l)%t+o-l,v=(h+o+l)%t-o-l,S=Math.abs(_+l)<Math.abs(v+l)?_:v;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=S},_onDragEnd:function(t){var o=this._map,l=o.options,h=!l.inertia||t.noInertia||this._times.length<2;if(o.fire("dragend",t),h)o.fire("moveend");else{this._prunePositions(+new Date);var _=this._lastPos.subtract(this._positions[0]),v=(this._lastTime-this._times[0])/1e3,S=l.easeLinearity,N=_.multiplyBy(S/v),G=N.distanceTo([0,0]),ht=Math.min(l.inertiaMaxSpeed,G),St=N.multiplyBy(ht/G),Gt=ht/(l.inertiaDeceleration*S),re=St.multiplyBy(-Gt/2).round();!re.x&&!re.y?o.fire("moveend"):(re=o._limitOffset(re,o.options.maxBounds),ut(function(){o.panBy(re,{duration:Gt,easeLinearity:S,noMoveStart:!0,animate:!0})}))}}});x.addInitHook("addHandler","dragging",Vs),x.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ys=li.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),qt(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),Ge(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,o=document.documentElement,l=t.scrollTop||o.scrollTop,h=t.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(h,l)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var o=this._panKeys={},l=this.keyCodes,h,_;for(h=0,_=l.left.length;h<_;h++)o[l.left[h]]=[-1*t,0];for(h=0,_=l.right.length;h<_;h++)o[l.right[h]]=[t,0];for(h=0,_=l.down.length;h<_;h++)o[l.down[h]]=[0,t];for(h=0,_=l.up.length;h<_;h++)o[l.up[h]]=[0,-1*t]},_setZoomDelta:function(t){var o=this._zoomKeys={},l=this.keyCodes,h,_;for(h=0,_=l.zoomIn.length;h<_;h++)o[l.zoomIn[h]]=t;for(h=0,_=l.zoomOut.length;h<_;h++)o[l.zoomOut[h]]=-t},_addHooks:function(){qt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){Ge(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var o=t.keyCode,l=this._map,h;if(o in this._panKeys){if(!l._panAnim||!l._panAnim._inProgress)if(h=this._panKeys[o],t.shiftKey&&(h=tt(h).multiplyBy(3)),l.options.maxBounds&&(h=l._limitOffset(tt(h),l.options.maxBounds)),l.options.worldCopyJump){var _=l.wrapLatLng(l.unproject(l.project(l.getCenter()).add(h)));l.panTo(_)}else l.panBy(h)}else if(o in this._zoomKeys)l.setZoom(l.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&l._popup&&l._popup.options.closeOnEscapeKey)l.closePopup();else return;fi(t)}}});x.addInitHook("addHandler","keyboard",Ys),x.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var qs=li.extend({addHooks:function(){qt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){Ge(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var o=yo(t),l=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var h=Math.max(l-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(u(this._performZoom,this),h),fi(t)},_performZoom:function(){var t=this._map,o=t.getZoom(),l=this._map.options.zoomSnap||0;t._stop();var h=this._delta/(this._map.options.wheelPxPerZoomLevel*4),_=4*Math.log(2/(1+Math.exp(-Math.abs(h))))/Math.LN2,v=l?Math.ceil(_/l)*l:_,S=t._limitZoom(o+(this._delta>0?v:-v))-o;this._delta=0,this._startTime=null,S&&(t.options.scrollWheelZoom==="center"?t.setZoom(o+S):t.setZoomAround(this._lastMousePos,o+S))}});x.addInitHook("addHandler","scrollWheelZoom",qs);var ou=600;x.mergeOptions({tapHold:Lt.touchNative&&Lt.safari&&Lt.mobile,tapTolerance:15});var Ks=li.extend({addHooks:function(){qt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){Ge(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var o=t.touches[0];this._startPos=this._newPos=new R(o.clientX,o.clientY),this._holdTimeout=setTimeout(u(function(){this._cancel(),this._isTapValid()&&(qt(document,"touchend",An),qt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),ou),qt(document,"touchend touchcancel contextmenu",this._cancel,this),qt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){Ge(document,"touchend",An),Ge(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),Ge(document,"touchend touchcancel contextmenu",this._cancel,this),Ge(document,"touchmove",this._onMove,this)},_onMove:function(t){var o=t.touches[0];this._newPos=new R(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,o){var l=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});l._simulated=!0,o.target.dispatchEvent(l)}});x.addInitHook("addHandler","tapHold",Ks),x.mergeOptions({touchZoom:Lt.touch,bounceAtZoomLimits:!0});var Js=li.extend({addHooks:function(){Wt(this._map._container,"leaflet-touch-zoom"),qt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){Te(this._map._container,"leaflet-touch-zoom"),Ge(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var o=this._map;if(!(!t.touches||t.touches.length!==2||o._animatingZoom||this._zooming)){var l=o.mouseEventToContainerPoint(t.touches[0]),h=o.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(l.add(h)._divideBy(2))),this._startDist=l.distanceTo(h),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),qt(document,"touchmove",this._onTouchMove,this),qt(document,"touchend touchcancel",this._onTouchEnd,this),An(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var o=this._map,l=o.mouseEventToContainerPoint(t.touches[0]),h=o.mouseEventToContainerPoint(t.touches[1]),_=l.distanceTo(h)/this._startDist;if(this._zoom=o.getScaleZoom(_,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&_<1||this._zoom>o.getMaxZoom()&&_>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,_===1)return}else{var v=l._add(h)._divideBy(2)._subtract(this._centerPoint);if(_===1&&v.x===0&&v.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(v),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),O(this._animRequest);var S=u(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ut(S,this,!0),An(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,O(this._animRequest),Ge(document,"touchmove",this._onTouchMove,this),Ge(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});x.addInitHook("addHandler","touchZoom",Js),x.BoxZoom=Us,x.DoubleClickZoom=Xs,x.Drag=Vs,x.Keyboard=Ys,x.ScrollWheelZoom=qs,x.TapHold=Ks,x.TouchZoom=Js,i.Bounds=Pt,i.Browser=Lt,i.CRS=et,i.Canvas=Hs,i.Circle=Qo,i.CircleMarker=ko,i.Class=V,i.Control=Ot,i.DivIcon=Rs,i.DivOverlay=ai,i.DomEvent=Xo,i.DomUtil=jo,i.Draggable=yi,i.Evented=F,i.FeatureGroup=di,i.GeoJSON=mi,i.GridLayer=eo,i.Handler=li,i.Icon=Oi,i.ImageOverlay=Mo,i.LatLng=ot,i.LatLngBounds=vt,i.Layer=oi,i.LayerGroup=Ii,i.LineUtil=Ba,i.Map=x,i.Marker=wo,i.Mixin=Ea,i.Path=bi,i.Point=R,i.PolyUtil=Aa,i.Polygon=Bi,i.Polyline=_i,i.Popup=To,i.PosAnimation=M,i.Projection=Za,i.Rectangle=js,i.Renderer=pi,i.SVG=io,i.SVGOverlay=Ds,i.TileLayer=Di,i.Tooltip=Eo,i.Transformation=At,i.Util=it,i.VideoOverlay=Zs,i.bind=u,i.bounds=Mt,i.canvas=Fs,i.circle=ja,i.circleMarker=Ga,i.control=Ct,i.divIcon=$a,i.extend=r,i.featureGroup=Wa,i.geoJSON=Bs,i.geoJson=Va,i.gridLayer=tu,i.icon=Ha,i.imageOverlay=Ya,i.latLng=Q,i.latLngBounds=U,i.layerGroup=xa,i.map=ct,i.marker=Fa,i.point=tt,i.polygon=Xa,i.polyline=Ua,i.popup=Ja,i.rectangle=iu,i.setOptions=C,i.stamp=f,i.svg=Gs,i.svgOverlay=Ka,i.tileLayer=xs,i.tooltip=Qa,i.transformation=Dt,i.version=s,i.videoOverlay=qa;var su=window.L;i.noConflict=function(){return window.L=su,this},window.L=i})})(ys,ys.exports);var gi=ys.exports;const{Map:_o}=gu;function Sl(n,e,i){const s=n.slice();return s[161]=e[i],s[163]=i,s}function Ml(n,e,i){const s=n.slice();return s[164]=e[i],s}function Tl(n,e,i){const s=n.slice();return s[167]=e[i],s[168]=e,s[169]=i,s}function El(n,e,i){const s=n.slice();return s[170]=e[i],s}function Al(n,e,i){const s=n.slice();return s[173]=e[i],s}function ds(n){const e=n.slice(),i=e[62](e[173].source);e[176]=i;const s=e[62](e[173].target);return e[177]=s,e}function zl(n,e,i){const s=n.slice();return s[178]=e[i],s[179]=e,s[180]=i,s}function Nl(n,e,i){const s=n.slice();return s[177]=e[i],s}function Il(n,e,i){const s=n.slice();return s[185]=e[i],s}function Ol(n,e,i){const s=n.slice();return s[173]=e[i],s}function $f(n){let e=[],i=new _o,s,r=be(n[2]);const a=u=>u[173].id;for(let u=0;u<r.length;u+=1){let c=Ol(n,r,u),f=a(c);i.set(f,e[u]=Bl(f,c))}return{c(){for(let u=0;u<e.length;u+=1)e[u].c();s=Ee()},m(u,c){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(u,c);K(u,s,c)},p(u,c){c[0]&4|c[1]&8192&&(r=be(u[2]),e=vi(e,c,a,1,u,r,i,s.parentNode,Ho,Bl,s,Ol))},d(u){u&&Y(s);for(let c=0;c<e.length;c+=1)e[c].d(u)}}}function td(n){let e;return{c(){e=T("div"),e.textContent="(none)",m(e,"class","muted small txt svelte-1ihg8yv")},m(i,s){K(i,e,s)},p:Ht,d(i){i&&Y(e)}}}function Bl(n,e){let i,s=e[173].source+"",r,a,u=e[173].target+"",c,f,d,p,g,w;function k(){return e[87](e[173])}return{key:n,first:null,c(){i=T("span"),r=ge(s),a=ge("→"),c=ge(u),f=W(),d=T("button"),d.textContent="×",p=W(),m(d,"class","pill-x svelte-1ihg8yv"),m(d,"aria-label","Remove edge"),m(i,"class","edge-pill svelte-1ihg8yv"),m(i,"title","Click × to remove"),this.first=i},m(P,C){K(P,i,C),y(i,r),y(i,a),y(i,c),y(i,f),y(i,d),y(i,p),g||(w=lt(d,"click",k),g=!0)},p(P,C){e=P,C[0]&4&&s!==(s=e[173].source+"")&&sn(r,s),C[0]&4&&u!==(u=e[173].target+"")&&sn(c,u)},d(P){P&&Y(i),g=!1,w()}}}function Zl(n){let e,i,s,r,a,u,c,f,d,p;return{c(){e=T("div"),i=T("span"),s=ge("connecting from "),r=T("code"),a=ge(n[5]),u=ge(" — click a node’s ◀ to finish"),c=W(),f=T("button"),f.textContent="cancel",m(i,"class","txt svelte-1ihg8yv"),m(f,"class","pill-x svelte-1ihg8yv"),m(e,"class","pending small svelte-1ihg8yv")},m(g,w){K(g,e,w),y(e,i),y(i,s),y(i,r),y(r,a),y(i,u),y(e,c),y(e,f),d||(p=lt(f,"click",n[51]),d=!0)},p(g,w){w[0]&32&&sn(a,g[5])},d(g){g&&Y(e),d=!1,p()}}}function ed(n){let e,i=[],s=new _o,r=be(n[32]);const a=u=>u[185].id;for(let u=0;u<r.length;u+=1){let c=Il(n,r,u),f=a(c);s.set(f,i[u]=Dl(f,c))}return{c(){e=T("div");for(let u=0;u<i.length;u+=1)i[u].c();m(e,"class","tool-list svelte-1ihg8yv")},m(u,c){K(u,e,c);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null)},p(u,c){c[1]&2|c[2]&226&&(r=be(u[32]),i=vi(i,c,a,1,u,r,s,e,Ho,Dl,null,Il))},d(u){u&&Y(e);for(let c=0;c<i.length;c+=1)i[c].d()}}}function nd(n){let e;return{c(){e=T("div"),e.textContent="(no scheduled jobs)",m(e,"class","muted small txt svelte-1ihg8yv")},m(i,s){K(i,e,s)},p:Ht,d(i){i&&Y(e)}}}function Dl(n,e){let i,s,r,a,u=la(e[185].next_run_time)+"",c,f,d,p,g,w,k,P,C,A,z,E,I,D,X,H;function j(){return e[88](e[185])}function J(){return e[89](e[185])}function $(){return e[90](e[185])}function st(){return e[91](e[185])}function ut(){return e[92](e[185])}return{key:n,first:null,c(){i=T("div"),s=T("div"),r=T("div"),a=T("time"),c=ge(u),d=W(),p=T("div"),g=T("button"),g.textContent="Run now",w=W(),k=T("button"),k.textContent="Pause",P=W(),C=T("button"),C.textContent="Resume",A=W(),z=T("button"),z.textContent="Logs",E=W(),I=T("button"),I.textContent="Delete",D=W(),m(a,"datetime",f=e[185].next_run_time),m(r,"class","schedule-date svelte-1ihg8yv"),m(s,"class","schedule-head svelte-1ihg8yv"),m(g,"class","pill-x svelte-1ihg8yv"),m(g,"title","Run now"),m(k,"class","pill-x svelte-1ihg8yv"),m(k,"title","Pause"),m(C,"class","pill-x svelte-1ihg8yv"),m(C,"title","Resume"),m(z,"class","pill-x svelte-1ihg8yv"),m(z,"title","Logs"),m(I,"class","pill-x svelte-1ihg8yv"),m(I,"title","Delete"),m(p,"class","schedule-actions svelte-1ihg8yv"),m(i,"class","tool schedule-card svelte-1ihg8yv"),this.first=i},m(O,it){K(O,i,it),y(i,s),y(s,r),y(r,a),y(a,c),y(i,d),y(i,p),y(p,g),y(p,w),y(p,k),y(p,P),y(p,C),y(p,A),y(p,z),y(p,E),y(p,I),y(i,D),X||(H=[lt(g,"click",j),lt(k,"click",J),lt(C,"click",$),lt(z,"click",st),lt(I,"click",ut)],X=!0)},p(O,it){e=O,it[1]&2&&u!==(u=la(e[185].next_run_time)+"")&&sn(c,u),it[1]&2&&f!==(f=e[185].next_run_time)&&m(a,"datetime",f)},d(O){O&&Y(i),X=!1,qe(H)}}}function Rl(n){let e,i=n[177].name+"",s,r;return{c(){e=T("option"),s=ge(i),e.__value=r=n[177].name,pe(e,e.__value)},m(a,u){K(a,e,u),y(e,s)},p(a,u){u[0]&64&&i!==(i=a[177].name+"")&&sn(s,i),u[0]&64&&r!==(r=a[177].name)&&(e.__value=r,pe(e,e.__value))},d(a){a&&Y(e)}}}function id(n){let e,i,s=n[178].label+"",r,a,u,c,f,d,p,g,w,k,P,C,A,z,E,I,D,X,H,j,J;function $(){return n[93](n[178])}function st(){return n[94](n[178])}function ut(){return n[95](n[178])}let O=be(n[6]),it=[];for(let yt=0;yt<O.length;yt+=1)it[yt]=Rl(Nl(n,O,yt));function V(){n[96].call(P,n[180])}function _t(){return n[97](n[180],n[178])}function mt(){return n[98](n[178])}function F(){return n[99](n[178],n[180])}function R(){return n[100](n[178])}return{c(){e=T("div"),i=T("div"),r=ge(s),a=W(),u=T("button"),c=W(),f=T("button"),p=W(),g=T("button"),g.textContent="🗑",w=W(),k=T("div"),P=T("select");for(let yt=0;yt<it.length;yt+=1)it[yt].c();C=W(),A=T("button"),A.textContent="⚙",z=W(),E=T("button"),E.textContent="👁",I=W(),D=T("button"),D.textContent="▶",H=W(),m(i,"class","node-title svelte-1ihg8yv"),m(u,"class","dot in svelte-1ihg8yv"),m(u,"title","input"),m(f,"class","dot out svelte-1ihg8yv"),m(f,"title","output"),m(f,"aria-pressed",d=n[5]===n[178].id),m(g,"class","node-del svelte-1ihg8yv"),m(g,"title","delete node"),m(P,"class","svelte-1ihg8yv"),n[1][n[180]].type===void 0&&Ei(V),m(A,"class","edit-btn svelte-1ihg8yv"),m(E,"class","preview-btn svelte-1ihg8yv"),m(E,"title","Preview on map"),m(D,"class","runone-btn svelte-1ihg8yv"),m(D,"title","Run this node only"),m(k,"class","node-config svelte-1ihg8yv"),m(e,"class","node svelte-1ihg8yv"),m(e,"aria-selected",X=n[181]?"true":"false")},m(yt,tt){K(yt,e,tt),y(e,i),y(i,r),y(e,a),y(e,u),y(e,c),y(e,f),y(e,p),y(e,g),y(e,w),y(e,k),y(k,P);for(let Pt=0;Pt<it.length;Pt+=1)it[Pt]&&it[Pt].m(P,null);Gi(P,n[1][n[180]].type,!0),y(k,C),y(k,A),y(k,z),y(k,E),y(k,I),y(k,D),K(yt,H,tt),j||(J=[lt(u,"click",$),lt(f,"click",st),lt(g,"click",ut),lt(P,"change",V),lt(P,"change",_t),lt(A,"click",mt),lt(E,"click",F),lt(D,"click",R),ki(n[182].call(null,e))],j=!0)},p(yt,tt){if(n=yt,tt[0]&2&&s!==(s=n[178].label+"")&&sn(r,s),tt[0]&98&&d!==(d=n[5]===n[178].id)&&m(f,"aria-pressed",d),tt[0]&64){O=be(n[6]);let Pt;for(Pt=0;Pt<O.length;Pt+=1){const Mt=Nl(n,O,Pt);it[Pt]?it[Pt].p(Mt,tt):(it[Pt]=Rl(Mt),it[Pt].c(),it[Pt].m(P,null))}for(;Pt<it.length;Pt+=1)it[Pt].d(1);it.length=O.length}tt[0]&66&&Gi(P,n[1][n[180]].type),tt[5]&67108864&&X!==(X=n[181]?"true":"false")&&m(e,"aria-selected",X)},d(yt){yt&&(Y(e),Y(H)),Pi(it,yt),j=!1,qe(J)}}}function xl(n,e){let i,s,r,a;function u(f){e[101](f,e[180])}let c={id:e[178].id,width:Ma,height:Ta,$$slots:{default:[id,({selected:f,grabHandle:d})=>({181:f,182:d}),({selected:f,grabHandle:d})=>[0,0,0,0,0,(f?67108864:0)|(d?134217728:0)]]},$$scope:{ctx:e}};return e[1][e[180]].position!==void 0&&(c.position=e[1][e[180]].position),s=new ks({props:c}),Kn.push(()=>Su(s,"position",u)),{key:n,first:null,c(){i=Ee(),le(s.$$.fragment),this.first=i},m(f,d){K(f,i,d),oe(s,f,d),a=!0},p(f,d){e=f;const p={};d[0]&2&&(p.id=e[178].id),d[0]&122|d[5]&67108864|d[6]&16&&(p.$$scope={dirty:d,ctx:e}),!r&&d[0]&2&&(r=!0,p.position=e[1][e[180]].position,Pu(()=>r=!1)),s.$set(p)},i(f){a||(Z(s.$$.fragment,f),a=!0)},o(f){q(s.$$.fragment,f),a=!1},d(f){f&&Y(i),se(s,f)}}}function Wl(n){let e,i;return{c(){e=Qt("path"),m(e,"d",i=`M ${n[53](n[176])} ${n[54](n[176])}
                        C ${n[53](n[176])+60} ${n[54](n[176])},
                          ${n[52](n[177])-60} ${n[54](n[177])},
                          ${n[52](n[177])} ${n[54](n[177])}`),m(e,"class","cable svelte-1ihg8yv"),m(e,"marker-end","url(#arrow)")},m(s,r){K(s,e,r)},p(s,r){r[0]&4&&i!==(i=`M ${s[53](s[176])} ${s[54](s[176])}
                        C ${s[53](s[176])+60} ${s[54](s[176])},
                          ${s[52](s[177])-60} ${s[54](s[177])},
                          ${s[52](s[177])} ${s[54](s[177])}`)&&m(e,"d",i)},d(s){s&&Y(e)}}}function Hl(n,e){let i,s=e[43](e[173].source)&&e[43](e[173].target),r,a=s&&Wl(ds(e));return{key:n,first:null,c(){i=Ee(),a&&a.c(),r=Ee(),this.first=i},m(u,c){K(u,i,c),a&&a.m(u,c),K(u,r,c)},p(u,c){e=u,c[0]&4&&(s=e[43](e[173].source)&&e[43](e[173].target)),s?a?a.p(ds(e),c):(a=Wl(ds(e)),a.c(),a.m(r.parentNode,r)):a&&(a.d(1),a=null)},d(u){u&&(Y(i),Y(r)),a&&a.d(u)}}}function Fl(n){let e,i,s,r=[],a=new _o,u,c=be(n[2]);const f=d=>d[173].id;for(let d=0;d<c.length;d+=1){let p=Al(n,c,d),g=f(p);a.set(g,r[d]=Hl(g,p))}return{c(){e=Qt("defs"),i=Qt("marker"),s=Qt("path");for(let d=0;d<r.length;d+=1)r[d].c();u=Ee(),m(s,"d","M 0 0 L 10 5 L 0 10 z"),m(i,"id","arrow"),m(i,"viewBox","0 0 10 10"),m(i,"refX","9"),m(i,"refY","5"),m(i,"markerWidth","6"),m(i,"markerHeight","6"),m(i,"orient","auto-start-reverse")},m(d,p){K(d,e,p),y(e,i),y(i,s);for(let g=0;g<r.length;g+=1)r[g]&&r[g].m(d,p);K(d,u,p)},p(d,p){p[0]&4|p[1]&14684160|p[2]&1&&(c=be(d[2]),r=vi(r,p,f,1,d,c,a,u.parentNode,Ho,Hl,u,Al))},d(d){d&&(Y(e),Y(u));for(let p=0;p<r.length;p+=1)r[p].d(d)}}}function od(n){let e=[],i=new _o,s,r,a=n[10],u,c,f=be(n[1]);const d=g=>g[178].id;for(let g=0;g<f.length;g+=1){let w=zl(n,f,g),k=d(w);i.set(k,e[g]=xl(k,w))}let p=Fl(n);return{c(){for(let g=0;g<e.length;g+=1)e[g].c();s=W(),r=Qt("svg"),p.c(),m(r,"class","edges-overlay svelte-1ihg8yv"),m(r,"viewBox",u=`0 0 ${n[12]} ${n[13]}`),m(r,"preserveAspectRatio","none")},m(g,w){for(let k=0;k<e.length;k+=1)e[k]&&e[k].m(g,w);K(g,s,w),K(g,r,w),p.m(r,null),c=!0},p(g,w){w[0]&122|w[1]&671924224|w[5]&67108864&&(f=be(g[1]),ve(),e=vi(e,w,d,1,g,f,i,s.parentNode,co,xl,s,zl),ye()),w[0]&1024&&pn(a,a=g[10])?(p.d(1),p=Fl(g),p.c(),p.m(r,null)):p.p(g,w),(!c||w[0]&12288&&u!==(u=`0 0 ${g[12]} ${g[13]}`))&&m(r,"viewBox",u)},i(g){if(!c){for(let w=0;w<f.length;w+=1)Z(e[w]);c=!0}},o(g){for(let w=0;w<e.length;w+=1)q(e[w]);c=!1},d(g){g&&(Y(s),Y(r));for(let w=0;w<e.length;w+=1)e[w].d(g);p.d(g)}}}function Gl(n){let e,i,s,r,a,u,c=n[18].label+"",f,d,p,g,w,k,P,C,A,z,E,I,D,X;function H($,st){return $[22]?sd:rd}let j=H(n),J=j(n);return{c(){e=T("div"),i=W(),s=T("div"),r=T("div"),a=T("h3"),u=ge("Edit Args — "),f=ge(c),d=W(),p=T("div"),g=T("button"),g.textContent="Form",w=W(),k=T("button"),k.textContent="Advanced JSON",P=W(),J.c(),C=W(),A=T("div"),z=T("button"),z.textContent="Cancel",E=W(),I=T("button"),I.textContent="Save",m(e,"class","modal-backdrop svelte-1ihg8yv"),m(a,"class","svelte-1ihg8yv"),m(g,"class","svelte-1ihg8yv"),Yt(g,"seg-active",!n[22]),m(k,"class","svelte-1ihg8yv"),Yt(k,"seg-active",n[22]),m(p,"class","seg svelte-1ihg8yv"),m(r,"class","modal-head svelte-1ihg8yv"),m(z,"class","btn svelte-1ihg8yv"),m(I,"class","btn primary svelte-1ihg8yv"),m(A,"class","modal-actions svelte-1ihg8yv"),m(s,"class","modal svelte-1ihg8yv")},m($,st){K($,e,st),K($,i,st),K($,s,st),y(s,r),y(r,a),y(a,u),y(a,f),y(r,d),y(r,p),y(p,g),y(p,w),y(p,k),y(s,P),J.m(s,null),y(s,C),y(s,A),y(A,z),y(A,E),y(A,I),D||(X=[lt(e,"click",n[106]),lt(g,"click",n[107]),lt(k,"click",n[108]),lt(z,"click",n[116]),lt(I,"click",n[61]),lt(s,"click",Un(n[83]))],D=!0)},p($,st){st[0]&262144&&c!==(c=$[18].label+"")&&sn(f,c),st[0]&4194304&&Yt(g,"seg-active",!$[22]),st[0]&4194304&&Yt(k,"seg-active",$[22]),j===(j=H($))&&J?J.p($,st):(J.d(1),J=j($),J&&(J.c(),J.m(s,C)))},d($){$&&(Y(e),Y(i),Y(s)),J.d(),D=!1,qe(X)}}}function sd(n){let e,i,s;return{c(){e=T("textarea"),m(e,"class","json-area svelte-1ihg8yv")},m(r,a){K(r,e,a),pe(e,n[19]),i||(s=lt(e,"input",n[115]),i=!0)},p(r,a){a[0]&524288&&pe(e,r[19])},d(r){r&&Y(e),i=!1,s()}}}function rd(n){let e,i=be(n[20]),s=[];for(let r=0;r<i.length;r+=1)s[r]=Ul(Tl(n,i,r));return{c(){e=T("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","form-grid svelte-1ihg8yv")},m(r,a){K(r,e,a);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null)},p(r,a){if(a[0]&3145728){i=be(r[20]);let u;for(u=0;u<i.length;u+=1){const c=Tl(r,i,u);s[u]?s[u].p(c,a):(s[u]=Ul(c),s[u].c(),s[u].m(e,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=i.length}},d(r){r&&Y(e),Pi(s,r)}}}function ld(n){let e,i,s,r=be(ra(n[167])),a=[];for(let c=0;c<r.length;c+=1)a[c]=jl(El(n,r,c));function u(){n[114].call(e,n[167])}return{c(){e=T("select");for(let c=0;c<a.length;c+=1)a[c].c();m(e,"class","svelte-1ihg8yv"),n[21][n[167].key]===void 0&&Ei(u)},m(c,f){K(c,e,f);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(e,null);Gi(e,n[21][n[167].key],!0),i||(s=lt(e,"change",u),i=!0)},p(c,f){if(n=c,f[0]&1048576){r=be(ra(n[167]));let d;for(d=0;d<r.length;d+=1){const p=El(n,r,d);a[d]?a[d].p(p,f):(a[d]=jl(p),a[d].c(),a[d].m(e,null))}for(;d<a.length;d+=1)a[d].d(1);a.length=r.length}f[0]&3145728&&Gi(e,n[21][n[167].key])},d(c){c&&Y(e),Pi(a,c),i=!1,s()}}}function ad(n){let e,i,s,r,a,u=sa(n[167])+"",c,f,d;function p(){n[113].call(e,n[167])}return{c(){e=T("input"),s=W(),r=T("small"),a=ge("Comma-separated "),c=ge(u),m(e,"type","text"),m(e,"placeholder",i=oa(n[167])),m(e,"class","svelte-1ihg8yv"),m(r,"class","muted svelte-1ihg8yv")},m(g,w){K(g,e,w),pe(e,n[21][n[167].key]),K(g,s,w),K(g,r,w),y(r,a),y(r,c),f||(d=lt(e,"input",p),f=!0)},p(g,w){n=g,w[0]&1048576&&i!==(i=oa(n[167]))&&m(e,"placeholder",i),w[0]&3145728&&e.value!==n[21][n[167].key]&&pe(e,n[21][n[167].key]),w[0]&1048576&&u!==(u=sa(n[167])+"")&&sn(c,u)},d(g){g&&(Y(e),Y(s),Y(r)),f=!1,d()}}}function ud(n){let e,i,s,r,a;function u(){n[112].call(e,n[167])}return{c(){e=T("textarea"),m(e,"rows",i=na(n[167])),m(e,"placeholder",s=ia(n[167])),m(e,"class","svelte-1ihg8yv")},m(c,f){K(c,e,f),pe(e,n[21][n[167].key]),r||(a=lt(e,"input",u),r=!0)},p(c,f){n=c,f[0]&1048576&&i!==(i=na(n[167]))&&m(e,"rows",i),f[0]&1048576&&s!==(s=ia(n[167]))&&m(e,"placeholder",s),f[0]&3145728&&pe(e,n[21][n[167].key])},d(c){c&&Y(e),r=!1,a()}}}function cd(n){let e,i,s,r,a,u;function c(){n[111].call(i,n[167])}return{c(){e=T("label"),i=T("input"),s=W(),r=T("span"),m(i,"type","checkbox"),m(i,"class","svelte-1ihg8yv"),m(e,"class","switch svelte-1ihg8yv")},m(f,d){K(f,e,d),y(e,i),i.checked=n[21][n[167].key],y(e,s),y(e,r),a||(u=lt(i,"change",c),a=!0)},p(f,d){n=f,d[0]&3145728&&(i.checked=n[21][n[167].key])},d(f){f&&Y(e),a=!1,u()}}}function hd(n){let e,i,s,r;function a(){n[110].call(e,n[167])}return{c(){e=T("input"),m(e,"type","number"),m(e,"step",i=n[167].step??1),m(e,"class","svelte-1ihg8yv")},m(u,c){K(u,e,c),pe(e,n[21][n[167].key]),s||(r=lt(e,"input",a),s=!0)},p(u,c){n=u,c[0]&1048576&&i!==(i=n[167].step??1)&&m(e,"step",i),c[0]&3145728&&wi(e.value)!==n[21][n[167].key]&&pe(e,n[21][n[167].key])},d(u){u&&Y(e),s=!1,r()}}}function fd(n){let e,i,s,r;function a(){n[109].call(e,n[167])}return{c(){e=T("input"),m(e,"type","text"),m(e,"placeholder",i=n[167].placeholder??""),m(e,"class","svelte-1ihg8yv")},m(u,c){K(u,e,c),pe(e,n[21][n[167].key]),s||(r=lt(e,"input",a),s=!0)},p(u,c){n=u,c[0]&1048576&&i!==(i=n[167].placeholder??"")&&m(e,"placeholder",i),c[0]&3145728&&e.value!==n[21][n[167].key]&&pe(e,n[21][n[167].key])},d(u){u&&Y(e),s=!1,r()}}}function jl(n){let e,i=n[170]+"",s,r;return{c(){e=T("option"),s=ge(i),e.__value=r=n[170],pe(e,e.__value)},m(a,u){K(a,e,u),y(e,s)},p(a,u){u[0]&1048576&&i!==(i=a[170]+"")&&sn(s,i),u[0]&1048576&&r!==(r=a[170])&&(e.__value=r,pe(e,e.__value))},d(a){a&&Y(e)}}}function Ul(n){let e,i,s=n[167].label+"",r,a,u;function c(p,g){if(p[167].type==="string")return fd;if(p[167].type==="number")return hd;if(p[167].type==="boolean")return cd;if(p[167].type==="textarea")return ud;if(p[167].type==="array")return ad;if(p[167].type==="select")return ld}let f=c(n),d=f&&f(n);return{c(){e=T("div"),i=T("label"),r=ge(s),a=W(),d&&d.c(),u=W(),m(i,"class","svelte-1ihg8yv"),m(e,"class","form-row svelte-1ihg8yv")},m(p,g){K(p,e,g),y(e,i),y(i,r),y(e,a),d&&d.m(e,null),y(e,u)},p(p,g){g[0]&1048576&&s!==(s=p[167].label+"")&&sn(r,s),f===(f=c(p))&&d?d.p(p,g):(d&&d.d(1),d=f&&f(p),d&&(d.c(),d.m(e,u)))},d(p){p&&Y(e),d&&d.d()}}}function Xl(n){let e,i,s,r,a,u,c,f,d,p,g,w,k,P,C,A,z,E,I,D,X=n[30]?"Scheduling…":"Create schedule",H,j,J;function $(it,V){return it[24]==="once"?md:it[24]==="interval"?_d:dd}let st=$(n),ut=st(n),O=n[31]&&Vl(n);return{c(){e=T("div"),i=W(),s=T("div"),r=T("div"),r.innerHTML='<h3 class="svelte-1ihg8yv">Schedule Pipeline (active connected graph)</h3>',a=W(),u=T("div"),c=T("div"),f=T("label"),f.textContent="Mode",d=W(),p=T("select"),g=T("option"),g.textContent="Once",w=T("option"),w.textContent="Interval",k=T("option"),k.textContent="Cron",P=W(),ut.c(),C=W(),O&&O.c(),A=W(),z=T("div"),E=T("button"),E.textContent="Cancel",I=W(),D=T("button"),H=ge(X),m(e,"class","modal-backdrop svelte-1ihg8yv"),m(r,"class","modal-head svelte-1ihg8yv"),m(f,"class","svelte-1ihg8yv"),g.__value="once",pe(g,g.__value),w.__value="interval",pe(w,w.__value),k.__value="cron",pe(k,k.__value),m(p,"class","svelte-1ihg8yv"),n[24]===void 0&&Ei(()=>n[118].call(p)),m(c,"class","form-row svelte-1ihg8yv"),m(u,"class","form-grid svelte-1ihg8yv"),m(E,"class","btn svelte-1ihg8yv"),m(D,"class","btn primary svelte-1ihg8yv"),D.disabled=n[30],m(z,"class","modal-actions svelte-1ihg8yv"),m(s,"class","modal svelte-1ihg8yv")},m(it,V){K(it,e,V),K(it,i,V),K(it,s,V),y(s,r),y(s,a),y(s,u),y(u,c),y(c,f),y(c,d),y(c,p),y(p,g),y(p,w),y(p,k),Gi(p,n[24],!0),y(u,P),ut.m(u,null),y(u,C),O&&O.m(u,null),y(s,A),y(s,z),y(z,E),y(z,I),y(z,D),y(D,H),j||(J=[lt(e,"click",n[117]),lt(p,"change",n[118]),lt(E,"click",n[124]),lt(D,"click",n[65]),lt(s,"click",Un(n[82]))],j=!0)},p(it,V){V[0]&16777216&&Gi(p,it[24]),st===(st=$(it))&&ut?ut.p(it,V):(ut.d(1),ut=st(it),ut&&(ut.c(),ut.m(u,C))),it[31]?O?O.p(it,V):(O=Vl(it),O.c(),O.m(u,null)):O&&(O.d(1),O=null),V[0]&1073741824&&X!==(X=it[30]?"Scheduling…":"Create schedule")&&sn(H,X),V[0]&1073741824&&(D.disabled=it[30])},d(it){it&&(Y(e),Y(i),Y(s)),ut.d(),O&&O.d(),j=!1,qe(J)}}}function dd(n){let e,i,s,r,a,u,c,f;return{c(){e=T("div"),i=T("label"),i.textContent="Cron (UTC)",s=W(),r=T("input"),a=W(),u=T("small"),u.innerHTML="Example: <code>0 5 * * *</code> = 05:00 UTC daily",m(i,"class","svelte-1ihg8yv"),m(r,"type","text"),m(r,"placeholder","0 5 * * *"),m(r,"class","svelte-1ihg8yv"),m(u,"class","muted svelte-1ihg8yv"),m(e,"class","form-row svelte-1ihg8yv")},m(d,p){K(d,e,p),y(e,i),y(e,s),y(e,r),pe(r,n[29]),y(e,a),y(e,u),c||(f=lt(r,"input",n[123]),c=!0)},p(d,p){p[0]&536870912&&r.value!==d[29]&&pe(r,d[29])},d(d){d&&Y(e),c=!1,f()}}}function _d(n){let e,i,s,r,a,u,c,f,d,p,g,w,k;return{c(){e=T("div"),i=T("label"),i.textContent="Interval",s=W(),r=T("div"),a=T("input"),u=W(),c=T("input"),f=W(),d=T("input"),p=W(),g=T("small"),g.textContent="At least one of hours/minutes/seconds must be > 0.",m(i,"class","svelte-1ihg8yv"),m(a,"type","number"),m(a,"min","0"),m(a,"placeholder","hours"),m(a,"class","svelte-1ihg8yv"),m(c,"type","number"),m(c,"min","0"),m(c,"placeholder","minutes"),m(c,"class","svelte-1ihg8yv"),m(d,"type","number"),m(d,"min","0"),m(d,"placeholder","seconds"),m(d,"class","svelte-1ihg8yv"),at(r,"display","grid"),at(r,"grid-template-columns","repeat(3, 1fr)"),at(r,"gap","8px"),m(g,"class","muted svelte-1ihg8yv"),m(e,"class","form-row svelte-1ihg8yv")},m(P,C){K(P,e,C),y(e,i),y(e,s),y(e,r),y(r,a),pe(a,n[26]),y(r,u),y(r,c),pe(c,n[27]),y(r,f),y(r,d),pe(d,n[28]),y(e,p),y(e,g),w||(k=[lt(a,"input",n[120]),lt(c,"input",n[121]),lt(d,"input",n[122])],w=!0)},p(P,C){C[0]&67108864&&wi(a.value)!==P[26]&&pe(a,P[26]),C[0]&134217728&&wi(c.value)!==P[27]&&pe(c,P[27]),C[0]&268435456&&wi(d.value)!==P[28]&&pe(d,P[28])},d(P){P&&Y(e),w=!1,qe(k)}}}function md(n){let e,i,s,r,a,u,c,f;return{c(){e=T("div"),i=T("label"),i.textContent="Date & time (your local)",s=W(),r=T("input"),a=W(),u=T("small"),u.textContent="Stored & executed in UTC on the server.",m(i,"class","svelte-1ihg8yv"),m(r,"type","datetime-local"),m(u,"class","muted svelte-1ihg8yv"),m(e,"class","form-row svelte-1ihg8yv")},m(d,p){K(d,e,p),y(e,i),y(e,s),y(e,r),pe(r,n[25]),y(e,a),y(e,u),c||(f=lt(r,"input",n[119]),c=!0)},p(d,p){p[0]&33554432&&pe(r,d[25])},d(d){d&&Y(e),c=!1,f()}}}function Vl(n){let e,i,s;return{c(){e=T("div"),i=T("div"),s=ge(n[31]),m(i,"class","muted svelte-1ihg8yv"),at(i,"color","#ffb4b4"),m(e,"class","form-row svelte-1ihg8yv")},m(r,a){K(r,e,a),y(e,i),y(i,s)},p(r,a){a[1]&1&&sn(s,r[31])},d(r){r&&Y(e)}}}function Yl(n){let e,i,s,r,a,u,c,f,d,p,g,w,k,P,C,A,z,E,I,D,X,H;return{c(){e=T("div"),i=W(),s=T("div"),r=T("div"),r.innerHTML='<h3 class="svelte-1ihg8yv">Save Workflow</h3>',a=W(),u=T("div"),c=T("div"),f=T("label"),f.textContent="Workflow Name",d=W(),p=T("input"),g=W(),w=T("div"),k=T("label"),k.textContent="Description (Optional)",P=W(),C=T("textarea"),A=W(),z=T("div"),E=T("button"),E.textContent="Cancel",I=W(),D=T("button"),D.textContent="Save Workflow",m(e,"class","modal-backdrop svelte-1ihg8yv"),m(r,"class","modal-head svelte-1ihg8yv"),m(f,"class","svelte-1ihg8yv"),m(p,"type","text"),m(p,"placeholder","My Awesome Workflow"),m(p,"class","svelte-1ihg8yv"),m(c,"class","form-row svelte-1ihg8yv"),m(k,"class","svelte-1ihg8yv"),m(C,"rows","3"),m(C,"placeholder","Describe what this workflow does..."),m(C,"class","svelte-1ihg8yv"),m(w,"class","form-row svelte-1ihg8yv"),m(u,"class","form-grid svelte-1ihg8yv"),m(E,"class","btn svelte-1ihg8yv"),m(D,"class","btn primary svelte-1ihg8yv"),m(z,"class","modal-actions svelte-1ihg8yv"),m(s,"class","modal svelte-1ihg8yv")},m(j,J){K(j,e,J),K(j,i,J),K(j,s,J),y(s,r),y(s,a),y(s,u),y(u,c),y(c,f),y(c,d),y(c,p),pe(p,n[36]),y(u,g),y(u,w),y(w,k),y(w,P),y(w,C),pe(C,n[37]),y(s,A),y(s,z),y(z,E),y(z,I),y(z,D),X||(H=[lt(e,"click",n[125]),lt(p,"input",n[126]),lt(C,"input",n[127]),lt(E,"click",n[128]),lt(D,"click",n[72]),lt(s,"click",Un(n[81]))],X=!0)},p(j,J){J[1]&32&&p.value!==j[36]&&pe(p,j[36]),J[1]&64&&pe(C,j[37])},d(j){j&&(Y(e),Y(i),Y(s)),X=!1,qe(H)}}}function ql(n){let e,i,s,r,a,u,c,f,d,p,g;function w(C,A){return C[33].length===0?gd:pd}let k=w(n),P=k(n);return{c(){e=T("div"),i=W(),s=T("div"),r=T("div"),r.innerHTML='<h3 class="svelte-1ihg8yv">Load Workflow</h3>',a=W(),u=T("div"),P.c(),c=W(),f=T("div"),d=T("button"),d.textContent="Close",m(e,"class","modal-backdrop svelte-1ihg8yv"),m(r,"class","modal-head svelte-1ihg8yv"),m(u,"class","workflow-list svelte-1ihg8yv"),m(d,"class","btn svelte-1ihg8yv"),m(f,"class","modal-actions svelte-1ihg8yv"),m(s,"class","modal svelte-1ihg8yv")},m(C,A){K(C,e,A),K(C,i,A),K(C,s,A),y(s,r),y(s,a),y(s,u),P.m(u,null),y(s,c),y(s,f),y(f,d),p||(g=[lt(e,"click",n[129]),lt(d,"click",n[132]),lt(s,"click",Un(n[80]))],p=!0)},p(C,A){k===(k=w(C))&&P?P.p(C,A):(P.d(1),P=k(C),P&&(P.c(),P.m(u,null)))},d(C){C&&(Y(e),Y(i),Y(s)),P.d(),p=!1,qe(g)}}}function pd(n){let e,i=be(n[33]),s=[];for(let r=0;r<i.length;r+=1)s[r]=Kl(Ml(n,i,r));return{c(){for(let r=0;r<s.length;r+=1)s[r].c();e=Ee()},m(r,a){for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(r,a);K(r,e,a)},p(r,a){if(a[1]&4|a[2]&6144){i=be(r[33]);let u;for(u=0;u<i.length;u+=1){const c=Ml(r,i,u);s[u]?s[u].p(c,a):(s[u]=Kl(c),s[u].c(),s[u].m(e.parentNode,e))}for(;u<s.length;u+=1)s[u].d(1);s.length=i.length}},d(r){r&&Y(e),Pi(s,r)}}}function gd(n){let e;return{c(){e=T("div"),e.textContent="No saved workflows found",m(e,"class","muted svelte-1ihg8yv")},m(i,s){K(i,e,s)},p:Ht,d(i){i&&Y(e)}}}function Kl(n){let e,i,s,r=n[164].name+"",a,u,c,f=(n[164].description||"No description")+"",d,p,g,w=new Date(n[164].created_at).toLocaleString()+"",k,P,C,A,z,E,I,D,X;function H(){return n[130](n[164])}function j(){return n[131](n[164])}return{c(){e=T("div"),i=T("div"),s=T("div"),a=ge(r),u=W(),c=T("div"),d=ge(f),p=W(),g=T("div"),k=ge(w),P=W(),C=T("div"),A=T("button"),A.textContent="Load",z=W(),E=T("button"),E.textContent="Delete",I=W(),m(s,"class","workflow-name svelte-1ihg8yv"),m(c,"class","workflow-desc muted small svelte-1ihg8yv"),m(g,"class","workflow-date muted small svelte-1ihg8yv"),m(i,"class","workflow-info svelte-1ihg8yv"),m(A,"class","btn small svelte-1ihg8yv"),m(E,"class","btn small svelte-1ihg8yv"),at(E,"color","#ff6b6b"),m(C,"class","workflow-actions svelte-1ihg8yv"),m(e,"class","workflow-item svelte-1ihg8yv")},m(J,$){K(J,e,$),y(e,i),y(i,s),y(s,a),y(i,u),y(i,c),y(c,d),y(i,p),y(i,g),y(g,k),y(e,P),y(e,C),y(C,A),y(C,z),y(C,E),y(e,I),D||(X=[lt(A,"click",H),lt(E,"click",j)],D=!0)},p(J,$){n=J,$[1]&4&&r!==(r=n[164].name+"")&&sn(a,r),$[1]&4&&f!==(f=(n[164].description||"No description")+"")&&sn(d,f),$[1]&4&&w!==(w=new Date(n[164].created_at).toLocaleString()+"")&&sn(k,w)},d(J){J&&Y(e),D=!1,qe(X)}}}function Jl(n){let e,i,s,r,a,u,c,f,d,p=n[42].status+"",g,w,k,P,C,A,z,E,I,D,X,H,j,J,$,st,ut,O=n[41]?"Generating...":"Generate Workflow",it,V,_t,mt,F=n[40]&&Ql(n),R=!n[42].ok&&$l();return{c(){e=T("div"),i=W(),s=T("div"),r=T("div"),a=T("h3"),a.textContent="🤖 OLLAMA AI Assistant",u=W(),c=T("div"),f=ge("Status: "),d=T("span"),g=ge(p),k=W(),P=T("div"),C=T("div"),A=T("label"),A.textContent="Describe the workflow you want to create:",z=W(),E=T("textarea"),I=W(),F&&F.c(),D=W(),R&&R.c(),X=W(),H=T("div"),j=T("button"),j.textContent="Close",J=W(),$=T("button"),$.textContent="Check Status",st=W(),ut=T("button"),it=ge(O),m(e,"class","modal-backdrop svelte-1ihg8yv"),m(a,"class","svelte-1ihg8yv"),m(d,"class",w=Ro(n[42].ok?"status-ok":"status-error")+" svelte-1ihg8yv"),m(c,"class","ollama-status svelte-1ihg8yv"),m(r,"class","modal-head svelte-1ihg8yv"),m(A,"class","svelte-1ihg8yv"),m(E,"rows","4"),m(E,"placeholder","Example: Create a workflow to process Landsat imagery, calculate NDVI, and export the results as a GeoTIFF file"),E.disabled=n[41],m(E,"class","svelte-1ihg8yv"),m(C,"class","form-row svelte-1ihg8yv"),m(P,"class","ai-chat-body svelte-1ihg8yv"),m(j,"class","btn svelte-1ihg8yv"),m($,"class","btn svelte-1ihg8yv"),m(ut,"class","btn primary svelte-1ihg8yv"),ut.disabled=V=n[41]||!n[42].ok||!n[39].trim(),m(H,"class","modal-actions svelte-1ihg8yv"),m(s,"class","modal ai-modal svelte-1ihg8yv")},m(yt,tt){K(yt,e,tt),K(yt,i,tt),K(yt,s,tt),y(s,r),y(r,a),y(r,u),y(r,c),y(c,f),y(c,d),y(d,g),y(s,k),y(s,P),y(P,C),y(C,A),y(C,z),y(C,E),pe(E,n[39]),y(P,I),F&&F.m(P,null),y(P,D),R&&R.m(P,null),y(s,X),y(s,H),y(H,j),y(H,J),y(H,$),y(H,st),y(H,ut),y(ut,it),_t||(mt=[lt(e,"click",n[133]),lt(E,"input",n[134]),lt(j,"click",n[135]),lt($,"click",n[75]),lt(ut,"click",n[77]),lt(s,"click",Un(n[79]))],_t=!0)},p(yt,tt){tt[1]&2048&&p!==(p=yt[42].status+"")&&sn(g,p),tt[1]&2048&&w!==(w=Ro(yt[42].ok?"status-ok":"status-error")+" svelte-1ihg8yv")&&m(d,"class",w),tt[1]&1024&&(E.disabled=yt[41]),tt[1]&256&&pe(E,yt[39]),yt[40]?F?F.p(yt,tt):(F=Ql(yt),F.c(),F.m(P,D)):F&&(F.d(1),F=null),yt[42].ok?R&&(R.d(1),R=null):R||(R=$l(),R.c(),R.m(P,null)),tt[1]&1024&&O!==(O=yt[41]?"Generating...":"Generate Workflow")&&sn(it,O),tt[1]&3328&&V!==(V=yt[41]||!yt[42].ok||!yt[39].trim())&&(ut.disabled=V)},d(yt){yt&&(Y(e),Y(i),Y(s)),F&&F.d(),R&&R.d(),_t=!1,qe(mt)}}}function Ql(n){let e,i,s,r,a;return{c(){e=T("div"),i=T("h4"),i.textContent="AI Response:",s=W(),r=T("pre"),a=ge(n[40]),m(i,"class","svelte-1ihg8yv"),m(r,"class","svelte-1ihg8yv"),m(e,"class","ai-response svelte-1ihg8yv")},m(u,c){K(u,e,c),y(e,i),y(e,s),y(e,r),y(r,a)},p(u,c){c[1]&512&&sn(a,u[40])},d(u){u&&Y(e)}}}function $l(n){let e;return{c(){e=T("div"),e.innerHTML='<h4 class="svelte-1ihg8yv">⚠️ OLLAMA Not Available</h4> <p>To use the AI assistant, you need to:</p> <ol><li>Install OLLAMA from <a href="https://ollama.ai" target="_blank" class="svelte-1ihg8yv">ollama.ai</a></li> <li>Run: <code class="svelte-1ihg8yv">ollama pull llama3.2:latest</code></li> <li>Start OLLAMA server: <code class="svelte-1ihg8yv">ollama serve</code></li></ol>',m(e,"class","ollama-help svelte-1ihg8yv")},m(i,s){K(i,e,s)},d(i){i&&Y(e)}}}function vd(n){let e,i=[],s=new _o,r=be(n[7]);const a=u=>u[163];for(let u=0;u<r.length;u+=1){let c=Sl(n,r,u),f=a(c);s.set(f,i[u]=ta(f,c))}return{c(){e=T("ul");for(let u=0;u<i.length;u+=1)i[u].c();m(e,"class","svelte-1ihg8yv")},m(u,c){K(u,e,c);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null)},p(u,c){c[0]&128&&(r=be(u[7]),i=vi(i,c,a,1,u,r,s,e,Ho,ta,null,Sl))},d(u){u&&Y(e);for(let c=0;c<i.length;c+=1)i[c].d()}}}function yd(n){let e;return{c(){e=T("div"),e.textContent="No logs yet. Run the pipeline to see Python prints/stdout.",m(e,"class","muted small svelte-1ihg8yv")},m(i,s){K(i,e,s)},p:Ht,d(i){i&&Y(e)}}}function ta(n,e){let i,s,r=e[161].nodeId+"",a,u,c=e[161].text+"",f,d,p;return{key:n,first:null,c(){i=T("li"),s=T("code"),a=ge(r),u=ge(" — "),f=ge(c),d=W(),m(s,"class","svelte-1ihg8yv"),m(i,"class",p=Ro(e[161].ok?"ok":"err")+" svelte-1ihg8yv"),this.first=i},m(g,w){K(g,i,w),y(i,s),y(s,a),y(i,u),y(i,f),y(i,d)},p(g,w){e=g,w[0]&128&&r!==(r=e[161].nodeId+"")&&sn(a,r),w[0]&128&&c!==(c=e[161].text+"")&&sn(f,c),w[0]&128&&p!==(p=Ro(e[161].ok?"ok":"err")+" svelte-1ihg8yv")&&m(i,"class",p)},d(g){g&&Y(i)}}}function bd(n){let e,i,s,r,a,u,c,f,d,p,g,w,k,P,C,A,z,E,I,D,X,H,j,J,$,st,ut,O,it,V,_t,mt,F=n[0]==="dark"?"Dark":"Light",R,yt,tt,Pt,Mt,vt,U,ot,Q,et,Tt,jt,ft,At,Dt,Zt,$t,ze,ae,rt,_e,Rt,zt,Ft=n[8]?"Running…":"Run",Xt,Ne,Ie,we,Ut,tn,te,cn,fe,ee,me,Ze,He,hn,je,Ue,It,Ke,Je,gn,zn,Bn,Se,De,fn,Kt,ue,Fe,_n,Xe,bn,Tn,en,Lt,Ve,wn,nn,kn,b,dt,wt,kt,Et,B,Vt,ce,Jt,Oe,dn,Re,mn,Zn,ti,Dn,En,Rn,xn,si,pt,xt,ne,vn,xe,rn,Me;function Wt(Nt,he){return Nt[2].length===0?td:$f}let Te=Wt(n),Nn=Te(n),ln=n[5]&&Zl(n);function Pn(Nt,he){return Nt[32].length===0?nd:ed}let ei=Pn(n),Ln=ei(n);nn=new Jf({props:{width:n[12],height:n[13],theme:n[0],$$slots:{default:[od]},$$scope:{ctx:n}}});let Ye=n[18]&&Gl(n),ie=n[23]&&Xl(n),Qe=n[34]&&Yl(n),an=n[35]&&ql(n),un=n[38]&&Jl(n);function ni(Nt,he){return Nt[7].length===0?yd:vd}let Wn=ni(n),Hn=Wn(n);return{c(){e=T("div"),i=T("header"),s=T("div"),r=T("button"),r.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',a=W(),u=T("div"),u.innerHTML='<span class="title svelte-1ihg8yv">SATERYS</span>',c=W(),f=T("div"),f.innerHTML='<div class="hint svelte-1ihg8yv">Build pipelines — click a node’s ◀ / ▶ to connect</div>',d=W(),p=T("div"),g=T("button"),w=Qt("svg"),k=Qt("path"),P=W(),C=T("span"),C.textContent="Run",z=W(),E=T("button"),E.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M8 7V4m8 3V4M5 11h14M7 21h10a2 2 0 002-2V8a2 2 0 00-2-2H7a2 2 0 00-2 2v11a2 2 0 002 2zm5-6v-3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span>Schedule</span>',I=W(),D=T("button"),D.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2zm2 4l3 3-3 3m5 0h5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Logs</span>',X=W(),H=T("button"),j=Qt("svg"),J=Qt("path"),$=W(),st=T("span"),st.textContent="Layers",ut=W(),O=T("button"),it=Qt("svg"),V=Qt("path"),_t=W(),mt=T("span"),R=ge(F),yt=W(),tt=T("button"),tt.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>AI Chat</span>',Pt=W(),Mt=T("button"),Mt.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z" stroke="currentColor" stroke-width="2" fill="none"></path><polyline points="17,21 17,13 7,13 7,21" stroke="currentColor" stroke-width="2" fill="none"></polyline><polyline points="7,3 7,8 15,8" stroke="currentColor" stroke-width="2" fill="none"></polyline></svg> <span>Save</span>',vt=W(),U=T("button"),U.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z" stroke="currentColor" stroke-width="2" fill="none"></path><polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" fill="none"></polyline><line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2"></line><line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2"></line><polyline points="10,9 9,9 8,9" stroke="currentColor" stroke-width="2" fill="none"></polyline></svg> <span>Load</span>',ot=W(),Q=T("button"),Q.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span>Add</span>',et=W(),Tt=T("div"),jt=T("aside"),ft=T("div"),At=T("div"),At.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M5 12h14M12 5v14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span class="txt svelte-1ihg8yv">Tools</span>',Dt=W(),Zt=T("div"),$t=T("button"),$t.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span class="txt svelte-1ihg8yv">Add Node</span>',ze=W(),ae=T("button"),rt=Qt("svg"),_e=Qt("path"),Rt=W(),zt=T("span"),Xt=ge(Ft),Ne=W(),Ie=T("button"),we=Qt("svg"),Ut=Qt("path"),tn=W(),te=T("span"),te.textContent="Clear Layers",cn=W(),fe=T("button"),ee=Qt("svg"),me=Qt("path"),Ze=W(),He=T("span"),hn=ge("Theme: "),je=ge(n[0]),Ue=W(),It=T("div"),Ke=T("div"),Ke.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 12l7-7 4 4 7-7" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span class="txt svelte-1ihg8yv">Edges</span>',Je=W(),gn=T("div"),Nn.c(),zn=W(),ln&&ln.c(),Bn=W(),Se=T("div"),De=T("div"),fn=Qt("svg"),Kt=Qt("path"),ue=W(),Fe=T("span"),Fe.textContent="Schedules",_n=W(),Xe=T("button"),Xe.textContent="↻",bn=W(),Ln.c(),en=W(),Lt=T("div"),Ve=T("div"),wn=T("div"),le(nn.$$.fragment),kn=W(),b=T("div"),dt=W(),wt=T("div"),kt=T("div"),B=W(),Ye&&Ye.c(),Vt=W(),ie&&ie.c(),ce=W(),Qe&&Qe.c(),Jt=W(),an&&an.c(),Oe=W(),un&&un.c(),dn=W(),Re=T("div"),mn=T("div"),Zn=T("div"),Zn.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2zm2 4l3 3-3 3m5 0h5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Pipeline Logs</span>',ti=W(),Dn=T("div"),En=T("button"),En.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M9 9h11v11H9zM5 5h11v11" stroke="currentColor" stroke-width="2" fill="none"></path></svg>',Rn=W(),xn=T("button"),xn.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 6h18M9 6v12m6-12v12M5 6l1-3h12l1 3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',si=W(),pt=T("button"),pt.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M6 6l12 12M6 18L18 6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',xt=W(),ne=T("div"),Hn.c(),m(r,"class","icon-btn ghost svelte-1ihg8yv"),m(r,"title","Toggle sidebar"),m(u,"class","brand svelte-1ihg8yv"),m(s,"class","left svelte-1ihg8yv"),m(f,"class","center svelte-1ihg8yv"),m(k,"d","M8 5v14l11-7z"),m(k,"fill","currentColor"),m(w,"viewBox","0 0 24 24"),m(w,"width","18"),m(w,"height","18"),m(g,"class","icon-btn svelte-1ihg8yv"),m(g,"title",A=n[8]?"Running…":"Run pipeline"),g.disabled=n[8],m(E,"class","icon-btn svelte-1ihg8yv"),m(E,"title","Schedule pipeline"),m(D,"class","icon-btn svelte-1ihg8yv"),m(D,"title","Toggle logs"),m(J,"d","M12 3l9 5-9 5-9-5 9-5zm0 8l9 5-9 5-9-5"),m(J,"stroke","currentColor"),m(J,"stroke-width","2"),m(J,"fill","none"),m(J,"stroke-linejoin","round"),m(j,"viewBox","0 0 24 24"),m(j,"width","18"),m(j,"height","18"),m(H,"class","icon-btn svelte-1ihg8yv"),m(H,"title","Clear map layers"),H.disabled=n[56].size===0,m(V,"d","M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"),m(V,"stroke","currentColor"),m(V,"stroke-width","2"),m(V,"fill","none"),m(it,"viewBox","0 0 24 24"),m(it,"width","18"),m(it,"height","18"),m(O,"class","icon-btn svelte-1ihg8yv"),m(O,"title","Toggle theme"),m(tt,"class","icon-btn svelte-1ihg8yv"),m(tt,"title","AI Chat"),m(Mt,"class","icon-btn svelte-1ihg8yv"),m(Mt,"title","Save workflow"),m(U,"class","icon-btn svelte-1ihg8yv"),m(U,"title","Load workflow"),m(Q,"class","icon-btn primary svelte-1ihg8yv"),m(Q,"title","Add node"),m(p,"class","right svelte-1ihg8yv"),m(i,"class","topbar glass svelte-1ihg8yv"),m(At,"class","section-title svelte-1ihg8yv"),m($t,"class","tool svelte-1ihg8yv"),m($t,"title","Add node"),m(_e,"d","M8 5v14l11-7z"),m(_e,"fill","currentColor"),m(rt,"viewBox","0 0 24 24"),m(rt,"width","16"),m(rt,"height","16"),m(zt,"class","txt svelte-1ihg8yv"),m(ae,"class","tool svelte-1ihg8yv"),ae.disabled=n[8],m(ae,"title","Run pipeline"),m(Ut,"d","M12 3l9 5-9 5-9-5 9-5zm0 8l9 5-9 5-9-5"),m(Ut,"stroke","currentColor"),m(Ut,"stroke-width","2"),m(Ut,"fill","none"),m(Ut,"stroke-linejoin","round"),m(we,"viewBox","0 0 24 24"),m(we,"width","16"),m(we,"height","16"),m(te,"class","txt svelte-1ihg8yv"),m(Ie,"class","tool svelte-1ihg8yv"),Ie.disabled=n[56].size===0,m(Ie,"title","Clear overlay layers"),m(me,"d","M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"),m(me,"stroke","currentColor"),m(me,"stroke-width","2"),m(me,"fill","none"),m(ee,"viewBox","0 0 24 24"),m(ee,"width","16"),m(ee,"height","16"),m(He,"class","txt svelte-1ihg8yv"),m(fe,"class","tool svelte-1ihg8yv"),m(fe,"title","Toggle theme"),m(Zt,"class","tool-list svelte-1ihg8yv"),m(ft,"class","section"),m(Ke,"class","section-title svelte-1ihg8yv"),m(gn,"class","edge-chips svelte-1ihg8yv"),m(It,"class","section"),m(Kt,"d","M6 6h12v12H6zM9 3h6M3 9h6M15 21h6M3 15h6"),m(Kt,"stroke","currentColor"),m(Kt,"stroke-width","2"),m(Kt,"fill","none"),m(Kt,"stroke-linecap","round"),m(fn,"viewBox","0 0 24 24"),m(fn,"width","16"),m(fn,"height","16"),m(Fe,"class","txt svelte-1ihg8yv"),m(Xe,"class","pill-x svelte-1ihg8yv"),m(Xe,"title","Refresh"),m(De,"class","section-title svelte-1ihg8yv"),m(Se,"class","section"),m(jt,"class","sidebar svelte-1ihg8yv"),m(jt,"data-collapsed",Tn=n[9]?"true":"false"),m(wn,"class","canvas-container svelte-1ihg8yv"),m(b,"class","drag-handle svelte-1ihg8yv"),m(b,"title","Drag to resize"),m(kt,"class","map svelte-1ihg8yv"),m(wt,"class","right svelte-1ihg8yv"),m(Ve,"class","split svelte-1ihg8yv"),at(Ve,"grid-template-columns",n[14]*100+"% 4px "+(1-n[14])*100+"%"),m(Lt,"class","work svelte-1ihg8yv"),m(Tt,"class","main svelte-1ihg8yv"),m(Tt,"data-collapsed",Et=n[9]?"true":"false"),m(Zn,"class","logs-title svelte-1ihg8yv"),m(En,"class","icon-btn svelte-1ihg8yv"),m(En,"title","Copy all"),m(xn,"class","icon-btn svelte-1ihg8yv"),m(xn,"title","Clear"),m(pt,"class","icon-btn svelte-1ihg8yv"),m(pt,"title","Close"),m(Dn,"class","logs-actions svelte-1ihg8yv"),m(mn,"class","logs-header svelte-1ihg8yv"),m(ne,"class","logs-body svelte-1ihg8yv"),m(Re,"class","logs-drawer svelte-1ihg8yv"),m(Re,"data-open",vn=n[4]?"true":"false"),m(e,"class","app-root svelte-1ihg8yv")},m(Nt,he){K(Nt,e,he),y(e,i),y(i,s),y(s,r),y(s,a),y(s,u),y(i,c),y(i,f),y(i,d),y(i,p),y(p,g),y(g,w),y(w,k),y(g,P),y(g,C),y(p,z),y(p,E),y(p,I),y(p,D),y(p,X),y(p,H),y(H,j),y(j,J),y(H,$),y(H,st),y(p,ut),y(p,O),y(O,it),y(it,V),y(O,_t),y(O,mt),y(mt,R),y(p,yt),y(p,tt),y(p,Pt),y(p,Mt),y(p,vt),y(p,U),y(p,ot),y(p,Q),y(e,et),y(e,Tt),y(Tt,jt),y(jt,ft),y(ft,At),y(ft,Dt),y(ft,Zt),y(Zt,$t),y(Zt,ze),y(Zt,ae),y(ae,rt),y(rt,_e),y(ae,Rt),y(ae,zt),y(zt,Xt),y(Zt,Ne),y(Zt,Ie),y(Ie,we),y(we,Ut),y(Ie,tn),y(Ie,te),y(Zt,cn),y(Zt,fe),y(fe,ee),y(ee,me),y(fe,Ze),y(fe,He),y(He,hn),y(He,je),y(jt,Ue),y(jt,It),y(It,Ke),y(It,Je),y(It,gn),Nn.m(gn,null),y(It,zn),ln&&ln.m(It,null),y(jt,Bn),y(jt,Se),y(Se,De),y(De,fn),y(fn,Kt),y(De,ue),y(De,Fe),y(De,_n),y(De,Xe),y(Se,bn),Ln.m(Se,null),y(Tt,en),y(Tt,Lt),y(Lt,Ve),y(Ve,wn),oe(nn,wn,null),n[102](wn),y(Ve,kn),y(Ve,b),y(Ve,dt),y(Ve,wt),y(wt,kt),n[103](kt),n[104](wt),n[105](Lt),y(e,B),Ye&&Ye.m(e,null),y(e,Vt),ie&&ie.m(e,null),y(e,ce),Qe&&Qe.m(e,null),y(e,Jt),an&&an.m(e,null),y(e,Oe),un&&un.m(e,null),y(e,dn),y(e,Re),y(Re,mn),y(mn,Zn),y(mn,ti),y(mn,Dn),y(Dn,En),y(Dn,Rn),y(Dn,xn),y(Dn,si),y(Dn,pt),y(Re,xt),y(Re,ne),Hn.m(ne,null),xe=!0,rn||(Me=[lt(r,"click",n[57]),lt(g,"click",n[47]),lt(E,"click",n[64]),lt(D,"click",n[84]),lt(H,"click",n[59]),lt(O,"click",n[85]),lt(tt,"click",n[76]),lt(Mt,"click",n[70]),lt(U,"click",n[71]),lt(Q,"click",n[48]),lt($t,"click",n[48]),lt(ae,"click",n[47]),lt(Ie,"click",n[59]),lt(fe,"click",n[86]),lt(Xe,"click",n[66]),lt(b,"mousedown",n[55]),lt(En,"click",n[136]),lt(xn,"click",n[137]),lt(pt,"click",n[138])],rn=!0)},p(Nt,he){(!xe||he[0]&256&&A!==(A=Nt[8]?"Running…":"Run pipeline"))&&m(g,"title",A),(!xe||he[0]&256)&&(g.disabled=Nt[8]),(!xe||he[0]&1)&&F!==(F=Nt[0]==="dark"?"Dark":"Light")&&sn(R,F),(!xe||he[0]&256)&&Ft!==(Ft=Nt[8]?"Running…":"Run")&&sn(Xt,Ft),(!xe||he[0]&256)&&(ae.disabled=Nt[8]),(!xe||he[0]&1)&&sn(je,Nt[0]),Te===(Te=Wt(Nt))&&Nn?Nn.p(Nt,he):(Nn.d(1),Nn=Te(Nt),Nn&&(Nn.c(),Nn.m(gn,null))),Nt[5]?ln?ln.p(Nt,he):(ln=Zl(Nt),ln.c(),ln.m(It,null)):ln&&(ln.d(1),ln=null),ei===(ei=Pn(Nt))&&Ln?Ln.p(Nt,he):(Ln.d(1),Ln=ei(Nt),Ln&&(Ln.c(),Ln.m(Se,null))),(!xe||he[0]&512&&Tn!==(Tn=Nt[9]?"true":"false"))&&m(jt,"data-collapsed",Tn);const ii={};he[0]&4096&&(ii.width=Nt[12]),he[0]&8192&&(ii.height=Nt[13]),he[0]&1&&(ii.theme=Nt[0]),he[0]&13438|he[6]&16&&(ii.$$scope={dirty:he,ctx:Nt}),nn.$set(ii),(!xe||he[0]&16384)&&at(Ve,"grid-template-columns",Nt[14]*100+"% 4px "+(1-Nt[14])*100+"%"),(!xe||he[0]&512&&Et!==(Et=Nt[9]?"true":"false"))&&m(Tt,"data-collapsed",Et),Nt[18]?Ye?Ye.p(Nt,he):(Ye=Gl(Nt),Ye.c(),Ye.m(e,Vt)):Ye&&(Ye.d(1),Ye=null),Nt[23]?ie?ie.p(Nt,he):(ie=Xl(Nt),ie.c(),ie.m(e,ce)):ie&&(ie.d(1),ie=null),Nt[34]?Qe?Qe.p(Nt,he):(Qe=Yl(Nt),Qe.c(),Qe.m(e,Jt)):Qe&&(Qe.d(1),Qe=null),Nt[35]?an?an.p(Nt,he):(an=ql(Nt),an.c(),an.m(e,Oe)):an&&(an.d(1),an=null),Nt[38]?un?un.p(Nt,he):(un=Jl(Nt),un.c(),un.m(e,dn)):un&&(un.d(1),un=null),Wn===(Wn=ni(Nt))&&Hn?Hn.p(Nt,he):(Hn.d(1),Hn=Wn(Nt),Hn&&(Hn.c(),Hn.m(ne,null))),(!xe||he[0]&16&&vn!==(vn=Nt[4]?"true":"false"))&&m(Re,"data-open",vn)},i(Nt){xe||(Z(nn.$$.fragment,Nt),xe=!0)},o(Nt){q(nn.$$.fragment,Nt),xe=!1},d(Nt){Nt&&Y(e),Nn.d(),ln&&ln.d(),Ln.d(),se(nn),n[102](null),n[103](null),n[104](null),n[105](null),Ye&&Ye.d(),ie&&ie.d(),Qe&&Qe.d(),an&&an.d(),un&&un.d(),Hn.d(),rn=!1,qe(Me)}}}const Ma=230,Ta=80;function wd(n){const e=[];if(!n||typeof n!="object")return e;for(const[i,s]of Object.entries(n))typeof s=="string"?e.push({key:i,label:i,type:"string"}):typeof s=="number"?e.push({key:i,label:i,type:"number"}):typeof s=="boolean"?e.push({key:i,label:i,type:"boolean"}):Array.isArray(s)?e.push({key:i,label:i,type:"array",itemType:typeof s[0]=="number"?"number":"string"}):e.push({key:i,label:i,type:"textarea"});return e}function kd(n,e){const i=n.map(f=>f.id),s=new Set(i),r=new Map,a=new Map;for(const f of i)r.set(f,[]),a.set(f,0);for(const f of e)!s.has(f.source)||!s.has(f.target)||(r.get(f.source).push(f.target),a.set(f.target,(a.get(f.target)||0)+1));const u=[];for(const f of i)(a.get(f)||0)===0&&u.push(f);const c=[];for(;u.length;){const f=u.shift();c.push(f);for(const d of r.get(f))a.set(d,(a.get(d)||0)-1),(a.get(d)||0)===0&&u.push(d)}return c}async function ea(n,e={}){return await(await fetch("/run_node",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nodeId:n.id,type:n.type,args:n.args??{},inputs:e})})).json().catch(()=>({ok:!1,error:"Bad JSON"}))}function na(n){return n.rows??6}function ia(n){return n.placeholder??""}function oa(n){return n.hint??"comma-separated"}function sa(n){return n.itemType??"values"}function ra(n){return n.options??[]}function la(n){return n?new Date(n).toLocaleString():"—"}async function Pd(n){await fetch(`/pipeline/schedules/${n}/run-now`,{method:"POST"}).catch(()=>{})}function Ld(n,e,i){let s="dark",r=[],a=1,u=[],c=1,f=null,d={},p=[{name:"hello",default_args:{name:"world"}},{name:"sum",default_args:{nums:[1,2,3]}},{name:"script",default_args:{code:"print('hello')"}},{name:"raster.input",default_args:{path:""}},{name:"ollama.ai",default_args:{prompt:"Create a raster processing node",model:"llama3.2:latest"}}];qn(async()=>{try{const x=await(await fetch("/node_types")).json();Array.isArray(x==null?void 0:x.types)&&i(6,p=x.types)}catch{}});const g={hello:[{key:"name",label:"Name",type:"string",placeholder:"world"}],sum:[{key:"nums",label:"Numbers",type:"array",itemType:"number",hint:"e.g., 1,2,3"}],script:[{key:"code",label:"Code",type:"textarea",rows:8,placeholder:"print('hello')"}],"raster.input":[{key:"path",label:"Raster path",type:"string",placeholder:"/path/to.tif"}],"ollama.ai":[{key:"prompt",label:"AI Prompt",type:"textarea",rows:4,placeholder:"Describe the workflow you want to create..."},{key:"model",label:"Model",type:"string",placeholder:"llama3.2:latest"},{key:"ollama_host",label:"OLLAMA Host",type:"string",placeholder:"http://localhost:11434"},{key:"temperature",label:"Temperature",type:"number",step:.1},{key:"max_tokens",label:"Max Tokens",type:"number"}]};function w(M){var Ot;const x=g[M];if(x)return x;const ct=(Ot=p.find(Ct=>Ct.name===M))==null?void 0:Ot.default_args;return wd(ct??{})}const k=M=>r.find(x=>x.id===M);function P(M,x){!k(M)||!k(x)||M===x||u.some(ct=>ct.source===M&&ct.target===x)||i(2,u=[...u,{id:`e${c++}`,source:M,target:x}])}function C(M){i(2,u=u.filter(x=>x.id!==M))}function A(M){if(jt.has(M)&&Tt&&ft){const x=jt.get(M);Tt.removeLayer(x),ft.removeLayer(x),jt.delete(M)}i(1,r=r.filter(x=>x.id!==M)),delete d[M]}function z(){const M=new Set;for(const Ct of u)M.add(Ct.source),M.add(Ct.target);const x=r.filter(Ct=>M.has(Ct.id)),ct=new Set(x.map(Ct=>Ct.id)),Ot=u.filter(Ct=>ct.has(Ct.source)&&ct.has(Ct.target));return{activeNodes:x,activeEdges:Ot}}let E=[],I=!1,D={},X=!1,H=!1;function j(M,x,ct){i(7,E=[...E,{nodeId:M,ok:x,text:ct}]),X&&requestAnimationFrame(()=>{const Ot=document.querySelector(".logs-body");Ot&&(Ot.scrollTop=Ot.scrollHeight)})}async function J(){var Ct;i(8,I=!0),i(7,E=[]),D={},i(4,X=!0);const{activeNodes:M,activeEdges:x}=z();if(M.length===0){j("system",!1,"No connected nodes to run."),i(8,I=!1);return}const ct=kd(M,x);ct.length!==M.length&&j("system",!1,"Warning: cycle detected; running partial order.");const Ot={};for(const $e of x)(Ot[Ct=$e.target]??(Ot[Ct]=[])).push($e.source);for(const $e of ct){const Fn=k($e),ri={};for(const Be of Ot[$e]??[])ri[Be]=D[Be];j($e,!0,"▶ Running…");try{const Be=await ea(Fn,ri);if(Array.isArray(Be==null?void 0:Be.logs))for(const In of Be.logs)j($e,!0,String(In));if(typeof(Be==null?void 0:Be.stdout)=="string"&&Be.stdout.trim())for(const In of Be.stdout.split(/\r?\n/))In.trim()&&j($e,!0,In);if(Be!=null&&Be.ok){const In=Be.output??{};D[$e]=In;const Ci=typeof In=="string"?In:In.text??JSON.stringify(In);j($e,!0,`✅ ${Ci}`)}else j($e,!1,`❌ ${(Be==null?void 0:Be.error)||"Unknown error"}`)}catch(Be){j($e,!1,`❌ Exception: ${(Be==null?void 0:Be.message)||Be}`)}}i(8,I=!1)}function $(){const M=`n${a++}`,x=p[0]||{name:"hello",default_args:{name:M}},ct=120+r.length%6*260,Ot=140+Math.floor(r.length/6)*140,Ct=JSON.parse(JSON.stringify(x.default_args||{})),$e=`${x.name} (${M})`;i(1,r=[...r,{id:M,position:{x:ct,y:Ot},label:$e,type:x.name,args:Ct}]),i(3,d[M]=JSON.stringify(Ct,null,2),d)}function st(M){i(5,f=M)}function ut(M){f&&P(f,M),i(5,f=null)}function O(){i(5,f=null)}const it=M=>M.position.x,V=M=>M.position.x+Ma,_t=M=>M.position.y+Ta/2;let mt="",F=null,R=1200,yt=650,tt=null,Pt=.66,Mt=!1,vt=null;function U(M){if(!Mt||!vt)return;const x=vt.getBoundingClientRect(),ct=(M.clientX-x.left)/x.width;i(14,Pt=Math.max(.2,Math.min(.8,ct)))}function ot(){Mt=!0,document.addEventListener("mousemove",U),document.addEventListener("mouseup",Q)}function Q(){Mt=!1,document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",Q)}function et(){F&&(tt&&tt.disconnect(),tt=new ResizeObserver(()=>{F&&(i(12,R=Math.max(320,Math.floor(F.clientWidth-1))),i(13,yt=Math.max(240,Math.floor(F.clientHeight-1))))}),tt.observe(F))}let Tt=null,jt=new Map,ft=null,At=null,Dt=null,Zt=null;function $t(){!Tt||!Dt||(Zt&&Zt.disconnect(),Zt=new ResizeObserver(()=>{requestAnimationFrame(()=>Tt&&Tt.invalidateSize())}),Zt.observe(Dt))}function ze(){i(9,H=!H),requestAnimationFrame(()=>Tt==null?void 0:Tt.invalidateSize())}qn(()=>{let M=!1;const x=()=>Tt&&Tt.invalidateSize();return Promise.resolve().then(async()=>{if(await da(),!M&&(et(),!Tt&&At)){Tt=gi.map(At,{zoomControl:!0,attributionControl:!1}).setView([0,0],2);const ct={"🗺️ OpenStreetMap":gi.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{opacity:.9,minZoom:1,maxZoom:22,attribution:"© OpenStreetMap contributors"}),"🌌 OSM (Dark-ish)":gi.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",{opacity:.95,minZoom:1,maxZoom:22,attribution:"© OpenStreetMap, © CartoDB"}),"🛰️ Esri World Imagery":gi.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{opacity:1,minZoom:1,maxZoom:19,attribution:"Tiles © Esri"}),"🗺️ Carto Positron":gi.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{opacity:.95,minZoom:1,maxZoom:22,attribution:"© OpenStreetMap, © CartoDB"}),"⛰️ OpenTopoMap":gi.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{opacity:.95,minZoom:1,maxZoom:17,attribution:"© OpenStreetMap, © OpenTopoMap"})};ct["🛰️ Esri World Imagery"].addTo(Tt),ft=gi.control.layers(ct,{},{position:"topright",collapsed:!1}),ft.addTo(Tt),$t(),window.addEventListener("resize",x)}}),()=>{M=!0,window.removeEventListener("resize",x),Zt==null||Zt.disconnect(),tt==null||tt.disconnect()}});function ae(M,x){var Ot;const ct=D[M.id];return ct&&typeof ct=="object"&&ct.type==="raster"&&ct.path?ct.path:M.type==="raster.input"&&typeof((Ot=r[x].args)==null?void 0:Ot.path)=="string"?r[x].args.path:null}async function rt(M,x){if(!Tt||!ft){alert("Map not ready yet.");return}const ct=ae(M,x);if(!ct){alert("No raster path available. Run the pipeline or set args.path for raster.input.");return}const Ot=M.id;await fetch("/preview/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:Ot,path:ct})});const Ct=`/preview/tile/${Ot}/{z}/{x}/{y}.png`,$e=`${M.label} (${M.id})`;if(jt.has(Ot)){const Ni=jt.get(Ot);Tt.removeLayer(Ni),ft.removeLayer(Ni),jt.delete(Ot)}const Fn=gi.tileLayer(Ct,{tms:!1,opacity:.8,maxZoom:22});jt.set(Ot,Fn),Fn.addTo(Tt),ft.addOverlay(Fn,$e);const ri=await fetch(`/preview/bounds/${Ot}`).then(Ni=>Ni.json()),[Be,In,Ci,Vo]=ri.bounds,Qi=gi.latLngBounds([In,Be],[Vo,Ci]);Tt.fitBounds(Qi,{padding:[10,10]})}function _e(){if(!(!Tt||!ft)){for(const[,M]of jt)Tt.removeLayer(M),ft.removeLayer(M);jt.clear()}}let Rt=null,zt="",Ft=[],Xt={},Ne=!1;function Ie(M){var Ot;i(18,Rt=M),i(20,Ft=w(M.type)),i(21,Xt={});const ct={...((Ot=p.find(Ct=>Ct.name===M.type))==null?void 0:Ot.default_args)??{},...M.args??{}};for(const Ct of Ft)i(21,Xt[Ct.key]=ct[Ct.key],Xt);i(19,zt=JSON.stringify(M.args??{},null,2)),i(22,Ne=!1)}function we(){if(!Rt)return;const M={};for(const x of Ft){let ct=Xt[x.key];if(x.type==="number"&&(ct=Number(ct)),x.type==="array"){if(Array.isArray(ct))M[x.key]=ct;else if(typeof ct=="string"){const Ot=ct.split(",").map(Ct=>Ct.trim()).filter(Boolean);M[x.key]=x.itemType==="number"?Ot.map(Number):Ot}else M[x.key]=[];continue}x.type==="boolean"&&(ct=!!ct),M[x.key]=ct}i(18,Rt.args=M,Rt),i(3,d[Rt.id]=JSON.stringify(M,null,2),d)}function Ut(){if(Rt)if(Ne)try{const M=JSON.parse(zt||"{}");i(18,Rt.args=M,Rt),i(3,d[Rt.id]=JSON.stringify(M,null,2),d),i(18,Rt=null)}catch{alert("Invalid JSON")}else we(),i(18,Rt=null)}const tn=M=>{const x=r.find(ct=>ct.id===M);if(!x)throw new Error(`Node not found: ${M}`);return x};let te=null;async function cn(M){i(4,X=!0),i(7,E=[]),await fe(M),te&&clearInterval(te),i(78,te=setInterval(()=>fe(M),1e3))}async function fe(M){try{const x=await fetch(`/pipeline/schedules/${M}/runs`).then(Ct=>Ct.json());if(!Array.isArray(x)||x.length===0){i(7,E=[{nodeId:"system",ok:!0,text:"(no runs yet)"}]);return}const ct=x[0],Ot=await fetch(`/pipeline/schedules/runs/${ct.id}`).then(Ct=>Ct.json());i(7,E=Ot.logs.map(Ct=>({nodeId:Ot.status==="running"?"run":Ot.status==="success"?"ok":"err",ok:!/❌|exception/i.test(Ct),text:Ct}))),Ot.status!=="running"&&te&&(clearInterval(te),i(78,te=null))}catch{i(7,E=[{nodeId:"system",ok:!1,text:"Failed to fetch run logs"}])}}fo(()=>{te&&clearInterval(te)});let ee=!1,me="once",Ze="",He=0,hn=0,je=0,Ue="0 5 * * *",It=!1,Ke="",Je=[];function gn(){const{activeNodes:M}=z();if(M.length===0){alert("No connected nodes to schedule. Connect nodes with edges first.");return}i(23,ee=!0),i(24,me="once"),i(25,Ze=""),i(26,He=i(27,hn=i(28,je=0))),i(29,Ue="0 5 * * *"),i(31,Ke="")}function zn(){const{activeNodes:M,activeEdges:x}=z(),ct=M.map(Ct=>({id:Ct.id,type:Ct.type,args:Ct.args??{}})),Ot=x.map(Ct=>({source:Ct.source,target:Ct.target}));return{nodes:ct,edges:Ot}}async function Bn(){const M=zn();if(M.nodes.length===0){i(31,Ke="Nothing to schedule (empty graph).");return}const x={mode:me,graph:M};if(me==="once"){if(!Ze){i(31,Ke="Please pick a date & time.");return}x.run_at=new Date(Ze).toISOString()}else if(me==="interval"){if(x.hours=Number(He)||0,x.minutes=Number(hn)||0,x.seconds=Number(je)||0,!(x.hours||x.minutes||x.seconds)){i(31,Ke="Interval must be > 0.");return}}else if(x.cron=(Ue||"").trim(),!x.cron){i(31,Ke="Cron expression is required.");return}i(30,It=!0),i(31,Ke="");try{const ct=await fetch("/pipeline/schedules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)});if(!ct.ok)throw new Error(`HTTP ${ct.status}`);await ct.json(),i(23,ee=!1),await Se()}catch(ct){i(31,Ke=`Failed to create schedule: ${(ct==null?void 0:ct.message)||ct}`)}finally{i(30,It=!1)}}async function Se(){try{const M=await fetch("/pipeline/schedules");if(M.ok){i(32,Je=await M.json());return}}catch{}try{const M=await fetch("/schedules");M.ok&&i(32,Je=await M.json())}catch{}}async function De(M){await fetch(`/pipeline/schedules/${M}`,{method:"DELETE"}).catch(()=>{}),await Se()}async function fn(M){await fetch(`/pipeline/schedules/${M}/pause`,{method:"POST"}).catch(()=>{}),await Se()}async function Kt(M){await fetch(`/pipeline/schedules/${M}/resume`,{method:"POST"}).catch(()=>{}),await Se()}qn(async()=>{await Se().catch(()=>{})});let ue=[],Fe=!1,_n=!1,Xe="",bn="";async function Tn(){try{const x=await(await fetch("/workflows")).json();i(33,ue=x.workflows||[])}catch(M){console.error("Failed to load workflows:",M)}}function en(){i(36,Xe=""),i(37,bn=""),i(34,Fe=!0)}function Lt(){Tn(),i(35,_n=!0)}async function Ve(){if(!Xe.trim()){alert("Please enter a workflow name");return}try{const x=await(await fetch("/workflows",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:Xe,description:bn,nodes:r.map(ct=>({id:ct.id,type:ct.type,position:ct.position,label:ct.label,args:ct.args})),edges:u.map(ct=>({id:ct.id,source:ct.source,target:ct.target}))})})).json();x.ok?(i(34,Fe=!1),alert(`Workflow "${Xe}" saved successfully!`)):alert(`Failed to save workflow: ${x.error}`)}catch(M){alert(`Error saving workflow: ${M}`)}}async function wn(M){try{const ct=await(await fetch(`/workflows/${M}`)).json();if(ct.ok&&ct.workflow){const Ot=ct.workflow;i(1,r=[]),i(2,u=[]),i(3,d={}),i(1,r=Ot.nodes.map(Ct=>({id:Ct.id,type:Ct.type,position:Ct.position,label:Ct.label,args:Ct.args||{}}))),i(2,u=Ot.edges.map(Ct=>({id:Ct.id,source:Ct.source,target:Ct.target})));for(const Ct of r)i(3,d[Ct.id]=JSON.stringify(Ct.args||{},null,2),d);i(35,_n=!1),alert(`Workflow "${M}" loaded successfully!`)}else alert(`Failed to load workflow: ${ct.error||"Unknown error"}`)}catch(x){alert(`Error loading workflow: ${x}`)}}async function nn(M){if(confirm(`Are you sure you want to delete workflow "${M}"?`))try{const ct=await(await fetch(`/workflows/${M}`,{method:"DELETE"})).json();ct.ok?(Tn(),alert(`Workflow "${M}" deleted successfully!`)):alert(`Failed to delete workflow: ${ct.error}`)}catch(x){alert(`Error deleting workflow: ${x}`)}}let kn=!1,b="",dt="",wt=!1,kt={ok:!1,status:"unknown",available_models:[]};async function Et(){try{const M=await fetch("/ollama/status");i(42,kt=await M.json())}catch{i(42,kt={ok:!1,status:"error",message:"Connection failed"})}}function B(){i(38,kn=!0),Et()}async function Vt(){if(!b.trim()){alert("Please enter a prompt");return}i(41,wt=!0),i(40,dt="");try{const x=await(await fetch("/ollama/generate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({prompt:b,model:"llama3.2:latest",temperature:.7,max_tokens:1e3})})).json();if(x.success&&x.workflow_suggestion){const ct=x.workflow_suggestion;i(40,dt=`${x.ai_response}

--- Suggested Workflow ---
${JSON.stringify(ct,null,2)}`),confirm("AI has generated a workflow suggestion. Would you like to add it to the canvas?")&&ce(ct)}else x.ai_response?i(40,dt=x.ai_response):i(40,dt=`Error: ${x.error||"Unknown error"}`)}catch(M){i(40,dt=`Error: ${M}`)}finally{i(41,wt=!1)}}function ce(M){if(!M.nodes||!Array.isArray(M.nodes)){alert("Invalid workflow suggestion format");return}const x=120+r.length%6*260,ct=140+Math.floor(r.length/6)*140,Ot=new Map;M.nodes.forEach((Ct,$e)=>{const Fn=`ai_n${a++}`;Ot.set(Ct.id||$e,Fn);const ri=x+$e%3*260,Be=ct+Math.floor($e/3)*140,In=p.find(Ci=>Ci.name===Ct.type)||p[0];i(1,r=[...r,{id:Fn,position:{x:ri,y:Be},label:Ct.label||`${Ct.type} (${Fn})`,type:Ct.type,args:Ct.args||In.default_args||{}}]),i(3,d[Fn]=JSON.stringify(Ct.args||In.default_args||{},null,2),d)}),M.edges&&Array.isArray(M.edges)&&M.edges.forEach(Ct=>{const $e=Ot.get(Ct.source),Fn=Ot.get(Ct.target);$e&&Fn&&i(2,u=[...u,{id:`ai_e${c++}`,source:$e,target:Fn}])}),i(38,kn=!1),i(39,b=""),alert("AI workflow suggestion applied to canvas!")}qn(async()=>{await Se().catch(()=>{}),await Tn().catch(()=>{})});function Jt(M){We.call(this,n,M)}function Oe(M){We.call(this,n,M)}function dn(M){We.call(this,n,M)}function Re(M){We.call(this,n,M)}function mn(M){We.call(this,n,M)}const Zn=()=>i(4,X=!X),ti=()=>i(0,s=s==="dark"?"light":"dark"),Dn=()=>i(0,s=s==="dark"?"light":"dark"),En=M=>C(M.id),Rn=M=>{Pd(M.id),cn(M.id)},xn=M=>fn(M.id),si=M=>Kt(M.id),pt=M=>cn(M.id),xt=M=>De(M.id),ne=M=>ut(M.id),vn=M=>st(M.id),xe=M=>A(M.id);function rn(M){r[M].type=os(this),i(1,r),i(6,p)}const Me=(M,x)=>{const ct=p.find(Ct=>Ct.name===r[M].type),Ot=(ct==null?void 0:ct.default_args)??{};i(1,r[M].args=JSON.parse(JSON.stringify(Ot)),r),i(1,r[M].label=`${r[M].type} (${x.id})`,r),i(3,d[x.id]=JSON.stringify(r[M].args,null,2),d)},Wt=M=>Ie(M),Te=(M,x)=>rt(M,x),Nn=async M=>{var x;try{const ct=await ea(M,{});i(4,X=!0),j(M.id,!!(ct!=null&&ct.ok),ct!=null&&ct.ok?((x=ct==null?void 0:ct.output)==null?void 0:x.message)||"Started":(ct==null?void 0:ct.error)||"Error")}catch(ct){j(M.id,!1,`Exception: ${typeof ct=="object"&&ct!==null&&"message"in ct?ct.message:String(ct)}`),i(4,X=!0)}};function ln(M,x){n.$$.not_equal(r[x].position,M)&&(r[x].position=M,i(1,r))}function Pn(M){Kn[M?"unshift":"push"](()=>{F=M,i(11,F)})}function ei(M){Kn[M?"unshift":"push"](()=>{At=M,i(16,At)})}function Ln(M){Kn[M?"unshift":"push"](()=>{Dt=M,i(17,Dt)})}function Ye(M){Kn[M?"unshift":"push"](()=>{vt=M,i(15,vt)})}const ie=()=>i(18,Rt=null),Qe=()=>i(22,Ne=!1),an=()=>i(22,Ne=!0);function un(M){Xt[M.key]=this.value,i(21,Xt),i(20,Ft)}function ni(M){Xt[M.key]=wi(this.value),i(21,Xt),i(20,Ft)}function Wn(M){Xt[M.key]=this.checked,i(21,Xt),i(20,Ft)}function Hn(M){Xt[M.key]=this.value,i(21,Xt),i(20,Ft)}function Nt(M){Xt[M.key]=this.value,i(21,Xt),i(20,Ft)}function he(M){Xt[M.key]=os(this),i(21,Xt),i(20,Ft)}function ii(){zt=this.value,i(19,zt)}const Ui=()=>i(18,Rt=null),zi=()=>i(23,ee=!1);function mo(){me=os(this),i(24,me)}function Xi(){Ze=this.value,i(25,Ze)}function jo(){He=wi(this.value),i(26,He)}function qt(){hn=wi(this.value),i(27,hn)}function Jn(){je=wi(this.value),i(28,je)}function Ge(){Ue=this.value,i(29,Ue)}const po=()=>i(23,ee=!1),Vi=()=>i(34,Fe=!1);function Yi(){Xe=this.value,i(36,Xe)}function qi(){bn=this.value,i(37,bn)}const hi=()=>i(34,Fe=!1),Ki=()=>i(35,_n=!1),Li=M=>wn(M.name),An=M=>nn(M.name),fi=()=>i(35,_n=!1),go=()=>i(38,kn=!1);function vo(){b=this.value,i(39,b)}const Uo=()=>i(38,kn=!1),yo=()=>navigator.clipboard.writeText(E.map(M=>`[${M.nodeId}] ${M.ok?"OK":"ERR"} ${M.text}`).join(`
`)),Ji=()=>i(7,E=[]),Xo=()=>i(4,X=!1);return n.$$.update=()=>{if(n.$$.dirty[0]&1&&document!=null&&document.body&&(document.body.dataset.theme=s),n.$$.dirty[0]&10){for(const M of r)if(d[M.id]===void 0)try{i(3,d[M.id]=JSON.stringify(M.args??{},null,2),d)}catch{i(3,d[M.id]="{}",d)}}if(n.$$.dirty[0]&6){const M=new Set(r.map(ct=>ct.id)),x=u.filter(ct=>M.has(ct.source)&&M.has(ct.target));x.length!==u.length&&i(2,u=x)}n.$$.dirty[0]&2&&i(10,mt=r.map(M=>`${M.id}:${M.position.x},${M.position.y}`).join("|")),n.$$.dirty[0]&16|n.$$.dirty[2]&65536&&!X&&te&&(clearInterval(te),i(78,te=null))},[s,r,u,d,X,f,p,E,I,H,mt,F,R,yt,Pt,vt,At,Dt,Rt,zt,Ft,Xt,Ne,ee,me,Ze,He,hn,je,Ue,It,Ke,Je,ue,Fe,_n,Xe,bn,kn,b,dt,wt,kt,k,C,A,j,J,$,st,ut,O,it,V,_t,ot,jt,ze,rt,_e,Ie,Ut,tn,cn,gn,Bn,Se,De,fn,Kt,en,Lt,Ve,wn,nn,Et,B,Vt,te,Jt,Oe,dn,Re,mn,Zn,ti,Dn,En,Rn,xn,si,pt,xt,ne,vn,xe,rn,Me,Wt,Te,Nn,ln,Pn,ei,Ln,Ye,ie,Qe,an,un,ni,Wn,Hn,Nt,he,ii,Ui,zi,mo,Xi,jo,qt,Jn,Ge,po,Vi,Yi,qi,hi,Ki,Li,An,fi,go,vo,Uo,yo,Ji,Xo]}class Cd extends Mn{constructor(e){super(),Sn(this,e,Ld,bd,pn,{},null,[-1,-1,-1,-1,-1,-1,-1])}}new Cd({target:document.getElementById("app")});export{fo as $,se as A,ma as B,pa as C,oe as D,le as E,bt as F,qe as G,sn as H,Un as I,ge as J,as as K,ke as L,Le as M,Ce as N,Pe as O,rr as P,Vn as Q,lc as R,Mn as S,pe as T,wi as U,Gi as V,Yn as W,Ei as X,os as Y,nt as Z,Kn as _,at as a,Do as a0,Qt as a1,ci as a2,Ho as a3,K as b,m as c,Y as d,T as e,gt as f,yn as g,be as h,Sn as i,q as j,Z as k,lt as l,ve as m,Ht as n,qn as o,co as p,ye as q,y as r,pn as s,Yt as t,vi as u,W as v,de as w,Fo as x,Ee as y,bs as z};
