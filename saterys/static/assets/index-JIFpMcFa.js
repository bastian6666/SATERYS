const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Controls-nCVS46AE.js","assets/Icon-Dp5k5dFM.js","assets/DrawerController-Ceo4GJ9R.js","assets/DrawerController-ZXfKNTdC.css"])))=>i.map(i=>d[i]);
var cu=Object.defineProperty;var hu=(n,e,i)=>e in n?cu(n,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[e]=i;var Fo=(n,e,i)=>hu(n,typeof e!="symbol"?e+"":e,i);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&s(u)}).observe(document,{childList:!0,subtree:!0});function i(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function s(r){if(r.ep)return;r.ep=!0;const l=i(r);fetch(r.href,l)}})();function Ut(){}function rs(n,e){for(const i in e)n[i]=e[i];return n}function Ka(n){return n()}function qs(){return Object.create(null)}function fn(n){n.forEach(Ka)}function so(n){return typeof n=="function"}function mn(n,e){return n!=n?e==e:n!==e||n&&typeof n=="object"||typeof n=="function"}function fu(n){return Object.keys(n).length===0}function yn(n,...e){if(n==null){for(const s of e)s(void 0);return Ut}const i=n.subscribe(...e);return i.unsubscribe?()=>i.unsubscribe():i}function bt(n){let e;return yn(n,i=>e=i)(),e}function vt(n,e,i){n.$$.on_destroy.push(yn(e,i))}function Me(n,e,i,s){if(n){const r=Ja(n,e,i,s);return n[0](r)}}function Ja(n,e,i,s){return n[1]&&s?rs(i.ctx.slice(),n[1](s(e))):i.ctx}function Te(n,e,i,s){if(n[2]&&s){const r=n[2](s(i));if(e.dirty===void 0)return r;if(typeof r=="object"){const l=[],u=Math.max(e.dirty.length,r.length);for(let c=0;c<u;c+=1)l[c]=e.dirty[c]|r[c];return l}return e.dirty|r}return e.dirty}function Ee(n,e,i,s,r,l){if(r){const u=Ja(e,i,s,l);n.p(u,r)}}function Ae(n){if(n.ctx.length>32){const e=[],i=n.ctx.length/32;for(let s=0;s<i;s++)e[s]=-1;return e}return-1}function as(n){const e={};for(const i in n)e[i]=!0;return e}function Vs(n){return n??""}function Zt(n,e,i){return n.set(i),e}function Si(n){return n&&so(n.destroy)?n.destroy:Ut}const du=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function b(n,e){n.appendChild(e)}function Q(n,e,i){n.insertBefore(e,i||null)}function Y(n){n.parentNode&&n.parentNode.removeChild(n)}function Ai(n,e){for(let i=0;i<n.length;i+=1)n[i]&&n[i].d(e)}function T(n){return document.createElement(n)}function oe(n){return document.createElementNS("http://www.w3.org/2000/svg",n)}function Be(n){return document.createTextNode(n)}function X(){return Be(" ")}function Ze(){return Be("")}function ft(n,e,i,s){return n.addEventListener(e,i,s),()=>n.removeEventListener(e,i,s)}function Vn(n){return function(e){return e.preventDefault(),n.call(this,e)}}function ni(n){return function(e){return e.stopPropagation(),n.call(this,e)}}function to(n){return function(e){e.target===this&&n.call(this,e)}}function m(n,e,i){i==null?n.removeAttribute(e):n.getAttribute(e)!==i&&n.setAttribute(e,i)}function Ci(n){return n===""?null:+n}function _u(n){return Array.from(n.childNodes)}function _n(n,e){e=""+e,n.data!==e&&(n.data=e)}function Oe(n,e){n.value=e??""}function at(n,e,i,s){i==null?n.style.removeProperty(e):n.style.setProperty(e,i,"")}function Fi(n,e,i){for(let s=0;s<n.options.length;s+=1){const r=n.options[s];if(r.__value===e){r.selected=!0;return}}(!i||e!==void 0)&&(n.selectedIndex=-1)}function Go(n){const e=n.querySelector(":checked");return e&&e.__value}let wo;function mu(){if(wo===void 0){wo=!1;try{typeof window<"u"&&window.parent&&window.parent.document}catch{wo=!0}}return wo}function pu(n,e){getComputedStyle(n).position==="static"&&(n.style.position="relative");const s=T("iframe");s.setAttribute("style","display: block; position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; border: 0; opacity: 0; pointer-events: none; z-index: -1;"),s.setAttribute("aria-hidden","true"),s.tabIndex=-1;const r=mu();let l;return r?(s.src="data:text/html,<script>onresize=function(){parent.postMessage(0,'*')}<\/script>",l=ft(window,"message",u=>{u.source===s.contentWindow&&e()})):(s.src="about:blank",s.onload=()=>{l=ft(s.contentWindow,"resize",e),e()}),b(n,s),()=>{(r||l&&s.contentWindow)&&l(),Y(s)}}function te(n,e,i){n.classList.toggle(e,!!i)}function gu(n,e,{bubbles:i=!1,cancelable:s=!1}={}){return new CustomEvent(n,{detail:e,bubbles:i,cancelable:s})}function di(n,e){return new n(e)}let io;function eo(n){io=n}function Ni(){if(!io)throw new Error("Function called outside component initialization");return io}function vu(n){Ni().$$.before_update.push(n)}function Xn(n){Ni().$$.on_mount.push(n)}function Qa(n){Ni().$$.after_update.push(n)}function ro(n){Ni().$$.on_destroy.push(n)}function Gi(){const n=Ni();return(e,i,{cancelable:s=!1}={})=>{const r=n.$$.callbacks[e];if(r){const l=gu(e,i,{cancelable:s});return r.slice().forEach(u=>{u.call(n,l)}),!l.defaultPrevented}return!0}}function Ie(n,e){return Ni().$$.context.set(n,e),e}function ve(n){return Ni().$$.context.get(n)}function Ve(n,e){const i=n.$$.callbacks[e.type];i&&i.slice().forEach(s=>s.call(this,e))}const Hi=[],ii=[];let Wi=[];const ts=[],$a=Promise.resolve();let es=!1;function tl(){es||(es=!0,$a.then(nl))}function el(){return tl(),$a}function zi(n){Wi.push(n)}function yu(n){ts.push(n)}const Uo=new Set;let xi=0;function nl(){if(xi!==0)return;const n=io;do{try{for(;xi<Hi.length;){const e=Hi[xi];xi++,eo(e),bu(e.$$)}}catch(e){throw Hi.length=0,xi=0,e}for(eo(null),Hi.length=0,xi=0;ii.length;)ii.pop()();for(let e=0;e<Wi.length;e+=1){const i=Wi[e];Uo.has(i)||(Uo.add(i),i())}Wi.length=0}while(Hi.length);for(;ts.length;)ts.pop()();es=!1,Uo.clear(),eo(n)}function bu(n){if(n.fragment!==null){n.update(),fn(n.before_update);const e=n.dirty;n.dirty=[-1],n.fragment&&n.fragment.p(n.ctx,e),n.after_update.forEach(zi)}}function wu(n){const e=[],i=[];Wi.forEach(s=>n.indexOf(s)===-1?e.push(s):i.push(s)),i.forEach(s=>s()),Wi=e}const Co=new Set;let Ti;function ke(){Ti={r:0,c:[],p:Ti}}function Pe(){Ti.r||fn(Ti.c),Ti=Ti.p}function Z(n,e){n&&n.i&&(Co.delete(n),n.i(e))}function W(n,e,i,s){if(n&&n.o){if(Co.has(n))return;Co.add(n),Ti.c.push(()=>{Co.delete(n),s&&(i&&n.d(1),s())}),n.o(e)}else s&&s()}function Le(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function ao(n,e){n.d(1),e.delete(n.key)}function oo(n,e){W(n,1,1,()=>{e.delete(n.key)})}function _i(n,e,i,s,r,l,u,c,f,d,p,g){let w=n.length,k=l.length,P=w;const M={};for(;P--;)M[n[P].key]=P;const A=[],z=new Map,E=new Map,B=[];for(P=k;P--;){const lt=g(r,l,P),K=i(lt);let tt=u.get(K);tt?B.push(()=>tt.p(lt,e)):(tt=d(K,lt),tt.c()),z.set(K,A[P]=tt),K in M&&E.set(K,Math.abs(P-M[K]))}const H=new Set,F=new Set;function G(lt){Z(lt,1),lt.m(c,p),u.set(lt.key,lt),p=lt.first,k--}for(;w&&k;){const lt=A[k-1],K=n[w-1],tt=lt.key,st=K.key;lt===K?(p=lt.first,w--,k--):z.has(st)?!u.has(tt)||H.has(tt)?G(lt):F.has(st)?w--:E.get(tt)>E.get(st)?(F.add(tt),G(lt)):(H.add(st),w--):(f(K,u),w--)}for(;w--;){const lt=n[w];z.has(lt.key)||f(lt,u)}for(;k;)G(A[k-1]);return fn(B),A}function il(n,e){const i={},s={},r={$$scope:1};let l=n.length;for(;l--;){const u=n[l],c=e[l];if(c){for(const f in u)f in c||(s[f]=1);for(const f in c)r[f]||(i[f]=c[f],r[f]=1);n[l]=c}else for(const f in u)r[f]=1}for(const u in s)u in i||(i[u]=void 0);return i}function ol(n){return typeof n=="object"&&n!==null?n:{}}function ku(n,e,i){const s=n.$$.props[e];s!==void 0&&(n.$$.bound[s]=i,i(n.$$.ctx[s]))}function _e(n){n&&n.c()}function ue(n,e,i){const{fragment:s,after_update:r}=n.$$;s&&s.m(e,i),zi(()=>{const l=n.$$.on_mount.map(Ka).filter(so);n.$$.on_destroy?n.$$.on_destroy.push(...l):fn(l),n.$$.on_mount=[]}),r.forEach(zi)}function ce(n,e){const i=n.$$;i.fragment!==null&&(wu(i.after_update),fn(i.on_destroy),i.fragment&&i.fragment.d(e),i.on_destroy=i.fragment=null,i.ctx=[])}function Pu(n,e){n.$$.dirty[0]===-1&&(Hi.push(n),tl(),n.$$.dirty.fill(0)),n.$$.dirty[e/31|0]|=1<<e%31}function Ln(n,e,i,s,r,l,u=null,c=[-1]){const f=io;eo(n);const d=n.$$={fragment:null,ctx:[],props:l,update:Ut,not_equal:r,bound:qs(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:qs(),dirty:c,skip_bound:!1,root:e.target||f.$$.root};u&&u(d.root);let p=!1;if(d.ctx=i?i(n,e.props||{},(g,w,...k)=>{const P=k.length?k[0]:w;return d.ctx&&r(d.ctx[g],d.ctx[g]=P)&&(!d.skip_bound&&d.bound[g]&&d.bound[g](P),p&&Pu(n,g)),w}):[],d.update(),p=!0,fn(d.before_update),d.fragment=s?s(d.ctx):!1,e.target){if(e.hydrate){const g=_u(e.target);d.fragment&&d.fragment.l(g),g.forEach(Y)}else d.fragment&&d.fragment.c();e.intro&&Z(n.$$.fragment),ue(n,e.target,e.anchor),nl()}eo(f)}class Cn{constructor(){Fo(this,"$$");Fo(this,"$$set")}$destroy(){ce(this,1),this.$destroy=Ut}$on(e,i){if(!so(i))return Ut;const s=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return s.push(i),()=>{const r=s.indexOf(i);r!==-1&&s.splice(r,1)}}$set(e){this.$$set&&!fu(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Lu="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Lu);const ji=[];function Mo(n,e){return{subscribe:$(n,e).subscribe}}function $(n,e=Ut){let i;const s=new Set;function r(c){if(mn(n,c)&&(n=c,i)){const f=!ji.length;for(const d of s)d[1](),ji.push(d,n);if(f){for(let d=0;d<ji.length;d+=2)ji[d][0](ji[d+1]);ji.length=0}}}function l(c){r(c(n))}function u(c,f=Ut){const d=[c,f];return s.add(d),s.size===1&&(i=e(r,l)||Ut),c(n),()=>{s.delete(d),s.size===0&&i&&(i(),i=null)}}return{set:r,update:l,subscribe:u}}function no(n,e,i){const s=!Array.isArray(n),r=s?[n]:n;if(!r.every(Boolean))throw new Error("derived() expects stores as input, got a falsy value");const l=e.length<2;return Mo(i,(u,c)=>{let f=!1;const d=[];let p=0,g=Ut;const w=()=>{if(p)return;g();const P=e(s?d[0]:d,u,c);l?u(P):g=so(P)?P:Ut},k=r.map((P,M)=>yn(P,A=>{d[M]=A,p&=~(1<<M),f&&w()},()=>{p|=1<<M}));return f=!0,w(),function(){fn(k),g(),f=!1}})}function To(){const n=new Map,{subscribe:e,set:i,update:s}=$(n);return{subscribe:e,set:i,update:s,add:(l,u)=>(s(c=>(c.set(u,l),c)),n),get:l=>n.get(l)||null,getAll:()=>Array.from(n.values()),delete:l=>{let u=!1;return s(c=>(c.delete(l),u=!0,c)),u},count:()=>n.size}}function Cu(n){const{id:e,inputs:i,outputs:s,resizable:r,dimensions:l,editable:u,direction:c,zIndex:f,position:d,selectionColor:p,borderWidth:g,edge:w}=n,{bgColor:k,borderColor:P,rotation:M,borderRadius:A,connections:z,textColor:E,locked:B,group:H}=n,F=To(),G=(tt="self")=>{bt(F).forEach(st=>{(tt==="self"||bt(st.direction)===tt)&&st.recalculatePosition()})};return{id:typeof e=="string"&&e.slice(0,2)==="N-"?e:`N-${e}`,position:$({x:(d==null?void 0:d.x)||0,y:(d==null?void 0:d.y)||0}),dimensions:{width:$((l==null?void 0:l.width)||0),height:$((l==null?void 0:l.height)||(l==null?void 0:l.width))},group:$(H||null),locked:$(B||!1),inputs:$(i),outputs:$(s),recalculateAnchors:G,rotation:$(M||0),moving:$(!1),resizingWidth:$(!1),resizingHeight:$(!1),rotating:$(!1),editable:$(u||!1),resizable:$(r),anchors:F,zIndex:$(f||2),collapsed:$(!1),edge:w||null,borderRadius:$(A),bgColor:$(k||null),direction:$(c),label:$(n.label||""),borderColor:$(P||null),borderWidth:$(g),selectionColor:$(p||null),textColor:$(E||null),connections:$(z)}}const Su=10,Mu=100,Tu=50,Eu="#000",Au="#fff",zu="12px",Nu=22,Iu=1.4,Ou=40;function Bu(n,e){const i=[n,e].sort();return`${i[0]}+${i[1]}`}function Xs(n,e,i){var c,f,d,p,g;const{source:s,target:r}=n,u={id:s.id&&r.id?Bu(s.id,r.id):"cursor",target:n.target,source:n.source,component:e,type:$((i==null?void 0:i.type)||null),color:(i==null?void 0:i.color)||$(null),width:$((i==null?void 0:i.width)||0),animated:$((i==null?void 0:i.animated)||!1),rendered:$(!1),start:(i==null?void 0:i.start)||null,end:(i==null?void 0:i.end)||null};if(i!=null&&i.disconnect&&(u.disconnect=!0),i!=null&&i.label){const w={text:$(i==null?void 0:i.label.text),color:$(((c=i==null?void 0:i.label)==null?void 0:c.color)||Eu),textColor:$(((f=i==null?void 0:i.label)==null?void 0:f.textColor)||Au),fontSize:$(((d=i==null?void 0:i.label)==null?void 0:d.fontSize)||zu),dimensions:{width:$(((p=i==null?void 0:i.label.dimensions)==null?void 0:p.width)||Mu),height:$(((g=i==null?void 0:i.label.dimensions)==null?void 0:g.height)||Tu)},borderRadius:$((i==null?void 0:i.label.borderRadius)||Su)};u.label=w}return u}function Zu(){const n=new Map,e=new Set,{subscribe:i,set:s,update:r}=$(n),l={subscribe:i,set:s,update:r,add:(u,c)=>{if(typeof c!="string"){const f=Array.from(c),d=f[0],p=f[1];if(d.connected.update(g=>g.add(p)),p.connected.update(g=>g.add(d)),l.match(...Array.from(c)).length)return;e.forEach(g=>g(u,"connection"))}r(f=>(f.set(c,u),f))},getAll:()=>Array.from(n.values()),get:u=>n.get(u)||null,match:(...u)=>Array.from(n.keys()).filter(c=>c==="cursor"?!1:u.every(f=>f?c.has(f):!0)),fetch:(u,c)=>{const f=Array.from(n.keys()).filter(d=>d==="cursor"?!1:[u,c].every(p=>p?d.has(p):!0))[0];return n.get(f)||null},delete:u=>{if(typeof u!="string"){const f=Array.from(u),d=f[0],p=f[1];d.connected.update(g=>(g.delete(p),g)),p.connected.update(g=>(g.delete(d),g))}let c=!1;return r(f=>{const d=f.get(u);return d&&(f.delete(u),c=!0,typeof u!="string"&&e.forEach(p=>p(d,"disconnection"))),f}),c},onEdgeChange:u=>(e.add(u),()=>e.delete(u)),count:()=>n.size};return l}function Du(n,e){const i=n.clientX-e.clientX,s=n.clientY-e.clientY;return Math.sqrt(i*i+s*s)}function Ru(){const n=()=>Math.floor(Math.random()*256),e=n(),i=n(),s=n();return`rgb(${e},${i},${s})`}const xu={"(":"round","[":"square","([":"stadium","[[":"subroutine","[(":"cylindrical","((":"circle","{":"rhombus","{{":"hexagon"},Ys={"-":"straight","~":"bezier"},sl={"(":")","[":"]","{":"}"},ju=/[-=~]*>(?:\s*\|(.+?)\|)?/g,Hu=n=>{const e=n.split(`
`),i={parentNodes:[],nodeList:{}};for(const s of e){const{parentNodes:r,childNodes:l,edge:u}=Wu(s);for(const c of r){i.nodeList[c.id]||i.parentNodes.push(c);for(const f of l){if(i.nodeList[c.id]){if(i.nodeList[f.id]&&i.nodeList[f.id].children.some(({node:d})=>d.id===c.id))throw new Error("Circular reference detected");i.nodeList[c.id].children.push({node:i.nodeList[f.id]||f,...u})}else c.children.push({node:i.nodeList[f.id]||f,...u}),i.nodeList[c.id]=c;i.nodeList[f.id]?i.nodeList[f.id].parents.push({node:i.nodeList[c.id]||c}):(f.parents.push({node:i.nodeList[c.id]||c}),i.nodeList[f.id]=f),i.parentNodes=i.parentNodes.filter(d=>d.id!==f.id)}}}return i},Wu=n=>{const e=[],i=[],s=n.trim();let r="";const l=s.match(ju);if(l)r=l[0];else throw new Error("Invalid edge");const[u,c]=s.split(r);for(const d of u.split("&"))e.push(Ks(d));for(const d of c.split("&"))i.push(Ks(d));const f=Fu(r);return{parentNodes:e,childNodes:i,edge:f}},Ks=n=>{n=n.trim();const e=n[0],i=n.slice(1);let s="",r="";const l="Default",u={shape:""},c=[];for(let f=0;f<i.length;f++)if(Gu(i[f]))c.push(i[f]);else if(sl[c[c.length-1]]===i[f]){r=xu[c.join("")];break}else s+=i[f];return u.shape=r,u.content=s,{id:e,data:u,type:l,children:[],parents:[],depth:0,nesting:0}},Fu=n=>{n=n.trim();let e="";const[i,s]=n.split("|"),r=i[0];if(r in Ys)e=Ys[r];else throw new Error("Not a valid edge type");return s?{shape:e,content:s.trim(),length:Math.floor((i.trim().length-1)/2)}:{shape:e,length:Math.floor((i.trim().length-1)/2)}};function Gu(n){return n in sl}function Uu(){return Math.random().toString(36).substring(7)}function qu(n,e){const i=Math.sign(n.x).toString(),s=Math.sign(n.y).toString(),r=Math.sign(e.x).toString(),l=Math.sign(e.y).toString();return`${i}${s}${r}${l}`}function Vu(n,e){return{1001:`a ${n} ${n} 0 0 1 ${n} ${n}`,"0110":`a ${n} ${n} 0 0 0 ${n} ${n}`,"100-1":`a ${n} ${n} 0 0 0 ${n} -${n}`,"0-110":`a ${n} ${n} 0 0 1 ${n} -${n}`,"-1001":`a ${n} ${n} 0 0 0 -${n} ${n}`,"01-10":`a ${n} ${n} 0 0 1 -${n} ${n}`,"-100-1":`a ${n} ${n} 0 0 1 -${n} -${n}`,"0-1-10":`a ${n} ${n} 0 0 0 -${n} -${n}`}[e]||""}function Js(n,e){const i=e*(Math.PI/180),s=n.x*Math.cos(i)-n.y*Math.sin(i),r=n.x*Math.sin(i)+n.y*Math.cos(i);return{x:s,y:r}}const Xu=(n,e,i,s)=>n+` l ${e} ${i} `+s,Hn=$({x:0,y:0}),ns=$(0),Yn=$(!1),is=$(!1),rl=Mo({x:0,y:0},n=>{const e=l=>{n({x:l.clientX,y:l.clientY})},i=l=>{if(l.touches.length===2){const u=Du(l.touches[0],l.touches[1]);ns.set(u);const c={x:l.touches[0].clientX,y:l.touches[0].clientY};n(c)}else if(l.touches.length===1){const u=l.touches[0].clientX,c=l.touches[0].clientY;n({x:u,y:c}),Yn.set(!0)}},s=l=>{i(l),window.addEventListener("touchend",r),window.addEventListener("touchmove",i)},r=()=>{Yn.set(!1),ns.set(0),window.removeEventListener("touchmove",i)};return document.addEventListener("mousemove",e),window.addEventListener("touchstart",s,!0),()=>{window.removeEventListener("mousemove",e),window.removeEventListener("touchstart",s),window.removeEventListener("touchmove",i),window.removeEventListener("touchend",r)}});function qo(n){const e=n.style.width,i=n.style.height;n.style.width="fit-content",n.style.height="fit-content";const s=n.offsetWidth,r=n.offsetHeight;return n.style.width=e,n.style.height=i,[s,r]}function al(n,e,i,s,r){const l={x:0,y:0},u=s.x-r.left-r.width/2,c=s.y-r.top-r.height/2,f=(u-i.x)/n,d=(c-i.y)/n;return l.x=u-f*e,l.y=c-d*e,l}const Yu=3,Ku=.1,$i={north:{x:0,y:-1},south:{x:0,y:1},east:{x:1,y:0},west:{x:-1,y:0},self:{x:0,y:0}};function ll(n,e,i){const s=e*i,r=n-s;return Number(Math.max(Ku,Math.min(Yu,r)).toFixed(9))}const Eo=(n,e,i,s,r,l,u)=>{const{clientX:c,clientY:f}=n,d=l,p=c-i,g=f-e,w=u.x,k=u.y,P=s*(1-l)/2,M=r*(1-l)/2,A=p-w-P,z=g-k-M,E=A/d,B=z/d;return{x:E,y:B}};function Ju(n,e,i){const{top:s,left:r,width:l,height:u}=bt(n),c=bt(e.scale),f=bt(e.translation);return{scaled:Eo({clientX:i.x,clientY:i.y},s,r,l,u,c,f),scale:c}}function Qu(n,e,i){const{scale:s,translation:r}=i,l=bt(s),u=bt(r),c=e.x-n.x,f=e.y-n.y,d=u.x+c*l,p=u.y+f*l;return{x:d,y:p}}function $u(n,e){return n.x*e.x+n.y*e.y}function tc(n,e,i){const s=[],r=e.x-n.x,l=e.y-n.y,u=nc(n.direction,e.direction),c=$u(n.direction,e.direction)===0,f=ec(n,e),d=Ke(n.direction,-1,-1),p=Ke(e.direction,-1,-1),g={x:Math.abs(n.direction.y),y:Math.abs(n.direction.x)},w=Ke(n.direction,r-i*n.direction.x*(c?1:u?0:2),l-i*n.direction.y*(c?1:u?0:2)),k=Ke(e.direction,r+i*e.direction.x*(c?1:u?0:2),l+i*e.direction.y*(c?1:u?0:2)),P=Math.sign(w.x)===-1||Math.sign(w.y)===-1,M=Math.sign(k.x)===1||Math.sign(k.y)===1,A=Math.abs(r),z=Math.abs(l),E=Ke(n.direction,i,i),B=Ke(p,i,i),H=Ke(e.direction,i,i),F=Ke(n.direction,A,z),G=Ke(p,A,z),lt=Ke(n.direction,A/2,z/2),K=Ke(p,A/2,z/2),tt=Ke(g,r,l),st=!f&&!M&&!P,ht=n.x+E.x,I=n.y+E.y,rt=e.x+H.x,R=e.y+H.y;if(P&&s.push(E),f&&!M&&!P)s.push(F),s.push(G);else if(u)P||s.push(Ke(n.direction,i+A,i+z)),s.push(tt),M||s.push(Ke(p,i+A,i+z));else if(st)s.push(lt),s.push(tt),s.push(K);else if(P&&M)if(c){const mt=Math.abs(ht-rt),pt=Math.abs(I-R);s.push(Ke(e.direction,A<i*2?e.direction.x*(r+e.direction.x*i):A+i,z<i*2?e.direction.y*(l+e.direction.y*i):z+i)),s.push(Ke(d,mt,pt))}else{const mt=Math.abs(ht-rt),pt=Math.abs(I-R);s.push(Ke(g,r/2,l/2)),s.push(Ke(e.direction,mt,pt)),s.push(Ke(g,r/2,l/2))}else if(P){const mt=Math.abs(ht-e.x),pt=Math.abs(I-e.y);s.push(Ke(p,A<i*2?A-i:A/2,z<i*2?z-i:z/2)),s.push(Ke(d,mt,pt)),s.push(Ke(p,Math.max(i,A/2),Math.max(i,z/2)))}else if(M){const mt=Math.abs(rt-n.x),pt=Math.abs(R-n.y);s.push(Ke(n.direction,Math.max(i,A/2),Math.max(i,z/2))),s.push(Ke(e.direction,mt,pt)),s.push(Ke(n.direction,A<i*2?A-i:A/2,z<i*2?z-i:z/2))}return M&&s.push(B),s}function ec(n,e){const{x:i,y:s}=n.direction,{x:r,y:l}=e.direction,u=e.x-n.x,c=e.y-n.y;return i*l===r*s?!1:Math.sign(c)===Math.sign(s+l)!=(Math.sign(u)===Math.sign(i+r))}function Ke(n,e,i){return{x:n.x*e,y:n.y*i}}function nc(n,e){return n.x===e.x&&n.y===e.y}function ic(n,e){const{width:i,height:s}=n,{top:r,left:l,right:u,bottom:c}=e,f=u-l,d=c-r;if(!f||!d)return{x:null,y:null,scale:null};const p=l+f/2,g=r+d/2,w=Math.min(i/f,s/d)*.8,k=i/2,P=s/2,M=k-p,A=P-g;return{x:M*w,y:A*w,scale:w}}const ko=(n,e,i)=>Math.min(Math.abs(n||e)/2,i);function Vo(n,e){const s=n.getTotalLength()*e;return n.getPointAtLength(s)}function oc(n,e,i,s){return no([n,e,i,s],([l,u,c,f])=>{const d={clientX:l.x,clientY:l.y};return Eo(d,u.top,u.left,u.width,u.height,f,c)})}function sc(n,e,i,s){const r=$({top:1/0,left:1/0,right:-1/0,bottom:-1/0}),l=$({top:1/0,left:1/0,right:-1/0,bottom:-1/0});let u,c=bt(e),f=bt(i),d=bt(s),p=c.width/f,g=c.height/f;function w(){const{x:P,y:M}=Eo({clientX:c.left,clientY:c.top},c.top,c.left,c.width,c.height,f,d),A=bt(l);r.set({top:Math.min(A.top,M),left:Math.min(A.left,P),right:Math.max(A.right,P+p),bottom:Math.max(A.bottom,g+M)})}function k(P=!1){let M=1/0,A=1/0,z=-1/0,E=-1/0;for(const B of n.getAll()){console.log("dentro del for, este es e node:",B);const{x:H,y:F}=bt(B.position),G=bt(B.dimensions.width),lt=bt(B.dimensions.height);A=Math.min(A,H),M=Math.min(M,F),z=Math.max(z,H+G),E=Math.max(E,F+lt)}l.set({top:M,left:A,right:z,bottom:E}),w(),P&&(u=requestAnimationFrame(()=>k(P)))}return n.subscribe(()=>{console.log("dentro del nodes.subscribe...........Aqui no estan llegando los nodes"),k()}),is.subscribe(P=>{P&&k(P),P||cancelAnimationFrame(u)}),Yn.subscribe(P=>{P&&k(P),P||cancelAnimationFrame(u)}),e.subscribe(()=>{c=bt(e),p=c.width/f,g=c.height/f,w()}),i.subscribe(()=>{f=bt(i),p=c.width/f,g=c.height/f,w()}),s.subscribe(()=>{d=bt(s),w()}),{graphBounds:r,nodeBounds:l}}function rc(n,e,i){const{width:s,height:r,top:l,left:u}=n,c={clientX:s/2,clientY:r/2};return Eo(c,l,u,s,r,i,e)}function ul(n,e){const{zoom:i,editable:s,translation:r,direction:l,locked:u,edge:c,nodes:f}=e,d=$({x:(r==null?void 0:r.x)||0,y:(r==null?void 0:r.y)||0}),p=$({top:0,left:0,width:0,height:0,bottom:0,right:0}),g=$(i),w=$(!1),k=To(),P=sc(k,p,g,d),M=no([p,d,g],([z,E,B])=>rc(z,E,B));return{id:n,nodes:k,edges:Zu(),transforms:{translation:d,scale:g},maxZIndex:$(2),dimensions:p,bounds:P,center:M,mounted:w,direction:l||"LR",editable:s||!1,edge:c||null,editing:$(null),cursor:oc(rl,p,d,g),locked:$(u||!1),groups:$({selected:{parent:$(null),nodes:$(new Set)},hidden:{parent:$(null),nodes:$(new Set)}}),groupBoxes:To(),activeGroup:$(null),initialNodePositions:$([])}}const Xo=To(),Po={width:200,height:100};function So(n,e){return{x:Math.round(n/Po.width)*Po.width,y:Math.round(e/Po.height)*Po.height}}const Lo=10;function cl(n){const e=bt(n);return Array.from(e).map(s=>bt(s.position))}function ac(n,e){console.log("moveNodes called");let i;const s=bt(n.groups),r=bt(n.activeGroup);if(console.log("Graph Groups:",s),console.log("Active Group:",r),!r)return;const l=s[r].nodes;if(!l)return;const u=bt(n.initialNodePositions),{x:c,y:f}=bt(Hn),d=Array.from(bt(l)),p=bt(n.groupBoxes);console.log("Group Boxes:",p),d.forEach(w=>w.moving.set(!0)),g();function g(){const w=bt(n.cursor);let k=w.x-c,P=w.y-f;if(e){const A=So(k,P);k=A.x,P=A.y}const M={x:k,y:P};d.forEach((A,z)=>{const{group:E,position:B}=A,H=u[z];let F;if(r==="selected"){const G=bt(E);G&&(F=p.get(G))}if(!F)lc(H,M,B);else{const G=bt(A.dimensions.width),lt=bt(A.dimensions.height),K=fl(F,G,lt);hl(H,M,B,K)}}),bt(Yn)?i=requestAnimationFrame(g):cancelAnimationFrame(i)}}function lc(n,e,i){i.set({x:n.x+e.x,y:n.y+e.y})}function hl(n,e,i,s){i.set({x:Math.min(Math.max(s.left,n.x+e.x),s.right),y:Math.min(Math.max(s.top,n.y+e.y),s.bottom)})}function fl(n,e,i){const{x:s,y:r}=bt(n.position);return console.log("Group Box Position:",{x:s,y:r}),{left:s+Lo,right:s+bt(n.dimensions.width)-e-Lo,top:r+Lo,bottom:r+bt(n.dimensions.height)-i-Lo}}function Qs(n=1,e,i,s=.1){const r=bt(e),{width:l,height:u,top:c,left:f}=r,d=i.scale,p=bt(i.translation),g=bt(d),w=ll(g,n,s),k=al(g,w,p,{x:l/2+f,y:u/2+c},r);d.set(w),i.translation.set(k)}function uc(n,e,i,s,r,l,u,c,f,d,p,g){const{width:w,height:k}=r,{x:P,y:M}=s,A=bt(e.position),z=$({x:P-A.x+w/2,y:M-A.y+k/2}),E=no([e.position,z],([tt,st])=>({x:tt.x+st.x,y:tt.y+st.y})),B=n.transforms,H=n.dimensions,F=$(f||"self"),G=()=>{const tt=document.getElementById(i),st=bt(F),ht=$i[st];if(!tt)return;const{x:I,y:rt,width:R,height:mt}=tt.getBoundingClientRect(),pt=bt(z),J=bt(E),{scaled:j,scale:Et}=Ju(H,B,{x:I,y:rt}),ut=j.x-J.x,kt=j.y-J.y;z.set({x:pt.x+ut+R/Et/2+ht.x*R/Et/2,y:pt.y+kt+mt/Et/2+ht.y*mt/Et/2})},lt=no([e.moving,e.resizingWidth,e.resizingHeight,e.rotating],([tt,st,ht,I])=>tt||st||ht||I),K=no([e.rotation],([tt])=>tt);return{id:i,position:E,offset:z,direction:F,dynamic:$(d||!1),type:c,edge:u,moving:lt,mounted:$(!1),recalculatePosition:G,connected:$(new Set),store:l||null,inputKey:p||null,edgeColor:g||$(null),rotation:K,node:e}}function cc(n){var s,r;const e=JSON.parse(n);return ul(e.id,{...e,editable:e.editable,direction:e.direction,locked:e.locked,zoom:((s=e.transforms)==null?void 0:s.scale)??1,translation:((r=e.transforms)==null?void 0:r.translation)??{x:0,y:0},edge:e.edge})}function hc(n){let e;const i=n[2].default,s=Me(i,n,n[1],null);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,[l]){s&&s.p&&(!e||l&2)&&Ee(s,i,r,r[1],e?Te(i,r[1],l,null):Ae(r[1]),null)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function fc(n,e,i){let{$$slots:s={},$$scope:r}=e,{edge:l}=e;return Ie("edge",l),n.$$set=u=>{"edge"in u&&i(0,l=u.edge),"$$scope"in u&&i(1,r=u.$$scope)},[l,r,s]}class dl extends Cn{constructor(e){super(),Ln(this,e,fc,hc,mn,{edge:0})}}const dc=n=>({hovering:n[0]&32768}),$s=n=>({destroy:n[9],hovering:n[15]}),_c=n=>({path:n[0]&4096,hovering:n[0]&32768}),tr=n=>({path:n[12],destroy:n[9],hovering:n[15]});function mc(n){let e,i,s,r,l,u=(n[0]||n[1])&&er(n);const c=n[91].default,f=Me(c,n,n[90],tr),d=f||pc(n);let p=n[10]&&nr(n);return{c(){e=oe("svg"),u&&u.c(),i=oe("path"),d&&d.c(),p&&p.c(),m(i,"role","presentation"),m(i,"id",n[38]+"-target"),m(i,"class","target svelte-ppcocz"),m(i,"d",n[12]),te(i,"cursor",n[38]==="cursor"||!n[4]&&!n[3]),at(i,"cursor",n[4]||n[15]?"pointer":"move"),at(i,"--prop-target-edge-color",n[4]||n[15]?n[8]||null:"transparent"),m(e,"class","edges-wrapper svelte-ppcocz"),at(e,"z-index",n[17])},m(g,w){Q(g,e,w),u&&u.m(e,null),b(e,i),n[94](i),d&&d.m(e,null),p&&p.m(e,null),n[95](e),s=!0,r||(l=[ft(i,"mousedown",function(){so(n[4])&&n[4].apply(this,arguments)}),ft(i,"mouseenter",n[92]),ft(i,"mouseleave",n[93])],r=!0)},p(g,w){n=g,n[0]||n[1]?u?u.p(n,w):(u=er(n),u.c(),u.m(e,i)):u&&(u.d(1),u=null),(!s||w[0]&4096)&&m(i,"d",n[12]),(!s||w[0]&24|w[1]&128)&&te(i,"cursor",n[38]==="cursor"||!n[4]&&!n[3]),w[0]&32784&&at(i,"cursor",n[4]||n[15]?"pointer":"move"),w[0]&33040&&at(i,"--prop-target-edge-color",n[4]||n[15]?n[8]||null:"transparent"),f?f.p&&(!s||w[0]&36864|w[2]&268435456)&&Ee(f,c,n,n[90],s?Te(c,n[90],w,_c):Ae(n[90]),tr):d&&d.p&&(!s||w[0]&1052711)&&d.p(n,s?w:[-1,-1,-1,-1]),n[10]?p?(p.p(n,w),w[0]&1024&&Z(p,1)):(p=nr(n),p.c(),Z(p,1),p.m(e,null)):p&&(ke(),W(p,1,1,()=>{p=null}),Pe()),w[0]&131072&&at(e,"z-index",n[17])},i(g){s||(Z(d,g),Z(p),s=!0)},o(g){W(d,g),W(p),s=!1},d(g){g&&Y(e),u&&u.d(),n[94](null),d&&d.d(g),p&&p.d(),n[95](null),r=!1,fn(l)}}}function er(n){let e,i,s,r,l;return{c(){e=oe("defs"),i=oe("marker"),s=oe("polygon"),r=oe("marker"),l=oe("polygon"),m(s,"class","arrow svelte-ppcocz"),m(s,"points","0 0, 15 5, 0 10"),at(s,"--prop-edge-color",n[20]),m(i,"id",n[38]+"-end-arrow"),m(i,"viewBox","0 0 15 15"),m(i,"markerWidth","15"),m(i,"markerHeight","10"),m(i,"refX","12.5"),m(i,"refY","5"),m(i,"orient","auto"),m(l,"class","arrow svelte-ppcocz"),m(l,"points","0 5, 15 0, 15 10"),at(l,"--prop-edge-color",n[20]),m(r,"id",n[38]+"-start-arrow"),m(r,"viewBox","0 0 15 15"),m(r,"markerWidth","15"),m(r,"markerHeight","10"),m(r,"refX","0"),m(r,"refY","5"),m(r,"orient","auto")},m(u,c){Q(u,e,c),b(e,i),b(i,s),b(e,r),b(r,l)},p(u,c){c[0]&1048576&&at(s,"--prop-edge-color",u[20]),c[0]&1048576&&at(l,"--prop-edge-color",u[20])},d(u){u&&Y(e)}}}function pc(n){let e,i,s;return{c(){e=oe("path"),m(e,"id",n[38]),m(e,"class","edge svelte-ppcocz"),m(e,"d",n[12]),m(e,"marker-end",i=n[1]==="arrow"?`url(#${n[38]+"-end-arrow"})`:""),m(e,"marker-start",s=n[0]==="arrow"?`url(#${n[38]+"-start-arrow"})`:""),te(e,"animate",n[2]),at(e,"--prop-edge-color",n[20]),at(e,"--prop-stroke-width",n[5]?n[5]+"px":null)},m(r,l){Q(r,e,l)},p(r,l){l[0]&4096&&m(e,"d",r[12]),l[0]&2&&i!==(i=r[1]==="arrow"?`url(#${r[38]+"-end-arrow"})`:"")&&m(e,"marker-end",i),l[0]&1&&s!==(s=r[0]==="arrow"?`url(#${r[38]+"-start-arrow"})`:"")&&m(e,"marker-start",s),l[0]&4&&te(e,"animate",r[2]),l[0]&1048576&&at(e,"--prop-edge-color",r[20]),l[0]&32&&at(e,"--prop-stroke-width",r[5]?r[5]+"px":null)},d(r){r&&Y(e)}}}function nr(n){let e,i,s,r,l;const u=n[91].label,c=Me(u,n,n[90],$s),f=c||gc(n);return{c(){e=oe("foreignObject"),i=T("span"),f&&f.c(),m(i,"class","label-wrapper svelte-ppcocz"),m(e,"x",s=n[14].x),m(e,"y",r=n[14].y),m(e,"width","100%"),m(e,"height","100%"),m(e,"class","svelte-ppcocz")},m(d,p){Q(d,e,p),b(e,i),f&&f.m(i,null),l=!0},p(d,p){c?c.p&&(!l||p[0]&32768|p[2]&268435456)&&Ee(c,u,d,d[90],l?Te(u,d[90],p,dc):Ae(d[90]),$s):f&&f.p&&(!l||p[0]&2240)&&f.p(d,l?p:[-1,-1,-1,-1]),(!l||p[0]&16384&&s!==(s=d[14].x))&&m(e,"x",s),(!l||p[0]&16384&&r!==(r=d[14].y))&&m(e,"y",r)},i(d){l||(Z(f,d),l=!0)},o(d){W(f,d),l=!1},d(d){d&&Y(e),f&&f.d(d)}}}function gc(n){let e,i;return{c(){e=T("div"),i=Be(n[11]),m(e,"class","default-label svelte-ppcocz"),at(e,"--prop-label-color",n[6]),at(e,"--prop-label-text-color",n[7])},m(s,r){Q(s,e,r),b(e,i)},p(s,r){r[0]&2048&&_n(i,s[11]),r[0]&64&&at(e,"--prop-label-color",s[6]),r[0]&128&&at(e,"--prop-label-text-color",s[7])},d(s){s&&Y(e)}}}function vc(n){let e,i,s=n[23]&&n[24]&&mc(n);return{c(){s&&s.c(),e=Ze()},m(r,l){s&&s.m(r,l),Q(r,e,l),i=!0},p(r,l){r[23]&&r[24]&&s.p(r,l)},i(r){i||(Z(s),i=!0)},o(r){W(s),i=!1},d(r){r&&Y(e),s&&s.d(r)}}}let Yo;function yc(n){const e=n.parentNode;if(!e)return;e.removeChild(n);const i=document.querySelector(".svelvet-graph-wrapper");i&&i.appendChild(n)}function bc(n,e,i){var Jn,Kn;let s,r,l,u,c,f,d,p,g,w,k,P,M,A,z,E,B,H,F,G,lt,K,tt,st,ht,I,rt,R,mt,pt,J,j,Et=Ut,ut=()=>(Et(),Et=yn(mt,gt=>i(73,j=gt)),mt),kt,Nt=Ut,yt=()=>(Nt(),Nt=yn(R,gt=>i(74,kt=gt)),R),x,it,U,q,Vt,re,dt,Dt,Ht,Wt,It,ne,Xt,ot,ae=Ut,Qt=()=>(ae(),ae=yn(l,gt=>i(88,ot=gt)),l),Rt,se=Ut,Fe=()=>(se(),se=yn(r,gt=>i(89,Rt=gt)),r);n.$$.on_destroy.push(()=>Et()),n.$$.on_destroy.push(()=>Nt()),n.$$.on_destroy.push(()=>ae()),n.$$.on_destroy.push(()=>se());let{$$slots:Ge={},$$scope:De}=e;const Ce=as(Ge),Kt=ve("edgeStore"),he=ve("edgeStyle"),ze=ve("endStyles"),Re=ve("raiseEdgesOnSelect"),Ft=ve("edgesAboveNode");let{edge:le=ve("edge")}=e,{straight:xe=he==="straight"}=e,{step:Je=he==="step"}=e,{start:Qe=ze[0]}=e,{end:Sn=ze[1]}=e,{animate:ye=!1}=e,{label:Xe=""}=e,{enableHover:Ot=!1}=e,{edgeClick:an=null}=e,{labelPosition:je=.5}=e,{width:Ue=null}=e,{color:dn=null}=e,{labelColor:bn=null}=e,{textColor:He=null}=e,{cornerRadius:Ne=8}=e,{targetColor:$e=null}=e;const Jt=le.source,fe=le.target,tn=Jt.direction;vt(n,tn,gt=>i(76,it=gt));const Tn=fe.direction;vt(n,Tn,gt=>i(75,x=gt));const pn=Jt.rotation;vt(n,pn,gt=>i(83,Ht=gt));const gn=fe.rotation;vt(n,gn,gt=>i(82,Dt=gt));const En=Jt.position;vt(n,En,gt=>i(87,Xt=gt));const qe=fe.position;vt(n,qe,gt=>i(86,ne=gt));const Pt=Jt.dynamic;vt(n,Pt,gt=>i(79,Vt=gt));const Ye=fe.dynamic;vt(n,Ye,gt=>i(78,q=gt));const vn=Jt.moving;vt(n,vn,gt=>i(81,dt=gt));const en=fe.moving;vt(n,en,gt=>i(80,re=gt));const Bn=(Jn=Jt.node)==null?void 0:Jn.position;vt(n,Bn,gt=>i(85,It=gt));const y=(Kn=fe.node)==null?void 0:Kn.position;vt(n,y,gt=>i(84,Wt=gt));const _t=le.type;vt(n,_t,gt=>i(77,U=gt));const Lt=le.id;let Ct,At,O={x:0,y:0},$t=!1,me=!1,Yt=!1,Se=!1,nn=!1,ln;le.rendered.set(!0),Xn(()=>{setTimeout(()=>{At&&i(14,O=Vo(At,je))},0),yc(ln)}),Qa(()=>{At&&i(14,O=Vo(At,je))}),ro(()=>{ln.remove(),cancelAnimationFrame(Yo)});function on(){$t&&(At&&i(14,O=Vo(At,je)),Yo=requestAnimationFrame(on))}function An(){if(Jt.id===null||fe.id===null)return;const gt=Kt.match(Jt,fe);Kt.delete(gt[0]),Jt==null||Jt.connected.update(Gt=>(fe&&Gt.delete(fe),Gt)),fe==null||fe.connected.update(Gt=>(Jt&&Gt.delete(Jt),Gt))}const oi=()=>i(15,nn=!0),Wn=()=>i(15,nn=!1);function xn(gt){ii[gt?"unshift":"push"](()=>{At=gt,i(13,At)})}function wn(gt){ii[gt?"unshift":"push"](()=>{ln=gt,i(16,ln)})}return n.$$set=gt=>{"edge"in gt&&i(39,le=gt.edge),"straight"in gt&&i(40,xe=gt.straight),"step"in gt&&i(41,Je=gt.step),"start"in gt&&i(0,Qe=gt.start),"end"in gt&&i(1,Sn=gt.end),"animate"in gt&&i(2,ye=gt.animate),"label"in gt&&i(42,Xe=gt.label),"enableHover"in gt&&i(3,Ot=gt.enableHover),"edgeClick"in gt&&i(4,an=gt.edgeClick),"labelPosition"in gt&&i(43,je=gt.labelPosition),"width"in gt&&i(5,Ue=gt.width),"color"in gt&&i(44,dn=gt.color),"labelColor"in gt&&i(6,bn=gt.labelColor),"textColor"in gt&&i(7,He=gt.textColor),"cornerRadius"in gt&&i(45,Ne=gt.cornerRadius),"targetColor"in gt&&i(8,$e=gt.targetColor),"$$scope"in gt&&i(90,De=gt.$$scope)},n.$$.update=()=>{var gt;if(n.$$.dirty[2]&196608&&i(55,s=Vt||q),n.$$.dirty[1]&256&&Qt(i(21,l=(gt=le.label)==null?void 0:gt.text)),n.$$.dirty[1]&8192|n.$$.dirty[2]&134217728&&i(20,u=dn||Rt||null),n.$$.dirty[1]&2048|n.$$.dirty[2]&67108864&&i(11,c=Xe||ot||""),n.$$.dirty[0]&2048&&i(10,f=c||Ce.label),n.$$.dirty[2]&33554432&&i(72,d=Xt),n.$$.dirty[2]&16777216&&i(71,p=ne),n.$$.dirty[2]&8388608&&i(56,g=It),n.$$.dirty[2]&4194304&&i(57,w=Wt),n.$$.dirty[2]&1024&&i(52,k=d.x),n.$$.dirty[2]&1024&&i(51,P=d.y),n.$$.dirty[2]&512&&i(54,M=p.x),n.$$.dirty[2]&512&&i(53,A=p.y),n.$$.dirty[1]&10485760&&i(70,z=M-k),n.$$.dirty[1]&5242880&&i(69,E=A-P),n.$$.dirty[2]&256&&i(68,B=Math.abs(z)),n.$$.dirty[2]&128&&i(67,H=Math.abs(E)),n.$$.dirty[2]&64&&i(65,F=Math.max(30,Math.min(600,B/2))),n.$$.dirty[2]&32&&i(63,G=Math.max(30,Math.min(600,H/2))),n.$$.dirty[1]&117833728&&s&&Jt.node&&fe.node){const Gt=w.x-g.x,ee=w.y-g.y;i(48,Yt=ee>0),i(49,Se=Gt>0);let un,Mn;if(Yt){const cn=bt(Jt.node.dimensions.height),pe=g.y+cn;un=w.y-pe}else{const cn=bt(fe.node.dimensions.height),pe=w.y+cn;un=g.y-pe}if(Se){const cn=bt(Jt.node.dimensions.width),pe=g.x+cn;Mn=w.x-pe}else{const cn=bt(fe.node.dimensions.width),pe=w.x+cn;Mn=g.x-pe}i(47,me=un>Mn)}if(n.$$.dirty[1]&17235968|n.$$.dirty[2]&196608&&s){let Gt,ee;me?(Gt=Yt?"south":"north",ee=Yt?"north":"south"):(Gt=Se?"east":"west",ee=Se?"west":"east"),Vt&&Zt(tn,it=Gt,it),q&&Zt(Tn,x=ee,x)}if(n.$$.dirty[2]&2113536&&i(66,lt=Js($i[it],Ht||0)),n.$$.dirty[2]&1056768&&i(64,K=Js($i[x],Dt||0)),n.$$.dirty[1]&2097152|n.$$.dirty[2]&24&&i(62,tt=k+lt.x*F),n.$$.dirty[1]&1048576|n.$$.dirty[2]&18&&i(61,st=P+lt.y*G),n.$$.dirty[1]&8388608|n.$$.dirty[2]&12&&i(60,ht=M+K.x*F),n.$$.dirty[1]&4194304|n.$$.dirty[2]&6&&i(59,I=A+K.y*G),n.$$.dirty[1]&1879048192|n.$$.dirty[2]&1&&i(58,rt=`C ${tt}, ${st} ${ht}, ${I}`),n.$$.dirty[1]&149947904|n.$$.dirty[2]&32768&&(!Je||Lt==="cursor"||U==="bezier")&&i(12,Ct=`M ${k}, ${P} ${xe?"":rt} ${M}, ${A}`),n.$$.dirty[0]&1024|n.$$.dirty[1]&32768|n.$$.dirty[2]&786432&&(f&&!$t&&(dt||re||Lt==="cursor")?(i(46,$t=!0),on()):$t&&!dt&&!re&&Lt!=="cursor"&&(i(46,$t=!1),cancelAnimationFrame(Yo))),n.$$.dirty[1]&15746048|n.$$.dirty[2]&57344&&Je&&Lt!=="cursor"&&!(U&&U==="bezier")){const Gt={x:k,y:P,direction:$i[it]},ee={x:M,y:A,direction:$i[x]},un=tc(Gt,ee,Ou),Mn=(cn,pe,xt)=>{if(pe<un.length-1){const We=qu(cn,un[pe+1]);return Vu(xt,We)}return""};i(12,Ct=un.reduce((cn,pe,xt)=>{const We=Math.sign(pe.x),Fn=Math.sign(pe.y);let Qn=pe.x,hn=pe.y,mi="";if(Ne){const Gn=un[xt+1]||{x:0,y:0},kn=un[xt-1]||{x:0,y:0},ge=ko(pe.x,Gn.x,Ne),Un=ko(Gn.y,pe.y,Ne),In=ko(kn.x,pe.x,Ne),Zn=ko(kn.y,pe.y,Ne),On=Math.min(In,Zn),Dn=Math.min(ge,Un);pe.x?Qn=pe.x-(Dn+On)*We:hn=pe.y-(Dn+On)*Fn,mi=Mn(pe,xt,Dn)}return Xu(cn,Qn,hn,mi)},`M ${k}, ${P}`))}n.$$.dirty[2]&6144&&i(50,pt=Math.max(kt,j)),n.$$.dirty[1]&524288|n.$$.dirty[2]&6144&&i(17,J=Ft==="all"?1e5:Ft?pt:Re===!0?pt-1:Re==="source"?kt-1:Re==="target"?j-1:0)},Fe(i(22,r=(Jt==null?void 0:Jt.edgeColor)||(fe==null?void 0:fe.edgeColor)||null)),yt(i(19,R=Jt.node.zIndex||0)),ut(i(18,mt=fe.node.zIndex||0)),[Qe,Sn,ye,Ot,an,Ue,bn,He,$e,An,f,c,Ct,At,O,nn,ln,J,mt,R,u,l,r,Jt,fe,tn,Tn,pn,gn,En,qe,Pt,Ye,vn,en,Bn,y,_t,Lt,le,xe,Je,Xe,je,dn,Ne,$t,me,Yt,Se,pt,P,k,A,M,s,g,w,rt,I,ht,st,tt,G,K,F,lt,H,B,E,z,p,d,j,kt,x,it,U,q,Vt,re,dt,Dt,Ht,Wt,It,ne,Xt,ot,Rt,De,Ge,oi,Wn,xn,wn]}class _l extends Cn{constructor(e){super(),Ln(this,e,bc,vc,mn,{edge:39,straight:40,step:41,start:0,end:1,animate:2,label:42,enableHover:3,edgeClick:4,labelPosition:43,width:5,color:44,labelColor:6,textColor:7,cornerRadius:45,targetColor:8,destroy:9},null,[-1,-1,-1,-1])}get destroy(){return this.$$.ctx[9]}}function wc(n){let e;return{c(){e=T("div"),m(e,"class","svelvet-anchor svelte-19t6skv"),te(e,"output",n[0]),te(e,"input",n[1]),te(e,"connected",n[3]),te(e,"connecting",n[2]),te(e,"hovering",n[4]),at(e,"--prop-anchor-color",n[5])},m(i,s){Q(i,e,s)},p(i,[s]){s&1&&te(e,"output",i[0]),s&2&&te(e,"input",i[1]),s&8&&te(e,"connected",i[3]),s&4&&te(e,"connecting",i[2]),s&16&&te(e,"hovering",i[4]),s&32&&at(e,"--prop-anchor-color",i[5])},i:Ut,o:Ut,d(i){i&&Y(e)}}}function kc(n,e,i){let{output:s}=e,{input:r}=e,{connecting:l}=e,{connected:u}=e,{hovering:c}=e,{bgColor:f}=e;return n.$$set=d=>{"output"in d&&i(0,s=d.output),"input"in d&&i(1,r=d.input),"connecting"in d&&i(2,l=d.connecting),"connected"in d&&i(3,u=d.connected),"hovering"in d&&i(4,c=d.hovering),"bgColor"in d&&i(5,f=d.bgColor)},[s,r,l,u,c,f]}class Pc extends Cn{constructor(e){super(),Ln(this,e,kc,wc,mn,{output:0,input:1,connecting:2,connected:3,hovering:4,bgColor:5})}}const Lc=n=>({}),ir=n=>({});function or(n){const e=n.slice(),i=e[7].component;return e[86]=i,e}function Ko(n){const e=n.slice(),i=e[14].get("cursor");return e[7]=i,e}function sr(n,e,i){const s=n.slice();s[87]=e[i];const r=s[14].fetch(s[23],s[87]);return s[7]=r,s}const Cc=n=>({}),rr=n=>({});function Jo(n){const e=n.slice(),i=e[7].component;return e[86]=i,e}const Sc=n=>({linked:n[0]&512,hovering:n[0]&1024,connecting:n[0]&2048}),ar=n=>{var e;return{linked:((e=n[9])==null?void 0:e.size)>=1,hovering:n[10],connecting:n[11]}};function lr(n){var s;let e,i;return e=new Pc({props:{output:n[2],input:n[1],connecting:n[11],hovering:n[10],bgColor:n[0],connected:((s=n[9])==null?void 0:s.size)>=1}}),{c(){_e(e.$$.fragment)},m(r,l){ue(e,r,l),i=!0},p(r,l){var c;const u={};l[0]&4&&(u.output=r[2]),l[0]&2&&(u.input=r[1]),l[0]&2048&&(u.connecting=r[11]),l[0]&1024&&(u.hovering=r[10]),l[0]&1&&(u.bgColor=r[0]),l[0]&512&&(u.connected=((c=r[9])==null?void 0:c.size)>=1),e.$set(u)},i(r){i||(Z(e.$$.fragment,r),i=!0)},o(r){W(e.$$.fragment,r),i=!1},d(r){ce(e,r)}}}function Mc(n){let e,i,s=!n[5]&&lr(n);return{c(){s&&s.c(),e=Ze()},m(r,l){s&&s.m(r,l),Q(r,e,l),i=!0},p(r,l){r[5]?s&&(ke(),W(s,1,1,()=>{s=null}),Pe()):s?(s.p(r,l),l[0]&32&&Z(s,1)):(s=lr(r),s.c(),Z(s,1),s.m(e.parentNode,e))},i(r){i||(Z(s),i=!0)},o(r){W(s),i=!1},d(r){r&&Y(e),s&&s.d(r)}}}function ur(n){let e,i;return e=new dl({props:{edge:n[7],$$slots:{default:[zc]},$$scope:{ctx:n}}}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},p(s,r){const l={};r[0]&512&&(l.edge=s[7]),r[0]&512|r[1]&8388608&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Tc(n){let e,i;return e=new _l({}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Ec(n){let e,i;return e=new n[86]({}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Ac(n){let e,i,s,r;const l=[Ec,Tc],u=[];function c(f,d){return f[86]?0:1}return e=c(n),i=u[e]=l[e](n),{c(){i.c(),s=Ze()},m(f,d){u[e].m(f,d),Q(f,s,d),r=!0},p(f,d){let p=e;e=c(f),e!==p&&(ke(),W(u[p],1,1,()=>{u[p]=null}),Pe(),i=u[e],i||(i=u[e]=l[e](f),i.c()),Z(i,1),i.m(s.parentNode,s))},i(f){r||(Z(i),r=!0)},o(f){W(i),r=!1},d(f){f&&Y(s),u[e].d(f)}}}function zc(n){let e;const i=n[50].edge,s=Me(i,n,n[54],rr),r=s||Ac(n);return{c(){r&&r.c()},m(l,u){r&&r.m(l,u),e=!0},p(l,u){s?s.p&&(!e||u[1]&8388608)&&Ee(s,i,l,l[54],e?Te(i,l[54],u,Cc):Ae(l[54]),rr):r&&r.p&&(!e||u[0]&512)&&r.p(l,e?u:[-1,-1,-1])},i(l){e||(Z(r,l),e=!0)},o(l){W(r,l),e=!1},d(l){r&&r.d(l)}}}function cr(n,e){let i,s,r,l=e[7]&&e[7].source===e[23]&&ur(Jo(e));return{key:n,first:null,c(){i=Ze(),l&&l.c(),s=Ze(),this.first=i},m(u,c){Q(u,i,c),l&&l.m(u,c),Q(u,s,c),r=!0},p(u,c){e=u,e[7]&&e[7].source===e[23]?l?(l.p(Jo(e),c),c[0]&512&&Z(l,1)):(l=ur(Jo(e)),l.c(),Z(l,1),l.m(s.parentNode,s)):l&&(ke(),W(l,1,1,()=>{l=null}),Pe())},i(u){r||(Z(l),r=!0)},o(u){W(l),r=!1},d(u){u&&(Y(i),Y(s)),l&&l.d(u)}}}function hr(n){let e,i,s=n[7]&&Nc(or(n));return{c(){s&&s.c(),e=Ze()},m(r,l){s&&s.m(r,l),Q(r,e,l),i=!0},p(r,l){r[7]&&s.p(or(r),l)},i(r){i||(Z(s),i=!0)},o(r){W(s),i=!1},d(r){r&&Y(e),s&&s.d(r)}}}function Nc(n){let e,i;return e=new dl({props:{edge:n[7],$$slots:{default:[Zc]},$$scope:{ctx:n}}}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},p(s,r){const l={};r[1]&8388608&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Ic(n){let e,i;return e=new _l({}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Oc(n){let e,i;return e=new n[86]({}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Bc(n){let e,i,s,r;const l=[Oc,Ic],u=[];function c(f,d){return f[86]?0:1}return e=c(n),i=u[e]=l[e](n),{c(){i.c(),s=Ze()},m(f,d){u[e].m(f,d),Q(f,s,d),r=!0},p:Ut,i(f){r||(Z(i),r=!0)},o(f){W(i),r=!1},d(f){f&&Y(s),u[e].d(f)}}}function Zc(n){let e;const i=n[50].edge,s=Me(i,n,n[54],ir),r=s||Bc(n);return{c(){r&&r.c()},m(l,u){r&&r.m(l,u),e=!0},p(l,u){s&&s.p&&(!e||u[1]&8388608)&&Ee(s,i,l,l[54],e?Te(i,l[54],u,Lc):Ae(l[54]),ir)},i(l){e||(Z(r,l),e=!0)},o(l){W(r,l),e=!1},d(l){r&&r.d(l)}}}function Dc(n){let e,i,s,r=[],l=new Map,u,c,f,d,p;const g=n[50].default,w=Me(g,n,n[54],ar),k=w||Mc(n);let P=Le(Array.from(n[9]));const M=z=>z[87].id;for(let z=0;z<P.length;z+=1){let E=sr(n,P,z),B=M(E);l.set(B,r[z]=cr(B,E))}let A=n[11]&&hr(Ko(n));return{c(){var z;e=T("div"),k&&k.c(),s=X();for(let E=0;E<r.length;E+=1)r[E].c();u=X(),A&&A.c(),c=Ze(),m(e,"id",(z=n[23])==null?void 0:z.id),m(e,"class","anchor-wrapper svelte-bazd6o"),m(e,"role","button"),m(e,"tabindex","0"),m(e,"title",i=n[6]||""),te(e,"locked",n[4])},m(z,E){Q(z,e,E),k&&k.m(e,null),n[53](e),Q(z,s,E);for(let B=0;B<r.length;B+=1)r[B]&&r[B].m(z,E);Q(z,u,E),A&&A.m(z,E),Q(z,c,E),f=!0,d||(p=[ft(e,"mouseenter",n[51]),ft(e,"mouseleave",n[52]),ft(e,"mousedown",ni(Vn(n[25]))),ft(e,"mouseup",ni(n[24])),ft(e,"touchstart",ni(Vn(n[25]))),ft(e,"touchend",ni(n[24]))],d=!0)},p(z,E){w?w.p&&(!f||E[0]&3584|E[1]&8388608)&&Ee(w,g,z,z[54],f?Te(g,z[54],E,Sc):Ae(z[54]),ar):k&&k.p&&(!f||E[0]&3623)&&k.p(z,f?E:[-1,-1,-1]),(!f||E[0]&64&&i!==(i=z[6]||""))&&m(e,"title",i),(!f||E[0]&16)&&te(e,"locked",z[4]),E[0]&8405504|E[1]&8388608&&(P=Le(Array.from(z[9])),ke(),r=_i(r,E,M,1,z,P,l,u.parentNode,oo,cr,u,sr),Pe()),z[11]?A?(A.p(Ko(z),E),E[0]&2048&&Z(A,1)):(A=hr(Ko(z)),A.c(),Z(A,1),A.m(c.parentNode,c)):A&&(ke(),W(A,1,1,()=>{A=null}),Pe())},i(z){if(!f){Z(k,z);for(let E=0;E<P.length;E+=1)Z(r[E]);Z(A),f=!0}},o(z){W(k,z);for(let E=0;E<r.length;E+=1)W(r[E]);W(A),f=!1},d(z){z&&(Y(e),Y(s),Y(u),Y(c)),k&&k.d(z),n[53](null);for(let E=0;E<r.length;E+=1)r[E].d(z);A&&A.d(z),d=!1,fn(p)}}}let Qo;const fi=$(null);function Rc(n,e,i){if(e==="self")return;const s=n.parentNode;if(!s)return;s.removeChild(n);const r=document.querySelector(`#anchors-${e}-${i.id}`);r&&(r.appendChild(n),n&&i.recalculateAnchors())}function xc(n,e,i){let s,r,l,u,c=Ut,f=()=>(c(),c=yn(dt,y=>i(55,u=y)),dt),d,p=Ut,g,w,k=Ut,P=()=>(k(),k=yn(r,y=>i(9,w=y)),r),M,A,z,E,B=Ut,H=()=>(B(),B=yn(l,y=>i(47,E=y)),l),F,G,lt,K;vt(n,fi,y=>i(42,d=y)),n.$$.on_destroy.push(()=>c()),n.$$.on_destroy.push(()=>p()),n.$$.on_destroy.push(()=>k()),n.$$.on_destroy.push(()=>B());let{$$slots:tt={},$$scope:st}=e;const ht=ve("dynamic"),I=ve("node"),rt=ve("edgeStore"),R=ve("cursorAnchor"),mt=ve("direction"),pt=ve("mounted");vt(n,pt,y=>i(49,G=y));const J=ve("graph"),j=ve("nodeStore"),Et=ve("graphEdge"),ut=ve("nodeConnectEvent");vt(n,ut,y=>i(43,g=y));const kt=ve("anchorsMounted");vt(n,kt,y=>i(56,lt=y));const Nt=ve("flowchart")||void 0;let{bgColor:yt=null}=e,{id:x=0}=e,{input:it=!1}=e,{output:U=!1}=e,{multiple:q=U?!0:!it}=e,{dynamic:Vt=ht||!1}=e,{edge:re=null}=e,{inputsStore:dt=null}=e;f();let{key:Dt=null}=e,{outputStore:Ht=null}=e,{connections:Wt=[]}=e,{edgeColor:It=$(null)}=e,{edgeLabel:ne=""}=e,{locked:Xt=!1}=e,{nodeConnect:ot=!1}=e,{edgeStyle:ae=null}=e,{endStyles:Qt=[null,null]}=e,{invisible:Rt=!1}=e,{direction:se=mt==="TD"?it?"north":"south":it?"west":"east"}=e,{title:Fe=""}=e;const Ge=Gi(),De=Gi();let Ce,Kt=!1,he=!1,ze=0,Re=it===U?null:it?"input":"output",Ft=[];const le=I.edge,xe=I.anchors;vt(n,xe,y=>i(48,F=y));const Je=I.resizingWidth;vt(n,Je,y=>i(46,z=y));const Qe=I.resizingHeight;vt(n,Qe,y=>i(45,A=y));const Sn=I.rotating;vt(n,Sn,y=>i(44,M=y));const ye=I.connections;vt(n,ye,y=>i(57,K=y));const Xe=`A-${x||xe.count()+1}/${I.id}`,Ot=uc(J,I,Xe,{x:0,y:0},{width:0,height:0},dt||Ht||null,re||le||Et||null,Re,se,Vt,Dt,It);xe.add(Ot,Ot.id),Xn(()=>{Ce&&Ot.recalculatePosition();const y=Array.from(bt(I.anchors)).reduce((_t,[,Lt])=>(Lt.type==="output"&&_t++,_t),0);if(K!=null&&K.length&&!it){const _t=[];let Lt=null;K.forEach((Ct,At)=>{Ct&&(Lt===null&&(Lt=At),(At-Lt)%y===0?(Ft.push(Ct),_t.push(null)):_t.push(Ct))}),Zt(ye,K=_t,K)}Zt(kt,lt++,lt)}),Qa(()=>{Ce&&Ot.recalculatePosition()}),ro(()=>{pn(),cancelAnimationFrame(Qo)});function an(y){var me;rt.delete("cursor");const _t={x:y.changedTouches[0].clientX,y:y.changedTouches[0].clientY},Lt=document.elementFromPoint(_t.x,_t.y);if(!Lt)return;const Ct=Lt.parentElement;if(!Ct)return;const At=Ct.id,O=At.split("/")[1],$t=(me=j.get(O))==null?void 0:me.anchors.get(At);$t&&(rt.delete("cursor"),je(Ot,$t,y))}function je(y,_t,Lt){const Ct=$e(y,_t);Ct&&Jt(),Lt.shiftKey||tn(Ct)}function Ue(y){if("changedTouches"in y&&s){an(y);return}if(!s){if(w!=null&&w.size&&!q){rt.delete("cursor"),y.shiftKey||tn(!1);return}d&&Ne(y)}}function dn(y){if(!Xt){if(w!=null&&w.size&&!q&&!d)return gn();if(!d)return bn();Ne(y)}}function bn(){it===U?(Zt(fi,d={anchor:Ot,store:null,key:null},d),He(Ot,R)):it?(Zt(fi,d={anchor:Ot,store:dt,key:Dt},d),He(R,Ot)):U&&(Zt(fi,d={anchor:Ot,store:Ht,key:null},d),He(Ot,R))}function He(y,_t,Lt=!1){const Ct={color:It,label:{text:ne}};Lt&&(Ct.disconnect=!0),ae&&(Ct.type=ae),Qt[0]&&(Ct.start=Qt[0]),Qt[1]&&(Ct.start=Qt[1]);const At=Xs({source:y,target:_t},(y==null?void 0:y.edge)||null,Ct);rt.add(At,"cursor")}function Ne(y){if(rt.delete("cursor"),!d)return;const _t=d.anchor.type;if(d.anchor===Ot||_t===Ot.type&&_t){tn(!1);return}Ot.recalculatePosition();let Lt,Ct;it===U?_t==="input"?(Lt=Ot,Ct=d.anchor):(Lt=d.anchor,Ct=Ot):it?(Lt=d.anchor,Ct=Ot):(Lt=Ot,Ct=d.anchor),je(Lt,Ct,y)}function $e(y,_t){if(y===_t||bt(y.connected).has(Ot))return!1;const Lt={color:It,label:{text:ne}};if(Nt){const At=y.node.id.slice(2),O=Nt.nodeList[At];if(O){const $t=_t.node.id.slice(2),me=O.children.filter(Yt=>Yt.node.id===$t)[0];if(me){const Yt=me;Lt.label={text:Yt.content}}}}ae&&(Lt.type=ae),Qt[0]&&(Lt.start=Qt[0]),Qt[1]&&(Lt.start=Qt[1]);const Ct=Xs({source:y,target:_t},(y==null?void 0:y.edge)||null,Lt);return!y.node||!_t.node?!1:(rt.add(Ct,new Set([y,_t,y.node,_t.node])),!0)}function Jt(){if(it&&d&&d.store)u&&Dt&&dt&&typeof dt.set=="function"&&typeof dt.update=="function"&&Zt(dt,u[Dt]=d.store,u);else if(U&&d&&d.store){const{store:y,key:_t}=d;y&&_t&&typeof y.update=="function"&&y.update(Lt=>(Ht&&(Lt[_t]=Ht),Lt))}}function fe(){u&&Dt&&u[Dt]&&Zt(dt,u[Dt]=$(bt(u[Dt])),u)}function tn(y){(y||!g)&&(Zt(fi,d=null,d),Zt(ut,g=null,g))}function Tn(){Kt&&(Ce&&Ot.recalculatePosition(),Qo=requestAnimationFrame(Tn))}function pn(){rt.delete("cursor"),rt.match(Ot).forEach(_t=>rt.delete(_t)),tn(!1),fe()}function gn(){if(bt(Ot.connected).size>1)return;const y=Array.from(bt(Ot.connected))[0];if(y.type!=="input")if(pn(),y.type==="output"){He(y,R,!0),fe();const _t=y.store;Zt(fi,d={anchor:y,store:_t,key:null},d)}else He(y,R,!0),Zt(fi,d={anchor:y,store:null,key:null},d)}function En(){Ft.forEach((y,_t)=>{if(!y)return;Ye(y)&&i(26,Wt[_t]=null,Wt)}),i(41,Ft=Ft.filter(y=>y!==null))}function qe(){Wt.forEach(y=>{y&&Ye(y)})}function Pt(y){const _t=`N-${y[0]}`,Lt=j.get(_t);if(!Lt)return;const Ct=Lt.anchors.get(`A-${y[1]}/N-${y[0]}`);if(!Ct)return;const At=rt.match(Ot,Ct);At&&rt.delete(At[0])}const Ye=y=>{let _t,Lt,Ct=null;Array.isArray(y)?(_t=y[0].toString(),Lt=y[1].toString()):(_t=y.toString(),Lt=null);const At=`N-${_t}`,O=j.get(At);if(!O)return!1;if(Lt){const $t=`A-${Lt}/${At}`;Ct=O.anchors.get($t)||null}else{const $t=bt(O.anchors),me=Array.from($t.values());if(!me.length)return!1;Ct=me.reduce((Yt,Se)=>!Yt&&Se.type==="output"?null:Se.type==="output"?Yt:!Yt||bt(Se.connected).size<bt(Yt.connected).size?Se:Yt,null)}if(!Ct)return!1;if($e(Ot,Ct),Ct.store&&(dt||Ht)){if(it&&Ct.type==="output")u&&Dt&&dt&&typeof dt.set=="function"&&typeof dt.update=="function"&&Zt(dt,u[Dt]=Ct.store,u);else if(U&&Ct.type==="input"){const{store:$t,inputKey:me}=Ct;$t&&me&&typeof $t.update=="function"&&$t.update(Yt=>(Ht&&(Yt[me]=Ht),Yt))}}return!0},vn=()=>i(10,he=!0),en=()=>i(10,he=!1);function Bn(y){ii[y?"unshift":"push"](()=>{Ce=y,i(8,Ce)})}return n.$$set=y=>{"bgColor"in y&&i(0,yt=y.bgColor),"id"in y&&i(27,x=y.id),"input"in y&&i(1,it=y.input),"output"in y&&i(2,U=y.output),"multiple"in y&&i(28,q=y.multiple),"dynamic"in y&&i(29,Vt=y.dynamic),"edge"in y&&i(7,re=y.edge),"inputsStore"in y&&f(i(3,dt=y.inputsStore)),"key"in y&&i(30,Dt=y.key),"outputStore"in y&&i(31,Ht=y.outputStore),"connections"in y&&i(26,Wt=y.connections),"edgeColor"in y&&i(32,It=y.edgeColor),"edgeLabel"in y&&i(33,ne=y.edgeLabel),"locked"in y&&i(4,Xt=y.locked),"nodeConnect"in y&&i(34,ot=y.nodeConnect),"edgeStyle"in y&&i(35,ae=y.edgeStyle),"endStyles"in y&&i(36,Qt=y.endStyles),"invisible"in y&&i(5,Rt=y.invisible),"direction"in y&&i(37,se=y.direction),"title"in y&&i(6,Fe=y.title),"$$scope"in y&&i(54,st=y.$$scope)},n.$$.update=()=>{if(n.$$.dirty[1]&2048&&i(11,s=(d==null?void 0:d.anchor)===Ot),n.$$.dirty[0]&536871168|n.$$.dirty[1]&65536&&Vt&&Ce&&Rc(Ce,E,I),n.$$.dirty[0]&67108864|n.$$.dirty[1]&262144&&G===j.count()&&Wt.length&&qe(),n.$$.dirty[1]&4104&&ot&&g&&Ue(g),n.$$.dirty[1]&263168&&G===j.count()&&Ft.length&&En(),n.$$.dirty[0]&768|n.$$.dirty[1]&196608&&Ce&&Ot.recalculatePosition(),n.$$.dirty[1]&57600&&(!Kt&&(z||A||M)?(i(39,Kt=!0),Tn()):!z&&!A&&Kt&&!M&&(i(39,Kt=!1),cancelAnimationFrame(Qo))),n.$$.dirty[0]&512|n.$$.dirty[1]&512&&w){if(w.size<ze)De("disconnection",{node:I,anchor:Ot});else if(w.size>ze){const y=Array.from(w),_t=y[y.length-1];Ge("connection",{node:I,anchor:Ot,connectedNode:_t.node,connectedAnchor:_t})}i(40,ze=w.size)}},P(i(13,r=Ot&&Ot.connected)),H(i(12,l=Ot==null?void 0:Ot.direction)),[yt,it,U,dt,Xt,Rt,Fe,re,Ce,w,he,s,l,r,rt,pt,ut,kt,xe,Je,Qe,Sn,ye,Ot,Ue,dn,Wt,x,q,Vt,Dt,Ht,It,ne,ot,ae,Qt,se,Pt,Kt,ze,Ft,d,g,M,A,z,E,F,G,tt,vn,en,Bn,st]}class Ao extends Cn{constructor(e){super(),Ln(this,e,xc,Dc,mn,{bgColor:0,id:27,input:1,output:2,multiple:28,dynamic:29,edge:7,inputsStore:3,key:30,outputStore:31,connections:26,edgeColor:32,edgeLabel:33,locked:4,nodeConnect:34,edgeStyle:35,endStyles:36,invisible:5,direction:37,title:6,disconnect:38},null,[-1,-1,-1])}get disconnect(){return this.$$.ctx[38]}}function fr(n){let e,i,s,r,l;return{c(){e=T("div"),i=X(),s=T("div"),m(e,"class","left svelte-1ryxg7v"),te(e,"width",n[0]),m(s,"class","right svelte-1ryxg7v"),te(s,"width",n[0])},m(u,c){Q(u,e,c),Q(u,i,c),Q(u,s,c),r||(l=[Si(n[16].call(null,e,{left:n[3]})),Si(n[16].call(null,s,{right:n[4]}))],r=!0)},p(u,c){c[0]&1&&te(e,"width",u[0]),c[0]&1&&te(s,"width",u[0])},d(u){u&&(Y(e),Y(i),Y(s)),r=!1,fn(l)}}}function dr(n){let e,i,s,r,l;return{c(){e=T("div"),i=X(),s=T("div"),m(e,"class","top svelte-1ryxg7v"),te(e,"height",n[1]),m(s,"class","bottom svelte-1ryxg7v"),te(s,"height",n[1])},m(u,c){Q(u,e,c),Q(u,i,c),Q(u,s,c),r||(l=[Si(n[16].call(null,e,{top:n[5]})),Si(n[16].call(null,s,{bottom:n[6]}))],r=!0)},p(u,c){c[0]&2&&te(e,"height",u[1]),c[0]&2&&te(s,"height",u[1])},d(u){u&&(Y(e),Y(i),Y(s)),r=!1,fn(l)}}}function jc(n){let e,i,s;return{c(){e=T("div"),m(e,"class","svelte-1ryxg7v"),te(e,"both",n[7])},m(r,l){Q(r,e,l),i||(s=Si(n[16].call(null,e,{both:n[7]})),i=!0)},p:Ut,d(r){r&&Y(e),i=!1,s()}}}function _r(n){let e,i,s;return{c(){e=T("div"),m(e,"class","svelte-1ryxg7v"),te(e,"rotation",n[2])},m(r,l){Q(r,e,l),i||(s=Si(n[17].call(null,e)),i=!0)},p(r,l){l[0]&4&&te(e,"rotation",r[2])},d(r){r&&Y(e),i=!1,s()}}}function Hc(n){let e,i,s,r,l=n[0]&&fr(n),u=n[1]&&dr(n),c=n[7]&&jc(n),f=n[2]&&_r(n);return{c(){l&&l.c(),e=X(),u&&u.c(),i=X(),c&&c.c(),s=X(),f&&f.c(),r=Ze()},m(d,p){l&&l.m(d,p),Q(d,e,p),u&&u.m(d,p),Q(d,i,p),c&&c.m(d,p),Q(d,s,p),f&&f.m(d,p),Q(d,r,p)},p(d,p){d[0]?l?l.p(d,p):(l=fr(d),l.c(),l.m(e.parentNode,e)):l&&(l.d(1),l=null),d[1]?u?u.p(d,p):(u=dr(d),u.c(),u.m(i.parentNode,i)):u&&(u.d(1),u=null),d[7]&&c.p(d,p),d[2]?f?f.p(d,p):(f=_r(d),f.c(),f.m(r.parentNode,r)):f&&(f.d(1),f=null)},i:Ut,o:Ut,d(d){d&&(Y(e),Y(i),Y(s),Y(r)),l&&l.d(d),u&&u.d(d),c&&c.d(d),f&&f.d(d)}}}function Wc(n){return n*(180/Math.PI)}function Fc(n,e,i){let s,r,l,u,c,f,d,p,g,w,k,P;vt(n,Hn,dt=>i(38,d=dt));const M=ve("graph"),A=ve("node"),z=ve("resized");let{width:E=!1}=e,{height:B=!1}=e,{rotation:H=!1}=e,{minHeight:F=0}=e,{minWidth:G=0}=e,lt,K=E,tt=E,st=B,ht=B,I=E&&B,rt=0,R=0,mt=bt(A.position);const pt=A.position;vt(n,pt,dt=>i(32,k=dt));const J=A.resizingWidth;vt(n,J,dt=>i(31,w=dt));const j=A.resizingHeight;vt(n,j,dt=>i(30,g=dt));const Et=A.rotating;vt(n,Et,dt=>i(28,f=dt));const ut=A.rotation;vt(n,ut,dt=>i(29,p=dt));const kt=A.dimensions.height;vt(n,kt,dt=>i(26,u=dt));const Nt=A.dimensions.width;vt(n,Nt,dt=>i(27,c=dt));const yt=M.cursor;vt(n,yt,dt=>i(33,P=dt));let x,it,U=1;Xn(()=>{try{lt=document.querySelector(`#${A.id}`),lt&&i(19,[G,F]=qo(lt),G,i(18,F))}catch(dt){console.error(dt)}});function q(dt,Dt){const Ht=It=>{It.stopPropagation(),It.preventDefault(),Dt.left||Dt.top?i(23,U=-1):i(23,U=1),is.set(!0),Zt(Hn,d=bt(yt),d),i(21,x=c),i(22,it=u),i(20,mt=k),Dt.both?Zt(J,w=!0,w):Zt(J,w=!1,w),Zt(J,w=Dt.left||Dt.right||Dt.both||!1,w),Zt(j,g=Dt.top||Dt.bottom||Dt.both||!1,g),lt&&i(19,[G,F]=qo(lt),G,i(18,F)),window.addEventListener("mouseup",Wt)},Wt=()=>{Zt(J,w=!1,w),Zt(j,g=!1,g),is.set(!1),window.removeEventListener("mouseup",Wt)};return dt.addEventListener("mousedown",Ht),{destroy(){dt.removeEventListener("mousedown",Ht)}}}function Vt(dt){const Dt=Wt=>{Wt.stopPropagation(),Wt.preventDefault(),rt=p,Zt(Hn,d=bt(yt),d);const It=d.x-l.x,ne=d.y-l.y;R=Math.atan2(ne,It),Zt(Et,f=!0,f),window.addEventListener("mouseup",Ht)},Ht=()=>{Zt(Et,f=!1,f),window.removeEventListener("mouseup",Ht)};return dt.addEventListener("mousedown",Dt),{destroy(){dt.removeEventListener("mousedown",Dt)}}}function re(){const dt=bt(yt),Dt=dt.x-l.x,Ht=dt.y-l.y,Wt=Math.atan2(Ht,Dt),It=R-Wt;return rt-Wc(It)}return vu(()=>{lt&&i(19,[G,F]=qo(lt),G,i(18,F)),c<G&&z.set(!1),u<F&&z.set(!1)}),n.$$set=dt=>{"width"in dt&&i(0,E=dt.width),"height"in dt&&i(1,B=dt.height),"rotation"in dt&&i(2,H=dt.rotation),"minHeight"in dt&&i(18,F=dt.minHeight),"minWidth"in dt&&i(19,G=dt.minWidth)},n.$$.update=()=>{if(n.$$.dirty[0]&268435456|n.$$.dirty[1]&4&&f&&Zt(ut,p=re(),p),n.$$.dirty[0]&1624506368|n.$$.dirty[1]&4&&g){const dt=bt(Hn),Dt=P,Ht=Math.max(F,it+(Dt.y-dt.y)*U);Ht>F?(z.set(!0),Zt(kt,u=Ht,u)):z.set(!1),U===-1&&Zt(pt,k={x:mt.x,y:mt.y+Dt.y-dt.y},k),p!==0&&A.position.update(Wt=>({y:mt.y-(Ht-it)/2,x:Wt.x}))}if(n.$$.dirty[0]&548929536|n.$$.dirty[1]&5&&w){const dt=bt(Hn),Dt=P,Ht=Math.max(G,x+(Dt.x-dt.x)*U);Ht>G?(z.set(!0),Zt(Nt,c=Ht,c)):z.set(!1),U===-1&&Zt(pt,k={x:mt.x+Dt.x-dt.x,y:mt.y},k),p!==0&&A.position.update(Wt=>({x:mt.x-(Ht-x)/2,y:Wt.y}))}n.$$.dirty[1]&2&&i(25,s=k.x),n.$$.dirty[1]&2&&i(24,r=k.y),n.$$.dirty[0]&251658240&&(l={x:s+c/2,y:r+u/2})},[E,B,H,K,tt,st,ht,I,pt,J,j,Et,ut,kt,Nt,yt,q,Vt,F,G,mt,x,it,U,r,s,u,c,f,p,g,w,k,P]}class Gc extends Cn{constructor(e){super(),Ln(this,e,Fc,Hc,mn,{width:0,height:1,rotation:2,minHeight:18,minWidth:19},null,[-1,-1])}}function mr(n,e,i){const s=n.slice();return s[28]=e[i],s[34]=i,s}function pr(n,e,i){const s=n.slice();return s[28]=e[i],s[34]=i,s}function gr(n,e,i){const s=n.slice();return s[28]=e[i],s}function vr(n,e,i){const s=n.slice();return s[28]=e[i],s}function Uc(n){let e,i=[],s=new Map,r,l,u=[],c=new Map,f,d=Le({length:n[2]});const p=k=>k[34];for(let k=0;k<d.length;k+=1){let P=pr(n,d,k),M=p(P);s.set(M,i[k]=yr(M,P))}let g=Le({length:n[3]});const w=k=>k[34];for(let k=0;k<g.length;k+=1){let P=mr(n,g,k),M=w(P);c.set(M,u[k]=br(M,P))}return{c(){e=T("div");for(let k=0;k<i.length;k+=1)i[k].c();r=X(),l=T("div");for(let k=0;k<u.length;k+=1)u[k].c();m(e,"class","input-anchors svelte-j5bq7k"),te(e,"top",n[14]),te(e,"left",n[16]),m(l,"class","output-anchors svelte-j5bq7k"),te(l,"bottom",n[15]),te(l,"right",n[17])},m(k,P){Q(k,e,P);for(let M=0;M<i.length;M+=1)i[M]&&i[M].m(e,null);Q(k,r,P),Q(k,l,P);for(let M=0;M<u.length;M+=1)u[M]&&u[M].m(l,null);f=!0},p(k,P){P[0]&16388&&(d=Le({length:k[2]}),ke(),i=_i(i,P,p,1,k,d,s,e,oo,yr,null,pr),Pe()),P[0]&16392&&(g=Le({length:k[3]}),ke(),u=_i(u,P,w,1,k,g,c,l,oo,br,null,mr),Pe())},i(k){if(!f){for(let P=0;P<d.length;P+=1)Z(i[P]);for(let P=0;P<g.length;P+=1)Z(u[P]);f=!0}},o(k){for(let P=0;P<i.length;P+=1)W(i[P]);for(let P=0;P<u.length;P+=1)W(u[P]);f=!1},d(k){k&&(Y(e),Y(r),Y(l));for(let P=0;P<i.length;P+=1)i[P].d();for(let P=0;P<u.length;P+=1)u[P].d()}}}function qc(n){let e,i,s,r=Le({length:n[2]}),l=[];for(let p=0;p<r.length;p+=1)l[p]=wr(vr(n,r,p));const u=p=>W(l[p],1,1,()=>{l[p]=null});let c=Le({length:n[3]}),f=[];for(let p=0;p<c.length;p+=1)f[p]=kr(gr(n,c,p));const d=p=>W(f[p],1,1,()=>{f[p]=null});return{c(){for(let p=0;p<l.length;p+=1)l[p].c();e=X();for(let p=0;p<f.length;p+=1)f[p].c();i=Ze()},m(p,g){for(let w=0;w<l.length;w+=1)l[w]&&l[w].m(p,g);Q(p,e,g);for(let w=0;w<f.length;w+=1)f[w]&&f[w].m(p,g);Q(p,i,g),s=!0},p(p,g){if(g[0]&4){const w=r.length;r=Le({length:p[2]});let k;for(k=w;k<r.length;k+=1){const P=vr(p,r,k);l[k]?Z(l[k],1):(l[k]=wr(P),l[k].c(),Z(l[k],1),l[k].m(e.parentNode,e))}for(ke(),k=r.length;k<l.length;k+=1)u(k);Pe()}if(g[0]&8){const w=c.length;c=Le({length:p[3]});let k;for(k=w;k<c.length;k+=1){const P=gr(p,c,k);f[k]?Z(f[k],1):(f[k]=kr(P),f[k].c(),Z(f[k],1),f[k].m(i.parentNode,i))}for(ke(),k=c.length;k<f.length;k+=1)d(k);Pe()}},i(p){if(!s){for(let g=0;g<r.length;g+=1)Z(l[g]);for(let g=0;g<c.length;g+=1)Z(f[g]);s=!0}},o(p){l=l.filter(Boolean);for(let g=0;g<l.length;g+=1)W(l[g]);f=f.filter(Boolean);for(let g=0;g<f.length;g+=1)W(f[g]);s=!1},d(p){p&&(Y(e),Y(i)),Ai(l,p),Ai(f,p)}}}function yr(n,e){let i,s,r;return s=new Ao({props:{input:!0,direction:e[14]?"north":"west"}}),s.$on("connection",e[22]),s.$on("disconnection",e[23]),{key:n,first:null,c(){i=Ze(),_e(s.$$.fragment),this.first=i},m(l,u){Q(l,i,u),ue(s,l,u),r=!0},p(l,u){e=l},i(l){r||(Z(s.$$.fragment,l),r=!0)},o(l){W(s.$$.fragment,l),r=!1},d(l){l&&Y(i),ce(s,l)}}}function br(n,e){let i,s,r;return s=new Ao({props:{output:!0,direction:e[14]?"south":"east"}}),s.$on("connection",e[24]),s.$on("disconnection",e[25]),{key:n,first:null,c(){i=Ze(),_e(s.$$.fragment),this.first=i},m(l,u){Q(l,i,u),ue(s,l,u),r=!0},p(l,u){e=l},i(l){r||(Z(s.$$.fragment,l),r=!0)},o(l){W(s.$$.fragment,l),r=!1},d(l){l&&Y(i),ce(s,l)}}}function wr(n){let e,i;return e=new Ao({}),e.$on("connection",n[18]),e.$on("disconnection",n[19]),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function kr(n){let e,i;return e=new Ao({}),e.$on("connection",n[20]),e.$on("disconnection",n[21]),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Pr(n){let e,i;return e=new Gc({props:{width:!0,height:!0,rotation:!0}}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Vc(n){let e,i,s,r,l,u,c,f=`${n[1]}px`,d;const p=[qc,Uc],g=[];function w(P,M){return P[7]?0:1}i=w(n),s=g[i]=p[i](n);let k=n[6]&&Pr();return{c(){e=T("div"),s.c(),r=X(),l=T("p"),u=Be(n[5]),c=X(),k&&k.c(),m(l,"class","svelte-j5bq7k"),at(l,"color",n[4]),m(e,"class","default-node svelte-j5bq7k"),te(e,"selected",n[0]),at(e,"border-radius",f)},m(P,M){Q(P,e,M),g[i].m(e,null),b(e,r),b(e,l),b(l,u),b(e,c),k&&k.m(e,null),d=!0},p(P,M){s.p(P,M),(!d||M[0]&32)&&_n(u,P[5]),M[0]&16&&at(l,"color",P[4]),P[6]?k?M[0]&64&&Z(k,1):(k=Pr(),k.c(),Z(k,1),k.m(e,null)):k&&(ke(),W(k,1,1,()=>{k=null}),Pe()),(!d||M[0]&1)&&te(e,"selected",P[0]),M[0]&2&&f!==(f=`${P[1]}px`)&&at(e,"border-radius",f)},i(P){d||(Z(s),Z(k),d=!0)},o(P){W(s),W(k),d=!1},d(P){P&&Y(e),g[i].d(),k&&k.d()}}}function Xc(n,e,i){let s,r,l,u,c,f;const d=ve("dynamic"),p=ve("node");let{selected:g}=e;const w=p.label;vt(n,w,mt=>i(5,c=mt));const k=p.borderRadius;vt(n,k,mt=>i(1,s=mt));const P=p.textColor;vt(n,P,mt=>i(4,u=mt));const M=p.inputs;vt(n,M,mt=>i(2,r=mt));const A=p.outputs;vt(n,A,mt=>i(3,l=mt));const z=p.resizable;vt(n,z,mt=>i(6,f=mt));const E=bt(p.direction);let B=E==="TD",H=E==="TD",F=E!=="TD",G=E!=="TD";function lt(mt){Ve.call(this,n,mt)}function K(mt){Ve.call(this,n,mt)}function tt(mt){Ve.call(this,n,mt)}function st(mt){Ve.call(this,n,mt)}function ht(mt){Ve.call(this,n,mt)}function I(mt){Ve.call(this,n,mt)}function rt(mt){Ve.call(this,n,mt)}function R(mt){Ve.call(this,n,mt)}return n.$$set=mt=>{"selected"in mt&&i(0,g=mt.selected)},[g,s,r,l,u,c,f,d,w,k,P,M,A,z,B,H,F,G,lt,K,tt,st,ht,I,rt,R]}class Yc extends Cn{constructor(e){super(),Ln(this,e,Xc,Vc,mn,{selected:0},null,[-1,-1])}}const Kc=n=>({}),Lr=n=>({}),Jc=n=>({}),Cr=n=>({}),Qc=n=>({}),Sr=n=>({}),$c=n=>({}),Mr=n=>({}),th=n=>({selected:n[0]&2048}),Tr=n=>({grabHandle:n[50],selected:n[11],destroy:n[48]}),eh=n=>({selected:n[0]&2048}),Er=n=>({grabHandle:n[50],selected:n[11],destroy:n[48]});function Ar(n){let e,i,s,r,l,u,c,f,d,p,g,w,k,P,M,A=`${n[14].y}px`,z=`${n[14].x}px`,E=`rotate(${n[20]}deg)`,B,H,F;const G=[ih,nh],lt=[];function K(J,j){return J[12]?1:0}i=K(n),s=lt[i]=G[i](n);const tt=n[61].anchorWest,st=Me(tt,n,n[60],Mr),ht=n[61].anchorEast,I=Me(ht,n,n[60],Sr),rt=n[61].anchorNorth,R=Me(rt,n,n[60],Cr),mt=n[61].anchorSouth,pt=Me(mt,n,n[60],Lr);return{c(){e=T("div"),s.c(),r=X(),l=T("div"),st&&st.c(),c=X(),f=T("div"),I&&I.c(),p=X(),g=T("div"),R&&R.c(),k=X(),P=T("div"),pt&&pt.c(),m(l,"id",u=`anchors-west-${n[0].id}`),m(l,"class","anchors left svelte-1iknrz0"),m(f,"id",d=`anchors-east-${n[0].id}`),m(f,"class","anchors right svelte-1iknrz0"),m(g,"id",w=`anchors-north-${n[0].id}`),m(g,"class","anchors top svelte-1iknrz0"),m(P,"id",M=`anchors-south-${n[0].id}`),m(P,"class","anchors bottom svelte-1iknrz0"),m(e,"id",n[30]),m(e,"class","svelvet-node svelte-1iknrz0"),m(e,"role","button"),m(e,"title",n[10]),m(e,"tabindex",0),te(e,"selected",n[11]),te(e,"locked",n[16]||n[15]),at(e,"top",A),at(e,"left",z),at(e,"z-index",n[17]),at(e,"width",n[12]?n[19]+"px":"fit-content"),at(e,"height",n[12]?n[18]+"px":"fit-content"),at(e,"transform",E),at(e,"--prop-background-color",n[21]||(n[1]||n[2]?null:"transparent")),at(e,"--prop-text-color",n[22]),at(e,"--prop-border-color",n[23]),at(e,"--prop-selection-color",n[24]),at(e,"--prop-border-radius",n[25]?`${n[25]}px`:n[1]||n[2]?null:"0px"),at(e,"--prop-border-width",n[26]||(n[1]||n[2]?null:"0px"))},m(J,j){Q(J,e,j),lt[i].m(e,null),b(e,r),b(e,l),st&&st.m(l,null),b(e,c),b(e,f),I&&I.m(f,null),b(e,p),b(e,g),R&&R.m(g,null),b(e,k),b(e,P),pt&&pt.m(P,null),B=!0,H||(F=[ft(e,"contextmenu",ni(Vn(n[62]))),ft(e,"mouseup",n[49]),Si(n[50].call(null,e))],H=!0)},p(J,j){let Et=i;i=K(J),i===Et?lt[i].p(J,j):(ke(),W(lt[Et],1,1,()=>{lt[Et]=null}),Pe(),s=lt[i],s?s.p(J,j):(s=lt[i]=G[i](J),s.c()),Z(s,1),s.m(e,r)),st&&st.p&&(!B||j[1]&536870912)&&Ee(st,tt,J,J[60],B?Te(tt,J[60],j,$c):Ae(J[60]),Mr),(!B||j[0]&1&&u!==(u=`anchors-west-${J[0].id}`))&&m(l,"id",u),I&&I.p&&(!B||j[1]&536870912)&&Ee(I,ht,J,J[60],B?Te(ht,J[60],j,Qc):Ae(J[60]),Sr),(!B||j[0]&1&&d!==(d=`anchors-east-${J[0].id}`))&&m(f,"id",d),R&&R.p&&(!B||j[1]&536870912)&&Ee(R,rt,J,J[60],B?Te(rt,J[60],j,Jc):Ae(J[60]),Cr),(!B||j[0]&1&&w!==(w=`anchors-north-${J[0].id}`))&&m(g,"id",w),pt&&pt.p&&(!B||j[1]&536870912)&&Ee(pt,mt,J,J[60],B?Te(mt,J[60],j,Kc):Ae(J[60]),Lr),(!B||j[0]&1&&M!==(M=`anchors-south-${J[0].id}`))&&m(P,"id",M),(!B||j[0]&1024)&&m(e,"title",J[10]),(!B||j[0]&2048)&&te(e,"selected",J[11]),(!B||j[0]&98304)&&te(e,"locked",J[16]||J[15]),j[0]&16384&&A!==(A=`${J[14].y}px`)&&at(e,"top",A),j[0]&16384&&z!==(z=`${J[14].x}px`)&&at(e,"left",z),j[0]&131072&&at(e,"z-index",J[17]),j[0]&528384&&at(e,"width",J[12]?J[19]+"px":"fit-content"),j[0]&266240&&at(e,"height",J[12]?J[18]+"px":"fit-content"),j[0]&1048576&&E!==(E=`rotate(${J[20]}deg)`)&&at(e,"transform",E),j[0]&2097158&&at(e,"--prop-background-color",J[21]||(J[1]||J[2]?null:"transparent")),j[0]&4194304&&at(e,"--prop-text-color",J[22]),j[0]&8388608&&at(e,"--prop-border-color",J[23]),j[0]&16777216&&at(e,"--prop-selection-color",J[24]),j[0]&33554438&&at(e,"--prop-border-radius",J[25]?`${J[25]}px`:J[1]||J[2]?null:"0px"),j[0]&67108870&&at(e,"--prop-border-width",J[26]||(J[1]||J[2]?null:"0px"))},i(J){B||(Z(s),Z(st,J),Z(I,J),Z(R,J),Z(pt,J),B=!0)},o(J){W(s),W(st,J),W(I,J),W(R,J),W(pt,J),B=!1},d(J){J&&Y(e),lt[i].d(),st&&st.d(J),I&&I.d(J),R&&R.d(J),pt&&pt.d(J),H=!1,fn(F)}}}function nh(n){let e;const i=n[61].default,s=Me(i,n,n[60],Tr);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[0]&2048|l[1]&536870912)&&Ee(s,i,r,r[60],e?Te(i,r[60],l,th):Ae(r[60]),Tr)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function ih(n){let e,i,s;const r=n[61].default,l=Me(r,n,n[60],Er);return{c(){e=T("div"),l&&l.c(),zi(()=>n[63].call(e)),at(e,"width","fit-content"),at(e,"height","fit-content")},m(u,c){Q(u,e,c),l&&l.m(e,null),i=pu(e,n[63].bind(e)),s=!0},p(u,c){l&&l.p&&(!s||c[0]&2048|c[1]&536870912)&&Ee(l,r,u,u[60],s?Te(r,u[60],c,eh):Ae(u[60]),Er)},i(u){s||(Z(l,u),s=!0)},o(u){W(l,u),s=!1},d(u){u&&Y(e),l&&l.d(u),i()}}}function oh(n){let e,i,s=!n[13]&&Ar(n);return{c(){s&&s.c(),e=Ze()},m(r,l){s&&s.m(r,l),Q(r,e,l),i=!0},p(r,l){r[13]?s&&(ke(),W(s,1,1,()=>{s=null}),Pe()):s?(s.p(r,l),l[0]&8192&&Z(s,1)):(s=Ar(r),s.c(),Z(s,1),s.m(e.parentNode,e))},i(r){i||(Z(s),i=!0)},o(r){W(s),i=!1},d(r){r&&Y(e),s&&s.d(r)}}}const sh=new Set(["INPUT","SELECT","BUTTON","TEXTAREA"]);function rh(n,e,i){let s,r,l,u,c,f,d,p=Ut,g=()=>(p(),p=yn(Kt,O=>i(66,d=O)),Kt),w,k=Ut,P=()=>(k(),k=yn(Ft,O=>i(67,w=O)),Ft),M,A,z=Ut,E=()=>(z(),z=yn(le,O=>i(68,A=O)),le),B,H,F,G=Ut,lt=()=>(G(),G=yn(xe,O=>i(71,F=O)),xe),K,tt,st,ht=Ut,I=()=>(ht(),ht=yn(Ce,O=>i(16,st=O)),Ce),rt,R=Ut,mt=()=>(R(),R=yn(he,O=>i(73,rt=O)),he),pt,J,j,Et,ut=Ut,kt=()=>(ut(),ut=yn(ze,O=>i(75,Et=O)),ze),Nt,yt,x,it,U,q,Vt,re,dt,Dt,Ht,Wt;vt(n,Hn,O=>i(65,f=O)),vt(n,Yn,O=>i(70,H=O)),n.$$.on_destroy.push(()=>p()),n.$$.on_destroy.push(()=>k()),n.$$.on_destroy.push(()=>z()),n.$$.on_destroy.push(()=>G()),n.$$.on_destroy.push(()=>ht()),n.$$.on_destroy.push(()=>R()),n.$$.on_destroy.push(()=>ut());let{$$slots:It={},$$scope:ne}=e;const Xt=ve("mounted"),ot=ve("duplicate");vt(n,ot,O=>i(56,yt=O));const ae=ve("graphDOMElement");vt(n,ae,O=>i(74,J=O));const Qt=Gi();let{node:Rt}=e,{isDefault:se}=e,{useDefaults:Fe}=e,{center:Ge}=e,{nodeStore:De}=e,{locked:Ce}=e;I();let{groups:Kt}=e;g();let{maxZIndex:he}=e;mt();let{centerPoint:ze}=e;kt();let{cursor:Re}=e,{initialNodePositions:Ft}=e;P();let{activeGroup:le}=e;E();let{editing:xe}=e;lt();let{dimensionsProvided:Je=!1}=e,{title:Qe}=e;const Sn=$(0),ye=$(null);vt(n,ye,O=>i(64,c=O));const Xe=Rt.id,Ot=Rt.position;vt(n,Ot,O=>i(59,U=O));const an=Rt.dimensions.width;vt(n,an,O=>i(19,Nt=O));const je=Rt.dimensions.height;vt(n,je,O=>i(18,j=O));const Ue=Rt.selectionColor;vt(n,Ue,O=>i(24,Dt=O));const dn=Rt.editable;vt(n,dn,O=>i(72,K=O));const bn=Rt.locked;vt(n,bn,O=>i(15,tt=O));const He=Rt.zIndex;vt(n,He,O=>i(17,pt=O));const Ne=Rt.bgColor;vt(n,Ne,O=>i(21,Vt=O));const $e=Rt.borderRadius;vt(n,$e,O=>i(25,Ht=O));const Jt=Rt.textColor;vt(n,Jt,O=>i(22,re=O));const fe=Rt.group;vt(n,fe,O=>i(69,B=O));const tn=Rt.borderColor;vt(n,tn,O=>i(23,dt=O));const Tn=Rt.borderWidth;vt(n,Tn,O=>i(26,Wt=O));const pn=Rt.rotation;vt(n,pn,O=>i(20,q=O));const{selected:gn,hidden:En}=d,qe=En.nodes;vt(n,qe,O=>i(58,it=O));const Pt=gn.nodes;vt(n,Pt,O=>i(55,M=O));const Ye=$(!1);vt(n,Ye,O=>i(57,x=O)),Ie("node",Rt),Ie("anchorsMounted",Sn),Ie("resized",Ye),Ie("nodeConnectEvent",ye),Xn(()=>{if(Ge){const O={x:Et.x-Nt/2,y:Et.y-j/2};Rt.position.set(O),Yn.set(!0),Yn.set(!1)}Xt.update(O=>O+1)}),ro(()=>{r&&(M.delete(Rt),Pt.set(M)),Xt.update(O=>O-1)});function vn(){r?(Rt&&M.delete(Rt),Pt.set(M)):(Rt&&M.add(Rt),Pt.set(M))}function en(O){Zt(Hn,f=bt(Re),f),J.focus(),pt!==rt&&pt!==1/0&&Zt(He,pt=Zt(he,++rt,rt),pt);const $t=O.target;if(!sh.has($t.tagName)&&(O.preventDefault(),Qt("nodeClicked",{node:Rt,e:O}),!(st||tt))){if("touches"in O){if(O.touches&&O.touches.length>1)return}else O.button===2&&K&&Zt(xe,F=Rt,F);Zt(Yn,H=!0,H),Bn(O)}}function Bn(O){let $t,me,Yt=!1;const Se=B;Se&&($t=d[Se],me=bt($t.parent),Yt=me===Rt),Yt?Zt(le,A=Se,A):Zt(le,A="selected",A),!O.shiftKey&&r?Zt(le,A="selected",A):(!O.shiftKey&&!r&&!O.shiftKey&&(M.clear(),Pt.set(M)),vn()),Zt(Ft,w=cl(d.selected.nodes),w)}function y(){De.delete(Xe)}function _t(O){const $t=bt(Re),me=$t.x-f.x,Yt=$t.y-f.y;Math.abs(me)+Math.abs(Yt)<4&&Qt("nodeReleased",{e:O,node:Rt}),Zt(ye,c=O,c)}function Lt(O){return O.addEventListener("mousedown",en),O.addEventListener("touchstart",en),{destroy(){O.removeEventListener("mousedown",en),O.removeEventListener("touchstart",en)}}}function Ct(O){Ve.call(this,n,O)}function At(){j=this.clientHeight,je.set(j),Nt=this.clientWidth,an.set(Nt)}return n.$$set=O=>{"node"in O&&i(0,Rt=O.node),"isDefault"in O&&i(1,se=O.isDefault),"useDefaults"in O&&i(2,Fe=O.useDefaults),"center"in O&&i(51,Ge=O.center),"nodeStore"in O&&i(52,De=O.nodeStore),"locked"in O&&I(i(3,Ce=O.locked)),"groups"in O&&g(i(4,Kt=O.groups)),"maxZIndex"in O&&mt(i(5,he=O.maxZIndex)),"centerPoint"in O&&kt(i(6,ze=O.centerPoint)),"cursor"in O&&i(53,Re=O.cursor),"initialNodePositions"in O&&P(i(7,Ft=O.initialNodePositions)),"activeGroup"in O&&E(i(8,le=O.activeGroup)),"editing"in O&&lt(i(9,xe=O.editing)),"dimensionsProvided"in O&&i(54,Je=O.dimensionsProvided),"title"in O&&i(10,Qe=O.title),"$$scope"in O&&i(60,ne=O.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&268435456&&i(14,s=U),n.$$.dirty[0]&1|n.$$.dirty[1]&16777216&&i(11,r=M.has(Rt)),n.$$.dirty[0]&1|n.$$.dirty[1]&134217728&&i(13,l=it.has(Rt)),n.$$.dirty[1]&75497472&&i(12,u=Je||x),n.$$.dirty[0]&2049|n.$$.dirty[1]&33554432&&r&&yt&&Qt("duplicate",Rt)},[Rt,se,Fe,Ce,Kt,he,ze,Ft,le,xe,Qe,r,u,l,s,tt,st,pt,j,Nt,q,Vt,re,dt,Dt,Ht,Wt,ot,ae,ye,Xe,Ot,an,je,Ue,dn,bn,He,Ne,$e,Jt,fe,tn,Tn,pn,qe,Pt,Ye,y,_t,Lt,Ge,De,Re,Je,M,yt,x,it,U,ne,It,Ct,At]}class ah extends Cn{constructor(e){super(),Ln(this,e,rh,oh,mn,{node:0,isDefault:1,useDefaults:2,center:51,nodeStore:52,locked:3,groups:4,maxZIndex:5,centerPoint:6,cursor:53,initialNodePositions:7,activeGroup:8,editing:9,dimensionsProvided:54,title:10},null,[-1,-1,-1])}}const lh=n=>({selected:n[1]&262144,grabHandle:n[1]&524288,node:n[0]&128,destroy:n[1]&131072}),zr=n=>({selected:n[49],grabHandle:n[50],disconnect:n[14],connect:n[13],node:n[7],destroy:n[48]}),uh=n=>({}),Nr=n=>({slot:"anchorWest"}),ch=n=>({}),Ir=n=>({slot:"anchorEast"}),hh=n=>({}),Or=n=>({slot:"anchorNorth"}),fh=n=>({}),Br=n=>({slot:"anchorSouth"});function Zr(n){let e,i;return e=new ah({props:{node:n[7],center:n[5]||n[0]==="center",isDefault:n[8],useDefaults:n[4],dimensionsProvided:!!n[1]||!!n[2]||!!n[3]||n[8]||!1,nodeStore:n[11].nodes,locked:n[11].locked,groups:n[11].groups,title:n[6],maxZIndex:n[11].maxZIndex,centerPoint:n[11].center,cursor:n[11].cursor,activeGroup:n[11].activeGroup,editing:n[11].editing,initialNodePositions:n[11].initialNodePositions,$$slots:{anchorSouth:[vh],anchorNorth:[gh],anchorEast:[ph],anchorWest:[mh],default:[_h,({destroy:s,selected:r,grabHandle:l})=>({48:s,49:r,50:l}),({destroy:s,selected:r,grabHandle:l})=>[0,(s?131072:0)|(r?262144:0)|(l?524288:0)]]},$$scope:{ctx:n}}}),e.$on("nodeClicked",n[41]),e.$on("nodeMount",n[42]),e.$on("nodeReleased",n[43]),e.$on("duplicate",n[44]),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},p(s,r){const l={};r[0]&128&&(l.node=s[7]),r[0]&33&&(l.center=s[5]||s[0]==="center"),r[0]&256&&(l.isDefault=s[8]),r[0]&16&&(l.useDefaults=s[4]),r[0]&270&&(l.dimensionsProvided=!!s[1]||!!s[2]||!!s[3]||s[8]||!1),r[0]&64&&(l.title=s[6]),r[0]&384|r[1]&933888&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Dr(n){let e,i;return e=new Yc({props:{selected:n[49]}}),e.$on("connection",n[39]),e.$on("disconnection",n[40]),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},p(s,r){const l={};r[1]&262144&&(l.selected=s[49]),e.$set(l)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function dh(n){let e,i,s=n[8]&&Dr(n);return{c(){s&&s.c(),e=Ze()},m(r,l){s&&s.m(r,l),Q(r,e,l),i=!0},p(r,l){r[8]?s?(s.p(r,l),l[0]&256&&Z(s,1)):(s=Dr(r),s.c(),Z(s,1),s.m(e.parentNode,e)):s&&(ke(),W(s,1,1,()=>{s=null}),Pe())},i(r){i||(Z(s),i=!0)},o(r){W(s),i=!1},d(r){r&&Y(e),s&&s.d(r)}}}function _h(n){let e;const i=n[38].default,s=Me(i,n,n[45],zr),r=s||dh(n);return{c(){r&&r.c()},m(l,u){r&&r.m(l,u),e=!0},p(l,u){s?s.p&&(!e||u[0]&128|u[1]&933888)&&Ee(s,i,l,l[45],e?Te(i,l[45],u,lh):Ae(l[45]),zr):r&&r.p&&(!e||u[0]&256|u[1]&262144)&&r.p(l,e?u:[-1,-1])},i(l){e||(Z(r,l),e=!0)},o(l){W(r,l),e=!1},d(l){r&&r.d(l)}}}function mh(n){let e;const i=n[38].anchorWest,s=Me(i,n,n[45],Nr);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&16384)&&Ee(s,i,r,r[45],e?Te(i,r[45],l,uh):Ae(r[45]),Nr)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function ph(n){let e;const i=n[38].anchorEast,s=Me(i,n,n[45],Ir);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&16384)&&Ee(s,i,r,r[45],e?Te(i,r[45],l,ch):Ae(r[45]),Ir)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function gh(n){let e;const i=n[38].anchorNorth,s=Me(i,n,n[45],Or);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&16384)&&Ee(s,i,r,r[45],e?Te(i,r[45],l,hh):Ae(r[45]),Or)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function vh(n){let e;const i=n[38].anchorSouth,s=Me(i,n,n[45],Br);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&16384)&&Ee(s,i,r,r[45],e?Te(i,r[45],l,fh):Ae(r[45]),Br)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function yh(n){let e=n[7]&&n[10].get(n[7].id),i,s,r=e&&Zr(n);return{c(){r&&r.c(),i=Ze()},m(l,u){r&&r.m(l,u),Q(l,i,u),s=!0},p(l,u){u[0]&1152&&(e=l[7]&&l[10].get(l[7].id)),e?r?(r.p(l,u),u[0]&1152&&Z(r,1)):(r=Zr(l),r.c(),Z(r,1),r.m(i.parentNode,i)):r&&(ke(),W(r,1,1,()=>{r=null}),Pe())},i(l){s||(Z(r),s=!0)},o(l){W(r),s=!1},d(l){l&&Y(i),r&&r.d(l)}}}function bh(n,e,i){let s,r,l=Ut,u=()=>(l(),l=yn(s,ot=>i(37,r=ot)),s),c;n.$$.on_destroy.push(()=>l());let{$$slots:f={},$$scope:d}=e;const p=as(f),g=ve("graph"),w=ve("group");let{position:k={x:0,y:0}}=e,{drop:P=!1}=e,{dimensions:M=null}=e,{id:A=0}=e,{bgColor:z=null}=e,{borderRadius:E=null}=e,{borderColor:B=null}=e,{borderWidth:H=null}=e,{selectionColor:F=null}=e,{textColor:G=null}=e,{resizable:lt=!1}=e,{label:K=""}=e,{inputs:tt=1}=e,{outputs:st=1}=e,{width:ht=null}=e,{height:I=null}=e,{TD:rt=!1}=e,{LR:R=!1}=e,{zIndex:mt=1}=e,{editable:pt=!0}=e,{locked:J=!1}=e,{rotation:j=0}=e,{edge:Et=null}=e,{connections:ut=[]}=e,{useDefaults:kt=!1}=e,{center:Nt=!1}=e,{dynamic:yt=!1}=e,{title:x=""}=e;const it=g.nodes;vt(n,it,ot=>i(10,c=ot)),Ie("dynamic",yt);let U,q=!0;Xn(()=>{const ot=rt?"TD":R?"LR":g.direction,ae=g.groupBoxes.get(w),Qt=g.nodes.count()+1;i(8,q=!p.default),(p.anchorWest||p.anchorEast||p.anchorNorth||p.anchorSouth)&&i(8,q=!1);const Rt=M||(ht||I?{width:ht||I||200,height:I||ht||100}:q?{width:200,height:100}:{width:0,height:0}),se={id:A||Qt,position:P==="cursor"?{x:bt(g.cursor).x,y:bt(g.cursor).y}:ae?{x:bt(ae.position).x+k.x,y:bt(ae.position).y+k.y}:k,dimensions:Rt,editable:pt||g.editable,label:K,group:w,resizable:lt,inputs:tt,outputs:st,zIndex:mt,direction:ot,locked:J,rotation:j};ut.length&&(se.connections=ut),H&&(se.borderWidth=H),E&&(se.borderRadius=E),B&&(se.borderColor=B),F&&(se.selectionColor=F),G&&(se.textColor=G),z&&(se.bgColor=z),Et&&(se.edge=Et),i(7,U=Cu(se)),ae&&g.groups.update(Fe=>{const Ge=bt(Fe[w].nodes);return Fe[w].nodes.set(new Set([...Ge,U])),Fe}),g.nodes.add(U,U.id)}),ro(()=>{g.nodes.delete(U.id)});function Vt(ot){U&&U.connections.set([ot])}function re(ot){if(!U)return;(Array.isArray(ot)?ot:[ot]).forEach(Qt=>{const[Rt,se]=Array.isArray(Qt)?Qt:[Qt,null],Fe=`N-${Rt}`,Ge=g.nodes.get(Fe);if(!Ge)return;let De=null;const Ce=se?`A-${se}/${Fe}`:null;Ce&&(De=Ge.anchors.get(Ce));const Kt=g.edges.match(U,Ge,De);Kt.length&&g.edges.delete(Kt[Kt.length-1])})}Ie("connect",Vt),Ie("disconnect",re);let dt=k;function Dt(ot){Ve.call(this,n,ot)}function Ht(ot){Ve.call(this,n,ot)}function Wt(ot){Ve.call(this,n,ot)}function It(ot){Ve.call(this,n,ot)}function ne(ot){Ve.call(this,n,ot)}function Xt(ot){Ve.call(this,n,ot)}return n.$$set=ot=>{"position"in ot&&i(15,k=ot.position),"drop"in ot&&i(0,P=ot.drop),"dimensions"in ot&&i(1,M=ot.dimensions),"id"in ot&&i(16,A=ot.id),"bgColor"in ot&&i(17,z=ot.bgColor),"borderRadius"in ot&&i(18,E=ot.borderRadius),"borderColor"in ot&&i(19,B=ot.borderColor),"borderWidth"in ot&&i(20,H=ot.borderWidth),"selectionColor"in ot&&i(21,F=ot.selectionColor),"textColor"in ot&&i(22,G=ot.textColor),"resizable"in ot&&i(23,lt=ot.resizable),"label"in ot&&i(24,K=ot.label),"inputs"in ot&&i(25,tt=ot.inputs),"outputs"in ot&&i(26,st=ot.outputs),"width"in ot&&i(2,ht=ot.width),"height"in ot&&i(3,I=ot.height),"TD"in ot&&i(27,rt=ot.TD),"LR"in ot&&i(28,R=ot.LR),"zIndex"in ot&&i(29,mt=ot.zIndex),"editable"in ot&&i(30,pt=ot.editable),"locked"in ot&&i(31,J=ot.locked),"rotation"in ot&&i(32,j=ot.rotation),"edge"in ot&&i(33,Et=ot.edge),"connections"in ot&&i(34,ut=ot.connections),"useDefaults"in ot&&i(4,kt=ot.useDefaults),"center"in ot&&i(5,Nt=ot.center),"dynamic"in ot&&i(35,yt=ot.dynamic),"title"in ot&&i(6,x=ot.title),"$$scope"in ot&&i(45,d=ot.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&128|n.$$.dirty[1]&8&&U&&U.connections.set(ut),n.$$.dirty[0]&131200&&U&&U.bgColor.set(z),n.$$.dirty[0]&16777344&&U&&U.label.set(K),n.$$.dirty[0]&4194432&&U&&U.textColor.set(G),n.$$.dirty[0]&524416&&U&&U.borderColor.set(B),n.$$.dirty[0]&2097280&&U&&U.selectionColor.set(F),n.$$.dirty[0]&8388736&&U&&U.resizable.set(lt),n.$$.dirty[0]&1073741952&&U&&U.editable.set(pt),n.$$.dirty[0]&128|n.$$.dirty[1]&1&&U&&U.locked.set(J),n.$$.dirty[0]&33554560&&U&&U.inputs.set(tt),n.$$.dirty[0]&67108992&&U&&U.outputs.set(st),n.$$.dirty[0]&536871040&&U&&U.zIndex.set(mt),n.$$.dirty[0]&128&&u(i(9,s=U&&(U==null?void 0:U.position))),n.$$.dirty[0]&32896|n.$$.dirty[1]&96&&U){const{x:ot,y:ae}=dt,{x:Qt,y:Rt}=r,{x:se,y:Fe}=k;(se!==Qt||Fe!==Rt)&&(se!==ot||Fe!==ae?(i(36,dt=k),U.position.set(k)):(i(36,dt=r),i(15,k=r)))}n.$$.dirty[0]&33554560&&U&&U.inputs.set(tt),n.$$.dirty[0]&67108992&&U&&U.outputs.set(st)},[P,M,ht,I,kt,Nt,x,U,q,s,c,g,it,Vt,re,k,A,z,E,B,H,F,G,lt,K,tt,st,rt,R,mt,pt,J,j,Et,ut,yt,dt,r,f,Dt,Ht,Wt,It,ne,Xt,d]}class ls extends Cn{constructor(e){super(),Ln(this,e,bh,yh,mn,{position:15,drop:0,dimensions:1,id:16,bgColor:17,borderRadius:18,borderColor:19,borderWidth:20,selectionColor:21,textColor:22,resizable:23,label:24,inputs:25,outputs:26,width:2,height:3,TD:27,LR:28,zIndex:29,editable:30,locked:31,rotation:32,edge:33,connections:34,useDefaults:4,center:5,dynamic:35,title:6},null,[-1,-1])}}function wh(n){n.parentNodes.forEach(l=>kh(l));const[e,i]=Ph(n);Lh(e,n),Ch(e);for(let l=0;l<10;l++){let u=!1;for(let c=0;c<=i;c++)if(e[c])for(let f=0;f<e[c].length;f++){const d=e[c][f],p=Mh(e,d,f);p&&(Ei(e[c],f,p),u=!0)}if(!u)break}const s=Th(e);for(let l=0;l<10&&Eh(e,s);l++);for(let l=0;l<2;l++){let u=!1;for(let c=0;c<=i;c++)for(let f=0;f<e[c].length;f++){const d=e[c][f],p=Sh(e,d,f);p&&(Ei(e[c],f,p),u=!0)}if(!u)break}const r=[];for(let l=0;l<=i;l++)r.push(e[l]);return r}function kh(n,e=0,i=0){const s=[],r=(l,u=0,c=0)=>{l.depth=Math.max(l.depth,u),l.nesting=Math.max(l.nesting,c),s.push(l);for(const f of l.children){const{node:d,length:p}=f;r(d,p+u,c+1)}};r(n,e,i);for(const l of s)if(l.children.length){l.nesting=l.children[0].node.nesting-1,l.depth=l.children[0].node.depth-l.children[0].length;for(const u of l.children)l.nesting=Math.min(l.nesting,u.node.nesting-1),l.depth=Math.min(l.depth,u.node.depth-u.length)}}function Ph(n){let e=0;const i={};for(const s in n.nodeList){const{depth:r,parents:l,children:u,type:c,data:f}=n.nodeList[s];e=Math.max(e,r),i[r]||(i[r]=[]);const d={id:s,label:f.content,children:[],parents:[],layer:r,type:c.trim()};f.props&&(d.propsId=f.props.trim());for(const p of l)d.parents.push(p.node.id);for(const p of u)d.children.push(p.node.id);i[r].push(d)}return[i,e]}function Lh(n,e){for(const i in e.nodeList)for(const s of e.nodeList[i].children)if(s.node.depth-1>e.nodeList[i].depth){const r=e.nodeList[i].depth+1,l=s.node.depth-1,u=[];let c=0;for(let f=r;f<=l;f++){const d={id:`GHOST_${s.node.id}_${c}`,label:"",children:[],parents:[],layer:f,ignore:!0};u.push(d),c++}for(const f of s.node.parents)u[0].parents.push(f.node.id);u[u.length-1].children.push(s.node.id);for(let f=0;f<u.length-1;f++)u[f].children.push(`GHOST_${s.node.id}_${f+1}`);for(let f=l;f>=r;f--)u.length>0&&n[f].push(u[0]);for(const f of n[e.nodeList[i].depth])f.id===i&&(f.children.push(u[0].id),f.children=f.children.filter(d=>d!==s.node.id))}}function Ch(n){let e=0;for(const i in n)e=Math.max(n[i].length,e);for(const i in n)if(n[i].length<e){const s=Array.from({length:e-n[i].length},()=>({id:"NULL_NODE",children:[],parents:[],layer:parseInt(i),ignore:!0}));n[i]=n[i].concat(s)}}function Rr(n,e,i){let s=0,r=0;for(const l of e.parents){for(let u=0;u<n[e.layer-1].length;u++)if(l===n[e.layer-1][u].id){s+=Math.abs(i-u);break}r++}for(const l of e.children){for(let u=0;u<n[e.layer+1].length;u++)if(l===n[e.layer+1][u].id){s+=Math.abs(i-u);break}r++}return isNaN(s/r)?0:s/r}function xr(n,e,i){let s=0,r=0;for(const l of e.parents){for(let u=0;u<n[e.layer-1].length;u++)if(l===n[e.layer-1][u].id){s+=Math.abs(i-u);break}r++}return isNaN(s/r)?0:s/r}function jr(n,e,i){let s=0,r=0;for(const l of e.children){for(let u=0;u<n[e.layer+1].length;u++)if(l===n[e.layer+1][u].id){s+=Math.abs(i-u);break}r++}return isNaN(s/r)?0:s/r}function Sh(n,e,i){const s=os(n,e.layer);let r=0;e.layer===0?r=jr(n,e,i):r=xr(n,e,i);let l=r,u=i;for(let c=0;c<n[e.layer].length;c++)if(n[e.layer][c].id==="NULL_NODE"){Ei(n[e.layer],i,c);const d=os(n,e.layer);let p=0;e.layer===0?p=jr(n,e,c):p=xr(n,e,c),d<=s&&p<l&&(l=p,u=c),Ei(n[e.layer],c,i)}return u===i?null:u}function Mh(n,e,i){const s={};let r=1/0,l=0;for(let u=0;u<n[e.layer].length;u++){const c=Rr(n,e,u),f=Rr(n,n[e.layer][u],i);s[u]=c+f}for(const u in s)s[u]<r&&(r=s[u],l=parseInt(u));return l===i?null:l}function Ei(n,e,i){const s=n[e];n[e]=n[i],n[i]=s}function Th(n){const e=[];for(const i in n)for(const s of n[i])e.push(s);return e.sort((i,s)=>s.parents.length+s.children.length-(i.parents.length+i.children.length))}function os(n,e){let i=0;for(let s=0;s<n[e].length;s++){const r=n[e][s],l=[],u=[];if(n[e-1])for(let c=s+1;c<n[e-1].length;c++)r.parents.includes(n[e-1][c].id)&&l.push(c);if(n[e+1])for(let c=s+1;c<n[e+1].length;c++)r.children.includes(n[e+1][c].id)&&u.push(c);for(let c=s+1;c<n[e].length;c++){const f=n[e][c];if(l.length)for(let d=0;d<n[e-1].length;d++)f.parents.includes(n[e-1][d].id)&&l.forEach(p=>{d<p&&i++});if(u.length)for(let d=0;d<n[e+1].length;d++)f.children.includes(n[e+1][d].id)&&u.forEach(p=>{d<p&&i++})}}return i}function Eh(n,e){let i=!1;for(const s of e){if(s.children.length+s.parents.length===0)return i;let r=0;for(let c=0;c<n[s.layer].length;c++)if(n[s.layer][c].id===s.id){r=c;break}let l=1/0,u=r;for(let c=0;c<n[s.layer].length;c++){Ei(n[s.layer],r,c);const f=os(n,s.layer);f<l&&(l=f,u=c),Ei(n[s.layer],c,r)}u!==r&&(Ei(n[s.layer],r,u),i=!0)}return i}function Hr(n,e,i){const s=n.slice();return s[6]=e[i],s}function Wr(n,e,i){const s=n.slice();return s[9]=e[i],s}function Ah(n){let e,i;const s=[{label:n[9].label},{id:n[9].id},{TD:!0},n[0][n[9].id],{connections:n[9].children.map(Ur)}];let r={};for(let l=0;l<s.length;l+=1)r=rs(r,s[l]);return e=new ls({props:r}),{c(){_e(e.$$.fragment)},m(l,u){ue(e,l,u),i=!0},p(l,u){const c=u&3?il(s,[u&2&&{label:l[9].label},u&2&&{id:l[9].id},s[2],ol(l[0][l[9].id]),u&2&&{connections:l[9].children.map(Ur)}]):{};e.$set(c)},i(l){i||(Z(e.$$.fragment,l),i=!0)},o(l){W(e.$$.fragment,l),i=!1},d(l){ce(e,l)}}}function Fr(n){let e,i,s=!n[9].ignore&&Ah(n);return{c(){s&&s.c(),e=Ze()},m(r,l){s&&s.m(r,l),Q(r,e,l),i=!0},p(r,l){r[9].ignore||s.p(r,l)},i(r){i||(Z(s),i=!0)},o(r){W(s),i=!1},d(r){r&&Y(e),s&&s.d(r)}}}function Gr(n){let e,i,s=Le(n[6]),r=[];for(let u=0;u<s.length;u+=1)r[u]=Fr(Wr(n,s,u));const l=u=>W(r[u],1,1,()=>{r[u]=null});return{c(){for(let u=0;u<r.length;u+=1)r[u].c();e=Ze()},m(u,c){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(u,c);Q(u,e,c),i=!0},p(u,c){if(c&3){s=Le(u[6]);let f;for(f=0;f<s.length;f+=1){const d=Wr(u,s,f);r[f]?(r[f].p(d,c),Z(r[f],1)):(r[f]=Fr(d),r[f].c(),Z(r[f],1),r[f].m(e.parentNode,e))}for(ke(),f=s.length;f<r.length;f+=1)l(f);Pe()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)Z(r[c]);i=!0}},o(u){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)W(r[c]);i=!1},d(u){u&&Y(e),Ai(r,u)}}}function zh(n){let e,i,s=Le(n[1]),r=[];for(let u=0;u<s.length;u+=1)r[u]=Gr(Hr(n,s,u));const l=u=>W(r[u],1,1,()=>{r[u]=null});return{c(){for(let u=0;u<r.length;u+=1)r[u].c();e=Ze()},m(u,c){for(let f=0;f<r.length;f+=1)r[f]&&r[f].m(u,c);Q(u,e,c),i=!0},p(u,[c]){if(c&3){s=Le(u[1]);let f;for(f=0;f<s.length;f+=1){const d=Hr(u,s,f);r[f]?(r[f].p(d,c),Z(r[f],1)):(r[f]=Gr(d),r[f].c(),Z(r[f],1),r[f].m(e.parentNode,e))}for(ke(),f=s.length;f<r.length;f+=1)l(f);Pe()}},i(u){if(!i){for(let c=0;c<s.length;c+=1)Z(r[c]);i=!0}},o(u){r=r.filter(Boolean);for(let c=0;c<r.length;c+=1)W(r[c]);i=!1},d(u){u&&Y(e),Ai(r,u)}}}const Nh=100,Ih=100,Ur=n=>[n,"1"];function Oh(n,e,i){let{mermaid:s=""}=e,{mermaidConfig:r={}}=e;const l=Hu(s);Ie("flowchart",l);const u=wh(l),c=ve("graph");let f;return Xn(()=>{c.nodes.subscribe(p=>f=Object.fromEntries(p));let d=0;for(const p of u){let g=0,w=-1/0;for(const k of p)k.ignore||(f[`N-${k.id}`].position.update(()=>({x:g,y:d})),f[`N-${k.id}`].dimensions.width.subscribe(P=>g+=P),f[`N-${k.id}`].dimensions.height.subscribe(P=>w=Math.max(w,P))),g+=Nh;d+=w+Ih}}),n.$$set=d=>{"mermaid"in d&&i(2,s=d.mermaid),"mermaidConfig"in d&&i(0,r=d.mermaidConfig)},[r,u,s]}class Bh extends Cn{constructor(e){super(),Ln(this,e,Oh,zh,mn,{mermaid:2,mermaidConfig:0})}}const Zh="modulepreload",Dh=function(n){return"/"+n},qr={},Qi=function(e,i,s){let r=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),c=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));r=Promise.allSettled(i.map(f=>{if(f=Dh(f),f in qr)return;qr[f]=!0;const d=f.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${p}`))return;const g=document.createElement("link");if(g.rel=d?"stylesheet":Zh,d||(g.as="script"),g.crossOrigin="",g.href=f,c&&g.setAttribute("nonce",c),document.head.appendChild(g),d)return new Promise((w,k)=>{g.addEventListener("load",w),g.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(u){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=u,window.dispatchEvent(c),!c.defaultPrevented)throw u}return r.then(u=>{for(const c of u||[])c.status==="rejected"&&l(c.reason);return e().catch(l)})},Rh=["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"],xh=new Set(Rh),Vr=n=>xh.has(n);function jh(n){let e,i,s;return{c(){e=T("input"),m(e,"placeholder",n[0]),m(e,"type","text")},m(r,l){Q(r,e,l),Oe(e,n[1]),i||(s=[ft(e,"keydown",ni(n[3])),ft(e,"click",ni(n[4])),ft(e,"mousedown",ni(n[5])),ft(e,"input",n[6])],i=!0)},p(r,[l]){l&1&&m(e,"placeholder",r[0]),l&2&&e.value!==r[1]&&Oe(e,r[1])},i:Ut,o:Ut,d(r){r&&Y(e),i=!1,fn(s)}}}function Hh(n,e,i){let s,{placeholder:r}=e;const l=ve("textStore");vt(n,l,p=>i(1,s=p));function u(p){Ve.call(this,n,p)}function c(p){Ve.call(this,n,p)}function f(p){Ve.call(this,n,p)}function d(){s=this.value,l.set(s)}return n.$$set=p=>{"placeholder"in p&&i(0,r=p.placeholder)},[r,s,l,u,c,f,d]}class Wh extends Cn{constructor(e){super(),Ln(this,e,Hh,jh,mn,{placeholder:0})}}function Fh(n){let e,i,s,r,l,u,c,f,d,p,g,w,k;return u=new Wh({props:{placeholder:"Node Label"}}),{c(){e=T("div"),i=T("span"),i.textContent="Editor",s=X(),r=T("button"),r.textContent="X",l=X(),_e(u.$$.fragment),c=X(),f=T("button"),f.textContent="Delete Node",d=X(),p=T("button"),p.textContent="Resize Node",at(i,"color","white"),at(i,"font-size","45px"),at(r,"position","absolute"),at(r,"top","10px"),at(r,"right","10px"),m(e,"class","editor svelte-1nv0yho")},m(P,M){Q(P,e,M),b(e,i),b(e,s),b(e,r),b(e,l),ue(u,e,null),b(e,c),b(e,f),b(e,d),b(e,p),g=!0,w||(k=[ft(r,"click",n[6]),ft(f,"click",n[3]),ft(p,"click",n[4]),ft(e,"contextmenu",n[2])],w=!0)},p:Ut,i(P){g||(Z(u.$$.fragment,P),g=!0)},o(P){W(u.$$.fragment,P),g=!1},d(P){P&&Y(e),ce(u),w=!1,fn(k)}}}function Gh(n){let e,i;return e=new ls({props:{zIndex:1/0,position:n[0],bgColor:"white",id:"editor",$$slots:{default:[Fh]},$$scope:{ctx:n}}}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},p(s,[r]){const l={};r&1&&(l.position=s[0]),r&512&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Uh(n,e,i){let{editing:s}=e;const r=ve("graph");Ie("graph",r),Ie("textStore",s.label),Ie("colorStore",s.bgColor);let l={x:150,y:50};function u(p){p.preventDefault(),i(0,l={x:p.clientX,y:p.clientY}),r.editing.set(s)}function c(){r.nodes.delete(s.id),r.editing.set(null)}function f(){const p=s.id,g=r.nodes.get(p);if(g){const w=g.dimensions.width,k=g.dimensions.height,P=prompt("Enter new width (for example:250):",w?w.toString():""),M=prompt("Enter new height (for example:200):",k?k.toString():"");if(P===null||M===null)return;g.dimensions.width.set(parseInt(P,10)||0),g.dimensions.height.set(parseInt(M,10)||0),g.resizingWidth.set(!0),g.resizingHeight.set(!0)}}const d=()=>r.editing.set(null);return n.$$set=p=>{"editing"in p&&i(5,s=p.editing)},r.cursor,[l,r,u,c,f,s,d]}class qh extends Cn{constructor(e){super(),Ln(this,e,Uh,Gh,mn,{editing:5})}}function Vh(n){let e,i,s,r;return{c(){e=T("div"),i=T("div"),m(i,"class","bounding-box svelte-1e5jg43"),at(i,"background-color",n[6]),m(e,"role","button"),m(e,"tabindex","0"),m(e,"class","bounding-box-border svelte-1e5jg43"),m(e,"id",n[2]),at(e,"border","solid 4px "+n[6]),at(e,"top",`${n[3].y}px`),at(e,"left",`${n[3].x}px`),at(e,"width",`${n[4]}px`),at(e,"height",`${n[5]}px`)},m(l,u){Q(l,e,u),b(e,i),s||(r=[ft(e,"contextmenu",ni(Vn(n[12]))),ft(e,"mousedown",ni(Vn(n[9])))],s=!0)},p(l,[u]){u&64&&at(i,"background-color",l[6]),u&4&&m(e,"id",l[2]),u&64&&at(e,"border","solid 4px "+l[6]);const c=u&64;(u&72||c)&&at(e,"top",`${l[3].y}px`),(u&72||c)&&at(e,"left",`${l[3].x}px`),(u&80||c)&&at(e,"width",`${l[4]}px`),(u&96||c)&&at(e,"height",`${l[5]}px`)},i:Ut,o:Ut,d(l){l&&Y(e),s=!1,fn(r)}}}function Xh(n,e,i){let s,r,l=Ut,u=()=>(l(),l=yn(k,F=>i(3,r=F)),k),c,f,d,p=Ut,g=()=>(p(),p=yn(P,F=>i(6,d=F)),P);n.$$.on_destroy.push(()=>l()),n.$$.on_destroy.push(()=>p());let{dimensions:w}=e,{position:k}=e;u();let{color:P}=e;g();let{groupName:M}=e;const{width:A,height:z}=w;vt(n,A,F=>i(4,c=F)),vt(n,z,F=>i(5,f=F));const E=Gi();function B(){E("groupClick",{groupName:M})}function H(F){Ve.call(this,n,F)}return n.$$set=F=>{"dimensions"in F&&i(10,w=F.dimensions),"position"in F&&u(i(0,k=F.position)),"color"in F&&g(i(1,P=F.color)),"groupName"in F&&i(11,M=F.groupName)},n.$$.update=()=>{n.$$.dirty&2048&&i(2,s=`${M}-bounding-box`)},[k,P,s,r,c,f,d,A,z,B,w,M,H]}class Yh extends Cn{constructor(e){super(),Ln(this,e,Xh,Vh,mn,{dimensions:10,position:0,color:1,groupName:11})}}function Xr(n,e,i){const s=n.slice();return s[4]=e[i][0],s[5]=e[i][1],s}function Yr(n,e){let i,s,r;const l=[e[5],{groupName:e[4]}];let u={};for(let c=0;c<l.length;c+=1)u=rs(u,l[c]);return s=new Yh({props:u}),s.$on("groupClick",e[2]),{key:n,first:null,c(){i=Ze(),_e(s.$$.fragment),this.first=i},m(c,f){Q(c,i,f),ue(s,c,f),r=!0},p(c,f){e=c;const d=f&1?il(l,[ol(e[5]),{groupName:e[4]}]):{};s.$set(d)},i(c){r||(Z(s.$$.fragment,c),r=!0)},o(c){W(s.$$.fragment,c),r=!1},d(c){c&&Y(i),ce(s,c)}}}function Kh(n){let e=[],i=new Map,s,r,l=Le(Array.from(n[0]));const u=c=>c[4];for(let c=0;c<l.length;c+=1){let f=Xr(n,l,c),d=u(f);i.set(d,e[c]=Yr(d,f))}return{c(){for(let c=0;c<e.length;c+=1)e[c].c();s=Ze()},m(c,f){for(let d=0;d<e.length;d+=1)e[d]&&e[d].m(c,f);Q(c,s,f),r=!0},p(c,[f]){f&1&&(l=Le(Array.from(c[0])),ke(),e=_i(e,f,u,1,c,l,i,s.parentNode,oo,Yr,s,Xr),Pe())},i(c){if(!r){for(let f=0;f<l.length;f+=1)Z(e[f]);r=!0}},o(c){for(let f=0;f<e.length;f+=1)W(e[f]);r=!1},d(c){c&&Y(s);for(let f=0;f<e.length;f+=1)e[f].d(c)}}}function Jh(n,e,i){let s;const l=ve("graph").groupBoxes;vt(n,l,c=>i(0,s=c));function u(c){Ve.call(this,n,c)}return[s,l,u]}class Qh extends Cn{constructor(e){super(),Ln(this,e,Jh,Kh,mn,{})}}function $h(n){let e,i,s,r;const l=n[11].default,u=Me(l,n,n[10],null);return{c(){e=T("div"),u&&u.c(),m(e,"class","svelvet-graph-wrapper svelte-19pa6i0"),m(e,"role","presentation"),at(e,"transform",n[0])},m(c,f){Q(c,e,f),u&&u.m(e,null),i=!0,s||(r=[ft(e,"contextmenu",to(Vn(n[12]))),ft(e,"click",to(Vn(n[13]))),ft(e,"touchstart",to(Vn(n[14])))],s=!0)},p(c,[f]){u&&u.p&&(!i||f&1024)&&Ee(u,l,c,c[10],i?Te(l,c[10],f,null):Ae(c[10]),null),f&1&&at(e,"transform",c[0])},i(c){i||(Z(u,c),i=!0)},o(c){W(u,c),i=!1},d(c){c&&Y(e),u&&u.d(c),s=!1,fn(r)}}}function tf(n,e,i){let s,r,l,u,c,{$$slots:f={},$$scope:d}=e;const p=ve("graph"),g=p.transforms,w=g.scale;vt(n,w,G=>i(9,c=G));const k=g.translation;vt(n,k,G=>i(8,u=G));const P=p.cursor;vt(n,P,G=>i(15,l=G));let{isMovable:M}=e,A,z=!1;function E(){Zt(k,u=Qu(bt(Hn),l,g),u),i(5,A=requestAnimationFrame(E))}function B(G){Ve.call(this,n,G)}function H(G){Ve.call(this,n,G)}function F(G){Ve.call(this,n,G)}return n.$$set=G=>{"isMovable"in G&&i(4,M=G.isMovable),"$$scope"in G&&i(10,d=G.$$scope)},n.$$.update=()=>{n.$$.dirty&256&&i(7,s=u),n.$$.dirty&640&&i(0,r=`translate(${s.x}px, ${s.y}px) scale(${c})`),n.$$.dirty&112&&(M&&!z?(i(6,z=!0),i(5,A=requestAnimationFrame(E))):(!M||!z)&&(i(6,z=!1),cancelAnimationFrame(A)))},[r,w,k,P,M,A,z,s,u,c,d,f,B,H,F]}class ef extends Cn{constructor(e){super(),Ln(this,e,tf,$h,mn,{isMovable:4})}}function nf(n){let e,i,s;const r=n[8].default,l=Me(r,n,n[9],null);return i=new Qh({}),i.$on("groupClick",n[5]),{c(){l&&l.c(),e=X(),_e(i.$$.fragment)},m(u,c){l&&l.m(u,c),Q(u,e,c),ue(i,u,c),s=!0},p(u,c){l&&l.p&&(!s||c&512)&&Ee(l,r,u,u[9],s?Te(r,u[9],c,null):Ae(u[9]),null)},i(u){s||(Z(l,u),Z(i.$$.fragment,u),s=!0)},o(u){W(l,u),W(i.$$.fragment,u),s=!1},d(u){u&&Y(e),l&&l.d(u),ce(i,u)}}}function of(n){let e,i;return e=new ef({props:{isMovable:n[0],$$slots:{default:[nf]},$$scope:{ctx:n}}}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},p(s,[r]){const l={};r&1&&(l.isMovable=s[0]),r&512&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function sf(n,e,i){let s,r,l,u,c,f;vt(n,Hn,B=>i(13,u=B)),vt(n,Yn,B=>i(7,f=B));let{$$slots:d={},$$scope:p}=e;console.log("Componente GraphRenderer.svelte");const g=ve("graph"),w=ve("snapTo");let{isMovable:k}=e;const P=g.activeGroup;vt(n,P,B=>i(6,c=B));const M=g.groups;vt(n,M,B=>i(10,s=B));const A=g.initialNodePositions;vt(n,A,B=>i(11,r=B));const z=g.cursor;vt(n,z,B=>i(12,l=B));function E(B){Zt(Yn,f=!0,f);const{groupName:H}=B.detail;Zt(P,c=H,c),Zt(Hn,u=l,u),Zt(A,r=cl(s[H].nodes),r)}return n.$$set=B=>{"isMovable"in B&&i(0,k=B.isMovable),"$$scope"in B&&i(9,p=B.$$scope)},n.$$.update=()=>{n.$$.dirty&192&&c&&f&&ac(g,w)},[k,P,M,A,z,E,c,f,d,p]}class rf extends Cn{constructor(e){super(),Ln(this,e,sf,of,mn,{isMovable:0})}}function af(n){let e,i;return{c(){e=oe("line"),i=oe("line"),m(e,"class","background-line svelte-rryw83"),m(e,"x1",n[11]),m(e,"y1",0),m(e,"x2",n[11]),m(e,"y2",n[6]),m(e,"stroke-width",n[5]),at(e,"--calculated-dot-color",n[2]),m(i,"class","background-line svelte-rryw83"),m(i,"y1",n[11]),m(i,"x1",0),m(i,"y2",n[11]),m(i,"x2",n[6]),m(i,"stroke-width",n[5]),at(i,"--calculated-dot-color",n[2])},m(s,r){Q(s,e,r),Q(s,i,r)},p(s,r){r&2048&&m(e,"x1",s[11]),r&2048&&m(e,"x2",s[11]),r&64&&m(e,"y2",s[6]),r&32&&m(e,"stroke-width",s[5]),r&4&&at(e,"--calculated-dot-color",s[2]),r&2048&&m(i,"y1",s[11]),r&2048&&m(i,"y2",s[11]),r&64&&m(i,"x2",s[6]),r&32&&m(i,"stroke-width",s[5]),r&4&&at(i,"--calculated-dot-color",s[2])},d(s){s&&(Y(e),Y(i))}}}function lf(n){let e;return{c(){e=oe("circle"),m(e,"class","background-dot svelte-rryw83"),m(e,"r",n[5]),m(e,"cx",n[11]),m(e,"cy",n[11]),at(e,"--calculated-dot-color",n[2])},m(i,s){Q(i,e,s)},p(i,s){s&32&&m(e,"r",i[5]),s&2048&&m(e,"cx",i[11]),s&2048&&m(e,"cy",i[11]),s&4&&at(e,"--calculated-dot-color",i[2])},d(i){i&&Y(e)}}}function Kr(n){let e,i,s;function r(c,f){if(c[0]==="dots")return cf;if(c[0]==="lines")return uf}let l=r(n),u=l&&l(n);return{c(){e=oe("pattern"),u&&u.c(),m(e,"id","graph-coarse-pattern"),m(e,"x",n[7]),m(e,"y",n[8]),m(e,"width",i=n[6]*n[3]),m(e,"height",s=n[6]*n[3]),m(e,"patternUnits","userSpaceOnUse")},m(c,f){Q(c,e,f),u&&u.m(e,null)},p(c,f){l===(l=r(c))&&u?u.p(c,f):(u&&u.d(1),u=l&&l(c),u&&(u.c(),u.m(e,null))),f&128&&m(e,"x",c[7]),f&256&&m(e,"y",c[8]),f&72&&i!==(i=c[6]*c[3])&&m(e,"width",i),f&72&&s!==(s=c[6]*c[3])&&m(e,"height",s)},d(c){c&&Y(e),u&&u.d()}}}function uf(n){let e,i,s,r,l,u;return{c(){e=oe("line"),r=oe("line"),m(e,"class","background-line svelte-rryw83"),m(e,"x1",n[11]),m(e,"y1",0),m(e,"x2",n[11]),m(e,"y2",i=n[6]*n[3]),m(e,"stroke-width",s=n[5]*1.2),at(e,"--calculated-dot-color",n[2]),m(r,"class","background-line svelte-rryw83"),m(r,"y1",n[11]),m(r,"x1",0),m(r,"y2",n[11]),m(r,"x2",l=n[6]*n[3]),m(r,"stroke-width",u=n[5]*1.2),at(r,"--calculated-dot-color",n[2])},m(c,f){Q(c,e,f),Q(c,r,f)},p(c,f){f&2048&&m(e,"x1",c[11]),f&2048&&m(e,"x2",c[11]),f&72&&i!==(i=c[6]*c[3])&&m(e,"y2",i),f&32&&s!==(s=c[5]*1.2)&&m(e,"stroke-width",s),f&4&&at(e,"--calculated-dot-color",c[2]),f&2048&&m(r,"y1",c[11]),f&2048&&m(r,"y2",c[11]),f&72&&l!==(l=c[6]*c[3])&&m(r,"x2",l),f&32&&u!==(u=c[5]*1.2)&&m(r,"stroke-width",u),f&4&&at(r,"--calculated-dot-color",c[2])},d(c){c&&(Y(e),Y(r))}}}function cf(n){let e,i;return{c(){e=oe("circle"),m(e,"class","background-dot svelte-rryw83"),m(e,"r",i=n[5]*2),m(e,"cx",n[11]),m(e,"cy",n[11]),at(e,"--calculated-dot-color",n[2])},m(s,r){Q(s,e,r)},p(s,r){r&32&&i!==(i=s[5]*2)&&m(e,"r",i),r&2048&&m(e,"cx",s[11]),r&2048&&m(e,"cy",s[11]),r&4&&at(e,"--calculated-dot-color",s[2])},d(s){s&&Y(e)}}}function Jr(n){let e;return{c(){e=oe("rect"),m(e,"width","100%"),m(e,"height","100%"),m(e,"fill","url(#graph-coarse-pattern)"),m(e,"opacity",n[10])},m(i,s){Q(i,e,s)},p(i,s){s&1024&&m(e,"opacity",i[10])},d(i){i&&Y(e)}}}function hf(n){let e,i,s,r,l;function u(g,w){if(g[0]==="dots")return lf;if(g[0]==="lines")return af}let c=u(n),f=c&&c(n),d=n[3]>0&&Kr(n),p=n[3]>0&&Jr(n);return{c(){e=T("div"),i=oe("svg"),s=oe("defs"),r=oe("pattern"),f&&f.c(),d&&d.c(),l=oe("rect"),p&&p.c(),m(r,"id","graph-pattern"),m(r,"x",n[7]),m(r,"y",n[8]),m(r,"width",n[6]),m(r,"height",n[6]),m(r,"patternUnits","userSpaceOnUse"),m(l,"width","100%"),m(l,"height","100%"),m(l,"fill","url(#graph-pattern)"),m(l,"opacity",n[9]),m(i,"class","svelte-rryw83"),m(e,"id","background-wrapper"),m(e,"class","svelte-rryw83"),at(e,"--calculated-background-color",n[1])},m(g,w){Q(g,e,w),b(e,i),b(i,s),b(s,r),f&&f.m(r,null),d&&d.m(s,null),b(i,l),p&&p.m(i,null),n[24](e)},p(g,[w]){c===(c=u(g))&&f?f.p(g,w):(f&&f.d(1),f=c&&c(g),f&&(f.c(),f.m(r,null))),w&128&&m(r,"x",g[7]),w&256&&m(r,"y",g[8]),w&64&&m(r,"width",g[6]),w&64&&m(r,"height",g[6]),g[3]>0?d?d.p(g,w):(d=Kr(g),d.c(),d.m(s,null)):d&&(d.d(1),d=null),w&512&&m(l,"opacity",g[9]),g[3]>0?p?p.p(g,w):(p=Jr(g),p.c(),p.m(i,null)):p&&(p.d(1),p=null),w&2&&at(e,"--calculated-background-color",g[1])},i:Ut,o:Ut,d(g){g&&Y(e),f&&f.d(),d&&d.d(),p&&p.d(),n[24](null)}}}function ff(n,e,i){let s,r,l,u,c,f,d;const p=ve("graph");let{style:g="dots"}=e,{gridWidth:w=Nu}=e,{dotSize:k=Iu}=e,{bgColor:P=null}=e,{dotColor:M=null}=e,{opacityThreshold:A=3}=e,{majorGrid:z=0}=e,{minOpacity:E=.4}=e;const B=p.transforms,H=B.scale;vt(n,H,R=>i(22,f=R));const F=B.translation;vt(n,F,R=>i(23,d=R));let G,lt,K,tt,st,ht=1,I=1;function rt(R){ii[R?"unshift":"push"](()=>{G=R,i(4,G)})}return n.$$set=R=>{"style"in R&&i(0,g=R.style),"gridWidth"in R&&i(14,w=R.gridWidth),"dotSize"in R&&i(15,k=R.dotSize),"bgColor"in R&&i(1,P=R.bgColor),"dotColor"in R&&i(2,M=R.dotColor),"opacityThreshold"in R&&i(16,A=R.opacityThreshold),"majorGrid"in R&&i(3,z=R.majorGrid),"minOpacity"in R&&i(17,E=R.minOpacity)},n.$$.update=()=>{n.$$.dirty&8388608&&i(21,s=d),n.$$.dirty&4194304&&i(20,r=f),n.$$.dirty&1064960&&i(6,l=r*w),n.$$.dirty&1081344&&i(5,u=r*k/2),n.$$.dirty&64&&i(11,c=l/2),n.$$.dirty&4128816&&(i(18,lt=(G==null?void 0:G.offsetWidth)||0),i(19,K=(G==null?void 0:G.offsetHeight)||0),i(7,tt=(lt+u)*(1-r)/2+s.x),i(8,st=(K+u)*(1-r)/2+s.y),i(9,ht=r>A?1:r/A+E),i(10,I=r>A/3?1:r/(A/3)+E))},[g,P,M,z,G,u,l,tt,st,ht,I,c,H,F,w,k,A,E,lt,K,r,s,f,d,rt]}class df extends Cn{constructor(e){super(),Ln(this,e,ff,hf,mn,{style:0,gridWidth:14,dotSize:15,bgColor:1,dotColor:2,opacityThreshold:16,majorGrid:3,minOpacity:17})}}function _f(n){let e,i;return{c(){e=T("div"),i=T("div"),m(i,"class","selection-box svelte-10ds4jd"),te(i,"creating",n[0]),m(e,"class","selection-border svelte-10ds4jd"),te(e,"creating",n[0]),at(e,"--prop-selection-box-color",n[1]),at(e,"height",n[4]),at(e,"width",n[3]),at(e,"top",n[6]),at(e,"left",n[5])},m(s,r){Q(s,e,r),b(e,i),n[18](i)},p(s,[r]){r&1&&te(i,"creating",s[0]),r&1&&te(e,"creating",s[0]),r&2&&at(e,"--prop-selection-box-color",s[1]),r&16&&at(e,"height",s[4]),r&8&&at(e,"width",s[3]),r&64&&at(e,"top",s[6]),r&32&&at(e,"left",s[5])},i:Ut,o:Ut,d(s){s&&Y(e),n[18](null)}}}function mf(n,e,i){let s,r,l,u,c,f,d,p,g,w,k=Ut,P=()=>(k(),k=yn(s,I=>i(20,w=I)),s),M,A;vt(n,rl,I=>i(16,M=I)),n.$$.on_destroy.push(()=>k());let{graph:z}=e,{anchor:E}=e,{adding:B=!1}=e,{creating:H=!1}=e,{color:F=null}=e;const{groups:G}=z;vt(n,G,I=>i(17,A=I));let lt,K;Xn(tt);function tt(){lt=Array.from(document.querySelectorAll(".svelvet-node")).map(rt=>{const{top:R,left:mt,width:pt,height:J}=rt.getBoundingClientRect();return{id:rt.id,top:R,left:mt,width:pt,height:J}})}function st(){if(!lt)return;const I=lt.reduce((rt,R)=>{if(c+E.left<=R.left&&u+E.top<=R.top&&c+E.left+Math.abs(l)>=R.left+R.width&&u+E.top+Math.abs(r)>=R.top+R.height){const mt=R.id,pt=z.nodes.get(mt);if(!pt)return rt;rt.push(pt)}return rt},[]);B?I.forEach(rt=>{w.add(rt)}):Zt(s,w=new Set(I),w),s.set(w)}function ht(I){ii[I?"unshift":"push"](()=>{K=I,i(2,K)})}return n.$$set=I=>{"graph"in I&&i(9,z=I.graph),"anchor"in I&&i(10,E=I.anchor),"adding"in I&&i(11,B=I.adding),"creating"in I&&i(0,H=I.creating),"color"in I&&i(1,F=I.color)},n.$$.update=()=>{n.$$.dirty&131072&&P(i(7,s=A.selected.nodes)),n.$$.dirty&66560&&i(12,r=M.y-E.y-E.top),n.$$.dirty&66560&&i(14,l=M.x-E.x-E.left),n.$$.dirty&5120&&i(13,u=Math.min(E.y,E.y+r)),n.$$.dirty&17408&&i(15,c=Math.min(E.x,E.x+l)),n.$$.dirty&8192&&i(6,f=`${u}px`),n.$$.dirty&32768&&i(5,d=`${c}px`),n.$$.dirty&4096&&i(4,p=`${Math.abs(r)}px`),n.$$.dirty&16384&&i(3,g=`${Math.abs(l)}px`),n.$$.dirty&20480&&(l||r)&&st()},[H,F,K,g,p,d,f,s,G,z,E,B,r,u,l,c,M,A,ht]}class pf extends Cn{constructor(e){super(),Ln(this,e,mf,_f,mn,{graph:9,anchor:10,adding:11,creating:0,color:1})}}const gf=n=>({}),Qr=n=>({}),vf=n=>({}),$r=n=>({}),yf=n=>({}),ta=n=>({}),bf=n=>({}),ea=n=>({}),wf=n=>({}),na=n=>({}),kf=n=>({}),ia=n=>({});function oa(n){let e,i;return e=new qh({props:{editing:n[24]}}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},p(s,r){const l={};r[0]&16777216&&(l.editing=s[24]),e.$set(l)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Pf(n){let e,i,s=n[24]&&oa(n);const r=n[56].default,l=Me(r,n,n[58],null);return{c(){s&&s.c(),e=X(),l&&l.c()},m(u,c){s&&s.m(u,c),Q(u,e,c),l&&l.m(u,c),i=!0},p(u,c){u[24]?s?(s.p(u,c),c[0]&16777216&&Z(s,1)):(s=oa(u),s.c(),Z(s,1),s.m(e.parentNode,e)):s&&(ke(),W(s,1,1,()=>{s=null}),Pe()),l&&l.p&&(!i||c[1]&134217728)&&Ee(l,r,u,u[58],i?Te(r,u[58],c,null):Ae(u[58]),null)},i(u){i||(Z(s),Z(l,u),i=!0)},o(u){W(s),W(l,u),i=!1},d(u){u&&Y(e),s&&s.d(u),l&&l.d(u)}}}function Lf(n){let e,i;return e=new df({}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},p:Ut,i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Cf(n){let e;const i=n[56].background,s=Me(i,n,n[58],ia);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&134217728)&&Ee(s,i,r,r[58],e?Te(i,r[58],l,kf):Ae(r[58]),ia)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function sa(n){let e,i,s;var r=n[14];function l(u,c){return{}}return r&&(e=di(r,l())),{c(){e&&_e(e.$$.fragment),i=Ze()},m(u,c){e&&ue(e,u,c),Q(u,i,c),s=!0},p(u,c){if(c[0]&16384&&r!==(r=u[14])){if(e){ke();const f=e;W(f.$$.fragment,1,0,()=>{ce(f,1)}),Pe()}r?(e=di(r,l()),_e(e.$$.fragment),Z(e.$$.fragment,1),ue(e,i.parentNode,i)):e=null}},i(u){s||(e&&Z(e.$$.fragment,u),s=!0)},o(u){e&&W(e.$$.fragment,u),s=!1},d(u){u&&Y(i),e&&ce(e,u)}}}function ra(n){let e,i,s;var r=n[15];function l(u,c){return{}}return r&&(e=di(r,l())),{c(){e&&_e(e.$$.fragment),i=Ze()},m(u,c){e&&ue(e,u,c),Q(u,i,c),s=!0},p(u,c){if(c[0]&32768&&r!==(r=u[15])){if(e){ke();const f=e;W(f.$$.fragment,1,0,()=>{ce(f,1)}),Pe()}r?(e=di(r,l()),_e(e.$$.fragment),Z(e.$$.fragment,1),ue(e,i.parentNode,i)):e=null}},i(u){s||(e&&Z(e.$$.fragment,u),s=!0)},o(u){e&&W(e.$$.fragment,u),s=!1},d(u){u&&Y(i),e&&ce(e,u)}}}function aa(n){let e,i,s;var r=n[13];function l(u,c){return{}}return r&&(e=di(r,l())),{c(){e&&_e(e.$$.fragment),i=Ze()},m(u,c){e&&ue(e,u,c),Q(u,i,c),s=!0},p(u,c){if(c[0]&8192&&r!==(r=u[13])){if(e){ke();const f=e;W(f.$$.fragment,1,0,()=>{ce(f,1)}),Pe()}r?(e=di(r,l()),_e(e.$$.fragment),Z(e.$$.fragment,1),ue(e,i.parentNode,i)):e=null}},i(u){s||(e&&Z(e.$$.fragment,u),s=!0)},o(u){e&&W(e.$$.fragment,u),s=!1},d(u){u&&Y(i),e&&ce(e,u)}}}function la(n){let e,i,s;var r=n[16];function l(u,c){return{}}return r&&(e=di(r,l())),{c(){e&&_e(e.$$.fragment),i=Ze()},m(u,c){e&&ue(e,u,c),Q(u,i,c),s=!0},p(u,c){if(c[0]&65536&&r!==(r=u[16])){if(e){ke();const f=e;W(f.$$.fragment,1,0,()=>{ce(f,1)}),Pe()}r?(e=di(r,l()),_e(e.$$.fragment),Z(e.$$.fragment,1),ue(e,i.parentNode,i)):e=null}},i(u){s||(e&&Z(e.$$.fragment,u),s=!0)},o(u){e&&W(e.$$.fragment,u),s=!1},d(u){u&&Y(i),e&&ce(e,u)}}}function ua(n){let e,i,s;var r=n[17];function l(u,c){return{}}return r&&(e=di(r,l())),{c(){e&&_e(e.$$.fragment),i=Ze()},m(u,c){e&&ue(e,u,c),Q(u,i,c),s=!0},p(u,c){if(c[0]&131072&&r!==(r=u[17])){if(e){ke();const f=e;W(f.$$.fragment,1,0,()=>{ce(f,1)}),Pe()}r?(e=di(r,l()),_e(e.$$.fragment),Z(e.$$.fragment,1),ue(e,i.parentNode,i)):e=null}},i(u){s||(e&&Z(e.$$.fragment,u),s=!0)},o(u){e&&W(e.$$.fragment,u),s=!1},d(u){u&&Y(i),e&&ce(e,u)}}}function ca(n){let e,i;return e=new pf({props:{creating:n[20],anchor:n[18],graph:n[3],adding:n[21],color:n[9]}}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},p(s,r){const l={};r[0]&1048576&&(l.creating=s[20]),r[0]&262144&&(l.anchor=s[18]),r[0]&8&&(l.graph=s[3]),r[0]&2097152&&(l.adding=s[21]),r[0]&512&&(l.color=s[9]),e.$set(l)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Sf(n){let e,i,s,r,l,u,c,f,d,p,g,w,k,P,M,A,z,E,B,H;i=new rf({props:{isMovable:n[22],$$slots:{default:[Pf]},$$scope:{ctx:n}}});const F=[Cf,Lf],G=[];function lt(x,it){return x[10]?0:1}r=lt(n),l=G[r]=F[r](n);let K=n[0]&&sa(n),tt=n[1]&&ra(n),st=n[6]&&aa(n),ht=n[2]&&la(n),I=n[12]&&ua(n);const rt=n[56].minimap,R=Me(rt,n,n[58],na),mt=n[56].drawer,pt=Me(mt,n,n[58],ea),J=n[56].controls,j=Me(J,n,n[58],ta),Et=n[56].toggle,ut=Me(Et,n,n[58],$r),kt=n[56].contrast,Nt=Me(kt,n,n[58],Qr);let yt=n[19]&&!n[8]&&ca(n);return{c(){e=T("section"),_e(i.$$.fragment),s=X(),l.c(),u=X(),K&&K.c(),c=X(),tt&&tt.c(),f=X(),st&&st.c(),d=X(),ht&&ht.c(),p=X(),I&&I.c(),g=X(),R&&R.c(),w=X(),pt&&pt.c(),k=X(),j&&j.c(),P=X(),ut&&ut.c(),M=X(),Nt&&Nt.c(),A=X(),yt&&yt.c(),m(e,"role","presentation"),m(e,"id",z=n[3].id),m(e,"class","svelvet-wrapper svelte-13nq7cv"),m(e,"title",n[11]),m(e,"tabindex",0),at(e,"width",n[4]?n[4]+"px":"100%"),at(e,"height",n[5]?n[5]+"px":"100%"),at(e,"cursor",n[7]?"move":"default")},m(x,it){Q(x,e,it),ue(i,e,null),b(e,s),G[r].m(e,null),b(e,u),K&&K.m(e,null),b(e,c),tt&&tt.m(e,null),b(e,f),st&&st.m(e,null),b(e,d),ht&&ht.m(e,null),b(e,p),I&&I.m(e,null),b(e,g),R&&R.m(e,null),b(e,w),pt&&pt.m(e,null),b(e,k),j&&j.m(e,null),b(e,P),ut&&ut.m(e,null),b(e,M),Nt&&Nt.m(e,null),b(e,A),yt&&yt.m(e,null),n[57](e),E=!0,B||(H=[ft(window,"touchend",n[36]),ft(window,"mouseup",n[36]),ft(window,"resize",n[35]),ft(window,"scroll",n[35]),ft(e,"wheel",Vn(n[43])),ft(e,"mousedown",to(Vn(n[37]))),ft(e,"touchend",Vn(n[39])),ft(e,"touchstart",to(Vn(n[38]))),ft(e,"keydown",n[40]),ft(e,"keyup",n[42]),ft(e,"dragover",Vn(Mf)),ft(e,"drop",n[41])],B=!0)},p(x,it){const U={};it[0]&4194304&&(U.isMovable=x[22]),it[0]&16777216|it[1]&134217728&&(U.$$scope={dirty:it,ctx:x}),i.$set(U);let q=r;r=lt(x),r===q?G[r].p(x,it):(ke(),W(G[q],1,1,()=>{G[q]=null}),Pe(),l=G[r],l?l.p(x,it):(l=G[r]=F[r](x),l.c()),Z(l,1),l.m(e,u)),x[0]?K?(K.p(x,it),it[0]&1&&Z(K,1)):(K=sa(x),K.c(),Z(K,1),K.m(e,c)):K&&(ke(),W(K,1,1,()=>{K=null}),Pe()),x[1]?tt?(tt.p(x,it),it[0]&2&&Z(tt,1)):(tt=ra(x),tt.c(),Z(tt,1),tt.m(e,f)):tt&&(ke(),W(tt,1,1,()=>{tt=null}),Pe()),x[6]?st?(st.p(x,it),it[0]&64&&Z(st,1)):(st=aa(x),st.c(),Z(st,1),st.m(e,d)):st&&(ke(),W(st,1,1,()=>{st=null}),Pe()),x[2]?ht?(ht.p(x,it),it[0]&4&&Z(ht,1)):(ht=la(x),ht.c(),Z(ht,1),ht.m(e,p)):ht&&(ke(),W(ht,1,1,()=>{ht=null}),Pe()),x[12]?I?(I.p(x,it),it[0]&4096&&Z(I,1)):(I=ua(x),I.c(),Z(I,1),I.m(e,g)):I&&(ke(),W(I,1,1,()=>{I=null}),Pe()),R&&R.p&&(!E||it[1]&134217728)&&Ee(R,rt,x,x[58],E?Te(rt,x[58],it,wf):Ae(x[58]),na),pt&&pt.p&&(!E||it[1]&134217728)&&Ee(pt,mt,x,x[58],E?Te(mt,x[58],it,bf):Ae(x[58]),ea),j&&j.p&&(!E||it[1]&134217728)&&Ee(j,J,x,x[58],E?Te(J,x[58],it,yf):Ae(x[58]),ta),ut&&ut.p&&(!E||it[1]&134217728)&&Ee(ut,Et,x,x[58],E?Te(Et,x[58],it,vf):Ae(x[58]),$r),Nt&&Nt.p&&(!E||it[1]&134217728)&&Ee(Nt,kt,x,x[58],E?Te(kt,x[58],it,gf):Ae(x[58]),Qr),x[19]&&!x[8]?yt?(yt.p(x,it),it[0]&524544&&Z(yt,1)):(yt=ca(x),yt.c(),Z(yt,1),yt.m(e,null)):yt&&(ke(),W(yt,1,1,()=>{yt=null}),Pe()),(!E||it[0]&8&&z!==(z=x[3].id))&&m(e,"id",z),(!E||it[0]&2048)&&m(e,"title",x[11]),it[0]&16&&at(e,"width",x[4]?x[4]+"px":"100%"),it[0]&32&&at(e,"height",x[5]?x[5]+"px":"100%"),it[0]&128&&at(e,"cursor",x[7]?"move":"default")},i(x){E||(Z(i.$$.fragment,x),Z(l),Z(K),Z(tt),Z(st),Z(ht),Z(I),Z(R,x),Z(pt,x),Z(j,x),Z(ut,x),Z(Nt,x),Z(yt),E=!0)},o(x){W(i.$$.fragment,x),W(l),W(K),W(tt),W(st),W(ht),W(I),W(R,x),W(pt,x),W(j,x),W(ut,x),W(Nt,x),W(yt),E=!1},d(x){x&&Y(e),ce(i),G[r].d(),K&&K.d(),tt&&tt.d(),st&&st.d(),ht&&ht.d(),I&&I.d(),R&&R.d(x),pt&&pt.d(x),j&&j.d(x),ut&&ut.d(x),Nt&&Nt.d(x),yt&&yt.d(),n[57](null),B=!1,fn(H)}}}function Mf(n){n.preventDefault()}function Tf(n,e,i){let s,r,l,u,c,f,d,p,g,w,k,P,M,A,z;vt(n,ns,y=>i(70,d=y)),vt(n,Hn,y=>i(71,p=y)),vt(n,Yn,y=>i(72,g=y)),vt(n,fi,y=>i(75,P=y));let{$$slots:E={},$$scope:B}=e,{graph:H}=e,{width:F}=e,{height:G}=e,{minimap:lt=!1}=e,{controls:K=!1}=e,{toggle:tt=!1}=e,{fixedZoom:st=!1}=e,{pannable:ht=!0}=e,{disableSelection:I=!1}=e,{ZOOM_INCREMENT:rt=.1}=e,{PAN_INCREMENT:R=50}=e,{PAN_TIME:mt=250}=e,{MAX_SCALE:pt=3}=e,{MIN_SCALE:J=.2}=e,{selectionColor:j}=e,{backgroundExists:Et}=e,{fitView:ut=!1}=e,{trackpadPan:kt}=e,{modifier:Nt}=e,{theme:yt="light"}=e,{title:x}=e,{drawer:it=!1}=e,{contrast:U=!1}=e;console.log("Initial Graph drawer prop:",it);let q;const Vt=Gi(),re={},dt=$(!1),Dt=$(0),Ht=$(null);vt(n,Ht,y=>i(23,c=y));const Wt=H.cursor,It=H.transforms.scale;vt(n,It,y=>i(68,u=y));const ne=H.dimensions;vt(n,ne,y=>i(55,A=y));const Xt=H.transforms.translation;vt(n,Xt,y=>i(67,l=y));const ot=H.groups;vt(n,ot,y=>i(69,f=y));const ae=H.groupBoxes,Qt=f.selected.nodes;vt(n,Qt,y=>i(66,r=y));const Rt=H.activeGroup;vt(n,Rt,y=>i(74,k=y));const se=H.initialNodePositions;vt(n,se,y=>i(73,w=y));const Fe=H.editing;vt(n,Fe,y=>i(24,z=y));const Ge=H.bounds.nodeBounds;vt(n,Ge,y=>i(76,M=y));let De=0,Ce=1,Kt={x:0,y:0,top:0,left:0},he=!1,ze=!1,Re=!1,Ft=!1,le=!1,xe=!1,Je,Qe=null,Sn=null,ye=null,Xe=null,Ot=null;const an={id:null,position:H.cursor,offset:$({x:0,y:0}),connected:$(new Set),dynamic:$(!1),edge:null,edgeColor:$(null),direction:$("self"),inputKey:null,type:"output",moving:Mo(!1),store:null,mounted:$(!0),rotation:Mo(0),node:{zIndex:$(1/0),rotating:$(!1),position:H.cursor,dimensions:{width:$(0),height:$(0)}}};Ie("graphDOMElement",Ht),Ie("cursorAnchor",an),Ie("duplicate",dt),Ie("graph",H),Ie("transforms",H.transforms),Ie("dimensions",H.dimensions),Ie("locked",H.locked),Ie("groups",H.groups),Ie("bounds",H.bounds),Ie("edgeStore",H.edges),Ie("nodeStore",H.nodes),Ie("mounted",Dt),Xn(()=>{console.log("Graph component mounted with drawer1:",it),$e()});async function je(){await el(),Yn.set(!0);const{x:y,y:_t,scale:Lt}=ic(Je,M);y!==null&&_t!==null&&Lt!==null&&(H.transforms.scale.set(Lt),Xt.set({x:y,y:_t})),Yn.set(!1),i(54,xe=!0)}async function Ue(){i(14,Sn=(await Qi(async()=>{const{default:y}=await import("./Minimap-BlD6zEVR.js");return{default:y}},[])).default)}async function dn(){i(13,Qe=(await Qi(async()=>{const{default:y}=await import("./ThemeToggle-BF6QE_Fc.js");return{default:y}},[])).default)}async function bn(){i(15,ye=(await Qi(async()=>{const{default:y}=await import("./Controls-nCVS46AE.js");return{default:y}},__vite__mapDeps([0,1]))).default)}async function He(){i(16,Xe=(await Qi(async()=>{const{default:y}=await import("./DrawerController-Ceo4GJ9R.js");return{default:y}},__vite__mapDeps([2,1,3]))).default)}async function Ne(){i(17,Ot=(await Qi(async()=>{const{default:y}=await import("./ContrastTheme-DqWfLO5l.js");return{default:y}},[])).default)}function $e(){if(!c)return;const y=c.getBoundingClientRect();Je={top:y.top,left:y.left,bottom:y.bottom,right:y.right,width:y.width,height:y.height},H.dimensions.set(Je),ut==="resize"&&je()}function Jt(y){if(ze){const Ct=`${Uu()}/${H.id}`,At=bt(Wt),O=At.x-p.x,$t=At.y-p.y,me=Math.min(p.y,p.y+$t),Yt=Math.min(p.x,p.x+O),Se={width:$(Math.abs(O)),height:$(Math.abs($t))},nn=$({x:Yt,y:me}),ln={group:$(Ct),dimensions:Se,position:nn,color:$(Ru()),moving:$(!1)};ae.add(ln,Ct),Array.from(r).forEach(on=>{on.group.set(Ct)}),ot.update(on=>{const An={parent:$(ln),nodes:$(new Set([...r,ln]))};return on[Ct]=An,on}),Zt(Qt,r=new Set,r),i(20,ze=!1),i(19,he=!1)}k&&Array.from(bt(f[k].nodes)).forEach(Ct=>{const At=So(bt(Ct.position).x,bt(Ct.position).y);Ct.position.set(At),Ct.moving.set(!1)});const _t=H.edges.get("cursor");_t&&(H.edges.delete("cursor"),_t.disconnect||Vt("edgeDrop",{cursor:bt(Wt),source:{node:P==null?void 0:P.anchor.node.id.slice(2),anchor:P==null?void 0:P.anchor.id.split("/")[0].slice(2)}})),Zt(Rt,k=null,k),Zt(Hn,p={x:0,y:0},p),Zt(se,w=[],w),i(19,he=!1),i(22,Ft=!1),Zt(Yn,g=!1,g),y.shiftKey||fi.set(null),i(18,Kt.y=0,Kt),i(18,Kt.x=0,Kt)}function fe(y){if(!ht&&!(y.shiftKey||y.metaKey)||y.button===2)return;c&&c.focus();const{clientX:_t,clientY:Lt}=y;if(Zt(Hn,p=bt(Wt),p),y.shiftKey||y.metaKey){y.preventDefault(),i(19,he=!0);const{top:Ct,left:At}=s;i(18,Kt.y=Lt-Ct,Kt),i(18,Kt.x=_t-At,Kt),i(18,Kt.top=Ct,Kt),i(18,Kt.left=At,Kt),y.shiftKey&&y.metaKey?i(20,ze=!0):i(20,ze=!1),y.metaKey&&!y.shiftKey?i(21,Re=!0):i(21,Re=!1)}else i(22,Ft=!0),Zt(Qt,r=new Set,r),Qt.set(r)}function tn(y){Zt(Qt,r=new Set,r),Qt.set(r),Zt(Hn,p=bt(Wt),p),i(22,Ft=!0),y.touches.length===2&&(pn(),De=d,Ce=u)}function Tn(){i(22,Ft=!1),le=!1}function pn(){le||(le=!0,q=requestAnimationFrame(gn))}function gn(){if(!le){cancelAnimationFrame(q);return}const _t=d/De;Zt(It,u=Ce*_t,u),q=requestAnimationFrame(gn)}function En(y){const{key:_t,code:Lt}=y,Ct=y.target;if(!(Ct.tagName=="INPUT"||Ct.tagName=="TEXTAREA")){if(Lt==="KeyA"&&y[`${Nt}Key`]){const At=H.nodes.getAll().filter(O=>!bt(O.locked));Zt(Qt,r=new Set(At),r)}else if(Vr(_t))en(_t,y);else if(_t==="=")Qs(-1,H.dimensions,H.transforms,rt);else if(_t==="-")Qs(1,H.dimensions,H.transforms,rt);else if(_t==="0")je();else if(_t==="Control")f.selected.nodes.set(new Set);else if(Lt==="KeyD"&&y[`${Nt}Key`])dt.set(!0),setTimeout(()=>{dt.set(!1)},100);else if(_t==="Tab"&&(y.altKey||y.ctrlKey))Pt();else if(_t==="l")i(44,yt=yt==="light"?"dark":"light");else if(_t==="d")i(2,it=!it);else if(_t==="m")i(0,lt=!lt);else if(_t==="c")i(1,K=!K);else if(_t==="e"){const At=Array.from(r)[0];H.editing.set(At)}else return;y.preventDefault()}}function qe(y){y.preventDefault();const _t=c==null?void 0:c.getBoundingClientRect();if(!_t)return;const Lt=y.clientX-_t.left,Ct=y.clientY-_t.top,{x:At,y:O}=So(Lt,Ct);if(console.log(`Dropped Node at Snapped Position: (${At}, ${O})`),!me)return;const $t={id:`node-${Date.now()}`,rotation:$(0),position:$({x:At,y:O}),moving:$(!1),label:$("New Node"),dimensions:{width:$(200),height:$(100)},inputs:$(2),outputs:$(2),anchors:$([]),group:$(null),collapsed:$(!1),resizingWidth:$(!1),resizingHeight:$(!1),rotating:$(!1),editable:$(!0),locked:$(!1),recalculateAnchors:Yt=>{},resizable:$(!0),zIndex:$(1),edge:null,direction:$("TD"),borderRadius:$(5),borderWidth:$(1),connections:$([]),bgColor:$("#007bff"),borderColor:$("#000"),selectionColor:$("#ff0000"),textColor:$("#fff")};let me=null;H.nodes.add($t,$t.id),me=null}function Pt(){const y=H.nodes.getAll(),_t=y.findIndex(Ct=>r.has(Ct)),Lt=_t+1;r.delete(y[_t]),r.add(y[Lt])}function Ye(y){const{key:_t}=y;Vr(_t)?(clearInterval(re[_t]),delete re[_t]):_t==="Shift"&&fi.set(null)}function vn(y){if(st)return;const _t=y.shiftKey?.15:1,{clientX:Lt,clientY:Ct,deltaY:At}=y,O=l,$t={x:Lt,y:Ct};if((kt||y.metaKey)&&At%1===0){Zt(Xt,l={x:Zt(Xt,l.x-=y.deltaX,l),y:Zt(Xt,l.y-=y.deltaY,l)},l);return}if(u>=pt&&At<0||u<=J&&At>0)return;const me=Math.min(.009*_t*Math.abs(At),.08),Yt=ll(u,Math.sign(At),me),Se=al(u,Yt,O,$t,Je);It.set(Yt),Xt.set(Se)}function en(y,_t){const Lt=_t.shiftKey?2:1,Ct=y==="ArrowLeft"||y==="ArrowUp"?1:-1,At=y==="ArrowLeft"||y==="ArrowRight",O=At?l.x:l.y,$t=O+Ct*R*Lt;if(!re[y]){const me=performance.now();let Yt=setInterval(()=>{const Se=performance.now()-me;if(r.size===0){const nn=O+($t-O)*(Se/mt);Xt.set({x:At?nn:l.x,y:At?l.y:nn})}else{const nn={x:At?-Ct*2:0,y:At?0:-Ct*2};Array.from(r).forEach(ln=>{const on=bt(ln.position);let An;const oi=bt(ln.group),Wn=bt(H.groupBoxes);if(oi&&(An=Wn.get(oi)),An){const xn=bt(ln.dimensions.width),wn=bt(ln.dimensions.height),Jn=fl(An,xn,wn);hl(on,nn,ln.position,Jn)}else{const xn={x:on.x+nn.x,y:on.y+nn.y},wn=So(xn.x,xn.y);ln.position.set(wn)}})}},2);re[y]=Yt}}function Bn(y){ii[y?"unshift":"push"](()=>{c=y,Ht.set(c)})}return n.$$set=y=>{"graph"in y&&i(3,H=y.graph),"width"in y&&i(4,F=y.width),"height"in y&&i(5,G=y.height),"minimap"in y&&i(0,lt=y.minimap),"controls"in y&&i(1,K=y.controls),"toggle"in y&&i(6,tt=y.toggle),"fixedZoom"in y&&i(45,st=y.fixedZoom),"pannable"in y&&i(7,ht=y.pannable),"disableSelection"in y&&i(8,I=y.disableSelection),"ZOOM_INCREMENT"in y&&i(46,rt=y.ZOOM_INCREMENT),"PAN_INCREMENT"in y&&i(47,R=y.PAN_INCREMENT),"PAN_TIME"in y&&i(48,mt=y.PAN_TIME),"MAX_SCALE"in y&&i(49,pt=y.MAX_SCALE),"MIN_SCALE"in y&&i(50,J=y.MIN_SCALE),"selectionColor"in y&&i(9,j=y.selectionColor),"backgroundExists"in y&&i(10,Et=y.backgroundExists),"fitView"in y&&i(51,ut=y.fitView),"trackpadPan"in y&&i(52,kt=y.trackpadPan),"modifier"in y&&i(53,Nt=y.modifier),"theme"in y&&i(44,yt=y.theme),"title"in y&&i(11,x=y.title),"drawer"in y&&i(2,it=y.drawer),"contrast"in y&&i(12,U=y.contrast),"$$scope"in y&&i(58,B=y.$$scope)},n.$$.update=()=>{n.$$.dirty[1]&16777216&&(s=A),n.$$.dirty[1]&8192&&yt&&document.documentElement.setAttribute("svelvet-theme",yt),n.$$.dirty[1]&9437184&&!xe&&ut&&je(),n.$$.dirty[0]&8256&&tt&&!Qe&&dn(),n.$$.dirty[0]&16385&&lt&&!Sn&&Ue(),n.$$.dirty[0]&32770&&K&&!ye&&bn(),n.$$.dirty[0]&65540&&it&&!Xe&&He(),n.$$.dirty[0]&135168&&U&&!Ot&&Ne(),n.$$.dirty[0]&4&&console.log("Reactive Graph drawer prop:",it)},[lt,K,it,H,F,G,tt,ht,I,j,Et,x,U,Qe,Sn,ye,Xe,Ot,Kt,he,ze,Re,Ft,c,z,Ht,It,ne,Xt,ot,Qt,Rt,se,Fe,Ge,$e,Jt,fe,tn,Tn,En,qe,Ye,vn,yt,st,rt,R,mt,pt,J,ut,kt,Nt,xe,A,E,Bn,B]}class Ef extends Cn{constructor(e){super(),Ln(this,e,Tf,Sf,mn,{graph:3,width:4,height:5,minimap:0,controls:1,toggle:6,fixedZoom:45,pannable:7,disableSelection:8,ZOOM_INCREMENT:46,PAN_INCREMENT:47,PAN_TIME:48,MAX_SCALE:49,MIN_SCALE:50,selectionColor:9,backgroundExists:10,fitView:51,trackpadPan:52,modifier:53,theme:44,title:11,drawer:2,contrast:12},null,[-1,-1,-1])}}const Af=n=>({}),ha=n=>({slot:"minimap"}),zf=n=>({}),fa=n=>({slot:"controls"}),Nf=n=>({}),da=n=>({slot:"background"}),If=n=>({}),_a=n=>({slot:"toggle"}),Of=n=>({}),ma=n=>({slot:"drawer"}),Bf=n=>({}),pa=n=>({slot:"contrast"});function Zf(n){let e;return{c(){e=T("div"),m(e,"class","svelvet-temp svelte-lsy29y"),at(e,"width",n[2]?n[2]+"px":"100%"),at(e,"height",n[3]?n[3]+"px":"100%")},m(i,s){Q(i,e,s)},p(i,s){s[0]&4&&at(e,"width",i[2]?i[2]+"px":"100%"),s[0]&8&&at(e,"height",i[3]?i[3]+"px":"100%")},i:Ut,o:Ut,d(i){i&&Y(e)}}}function Df(n){let e,i;return e=new Ef({props:{width:n[2],height:n[3],toggle:n[6],backgroundExists:n[19],minimap:n[4],graph:n[18],fitView:n[9],fixedZoom:n[16],pannable:n[17],theme:n[1],drawer:n[7],controls:n[5],selectionColor:n[10],disableSelection:n[11],trackpadPan:n[13],modifier:n[14],title:n[15],contrast:n[8],$$slots:{contrast:[Gf],drawer:[Ff],toggle:[Wf],background:[Hf],controls:[jf],minimap:[xf],default:[Rf]},$$scope:{ctx:n}}}),e.$on("edgeDrop",n[35]),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},p(s,r){const l={};r[0]&4&&(l.width=s[2]),r[0]&8&&(l.height=s[3]),r[0]&64&&(l.toggle=s[6]),r[0]&524288&&(l.backgroundExists=s[19]),r[0]&16&&(l.minimap=s[4]),r[0]&262144&&(l.graph=s[18]),r[0]&512&&(l.fitView=s[9]),r[0]&65536&&(l.fixedZoom=s[16]),r[0]&131072&&(l.pannable=s[17]),r[0]&2&&(l.theme=s[1]),r[0]&128&&(l.drawer=s[7]),r[0]&32&&(l.controls=s[5]),r[0]&1024&&(l.selectionColor=s[10]),r[0]&2048&&(l.disableSelection=s[11]),r[0]&8192&&(l.trackpadPan=s[13]),r[0]&16384&&(l.modifier=s[14]),r[0]&32768&&(l.title=s[15]),r[0]&256&&(l.contrast=s[8]),r[0]&4097|r[1]&32&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function ga(n){let e,i;return e=new Bh({props:{mermaid:n[0],mermaidConfig:n[12]}}),{c(){_e(e.$$.fragment)},m(s,r){ue(e,s,r),i=!0},p(s,r){const l={};r[0]&1&&(l.mermaid=s[0]),r[0]&4096&&(l.mermaidConfig=s[12]),e.$set(l)},i(s){i||(Z(e.$$.fragment,s),i=!0)},o(s){W(e.$$.fragment,s),i=!1},d(s){ce(e,s)}}}function Rf(n){let e,i,s=n[0].length&&ga(n);const r=n[34].default,l=Me(r,n,n[36],null);return{c(){s&&s.c(),e=X(),l&&l.c()},m(u,c){s&&s.m(u,c),Q(u,e,c),l&&l.m(u,c),i=!0},p(u,c){u[0].length?s?(s.p(u,c),c[0]&1&&Z(s,1)):(s=ga(u),s.c(),Z(s,1),s.m(e.parentNode,e)):s&&(ke(),W(s,1,1,()=>{s=null}),Pe()),l&&l.p&&(!i||c[1]&32)&&Ee(l,r,u,u[36],i?Te(r,u[36],c,null):Ae(u[36]),null)},i(u){i||(Z(s),Z(l,u),i=!0)},o(u){W(s),W(l,u),i=!1},d(u){u&&Y(e),s&&s.d(u),l&&l.d(u)}}}function xf(n){let e;const i=n[34].minimap,s=Me(i,n,n[36],ha);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&32)&&Ee(s,i,r,r[36],e?Te(i,r[36],l,Af):Ae(r[36]),ha)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function jf(n){let e;const i=n[34].controls,s=Me(i,n,n[36],fa);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&32)&&Ee(s,i,r,r[36],e?Te(i,r[36],l,zf):Ae(r[36]),fa)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Hf(n){let e;const i=n[34].background,s=Me(i,n,n[36],da);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&32)&&Ee(s,i,r,r[36],e?Te(i,r[36],l,Nf):Ae(r[36]),da)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Wf(n){let e;const i=n[34].toggle,s=Me(i,n,n[36],_a);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&32)&&Ee(s,i,r,r[36],e?Te(i,r[36],l,If):Ae(r[36]),_a)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Ff(n){let e;const i=n[34].drawer,s=Me(i,n,n[36],ma);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&32)&&Ee(s,i,r,r[36],e?Te(i,r[36],l,Of):Ae(r[36]),ma)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Gf(n){let e;const i=n[34].contrast,s=Me(i,n,n[36],pa);return{c(){s&&s.c()},m(r,l){s&&s.m(r,l),e=!0},p(r,l){s&&s.p&&(!e||l[1]&32)&&Ee(s,i,r,r[36],e?Te(i,r[36],l,Bf):Ae(r[36]),pa)},i(r){e||(Z(s,r),e=!0)},o(r){W(s,r),e=!1},d(r){s&&s.d(r)}}}function Uf(n){let e,i,s,r;const l=[Df,Zf],u=[];function c(f,d){return f[18]?0:1}return e=c(n),i=u[e]=l[e](n),{c(){i.c(),s=Ze()},m(f,d){u[e].m(f,d),Q(f,s,d),r=!0},p(f,d){let p=e;e=c(f),e===p?u[e].p(f,d):(ke(),W(u[p],1,1,()=>{u[p]=null}),Pe(),i=u[e],i?i.p(f,d):(i=u[e]=l[e](f),i.c()),Z(i,1),i.m(s.parentNode,s))},i(f){r||(Z(i),r=!0)},o(f){W(i),r=!1},d(f){f&&Y(s),u[e].d(f)}}}function qf(n,e,i){let s,r,{$$slots:l={},$$scope:u}=e;const c=as(l);let{mermaid:f=""}=e,{theme:d="light"}=e,{id:p=0}=e,{snapTo:g=0}=e,{zoom:w=1}=e,{TD:k=!1}=e,{editable:P=!0}=e,{locked:M=!1}=e,{width:A=0}=e,{height:z=0}=e,{minimap:E=!1}=e,{controls:B=!1}=e,{toggle:H=!1}=e,{drawer:F=!1}=e,{contrast:G=!1}=e,{fitView:lt=!1}=e,{selectionColor:K="lightblue"}=e,{edgeStyle:tt="bezier"}=e,{endStyles:st=[null,null]}=e,{edge:ht=null}=e,{disableSelection:I=!1}=e,{mermaidConfig:rt={}}=e,{translation:R={x:0,y:0}}=e,{trackpadPan:mt=!1}=e,{modifier:pt="meta"}=e,{raiseEdgesOnSelect:J=!1}=e,{edgesAboveNode:j=!1}=e,{title:Et=""}=e,{fixedZoom:ut=!1}=e,{pannable:kt=!0}=e;const Nt=Gi();let yt=null,x=k?"TD":"LR";Ie("snapTo",g),Ie("edgeStyle",tt),Ie("endStyles",st),Ie("graphEdge",ht),Ie("raiseEdgesOnSelect",J),Ie("edgesAboveNode",j),Ie("graph",yt),Xn(()=>{console.log("Graph component mounted with drawer:",F);const q=localStorage.getItem("state");if(console.log("stateObject during onMount:",q),q)i(18,yt=cc(q)),console.log("This is the graph set using reloadStore",yt),Xo.add(yt,yt.id),console.log("graphStore updated",yt);else{let Vt=`G-${p||Xo.count()+1}`;i(18,yt=ul(Vt,{zoom:w,direction:x,editable:P,locked:M,translation:R})),Xo.add(yt,Vt)}});function it(q,Vt){if(!yt)return;const re=`N-${q[0]}`,dt=yt.nodes.get(re);if(!dt)return;const Dt=dt.anchors.get(`A-${q[1]}/N-${q[0]}`);if(!Dt)return;const Ht=`N-${Vt[0]}`,Wt=yt.nodes.get(Ht);if(!Wt)return;const It=Wt.anchors.get(`A-${Vt[1]}/N-${Vt[0]}`);if(!It)return;const ne=yt.edges.match(Dt,It);ne&&yt.edges.delete(ne[0])}function U(q){Ve.call(this,n,q)}return n.$$set=q=>{"mermaid"in q&&i(0,f=q.mermaid),"theme"in q&&i(1,d=q.theme),"id"in q&&i(20,p=q.id),"snapTo"in q&&i(21,g=q.snapTo),"zoom"in q&&i(22,w=q.zoom),"TD"in q&&i(23,k=q.TD),"editable"in q&&i(24,P=q.editable),"locked"in q&&i(25,M=q.locked),"width"in q&&i(2,A=q.width),"height"in q&&i(3,z=q.height),"minimap"in q&&i(4,E=q.minimap),"controls"in q&&i(5,B=q.controls),"toggle"in q&&i(6,H=q.toggle),"drawer"in q&&i(7,F=q.drawer),"contrast"in q&&i(8,G=q.contrast),"fitView"in q&&i(9,lt=q.fitView),"selectionColor"in q&&i(10,K=q.selectionColor),"edgeStyle"in q&&i(26,tt=q.edgeStyle),"endStyles"in q&&i(27,st=q.endStyles),"edge"in q&&i(28,ht=q.edge),"disableSelection"in q&&i(11,I=q.disableSelection),"mermaidConfig"in q&&i(12,rt=q.mermaidConfig),"translation"in q&&i(29,R=q.translation),"trackpadPan"in q&&i(13,mt=q.trackpadPan),"modifier"in q&&i(14,pt=q.modifier),"raiseEdgesOnSelect"in q&&i(30,J=q.raiseEdgesOnSelect),"edgesAboveNode"in q&&i(31,j=q.edgesAboveNode),"title"in q&&i(15,Et=q.title),"fixedZoom"in q&&i(16,ut=q.fixedZoom),"pannable"in q&&i(17,kt=q.pannable),"$$scope"in q&&i(36,u=q.$$scope)},n.$$.update=()=>{n.$$.dirty[0]&262144&&i(33,r=yt&&yt.edges),n.$$.dirty[0]&4456448&&yt&&yt.transforms.scale.set(w),n.$$.dirty[1]&4&&r&&r.onEdgeChange((q,Vt)=>{Nt(Vt,{sourceAnchor:q.source,targetAnchor:q.target,sourceNode:q.source.node,targetNode:q.target.node})})},i(19,s=c.background),[f,d,A,z,E,B,H,F,G,lt,K,I,rt,mt,pt,Et,ut,kt,yt,s,p,g,w,k,P,M,tt,st,ht,R,J,j,it,r,l,U,u]}class Vf extends Cn{constructor(e){super(),Ln(this,e,qf,Uf,mn,{mermaid:0,theme:1,id:20,snapTo:21,zoom:22,TD:23,editable:24,locked:25,width:2,height:3,minimap:4,controls:5,toggle:6,drawer:7,contrast:8,fitView:9,selectionColor:10,edgeStyle:26,endStyles:27,edge:28,disableSelection:11,mermaidConfig:12,translation:29,trackpadPan:13,modifier:14,raiseEdgesOnSelect:30,edgesAboveNode:31,title:15,fixedZoom:16,pannable:17,disconnect:32},null,[-1,-1])}get disconnect(){return this.$$.ctx[32]}}var Xf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},ss={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(n,e){(function(i,s){s(e)})(Xf,function(i){var s="1.9.4";function r(t){var o,a,h,_;for(a=1,h=arguments.length;a<h;a++){_=arguments[a];for(o in _)t[o]=_[o]}return t}var l=Object.create||function(){function t(){}return function(o){return t.prototype=o,new t}}();function u(t,o){var a=Array.prototype.slice;if(t.bind)return t.bind.apply(t,a.call(arguments,1));var h=a.call(arguments,2);return function(){return t.apply(o,h.length?h.concat(a.call(arguments)):arguments)}}var c=0;function f(t){return"_leaflet_id"in t||(t._leaflet_id=++c),t._leaflet_id}function d(t,o,a){var h,_,v,C;return C=function(){h=!1,_&&(v.apply(a,_),_=!1)},v=function(){h?_=arguments:(t.apply(a,arguments),setTimeout(C,o),h=!0)},v}function p(t,o,a){var h=o[1],_=o[0],v=h-_;return t===h&&a?t:((t-_)%v+v)%v+_}function g(){return!1}function w(t,o){if(o===!1)return t;var a=Math.pow(10,o===void 0?6:o);return Math.round(t*a)/a}function k(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function P(t){return k(t).split(/\s+/)}function M(t,o){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?l(t.options):{});for(var a in o)t.options[a]=o[a];return t.options}function A(t,o,a){var h=[];for(var _ in t)h.push(encodeURIComponent(a?_.toUpperCase():_)+"="+encodeURIComponent(t[_]));return(!o||o.indexOf("?")===-1?"?":"&")+h.join("&")}var z=/\{ *([\w_ -]+) *\}/g;function E(t,o){return t.replace(z,function(a,h){var _=o[h];if(_===void 0)throw new Error("No value provided for variable "+a);return typeof _=="function"&&(_=_(o)),_})}var B=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function H(t,o){for(var a=0;a<t.length;a++)if(t[a]===o)return a;return-1}var F="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function G(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var lt=0;function K(t){var o=+new Date,a=Math.max(0,16-(o-lt));return lt=o+a,window.setTimeout(t,a)}var tt=window.requestAnimationFrame||G("RequestAnimationFrame")||K,st=window.cancelAnimationFrame||G("CancelAnimationFrame")||G("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function ht(t,o,a){if(a&&tt===K)t.call(o);else return tt.call(window,u(t,o))}function I(t){t&&st.call(window,t)}var rt={__proto__:null,extend:r,create:l,bind:u,get lastId(){return c},stamp:f,throttle:d,wrapNum:p,falseFn:g,formatNum:w,trim:k,splitWords:P,setOptions:M,getParamString:A,template:E,isArray:B,indexOf:H,emptyImageUrl:F,requestFn:tt,cancelFn:st,requestAnimFrame:ht,cancelAnimFrame:I};function R(){}R.extend=function(t){var o=function(){M(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},a=o.__super__=this.prototype,h=l(a);h.constructor=o,o.prototype=h;for(var _ in this)Object.prototype.hasOwnProperty.call(this,_)&&_!=="prototype"&&_!=="__super__"&&(o[_]=this[_]);return t.statics&&r(o,t.statics),t.includes&&(mt(t.includes),r.apply(null,[h].concat(t.includes))),r(h,t),delete h.statics,delete h.includes,h.options&&(h.options=a.options?l(a.options):{},r(h.options,t.options)),h._initHooks=[],h.callInitHooks=function(){if(!this._initHooksCalled){a.callInitHooks&&a.callInitHooks.call(this),this._initHooksCalled=!0;for(var v=0,C=h._initHooks.length;v<C;v++)h._initHooks[v].call(this)}},o},R.include=function(t){var o=this.prototype.options;return r(this.prototype,t),t.options&&(this.prototype.options=o,this.mergeOptions(t.options)),this},R.mergeOptions=function(t){return r(this.prototype.options,t),this},R.addInitHook=function(t){var o=Array.prototype.slice.call(arguments,1),a=typeof t=="function"?t:function(){this[t].apply(this,o)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(a),this};function mt(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=B(t)?t:[t];for(var o=0;o<t.length;o++)t[o]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var pt={on:function(t,o,a){if(typeof t=="object")for(var h in t)this._on(h,t[h],o);else{t=P(t);for(var _=0,v=t.length;_<v;_++)this._on(t[_],o,a)}return this},off:function(t,o,a){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var h in t)this._off(h,t[h],o);else{t=P(t);for(var _=arguments.length===1,v=0,C=t.length;v<C;v++)_?this._off(t[v]):this._off(t[v],o,a)}return this},_on:function(t,o,a,h){if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}if(this._listens(t,o,a)===!1){a===this&&(a=void 0);var _={fn:o,ctx:a};h&&(_.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(_)}},_off:function(t,o,a){var h,_,v;if(this._events&&(h=this._events[t],!!h)){if(arguments.length===1){if(this._firingCount)for(_=0,v=h.length;_<v;_++)h[_].fn=g;delete this._events[t];return}if(typeof o!="function"){console.warn("wrong listener type: "+typeof o);return}var C=this._listens(t,o,a);if(C!==!1){var N=h[C];this._firingCount&&(N.fn=g,this._events[t]=h=h.slice()),h.splice(C,1)}}},fire:function(t,o,a){if(!this.listens(t,a))return this;var h=r({},o,{type:t,target:this,sourceTarget:o&&o.sourceTarget||this});if(this._events){var _=this._events[t];if(_){this._firingCount=this._firingCount+1||1;for(var v=0,C=_.length;v<C;v++){var N=_[v],D=N.fn;N.once&&this.off(t,D,N.ctx),D.call(N.ctx||this,h)}this._firingCount--}}return a&&this._propagateEvent(h),this},listens:function(t,o,a,h){typeof t!="string"&&console.warn('"string" type argument expected');var _=o;typeof o!="function"&&(h=!!o,_=void 0,a=void 0);var v=this._events&&this._events[t];if(v&&v.length&&this._listens(t,_,a)!==!1)return!0;if(h){for(var C in this._eventParents)if(this._eventParents[C].listens(t,o,a,h))return!0}return!1},_listens:function(t,o,a){if(!this._events)return!1;var h=this._events[t]||[];if(!o)return!!h.length;a===this&&(a=void 0);for(var _=0,v=h.length;_<v;_++)if(h[_].fn===o&&h[_].ctx===a)return _;return!1},once:function(t,o,a){if(typeof t=="object")for(var h in t)this._on(h,t[h],o,!0);else{t=P(t);for(var _=0,v=t.length;_<v;_++)this._on(t[_],o,a,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[f(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[f(t)],this},_propagateEvent:function(t){for(var o in this._eventParents)this._eventParents[o].fire(t.type,r({layer:t.target,propagatedFrom:t.target},t),!0)}};pt.addEventListener=pt.on,pt.removeEventListener=pt.clearAllEventListeners=pt.off,pt.addOneTimeEventListener=pt.once,pt.fireEvent=pt.fire,pt.hasEventListeners=pt.listens;var J=R.extend(pt);function j(t,o,a){this.x=a?Math.round(t):t,this.y=a?Math.round(o):o}var Et=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};j.prototype={clone:function(){return new j(this.x,this.y)},add:function(t){return this.clone()._add(ut(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(ut(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new j(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new j(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=Et(this.x),this.y=Et(this.y),this},distanceTo:function(t){t=ut(t);var o=t.x-this.x,a=t.y-this.y;return Math.sqrt(o*o+a*a)},equals:function(t){return t=ut(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=ut(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+w(this.x)+", "+w(this.y)+")"}};function ut(t,o,a){return t instanceof j?t:B(t)?new j(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new j(t.x,t.y):new j(t,o,a)}function kt(t,o){if(t)for(var a=o?[t,o]:t,h=0,_=a.length;h<_;h++)this.extend(a[h])}kt.prototype={extend:function(t){var o,a;if(!t)return this;if(t instanceof j||typeof t[0]=="number"||"x"in t)o=a=ut(t);else if(t=Nt(t),o=t.min,a=t.max,!o||!a)return this;return!this.min&&!this.max?(this.min=o.clone(),this.max=a.clone()):(this.min.x=Math.min(o.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(o.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)),this},getCenter:function(t){return ut((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return ut(this.min.x,this.max.y)},getTopRight:function(){return ut(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var o,a;return typeof t[0]=="number"||t instanceof j?t=ut(t):t=Nt(t),t instanceof kt?(o=t.min,a=t.max):o=a=t,o.x>=this.min.x&&a.x<=this.max.x&&o.y>=this.min.y&&a.y<=this.max.y},intersects:function(t){t=Nt(t);var o=this.min,a=this.max,h=t.min,_=t.max,v=_.x>=o.x&&h.x<=a.x,C=_.y>=o.y&&h.y<=a.y;return v&&C},overlaps:function(t){t=Nt(t);var o=this.min,a=this.max,h=t.min,_=t.max,v=_.x>o.x&&h.x<a.x,C=_.y>o.y&&h.y<a.y;return v&&C},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var o=this.min,a=this.max,h=Math.abs(o.x-a.x)*t,_=Math.abs(o.y-a.y)*t;return Nt(ut(o.x-h,o.y-_),ut(a.x+h,a.y+_))},equals:function(t){return t?(t=Nt(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function Nt(t,o){return!t||t instanceof kt?t:new kt(t,o)}function yt(t,o){if(t)for(var a=o?[t,o]:t,h=0,_=a.length;h<_;h++)this.extend(a[h])}yt.prototype={extend:function(t){var o=this._southWest,a=this._northEast,h,_;if(t instanceof it)h=t,_=t;else if(t instanceof yt){if(h=t._southWest,_=t._northEast,!h||!_)return this}else return t?this.extend(U(t)||x(t)):this;return!o&&!a?(this._southWest=new it(h.lat,h.lng),this._northEast=new it(_.lat,_.lng)):(o.lat=Math.min(h.lat,o.lat),o.lng=Math.min(h.lng,o.lng),a.lat=Math.max(_.lat,a.lat),a.lng=Math.max(_.lng,a.lng)),this},pad:function(t){var o=this._southWest,a=this._northEast,h=Math.abs(o.lat-a.lat)*t,_=Math.abs(o.lng-a.lng)*t;return new yt(new it(o.lat-h,o.lng-_),new it(a.lat+h,a.lng+_))},getCenter:function(){return new it((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new it(this.getNorth(),this.getWest())},getSouthEast:function(){return new it(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof it||"lat"in t?t=U(t):t=x(t);var o=this._southWest,a=this._northEast,h,_;return t instanceof yt?(h=t.getSouthWest(),_=t.getNorthEast()):h=_=t,h.lat>=o.lat&&_.lat<=a.lat&&h.lng>=o.lng&&_.lng<=a.lng},intersects:function(t){t=x(t);var o=this._southWest,a=this._northEast,h=t.getSouthWest(),_=t.getNorthEast(),v=_.lat>=o.lat&&h.lat<=a.lat,C=_.lng>=o.lng&&h.lng<=a.lng;return v&&C},overlaps:function(t){t=x(t);var o=this._southWest,a=this._northEast,h=t.getSouthWest(),_=t.getNorthEast(),v=_.lat>o.lat&&h.lat<a.lat,C=_.lng>o.lng&&h.lng<a.lng;return v&&C},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,o){return t?(t=x(t),this._southWest.equals(t.getSouthWest(),o)&&this._northEast.equals(t.getNorthEast(),o)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function x(t,o){return t instanceof yt?t:new yt(t,o)}function it(t,o,a){if(isNaN(t)||isNaN(o))throw new Error("Invalid LatLng object: ("+t+", "+o+")");this.lat=+t,this.lng=+o,a!==void 0&&(this.alt=+a)}it.prototype={equals:function(t,o){if(!t)return!1;t=U(t);var a=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return a<=(o===void 0?1e-9:o)},toString:function(t){return"LatLng("+w(this.lat,t)+", "+w(this.lng,t)+")"},distanceTo:function(t){return Vt.distance(this,U(t))},wrap:function(){return Vt.wrapLatLng(this)},toBounds:function(t){var o=180*t/40075017,a=o/Math.cos(Math.PI/180*this.lat);return x([this.lat-o,this.lng-a],[this.lat+o,this.lng+a])},clone:function(){return new it(this.lat,this.lng,this.alt)}};function U(t,o,a){return t instanceof it?t:B(t)&&typeof t[0]!="object"?t.length===3?new it(t[0],t[1],t[2]):t.length===2?new it(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new it(t.lat,"lng"in t?t.lng:t.lon,t.alt):o===void 0?null:new it(t,o,a)}var q={latLngToPoint:function(t,o){var a=this.projection.project(t),h=this.scale(o);return this.transformation._transform(a,h)},pointToLatLng:function(t,o){var a=this.scale(o),h=this.transformation.untransform(t,a);return this.projection.unproject(h)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var o=this.projection.bounds,a=this.scale(t),h=this.transformation.transform(o.min,a),_=this.transformation.transform(o.max,a);return new kt(h,_)},infinite:!1,wrapLatLng:function(t){var o=this.wrapLng?p(t.lng,this.wrapLng,!0):t.lng,a=this.wrapLat?p(t.lat,this.wrapLat,!0):t.lat,h=t.alt;return new it(a,o,h)},wrapLatLngBounds:function(t){var o=t.getCenter(),a=this.wrapLatLng(o),h=o.lat-a.lat,_=o.lng-a.lng;if(h===0&&_===0)return t;var v=t.getSouthWest(),C=t.getNorthEast(),N=new it(v.lat-h,v.lng-_),D=new it(C.lat-h,C.lng-_);return new yt(N,D)}},Vt=r({},q,{wrapLng:[-180,180],R:6371e3,distance:function(t,o){var a=Math.PI/180,h=t.lat*a,_=o.lat*a,v=Math.sin((o.lat-t.lat)*a/2),C=Math.sin((o.lng-t.lng)*a/2),N=v*v+Math.cos(h)*Math.cos(_)*C*C,D=2*Math.atan2(Math.sqrt(N),Math.sqrt(1-N));return this.R*D}}),re=6378137,dt={R:re,MAX_LATITUDE:85.0511287798,project:function(t){var o=Math.PI/180,a=this.MAX_LATITUDE,h=Math.max(Math.min(a,t.lat),-a),_=Math.sin(h*o);return new j(this.R*t.lng*o,this.R*Math.log((1+_)/(1-_))/2)},unproject:function(t){var o=180/Math.PI;return new it((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*o,t.x*o/this.R)},bounds:function(){var t=re*Math.PI;return new kt([-t,-t],[t,t])}()};function Dt(t,o,a,h){if(B(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=o,this._c=a,this._d=h}Dt.prototype={transform:function(t,o){return this._transform(t.clone(),o)},_transform:function(t,o){return o=o||1,t.x=o*(this._a*t.x+this._b),t.y=o*(this._c*t.y+this._d),t},untransform:function(t,o){return o=o||1,new j((t.x/o-this._b)/this._a,(t.y/o-this._d)/this._c)}};function Ht(t,o,a,h){return new Dt(t,o,a,h)}var Wt=r({},Vt,{code:"EPSG:3857",projection:dt,transformation:function(){var t=.5/(Math.PI*dt.R);return Ht(t,.5,-t,.5)}()}),It=r({},Wt,{code:"EPSG:900913"});function ne(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Xt(t,o){var a="",h,_,v,C,N,D;for(h=0,v=t.length;h<v;h++){for(N=t[h],_=0,C=N.length;_<C;_++)D=N[_],a+=(_?"L":"M")+D.x+" "+D.y;a+=o?Pt.svg?"z":"x":""}return a||"M0 0"}var ot=document.documentElement.style,ae="ActiveXObject"in window,Qt=ae&&!document.addEventListener,Rt="msLaunchUri"in navigator&&!("documentMode"in document),se=qe("webkit"),Fe=qe("android"),Ge=qe("android 2")||qe("android 3"),De=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ce=Fe&&qe("Google")&&De<537&&!("AudioNode"in window),Kt=!!window.opera,he=!Rt&&qe("chrome"),ze=qe("gecko")&&!se&&!Kt&&!ae,Re=!he&&qe("safari"),Ft=qe("phantom"),le="OTransition"in ot,xe=navigator.platform.indexOf("Win")===0,Je=ae&&"transition"in ot,Qe="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Ge,Sn="MozPerspective"in ot,ye=!window.L_DISABLE_3D&&(Je||Qe||Sn)&&!le&&!Ft,Xe=typeof orientation<"u"||qe("mobile"),Ot=Xe&&se,an=Xe&&Qe,je=!window.PointerEvent&&window.MSPointerEvent,Ue=!!(window.PointerEvent||je),dn="ontouchstart"in window||!!window.TouchEvent,bn=!window.L_NO_TOUCH&&(dn||Ue),He=Xe&&Kt,Ne=Xe&&ze,$e=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Jt=function(){var t=!1;try{var o=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",g,o),window.removeEventListener("testPassiveEventSupport",g,o)}catch{}return t}(),fe=function(){return!!document.createElement("canvas").getContext}(),tn=!!(document.createElementNS&&ne("svg").createSVGRect),Tn=!!tn&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),pn=!tn&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var o=t.firstChild;return o.style.behavior="url(#default#VML)",o&&typeof o.adj=="object"}catch{return!1}}(),gn=navigator.platform.indexOf("Mac")===0,En=navigator.platform.indexOf("Linux")===0;function qe(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var Pt={ie:ae,ielt9:Qt,edge:Rt,webkit:se,android:Fe,android23:Ge,androidStock:Ce,opera:Kt,chrome:he,gecko:ze,safari:Re,phantom:Ft,opera12:le,win:xe,ie3d:Je,webkit3d:Qe,gecko3d:Sn,any3d:ye,mobile:Xe,mobileWebkit:Ot,mobileWebkit3d:an,msPointer:je,pointer:Ue,touch:bn,touchNative:dn,mobileOpera:He,mobileGecko:Ne,retina:$e,passiveEvents:Jt,canvas:fe,svg:tn,vml:pn,inlineSvg:Tn,mac:gn,linux:En},Ye=Pt.msPointer?"MSPointerDown":"pointerdown",vn=Pt.msPointer?"MSPointerMove":"pointermove",en=Pt.msPointer?"MSPointerUp":"pointerup",Bn=Pt.msPointer?"MSPointerCancel":"pointercancel",y={touchstart:Ye,touchmove:vn,touchend:en,touchcancel:Bn},_t={touchstart:ln,touchmove:nn,touchend:nn,touchcancel:nn},Lt={},Ct=!1;function At(t,o,a){return o==="touchstart"&&Se(),_t[o]?(a=_t[o].bind(this,a),t.addEventListener(y[o],a,!1),a):(console.warn("wrong event specified:",o),g)}function O(t,o,a){if(!y[o]){console.warn("wrong event specified:",o);return}t.removeEventListener(y[o],a,!1)}function $t(t){Lt[t.pointerId]=t}function me(t){Lt[t.pointerId]&&(Lt[t.pointerId]=t)}function Yt(t){delete Lt[t.pointerId]}function Se(){Ct||(document.addEventListener(Ye,$t,!0),document.addEventListener(vn,me,!0),document.addEventListener(en,Yt,!0),document.addEventListener(Bn,Yt,!0),Ct=!0)}function nn(t,o){if(o.pointerType!==(o.MSPOINTER_TYPE_MOUSE||"mouse")){o.touches=[];for(var a in Lt)o.touches.push(Lt[a]);o.changedTouches=[o],t(o)}}function ln(t,o){o.MSPOINTER_TYPE_TOUCH&&o.pointerType===o.MSPOINTER_TYPE_TOUCH&&St(o),nn(t,o)}function on(t){var o={},a,h;for(h in t)a=t[h],o[h]=a&&a.bind?a.bind(t):a;return t=o,o.type="dblclick",o.detail=2,o.isTrusted=!1,o._simulated=!0,o}var An=200;function oi(t,o){t.addEventListener("dblclick",o);var a=0,h;function _(v){if(v.detail!==1){h=v.detail;return}if(!(v.pointerType==="mouse"||v.sourceCapabilities&&!v.sourceCapabilities.firesTouchEvents)){var C=ki(v);if(!(C.some(function(D){return D instanceof HTMLLabelElement&&D.attributes.for})&&!C.some(function(D){return D instanceof HTMLInputElement||D instanceof HTMLSelectElement}))){var N=Date.now();N-a<=An?(h++,h===2&&o(on(v))):h=1,a=N}}}return t.addEventListener("click",_),{dblclick:o,simDblclick:_}}function Wn(t,o){t.removeEventListener("dblclick",o.dblclick),t.removeEventListener("click",o.simDblclick)}var xn=Gn(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),wn=Gn(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Jn=wn==="webkitTransition"||wn==="OTransition"?wn+"End":"transitionend";function Kn(t){return typeof t=="string"?document.getElementById(t):t}function gt(t,o){var a=t.style[o]||t.currentStyle&&t.currentStyle[o];if((!a||a==="auto")&&document.defaultView){var h=document.defaultView.getComputedStyle(t,null);a=h?h[o]:null}return a==="auto"?null:a}function Gt(t,o,a){var h=document.createElement(t);return h.className=o||"",a&&a.appendChild(h),h}function ee(t){var o=t.parentNode;o&&o.removeChild(t)}function un(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Mn(t){var o=t.parentNode;o&&o.lastChild!==t&&o.appendChild(t)}function cn(t){var o=t.parentNode;o&&o.firstChild!==t&&o.insertBefore(t,o.firstChild)}function pe(t,o){if(t.classList!==void 0)return t.classList.contains(o);var a=Qn(t);return a.length>0&&new RegExp("(^|\\s)"+o+"(\\s|$)").test(a)}function xt(t,o){if(t.classList!==void 0)for(var a=P(o),h=0,_=a.length;h<_;h++)t.classList.add(a[h]);else if(!pe(t,o)){var v=Qn(t);Fn(t,(v?v+" ":"")+o)}}function We(t,o){t.classList!==void 0?t.classList.remove(o):Fn(t,k((" "+Qn(t)+" ").replace(" "+o+" "," ")))}function Fn(t,o){t.className.baseVal===void 0?t.className=o:t.className.baseVal=o}function Qn(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function hn(t,o){"opacity"in t.style?t.style.opacity=o:"filter"in t.style&&mi(t,o)}function mi(t,o){var a=!1,h="DXImageTransform.Microsoft.Alpha";try{a=t.filters.item(h)}catch{if(o===1)return}o=Math.round(o*100),a?(a.Enabled=o!==100,a.Opacity=o):t.style.filter+=" progid:"+h+"(opacity="+o+")"}function Gn(t){for(var o=document.documentElement.style,a=0;a<t.length;a++)if(t[a]in o)return t[a];return!1}function kn(t,o,a){var h=o||new j(0,0);t.style[xn]=(Pt.ie3d?"translate("+h.x+"px,"+h.y+"px)":"translate3d("+h.x+"px,"+h.y+"px,0)")+(a?" scale("+a+")":"")}function ge(t,o){t._leaflet_pos=o,Pt.any3d?kn(t,o):(t.style.left=o.x+"px",t.style.top=o.y+"px")}function Un(t){return t._leaflet_pos||new j(0,0)}var In,Zn,On;if("onselectstart"in document)In=function(){et(window,"selectstart",St)},Zn=function(){wt(window,"selectstart",St)};else{var Dn=Gn(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);In=function(){if(Dn){var t=document.documentElement.style;On=t[Dn],t[Dn]="none"}},Zn=function(){Dn&&(document.documentElement.style[Dn]=On,On=void 0)}}function ai(){et(window,"dragstart",St)}function sn(){wt(window,"dragstart",St)}var li,bi;function wi(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(S(),li=t,bi=t.style.outlineStyle,t.style.outlineStyle="none",et(window,"keydown",S))}function S(){li&&(li.style.outlineStyle=bi,li=void 0,bi=void 0,wt(window,"keydown",S))}function nt(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function V(t){var o=t.getBoundingClientRect();return{x:o.width/t.offsetWidth||1,y:o.height/t.offsetHeight||1,boundingClientRect:o}}var zt={__proto__:null,TRANSFORM:xn,TRANSITION:wn,TRANSITION_END:Jn,get:Kn,getStyle:gt,create:Gt,remove:ee,empty:un,toFront:Mn,toBack:cn,hasClass:pe,addClass:xt,removeClass:We,setClass:Fn,getClass:Qn,setOpacity:hn,testProp:Gn,setTransform:kn,setPosition:ge,getPosition:Un,get disableTextSelection(){return In},get enableTextSelection(){return Zn},disableImageDrag:ai,enableImageDrag:sn,preventOutline:wi,restoreOutline:S,getSizedParentNode:nt,getScale:V};function et(t,o,a,h){if(o&&typeof o=="object")for(var _ in o)be(t,_,o[_],a);else{o=P(o);for(var v=0,C=o.length;v<C;v++)be(t,o[v],a,h)}return this}var Tt="_leaflet_events";function wt(t,o,a,h){if(arguments.length===1)jt(t),delete t[Tt];else if(o&&typeof o=="object")for(var _ in o)rn(t,_,o[_],a);else if(o=P(o),arguments.length===2)jt(t,function(N){return H(o,N)!==-1});else for(var v=0,C=o.length;v<C;v++)rn(t,o[v],a,h);return this}function jt(t,o){for(var a in t[Tt]){var h=a.split(/\d/)[0];(!o||o(h))&&rn(t,h,null,null,a)}}var Bt={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function be(t,o,a,h){var _=o+f(a)+(h?"_"+f(h):"");if(t[Tt]&&t[Tt][_])return this;var v=function(N){return a.call(h||t,N||window.event)},C=v;!Pt.touchNative&&Pt.pointer&&o.indexOf("touch")===0?v=At(t,o,v):Pt.touch&&o==="dblclick"?v=oi(t,v):"addEventListener"in t?o==="touchstart"||o==="touchmove"||o==="wheel"||o==="mousewheel"?t.addEventListener(Bt[o]||o,v,Pt.passiveEvents?{passive:!1}:!1):o==="mouseenter"||o==="mouseleave"?(v=function(N){N=N||window.event,zo(t,N)&&C(N)},t.addEventListener(Bt[o],v,!1)):t.addEventListener(o,C,!1):t.attachEvent("on"+o,v),t[Tt]=t[Tt]||{},t[Tt][_]=v}function rn(t,o,a,h,_){_=_||o+f(a)+(h?"_"+f(h):"");var v=t[Tt]&&t[Tt][_];if(!v)return this;!Pt.touchNative&&Pt.pointer&&o.indexOf("touch")===0?O(t,o,v):Pt.touch&&o==="dblclick"?Wn(t,v):"removeEventListener"in t?t.removeEventListener(Bt[o]||o,v,!1):t.detachEvent("on"+o,v),t[Tt][_]=null}function Rn(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function ui(t){return be(t,"wheel",Rn),this}function zn(t){return et(t,"mousedown touchstart dblclick contextmenu",Rn),t._leaflet_disable_click=!0,this}function St(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function ie(t){return St(t),Rn(t),this}function ki(t){if(t.composedPath)return t.composedPath();for(var o=[],a=t.target;a;)o.push(a),a=a.parentNode;return o}function us(t,o){if(!o)return new j(t.clientX,t.clientY);var a=V(o),h=a.boundingClientRect;return new j((t.clientX-h.left)/a.x-o.clientLeft,(t.clientY-h.top)/a.y-o.clientTop)}var gl=Pt.linux&&Pt.chrome?window.devicePixelRatio:Pt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function cs(t){return Pt.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/gl:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function zo(t,o){var a=o.relatedTarget;if(!a)return!0;try{for(;a&&a!==t;)a=a.parentNode}catch{return!1}return a!==t}var vl={__proto__:null,on:et,off:wt,stopPropagation:Rn,disableScrollPropagation:ui,disableClickPropagation:zn,preventDefault:St,stop:ie,getPropagationPath:ki,getMousePosition:us,getWheelDelta:cs,isExternalTarget:zo,addListener:et,removeListener:wt},hs=J.extend({run:function(t,o,a,h){this.stop(),this._el=t,this._inProgress=!0,this._duration=a||.25,this._easeOutPower=1/Math.max(h||.5,.2),this._startPos=Un(t),this._offset=o.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=ht(this._animate,this),this._step()},_step:function(t){var o=+new Date-this._startTime,a=this._duration*1e3;o<a?this._runFrame(this._easeOut(o/a),t):(this._runFrame(1),this._complete())},_runFrame:function(t,o){var a=this._startPos.add(this._offset.multiplyBy(t));o&&a._round(),ge(this._el,a),this.fire("step")},_complete:function(){I(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),we=J.extend({options:{crs:Wt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,o){o=M(this,o),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=u(this._onResize,this),this._initEvents(),o.maxBounds&&this.setMaxBounds(o.maxBounds),o.zoom!==void 0&&(this._zoom=this._limitZoom(o.zoom)),o.center&&o.zoom!==void 0&&this.setView(U(o.center),o.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=wn&&Pt.any3d&&!Pt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),et(this._proxy,Jn,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,o,a){if(o=o===void 0?this._zoom:this._limitZoom(o),t=this._limitCenter(U(t),o,this.options.maxBounds),a=a||{},this._stop(),this._loaded&&!a.reset&&a!==!0){a.animate!==void 0&&(a.zoom=r({animate:a.animate},a.zoom),a.pan=r({animate:a.animate,duration:a.duration},a.pan));var h=this._zoom!==o?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,o,a.zoom):this._tryAnimatedPan(t,a.pan);if(h)return clearTimeout(this._sizeTimer),this}return this._resetView(t,o,a.pan&&a.pan.noMoveStart),this},setZoom:function(t,o){return this._loaded?this.setView(this.getCenter(),t,{zoom:o}):(this._zoom=t,this)},zoomIn:function(t,o){return t=t||(Pt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,o)},zoomOut:function(t,o){return t=t||(Pt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,o)},setZoomAround:function(t,o,a){var h=this.getZoomScale(o),_=this.getSize().divideBy(2),v=t instanceof j?t:this.latLngToContainerPoint(t),C=v.subtract(_).multiplyBy(1-1/h),N=this.containerPointToLatLng(_.add(C));return this.setView(N,o,{zoom:a})},_getBoundsCenterZoom:function(t,o){o=o||{},t=t.getBounds?t.getBounds():x(t);var a=ut(o.paddingTopLeft||o.padding||[0,0]),h=ut(o.paddingBottomRight||o.padding||[0,0]),_=this.getBoundsZoom(t,!1,a.add(h));if(_=typeof o.maxZoom=="number"?Math.min(o.maxZoom,_):_,_===1/0)return{center:t.getCenter(),zoom:_};var v=h.subtract(a).divideBy(2),C=this.project(t.getSouthWest(),_),N=this.project(t.getNorthEast(),_),D=this.unproject(C.add(N).divideBy(2).add(v),_);return{center:D,zoom:_}},fitBounds:function(t,o){if(t=x(t),!t.isValid())throw new Error("Bounds are not valid.");var a=this._getBoundsCenterZoom(t,o);return this.setView(a.center,a.zoom,o)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,o){return this.setView(t,this._zoom,{pan:o})},panBy:function(t,o){if(t=ut(t).round(),o=o||{},!t.x&&!t.y)return this.fire("moveend");if(o.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new hs,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),o.noMoveStart||this.fire("movestart"),o.animate!==!1){xt(this._mapPane,"leaflet-pan-anim");var a=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,a,o.duration||.25,o.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,o,a){if(a=a||{},a.animate===!1||!Pt.any3d)return this.setView(t,o,a);this._stop();var h=this.project(this.getCenter()),_=this.project(t),v=this.getSize(),C=this._zoom;t=U(t),o=o===void 0?C:o;var N=Math.max(v.x,v.y),D=N*this.getZoomScale(C,o),ct=_.distanceTo(h)||1,Mt=1.42,qt=Mt*Mt;function de(Pn){var bo=Pn?-1:1,ru=Pn?D:N,au=D*D-N*N+bo*qt*qt*ct*ct,lu=2*ru*qt*ct,Wo=au/lu,Us=Math.sqrt(Wo*Wo+1)-Wo,uu=Us<1e-9?-18:Math.log(Us);return uu}function jn(Pn){return(Math.exp(Pn)-Math.exp(-Pn))/2}function Nn(Pn){return(Math.exp(Pn)+Math.exp(-Pn))/2}function ti(Pn){return jn(Pn)/Nn(Pn)}var qn=de(0);function Ri(Pn){return N*(Nn(qn)/Nn(qn+Mt*Pn))}function nu(Pn){return N*(Nn(qn)*ti(qn+Mt*Pn)-jn(qn))/qt}function iu(Pn){return 1-Math.pow(1-Pn,1.5)}var ou=Date.now(),Fs=(de(1)-qn)/Mt,su=a.duration?1e3*a.duration:1e3*Fs*.8;function Gs(){var Pn=(Date.now()-ou)/su,bo=iu(Pn)*Fs;Pn<=1?(this._flyToFrame=ht(Gs,this),this._move(this.unproject(h.add(_.subtract(h).multiplyBy(nu(bo)/ct)),C),this.getScaleZoom(N/Ri(bo),C),{flyTo:!0})):this._move(t,o)._moveEnd(!0)}return this._moveStart(!0,a.noMoveStart),Gs.call(this),this},flyToBounds:function(t,o){var a=this._getBoundsCenterZoom(t,o);return this.flyTo(a.center,a.zoom,o)},setMaxBounds:function(t){return t=x(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var o=this.options.minZoom;return this.options.minZoom=t,this._loaded&&o!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var o=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&o!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,o){this._enforcingBounds=!0;var a=this.getCenter(),h=this._limitCenter(a,this._zoom,x(t));return a.equals(h)||this.panTo(h,o),this._enforcingBounds=!1,this},panInside:function(t,o){o=o||{};var a=ut(o.paddingTopLeft||o.padding||[0,0]),h=ut(o.paddingBottomRight||o.padding||[0,0]),_=this.project(this.getCenter()),v=this.project(t),C=this.getPixelBounds(),N=Nt([C.min.add(a),C.max.subtract(h)]),D=N.getSize();if(!N.contains(v)){this._enforcingBounds=!0;var ct=v.subtract(N.getCenter()),Mt=N.extend(v).getSize().subtract(D);_.x+=ct.x<0?-Mt.x:Mt.x,_.y+=ct.y<0?-Mt.y:Mt.y,this.panTo(this.unproject(_),o),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=r({animate:!1,pan:!0},t===!0?{animate:!0}:t);var o=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var a=this.getSize(),h=o.divideBy(2).round(),_=a.divideBy(2).round(),v=h.subtract(_);return!v.x&&!v.y?this:(t.animate&&t.pan?this.panBy(v):(t.pan&&this._rawPanBy(v),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(u(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:o,newSize:a}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=r({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var o=u(this._handleGeolocationResponse,this),a=u(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(o,a,t):navigator.geolocation.getCurrentPosition(o,a,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var o=t.code,a=t.message||(o===1?"permission denied":o===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:o,message:"Geolocation error: "+a+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var o=t.coords.latitude,a=t.coords.longitude,h=new it(o,a),_=h.toBounds(t.coords.accuracy*2),v=this._locateOptions;if(v.setView){var C=this.getBoundsZoom(_);this.setView(h,v.maxZoom?Math.min(C,v.maxZoom):C)}var N={latlng:h,bounds:_,timestamp:t.timestamp};for(var D in t.coords)typeof t.coords[D]=="number"&&(N[D]=t.coords[D]);this.fire("locationfound",N)}},addHandler:function(t,o){if(!o)return this;var a=this[t]=new o(this);return this._handlers.push(a),this.options[t]&&a.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ee(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(I(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)ee(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,o){var a="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),h=Gt("div",a,o||this._mapPane);return t&&(this._panes[t]=h),h},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),o=this.unproject(t.getBottomLeft()),a=this.unproject(t.getTopRight());return new yt(o,a)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,o,a){t=x(t),a=ut(a||[0,0]);var h=this.getZoom()||0,_=this.getMinZoom(),v=this.getMaxZoom(),C=t.getNorthWest(),N=t.getSouthEast(),D=this.getSize().subtract(a),ct=Nt(this.project(N,h),this.project(C,h)).getSize(),Mt=Pt.any3d?this.options.zoomSnap:1,qt=D.x/ct.x,de=D.y/ct.y,jn=o?Math.max(qt,de):Math.min(qt,de);return h=this.getScaleZoom(jn,h),Mt&&(h=Math.round(h/(Mt/100))*(Mt/100),h=o?Math.ceil(h/Mt)*Mt:Math.floor(h/Mt)*Mt),Math.max(_,Math.min(v,h))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new j(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,o){var a=this._getTopLeftPoint(t,o);return new kt(a,a.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,o){var a=this.options.crs;return o=o===void 0?this._zoom:o,a.scale(t)/a.scale(o)},getScaleZoom:function(t,o){var a=this.options.crs;o=o===void 0?this._zoom:o;var h=a.zoom(t*a.scale(o));return isNaN(h)?1/0:h},project:function(t,o){return o=o===void 0?this._zoom:o,this.options.crs.latLngToPoint(U(t),o)},unproject:function(t,o){return o=o===void 0?this._zoom:o,this.options.crs.pointToLatLng(ut(t),o)},layerPointToLatLng:function(t){var o=ut(t).add(this.getPixelOrigin());return this.unproject(o)},latLngToLayerPoint:function(t){var o=this.project(U(t))._round();return o._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(U(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(x(t))},distance:function(t,o){return this.options.crs.distance(U(t),U(o))},containerPointToLayerPoint:function(t){return ut(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return ut(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var o=this.containerPointToLayerPoint(ut(t));return this.layerPointToLatLng(o)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(U(t)))},mouseEventToContainerPoint:function(t){return us(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var o=this._container=Kn(t);if(o){if(o._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");et(o,"scroll",this._onScroll,this),this._containerId=f(o)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&Pt.any3d,xt(t,"leaflet-container"+(Pt.touch?" leaflet-touch":"")+(Pt.retina?" leaflet-retina":"")+(Pt.ielt9?" leaflet-oldie":"")+(Pt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var o=gt(t,"position");o!=="absolute"&&o!=="relative"&&o!=="fixed"&&o!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),ge(this._mapPane,new j(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(xt(t.markerPane,"leaflet-zoom-hide"),xt(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,o,a){ge(this._mapPane,new j(0,0));var h=!this._loaded;this._loaded=!0,o=this._limitZoom(o),this.fire("viewprereset");var _=this._zoom!==o;this._moveStart(_,a)._move(t,o)._moveEnd(_),this.fire("viewreset"),h&&this.fire("load")},_moveStart:function(t,o){return t&&this.fire("zoomstart"),o||this.fire("movestart"),this},_move:function(t,o,a,h){o===void 0&&(o=this._zoom);var _=this._zoom!==o;return this._zoom=o,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),h?a&&a.pinch&&this.fire("zoom",a):((_||a&&a.pinch)&&this.fire("zoom",a),this.fire("move",a)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return I(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){ge(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[f(this._container)]=this;var o=t?wt:et;o(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&o(window,"resize",this._onResize,this),Pt.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){I(this._resizeRequest),this._resizeRequest=ht(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,o){for(var a=[],h,_=o==="mouseout"||o==="mouseover",v=t.target||t.srcElement,C=!1;v;){if(h=this._targets[f(v)],h&&(o==="click"||o==="preclick")&&this._draggableMoved(h)){C=!0;break}if(h&&h.listens(o,!0)&&(_&&!zo(v,t)||(a.push(h),_))||v===this._container)break;v=v.parentNode}return!a.length&&!C&&!_&&this.listens(o,!0)&&(a=[this]),a},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var o=t.target||t.srcElement;if(!(!this._loaded||o._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(o))){var a=t.type;a==="mousedown"&&wi(o),this._fireDOMEvent(t,a)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,o,a){if(t.type==="click"){var h=r({},t);h.type="preclick",this._fireDOMEvent(h,h.type,a)}var _=this._findEventTargets(t,o);if(a){for(var v=[],C=0;C<a.length;C++)a[C].listens(o,!0)&&v.push(a[C]);_=v.concat(_)}if(_.length){o==="contextmenu"&&St(t);var N=_[0],D={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var ct=N.getLatLng&&(!N._radius||N._radius<=10);D.containerPoint=ct?this.latLngToContainerPoint(N.getLatLng()):this.mouseEventToContainerPoint(t),D.layerPoint=this.containerPointToLayerPoint(D.containerPoint),D.latlng=ct?N.getLatLng():this.layerPointToLatLng(D.layerPoint)}for(C=0;C<_.length;C++)if(_[C].fire(o,D,!0),D.originalEvent._stopped||_[C].options.bubblingMouseEvents===!1&&H(this._mouseEvents,o)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,o=this._handlers.length;t<o;t++)this._handlers[t].disable()},whenReady:function(t,o){return this._loaded?t.call(o||this,{target:this}):this.on("load",t,o),this},_getMapPanePos:function(){return Un(this._mapPane)||new j(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,o){var a=t&&o!==void 0?this._getNewPixelOrigin(t,o):this.getPixelOrigin();return a.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,o){var a=this.getSize()._divideBy(2);return this.project(t,o)._subtract(a)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,o,a){var h=this._getNewPixelOrigin(a,o);return this.project(t,o)._subtract(h)},_latLngBoundsToNewLayerBounds:function(t,o,a){var h=this._getNewPixelOrigin(a,o);return Nt([this.project(t.getSouthWest(),o)._subtract(h),this.project(t.getNorthWest(),o)._subtract(h),this.project(t.getSouthEast(),o)._subtract(h),this.project(t.getNorthEast(),o)._subtract(h)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,o,a){if(!a)return t;var h=this.project(t,o),_=this.getSize().divideBy(2),v=new kt(h.subtract(_),h.add(_)),C=this._getBoundsOffset(v,a,o);return Math.abs(C.x)<=1&&Math.abs(C.y)<=1?t:this.unproject(h.add(C),o)},_limitOffset:function(t,o){if(!o)return t;var a=this.getPixelBounds(),h=new kt(a.min.add(t),a.max.add(t));return t.add(this._getBoundsOffset(h,o))},_getBoundsOffset:function(t,o,a){var h=Nt(this.project(o.getNorthEast(),a),this.project(o.getSouthWest(),a)),_=h.min.subtract(t.min),v=h.max.subtract(t.max),C=this._rebound(_.x,-v.x),N=this._rebound(_.y,-v.y);return new j(C,N)},_rebound:function(t,o){return t+o>0?Math.round(t-o)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(o))},_limitZoom:function(t){var o=this.getMinZoom(),a=this.getMaxZoom(),h=Pt.any3d?this.options.zoomSnap:1;return h&&(t=Math.round(t/h)*h),Math.max(o,Math.min(a,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){We(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,o){var a=this._getCenterOffset(t)._trunc();return(o&&o.animate)!==!0&&!this.getSize().contains(a)?!1:(this.panBy(a,o),!0)},_createAnimProxy:function(){var t=this._proxy=Gt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(o){var a=xn,h=this._proxy.style[a];kn(this._proxy,this.project(o.center,o.zoom),this.getZoomScale(o.zoom,1)),h===this._proxy.style[a]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ee(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),o=this.getZoom();kn(this._proxy,this.project(t,o),this.getZoomScale(o,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,o,a){if(this._animatingZoom)return!0;if(a=a||{},!this._zoomAnimated||a.animate===!1||this._nothingToAnimate()||Math.abs(o-this._zoom)>this.options.zoomAnimationThreshold)return!1;var h=this.getZoomScale(o),_=this._getCenterOffset(t)._divideBy(1-1/h);return a.animate!==!0&&!this.getSize().contains(_)?!1:(ht(function(){this._moveStart(!0,a.noMoveStart||!1)._animateZoom(t,o,!0)},this),!0)},_animateZoom:function(t,o,a,h){this._mapPane&&(a&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=o,xt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:o,noUpdate:h}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(u(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&We(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function yl(t,o){return new we(t,o)}var si=R.extend({options:{position:"topright"},initialize:function(t){M(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var o=this._map;return o&&o.removeControl(this),this.options.position=t,o&&o.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var o=this._container=this.onAdd(t),a=this.getPosition(),h=t._controlCorners[a];return xt(o,"leaflet-control"),a.indexOf("bottom")!==-1?h.insertBefore(o,h.firstChild):h.appendChild(o),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ee(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),qi=function(t){return new si(t)};we.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},o="leaflet-",a=this._controlContainer=Gt("div",o+"control-container",this._container);function h(_,v){var C=o+_+" "+o+v;t[_+v]=Gt("div",C,a)}h("top","left"),h("top","right"),h("bottom","left"),h("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)ee(this._controlCorners[t]);ee(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var fs=si.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,o,a,h){return a<h?-1:h<a?1:0}},initialize:function(t,o,a){M(this,a),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var h in t)this._addLayer(t[h],h);for(h in o)this._addLayer(o[h],h,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var o=0;o<this._layers.length;o++)this._layers[o].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return si.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,o){return this._addLayer(t,o),this._map?this._update():this},addOverlay:function(t,o){return this._addLayer(t,o,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var o=this._getLayer(f(t));return o&&this._layers.splice(this._layers.indexOf(o),1),this._map?this._update():this},expand:function(){xt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(xt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):We(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return We(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",o=this._container=Gt("div",t),a=this.options.collapsed;o.setAttribute("aria-haspopup",!0),zn(o),ui(o);var h=this._section=Gt("section",t+"-list");a&&(this._map.on("click",this.collapse,this),et(o,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var _=this._layersLink=Gt("a",t+"-toggle",o);_.href="#",_.title="Layers",_.setAttribute("role","button"),et(_,{keydown:function(v){v.keyCode===13&&this._expandSafely()},click:function(v){St(v),this._expandSafely()}},this),a||this.expand(),this._baseLayersList=Gt("div",t+"-base",h),this._separator=Gt("div",t+"-separator",h),this._overlaysList=Gt("div",t+"-overlays",h),o.appendChild(h)},_getLayer:function(t){for(var o=0;o<this._layers.length;o++)if(this._layers[o]&&f(this._layers[o].layer)===t)return this._layers[o]},_addLayer:function(t,o,a){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:o,overlay:a}),this.options.sortLayers&&this._layers.sort(u(function(h,_){return this.options.sortFunction(h.layer,_.layer,h.name,_.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;un(this._baseLayersList),un(this._overlaysList),this._layerControlInputs=[];var t,o,a,h,_=0;for(a=0;a<this._layers.length;a++)h=this._layers[a],this._addItem(h),o=o||h.overlay,t=t||!h.overlay,_+=h.overlay?0:1;return this.options.hideSingleBase&&(t=t&&_>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=o&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var o=this._getLayer(f(t.target)),a=o.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;a&&this._map.fire(a,o)},_createRadioElement:function(t,o){var a='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(o?' checked="checked"':"")+"/>",h=document.createElement("div");return h.innerHTML=a,h.firstChild},_addItem:function(t){var o=document.createElement("label"),a=this._map.hasLayer(t.layer),h;t.overlay?(h=document.createElement("input"),h.type="checkbox",h.className="leaflet-control-layers-selector",h.defaultChecked=a):h=this._createRadioElement("leaflet-base-layers_"+f(this),a),this._layerControlInputs.push(h),h.layerId=f(t.layer),et(h,"click",this._onInputClick,this);var _=document.createElement("span");_.innerHTML=" "+t.name;var v=document.createElement("span");o.appendChild(v),v.appendChild(h),v.appendChild(_);var C=t.overlay?this._overlaysList:this._baseLayersList;return C.appendChild(o),this._checkDisabledLayers(),o},_onInputClick:function(){if(!this._preventClick){var t=this._layerControlInputs,o,a,h=[],_=[];this._handlingClick=!0;for(var v=t.length-1;v>=0;v--)o=t[v],a=this._getLayer(o.layerId).layer,o.checked?h.push(a):o.checked||_.push(a);for(v=0;v<_.length;v++)this._map.hasLayer(_[v])&&this._map.removeLayer(_[v]);for(v=0;v<h.length;v++)this._map.hasLayer(h[v])||this._map.addLayer(h[v]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,o,a,h=this._map.getZoom(),_=t.length-1;_>=0;_--)o=t[_],a=this._getLayer(o.layerId).layer,o.disabled=a.options.minZoom!==void 0&&h<a.options.minZoom||a.options.maxZoom!==void 0&&h>a.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;this._preventClick=!0,et(t,"click",St),this.expand();var o=this;setTimeout(function(){wt(t,"click",St),o._preventClick=!1})}}),bl=function(t,o,a){return new fs(t,o,a)},No=si.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var o="leaflet-control-zoom",a=Gt("div",o+" leaflet-bar"),h=this.options;return this._zoomInButton=this._createButton(h.zoomInText,h.zoomInTitle,o+"-in",a,this._zoomIn),this._zoomOutButton=this._createButton(h.zoomOutText,h.zoomOutTitle,o+"-out",a,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),a},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,o,a,h,_){var v=Gt("a",a,h);return v.innerHTML=t,v.href="#",v.title=o,v.setAttribute("role","button"),v.setAttribute("aria-label",o),zn(v),et(v,"click",ie),et(v,"click",_,this),et(v,"click",this._refocusOnMap,this),v},_updateDisabled:function(){var t=this._map,o="leaflet-disabled";We(this._zoomInButton,o),We(this._zoomOutButton,o),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(xt(this._zoomOutButton,o),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(xt(this._zoomInButton,o),this._zoomInButton.setAttribute("aria-disabled","true"))}});we.mergeOptions({zoomControl:!0}),we.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new No,this.addControl(this.zoomControl))});var wl=function(t){return new No(t)},ds=si.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var o="leaflet-control-scale",a=Gt("div",o),h=this.options;return this._addScales(h,o+"-line",a),t.on(h.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),a},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,o,a){t.metric&&(this._mScale=Gt("div",o,a)),t.imperial&&(this._iScale=Gt("div",o,a))},_update:function(){var t=this._map,o=t.getSize().y/2,a=t.distance(t.containerPointToLatLng([0,o]),t.containerPointToLatLng([this.options.maxWidth,o]));this._updateScales(a)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var o=this._getRoundNum(t),a=o<1e3?o+" m":o/1e3+" km";this._updateScale(this._mScale,a,o/t)},_updateImperial:function(t){var o=t*3.2808399,a,h,_;o>5280?(a=o/5280,h=this._getRoundNum(a),this._updateScale(this._iScale,h+" mi",h/a)):(_=this._getRoundNum(o),this._updateScale(this._iScale,_+" ft",_/o))},_updateScale:function(t,o,a){t.style.width=Math.round(this.options.maxWidth*a)+"px",t.innerHTML=o},_getRoundNum:function(t){var o=Math.pow(10,(Math.floor(t)+"").length-1),a=t/o;return a=a>=10?10:a>=5?5:a>=3?3:a>=2?2:1,o*a}}),kl=function(t){return new ds(t)},Pl='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Io=si.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Pt.inlineSvg?Pl+" ":"")+"Leaflet</a>"},initialize:function(t){M(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=Gt("div","leaflet-control-attribution"),zn(this._container);for(var o in t._layers)t._layers[o].getAttribution&&this.addAttribution(t._layers[o].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var o in this._attributions)this._attributions[o]&&t.push(o);var a=[];this.options.prefix&&a.push(this.options.prefix),t.length&&a.push(t.join(", ")),this._container.innerHTML=a.join(' <span aria-hidden="true">|</span> ')}}});we.mergeOptions({attributionControl:!0}),we.addInitHook(function(){this.options.attributionControl&&new Io().addTo(this)});var Ll=function(t){return new Io(t)};si.Layers=fs,si.Zoom=No,si.Scale=ds,si.Attribution=Io,qi.layers=bl,qi.zoom=wl,qi.scale=kl,qi.attribution=Ll;var ci=R.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ci.addTo=function(t,o){return t.addHandler(o,this),this};var Cl={Events:pt},_s=Pt.touch?"touchstart mousedown":"mousedown",Pi=J.extend({options:{clickTolerance:3},initialize:function(t,o,a,h){M(this,h),this._element=t,this._dragStartTarget=o||t,this._preventOutline=a},enable:function(){this._enabled||(et(this._dragStartTarget,_s,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Pi._dragging===this&&this.finishDrag(!0),wt(this._dragStartTarget,_s,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!pe(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){Pi._dragging===this&&this.finishDrag();return}if(!(Pi._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(Pi._dragging=this,this._preventOutline&&wi(this._element),ai(),In(),!this._moving)){this.fire("down");var o=t.touches?t.touches[0]:t,a=nt(this._element);this._startPoint=new j(o.clientX,o.clientY),this._startPos=Un(this._element),this._parentScale=V(a);var h=t.type==="mousedown";et(document,h?"mousemove":"touchmove",this._onMove,this),et(document,h?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var o=t.touches&&t.touches.length===1?t.touches[0]:t,a=new j(o.clientX,o.clientY)._subtract(this._startPoint);!a.x&&!a.y||Math.abs(a.x)+Math.abs(a.y)<this.options.clickTolerance||(a.x/=this._parentScale.x,a.y/=this._parentScale.y,St(t),this._moved||(this.fire("dragstart"),this._moved=!0,xt(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),xt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(a),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),ge(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){We(document.body,"leaflet-dragging"),this._lastTarget&&(We(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),wt(document,"mousemove touchmove",this._onMove,this),wt(document,"mouseup touchend touchcancel",this._onUp,this),sn(),Zn();var o=this._moved&&this._moving;this._moving=!1,Pi._dragging=!1,o&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)})}});function ms(t,o,a){var h,_=[1,4,2,8],v,C,N,D,ct,Mt,qt,de;for(v=0,Mt=t.length;v<Mt;v++)t[v]._code=Mi(t[v],o);for(N=0;N<4;N++){for(qt=_[N],h=[],v=0,Mt=t.length,C=Mt-1;v<Mt;C=v++)D=t[v],ct=t[C],D._code&qt?ct._code&qt||(de=lo(ct,D,qt,o,a),de._code=Mi(de,o),h.push(de)):(ct._code&qt&&(de=lo(ct,D,qt,o,a),de._code=Mi(de,o),h.push(de)),h.push(D));t=h}return t}function ps(t,o){var a,h,_,v,C,N,D,ct,Mt;if(!t||t.length===0)throw new Error("latlngs not passed");$n(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var qt=U([0,0]),de=x(t),jn=de.getNorthWest().distanceTo(de.getSouthWest())*de.getNorthEast().distanceTo(de.getNorthWest());jn<1700&&(qt=Oo(t));var Nn=t.length,ti=[];for(a=0;a<Nn;a++){var qn=U(t[a]);ti.push(o.project(U([qn.lat-qt.lat,qn.lng-qt.lng])))}for(N=D=ct=0,a=0,h=Nn-1;a<Nn;h=a++)_=ti[a],v=ti[h],C=_.y*v.x-v.y*_.x,D+=(_.x+v.x)*C,ct+=(_.y+v.y)*C,N+=C*3;N===0?Mt=ti[0]:Mt=[D/N,ct/N];var Ri=o.unproject(ut(Mt));return U([Ri.lat+qt.lat,Ri.lng+qt.lng])}function Oo(t){for(var o=0,a=0,h=0,_=0;_<t.length;_++){var v=U(t[_]);o+=v.lat,a+=v.lng,h++}return U([o/h,a/h])}var Sl={__proto__:null,clipPolygon:ms,polygonCenter:ps,centroid:Oo};function gs(t,o){if(!o||!t.length)return t.slice();var a=o*o;return t=El(t,a),t=Tl(t,a),t}function vs(t,o,a){return Math.sqrt(Vi(t,o,a,!0))}function Ml(t,o,a){return Vi(t,o,a)}function Tl(t,o){var a=t.length,h=typeof Uint8Array<"u"?Uint8Array:Array,_=new h(a);_[0]=_[a-1]=1,Bo(t,_,o,0,a-1);var v,C=[];for(v=0;v<a;v++)_[v]&&C.push(t[v]);return C}function Bo(t,o,a,h,_){var v=0,C,N,D;for(N=h+1;N<=_-1;N++)D=Vi(t[N],t[h],t[_],!0),D>v&&(C=N,v=D);v>a&&(o[C]=1,Bo(t,o,a,h,C),Bo(t,o,a,C,_))}function El(t,o){for(var a=[t[0]],h=1,_=0,v=t.length;h<v;h++)Al(t[h],t[_])>o&&(a.push(t[h]),_=h);return _<v-1&&a.push(t[v-1]),a}var ys;function bs(t,o,a,h,_){var v=h?ys:Mi(t,a),C=Mi(o,a),N,D,ct;for(ys=C;;){if(!(v|C))return[t,o];if(v&C)return!1;N=v||C,D=lo(t,o,N,a,_),ct=Mi(D,a),N===v?(t=D,v=ct):(o=D,C=ct)}}function lo(t,o,a,h,_){var v=o.x-t.x,C=o.y-t.y,N=h.min,D=h.max,ct,Mt;return a&8?(ct=t.x+v*(D.y-t.y)/C,Mt=D.y):a&4?(ct=t.x+v*(N.y-t.y)/C,Mt=N.y):a&2?(ct=D.x,Mt=t.y+C*(D.x-t.x)/v):a&1&&(ct=N.x,Mt=t.y+C*(N.x-t.x)/v),new j(ct,Mt,_)}function Mi(t,o){var a=0;return t.x<o.min.x?a|=1:t.x>o.max.x&&(a|=2),t.y<o.min.y?a|=4:t.y>o.max.y&&(a|=8),a}function Al(t,o){var a=o.x-t.x,h=o.y-t.y;return a*a+h*h}function Vi(t,o,a,h){var _=o.x,v=o.y,C=a.x-_,N=a.y-v,D=C*C+N*N,ct;return D>0&&(ct=((t.x-_)*C+(t.y-v)*N)/D,ct>1?(_=a.x,v=a.y):ct>0&&(_+=C*ct,v+=N*ct)),C=t.x-_,N=t.y-v,h?C*C+N*N:new j(_,v)}function $n(t){return!B(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function ws(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),$n(t)}function ks(t,o){var a,h,_,v,C,N,D,ct;if(!t||t.length===0)throw new Error("latlngs not passed");$n(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var Mt=U([0,0]),qt=x(t),de=qt.getNorthWest().distanceTo(qt.getSouthWest())*qt.getNorthEast().distanceTo(qt.getNorthWest());de<1700&&(Mt=Oo(t));var jn=t.length,Nn=[];for(a=0;a<jn;a++){var ti=U(t[a]);Nn.push(o.project(U([ti.lat-Mt.lat,ti.lng-Mt.lng])))}for(a=0,h=0;a<jn-1;a++)h+=Nn[a].distanceTo(Nn[a+1])/2;if(h===0)ct=Nn[0];else for(a=0,v=0;a<jn-1;a++)if(C=Nn[a],N=Nn[a+1],_=C.distanceTo(N),v+=_,v>h){D=(v-h)/_,ct=[N.x-D*(N.x-C.x),N.y-D*(N.y-C.y)];break}var qn=o.unproject(ut(ct));return U([qn.lat+Mt.lat,qn.lng+Mt.lng])}var zl={__proto__:null,simplify:gs,pointToSegmentDistance:vs,closestPointOnSegment:Ml,clipSegment:bs,_getEdgeIntersection:lo,_getBitCode:Mi,_sqClosestPointOnSegment:Vi,isFlat:$n,_flat:ws,polylineCenter:ks},Zo={project:function(t){return new j(t.lng,t.lat)},unproject:function(t){return new it(t.y,t.x)},bounds:new kt([-180,-90],[180,90])},Do={R:6378137,R_MINOR:6356752314245179e-9,bounds:new kt([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var o=Math.PI/180,a=this.R,h=t.lat*o,_=this.R_MINOR/a,v=Math.sqrt(1-_*_),C=v*Math.sin(h),N=Math.tan(Math.PI/4-h/2)/Math.pow((1-C)/(1+C),v/2);return h=-a*Math.log(Math.max(N,1e-10)),new j(t.lng*o*a,h)},unproject:function(t){for(var o=180/Math.PI,a=this.R,h=this.R_MINOR/a,_=Math.sqrt(1-h*h),v=Math.exp(-t.y/a),C=Math.PI/2-2*Math.atan(v),N=0,D=.1,ct;N<15&&Math.abs(D)>1e-7;N++)ct=_*Math.sin(C),ct=Math.pow((1-ct)/(1+ct),_/2),D=Math.PI/2-2*Math.atan(v*ct)-C,C+=D;return new it(C*o,t.x*o/a)}},Nl={__proto__:null,LonLat:Zo,Mercator:Do,SphericalMercator:dt},Il=r({},Vt,{code:"EPSG:3395",projection:Do,transformation:function(){var t=.5/(Math.PI*Do.R);return Ht(t,.5,-t,.5)}()}),Ps=r({},Vt,{code:"EPSG:4326",projection:Zo,transformation:Ht(1/180,1,-1/180,.5)}),Ol=r({},q,{projection:Zo,transformation:Ht(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,o){var a=o.lng-t.lng,h=o.lat-t.lat;return Math.sqrt(a*a+h*h)},infinite:!0});q.Earth=Vt,q.EPSG3395=Il,q.EPSG3857=Wt,q.EPSG900913=It,q.EPSG4326=Ps,q.Simple=Ol;var ri=J.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[f(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[f(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var o=t.target;if(o.hasLayer(this)){if(this._map=o,this._zoomAnimated=o._zoomAnimated,this.getEvents){var a=this.getEvents();o.on(a,this),this.once("remove",function(){o.off(a,this)},this)}this.onAdd(o),this.fire("add"),o.fire("layeradd",{layer:this})}}});we.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var o=f(t);return this._layers[o]?this:(this._layers[o]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var o=f(t);return this._layers[o]?(this._loaded&&t.onRemove(this),delete this._layers[o],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return f(t)in this._layers},eachLayer:function(t,o){for(var a in this._layers)t.call(o,this._layers[a]);return this},_addLayers:function(t){t=t?B(t)?t:[t]:[];for(var o=0,a=t.length;o<a;o++)this.addLayer(t[o])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[f(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var o=f(t);this._zoomBoundLayers[o]&&(delete this._zoomBoundLayers[o],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,o=-1/0,a=this._getZoomSpan();for(var h in this._zoomBoundLayers){var _=this._zoomBoundLayers[h].options;t=_.minZoom===void 0?t:Math.min(t,_.minZoom),o=_.maxZoom===void 0?o:Math.max(o,_.maxZoom)}this._layersMaxZoom=o===-1/0?void 0:o,this._layersMinZoom=t===1/0?void 0:t,a!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Ii=ri.extend({initialize:function(t,o){M(this,o),this._layers={};var a,h;if(t)for(a=0,h=t.length;a<h;a++)this.addLayer(t[a])},addLayer:function(t){var o=this.getLayerId(t);return this._layers[o]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var o=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[o]&&this._map.removeLayer(this._layers[o]),delete this._layers[o],this},hasLayer:function(t){var o=typeof t=="number"?t:this.getLayerId(t);return o in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var o=Array.prototype.slice.call(arguments,1),a,h;for(a in this._layers)h=this._layers[a],h[t]&&h[t].apply(h,o);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,o){for(var a in this._layers)t.call(o,this._layers[a]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return f(t)}}),Bl=function(t,o){return new Ii(t,o)},pi=Ii.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),Ii.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),Ii.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new yt;for(var o in this._layers){var a=this._layers[o];t.extend(a.getBounds?a.getBounds():a.getLatLng())}return t}}),Zl=function(t,o){return new pi(t,o)},Oi=R.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){M(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,o){var a=this._getIconUrl(t);if(!a){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var h=this._createImg(a,o&&o.tagName==="IMG"?o:null);return this._setIconStyles(h,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(h.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),h},_setIconStyles:function(t,o){var a=this.options,h=a[o+"Size"];typeof h=="number"&&(h=[h,h]);var _=ut(h),v=ut(o==="shadow"&&a.shadowAnchor||a.iconAnchor||_&&_.divideBy(2,!0));t.className="leaflet-marker-"+o+" "+(a.className||""),v&&(t.style.marginLeft=-v.x+"px",t.style.marginTop=-v.y+"px"),_&&(t.style.width=_.x+"px",t.style.height=_.y+"px")},_createImg:function(t,o){return o=o||document.createElement("img"),o.src=t,o},_getIconUrl:function(t){return Pt.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function Dl(t){return new Oi(t)}var Xi=Oi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof Xi.imagePath!="string"&&(Xi.imagePath=this._detectIconPath()),(this.options.imagePath||Xi.imagePath)+Oi.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var o=function(a,h,_){var v=h.exec(a);return v&&v[_]};return t=o(t,/^url\((['"])?(.+)\1\)$/,2),t&&o(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=Gt("div","leaflet-default-icon-path",document.body),o=gt(t,"background-image")||gt(t,"backgroundImage");if(document.body.removeChild(t),o=this._stripUrl(o),o)return o;var a=document.querySelector('link[href$="leaflet.css"]');return a?a.href.substring(0,a.href.length-11-1):""}}),Ls=ci.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new Pi(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),xt(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&We(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var o=this._marker,a=o._map,h=this._marker.options.autoPanSpeed,_=this._marker.options.autoPanPadding,v=Un(o._icon),C=a.getPixelBounds(),N=a.getPixelOrigin(),D=Nt(C.min._subtract(N).add(_),C.max._subtract(N).subtract(_));if(!D.contains(v)){var ct=ut((Math.max(D.max.x,v.x)-D.max.x)/(C.max.x-D.max.x)-(Math.min(D.min.x,v.x)-D.min.x)/(C.min.x-D.min.x),(Math.max(D.max.y,v.y)-D.max.y)/(C.max.y-D.max.y)-(Math.min(D.min.y,v.y)-D.min.y)/(C.min.y-D.min.y)).multiplyBy(h);a.panBy(ct,{animate:!1}),this._draggable._newPos._add(ct),this._draggable._startPos._add(ct),ge(o._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=ht(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(I(this._panRequest),this._panRequest=ht(this._adjustPan.bind(this,t)))},_onDrag:function(t){var o=this._marker,a=o._shadow,h=Un(o._icon),_=o._map.layerPointToLatLng(h);a&&ge(a,h),o._latlng=_,t.latlng=_,t.oldLatLng=this._oldLatLng,o.fire("move",t).fire("drag",t)},_onDragEnd:function(t){I(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),uo=ri.extend({options:{icon:new Xi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,o){M(this,o),this._latlng=U(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var o=this._latlng;return this._latlng=U(t),this.update(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,o="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),a=t.icon.createIcon(this._icon),h=!1;a!==this._icon&&(this._icon&&this._removeIcon(),h=!0,t.title&&(a.title=t.title),a.tagName==="IMG"&&(a.alt=t.alt||"")),xt(a,o),t.keyboard&&(a.tabIndex="0",a.setAttribute("role","button")),this._icon=a,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&et(a,"focus",this._panOnFocus,this);var _=t.icon.createShadow(this._shadow),v=!1;_!==this._shadow&&(this._removeShadow(),v=!0),_&&(xt(_,o),_.alt=""),this._shadow=_,t.opacity<1&&this._updateOpacity(),h&&this.getPane().appendChild(this._icon),this._initInteraction(),_&&v&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&wt(this._icon,"focus",this._panOnFocus,this),ee(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ee(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&ge(this._icon,t),this._shadow&&ge(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(o)},_initInteraction:function(){if(this.options.interactive&&(xt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Ls)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Ls(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&hn(this._icon,t),this._shadow&&hn(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var o=this.options.icon.options,a=o.iconSize?ut(o.iconSize):ut(0,0),h=o.iconAnchor?ut(o.iconAnchor):ut(0,0);t.panInside(this._latlng,{paddingTopLeft:h,paddingBottomRight:a.subtract(h)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Rl(t,o){return new uo(t,o)}var Li=ri.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return M(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),co=Li.extend({options:{fill:!0,radius:10},initialize:function(t,o){M(this,o),this._latlng=U(t),this._radius=this.options.radius},setLatLng:function(t){var o=this._latlng;return this._latlng=U(t),this.redraw(),this.fire("move",{oldLatLng:o,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var o=t&&t.radius||this._radius;return Li.prototype.setStyle.call(this,t),this.setRadius(o),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,o=this._radiusY||t,a=this._clickTolerance(),h=[t+a,o+a];this._pxBounds=new kt(this._point.subtract(h),this._point.add(h))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function xl(t,o){return new co(t,o)}var Ro=co.extend({initialize:function(t,o,a){if(typeof o=="number"&&(o=r({},a,{radius:o})),M(this,o),this._latlng=U(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new yt(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:Li.prototype.setStyle,_project:function(){var t=this._latlng.lng,o=this._latlng.lat,a=this._map,h=a.options.crs;if(h.distance===Vt.distance){var _=Math.PI/180,v=this._mRadius/Vt.R/_,C=a.project([o+v,t]),N=a.project([o-v,t]),D=C.add(N).divideBy(2),ct=a.unproject(D).lat,Mt=Math.acos((Math.cos(v*_)-Math.sin(o*_)*Math.sin(ct*_))/(Math.cos(o*_)*Math.cos(ct*_)))/_;(isNaN(Mt)||Mt===0)&&(Mt=v/Math.cos(Math.PI/180*o)),this._point=D.subtract(a.getPixelOrigin()),this._radius=isNaN(Mt)?0:D.x-a.project([ct,t-Mt]).x,this._radiusY=D.y-C.y}else{var qt=h.unproject(h.project(this._latlng).subtract([this._mRadius,0]));this._point=a.latLngToLayerPoint(this._latlng),this._radius=this._point.x-a.latLngToLayerPoint(qt).x}this._updateBounds()}});function jl(t,o,a){return new Ro(t,o,a)}var gi=Li.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,o){M(this,o),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var o=1/0,a=null,h=Vi,_,v,C=0,N=this._parts.length;C<N;C++)for(var D=this._parts[C],ct=1,Mt=D.length;ct<Mt;ct++){_=D[ct-1],v=D[ct];var qt=h(t,_,v,!0);qt<o&&(o=qt,a=h(t,_,v))}return a&&(a.distance=Math.sqrt(o)),a},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ks(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,o){return o=o||this._defaultShape(),t=U(t),o.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new yt,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return $n(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var o=[],a=$n(t),h=0,_=t.length;h<_;h++)a?(o[h]=U(t[h]),this._bounds.extend(o[h])):o[h]=this._convertLatLngs(t[h]);return o},_project:function(){var t=new kt;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),o=new j(t,t);this._rawPxBounds&&(this._pxBounds=new kt([this._rawPxBounds.min.subtract(o),this._rawPxBounds.max.add(o)]))},_projectLatlngs:function(t,o,a){var h=t[0]instanceof it,_=t.length,v,C;if(h){for(C=[],v=0;v<_;v++)C[v]=this._map.latLngToLayerPoint(t[v]),a.extend(C[v]);o.push(C)}else for(v=0;v<_;v++)this._projectLatlngs(t[v],o,a)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var o=this._parts,a,h,_,v,C,N,D;for(a=0,_=0,v=this._rings.length;a<v;a++)for(D=this._rings[a],h=0,C=D.length;h<C-1;h++)N=bs(D[h],D[h+1],t,h,!0),N&&(o[_]=o[_]||[],o[_].push(N[0]),(N[1]!==D[h+1]||h===C-2)&&(o[_].push(N[1]),_++))}},_simplifyPoints:function(){for(var t=this._parts,o=this.options.smoothFactor,a=0,h=t.length;a<h;a++)t[a]=gs(t[a],o)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,o){var a,h,_,v,C,N,D=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(a=0,v=this._parts.length;a<v;a++)for(N=this._parts[a],h=0,C=N.length,_=C-1;h<C;_=h++)if(!(!o&&h===0)&&vs(t,N[_],N[h])<=D)return!0;return!1}});function Hl(t,o){return new gi(t,o)}gi._flat=ws;var Bi=gi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return ps(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var o=gi.prototype._convertLatLngs.call(this,t),a=o.length;return a>=2&&o[0]instanceof it&&o[0].equals(o[a-1])&&o.pop(),o},_setLatLngs:function(t){gi.prototype._setLatLngs.call(this,t),$n(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return $n(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,o=this.options.weight,a=new j(o,o);if(t=new kt(t.min.subtract(a),t.max.add(a)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var h=0,_=this._rings.length,v;h<_;h++)v=ms(this._rings[h],t,!0),v.length&&this._parts.push(v)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var o=!1,a,h,_,v,C,N,D,ct;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(v=0,D=this._parts.length;v<D;v++)for(a=this._parts[v],C=0,ct=a.length,N=ct-1;C<ct;N=C++)h=a[C],_=a[N],h.y>t.y!=_.y>t.y&&t.x<(_.x-h.x)*(t.y-h.y)/(_.y-h.y)+h.x&&(o=!o);return o||gi.prototype._containsPoint.call(this,t,!0)}});function Wl(t,o){return new Bi(t,o)}var vi=pi.extend({initialize:function(t,o){M(this,o),this._layers={},t&&this.addData(t)},addData:function(t){var o=B(t)?t:t.features,a,h,_;if(o){for(a=0,h=o.length;a<h;a++)_=o[a],(_.geometries||_.geometry||_.features||_.coordinates)&&this.addData(_);return this}var v=this.options;if(v.filter&&!v.filter(t))return this;var C=ho(t,v);return C?(C.feature=mo(t),C.defaultOptions=C.options,this.resetStyle(C),v.onEachFeature&&v.onEachFeature(t,C),this.addLayer(C)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=r({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(o){this._setLayerStyle(o,t)},this)},_setLayerStyle:function(t,o){t.setStyle&&(typeof o=="function"&&(o=o(t.feature)),t.setStyle(o))}});function ho(t,o){var a=t.type==="Feature"?t.geometry:t,h=a?a.coordinates:null,_=[],v=o&&o.pointToLayer,C=o&&o.coordsToLatLng||xo,N,D,ct,Mt;if(!h&&!a)return null;switch(a.type){case"Point":return N=C(h),Cs(v,t,N,o);case"MultiPoint":for(ct=0,Mt=h.length;ct<Mt;ct++)N=C(h[ct]),_.push(Cs(v,t,N,o));return new pi(_);case"LineString":case"MultiLineString":return D=fo(h,a.type==="LineString"?0:1,C),new gi(D,o);case"Polygon":case"MultiPolygon":return D=fo(h,a.type==="Polygon"?1:2,C),new Bi(D,o);case"GeometryCollection":for(ct=0,Mt=a.geometries.length;ct<Mt;ct++){var qt=ho({geometry:a.geometries[ct],type:"Feature",properties:t.properties},o);qt&&_.push(qt)}return new pi(_);case"FeatureCollection":for(ct=0,Mt=a.features.length;ct<Mt;ct++){var de=ho(a.features[ct],o);de&&_.push(de)}return new pi(_);default:throw new Error("Invalid GeoJSON object.")}}function Cs(t,o,a,h){return t?t(o,a):new uo(a,h&&h.markersInheritOptions&&h)}function xo(t){return new it(t[1],t[0],t[2])}function fo(t,o,a){for(var h=[],_=0,v=t.length,C;_<v;_++)C=o?fo(t[_],o-1,a):(a||xo)(t[_]),h.push(C);return h}function jo(t,o){return t=U(t),t.alt!==void 0?[w(t.lng,o),w(t.lat,o),w(t.alt,o)]:[w(t.lng,o),w(t.lat,o)]}function _o(t,o,a,h){for(var _=[],v=0,C=t.length;v<C;v++)_.push(o?_o(t[v],$n(t[v])?0:o-1,a,h):jo(t[v],h));return!o&&a&&_.length>0&&_.push(_[0].slice()),_}function Zi(t,o){return t.feature?r({},t.feature,{geometry:o}):mo(o)}function mo(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var Ho={toGeoJSON:function(t){return Zi(this,{type:"Point",coordinates:jo(this.getLatLng(),t)})}};uo.include(Ho),Ro.include(Ho),co.include(Ho),gi.include({toGeoJSON:function(t){var o=!$n(this._latlngs),a=_o(this._latlngs,o?1:0,!1,t);return Zi(this,{type:(o?"Multi":"")+"LineString",coordinates:a})}}),Bi.include({toGeoJSON:function(t){var o=!$n(this._latlngs),a=o&&!$n(this._latlngs[0]),h=_o(this._latlngs,a?2:o?1:0,!0,t);return o||(h=[h]),Zi(this,{type:(a?"Multi":"")+"Polygon",coordinates:h})}}),Ii.include({toMultiPoint:function(t){var o=[];return this.eachLayer(function(a){o.push(a.toGeoJSON(t).geometry.coordinates)}),Zi(this,{type:"MultiPoint",coordinates:o})},toGeoJSON:function(t){var o=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(o==="MultiPoint")return this.toMultiPoint(t);var a=o==="GeometryCollection",h=[];return this.eachLayer(function(_){if(_.toGeoJSON){var v=_.toGeoJSON(t);if(a)h.push(v.geometry);else{var C=mo(v);C.type==="FeatureCollection"?h.push.apply(h,C.features):h.push(C)}}}),a?Zi(this,{geometries:h,type:"GeometryCollection"}):{type:"FeatureCollection",features:h}}});function Ss(t,o){return new vi(t,o)}var Fl=Ss,po=ri.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,o,a){this._url=t,this._bounds=x(o),M(this,a)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(xt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ee(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&Mn(this._image),this},bringToBack:function(){return this._map&&cn(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=x(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",o=this._image=t?this._url:Gt("img");if(xt(o,"leaflet-image-layer"),this._zoomAnimated&&xt(o,"leaflet-zoom-animated"),this.options.className&&xt(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onload=u(this.fire,this,"load"),o.onerror=u(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(o.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=o.src;return}o.src=this._url,o.alt=this.options.alt},_animateZoom:function(t){var o=this._map.getZoomScale(t.zoom),a=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;kn(this._image,a,o)},_reset:function(){var t=this._image,o=new kt(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),a=o.getSize();ge(t,o.min),t.style.width=a.x+"px",t.style.height=a.y+"px"},_updateOpacity:function(){hn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Gl=function(t,o,a){return new po(t,o,a)},Ms=po.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",o=this._image=t?this._url:Gt("video");if(xt(o,"leaflet-image-layer"),this._zoomAnimated&&xt(o,"leaflet-zoom-animated"),this.options.className&&xt(o,this.options.className),o.onselectstart=g,o.onmousemove=g,o.onloadeddata=u(this.fire,this,"load"),t){for(var a=o.getElementsByTagName("source"),h=[],_=0;_<a.length;_++)h.push(a[_].src);this._url=a.length>0?h:[o.src];return}B(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(o.style,"objectFit")&&(o.style.objectFit="fill"),o.autoplay=!!this.options.autoplay,o.loop=!!this.options.loop,o.muted=!!this.options.muted,o.playsInline=!!this.options.playsInline;for(var v=0;v<this._url.length;v++){var C=Gt("source");C.src=this._url[v],o.appendChild(C)}}});function Ul(t,o,a){return new Ms(t,o,a)}var Ts=po.extend({_initImage:function(){var t=this._image=this._url;xt(t,"leaflet-image-layer"),this._zoomAnimated&&xt(t,"leaflet-zoom-animated"),this.options.className&&xt(t,this.options.className),t.onselectstart=g,t.onmousemove=g}});function ql(t,o,a){return new Ts(t,o,a)}var hi=ri.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,o){t&&(t instanceof it||B(t))?(this._latlng=U(t),M(this,o)):(M(this,t),this._source=o),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&hn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&hn(this._container,1),this.bringToFront(),this.options.interactive&&(xt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(hn(this._container,0),this._removeTimeout=setTimeout(u(ee,void 0,this._container),200)):ee(this._container),this.options.interactive&&(We(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=U(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Mn(this._container),this},bringToBack:function(){return this._map&&cn(this._container),this},_prepareOpen:function(t){var o=this._source;if(!o._map)return!1;if(o instanceof pi){o=null;var a=this._source._layers;for(var h in a)if(a[h]._map){o=a[h];break}if(!o)return!1;this._source=o}if(!t)if(o.getCenter)t=o.getCenter();else if(o.getLatLng)t=o.getLatLng();else if(o.getBounds)t=o.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,o=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof o=="string")t.innerHTML=o;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(o)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),o=ut(this.options.offset),a=this._getAnchor();this._zoomAnimated?ge(this._container,t.add(a)):o=o.add(t).add(a);var h=this._containerBottom=-o.y,_=this._containerLeft=-Math.round(this._containerWidth/2)+o.x;this._container.style.bottom=h+"px",this._container.style.left=_+"px"}},_getAnchor:function(){return[0,0]}});we.include({_initOverlay:function(t,o,a,h){var _=o;return _ instanceof t||(_=new t(h).setContent(o)),a&&_.setLatLng(a),_}}),ri.include({_initOverlay:function(t,o,a,h){var _=a;return _ instanceof t?(M(_,h),_._source=this):(_=o&&!h?o:new t(h,this),_.setContent(a)),_}});var go=hi.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,hi.prototype.openOn.call(this,t)},onAdd:function(t){hi.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Li||this._source.on("preclick",Rn))},onRemove:function(t){hi.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Li||this._source.off("preclick",Rn))},getEvents:function(){var t=hi.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",o=this._container=Gt("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),a=this._wrapper=Gt("div",t+"-content-wrapper",o);if(this._contentNode=Gt("div",t+"-content",a),zn(o),ui(this._contentNode),et(o,"contextmenu",Rn),this._tipContainer=Gt("div",t+"-tip-container",o),this._tip=Gt("div",t+"-tip",this._tipContainer),this.options.closeButton){var h=this._closeButton=Gt("a",t+"-close-button",o);h.setAttribute("role","button"),h.setAttribute("aria-label","Close popup"),h.href="#close",h.innerHTML='<span aria-hidden="true">&#215;</span>',et(h,"click",function(_){St(_),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,o=t.style;o.width="",o.whiteSpace="nowrap";var a=t.offsetWidth;a=Math.min(a,this.options.maxWidth),a=Math.max(a,this.options.minWidth),o.width=a+1+"px",o.whiteSpace="",o.height="";var h=t.offsetHeight,_=this.options.maxHeight,v="leaflet-popup-scrolled";_&&h>_?(o.height=_+"px",xt(t,v)):We(t,v),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),a=this._getAnchor();ge(this._container,o.add(a))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,o=parseInt(gt(this._container,"marginBottom"),10)||0,a=this._container.offsetHeight+o,h=this._containerWidth,_=new j(this._containerLeft,-a-this._containerBottom);_._add(Un(this._container));var v=t.layerPointToContainerPoint(_),C=ut(this.options.autoPanPadding),N=ut(this.options.autoPanPaddingTopLeft||C),D=ut(this.options.autoPanPaddingBottomRight||C),ct=t.getSize(),Mt=0,qt=0;v.x+h+D.x>ct.x&&(Mt=v.x+h-ct.x+D.x),v.x-Mt-N.x<0&&(Mt=v.x-N.x),v.y+a+D.y>ct.y&&(qt=v.y+a-ct.y+D.y),v.y-qt-N.y<0&&(qt=v.y-N.y),(Mt||qt)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([Mt,qt]))}},_getAnchor:function(){return ut(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Vl=function(t,o){return new go(t,o)};we.mergeOptions({closePopupOnClick:!0}),we.include({openPopup:function(t,o,a){return this._initOverlay(go,t,o,a).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),ri.include({bindPopup:function(t,o){return this._popup=this._initOverlay(go,this._popup,t,o),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof pi||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){ie(t);var o=t.layer||t.target;if(this._popup._source===o&&!(o instanceof Li)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=o,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var vo=hi.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){hi.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){hi.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=hi.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",o=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Gt("div",o),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+f(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var o,a,h=this._map,_=this._container,v=h.latLngToContainerPoint(h.getCenter()),C=h.layerPointToContainerPoint(t),N=this.options.direction,D=_.offsetWidth,ct=_.offsetHeight,Mt=ut(this.options.offset),qt=this._getAnchor();N==="top"?(o=D/2,a=ct):N==="bottom"?(o=D/2,a=0):N==="center"?(o=D/2,a=ct/2):N==="right"?(o=0,a=ct/2):N==="left"?(o=D,a=ct/2):C.x<v.x?(N="right",o=0,a=ct/2):(N="left",o=D+(Mt.x+qt.x)*2,a=ct/2),t=t.subtract(ut(o,a,!0)).add(Mt).add(qt),We(_,"leaflet-tooltip-right"),We(_,"leaflet-tooltip-left"),We(_,"leaflet-tooltip-top"),We(_,"leaflet-tooltip-bottom"),xt(_,"leaflet-tooltip-"+N),ge(_,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&hn(this._container,t)},_animateZoom:function(t){var o=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(o)},_getAnchor:function(){return ut(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Xl=function(t,o){return new vo(t,o)};we.include({openTooltip:function(t,o,a){return this._initOverlay(vo,t,o,a).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),ri.include({bindTooltip:function(t,o){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(vo,this._tooltip,t,o),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var o=t?"off":"on",a={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?a.add=this._openTooltip:(a.mouseover=this._openTooltip,a.mouseout=this.closeTooltip,a.click=this._openTooltip,this._map?this._addFocusListeners():a.add=this._addFocusListeners),this._tooltip.options.sticky&&(a.mousemove=this._moveTooltip),this[o](a),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof pi||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var o=typeof t.getElement=="function"&&t.getElement();o&&(et(o,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),et(o,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var o=typeof t.getElement=="function"&&t.getElement();o&&o.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var o=this;this._map.once("moveend",function(){o._openOnceFlag=!1,o._openTooltip(t)});return}this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0)}},_moveTooltip:function(t){var o=t.latlng,a,h;this._tooltip.options.sticky&&t.originalEvent&&(a=this._map.mouseEventToContainerPoint(t.originalEvent),h=this._map.containerPointToLayerPoint(a),o=this._map.layerPointToLatLng(h)),this._tooltip.setLatLng(o)}});var Es=Oi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var o=t&&t.tagName==="DIV"?t:document.createElement("div"),a=this.options;if(a.html instanceof Element?(un(o),o.appendChild(a.html)):o.innerHTML=a.html!==!1?a.html:"",a.bgPos){var h=ut(a.bgPos);o.style.backgroundPosition=-h.x+"px "+-h.y+"px"}return this._setIconStyles(o,"icon"),o},createShadow:function(){return null}});function Yl(t){return new Es(t)}Oi.Default=Xi;var Yi=ri.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Pt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){M(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),ee(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Mn(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(cn(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof j?t:new j(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var o=this.getPane().children,a=-t(-1/0,1/0),h=0,_=o.length,v;h<_;h++)v=o[h].style.zIndex,o[h]!==this._container&&v&&(a=t(a,+v));isFinite(a)&&(this.options.zIndex=a+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Pt.ielt9){hn(this._container,this.options.opacity);var t=+new Date,o=!1,a=!1;for(var h in this._tiles){var _=this._tiles[h];if(!(!_.current||!_.loaded)){var v=Math.min(1,(t-_.loaded)/200);hn(_.el,v),v<1?o=!0:(_.active?a=!0:this._onOpaqueTile(_),_.active=!0)}}a&&!this._noPrune&&this._pruneTiles(),o&&(I(this._fadeFrame),this._fadeFrame=ht(this._updateOpacity,this))}},_onOpaqueTile:g,_initContainer:function(){this._container||(this._container=Gt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,o=this.options.maxZoom;if(t!==void 0){for(var a in this._levels)a=Number(a),this._levels[a].el.children.length||a===t?(this._levels[a].el.style.zIndex=o-Math.abs(t-a),this._onUpdateLevel(a)):(ee(this._levels[a].el),this._removeTilesAtZoom(a),this._onRemoveLevel(a),delete this._levels[a]);var h=this._levels[t],_=this._map;return h||(h=this._levels[t]={},h.el=Gt("div","leaflet-tile-container leaflet-zoom-animated",this._container),h.el.style.zIndex=o,h.origin=_.project(_.unproject(_.getPixelOrigin()),t).round(),h.zoom=t,this._setZoomTransform(h,_.getCenter(),_.getZoom()),g(h.el.offsetWidth),this._onCreateLevel(h)),this._level=h,h}},_onUpdateLevel:g,_onRemoveLevel:g,_onCreateLevel:g,_pruneTiles:function(){if(this._map){var t,o,a=this._map.getZoom();if(a>this.options.maxZoom||a<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)o=this._tiles[t],o.retain=o.current;for(t in this._tiles)if(o=this._tiles[t],o.current&&!o.active){var h=o.coords;this._retainParent(h.x,h.y,h.z,h.z-5)||this._retainChildren(h.x,h.y,h.z,h.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var o in this._tiles)this._tiles[o].coords.z===t&&this._removeTile(o)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)ee(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,o,a,h){var _=Math.floor(t/2),v=Math.floor(o/2),C=a-1,N=new j(+_,+v);N.z=+C;var D=this._tileCoordsToKey(N),ct=this._tiles[D];return ct&&ct.active?(ct.retain=!0,!0):(ct&&ct.loaded&&(ct.retain=!0),C>h?this._retainParent(_,v,C,h):!1)},_retainChildren:function(t,o,a,h){for(var _=2*t;_<2*t+2;_++)for(var v=2*o;v<2*o+2;v++){var C=new j(_,v);C.z=a+1;var N=this._tileCoordsToKey(C),D=this._tiles[N];if(D&&D.active){D.retain=!0;continue}else D&&D.loaded&&(D.retain=!0);a+1<h&&this._retainChildren(_,v,a+1,h)}},_resetView:function(t){var o=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),o,o)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var o=this.options;return o.minNativeZoom!==void 0&&t<o.minNativeZoom?o.minNativeZoom:o.maxNativeZoom!==void 0&&o.maxNativeZoom<t?o.maxNativeZoom:t},_setView:function(t,o,a,h){var _=Math.round(o);this.options.maxZoom!==void 0&&_>this.options.maxZoom||this.options.minZoom!==void 0&&_<this.options.minZoom?_=void 0:_=this._clampZoom(_);var v=this.options.updateWhenZooming&&_!==this._tileZoom;(!h||v)&&(this._tileZoom=_,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),_!==void 0&&this._update(t),a||this._pruneTiles(),this._noPrune=!!a),this._setZoomTransforms(t,o)},_setZoomTransforms:function(t,o){for(var a in this._levels)this._setZoomTransform(this._levels[a],t,o)},_setZoomTransform:function(t,o,a){var h=this._map.getZoomScale(a,t.zoom),_=t.origin.multiplyBy(h).subtract(this._map._getNewPixelOrigin(o,a)).round();Pt.any3d?kn(t.el,_,h):ge(t.el,_)},_resetGrid:function(){var t=this._map,o=t.options.crs,a=this._tileSize=this.getTileSize(),h=this._tileZoom,_=this._map.getPixelWorldBounds(this._tileZoom);_&&(this._globalTileRange=this._pxBoundsToTileRange(_)),this._wrapX=o.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,o.wrapLng[0]],h).x/a.x),Math.ceil(t.project([0,o.wrapLng[1]],h).x/a.y)],this._wrapY=o.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([o.wrapLat[0],0],h).y/a.x),Math.ceil(t.project([o.wrapLat[1],0],h).y/a.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var o=this._map,a=o._animatingZoom?Math.max(o._animateToZoom,o.getZoom()):o.getZoom(),h=o.getZoomScale(a,this._tileZoom),_=o.project(t,this._tileZoom).floor(),v=o.getSize().divideBy(h*2);return new kt(_.subtract(v),_.add(v))},_update:function(t){var o=this._map;if(o){var a=this._clampZoom(o.getZoom());if(t===void 0&&(t=o.getCenter()),this._tileZoom!==void 0){var h=this._getTiledPixelBounds(t),_=this._pxBoundsToTileRange(h),v=_.getCenter(),C=[],N=this.options.keepBuffer,D=new kt(_.getBottomLeft().subtract([N,-N]),_.getTopRight().add([N,-N]));if(!(isFinite(_.min.x)&&isFinite(_.min.y)&&isFinite(_.max.x)&&isFinite(_.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var ct in this._tiles){var Mt=this._tiles[ct].coords;(Mt.z!==this._tileZoom||!D.contains(new j(Mt.x,Mt.y)))&&(this._tiles[ct].current=!1)}if(Math.abs(a-this._tileZoom)>1){this._setView(t,a);return}for(var qt=_.min.y;qt<=_.max.y;qt++)for(var de=_.min.x;de<=_.max.x;de++){var jn=new j(de,qt);if(jn.z=this._tileZoom,!!this._isValidTile(jn)){var Nn=this._tiles[this._tileCoordsToKey(jn)];Nn?Nn.current=!0:C.push(jn)}}if(C.sort(function(qn,Ri){return qn.distanceTo(v)-Ri.distanceTo(v)}),C.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ti=document.createDocumentFragment();for(de=0;de<C.length;de++)this._addTile(C[de],ti);this._level.el.appendChild(ti)}}}},_isValidTile:function(t){var o=this._map.options.crs;if(!o.infinite){var a=this._globalTileRange;if(!o.wrapLng&&(t.x<a.min.x||t.x>a.max.x)||!o.wrapLat&&(t.y<a.min.y||t.y>a.max.y))return!1}if(!this.options.bounds)return!0;var h=this._tileCoordsToBounds(t);return x(this.options.bounds).overlaps(h)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var o=this._map,a=this.getTileSize(),h=t.scaleBy(a),_=h.add(a),v=o.unproject(h,t.z),C=o.unproject(_,t.z);return[v,C]},_tileCoordsToBounds:function(t){var o=this._tileCoordsToNwSe(t),a=new yt(o[0],o[1]);return this.options.noWrap||(a=this._map.wrapLatLngBounds(a)),a},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var o=t.split(":"),a=new j(+o[0],+o[1]);return a.z=+o[2],a},_removeTile:function(t){var o=this._tiles[t];o&&(ee(o.el),delete this._tiles[t],this.fire("tileunload",{tile:o.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){xt(t,"leaflet-tile");var o=this.getTileSize();t.style.width=o.x+"px",t.style.height=o.y+"px",t.onselectstart=g,t.onmousemove=g,Pt.ielt9&&this.options.opacity<1&&hn(t,this.options.opacity)},_addTile:function(t,o){var a=this._getTilePos(t),h=this._tileCoordsToKey(t),_=this.createTile(this._wrapCoords(t),u(this._tileReady,this,t));this._initTile(_),this.createTile.length<2&&ht(u(this._tileReady,this,t,null,_)),ge(_,a),this._tiles[h]={el:_,coords:t,current:!0},o.appendChild(_),this.fire("tileloadstart",{tile:_,coords:t})},_tileReady:function(t,o,a){o&&this.fire("tileerror",{error:o,tile:a,coords:t});var h=this._tileCoordsToKey(t);a=this._tiles[h],a&&(a.loaded=+new Date,this._map._fadeAnimated?(hn(a.el,0),I(this._fadeFrame),this._fadeFrame=ht(this._updateOpacity,this)):(a.active=!0,this._pruneTiles()),o||(xt(a.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:a.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Pt.ielt9||!this._map._fadeAnimated?ht(this._pruneTiles,this):setTimeout(u(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var o=new j(this._wrapX?p(t.x,this._wrapX):t.x,this._wrapY?p(t.y,this._wrapY):t.y);return o.z=t.z,o},_pxBoundsToTileRange:function(t){var o=this.getTileSize();return new kt(t.min.unscaleBy(o).floor(),t.max.unscaleBy(o).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Kl(t){return new Yi(t)}var Di=Yi.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,o){this._url=t,o=M(this,o),o.detectRetina&&Pt.retina&&o.maxZoom>0?(o.tileSize=Math.floor(o.tileSize/2),o.zoomReverse?(o.zoomOffset--,o.minZoom=Math.min(o.maxZoom,o.minZoom+1)):(o.zoomOffset++,o.maxZoom=Math.max(o.minZoom,o.maxZoom-1)),o.minZoom=Math.max(0,o.minZoom)):o.zoomReverse?o.minZoom=Math.min(o.maxZoom,o.minZoom):o.maxZoom=Math.max(o.minZoom,o.maxZoom),typeof o.subdomains=="string"&&(o.subdomains=o.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,o){return this._url===t&&o===void 0&&(o=!0),this._url=t,o||this.redraw(),this},createTile:function(t,o){var a=document.createElement("img");return et(a,"load",u(this._tileOnLoad,this,o,a)),et(a,"error",u(this._tileOnError,this,o,a)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(a.referrerPolicy=this.options.referrerPolicy),a.alt="",a.src=this.getTileUrl(t),a},getTileUrl:function(t){var o={r:Pt.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var a=this._globalTileRange.max.y-t.y;this.options.tms&&(o.y=a),o["-y"]=a}return E(this._url,r(o,this.options))},_tileOnLoad:function(t,o){Pt.ielt9?setTimeout(u(t,this,null,o),0):t(null,o)},_tileOnError:function(t,o,a){var h=this.options.errorTileUrl;h&&o.getAttribute("src")!==h&&(o.src=h),t(a,o)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,o=this.options.maxZoom,a=this.options.zoomReverse,h=this.options.zoomOffset;return a&&(t=o-t),t+h},_getSubdomain:function(t){var o=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[o]},_abortLoading:function(){var t,o;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(o=this._tiles[t].el,o.onload=g,o.onerror=g,!o.complete)){o.src=F;var a=this._tiles[t].coords;ee(o),delete this._tiles[t],this.fire("tileabort",{tile:o,coords:a})}},_removeTile:function(t){var o=this._tiles[t];if(o)return o.el.setAttribute("src",F),Yi.prototype._removeTile.call(this,t)},_tileReady:function(t,o,a){if(!(!this._map||a&&a.getAttribute("src")===F))return Yi.prototype._tileReady.call(this,t,o,a)}});function As(t,o){return new Di(t,o)}var zs=Di.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,o){this._url=t;var a=r({},this.defaultWmsParams);for(var h in o)h in this.options||(a[h]=o[h]);o=M(this,o);var _=o.detectRetina&&Pt.retina?2:1,v=this.getTileSize();a.width=v.x*_,a.height=v.y*_,this.wmsParams=a},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var o=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[o]=this._crs.code,Di.prototype.onAdd.call(this,t)},getTileUrl:function(t){var o=this._tileCoordsToNwSe(t),a=this._crs,h=Nt(a.project(o[0]),a.project(o[1])),_=h.min,v=h.max,C=(this._wmsVersion>=1.3&&this._crs===Ps?[_.y,_.x,v.y,v.x]:[_.x,_.y,v.x,v.y]).join(","),N=Di.prototype.getTileUrl.call(this,t);return N+A(this.wmsParams,N,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+C},setParams:function(t,o){return r(this.wmsParams,t),o||this.redraw(),this}});function Jl(t,o){return new zs(t,o)}Di.WMS=zs,As.wms=Jl;var yi=ri.extend({options:{padding:.1},initialize:function(t){M(this,t),f(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),xt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,o){var a=this._map.getZoomScale(o,this._zoom),h=this._map.getSize().multiplyBy(.5+this.options.padding),_=this._map.project(this._center,o),v=h.multiplyBy(-a).add(_).subtract(this._map._getNewPixelOrigin(t,o));Pt.any3d?kn(this._container,v,a):ge(this._container,v)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,o=this._map.getSize(),a=this._map.containerPointToLayerPoint(o.multiplyBy(-t)).round();this._bounds=new kt(a,a.add(o.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ns=yi.extend({options:{tolerance:0},getEvents:function(){var t=yi.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){yi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");et(t,"mousemove",this._onMouseMove,this),et(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),et(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){I(this._redrawRequest),delete this._ctx,ee(this._container),wt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var o in this._layers)t=this._layers[o],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){yi.prototype._update.call(this);var t=this._bounds,o=this._container,a=t.getSize(),h=Pt.retina?2:1;ge(o,t.min),o.width=h*a.x,o.height=h*a.y,o.style.width=a.x+"px",o.style.height=a.y+"px",Pt.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){yi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[f(t)]=t;var o=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=o),this._drawLast=o,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var o=t._order,a=o.next,h=o.prev;a?a.prev=h:this._drawLast=h,h?h.next=a:this._drawFirst=a,delete t._order,delete this._layers[f(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var o=t.options.dashArray.split(/[, ]+/),a=[],h,_;for(_=0;_<o.length;_++){if(h=Number(o[_]),isNaN(h))return;a.push(h)}t.options._dashArray=a}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||ht(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var o=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new kt,this._redrawBounds.extend(t._pxBounds.min.subtract([o,o])),this._redrawBounds.extend(t._pxBounds.max.add([o,o]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var o=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,o.x,o.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,o=this._redrawBounds;if(this._ctx.save(),o){var a=o.getSize();this._ctx.beginPath(),this._ctx.rect(o.min.x,o.min.y,a.x,a.y),this._ctx.clip()}this._drawing=!0;for(var h=this._drawFirst;h;h=h.next)t=h.layer,(!o||t._pxBounds&&t._pxBounds.intersects(o))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,o){if(this._drawing){var a,h,_,v,C=t._parts,N=C.length,D=this._ctx;if(N){for(D.beginPath(),a=0;a<N;a++){for(h=0,_=C[a].length;h<_;h++)v=C[a][h],D[h?"lineTo":"moveTo"](v.x,v.y);o&&D.closePath()}this._fillStroke(D,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var o=t._point,a=this._ctx,h=Math.max(Math.round(t._radius),1),_=(Math.max(Math.round(t._radiusY),1)||h)/h;_!==1&&(a.save(),a.scale(1,_)),a.beginPath(),a.arc(o.x,o.y/_,h,0,Math.PI*2,!1),_!==1&&a.restore(),this._fillStroke(a,t)}},_fillStroke:function(t,o){var a=o.options;a.fill&&(t.globalAlpha=a.fillOpacity,t.fillStyle=a.fillColor||a.color,t.fill(a.fillRule||"evenodd")),a.stroke&&a.weight!==0&&(t.setLineDash&&t.setLineDash(o.options&&o.options._dashArray||[]),t.globalAlpha=a.opacity,t.lineWidth=a.weight,t.strokeStyle=a.color,t.lineCap=a.lineCap,t.lineJoin=a.lineJoin,t.stroke())},_onClick:function(t){for(var o=this._map.mouseEventToLayerPoint(t),a,h,_=this._drawFirst;_;_=_.next)a=_.layer,a.options.interactive&&a._containsPoint(o)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(a))&&(h=a);this._fireEvent(h?[h]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var o=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,o)}},_handleMouseOut:function(t){var o=this._hoveredLayer;o&&(We(this._container,"leaflet-interactive"),this._fireEvent([o],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,o){if(!this._mouseHoverThrottled){for(var a,h,_=this._drawFirst;_;_=_.next)a=_.layer,a.options.interactive&&a._containsPoint(o)&&(h=a);h!==this._hoveredLayer&&(this._handleMouseOut(t),h&&(xt(this._container,"leaflet-interactive"),this._fireEvent([h],t,"mouseover"),this._hoveredLayer=h)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(u(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,o,a){this._map._fireDOMEvent(o,a||o.type,t)},_bringToFront:function(t){var o=t._order;if(o){var a=o.next,h=o.prev;if(a)a.prev=h;else return;h?h.next=a:a&&(this._drawFirst=a),o.prev=this._drawLast,this._drawLast.next=o,o.next=null,this._drawLast=o,this._requestRedraw(t)}},_bringToBack:function(t){var o=t._order;if(o){var a=o.next,h=o.prev;if(h)h.next=a;else return;a?a.prev=h:h&&(this._drawLast=h),o.prev=null,o.next=this._drawFirst,this._drawFirst.prev=o,this._drawFirst=o,this._requestRedraw(t)}}});function Is(t){return Pt.canvas?new Ns(t):null}var Ki=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Ql={_initContainer:function(){this._container=Gt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(yi.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var o=t._container=Ki("shape");xt(o,"leaflet-vml-shape "+(this.options.className||"")),o.coordsize="1 1",t._path=Ki("path"),o.appendChild(t._path),this._updateStyle(t),this._layers[f(t)]=t},_addPath:function(t){var o=t._container;this._container.appendChild(o),t.options.interactive&&t.addInteractiveTarget(o)},_removePath:function(t){var o=t._container;ee(o),t.removeInteractiveTarget(o),delete this._layers[f(t)]},_updateStyle:function(t){var o=t._stroke,a=t._fill,h=t.options,_=t._container;_.stroked=!!h.stroke,_.filled=!!h.fill,h.stroke?(o||(o=t._stroke=Ki("stroke")),_.appendChild(o),o.weight=h.weight+"px",o.color=h.color,o.opacity=h.opacity,h.dashArray?o.dashStyle=B(h.dashArray)?h.dashArray.join(" "):h.dashArray.replace(/( *, *)/g," "):o.dashStyle="",o.endcap=h.lineCap.replace("butt","flat"),o.joinstyle=h.lineJoin):o&&(_.removeChild(o),t._stroke=null),h.fill?(a||(a=t._fill=Ki("fill")),_.appendChild(a),a.color=h.fillColor||h.color,a.opacity=h.fillOpacity):a&&(_.removeChild(a),t._fill=null)},_updateCircle:function(t){var o=t._point.round(),a=Math.round(t._radius),h=Math.round(t._radiusY||a);this._setPath(t,t._empty()?"M0 0":"AL "+o.x+","+o.y+" "+a+","+h+" 0,"+65535*360)},_setPath:function(t,o){t._path.v=o},_bringToFront:function(t){Mn(t._container)},_bringToBack:function(t){cn(t._container)}},yo=Pt.vml?Ki:ne,Ji=yi.extend({_initContainer:function(){this._container=yo("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=yo("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ee(this._container),wt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){yi.prototype._update.call(this);var t=this._bounds,o=t.getSize(),a=this._container;(!this._svgSize||!this._svgSize.equals(o))&&(this._svgSize=o,a.setAttribute("width",o.x),a.setAttribute("height",o.y)),ge(a,t.min),a.setAttribute("viewBox",[t.min.x,t.min.y,o.x,o.y].join(" ")),this.fire("update")}},_initPath:function(t){var o=t._path=yo("path");t.options.className&&xt(o,t.options.className),t.options.interactive&&xt(o,"leaflet-interactive"),this._updateStyle(t),this._layers[f(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){ee(t._path),t.removeInteractiveTarget(t._path),delete this._layers[f(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var o=t._path,a=t.options;o&&(a.stroke?(o.setAttribute("stroke",a.color),o.setAttribute("stroke-opacity",a.opacity),o.setAttribute("stroke-width",a.weight),o.setAttribute("stroke-linecap",a.lineCap),o.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?o.setAttribute("stroke-dasharray",a.dashArray):o.removeAttribute("stroke-dasharray"),a.dashOffset?o.setAttribute("stroke-dashoffset",a.dashOffset):o.removeAttribute("stroke-dashoffset")):o.setAttribute("stroke","none"),a.fill?(o.setAttribute("fill",a.fillColor||a.color),o.setAttribute("fill-opacity",a.fillOpacity),o.setAttribute("fill-rule",a.fillRule||"evenodd")):o.setAttribute("fill","none"))},_updatePoly:function(t,o){this._setPath(t,Xt(t._parts,o))},_updateCircle:function(t){var o=t._point,a=Math.max(Math.round(t._radius),1),h=Math.max(Math.round(t._radiusY),1)||a,_="a"+a+","+h+" 0 1,0 ",v=t._empty()?"M0 0":"M"+(o.x-a)+","+o.y+_+a*2+",0 "+_+-a*2+",0 ";this._setPath(t,v)},_setPath:function(t,o){t._path.setAttribute("d",o)},_bringToFront:function(t){Mn(t._path)},_bringToBack:function(t){cn(t._path)}});Pt.vml&&Ji.include(Ql);function Os(t){return Pt.svg||Pt.vml?new Ji(t):null}we.include({getRenderer:function(t){var o=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return o||(o=this._renderer=this._createRenderer()),this.hasLayer(o)||this.addLayer(o),o},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var o=this._paneRenderers[t];return o===void 0&&(o=this._createRenderer({pane:t}),this._paneRenderers[t]=o),o},_createRenderer:function(t){return this.options.preferCanvas&&Is(t)||Os(t)}});var Bs=Bi.extend({initialize:function(t,o){Bi.prototype.initialize.call(this,this._boundsToLatLngs(t),o)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=x(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function $l(t,o){return new Bs(t,o)}Ji.create=yo,Ji.pointsToPath=Xt,vi.geometryToLayer=ho,vi.coordsToLatLng=xo,vi.coordsToLatLngs=fo,vi.latLngToCoords=jo,vi.latLngsToCoords=_o,vi.getFeature=Zi,vi.asFeature=mo,we.mergeOptions({boxZoom:!0});var Zs=ci.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){et(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){wt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ee(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),In(),ai(),this._startPoint=this._map.mouseEventToContainerPoint(t),et(document,{contextmenu:ie,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=Gt("div","leaflet-zoom-box",this._container),xt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var o=new kt(this._point,this._startPoint),a=o.getSize();ge(this._box,o.min),this._box.style.width=a.x+"px",this._box.style.height=a.y+"px"},_finish:function(){this._moved&&(ee(this._box),We(this._container,"leaflet-crosshair")),Zn(),sn(),wt(document,{contextmenu:ie,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(u(this._resetState,this),0);var o=new yt(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(o).fire("boxzoomend",{boxZoomBounds:o})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});we.addInitHook("addHandler","boxZoom",Zs),we.mergeOptions({doubleClickZoom:!0});var Ds=ci.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var o=this._map,a=o.getZoom(),h=o.options.zoomDelta,_=t.originalEvent.shiftKey?a-h:a+h;o.options.doubleClickZoom==="center"?o.setZoom(_):o.setZoomAround(t.containerPoint,_)}});we.addInitHook("addHandler","doubleClickZoom",Ds),we.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Rs=ci.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new Pi(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}xt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){We(this._map._container,"leaflet-grab"),We(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var o=x(this._map.options.maxBounds);this._offsetLimit=Nt(this._map.latLngToContainerPoint(o.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(o.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var o=this._lastTime=+new Date,a=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(a),this._times.push(o),this._prunePositions(o)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),o=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=o.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,o){return t-(t-o)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),o=this._offsetLimit;t.x<o.min.x&&(t.x=this._viscousLimit(t.x,o.min.x)),t.y<o.min.y&&(t.y=this._viscousLimit(t.y,o.min.y)),t.x>o.max.x&&(t.x=this._viscousLimit(t.x,o.max.x)),t.y>o.max.y&&(t.y=this._viscousLimit(t.y,o.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,o=Math.round(t/2),a=this._initialWorldOffset,h=this._draggable._newPos.x,_=(h-o+a)%t+o-a,v=(h+o+a)%t-o-a,C=Math.abs(_+a)<Math.abs(v+a)?_:v;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=C},_onDragEnd:function(t){var o=this._map,a=o.options,h=!a.inertia||t.noInertia||this._times.length<2;if(o.fire("dragend",t),h)o.fire("moveend");else{this._prunePositions(+new Date);var _=this._lastPos.subtract(this._positions[0]),v=(this._lastTime-this._times[0])/1e3,C=a.easeLinearity,N=_.multiplyBy(C/v),D=N.distanceTo([0,0]),ct=Math.min(a.inertiaMaxSpeed,D),Mt=N.multiplyBy(ct/D),qt=ct/(a.inertiaDeceleration*C),de=Mt.multiplyBy(-qt/2).round();!de.x&&!de.y?o.fire("moveend"):(de=o._limitOffset(de,o.options.maxBounds),ht(function(){o.panBy(de,{duration:qt,easeLinearity:C,noMoveStart:!0,animate:!0})}))}}});we.addInitHook("addHandler","dragging",Rs),we.mergeOptions({keyboard:!0,keyboardPanDelta:80});var xs=ci.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),et(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),wt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,o=document.documentElement,a=t.scrollTop||o.scrollTop,h=t.scrollLeft||o.scrollLeft;this._map._container.focus(),window.scrollTo(h,a)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var o=this._panKeys={},a=this.keyCodes,h,_;for(h=0,_=a.left.length;h<_;h++)o[a.left[h]]=[-1*t,0];for(h=0,_=a.right.length;h<_;h++)o[a.right[h]]=[t,0];for(h=0,_=a.down.length;h<_;h++)o[a.down[h]]=[0,t];for(h=0,_=a.up.length;h<_;h++)o[a.up[h]]=[0,-1*t]},_setZoomDelta:function(t){var o=this._zoomKeys={},a=this.keyCodes,h,_;for(h=0,_=a.zoomIn.length;h<_;h++)o[a.zoomIn[h]]=t;for(h=0,_=a.zoomOut.length;h<_;h++)o[a.zoomOut[h]]=-t},_addHooks:function(){et(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){wt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var o=t.keyCode,a=this._map,h;if(o in this._panKeys){if(!a._panAnim||!a._panAnim._inProgress)if(h=this._panKeys[o],t.shiftKey&&(h=ut(h).multiplyBy(3)),a.options.maxBounds&&(h=a._limitOffset(ut(h),a.options.maxBounds)),a.options.worldCopyJump){var _=a.wrapLatLng(a.unproject(a.project(a.getCenter()).add(h)));a.panTo(_)}else a.panBy(h)}else if(o in this._zoomKeys)a.setZoom(a.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[o]);else if(o===27&&a._popup&&a._popup.options.closeOnEscapeKey)a.closePopup();else return;ie(t)}}});we.addInitHook("addHandler","keyboard",xs),we.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var js=ci.extend({addHooks:function(){et(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){wt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var o=cs(t),a=this._map.options.wheelDebounceTime;this._delta+=o,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var h=Math.max(a-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(u(this._performZoom,this),h),ie(t)},_performZoom:function(){var t=this._map,o=t.getZoom(),a=this._map.options.zoomSnap||0;t._stop();var h=this._delta/(this._map.options.wheelPxPerZoomLevel*4),_=4*Math.log(2/(1+Math.exp(-Math.abs(h))))/Math.LN2,v=a?Math.ceil(_/a)*a:_,C=t._limitZoom(o+(this._delta>0?v:-v))-o;this._delta=0,this._startTime=null,C&&(t.options.scrollWheelZoom==="center"?t.setZoom(o+C):t.setZoomAround(this._lastMousePos,o+C))}});we.addInitHook("addHandler","scrollWheelZoom",js);var tu=600;we.mergeOptions({tapHold:Pt.touchNative&&Pt.safari&&Pt.mobile,tapTolerance:15});var Hs=ci.extend({addHooks:function(){et(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){wt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var o=t.touches[0];this._startPos=this._newPos=new j(o.clientX,o.clientY),this._holdTimeout=setTimeout(u(function(){this._cancel(),this._isTapValid()&&(et(document,"touchend",St),et(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",o))},this),tu),et(document,"touchend touchcancel contextmenu",this._cancel,this),et(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){wt(document,"touchend",St),wt(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),wt(document,"touchend touchcancel contextmenu",this._cancel,this),wt(document,"touchmove",this._onMove,this)},_onMove:function(t){var o=t.touches[0];this._newPos=new j(o.clientX,o.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,o){var a=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:o.screenX,screenY:o.screenY,clientX:o.clientX,clientY:o.clientY});a._simulated=!0,o.target.dispatchEvent(a)}});we.addInitHook("addHandler","tapHold",Hs),we.mergeOptions({touchZoom:Pt.touch,bounceAtZoomLimits:!0});var Ws=ci.extend({addHooks:function(){xt(this._map._container,"leaflet-touch-zoom"),et(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){We(this._map._container,"leaflet-touch-zoom"),wt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var o=this._map;if(!(!t.touches||t.touches.length!==2||o._animatingZoom||this._zooming)){var a=o.mouseEventToContainerPoint(t.touches[0]),h=o.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=o.getSize()._divideBy(2),this._startLatLng=o.containerPointToLatLng(this._centerPoint),o.options.touchZoom!=="center"&&(this._pinchStartLatLng=o.containerPointToLatLng(a.add(h)._divideBy(2))),this._startDist=a.distanceTo(h),this._startZoom=o.getZoom(),this._moved=!1,this._zooming=!0,o._stop(),et(document,"touchmove",this._onTouchMove,this),et(document,"touchend touchcancel",this._onTouchEnd,this),St(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var o=this._map,a=o.mouseEventToContainerPoint(t.touches[0]),h=o.mouseEventToContainerPoint(t.touches[1]),_=a.distanceTo(h)/this._startDist;if(this._zoom=o.getScaleZoom(_,this._startZoom),!o.options.bounceAtZoomLimits&&(this._zoom<o.getMinZoom()&&_<1||this._zoom>o.getMaxZoom()&&_>1)&&(this._zoom=o._limitZoom(this._zoom)),o.options.touchZoom==="center"){if(this._center=this._startLatLng,_===1)return}else{var v=a._add(h)._divideBy(2)._subtract(this._centerPoint);if(_===1&&v.x===0&&v.y===0)return;this._center=o.unproject(o.project(this._pinchStartLatLng,this._zoom).subtract(v),this._zoom)}this._moved||(o._moveStart(!0,!1),this._moved=!0),I(this._animRequest);var C=u(o._move,o,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=ht(C,this,!0),St(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,I(this._animRequest),wt(document,"touchmove",this._onTouchMove,this),wt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});we.addInitHook("addHandler","touchZoom",Ws),we.BoxZoom=Zs,we.DoubleClickZoom=Ds,we.Drag=Rs,we.Keyboard=xs,we.ScrollWheelZoom=js,we.TapHold=Hs,we.TouchZoom=Ws,i.Bounds=kt,i.Browser=Pt,i.CRS=q,i.Canvas=Ns,i.Circle=Ro,i.CircleMarker=co,i.Class=R,i.Control=si,i.DivIcon=Es,i.DivOverlay=hi,i.DomEvent=vl,i.DomUtil=zt,i.Draggable=Pi,i.Evented=J,i.FeatureGroup=pi,i.GeoJSON=vi,i.GridLayer=Yi,i.Handler=ci,i.Icon=Oi,i.ImageOverlay=po,i.LatLng=it,i.LatLngBounds=yt,i.Layer=ri,i.LayerGroup=Ii,i.LineUtil=zl,i.Map=we,i.Marker=uo,i.Mixin=Cl,i.Path=Li,i.Point=j,i.PolyUtil=Sl,i.Polygon=Bi,i.Polyline=gi,i.Popup=go,i.PosAnimation=hs,i.Projection=Nl,i.Rectangle=Bs,i.Renderer=yi,i.SVG=Ji,i.SVGOverlay=Ts,i.TileLayer=Di,i.Tooltip=vo,i.Transformation=Dt,i.Util=rt,i.VideoOverlay=Ms,i.bind=u,i.bounds=Nt,i.canvas=Is,i.circle=jl,i.circleMarker=xl,i.control=qi,i.divIcon=Yl,i.extend=r,i.featureGroup=Zl,i.geoJSON=Ss,i.geoJson=Fl,i.gridLayer=Kl,i.icon=Dl,i.imageOverlay=Gl,i.latLng=U,i.latLngBounds=x,i.layerGroup=Bl,i.map=yl,i.marker=Rl,i.point=ut,i.polygon=Wl,i.polyline=Hl,i.popup=Vl,i.rectangle=$l,i.setOptions=M,i.stamp=f,i.svg=Os,i.svgOverlay=ql,i.tileLayer=As,i.tooltip=Xl,i.transformation=Ht,i.version=s,i.videoOverlay=Ul;var eu=window.L;i.noConflict=function(){return window.L=eu,this},window.L=i})})(ss,ss.exports);var ei=ss.exports;const{Map:Ui}=du;function va(n,e,i){const s=n.slice();return s[139]=e[i],s[141]=i,s}function ya(n,e,i){const s=n.slice();return s[142]=e[i],s[141]=i,s}function ba(n,e,i){const s=n.slice();return s[144]=e[i],s[145]=e,s[146]=i,s}function wa(n,e,i){const s=n.slice();return s[147]=e[i],s}function ka(n,e,i){const s=n.slice();return s[150]=e[i],s}function $o(n){const e=n.slice(),i=e[57](e[150].source);e[153]=i;const s=e[57](e[150].target);return e[154]=s,e}function Pa(n,e,i){const s=n.slice();return s[155]=e[i],s[156]=e,s[157]=i,s}function La(n,e,i){const s=n.slice();return s[154]=e[i],s}function Ca(n,e,i){const s=n.slice();return s[162]=e[i],s}function Sa(n,e,i){const s=n.slice();return s[150]=e[i],s}function Yf(n){let e=[],i=new Ui,s,r=Le(n[2]);const l=u=>u[150].id;for(let u=0;u<r.length;u+=1){let c=Sa(n,r,u),f=l(c);i.set(f,e[u]=Ma(f,c))}return{c(){for(let u=0;u<e.length;u+=1)e[u].c();s=Ze()},m(u,c){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(u,c);Q(u,s,c)},p(u,c){c[0]&4|c[1]&64&&(r=Le(u[2]),e=_i(e,c,l,1,u,r,i,s.parentNode,ao,Ma,s,Sa))},d(u){u&&Y(s);for(let c=0;c<e.length;c+=1)e[c].d(u)}}}function Kf(n){let e;return{c(){e=T("div"),e.textContent="(none)",m(e,"class","muted small txt svelte-a61jnr")},m(i,s){Q(i,e,s)},p:Ut,d(i){i&&Y(e)}}}function Ma(n,e){let i,s=e[150].source+"",r,l,u=e[150].target+"",c,f,d,p,g,w;function k(){return e[74](e[150])}return{key:n,first:null,c(){i=T("span"),r=Be(s),l=Be(""),c=Be(u),f=X(),d=T("button"),d.textContent="",p=X(),m(d,"class","pill-x svelte-a61jnr"),m(d,"aria-label","Remove edge"),m(i,"class","edge-pill svelte-a61jnr"),m(i,"title","Click  to remove"),this.first=i},m(P,M){Q(P,i,M),b(i,r),b(i,l),b(i,c),b(i,f),b(i,d),b(i,p),g||(w=ft(d,"click",k),g=!0)},p(P,M){e=P,M[0]&4&&s!==(s=e[150].source+"")&&_n(r,s),M[0]&4&&u!==(u=e[150].target+"")&&_n(c,u)},d(P){P&&Y(i),g=!1,w()}}}function Ta(n){let e,i,s,r,l,u,c,f,d,p;return{c(){e=T("div"),i=T("span"),s=Be("connecting from "),r=T("code"),l=Be(n[5]),u=Be("  click a nodes  to finish"),c=X(),f=T("button"),f.textContent="cancel",m(i,"class","txt svelte-a61jnr"),m(f,"class","pill-x svelte-a61jnr"),m(e,"class","pending small svelte-a61jnr")},m(g,w){Q(g,e,w),b(e,i),b(i,s),b(i,r),b(r,l),b(i,u),b(e,c),b(e,f),d||(p=ft(f,"click",n[46]),d=!0)},p(g,w){w[0]&32&&_n(l,g[5])},d(g){g&&Y(e),d=!1,p()}}}function Jf(n){let e,i=[],s=new Ui,r=Le(n[35]);const l=u=>u[162].id;for(let u=0;u<r.length;u+=1){let c=Ca(n,r,u),f=l(c);s.set(f,i[u]=Ea(f,c))}return{c(){e=T("div");for(let u=0;u<i.length;u+=1)i[u].c();m(e,"class","tool-list svelte-a61jnr")},m(u,c){Q(u,e,c);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null)},p(u,c){c[1]&134217744|c[2]&7&&(r=Le(u[35]),i=_i(i,c,l,1,u,r,s,e,ao,Ea,null,Ca))},d(u){u&&Y(e);for(let c=0;c<i.length;c+=1)i[c].d()}}}function Qf(n){let e;return{c(){e=T("div"),e.textContent="(no scheduled jobs)",m(e,"class","muted small txt svelte-a61jnr")},m(i,s){Q(i,e,s)},p:Ut,d(i){i&&Y(e)}}}function Ea(n,e){let i,s,r,l,u=Ya(e[162].next_run_time)+"",c,f,d,p,g,w,k,P,M,A,z,E,B,H,F,G;function lt(){return e[75](e[162])}function K(){return e[76](e[162])}function tt(){return e[77](e[162])}function st(){return e[78](e[162])}function ht(){return e[79](e[162])}return{key:n,first:null,c(){i=T("div"),s=T("div"),r=T("div"),l=T("time"),c=Be(u),d=X(),p=T("div"),g=T("button"),g.textContent="Run now",w=X(),k=T("button"),k.textContent="Pause",P=X(),M=T("button"),M.textContent="Resume",A=X(),z=T("button"),z.textContent="Logs",E=X(),B=T("button"),B.textContent="Delete",H=X(),m(l,"datetime",f=e[162].next_run_time),m(r,"class","schedule-date svelte-a61jnr"),m(s,"class","schedule-head svelte-a61jnr"),m(g,"class","pill-x svelte-a61jnr"),m(g,"title","Run now"),m(k,"class","pill-x svelte-a61jnr"),m(k,"title","Pause"),m(M,"class","pill-x svelte-a61jnr"),m(M,"title","Resume"),m(z,"class","pill-x svelte-a61jnr"),m(z,"title","Logs"),m(B,"class","pill-x svelte-a61jnr"),m(B,"title","Delete"),m(p,"class","schedule-actions svelte-a61jnr"),m(i,"class","tool schedule-card svelte-a61jnr"),this.first=i},m(I,rt){Q(I,i,rt),b(i,s),b(s,r),b(r,l),b(l,c),b(i,d),b(i,p),b(p,g),b(p,w),b(p,k),b(p,P),b(p,M),b(p,A),b(p,z),b(p,E),b(p,B),b(i,H),F||(G=[ft(g,"click",lt),ft(k,"click",K),ft(M,"click",tt),ft(z,"click",st),ft(B,"click",ht)],F=!0)},p(I,rt){e=I,rt[1]&16&&u!==(u=Ya(e[162].next_run_time)+"")&&_n(c,u),rt[1]&16&&f!==(f=e[162].next_run_time)&&m(l,"datetime",f)},d(I){I&&Y(i),F=!1,fn(G)}}}function Aa(n){let e,i=n[154].name+"",s,r;return{c(){e=T("option"),s=Be(i),e.__value=r=n[154].name,Oe(e,e.__value)},m(l,u){Q(l,e,u),b(e,s)},p(l,u){u[0]&64&&i!==(i=l[154].name+"")&&_n(s,i),u[0]&64&&r!==(r=l[154].name)&&(e.__value=r,Oe(e,e.__value))},d(l){l&&Y(e)}}}function $f(n){let e,i,s=n[155].label+"",r,l,u,c,f,d,p,g,w,k,P,M,A,z,E,B,H,F,G,lt,K;function tt(){return n[80](n[155])}function st(){return n[81](n[155])}function ht(){return n[82](n[155])}let I=Le(n[6]),rt=[];for(let Et=0;Et<I.length;Et+=1)rt[Et]=Aa(La(n,I,Et));function R(){n[83].call(P,n[157])}function mt(){return n[84](n[157],n[155])}function pt(){return n[85](n[155])}function J(){return n[86](n[155],n[157])}function j(){return n[87](n[155])}return{c(){e=T("div"),i=T("div"),r=Be(s),l=X(),u=T("button"),c=X(),f=T("button"),p=X(),g=T("button"),g.textContent="",w=X(),k=T("div"),P=T("select");for(let Et=0;Et<rt.length;Et+=1)rt[Et].c();M=X(),A=T("button"),A.textContent="",z=X(),E=T("button"),E.textContent="",B=X(),H=T("button"),H.textContent="",G=X(),m(i,"class","node-title svelte-a61jnr"),m(u,"class","dot in svelte-a61jnr"),m(u,"title","input"),m(f,"class","dot out svelte-a61jnr"),m(f,"title","output"),m(f,"aria-pressed",d=n[5]===n[155].id),m(g,"class","node-del svelte-a61jnr"),m(g,"title","delete node"),m(P,"class","svelte-a61jnr"),n[1][n[157]].type===void 0&&zi(R),m(A,"class","edit-btn svelte-a61jnr"),m(E,"class","preview-btn svelte-a61jnr"),m(E,"title","Preview on map"),m(H,"class","runone-btn svelte-a61jnr"),m(H,"title","Run this node only"),m(k,"class","node-config svelte-a61jnr"),m(e,"class","node svelte-a61jnr"),m(e,"aria-selected",F=n[158]?"true":"false")},m(Et,ut){Q(Et,e,ut),b(e,i),b(i,r),b(e,l),b(e,u),b(e,c),b(e,f),b(e,p),b(e,g),b(e,w),b(e,k),b(k,P);for(let kt=0;kt<rt.length;kt+=1)rt[kt]&&rt[kt].m(P,null);Fi(P,n[1][n[157]].type,!0),b(k,M),b(k,A),b(k,z),b(k,E),b(k,B),b(k,H),Q(Et,G,ut),lt||(K=[ft(u,"click",tt),ft(f,"click",st),ft(g,"click",ht),ft(P,"change",R),ft(P,"change",mt),ft(A,"click",pt),ft(E,"click",J),ft(H,"click",j),Si(n[159].call(null,e))],lt=!0)},p(Et,ut){if(n=Et,ut[0]&2&&s!==(s=n[155].label+"")&&_n(r,s),ut[0]&98&&d!==(d=n[5]===n[155].id)&&m(f,"aria-pressed",d),ut[0]&64){I=Le(n[6]);let kt;for(kt=0;kt<I.length;kt+=1){const Nt=La(n,I,kt);rt[kt]?rt[kt].p(Nt,ut):(rt[kt]=Aa(Nt),rt[kt].c(),rt[kt].m(P,null))}for(;kt<rt.length;kt+=1)rt[kt].d(1);rt.length=I.length}ut[0]&66&&Fi(P,n[1][n[157]].type),ut[5]&8&&F!==(F=n[158]?"true":"false")&&m(e,"aria-selected",F)},d(Et){Et&&(Y(e),Y(G)),Ai(rt,Et),lt=!1,fn(K)}}}function za(n,e){let i,s,r,l;function u(f){e[88](f,e[157])}let c={id:e[155].id,width:ml,height:pl,$$slots:{default:[$f,({selected:f,grabHandle:d})=>({158:f,159:d}),({selected:f,grabHandle:d})=>[0,0,0,0,0,(f?8:0)|(d?16:0)]]},$$scope:{ctx:e}};return e[1][e[157]].position!==void 0&&(c.position=e[1][e[157]].position),s=new ls({props:c}),ii.push(()=>ku(s,"position",u)),{key:n,first:null,c(){i=Ze(),_e(s.$$.fragment),this.first=i},m(f,d){Q(f,i,d),ue(s,f,d),l=!0},p(f,d){e=f;const p={};d[0]&2&&(p.id=e[155].id),d[0]&122|d[5]&4104&&(p.$$scope={dirty:d,ctx:e}),!r&&d[0]&2&&(r=!0,p.position=e[1][e[157]].position,yu(()=>r=!1)),s.$set(p)},i(f){l||(Z(s.$$.fragment,f),l=!0)},o(f){W(s.$$.fragment,f),l=!1},d(f){f&&Y(i),ce(s,f)}}}function Na(n){let e,i;return{c(){e=oe("path"),m(e,"d",i=`M ${n[48](n[153])} ${n[49](n[153])}
                          C ${n[48](n[153])+60} ${n[49](n[153])},
                            ${n[47](n[154])-60} ${n[49](n[154])},
                            ${n[47](n[154])} ${n[49](n[154])}`),m(e,"class","cable svelte-a61jnr"),m(e,"marker-end","url(#arrow)")},m(s,r){Q(s,e,r)},p(s,r){r[0]&4&&i!==(i=`M ${s[48](s[153])} ${s[49](s[153])}
                          C ${s[48](s[153])+60} ${s[49](s[153])},
                            ${s[47](s[154])-60} ${s[49](s[154])},
                            ${s[47](s[154])} ${s[49](s[154])}`)&&m(e,"d",i)},d(s){s&&Y(e)}}}function Ia(n,e){let i,s=e[36](e[150].source)&&e[36](e[150].target),r,l=s&&Na($o(e));return{key:n,first:null,c(){i=Ze(),l&&l.c(),r=Ze(),this.first=i},m(u,c){Q(u,i,c),l&&l.m(u,c),Q(u,r,c)},p(u,c){e=u,c[0]&4&&(s=e[36](e[150].source)&&e[36](e[150].target)),s?l?l.p($o(e),c):(l=Na($o(e)),l.c(),l.m(r.parentNode,r)):l&&(l.d(1),l=null)},d(u){u&&(Y(i),Y(r)),l&&l.d(u)}}}function Oa(n){let e,i,s,r=[],l=new Ui,u,c=Le(n[2]);const f=d=>d[150].id;for(let d=0;d<c.length;d+=1){let p=ka(n,c,d),g=f(p);l.set(g,r[d]=Ia(g,p))}return{c(){e=oe("defs"),i=oe("marker"),s=oe("path");for(let d=0;d<r.length;d+=1)r[d].c();u=Ze(),m(s,"d","M 0 0 L 10 5 L 0 10 z"),m(i,"id","arrow"),m(i,"viewBox","0 0 10 10"),m(i,"refX","9"),m(i,"refY","5"),m(i,"markerWidth","6"),m(i,"markerHeight","6"),m(i,"orient","auto-start-reverse")},m(d,p){Q(d,e,p),b(e,i),b(i,s);for(let g=0;g<r.length;g+=1)r[g]&&r[g].m(d,p);Q(d,u,p)},p(d,p){p[0]&4|p[1]&67567648&&(c=Le(d[2]),r=_i(r,p,f,1,d,c,l,u.parentNode,ao,Ia,u,ka))},d(d){d&&(Y(e),Y(u));for(let p=0;p<r.length;p+=1)r[p].d(d)}}}function td(n){let e=[],i=new Ui,s,r,l=n[14],u,c,f=Le(n[1]);const d=g=>g[155].id;for(let g=0;g<f.length;g+=1){let w=Pa(n,f,g),k=d(w);i.set(k,e[g]=za(k,w))}let p=Oa(n);return{c(){for(let g=0;g<e.length;g+=1)e[g].c();s=X(),r=oe("svg"),p.c(),m(r,"class","edges-overlay svelte-a61jnr"),m(r,"viewBox",u=`0 0 ${n[16]} ${n[17]}`),m(r,"preserveAspectRatio","none")},m(g,w){for(let k=0;k<e.length;k+=1)e[k]&&e[k].m(g,w);Q(g,s,w),Q(g,r,w),p.m(r,null),c=!0},p(g,w){w[0]&122|w[1]&20997248|w[5]&8&&(f=Le(g[1]),ke(),e=_i(e,w,d,1,g,f,i,s.parentNode,oo,za,s,Pa),Pe()),w[0]&16384&&mn(l,l=g[14])?(p.d(1),p=Oa(g),p.c(),p.m(r,null)):p.p(g,w),(!c||w[0]&196608&&u!==(u=`0 0 ${g[16]} ${g[17]}`))&&m(r,"viewBox",u)},i(g){if(!c){for(let w=0;w<f.length;w+=1)Z(e[w]);c=!0}},o(g){for(let w=0;w<e.length;w+=1)W(e[w]);c=!1},d(g){g&&(Y(s),Y(r));for(let w=0;w<e.length;w+=1)e[w].d(g);p.d(g)}}}function Ba(n){let e,i,s,r,l,u,c=n[21].label+"",f,d,p,g,w,k,P,M,A,z,E,B,H,F;function G(tt,st){return tt[25]?ed:nd}let lt=G(n),K=lt(n);return{c(){e=T("div"),i=X(),s=T("div"),r=T("div"),l=T("h3"),u=Be("Edit Args  "),f=Be(c),d=X(),p=T("div"),g=T("button"),g.textContent="Form",w=X(),k=T("button"),k.textContent="Advanced JSON",P=X(),K.c(),M=X(),A=T("div"),z=T("button"),z.textContent="Cancel",E=X(),B=T("button"),B.textContent="Save",m(e,"class","modal-backdrop svelte-a61jnr"),m(l,"class","svelte-a61jnr"),m(g,"class","svelte-a61jnr"),te(g,"seg-active",!n[25]),m(k,"class","svelte-a61jnr"),te(k,"seg-active",n[25]),m(p,"class","seg svelte-a61jnr"),m(r,"class","modal-head svelte-a61jnr"),m(z,"class","btn svelte-a61jnr"),m(B,"class","btn primary svelte-a61jnr"),m(A,"class","modal-actions svelte-a61jnr"),m(s,"class","modal svelte-a61jnr")},m(tt,st){Q(tt,e,st),Q(tt,i,st),Q(tt,s,st),b(s,r),b(r,l),b(l,u),b(l,f),b(r,d),b(r,p),b(p,g),b(p,w),b(p,k),b(s,P),K.m(s,null),b(s,M),b(s,A),b(A,z),b(A,E),b(A,B),H||(F=[ft(e,"click",n[92]),ft(g,"click",n[93]),ft(k,"click",n[94]),ft(z,"click",n[102]),ft(B,"click",n[56]),ft(s,"click",ni(n[69]))],H=!0)},p(tt,st){st[0]&2097152&&c!==(c=tt[21].label+"")&&_n(f,c),st[0]&33554432&&te(g,"seg-active",!tt[25]),st[0]&33554432&&te(k,"seg-active",tt[25]),lt===(lt=G(tt))&&K?K.p(tt,st):(K.d(1),K=lt(tt),K&&(K.c(),K.m(s,M)))},d(tt){tt&&(Y(e),Y(i),Y(s)),K.d(),H=!1,fn(F)}}}function ed(n){let e,i,s;return{c(){e=T("textarea"),m(e,"class","json-area svelte-a61jnr")},m(r,l){Q(r,e,l),Oe(e,n[22]),i||(s=ft(e,"input",n[101]),i=!0)},p(r,l){l[0]&4194304&&Oe(e,r[22])},d(r){r&&Y(e),i=!1,s()}}}function nd(n){let e,i=Le(n[23]),s=[];for(let r=0;r<i.length;r+=1)s[r]=Da(ba(n,i,r));return{c(){e=T("div");for(let r=0;r<s.length;r+=1)s[r].c();m(e,"class","form-grid svelte-a61jnr")},m(r,l){Q(r,e,l);for(let u=0;u<s.length;u+=1)s[u]&&s[u].m(e,null)},p(r,l){if(l[0]&25165824){i=Le(r[23]);let u;for(u=0;u<i.length;u+=1){const c=ba(r,i,u);s[u]?s[u].p(c,l):(s[u]=Da(c),s[u].c(),s[u].m(e,null))}for(;u<s.length;u+=1)s[u].d(1);s.length=i.length}},d(r){r&&Y(e),Ai(s,r)}}}function id(n){let e,i,s,r=Le(Xa(n[144])),l=[];for(let c=0;c<r.length;c+=1)l[c]=Za(wa(n,r,c));function u(){n[100].call(e,n[144])}return{c(){e=T("select");for(let c=0;c<l.length;c+=1)l[c].c();m(e,"class","svelte-a61jnr"),n[24][n[144].key]===void 0&&zi(u)},m(c,f){Q(c,e,f);for(let d=0;d<l.length;d+=1)l[d]&&l[d].m(e,null);Fi(e,n[24][n[144].key],!0),i||(s=ft(e,"change",u),i=!0)},p(c,f){if(n=c,f[0]&8388608){r=Le(Xa(n[144]));let d;for(d=0;d<r.length;d+=1){const p=wa(n,r,d);l[d]?l[d].p(p,f):(l[d]=Za(p),l[d].c(),l[d].m(e,null))}for(;d<l.length;d+=1)l[d].d(1);l.length=r.length}f[0]&25165824&&Fi(e,n[24][n[144].key])},d(c){c&&Y(e),Ai(l,c),i=!1,s()}}}function od(n){let e,i,s,r,l,u=Va(n[144])+"",c,f,d;function p(){n[99].call(e,n[144])}return{c(){e=T("input"),s=X(),r=T("small"),l=Be("Comma-separated "),c=Be(u),m(e,"type","text"),m(e,"placeholder",i=qa(n[144])),m(e,"class","svelte-a61jnr"),m(r,"class","muted svelte-a61jnr")},m(g,w){Q(g,e,w),Oe(e,n[24][n[144].key]),Q(g,s,w),Q(g,r,w),b(r,l),b(r,c),f||(d=ft(e,"input",p),f=!0)},p(g,w){n=g,w[0]&8388608&&i!==(i=qa(n[144]))&&m(e,"placeholder",i),w[0]&25165824&&e.value!==n[24][n[144].key]&&Oe(e,n[24][n[144].key]),w[0]&8388608&&u!==(u=Va(n[144])+"")&&_n(c,u)},d(g){g&&(Y(e),Y(s),Y(r)),f=!1,d()}}}function sd(n){let e,i,s,r,l;function u(){n[98].call(e,n[144])}return{c(){e=T("textarea"),m(e,"rows",i=Ga(n[144])),m(e,"placeholder",s=Ua(n[144])),m(e,"class","svelte-a61jnr")},m(c,f){Q(c,e,f),Oe(e,n[24][n[144].key]),r||(l=ft(e,"input",u),r=!0)},p(c,f){n=c,f[0]&8388608&&i!==(i=Ga(n[144]))&&m(e,"rows",i),f[0]&8388608&&s!==(s=Ua(n[144]))&&m(e,"placeholder",s),f[0]&25165824&&Oe(e,n[24][n[144].key])},d(c){c&&Y(e),r=!1,l()}}}function rd(n){let e,i,s,r,l,u;function c(){n[97].call(i,n[144])}return{c(){e=T("label"),i=T("input"),s=X(),r=T("span"),m(i,"type","checkbox"),m(i,"class","svelte-a61jnr"),m(e,"class","switch svelte-a61jnr")},m(f,d){Q(f,e,d),b(e,i),i.checked=n[24][n[144].key],b(e,s),b(e,r),l||(u=ft(i,"change",c),l=!0)},p(f,d){n=f,d[0]&25165824&&(i.checked=n[24][n[144].key])},d(f){f&&Y(e),l=!1,u()}}}function ad(n){let e,i,s,r;function l(){n[96].call(e,n[144])}return{c(){e=T("input"),m(e,"type","number"),m(e,"step",i=n[144].step??1),m(e,"class","svelte-a61jnr")},m(u,c){Q(u,e,c),Oe(e,n[24][n[144].key]),s||(r=ft(e,"input",l),s=!0)},p(u,c){n=u,c[0]&8388608&&i!==(i=n[144].step??1)&&m(e,"step",i),c[0]&25165824&&Ci(e.value)!==n[24][n[144].key]&&Oe(e,n[24][n[144].key])},d(u){u&&Y(e),s=!1,r()}}}function ld(n){let e,i,s,r;function l(){n[95].call(e,n[144])}return{c(){e=T("input"),m(e,"type","text"),m(e,"placeholder",i=n[144].placeholder??""),m(e,"class","svelte-a61jnr")},m(u,c){Q(u,e,c),Oe(e,n[24][n[144].key]),s||(r=ft(e,"input",l),s=!0)},p(u,c){n=u,c[0]&8388608&&i!==(i=n[144].placeholder??"")&&m(e,"placeholder",i),c[0]&25165824&&e.value!==n[24][n[144].key]&&Oe(e,n[24][n[144].key])},d(u){u&&Y(e),s=!1,r()}}}function Za(n){let e,i=n[147]+"",s,r;return{c(){e=T("option"),s=Be(i),e.__value=r=n[147],Oe(e,e.__value)},m(l,u){Q(l,e,u),b(e,s)},p(l,u){u[0]&8388608&&i!==(i=l[147]+"")&&_n(s,i),u[0]&8388608&&r!==(r=l[147])&&(e.__value=r,Oe(e,e.__value))},d(l){l&&Y(e)}}}function Da(n){let e,i,s=n[144].label+"",r,l,u;function c(p,g){if(p[144].type==="string")return ld;if(p[144].type==="number")return ad;if(p[144].type==="boolean")return rd;if(p[144].type==="textarea")return sd;if(p[144].type==="array")return od;if(p[144].type==="select")return id}let f=c(n),d=f&&f(n);return{c(){e=T("div"),i=T("label"),r=Be(s),l=X(),d&&d.c(),u=X(),m(i,"class","svelte-a61jnr"),m(e,"class","form-row svelte-a61jnr")},m(p,g){Q(p,e,g),b(e,i),b(i,r),b(e,l),d&&d.m(e,null),b(e,u)},p(p,g){g[0]&8388608&&s!==(s=p[144].label+"")&&_n(r,s),f===(f=c(p))&&d?d.p(p,g):(d&&d.d(1),d=f&&f(p),d&&(d.c(),d.m(e,u)))},d(p){p&&Y(e),d&&d.d()}}}function Ra(n){let e,i,s,r,l,u,c,f,d,p,g,w,k,P,M,A,z,E,B,H,F=n[33]?"Scheduling":"Create schedule",G,lt,K;function tt(rt,R){return rt[27]==="once"?hd:rt[27]==="interval"?cd:ud}let st=tt(n),ht=st(n),I=n[34]&&xa(n);return{c(){e=T("div"),i=X(),s=T("div"),r=T("div"),r.innerHTML='<h3 class="svelte-a61jnr">Schedule Pipeline (active connected graph)</h3>',l=X(),u=T("div"),c=T("div"),f=T("label"),f.textContent="Mode",d=X(),p=T("select"),g=T("option"),g.textContent="Once",w=T("option"),w.textContent="Interval",k=T("option"),k.textContent="Cron",P=X(),ht.c(),M=X(),I&&I.c(),A=X(),z=T("div"),E=T("button"),E.textContent="Cancel",B=X(),H=T("button"),G=Be(F),m(e,"class","modal-backdrop svelte-a61jnr"),m(r,"class","modal-head svelte-a61jnr"),m(f,"class","svelte-a61jnr"),g.__value="once",Oe(g,g.__value),w.__value="interval",Oe(w,w.__value),k.__value="cron",Oe(k,k.__value),m(p,"class","svelte-a61jnr"),n[27]===void 0&&zi(()=>n[104].call(p)),m(c,"class","form-row svelte-a61jnr"),m(u,"class","form-grid svelte-a61jnr"),m(E,"class","btn svelte-a61jnr"),m(H,"class","btn primary svelte-a61jnr"),H.disabled=n[33],m(z,"class","modal-actions svelte-a61jnr"),m(s,"class","modal svelte-a61jnr")},m(rt,R){Q(rt,e,R),Q(rt,i,R),Q(rt,s,R),b(s,r),b(s,l),b(s,u),b(u,c),b(c,f),b(c,d),b(c,p),b(p,g),b(p,w),b(p,k),Fi(p,n[27],!0),b(u,P),ht.m(u,null),b(u,M),I&&I.m(u,null),b(s,A),b(s,z),b(z,E),b(z,B),b(z,H),b(H,G),lt||(K=[ft(e,"click",n[103]),ft(p,"change",n[104]),ft(E,"click",n[110]),ft(H,"click",n[60]),ft(s,"click",ni(n[68]))],lt=!0)},p(rt,R){R[0]&134217728&&Fi(p,rt[27]),st===(st=tt(rt))&&ht?ht.p(rt,R):(ht.d(1),ht=st(rt),ht&&(ht.c(),ht.m(u,M))),rt[34]?I?I.p(rt,R):(I=xa(rt),I.c(),I.m(u,null)):I&&(I.d(1),I=null),R[1]&4&&F!==(F=rt[33]?"Scheduling":"Create schedule")&&_n(G,F),R[1]&4&&(H.disabled=rt[33])},d(rt){rt&&(Y(e),Y(i),Y(s)),ht.d(),I&&I.d(),lt=!1,fn(K)}}}function ud(n){let e,i,s,r,l,u,c,f;return{c(){e=T("div"),i=T("label"),i.textContent="Cron (UTC)",s=X(),r=T("input"),l=X(),u=T("small"),u.innerHTML="Example: <code>0 5 * * *</code> = 05:00 UTC daily",m(i,"class","svelte-a61jnr"),m(r,"type","text"),m(r,"placeholder","0 5 * * *"),m(r,"class","svelte-a61jnr"),m(u,"class","muted svelte-a61jnr"),m(e,"class","form-row svelte-a61jnr")},m(d,p){Q(d,e,p),b(e,i),b(e,s),b(e,r),Oe(r,n[32]),b(e,l),b(e,u),c||(f=ft(r,"input",n[109]),c=!0)},p(d,p){p[1]&2&&r.value!==d[32]&&Oe(r,d[32])},d(d){d&&Y(e),c=!1,f()}}}function cd(n){let e,i,s,r,l,u,c,f,d,p,g,w,k;return{c(){e=T("div"),i=T("label"),i.textContent="Interval",s=X(),r=T("div"),l=T("input"),u=X(),c=T("input"),f=X(),d=T("input"),p=X(),g=T("small"),g.textContent="At least one of hours/minutes/seconds must be > 0.",m(i,"class","svelte-a61jnr"),m(l,"type","number"),m(l,"min","0"),m(l,"placeholder","hours"),m(l,"class","svelte-a61jnr"),m(c,"type","number"),m(c,"min","0"),m(c,"placeholder","minutes"),m(c,"class","svelte-a61jnr"),m(d,"type","number"),m(d,"min","0"),m(d,"placeholder","seconds"),m(d,"class","svelte-a61jnr"),at(r,"display","grid"),at(r,"grid-template-columns","repeat(3, 1fr)"),at(r,"gap","8px"),m(g,"class","muted svelte-a61jnr"),m(e,"class","form-row svelte-a61jnr")},m(P,M){Q(P,e,M),b(e,i),b(e,s),b(e,r),b(r,l),Oe(l,n[29]),b(r,u),b(r,c),Oe(c,n[30]),b(r,f),b(r,d),Oe(d,n[31]),b(e,p),b(e,g),w||(k=[ft(l,"input",n[106]),ft(c,"input",n[107]),ft(d,"input",n[108])],w=!0)},p(P,M){M[0]&536870912&&Ci(l.value)!==P[29]&&Oe(l,P[29]),M[0]&1073741824&&Ci(c.value)!==P[30]&&Oe(c,P[30]),M[1]&1&&Ci(d.value)!==P[31]&&Oe(d,P[31])},d(P){P&&Y(e),w=!1,fn(k)}}}function hd(n){let e,i,s,r,l,u,c,f;return{c(){e=T("div"),i=T("label"),i.textContent="Date & time (your local)",s=X(),r=T("input"),l=X(),u=T("small"),u.textContent="Stored & executed in UTC on the server.",m(i,"class","svelte-a61jnr"),m(r,"type","datetime-local"),m(u,"class","muted svelte-a61jnr"),m(e,"class","form-row svelte-a61jnr")},m(d,p){Q(d,e,p),b(e,i),b(e,s),b(e,r),Oe(r,n[28]),b(e,l),b(e,u),c||(f=ft(r,"input",n[105]),c=!0)},p(d,p){p[0]&268435456&&Oe(r,d[28])},d(d){d&&Y(e),c=!1,f()}}}function xa(n){let e,i,s;return{c(){e=T("div"),i=T("div"),s=Be(n[34]),m(i,"class","muted svelte-a61jnr"),at(i,"color","#ffb4b4"),m(e,"class","form-row svelte-a61jnr")},m(r,l){Q(r,e,l),b(e,i),b(i,s)},p(r,l){l[1]&8&&_n(s,r[34])},d(r){r&&Y(e)}}}function fd(n){let e,i=[],s=new Ui,r=Le(n[7]);const l=u=>u[141];for(let u=0;u<r.length;u+=1){let c=ya(n,r,u),f=l(c);s.set(f,i[u]=ja(f,c))}return{c(){e=T("ul");for(let u=0;u<i.length;u+=1)i[u].c();m(e,"class","svelte-a61jnr")},m(u,c){Q(u,e,c);for(let f=0;f<i.length;f+=1)i[f]&&i[f].m(e,null)},p(u,c){c[0]&128&&(r=Le(u[7]),i=_i(i,c,l,1,u,r,s,e,ao,ja,null,ya))},d(u){u&&Y(e);for(let c=0;c<i.length;c+=1)i[c].d()}}}function dd(n){let e;return{c(){e=T("div"),e.textContent="No logs yet. Run the pipeline to see Python prints/stdout.",m(e,"class","muted small svelte-a61jnr")},m(i,s){Q(i,e,s)},p:Ut,d(i){i&&Y(e)}}}function ja(n,e){let i,s,r=e[142].nodeId+"",l,u,c=e[142].text+"",f,d,p;return{key:n,first:null,c(){i=T("li"),s=T("code"),l=Be(r),u=Be("  "),f=Be(c),d=X(),m(s,"class","svelte-a61jnr"),m(i,"class",p=Vs(e[142].ok?"ok":"err")+" svelte-a61jnr"),this.first=i},m(g,w){Q(g,i,w),b(i,s),b(s,l),b(i,u),b(i,f),b(i,d)},p(g,w){e=g,w[0]&128&&r!==(r=e[142].nodeId+"")&&_n(l,r),w[0]&128&&c!==(c=e[142].text+"")&&_n(f,c),w[0]&128&&p!==(p=Vs(e[142].ok?"ok":"err")+" svelte-a61jnr")&&m(i,"class",p)},d(g){g&&Y(i)}}}function _d(n){let e,i=[],s=new Ui,r,l=Le(n[11]);const u=f=>f[141];for(let f=0;f<l.length;f+=1){let d=va(n,l,f),p=u(d);s.set(p,i[f]=Ha(p,d))}let c=n[13]&&Wa();return{c(){e=T("div");for(let f=0;f<i.length;f+=1)i[f].c();r=X(),c&&c.c(),m(e,"class","chat-messages svelte-a61jnr")},m(f,d){Q(f,e,d);for(let p=0;p<i.length;p+=1)i[p]&&i[p].m(e,null);b(e,r),c&&c.m(e,null)},p(f,d){d[0]&2048&&(l=Le(f[11]),i=_i(i,d,u,1,f,l,s,e,ao,Ha,r,va)),f[13]?c||(c=Wa(),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},d(f){f&&Y(e);for(let d=0;d<i.length;d+=1)i[d].d();c&&c.d()}}}function md(n){let e;return{c(){e=T("div"),e.innerHTML='<p> Hi! I&#39;m your AI assistant for SATERYS.</p> <p>I can help you:</p> <ul style="list-style: none; padding: 0;"><li> Create new nodes and workflows</li> <li> Modify existing nodes</li> <li> Answer questions about geospatial analysis</li> <li> Build complex pipelines from descriptions</li></ul> <p style="margin-top: 10px;"><b>Try asking:</b> &quot;Create a workflow to calculate NDVI from a raster&quot;</p>',m(e,"class","muted small svelte-a61jnr"),at(e,"padding","20px"),at(e,"text-align","center")},m(i,s){Q(i,e,s)},p:Ut,d(i){i&&Y(e)}}}function Ha(n,e){let i,s,r,l=e[139].role==="user"?" You":" AI",u,c,f,d=new Date(e[139].timestamp).toLocaleTimeString()+"",p,g,w,k=e[139].content+"",P,M;return{key:n,first:null,c(){i=T("div"),s=T("div"),r=T("span"),u=Be(l),c=X(),f=T("span"),p=Be(d),g=X(),w=T("div"),P=Be(k),m(r,"class","chat-role svelte-a61jnr"),m(f,"class","chat-time svelte-a61jnr"),m(s,"class","chat-message-header svelte-a61jnr"),m(w,"class","chat-content svelte-a61jnr"),m(i,"class","chat-message svelte-a61jnr"),m(i,"data-role",M=e[139].role),this.first=i},m(A,z){Q(A,i,z),b(i,s),b(s,r),b(r,u),b(s,c),b(s,f),b(f,p),b(i,g),b(i,w),b(w,P)},p(A,z){e=A,z[0]&2048&&l!==(l=e[139].role==="user"?" You":" AI")&&_n(u,l),z[0]&2048&&d!==(d=new Date(e[139].timestamp).toLocaleTimeString()+"")&&_n(p,d),z[0]&2048&&k!==(k=e[139].content+"")&&_n(P,k),z[0]&2048&&M!==(M=e[139].role)&&m(i,"data-role",M)},d(A){A&&Y(i)}}}function Wa(n){let e;return{c(){e=T("div"),e.innerHTML='<div class="chat-message-header svelte-a61jnr"><span class="chat-role svelte-a61jnr"> AI</span></div> <div class="chat-content svelte-a61jnr"><span class="typing-indicator svelte-a61jnr">Thinking...</span></div>',m(e,"class","chat-message svelte-a61jnr"),m(e,"data-role","assistant")},m(i,s){Q(i,e,s)},d(i){i&&Y(e)}}}function pd(n){let e,i,s,r,l,u,c,f,d,p,g,w,k,P,M,A,z,E,B,H,F,G,lt,K,tt,st,ht,I,rt,R,mt,pt,J,j,Et,ut,kt,Nt,yt=n[0]==="dark"?"Dark":"Light",x,it,U,q,Vt,re,dt,Dt,Ht,Wt,It,ne,Xt,ot,ae,Qt,Rt,se=n[8]?"Running":"Run",Fe,Ge,De,Ce,Kt,he,ze,Re,Ft,le,xe,Je,Qe,Sn,ye,Xe,Ot,an,je,Ue,dn,bn,He,Ne,$e,Jt,fe,tn,Tn,pn,gn,En,qe,Pt,Ye,vn,en,Bn,y,_t,Lt,Ct,At,O,$t,me,Yt,Se,nn,ln,on,An,oi,Wn,xn,wn,Jn,Kn,gt,Gt,ee,un,Mn,cn,pe,xt,We,Fn,Qn,hn,mi,Gn,kn,ge,Un,In,Zn,On,Dn,ai,sn,li,bi;function wi(St,ie){return St[2].length===0?Kf:Yf}let S=wi(n),nt=S(n),V=n[5]&&Ta(n);function zt(St,ie){return St[35].length===0?Qf:Jf}let et=zt(n),Tt=et(n);en=new Vf({props:{width:n[16],height:n[17],theme:n[0],$$slots:{default:[td]},$$scope:{ctx:n}}});let wt=n[21]&&Ba(n),jt=n[26]&&Ra(n);function Bt(St,ie){return St[7].length===0?dd:fd}let be=Bt(n),rn=be(n);function Rn(St,ie){return St[11].length===0?md:_d}let ui=Rn(n),zn=ui(n);return{c(){e=T("div"),i=T("header"),s=T("div"),r=T("button"),r.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',l=X(),u=T("div"),u.innerHTML='<span class="title svelte-a61jnr">SATERYS</span>',c=X(),f=T("div"),f.innerHTML='<div class="hint svelte-a61jnr">Build pipelines  click a nodes  /  to connect</div>',d=X(),p=T("div"),g=T("button"),w=oe("svg"),k=oe("path"),P=X(),M=T("span"),M.textContent="Run",z=X(),E=T("button"),E.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z" stroke="currentColor" stroke-width="2" fill="none"></path><path d="M7 3v6h10" stroke="currentColor" stroke-width="2" fill="none"></path><path d="M17 21v-8H7v8" stroke="currentColor" stroke-width="2" fill="none"></path></svg> <span>Save</span>',B=X(),H=T("button"),H.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M3 15v4a2 2 0 002 2h14a2 2 0 002-2v-4M17 9l-5 5-5-5M12 4v10" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Load</span>',F=X(),G=T("button"),G.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18" aria-hidden="true"><path d="M8 7V4m8 3V4M5 11h14M7 21h10a2 2 0 002-2V8a2 2 0 00-2-2H7a2 2 0 00-2 2v11a2 2 0 002 2zm5-6v-3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span>Schedule</span>',lt=X(),K=T("button"),K.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2zm2 4l3 3-3 3m5 0h5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Logs</span>',tt=X(),st=T("button"),st.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>AI Chat</span>',ht=X(),I=T("button"),rt=oe("svg"),R=oe("path"),mt=X(),pt=T("span"),pt.textContent="Layers",J=X(),j=T("button"),Et=oe("svg"),ut=oe("path"),kt=X(),Nt=T("span"),x=Be(yt),it=X(),U=T("button"),U.innerHTML='<svg viewBox="0 0 24 24" width="18" height="18"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span>Add</span>',q=X(),Vt=T("div"),re=T("aside"),dt=T("div"),Dt=T("div"),Dt.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M5 12h14M12 5v14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span class="txt svelte-a61jnr">Tools</span>',Ht=X(),Wt=T("div"),It=T("button"),It.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg> <span class="txt svelte-a61jnr">Add Node</span>',ne=X(),Xt=T("button"),ot=oe("svg"),ae=oe("path"),Qt=X(),Rt=T("span"),Fe=Be(se),Ge=X(),De=T("button"),Ce=oe("svg"),Kt=oe("path"),he=X(),ze=T("span"),ze.textContent="Clear Layers",Re=X(),Ft=T("button"),le=oe("svg"),xe=oe("path"),Je=X(),Qe=T("span"),Sn=Be("Theme: "),ye=Be(n[0]),Xe=X(),Ot=T("div"),an=T("div"),an.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 12l7-7 4 4 7-7" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span class="txt svelte-a61jnr">Edges</span>',je=X(),Ue=T("div"),nt.c(),dn=X(),V&&V.c(),bn=X(),He=T("div"),Ne=T("div"),$e=oe("svg"),Jt=oe("path"),fe=X(),tn=T("span"),tn.textContent="Schedules",Tn=X(),pn=T("button"),pn.textContent="",gn=X(),Tt.c(),qe=X(),Pt=T("div"),Ye=T("div"),vn=T("div"),_e(en.$$.fragment),Bn=X(),y=T("div"),_t=X(),Lt=T("div"),Ct=T("div"),O=X(),wt&&wt.c(),$t=X(),jt&&jt.c(),me=X(),Yt=T("div"),Se=T("div"),nn=T("div"),nn.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M4 5h16a2 2 0 012 2v10a2 2 0 01-2 2H4a2 2 0 01-2-2V7a2 2 0 012-2zm2 4l3 3-3 3m5 0h5" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>Pipeline Logs</span>',ln=X(),on=T("div"),An=T("button"),An.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M9 9h11v11H9zM5 5h11v11" stroke="currentColor" stroke-width="2" fill="none"></path></svg>',oi=X(),Wn=T("button"),Wn.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 6h18M9 6v12m6-12v12M5 6l1-3h12l1 3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',xn=X(),wn=T("button"),wn.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M6 6l12 12M6 18L18 6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',Jn=X(),Kn=T("div"),rn.c(),Gt=X(),ee=T("div"),un=T("div"),Mn=T("div"),Mn.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M21 15a2 2 0 01-2 2H7l-4 4V5a2 2 0 012-2h14a2 2 0 012 2z" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg> <span>AI Assistant</span>',cn=X(),pe=T("div"),xt=T("button"),xt.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M3 6h18M9 6v12m6-12v12M5 6l1-3h12l1 3" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',We=X(),Fn=T("button"),Fn.innerHTML='<svg viewBox="0 0 24 24" width="16" height="16"><path d="M6 6l12 12M6 18L18 6" stroke="currentColor" stroke-width="2" fill="none" stroke-linecap="round"></path></svg>',Qn=X(),hn=T("div"),zn.c(),mi=X(),Gn=T("div"),kn=T("form"),ge=T("input"),Un=X(),In=T("button"),Zn=oe("svg"),On=oe("path"),m(r,"class","icon-btn ghost svelte-a61jnr"),m(r,"title","Toggle sidebar"),m(u,"class","brand svelte-a61jnr"),m(s,"class","left svelte-a61jnr"),m(f,"class","center svelte-a61jnr"),m(k,"d","M8 5v14l11-7z"),m(k,"fill","currentColor"),m(w,"viewBox","0 0 24 24"),m(w,"width","18"),m(w,"height","18"),m(g,"class","icon-btn svelte-a61jnr"),m(g,"title",A=n[8]?"Running":"Run pipeline"),g.disabled=n[8],m(E,"class","icon-btn svelte-a61jnr"),m(E,"title","Save workflow"),m(H,"class","icon-btn svelte-a61jnr"),m(H,"title","Load workflow"),m(G,"class","icon-btn svelte-a61jnr"),m(G,"title","Schedule pipeline"),m(K,"class","icon-btn svelte-a61jnr"),m(K,"title","Toggle logs"),m(st,"class","icon-btn svelte-a61jnr"),m(st,"title","Toggle AI Chat"),m(R,"d","M12 3l9 5-9 5-9-5 9-5zm0 8l9 5-9 5-9-5"),m(R,"stroke","currentColor"),m(R,"stroke-width","2"),m(R,"fill","none"),m(R,"stroke-linejoin","round"),m(rt,"viewBox","0 0 24 24"),m(rt,"width","18"),m(rt,"height","18"),m(I,"class","icon-btn svelte-a61jnr"),m(I,"title","Clear map layers"),I.disabled=n[51].size===0,m(ut,"d","M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"),m(ut,"stroke","currentColor"),m(ut,"stroke-width","2"),m(ut,"fill","none"),m(Et,"viewBox","0 0 24 24"),m(Et,"width","18"),m(Et,"height","18"),m(j,"class","icon-btn svelte-a61jnr"),m(j,"title","Toggle theme"),m(U,"class","icon-btn primary svelte-a61jnr"),m(U,"title","Add node"),m(p,"class","right svelte-a61jnr"),m(i,"class","topbar glass svelte-a61jnr"),m(Dt,"class","section-title svelte-a61jnr"),m(It,"class","tool svelte-a61jnr"),m(It,"title","Add node"),m(ae,"d","M8 5v14l11-7z"),m(ae,"fill","currentColor"),m(ot,"viewBox","0 0 24 24"),m(ot,"width","16"),m(ot,"height","16"),m(Rt,"class","txt svelte-a61jnr"),m(Xt,"class","tool svelte-a61jnr"),Xt.disabled=n[8],m(Xt,"title","Run pipeline"),m(Kt,"d","M12 3l9 5-9 5-9-5 9-5zm0 8l9 5-9 5-9-5"),m(Kt,"stroke","currentColor"),m(Kt,"stroke-width","2"),m(Kt,"fill","none"),m(Kt,"stroke-linejoin","round"),m(Ce,"viewBox","0 0 24 24"),m(Ce,"width","16"),m(Ce,"height","16"),m(ze,"class","txt svelte-a61jnr"),m(De,"class","tool svelte-a61jnr"),De.disabled=n[51].size===0,m(De,"title","Clear overlay layers"),m(xe,"d","M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"),m(xe,"stroke","currentColor"),m(xe,"stroke-width","2"),m(xe,"fill","none"),m(le,"viewBox","0 0 24 24"),m(le,"width","16"),m(le,"height","16"),m(Qe,"class","txt svelte-a61jnr"),m(Ft,"class","tool svelte-a61jnr"),m(Ft,"title","Toggle theme"),m(Wt,"class","tool-list svelte-a61jnr"),m(dt,"class","section"),m(an,"class","section-title svelte-a61jnr"),m(Ue,"class","edge-chips svelte-a61jnr"),m(Ot,"class","section"),m(Jt,"d","M6 6h12v12H6zM9 3h6M3 9h6M15 21h6M3 15h6"),m(Jt,"stroke","currentColor"),m(Jt,"stroke-width","2"),m(Jt,"fill","none"),m(Jt,"stroke-linecap","round"),m($e,"viewBox","0 0 24 24"),m($e,"width","16"),m($e,"height","16"),m(tn,"class","txt svelte-a61jnr"),m(pn,"class","pill-x svelte-a61jnr"),m(pn,"title","Refresh"),m(Ne,"class","section-title svelte-a61jnr"),m(He,"class","section"),m(re,"class","sidebar svelte-a61jnr"),m(re,"data-collapsed",En=n[9]?"true":"false"),m(vn,"class","split-left svelte-a61jnr"),at(vn,"width",n[18]+"%"),m(y,"class","split-handle svelte-a61jnr"),m(y,"role","separator"),m(y,"aria-orientation","vertical"),m(y,"aria-label","Resize split"),m(Ct,"class","map svelte-a61jnr"),m(Lt,"class","split-right svelte-a61jnr"),m(Ye,"class","split-container svelte-a61jnr"),m(Pt,"class","work svelte-a61jnr"),m(Vt,"class","main svelte-a61jnr"),m(Vt,"data-collapsed",At=n[9]?"true":"false"),m(nn,"class","logs-title svelte-a61jnr"),m(An,"class","icon-btn svelte-a61jnr"),m(An,"title","Copy all"),m(Wn,"class","icon-btn svelte-a61jnr"),m(Wn,"title","Clear"),m(wn,"class","icon-btn svelte-a61jnr"),m(wn,"title","Close"),m(on,"class","logs-actions svelte-a61jnr"),m(Se,"class","logs-header svelte-a61jnr"),m(Kn,"class","logs-body svelte-a61jnr"),m(Yt,"class","logs-drawer svelte-a61jnr"),m(Yt,"data-open",gt=n[4]?"true":"false"),at(Yt,"bottom",n[10]?"45dvh":"0"),m(Mn,"class","chat-title svelte-a61jnr"),m(xt,"class","icon-btn svelte-a61jnr"),m(xt,"title","Clear history"),m(Fn,"class","icon-btn svelte-a61jnr"),m(Fn,"title","Close"),m(pe,"class","chat-actions svelte-a61jnr"),m(un,"class","chat-header svelte-a61jnr"),m(hn,"class","chat-body svelte-a61jnr"),m(ge,"type","text"),m(ge,"placeholder","Ask AI to create nodes, modify workflow, or answer questions..."),ge.disabled=n[13],m(ge,"class","svelte-a61jnr"),m(On,"d","M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"),m(On,"stroke","currentColor"),m(On,"stroke-width","2"),m(On,"fill","none"),m(On,"stroke-linecap","round"),m(On,"stroke-linejoin","round"),m(Zn,"viewBox","0 0 24 24"),m(Zn,"width","18"),m(Zn,"height","18"),m(In,"type","submit"),In.disabled=Dn=n[13]||!n[12].trim(),m(In,"class","svelte-a61jnr"),m(kn,"class","svelte-a61jnr"),m(Gn,"class","chat-input-area svelte-a61jnr"),m(ee,"class","chat-drawer svelte-a61jnr"),m(ee,"data-open",ai=n[10]?"true":"false"),m(e,"class","app-root svelte-a61jnr")},m(St,ie){Q(St,e,ie),b(e,i),b(i,s),b(s,r),b(s,l),b(s,u),b(i,c),b(i,f),b(i,d),b(i,p),b(p,g),b(g,w),b(w,k),b(g,P),b(g,M),b(p,z),b(p,E),b(p,B),b(p,H),b(p,F),b(p,G),b(p,lt),b(p,K),b(p,tt),b(p,st),b(p,ht),b(p,I),b(I,rt),b(rt,R),b(I,mt),b(I,pt),b(p,J),b(p,j),b(j,Et),b(Et,ut),b(j,kt),b(j,Nt),b(Nt,x),b(p,it),b(p,U),b(e,q),b(e,Vt),b(Vt,re),b(re,dt),b(dt,Dt),b(dt,Ht),b(dt,Wt),b(Wt,It),b(Wt,ne),b(Wt,Xt),b(Xt,ot),b(ot,ae),b(Xt,Qt),b(Xt,Rt),b(Rt,Fe),b(Wt,Ge),b(Wt,De),b(De,Ce),b(Ce,Kt),b(De,he),b(De,ze),b(Wt,Re),b(Wt,Ft),b(Ft,le),b(le,xe),b(Ft,Je),b(Ft,Qe),b(Qe,Sn),b(Qe,ye),b(re,Xe),b(re,Ot),b(Ot,an),b(Ot,je),b(Ot,Ue),nt.m(Ue,null),b(Ot,dn),V&&V.m(Ot,null),b(re,bn),b(re,He),b(He,Ne),b(Ne,$e),b($e,Jt),b(Ne,fe),b(Ne,tn),b(Ne,Tn),b(Ne,pn),b(He,gn),Tt.m(He,null),b(Vt,qe),b(Vt,Pt),b(Pt,Ye),b(Ye,vn),ue(en,vn,null),n[89](vn),b(Ye,Bn),b(Ye,y),b(Ye,_t),b(Ye,Lt),b(Lt,Ct),n[90](Ct),n[91](Lt),b(e,O),wt&&wt.m(e,null),b(e,$t),jt&&jt.m(e,null),b(e,me),b(e,Yt),b(Yt,Se),b(Se,nn),b(Se,ln),b(Se,on),b(on,An),b(on,oi),b(on,Wn),b(on,xn),b(on,wn),b(Yt,Jn),b(Yt,Kn),rn.m(Kn,null),b(e,Gt),b(e,ee),b(ee,un),b(un,Mn),b(un,cn),b(un,pe),b(pe,xt),b(pe,We),b(pe,Fn),b(ee,Qn),b(ee,hn),zn.m(hn,null),b(ee,mi),b(ee,Gn),b(Gn,kn),b(kn,ge),Oe(ge,n[12]),b(kn,Un),b(kn,In),b(In,Zn),b(Zn,On),sn=!0,li||(bi=[ft(r,"click",n[52]),ft(g,"click",n[42]),ft(E,"click",n[65]),ft(H,"click",n[66]),ft(G,"click",n[59]),ft(K,"click",n[70]),ft(st,"click",n[71]),ft(I,"click",n[54]),ft(j,"click",n[72]),ft(U,"click",n[43]),ft(It,"click",n[43]),ft(Xt,"click",n[42]),ft(De,"click",n[54]),ft(Ft,"click",n[73]),ft(pn,"click",n[61]),ft(y,"mousedown",n[50]),ft(An,"click",n[111]),ft(Wn,"click",n[112]),ft(wn,"click",n[113]),ft(xt,"click",n[40]),ft(Fn,"click",n[114]),ft(ge,"input",n[115]),ft(kn,"submit",Vn(n[39]))],li=!0)},p(St,ie){(!sn||ie[0]&256&&A!==(A=St[8]?"Running":"Run pipeline"))&&m(g,"title",A),(!sn||ie[0]&256)&&(g.disabled=St[8]),(!sn||ie[0]&1)&&yt!==(yt=St[0]==="dark"?"Dark":"Light")&&_n(x,yt),(!sn||ie[0]&256)&&se!==(se=St[8]?"Running":"Run")&&_n(Fe,se),(!sn||ie[0]&256)&&(Xt.disabled=St[8]),(!sn||ie[0]&1)&&_n(ye,St[0]),S===(S=wi(St))&&nt?nt.p(St,ie):(nt.d(1),nt=S(St),nt&&(nt.c(),nt.m(Ue,null))),St[5]?V?V.p(St,ie):(V=Ta(St),V.c(),V.m(Ot,null)):V&&(V.d(1),V=null),et===(et=zt(St))&&Tt?Tt.p(St,ie):(Tt.d(1),Tt=et(St),Tt&&(Tt.c(),Tt.m(He,null))),(!sn||ie[0]&512&&En!==(En=St[9]?"true":"false"))&&m(re,"data-collapsed",En);const ki={};ie[0]&65536&&(ki.width=St[16]),ie[0]&131072&&(ki.height=St[17]),ie[0]&1&&(ki.theme=St[0]),ie[0]&213118|ie[5]&4096&&(ki.$$scope={dirty:ie,ctx:St}),en.$set(ki),(!sn||ie[0]&262144)&&at(vn,"width",St[18]+"%"),(!sn||ie[0]&512&&At!==(At=St[9]?"true":"false"))&&m(Vt,"data-collapsed",At),St[21]?wt?wt.p(St,ie):(wt=Ba(St),wt.c(),wt.m(e,$t)):wt&&(wt.d(1),wt=null),St[26]?jt?jt.p(St,ie):(jt=Ra(St),jt.c(),jt.m(e,me)):jt&&(jt.d(1),jt=null),be===(be=Bt(St))&&rn?rn.p(St,ie):(rn.d(1),rn=be(St),rn&&(rn.c(),rn.m(Kn,null))),(!sn||ie[0]&16&&gt!==(gt=St[4]?"true":"false"))&&m(Yt,"data-open",gt),(!sn||ie[0]&1024)&&at(Yt,"bottom",St[10]?"45dvh":"0"),ui===(ui=Rn(St))&&zn?zn.p(St,ie):(zn.d(1),zn=ui(St),zn&&(zn.c(),zn.m(hn,null))),(!sn||ie[0]&8192)&&(ge.disabled=St[13]),ie[0]&4096&&ge.value!==St[12]&&Oe(ge,St[12]),(!sn||ie[0]&12288&&Dn!==(Dn=St[13]||!St[12].trim()))&&(In.disabled=Dn),(!sn||ie[0]&1024&&ai!==(ai=St[10]?"true":"false"))&&m(ee,"data-open",ai)},i(St){sn||(Z(en.$$.fragment,St),sn=!0)},o(St){W(en.$$.fragment,St),sn=!1},d(St){St&&Y(e),nt.d(),V&&V.d(),Tt.d(),ce(en),n[89](null),n[90](null),n[91](null),wt&&wt.d(),jt&&jt.d(),rn.d(),zn.d(),li=!1,fn(bi)}}}const ml=230,pl=80;function gd(n){const e=[];if(!n||typeof n!="object")return e;for(const[i,s]of Object.entries(n))typeof s=="string"?e.push({key:i,label:i,type:"string"}):typeof s=="number"?e.push({key:i,label:i,type:"number"}):typeof s=="boolean"?e.push({key:i,label:i,type:"boolean"}):Array.isArray(s)?e.push({key:i,label:i,type:"array",itemType:typeof s[0]=="number"?"number":"string"}):e.push({key:i,label:i,type:"textarea"});return e}function vd(n,e){const i=n.map(f=>f.id),s=new Set(i),r=new Map,l=new Map;for(const f of i)r.set(f,[]),l.set(f,0);for(const f of e)!s.has(f.source)||!s.has(f.target)||(r.get(f.source).push(f.target),l.set(f.target,(l.get(f.target)||0)+1));const u=[];for(const f of i)(l.get(f)||0)===0&&u.push(f);const c=[];for(;u.length;){const f=u.shift();c.push(f);for(const d of r.get(f))l.set(d,(l.get(d)||0)-1),(l.get(d)||0)===0&&u.push(d)}return c}async function Fa(n,e={}){return await(await fetch("/run_node",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nodeId:n.id,type:n.type,args:n.args??{},inputs:e})})).json().catch(()=>({ok:!1,error:"Bad JSON"}))}function Ga(n){return n.rows??6}function Ua(n){return n.placeholder??""}function qa(n){return n.hint??"comma-separated"}function Va(n){return n.itemType??"values"}function Xa(n){return n.options??[]}function Ya(n){return n?new Date(n).toLocaleString():""}async function yd(n){await fetch(`/pipeline/schedules/${n}/run-now`,{method:"POST"}).catch(()=>{})}function bd(n,e,i){let s="dark",r=[],l=1,u=[],c=1,f=null,d={},p=[{name:"hello",default_args:{name:"world"}},{name:"sum",default_args:{nums:[1,2,3]}},{name:"script",default_args:{code:"print('hello')"}},{name:"raster.input",default_args:{path:""}}];Xn(async()=>{try{const nt=await(await fetch("/node_types")).json();Array.isArray(nt==null?void 0:nt.types)&&i(6,p=nt.types)}catch{}});const g={hello:[{key:"name",label:"Name",type:"string",placeholder:"world"}],sum:[{key:"nums",label:"Numbers",type:"array",itemType:"number",hint:"e.g., 1,2,3"}],script:[{key:"code",label:"Code",type:"textarea",rows:8,placeholder:"print('hello')"}],"raster.input":[{key:"path",label:"Raster path",type:"string",placeholder:"/path/to.tif"}],"vector.input":[{key:"path",label:"Vector path",type:"string",placeholder:"/path/to.geojson"},{key:"layer",label:"Layer (optional)",type:"string",placeholder:"layer name"}],"vector.create":[{key:"type",label:"Geometry type",type:"select",options:["point","line","polygon"]},{key:"coordinates",label:"Coordinates (JSON)",type:"textarea",rows:4,placeholder:"[[lon, lat], ...]"},{key:"name",label:"Feature name",type:"string",placeholder:"Feature 1"},{key:"properties",label:"Properties (JSON)",type:"textarea",rows:3,placeholder:"{}"}]};function w(S){var zt;const nt=g[S];if(nt)return nt;const V=(zt=p.find(et=>et.name===S))==null?void 0:zt.default_args;return gd(V??{})}const k=S=>r.find(nt=>nt.id===S);function P(S,nt){!k(S)||!k(nt)||S===nt||u.some(V=>V.source===S&&V.target===nt)||i(2,u=[...u,{id:`e${c++}`,source:S,target:nt}])}function M(S){i(2,u=u.filter(nt=>nt.id!==S))}function A(S){if(ne.has(S)&&It&&Xt){const nt=ne.get(S);It.removeLayer(nt),Xt.removeLayer(nt),ne.delete(S)}i(1,r=r.filter(nt=>nt.id!==S)),delete d[S]}function z(){const S=new Set;for(const et of u)S.add(et.source),S.add(et.target);const nt=r.filter(et=>S.has(et.id)),V=new Set(nt.map(et=>et.id)),zt=u.filter(et=>V.has(et.source)&&V.has(et.target));return{activeNodes:nt,activeEdges:zt}}let E=[],B=!1,H={},F=!1,G=!1,lt=!1,K=[],tt="",st=!1;async function ht(){var nt,V;if(!tt.trim()||st)return;const S=tt.trim();i(12,tt=""),i(13,st=!0),i(11,K=[...K,{role:"user",content:S,timestamp:new Date().toISOString()}]),requestAnimationFrame(()=>{const zt=document.querySelector(".chat-body");zt&&(zt.scrollTop=zt.scrollHeight)});try{const zt={nodes:r.map(wt=>({id:wt.id,type:wt.type,label:wt.label,args:wt.args})),edges:u.map(wt=>({source:wt.source,target:wt.target}))},et=await fetch("/llm/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:S,context:zt})});if(!et.ok){const wt=await et.json().catch(()=>({detail:"Unknown error"}));throw new Error(wt.detail||`HTTP ${et.status}`)}const Tt=await et.json();if(i(11,K=[...K,{role:"assistant",content:Tt.message||"Action completed.",timestamp:Tt.timestamp||new Date().toISOString()}]),Tt.action==="create_node"||Tt.action==="create_workflow"){if(Tt.nodes&&Array.isArray(Tt.nodes)){for(const wt of Tt.nodes){const jt=`n${l++}`,Bt=((nt=wt.position)==null?void 0:nt.x)||120+r.length%6*260,be=((V=wt.position)==null?void 0:V.y)||140+Math.floor(r.length/6)*140,rn=wt.label||`${wt.type} (${jt})`;i(1,r=[...r,{id:jt,position:{x:Bt,y:be},label:rn,type:wt.type,args:wt.args||{}}]),i(3,d[jt]=JSON.stringify(wt.args||{},null,2),d)}R("llm",!0,`Created ${Tt.nodes.length} node(s) via LLM`),i(4,F=!0)}if(Tt.edges&&Array.isArray(Tt.edges))for(const wt of Tt.edges){let jt,Bt;typeof wt.source=="number"?jt=r[wt.source]:jt=r.find(be=>be.id===wt.source),typeof wt.target=="number"?Bt=r[wt.target]:Bt=r.find(be=>be.id===wt.target),jt&&Bt&&P(jt.id,Bt.id)}}requestAnimationFrame(()=>{const wt=document.querySelector(".chat-body");wt&&(wt.scrollTop=wt.scrollHeight)})}catch(zt){i(11,K=[...K,{role:"assistant",content:`Error: ${(zt==null?void 0:zt.message)||zt}`,timestamp:new Date().toISOString()}])}finally{i(13,st=!1)}}async function I(){try{const S=await fetch("/llm/history");if(S.ok){const nt=await S.json();nt.messages&&Array.isArray(nt.messages)&&i(11,K=nt.messages.map(V=>({role:V.role,content:V.content,timestamp:V.timestamp})))}}catch(S){console.warn("Failed to load chat history:",S)}}async function rt(){try{await fetch("/llm/history",{method:"DELETE"}),i(11,K=[])}catch(S){console.warn("Failed to clear chat history:",S)}}Xn(async()=>{await I().catch(()=>{})});function R(S,nt,V){i(7,E=[...E,{nodeId:S,ok:nt,text:V}]),F&&requestAnimationFrame(()=>{const zt=document.querySelector(".logs-body");zt&&(zt.scrollTop=zt.scrollHeight)})}async function mt(){var et;i(8,B=!0),i(7,E=[]),H={},i(4,F=!0);const{activeNodes:S,activeEdges:nt}=z();if(S.length===0){R("system",!1,"No connected nodes to run."),i(8,B=!1);return}const V=vd(S,nt);V.length!==S.length&&R("system",!1,"Warning: cycle detected; running partial order.");const zt={};for(const Tt of nt)(zt[et=Tt.target]??(zt[et]=[])).push(Tt.source);for(const Tt of V){const wt=k(Tt),jt={};for(const Bt of zt[Tt]??[])jt[Bt]=H[Bt];R(Tt,!0," Running");try{const Bt=await Fa(wt,jt);if(Array.isArray(Bt==null?void 0:Bt.logs))for(const be of Bt.logs)R(Tt,!0,String(be));if(typeof(Bt==null?void 0:Bt.stdout)=="string"&&Bt.stdout.trim())for(const be of Bt.stdout.split(/\r?\n/))be.trim()&&R(Tt,!0,be);if(Bt!=null&&Bt.ok){const be=Bt.output??{};H[Tt]=be;const rn=typeof be=="string"?be:be.text??JSON.stringify(be);R(Tt,!0,` ${rn}`)}else R(Tt,!1,` ${(Bt==null?void 0:Bt.error)||"Unknown error"}`)}catch(Bt){R(Tt,!1,` Exception: ${(Bt==null?void 0:Bt.message)||Bt}`)}}i(8,B=!1)}function pt(){const S=`n${l++}`,nt=p[0]||{name:"hello",default_args:{name:S}},V=120+r.length%6*260,zt=140+Math.floor(r.length/6)*140,et=JSON.parse(JSON.stringify(nt.default_args||{})),Tt=`${nt.name} (${S})`;i(1,r=[...r,{id:S,position:{x:V,y:zt},label:Tt,type:nt.name,args:et}]),i(3,d[S]=JSON.stringify(et,null,2),d)}function J(S){i(5,f=S)}function j(S){f&&P(f,S),i(5,f=null)}function Et(){i(5,f=null)}const ut=S=>S.position.x,kt=S=>S.position.x+ml,Nt=S=>S.position.y+pl/2;let yt="",x=null,it=1200,U=650,q=null;function Vt(){x&&(q&&q.disconnect(),q=new ResizeObserver(()=>{x&&(i(16,it=Math.max(320,Math.floor(x.clientWidth-1))),i(17,U=Math.max(240,Math.floor(x.clientHeight-1))))}),q.observe(x))}let re=60,dt=!1;function Dt(S){dt=!0,S.preventDefault()}function Ht(S){if(!dt||!x||!x.parentElement)return;const V=x.parentElement.getBoundingClientRect(),zt=S.clientX-V.left,et=Math.max(20,Math.min(80,zt/V.width*100));i(18,re=et)}function Wt(){dt=!1}Xn(()=>(window.addEventListener("mousemove",Ht),window.addEventListener("mouseup",Wt),()=>{window.removeEventListener("mousemove",Ht),window.removeEventListener("mouseup",Wt)}));let It=null,ne=new Map,Xt=null,ot=null,ae=null,Qt=null;function Rt(){!It||!ae||(Qt&&Qt.disconnect(),Qt=new ResizeObserver(()=>{requestAnimationFrame(()=>It&&It.invalidateSize())}),Qt.observe(ae))}function se(){i(9,G=!G),requestAnimationFrame(()=>It==null?void 0:It.invalidateSize())}Xn(()=>{let S=!1;const nt=()=>It&&It.invalidateSize();return Promise.resolve().then(async()=>{if(await el(),!S&&(Vt(),!It&&ot)){It=ei.map(ot,{zoomControl:!0,attributionControl:!1}).setView([0,0],2);const V={" OpenStreetMap":ei.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{opacity:.9,minZoom:1,maxZoom:22,attribution:" OpenStreetMap contributors"})," OSM (Dark-ish)":ei.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",{opacity:.95,minZoom:1,maxZoom:22,attribution:" OpenStreetMap,  CartoDB"})," Esri World Imagery":ei.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{opacity:1,minZoom:1,maxZoom:19,attribution:"Tiles  Esri"})," Carto Positron":ei.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{opacity:.95,minZoom:1,maxZoom:22,attribution:" OpenStreetMap,  CartoDB"})," OpenTopoMap":ei.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{opacity:.95,minZoom:1,maxZoom:17,attribution:" OpenStreetMap,  OpenTopoMap"})};V[" Esri World Imagery"].addTo(It),Xt=ei.control.layers(V,{},{position:"topright",collapsed:!1}),Xt.addTo(It),Rt(),window.addEventListener("resize",nt)}}),()=>{S=!0,window.removeEventListener("resize",nt),Qt==null||Qt.disconnect(),q==null||q.disconnect()}});function Fe(S,nt){var zt;const V=H[S.id];return V&&typeof V=="object"&&V.type==="raster"&&V.path?V.path:S.type==="raster.input"&&typeof((zt=r[nt].args)==null?void 0:zt.path)=="string"?r[nt].args.path:null}function Ge(S,nt){const V=H[S.id];return V&&typeof V=="object"&&V.type==="vector"?V:null}async function De(S,nt){if(!It||!Xt){alert("Map not ready yet.");return}const V=Ge(S);if(V){await Ce(S,V);return}const zt=Fe(S,nt);if(!zt){alert("No raster or vector data available. Run the pipeline first.");return}const et=S.id;await fetch("/preview/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:et,path:zt})});const Tt=`/preview/tile/${et}/{z}/{x}/{y}.png`,wt=`${S.label} (${S.id})`;if(ne.has(et)){const Bt=ne.get(et);It.removeLayer(Bt),Xt.removeLayer(Bt),ne.delete(et)}const jt=ei.tileLayer(Tt,{tms:!1,opacity:.8,maxZoom:22});ne.set(et,jt),jt.addTo(It),Xt.addOverlay(jt,wt);try{const Bt=await fetch(`/preview/bounds/${et}`).then(St=>St.json()),[be,rn,Rn,ui]=Bt.bounds,zn=ei.latLngBounds([rn,be],[ui,Rn]);It.fitBounds(zn,{padding:[10,10],animate:!0})}catch(Bt){console.warn("Failed to get bounds for zoom:",Bt)}}async function Ce(S,nt){if(!It||!Xt)return;const V=S.id,zt=nt.geojson,et=nt.bounds;await fetch("/preview/register_vector",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:V,geojson:zt,bounds:et})});const Tt=`${S.label} (${S.id})`;if(ne.has(V)){const jt=ne.get(V);It.removeLayer(jt),Xt.removeLayer(jt),ne.delete(V)}const wt=ei.geoJSON(zt,{style:jt=>({color:"#3388ff",weight:2,opacity:.8,fillOpacity:.3}),pointToLayer:(jt,Bt)=>ei.circleMarker(Bt,{radius:6,fillColor:"#3388ff",color:"#fff",weight:1,opacity:1,fillOpacity:.8}),onEachFeature:(jt,Bt)=>{if(jt.properties){const be=Object.entries(jt.properties).map(([rn,Rn])=>`<b>${rn}:</b> ${Rn}`).join("<br>");Bt.bindPopup(be)}}});if(ne.set(V,wt),wt.addTo(It),Xt.addOverlay(wt,Tt),et&&et.length===4){const[jt,Bt,be,rn]=et,Rn=ei.latLngBounds([Bt,jt],[rn,be]);It.fitBounds(Rn,{padding:[10,10],animate:!0})}}function Kt(){if(!(!It||!Xt)){for(const[,S]of ne)It.removeLayer(S),Xt.removeLayer(S);ne.clear()}}let he=null,ze="",Re=[],Ft={},le=!1;function xe(S){var zt;i(21,he=S),i(23,Re=w(S.type)),i(24,Ft={});const V={...((zt=p.find(et=>et.name===S.type))==null?void 0:zt.default_args)??{},...S.args??{}};for(const et of Re)i(24,Ft[et.key]=V[et.key],Ft);i(22,ze=JSON.stringify(S.args??{},null,2)),i(25,le=!1)}function Je(){if(!he)return;const S={};for(const nt of Re){let V=Ft[nt.key];if(nt.type==="number"&&(V=Number(V)),nt.type==="array"){if(Array.isArray(V))S[nt.key]=V;else if(typeof V=="string"){const zt=V.split(",").map(et=>et.trim()).filter(Boolean);S[nt.key]=nt.itemType==="number"?zt.map(Number):zt}else S[nt.key]=[];continue}nt.type==="boolean"&&(V=!!V),S[nt.key]=V}i(21,he.args=S,he),i(3,d[he.id]=JSON.stringify(S,null,2),d)}function Qe(){if(he)if(le)try{const S=JSON.parse(ze||"{}");i(21,he.args=S,he),i(3,d[he.id]=JSON.stringify(S,null,2),d),i(21,he=null)}catch{alert("Invalid JSON")}else Je(),i(21,he=null)}const Sn=S=>{const nt=r.find(V=>V.id===S);if(!nt)throw new Error(`Node not found: ${S}`);return nt};let ye=null;async function Xe(S){i(4,F=!0),i(7,E=[]),await Ot(S),ye&&clearInterval(ye),i(67,ye=setInterval(()=>Ot(S),1e3))}async function Ot(S){try{const nt=await fetch(`/pipeline/schedules/${S}/runs`).then(et=>et.json());if(!Array.isArray(nt)||nt.length===0){i(7,E=[{nodeId:"system",ok:!0,text:"(no runs yet)"}]);return}const V=nt[0],zt=await fetch(`/pipeline/schedules/runs/${V.id}`).then(et=>et.json());i(7,E=zt.logs.map(et=>({nodeId:zt.status==="running"?"run":zt.status==="success"?"ok":"err",ok:!/|exception/i.test(et),text:et}))),zt.status!=="running"&&ye&&(clearInterval(ye),i(67,ye=null))}catch{i(7,E=[{nodeId:"system",ok:!1,text:"Failed to fetch run logs"}])}}ro(()=>{ye&&clearInterval(ye)});let an=!1,je="once",Ue="",dn=0,bn=0,He=0,Ne="0 5 * * *",$e=!1,Jt="",fe=[];function tn(){const{activeNodes:S}=z();if(S.length===0){alert("No connected nodes to schedule. Connect nodes with edges first.");return}i(26,an=!0),i(27,je="once"),i(28,Ue=""),i(29,dn=i(30,bn=i(31,He=0))),i(32,Ne="0 5 * * *"),i(34,Jt="")}function Tn(){const{activeNodes:S,activeEdges:nt}=z(),V=S.map(et=>({id:et.id,type:et.type,args:et.args??{}})),zt=nt.map(et=>({source:et.source,target:et.target}));return{nodes:V,edges:zt}}async function pn(){const S=Tn();if(S.nodes.length===0){i(34,Jt="Nothing to schedule (empty graph).");return}const nt={mode:je,graph:S};if(je==="once"){if(!Ue){i(34,Jt="Please pick a date & time.");return}nt.run_at=new Date(Ue).toISOString()}else if(je==="interval"){if(nt.hours=Number(dn)||0,nt.minutes=Number(bn)||0,nt.seconds=Number(He)||0,!(nt.hours||nt.minutes||nt.seconds)){i(34,Jt="Interval must be > 0.");return}}else if(nt.cron=(Ne||"").trim(),!nt.cron){i(34,Jt="Cron expression is required.");return}i(33,$e=!0),i(34,Jt="");try{const V=await fetch("/pipeline/schedules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(nt)});if(!V.ok)throw new Error(`HTTP ${V.status}`);await V.json(),i(26,an=!1),await gn()}catch(V){i(34,Jt=`Failed to create schedule: ${(V==null?void 0:V.message)||V}`)}finally{i(33,$e=!1)}}async function gn(){try{const S=await fetch("/pipeline/schedules");if(S.ok){i(35,fe=await S.json());return}}catch{}try{const S=await fetch("/schedules");S.ok&&i(35,fe=await S.json())}catch{}}async function En(S){await fetch(`/pipeline/schedules/${S}`,{method:"DELETE"}).catch(()=>{}),await gn()}async function qe(S){await fetch(`/pipeline/schedules/${S}/pause`,{method:"POST"}).catch(()=>{}),await gn()}async function Pt(S){await fetch(`/pipeline/schedules/${S}/resume`,{method:"POST"}).catch(()=>{}),await gn()}Xn(async()=>{await gn().catch(()=>{})});function Ye(){const S={nodes:r.map(Tt=>({id:Tt.id,position:Tt.position,label:Tt.label,type:Tt.type,args:Tt.args})),edges:u.map(Tt=>({id:Tt.id,source:Tt.source,target:Tt.target}))},nt=JSON.stringify(S,null,2),V=new Blob([nt],{type:"application/json"}),zt=URL.createObjectURL(V),et=document.createElement("a");et.href=zt,et.download=`saterys-workflow-${new Date().toISOString().replace(/:/g,"-").split(".")[0]}.json`,et.click(),URL.revokeObjectURL(zt)}function vn(){const S=document.createElement("input");S.type="file",S.accept=".json",S.onchange=async nt=>{var zt;const V=(zt=nt.target.files)==null?void 0:zt[0];if(V)try{const et=await V.text(),Tt=JSON.parse(et);if(!Tt.nodes||!Array.isArray(Tt.nodes)){alert("Invalid workflow file: missing nodes array");return}i(1,r=[]),i(2,u=[]),i(3,d={}),Kt(),i(1,r=Tt.nodes.map(jt=>({id:jt.id||`n${l++}`,position:jt.position||{x:100,y:100},label:jt.label||"unknown",type:jt.type||"hello",args:jt.args||{}}))),l=Math.max(...r.map(jt=>{const Bt=jt.id.match(/^n(\d+)$/);return Bt?parseInt(Bt[1]):0}),0)+1,Tt.edges&&Array.isArray(Tt.edges)&&(i(2,u=Tt.edges.map(Bt=>({id:Bt.id||`e${c++}`,source:Bt.source,target:Bt.target}))),c=Math.max(...u.map(Bt=>{const be=Bt.id.match(/^e(\d+)$/);return be?parseInt(be[1]):0}),0)+1);for(const jt of r)i(3,d[jt.id]=JSON.stringify(jt.args||{},null,2),d);R("system",!0,`Loaded workflow with ${r.length} nodes and ${u.length} edges`),i(4,F=!0)}catch(et){alert(`Failed to load workflow: ${et instanceof Error?et.message:String(et)}`)}},S.click()}function en(S){Ve.call(this,n,S)}function Bn(S){Ve.call(this,n,S)}const y=()=>i(4,F=!F),_t=()=>i(10,lt=!lt),Lt=()=>i(0,s=s==="dark"?"light":"dark"),Ct=()=>i(0,s=s==="dark"?"light":"dark"),At=S=>M(S.id),O=S=>{yd(S.id),Xe(S.id)},$t=S=>qe(S.id),me=S=>Pt(S.id),Yt=S=>Xe(S.id),Se=S=>En(S.id),nn=S=>j(S.id),ln=S=>J(S.id),on=S=>A(S.id);function An(S){r[S].type=Go(this),i(1,r),i(6,p)}const oi=(S,nt)=>{const V=p.find(et=>et.name===r[S].type),zt=(V==null?void 0:V.default_args)??{};i(1,r[S].args=JSON.parse(JSON.stringify(zt)),r),i(1,r[S].label=`${r[S].type} (${nt.id})`,r),i(3,d[nt.id]=JSON.stringify(r[S].args,null,2),d)},Wn=S=>xe(S),xn=(S,nt)=>De(S,nt),wn=async S=>{var nt;try{const V=await Fa(S,{});i(4,F=!0),R(S.id,!!(V!=null&&V.ok),V!=null&&V.ok?((nt=V==null?void 0:V.output)==null?void 0:nt.message)||"Started":(V==null?void 0:V.error)||"Error")}catch(V){R(S.id,!1,`Exception: ${typeof V=="object"&&V!==null&&"message"in V?V.message:String(V)}`),i(4,F=!0)}};function Jn(S,nt){n.$$.not_equal(r[nt].position,S)&&(r[nt].position=S,i(1,r))}function Kn(S){ii[S?"unshift":"push"](()=>{x=S,i(15,x)})}function gt(S){ii[S?"unshift":"push"](()=>{ot=S,i(19,ot)})}function Gt(S){ii[S?"unshift":"push"](()=>{ae=S,i(20,ae)})}const ee=()=>i(21,he=null),un=()=>i(25,le=!1),Mn=()=>i(25,le=!0);function cn(S){Ft[S.key]=this.value,i(24,Ft),i(23,Re)}function pe(S){Ft[S.key]=Ci(this.value),i(24,Ft),i(23,Re)}function xt(S){Ft[S.key]=this.checked,i(24,Ft),i(23,Re)}function We(S){Ft[S.key]=this.value,i(24,Ft),i(23,Re)}function Fn(S){Ft[S.key]=this.value,i(24,Ft),i(23,Re)}function Qn(S){Ft[S.key]=Go(this),i(24,Ft),i(23,Re)}function hn(){ze=this.value,i(22,ze)}const mi=()=>i(21,he=null),Gn=()=>i(26,an=!1);function kn(){je=Go(this),i(27,je)}function ge(){Ue=this.value,i(28,Ue)}function Un(){dn=Ci(this.value),i(29,dn)}function In(){bn=Ci(this.value),i(30,bn)}function Zn(){He=Ci(this.value),i(31,He)}function On(){Ne=this.value,i(32,Ne)}const Dn=()=>i(26,an=!1),ai=()=>navigator.clipboard.writeText(E.map(S=>`[${S.nodeId}] ${S.ok?"OK":"ERR"} ${S.text}`).join(`
`)),sn=()=>i(7,E=[]),li=()=>i(4,F=!1),bi=()=>i(10,lt=!1);function wi(){tt=this.value,i(12,tt)}return n.$$.update=()=>{if(n.$$.dirty[0]&1&&document!=null&&document.body&&(document.body.dataset.theme=s),n.$$.dirty[0]&10){for(const S of r)if(d[S.id]===void 0)try{i(3,d[S.id]=JSON.stringify(S.args??{},null,2),d)}catch{i(3,d[S.id]="{}",d)}}if(n.$$.dirty[0]&6){const S=new Set(r.map(V=>V.id)),nt=u.filter(V=>S.has(V.source)&&S.has(V.target));nt.length!==u.length&&i(2,u=nt)}n.$$.dirty[0]&2&&i(14,yt=r.map(S=>`${S.id}:${S.position.x},${S.position.y}`).join("|")),n.$$.dirty[0]&16|n.$$.dirty[2]&32&&!F&&ye&&(clearInterval(ye),i(67,ye=null))},[s,r,u,d,F,f,p,E,B,G,lt,K,tt,st,yt,x,it,U,re,ot,ae,he,ze,Re,Ft,le,an,je,Ue,dn,bn,He,Ne,$e,Jt,fe,k,M,A,ht,rt,R,mt,pt,J,j,Et,ut,kt,Nt,Dt,ne,se,De,Kt,xe,Qe,Sn,Xe,tn,pn,gn,En,qe,Pt,Ye,vn,ye,en,Bn,y,_t,Lt,Ct,At,O,$t,me,Yt,Se,nn,ln,on,An,oi,Wn,xn,wn,Jn,Kn,gt,Gt,ee,un,Mn,cn,pe,xt,We,Fn,Qn,hn,mi,Gn,kn,ge,Un,In,Zn,On,Dn,ai,sn,li,bi,wi]}class wd extends Cn{constructor(e){super(),Ln(this,e,bd,pd,mn,{},null,[-1,-1,-1,-1,-1,-1])}}new wd({target:document.getElementById("app")});export{ro as $,ce as A,il as B,ol as C,ue as D,_e as E,bt as F,fn as G,_n as H,ni as I,Be as J,Xo as K,Me as L,Ee as M,Ae as N,Te as O,Qs as P,Yn as Q,ic as R,Cn as S,Oe as T,Ci as U,Fi as V,Vn as W,zi as X,Go as Y,$ as Z,ii as _,at as a,So as a0,oe as a1,di as a2,ao as a3,Q as b,m as c,Y as d,T as e,vt as f,yn as g,Le as h,Ln as i,W as j,Z as k,ft as l,ke as m,Ut as n,Xn as o,oo as p,Pe as q,b as r,mn as s,te as t,_i as u,X as v,ve as w,Eo as x,Ze as y,rs as z};
